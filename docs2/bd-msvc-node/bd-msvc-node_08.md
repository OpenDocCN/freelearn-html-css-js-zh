# 8

# Node.js 中的微服务调试

在 Node.js 中调试微服务涉及识别和解决在各个服务中发生的问题或错误。

我们将从这个章节开始，通过调试 Node.js 中的微服务来介绍微服务开发。请记住，由于微服务的分布式特性和与其他服务的交互，调试微服务可能会很具挑战性。结合适当的工具和技术，系统性和有条理的方法将帮助您有效地调试 Node.js 微服务，并高效地识别和解决问题。

到本章结束时，您将能够调试健壮的 Node.js 微服务，以便在开发过程中更快地检查和发现问题，从而确保软件质量更好。

在本章中，我们将涵盖以下主要主题：

+   日志和调试工具

+   容器中的调试和错误处理

+   单元测试和远程调试

+   仪器化和跟踪以及环境和配置

+   复现和隔离问题以及调试工具和库

# 日志和调试工具

在本节中，我们将探讨日志和调试工具，这些工具将帮助我们更快地找到软件应用程序错误的解决方案。

## 微服务中的日志记录

**日志记录**是微服务架构的一个关键方面，它提供了对系统行为、性能和错误的洞察。

微服务日志记录的关键方面如下：

+   **集中式日志记录**：利用集中式日志记录系统，如 ELK Stack 或 Fluentd，从各种微服务中聚合日志。集中式日志记录通过提供应用程序行为的统一视图来简化故障排除。

+   **结构化日志记录**：实现结构化日志记录，其中日志消息采用标准格式（JSON 或键值对）。结构化日志更容易分析，并且可以被日志聚合系统高效处理。

+   使用`info`、`warn`、`error`、`debug`等来对日志消息进行分类。`info`用于一般信息，`warn`用于潜在问题，`error`用于关键错误，而`debug`用于详细的调试信息。您可以根据您的部署环境动态调整日志级别。

+   **上下文日志记录**：在日志条目中包含上下文信息，例如请求 ID、用户 ID 和事务 ID。这种上下文有助于在微服务之间跟踪特定请求，有助于调试和监控。例如，为了确保在医疗领域（如 PHI）或银行领域（如银行详情）的敏感数据不会意外地记录在 Node.js 项目中，实施适当的上下文日志记录和数据掩码技术是非常重要的：

    +   **敏感数据的上下文日志**：确定不应记录的敏感数据元素，例如 PHI 或银行详情。实施上下文日志记录以确保敏感数据从一开始就不会被记录。这可以通过应用逻辑来排除特定字段或属性被记录来实现。

    +   **数据屏蔽**：在记录之前应用数据屏蔽技术以混淆敏感数据。例如，你可以用屏蔽值替换实际的银行详情或使用诸如编辑或标记化等技术。

    +   **访问控制**：实施访问控制以限制哪些用户或角色可以查看日志中的敏感数据。确保只有授权人员才能访问包含敏感信息的日志。

    +   **定期审计**：定期审计日志配置和代码以确保敏感数据始终被排除在日志之外。这有助于你识别任何无意中泄露的敏感信息。

    +   **加密**：在记录之前考虑对敏感数据进行加密，以便即使日志被未经授权的用户访问，数据仍然受到保护。通过实施这些措施，你可以帮助确保敏感数据不会意外地记录在 Node.js 项目中，从而降低数据泄露的风险并保持符合数据保护法规。

+   **日志轮转和保留**：实施日志轮转以管理日志文件大小并防止其消耗过多的存储空间。定义日志保留策略以确保日志保留适当的时间，用于审计和调试目的。

为了确保微服务中的安全日志记录和定期日志更新，你可以考虑以下最佳实践：

+   **使用安全的日志记录实践**：实施安全的日志记录机制以确保敏感数据不会在日志中暴露。这可能涉及在记录之前对敏感信息进行编辑或屏蔽。

+   **实施日志完整性和授权**：使用数字签名和访问控制机制来确保日志数据的完整性和安全性。只有授权人员应该有权访问日志。

+   **日志聚合和分析**：实施日志聚合解决方案以集中来自多个微服务的日志。使用分析工具监控日志以查找安全事件和异常。

+   **持续日志审查**：定期审查和分析日志以查找安全和性能问题。这有助于识别和解决微服务中任何潜在的安全漏洞。

+   **版本化日志**：对日志消息实施版本控制，以确保一致性和便于更容易的故障排除。通过遵循这些实践，你可以确保安全的日志记录、定期的日志更新以及微服务中的持续审查，这些都是维护系统安全和完整性的关键。

有效的日志记录实践有助于提高系统可靠性、故障排除的便捷性以及及时识别和解决问题的能力。通过实施结构化和上下文日志记录，并利用集中式日志记录工具，微服务架构可以保持对其操作和性能的可见性。在这些概念的基础上，我们可以进一步了解调试工具。

## 调试工具

**微服务中的调试工具**是帮助开发者识别和修复其微服务架构中的错误、性能问题或其他问题的软件应用程序或库。调试工具的一些常见功能包括日志记录、跟踪、监控、崩溃报告和数据收集。

这里是微服务调试工具的关键概念：

+   **调试器**：使用 Node.js 调试器，如 Chrome DevTools、VS Code 调试器或 Node.js Inspector 进行交互式调试。这些工具允许开发者设置断点、检查变量以及逐步执行代码。

+   **性能分析工具**：使用性能分析工具，如 Clinic.js 或 Node.js 内置的 CPU 和内存分析器来识别性能瓶颈。性能分析有助于优化代码并提高整体系统效率。例如，V8 分析器是一种用于分析在 V8 JavaScript 引擎中运行的 JavaScript 代码的性能分析工具，该引擎用于 Google Chrome 和 Node.js。它可以用来识别性能瓶颈并优化代码以获得更好的性能。V8 分析器提供了关于 JavaScript 代码的执行时间、内存消耗和 CPU 使用的洞察，帮助开发者提高其应用程序的效率。

+   **分布式跟踪**：利用分布式跟踪工具，如 Jaeger、Zipkin 或 OpenTelemetry。分布式跟踪提供了对请求在微服务之间流动的洞察，有助于识别延迟问题和瓶颈。

+   **错误跟踪系统**：集成错误跟踪系统，如 Sentry、Rollbar 或 New Relic。这些工具自动捕获错误和异常，提供详细的报告、堆栈跟踪和上下文信息，这对于快速解决问题至关重要。

+   **日志分析工具**：使用日志分析工具，如 Loggly、Splunk 或 Sumo Logic。这些工具提供高级的日志搜索、过滤和可视化功能，有助于深入分析应用程序行为和问题诊断。

+   **混沌工程工具**：实施混沌工程工具，例如来自 Netflix 的 Simian Army 的 Chaos Monkey 或 Gremlin。混沌工程涉及故意向系统中注入故障以测试其弹性并识别弱点，防止它们引发真实事件。

+   **自定义调试端点**：在微服务中创建专门用于调试目的的自定义端点。这些端点可以提供详细的内部状态信息、配置设置或有助于诊断问题的指标，而不会将敏感数据暴露给外部来源。在 Node.js 微服务中，您可以创建自定义调试端点来公开特定的调试信息。

    下面是一个使用 Express 框架实现自定义调试端点的示例：

    ```js
    // Import required modules
    ```

    ```js
    const express = require('express');
    ```

    ```js
    const app = express();
    ```

    ```js
    // Debug endpoint to get the health status of the microservice
    ```

    ```js
    app.get('/debug/health', (req, res) => {
    ```

    ```js
    // Check the health status of the microservice
    ```

    ```js
    // Return appropriate response based on the health status
    ```

    ```js
    // You can include more detailed debugging information if required
    ```

    ```js
    res.json({ status: 'healthy', message: 'Microservice is running fine' }); });
    ```

    ```js
    // Debug endpoint to get system information
    ```

    ```js
    app.get('/debug/system', (req, res) => {
    ```

    ```js
    // Retrieve system information such as memory usage, CPU load, etc.
    ```

    ```js
    // Return the system information as a JSON response
    ```

    ```js
    res.json({ memoryUsage: process.memoryUsage(), cpuUsage: process.cpuUsage() }); });
    ```

    ```js
    // Start the server
    ```

    ```js
    const port = 3000; app.listen(port, () => { console.log(`Microservice debug endpoints are listening on port ${port}`); });
    ```

    在这个例子中，我们使用 Express 创建了两个自定义调试端点，分别命名为 `'/debug/health'` 和 `'/debug/system'`。`'/debug/health'` 端点负责提供微服务的健康状态，而 `'/debug/system'` 端点提供系统信息，例如内存和 CPU 使用情况。根据您的特定调试需求，您可以添加更多自定义调试端点。这些端点可以帮助您在开发和生产环境中监控和调试微服务。

使用正确的调试工具，您将能够解决软件开发各个阶段的难题。

*图 8**.1* 展示了日志记录和调试的过程：

![图 8.1：日志记录和调试的过程（图片由 vectorjuice 在 Freepik 提供）](img/B14980_08_01.jpg)

图 8.1：日志记录和调试的过程（图片由 vectorjuice 在 Freepik 提供）

总结来说，通过结合使用集中式日志记录、强大的调试工具和主动监控实践，开发者可以有效地识别、诊断和解决基于微服务的应用程序中的问题，确保可靠和响应迅速的用户体验。

现在您已经理解了这些概念，让我们考虑容器中的调试和错误处理。

# 容器中的调试和错误处理

在容器中进行调试和错误处理是部署软件解决方案时检查日志和问题的重大里程碑。

## 容器中的调试

**容器中的调试**是寻找和修复在 Docker 容器中运行的应用程序中的错误、性能问题或其他问题的过程。Docker 容器是隔离的环境，它们打包了应用程序的代码、依赖项和配置，使得在任何平台上部署和运行变得更加容易。

让我们来看看容器调试的关键方面：

+   `docker exec -it <container_id> /bin/bash` 允许直接交互，让您能够实时检查文件、运行命令和进行故障排除。`docker exec` 命令在运行的容器中运行新的命令。

    下面是命令的分解：

    +   `docker exec`：命令的这一部分在运行的容器中运行新的命令。

    +   `-it`：此选项用于分配伪 TTY 并保持 STDIN 打开，即使它未连接。这允许您与容器内部的 shell 进行交互。

    +   `<container_id>`：这是将要执行命令的容器的 ID 或名称。

    +   `/bin/bash`：这是将在容器内运行的命令。在这种情况下，`/bin/bash`在容器内启动一个新的 Bash shell 会话。

    因此，当您运行`docker exec -it <container_id> /bin/bash`时，您将在指定的容器内启动一个新的交互式 Bash shell 会话。

+   **容器内的日志记录**：确保您的应用程序在容器内进行广泛的日志记录。集中式日志解决方案可以聚合多个容器的日志，使问题跟踪更加容易。

+   **远程调试**：VS Code 和 WebStorm 等工具允许在容器内进行 Node.js 应用程序的远程调试。通过暴露调试端口，您可以将调试器从您的开发环境附加到容器，实现实时调试。

+   **健康检查**：在您的 Docker 容器中实现健康检查。健康检查可以是自定义脚本或简单的 HTTP 端点，Docker 可以使用这些端点来验证容器的健康状态。不健康的容器可以自动重启或替换。健康和不健康的容器是描述 Docker 容器状态的术语，基于其工作负载的可用性。Docker 容器是运行在任何平台上的应用程序的隔离环境。

+   使用`inspect`命令获取正在运行的容器的详细信息。这些信息对于诊断问题、了解网络配置和检查资源使用情况非常有价值。

通信协议是确保服务和微服务质量的一种基本方式。

*图 8**.2*展示了容器中调试的过程：

![图 8.2：容器中的调试（由 Freepik 上的 macrovector 提供）](img/B14980_08_02.jpg)

图 8.2：容器中的调试（由 Freepik 上的 macrovector 提供）

学习了这些概念后，我们可以继续进行错误处理。

## 错误处理

**错误处理**在微服务中是一个涉及如何处理由多个服务组成的分布式系统中可能出现的故障和异常的话题。

错误处理过程如下：

+   **优雅的错误响应**：设计您的服务，使其提供有意义的和一致的错误响应。包括错误代码、消息，如果适用，还包括相关文档的链接。适当的 HTTP 状态代码（4xx 表示客户端错误，5xx 表示服务器错误）提供了对错误类型的清晰指示。

+   **集中式错误处理**：在您的微服务架构中实现集中式错误处理。一个中间件或全局错误处理器可以捕获未处理的异常并提供统一的错误响应，确保服务之间的一致性。

+   **错误日志记录**：全面记录错误。包括堆栈跟踪、时间戳和上下文信息。集中式日志系统可以收集这些日志，为您提供整个应用程序的错误完整视图。

+   **重试策略**：对于短暂性错误，实现带有指数退避的重试机制。重试策略可以显著减少由网络问题或临时资源限制引起的短暂性失败的影响。

+   **断路器模式**：在微服务环境中实现断路器模式，以防止级联故障。当一个服务持续失败时，断路器停止对该服务的请求，使其有机会恢复，并防止进一步的负载。

+   **回退机制**：为关键操作实现回退机制。如果服务不可用，系统可以提供降级功能或回滚到缓存数据，确保用户体验不会完全中断。

+   **监控和警报**：针对特定的错误率和模式设置监控和警报。主动警报可以让您的团队能够快速响应新出现的问题，防止服务中断。

+   **事后分析**：对重大事件进行事后分析。了解根本原因有助于实施预防措施，确保类似问题不会再次发生。

在这些概念的基础上，我们可以更好地分析错误处理的过程。

总结来说，通过关注容器内的有效调试策略并实施强大的错误处理实践，您可以显著提高基于微服务的应用程序的可靠性、稳定性和弹性。

接下来，我们将讨论单元测试和远程调试。

# 单元测试和远程调试

在微服务架构中，单元测试和远程调试在开发微服务时发挥着至关重要的作用。

## 单元测试

**单元测试**是一种软件测试技术，用于验证软件系统单个单元或组件的功能和质量。一个单元可以是函数、方法、类或任何其他隔离的代码片段。单元测试通常由开发人员使用自动化工具或框架执行，并在开发早期阶段帮助识别和修复错误。

这里是单元测试的一些关键原则：

+   **测试框架**：在 Node.js 应用程序中，利用 Mocha、Jest 或 Jasmine 等测试框架来组织测试和断言。

+   `assert`模块。断言验证预期的结果是否与实际结果匹配，确保代码的正确性。

+   **模拟和存根**：使用 Sinon.js 等库来创建模拟和存根。模拟外部依赖和函数允许您隔离待测试的代码，确保测试专注于特定的组件。

+   **测试执行器**：将测试设置与 CI/CD 管道集成。例如，Jenkins、Travis CI 和 GitHub Actions 等工具可以自动在代码提交时触发测试，确保新的代码更改不会引入回归。

+   **覆盖率分析**：使用 Istanbul 等工具来衡量代码覆盖率。代码覆盖率分析有助于识别未测试的代码路径，确保应用程序的全面测试。

+   ** Arrange, Act, Assert (AAA) 模式**：对于单元测试，遵循 AAA 模式：**Arrange** 设置前置条件，**Act** 执行测试操作，**Assert** 验证预期的结果。这种结构化方法确保了测试的清晰性和可维护性。

+   **参数化测试**：实现参数化测试以使用多个输入运行相同的测试逻辑。参数化测试增强了测试覆盖率，对于测试边缘情况特别有用。

单元测试及其框架和库可以帮助许多开发者构建健壮的微服务。

接下来，我们将考虑远程调试。

## 远程调试

**远程调试**是指调试运行在不同于开发环境的机器或环境中的应用程序的过程。

这里是远程调试的一些关键概念：

+   `inspect` 或 `inspect-brk` 标志后跟端口号（例如，`--inspect=9229`）。这会暴露一个调试端口，外部调试器可以连接到。

+   包含正确主机和端口号的`launch.json`文件，以便进行调试。VS Code 的调试器可以附加到正在运行的 Node.js 进程，允许你设置断点、检查变量和逐步执行代码。

+   使用`--inspect`并在 Chrome 中打开`chrome://inspect`。然后你可以连接到你的 Node.js 进程，并使用熟悉的 Chrome DevTools 界面进行调试。

+   使用`--inspect`并运行`node inspect`命令来启动 Inspector。它提供了一个**读取-评估-打印循环（REPL）**接口用于调试。

+   **容器化远程调试**：当在 Docker 容器中运行 Node.js 应用程序时，在 Dockerfile 中暴露调试端口。确保主机和容器端口正确映射。这允许你调试容器内运行的应用程序。

+   **安全考虑**：在生产环境中暴露调试端口时要谨慎。确保有安全措施，如身份验证和防火墙规则，以防止未经授权访问调试界面。

远程调试有其专门的软件，这使得开发者的工作更加轻松和高效。

*图 8**.3* 展示了单元测试和远程调试：

![图 8.3：单元测试和远程调试（图片由 Freepik 上的 vector4stock 提供）](img/B14980_08_03.jpg)

图 8.3：单元测试和远程调试（图片由 Freepik 上的 vector4stock 提供）

总结来说，有效的单元测试确保了代码库中各个组件按预期工作。远程调试工具使开发者能够诊断和解决运行中的应用程序中的问题，即使在分布式或容器化环境中，也能增强开发和维护过程。

在下一节中，我们将学习关于仪器和跟踪以及环境和配置的内容。

# 仪器和跟踪与环境和配置

在本节中，我们将学习如何实现仪器和跟踪以及环境和配置技术，使调试和部署过程变得轻松。

## 仪器和跟踪

**仪器和跟踪**是软件开发中的两个相关概念，有助于监控、测量和诊断应用程序的性能和行为。仪器化指的是向应用程序添加代码或注释以生成跟踪信息的能力，例如函数调用、参数、异常和事件，而跟踪则指的是收集、分析和显示跟踪信息的过程，无论是实时还是离线，以了解执行流程、识别瓶颈和排除错误。

让我们详细探讨仪器和跟踪的概念：

+   **分布式跟踪**: 使用 Jaeger、Zipkin 或 OpenTelemetry 等工具实现分布式跟踪。分布式跟踪允许您跟踪请求在各个微服务中流动的情况，提供关于延迟和瓶颈的见解。

+   **应用性能监控（APM）工具**: 使用 APM 工具，如 New Relic、Datadog 或 AppDynamics。这些工具提供详细性能指标，包括响应时间、错误率和数据库查询，以帮助您识别性能问题。

+   **自定义仪器**: 使用自定义指标对关键代码路径进行仪器化。测量函数、API 调用和外部服务交互。自定义仪器提供针对您应用程序独特需求的特定见解。

+   **日志上下文**: 在日志中实现上下文传播。在日志条目中包含唯一的标识符，如请求 ID。这种上下文有助于在不同微服务之间关联日志，有助于调试期间的跟踪性。

+   **请求-响应日志**: 记录关于传入请求和传出响应的详细信息。包括头信息、有效负载和处理时间。请求-响应日志有助于诊断与外部 API 交互相关的问题。

仪器和跟踪，凭借其各种工具和技术，有助于开发者更好地分析软件中每天发生的问题，并帮助他们更快地解决问题。

在下一节中，我们将讨论环境和配置。

## 环境和配置

**环境和配置**是软件开发中的两个重要方面，影响应用程序的行为以及与其他组件的交互。环境指的是影响应用程序执行的条件和变量的集合，例如操作系统、硬件、网络、依赖项和设置，而配置则是指定和调整应用程序参数和选项的过程，例如连接字符串、日志级别、功能标志和环境变量。

让我们来看看环境和配置的概念：

+   **环境变量**：使用环境变量来存储配置设置。特定环境的配置（开发、测试和生产）可以轻松管理，增强安全性和可移植性。

+   **密钥管理**：安全地存储敏感信息，如 API 密钥和数据库密码。利用 AWS Secrets Manager、Vault 或特定环境的密钥文件等工具。避免直接在配置文件中硬编码敏感数据。

+   **配置管理系统**：实施配置管理系统，如 Consul 或 Terraform。这些工具允许在不要求服务重启的情况下进行动态配置更新，促进灵活性和实时调整。

+   **配置即代码**：接受配置即代码的概念。将配置设置存储在与应用程序代码一起的版本控制系统中。然后，基础设施自动化工具可以在各种环境中部署具有正确配置的应用程序。

+   **容器编排配置**：利用 Kubernetes 或 Docker Compose 等容器编排平台来管理微服务。这些工具允许你声明性地定义配置、环境变量和密钥，简化部署和扩展过程。

+   **环境间一致性**：确保不同环境中的配置一致性。使用配置模板和脚本来自动化特定环境的调整，减少部署过程中配置错误的几率。

+   **配置验证**：在应用程序启动时实施验证检查。确保必要的配置存在且具有有效的值。如果缺少或配置错误，配置将快速失败。

+   **不可变基础设施**：追求不可变基础设施，其中服务器和容器在创建后永不修改。不可变基础设施促进可靠性并确保配置在整个应用程序生命周期中保持一致。

总结来说，通过整合强大的仪器和跟踪实践，你可以深入了解你的微服务的性能和行为。另一方面，有效的环境和配置管理确保你的微服务在各种环境中保持一致性，从而在整个开发和部署过程中促进稳定性和安全性。

在最后一节中，我们将讨论如何重现和隔离问题，以及各种调试工具和库。

# 重现和隔离问题以及调试工具和库

在本节中，你将学习如何重现和隔离问题，以及如何使用调试工具和库。

## 重现和隔离问题

**重现和隔离问题**是软件测试和调试的重要步骤。它们帮助您确定问题的根本原因和范围，并为开发者提供清晰且可操作的反馈。

让我们学习如何重现和隔离问题：

+   Node.js 中的`assert`模块：

    ```js
    const assert = require('assert');
    ```

    ```js
    function add(a, b) { return a + b; }
    ```

    ```js
    // Unit test for the add function
    ```

    ```js
    function testAdd() {
    ```

    ```js
    const result = add(2, 3);
    ```

    ```js
    assert.strictEqual(result, 5, 'Expected add(2, 3) to equal 5'); }
    ```

    ```js
    testAdd();
    ```

    ```js
    console.log('All tests passed');
    ```

    在本例中，我们有一个`testAdd`函数，它通过传入两个数字并使用`assert.strictEqual`检查结果是否等于预期值来测试`add`函数。如果测试通过，则会在控制台打印出`'All tests passed'`。

+   **集成测试**：开发集成测试以模拟微服务之间的交互。这些测试确保服务能够正确协同工作，有助于识别与通信协议和数据交换相关的问题。

+   **基于场景的测试**：创建基于场景的测试，模拟现实世界的用户交互。这些测试通过应用程序复制用户旅程，使您能够识别与数据流和用户体验相关的问题。

+   **预发布环境**：维护尽可能接近生产设置的预发布环境。在预发布环境中重现问题为在将修复部署到生产环境之前提供了一个受控的测试空间。

+   **功能标志**：在生产中使用功能标志来启用或禁用特定的功能。功能标志允许您隔离有问题的功能或组件，而不会影响整个用户群。

+   **隔离技术**：在测试时使用服务虚拟化等技术来隔离微服务。服务虚拟化允许您模拟依赖服务的行为，从而实现单个微服务的独立测试。

正如我们所学的，这些概念帮助我们更快地识别问题，因为我们可以在隔离环境中重现它们，并在它们进入生产环境之前解决它们。

在下一节中，我们将学习更多关于调试工具和库的内容。

## 调试工具和库

**调试工具和库**是帮助开发者和测试者找到并修复代码中错误的软件。有许多类型的调试工具和库，例如命令行调试器、图形调试器、网络调试器、内存调试器等。一些调试工具和库针对特定的编程语言、框架或平台，而其他则更通用，可以与不同的技术一起工作。

使用以下概念、工具和库，我们可以轻松地调试我们的应用程序：

+   **日志记录和跟踪**：使用结构化日志来捕获相关信息。结构化日志便于各种日志工具进行分析。实现分布式跟踪以跟踪跨微服务的请求，有助于诊断问题。

+   **Chrome DevTools**：利用 Chrome DevTools 进行 Node.js 应用程序的调试。DevTools 提供了一套全面的调试工具，允许你设置断点、检查变量、分析性能和分析网络活动。

+   **调试语句**：将调试语句插入到你的代码中。当 Node.js 应用程序遇到调试语句时，它会暂停执行，允许你交互式地检查调用堆栈和变量值。

+   使用 `--inspect` 和 `--inspect-brk` 分析 CPU 和内存使用情况。性能分析有助于识别代码中的性能瓶颈和内存泄漏。

+   **错误处理库**：实施错误处理库，如 Sentry、Rollbar 或 Bugsnag。这些工具自动捕获错误并提供详细的报告，包括堆栈跟踪和上下文信息，有助于快速解决问题。

+   **混沌工程工具**：实施如 Chaos Monkey 或 Gremlin 等工具进行可控的混沌工程实验。混沌工程允许你通过以可控方式引入故障来主动识别系统弹性的弱点。

+   **远程调试**：利用远程调试功能，以便你可以调试在远程环境或容器中运行的应用程序。如 VS Code Remote Development 等工具可以促进远程服务的无缝调试。

+   **自定义调试端点**：在微服务中创建自定义调试端点。这些端点可以提供有关内部状态、配置或指标的具体信息，有助于诊断问题而不会暴露敏感数据。

通过牢记这些技术，你将在开发的同时获得额外的调试能力。

*图 8.4* 描述了调试工具和库：

![图 8.4：调试工具和库（图片由 vectorjuice 在 Freepik 提供）](img/B14980_08_04.jpg)

图 8.4：调试工具和库（图片由 vectorjuice 在 Freepik 提供）

总结来说，通过采用严格的测试实践和多种调试工具和库的组合，开发者可以有效地在微服务架构中重现、隔离和解决问题，确保其应用的可靠性和稳定性。

# 总结

在本章中，我们学习了关于微服务及其调试的很多知识。我们涵盖了调试的每一个步骤，以确保我们的软件应用无错误。

在 Node.js 中调试微服务涉及对分布式系统内识别、隔离和解决问题的系统化方法。

通过结合严格的测试、结构化日志记录、跟踪、有效使用调试工具和主动监控，开发者可以系统地调试 Node.js 中的微服务，确保其分布式应用的可靠性和稳定性。

在下一章中，我们将学习如何使用 Node.js 在微服务中进行数据库操作。

# 测验时间

+   微服务中日志记录的关键方面有哪些？

+   微服务调试工具的关键概念是什么？

+   错误处理过程是如何工作的？

+   什么是单元测试？

# 第三部分：使用 Node.js 在微服务中进行数据管理

在本部分，我们将讨论微服务中的数据管理，以便更好地理解如何在 Node.js 中操作数据、API、数据合约、缓存和数据安全。

本部分包含以下章节：

+   *第九章*, *使用 Node.js 在微服务中进行数据库操作*

+   *第十章*, *微服务中的 API 通信和数据合约*

+   *第十一章*, *微服务中的缓存和异步消息传递*

+   *第十二章*, *使用 Saga 模式、加密和安全措施确保数据安全*
