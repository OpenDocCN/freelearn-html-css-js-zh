# 前言

HTML5，除了是互联网时代的最新热门词汇外，正迅速成为网络的通用语言。事实上，HTML5 是第一个拥有自己标志的 HTML 版本（[`www.w3.org/html/logo`](http://www.w3.org/html/logo)）。要理解其重要性，首先需要了解一点历史。

![前言](img/5869_00_01.jpg)

# 时间简史（客户端-服务器版）

在过去的几十年里，企业级应用开发一直在终端和主机、客户端和服务器之间摇摆不定。在 20 世纪 80 年代，由于“哑终端”或“瘦客户端”的作用，业务逻辑主要被推到服务器端，这些终端除了作为用户和服务器之间的中间人外，几乎不做任何事情。从 20 世纪 90 年代开始，随着“胖客户端”的出现，逻辑开始向客户端倾斜，承担处理负担。随着 1991 年万维网的引入，一种新的瘦客户端出现了。摆锤再次摆动。或者，它真的摆动了？

客户端与服务器之间的转变主要是由成本和功耗驱动的。早期，投资主要用于构建强大且昂贵的服务器。随着个人电脑在内存和处理能力方面的增强，以及成本的降低，现在可以构建更易于分布的应用程序，允许离线功能，最重要的是，需要更强大（且成本更低）的服务器基础设施。然而，维护、升级和部署“胖客户端”带来了新的负担。

基于 Web 的应用程序最终出现，以解决成本、功耗和维护性的问题。最初，它们看起来与它们的“瘦客户端”前辈非常相似：仅仅是用户和服务器之间的中间人，但没有部署开销。然而，随着 Java 和 JavaScript 等技术的引入，“瘦客户端”开始增加一些重量。不久，随着小程序、脚本和插件的普及，处理负担开始向客户端转移，随之而来的是维护性问题再次出现。问题不再是管理应用程序的分布，而是转向管理小程序、脚本和插件的分布。

随着“富客户端”的引入，情况出现了分化。业务逻辑分层。关注点的分离成为常态。让服务器处理服务器相关的事务。让客户端处理客户端相关的事务。然而，客户端需要一些时间才能处理世界对它的需求。

# 时间简史（网络浏览器版）

当蒂姆·伯纳斯-李（Tim Berners-Lee）在 1990 年向他的 CERN 同事介绍他的万维网浏览器时，只能隐约看到它将来会成为什么。马克·安德森（Marc Andreessen）将在 1993 年引入 Mosaic 和图形浏览，而 Netscape 将在 1994 年迅速跟进。之后，微软在 1995 年推出了 Internet Explorer。很快，第一场浏览器大战就会到来和结束，Internet Explorer 成为赢家，Netscape 的残余部分聚集在 Mozilla 和 Firefox 周围，Firefox 于 2002 年发布。在 21 世纪初，苹果发布了 Safari，谷歌发布了 Chrome。

然而，网络浏览器很少彼此保持平衡。尽管存在网络标准和名为 W3C 的管理机构，但浏览器制造商仍然按照自己的曲调演奏。最初，HTML 的实现差异很大，这一趋势一直持续到 HTML 4.0、XHTML、CSS 和 JavaScript。实现和行为上的差异使得网络开发变得困难且耗时。

为了克服网络浏览器的局限性和不一致性，基于插件的技术，如 Adobe Flash，开始蓬勃发展，继续在基于浏览器的技术，如 HTML、CSS 和 JavaScript 停止的地方继续前进。多年来，许多网站主要由——有时甚至完全是——像 Flash 这样的技术组成；这些插件甚至提供了更好的性能。随着摆钟摆回到更肥的客户端，**富互联网应用**（**RIAs**）的概念盛行。

### 注意

请参阅谷歌的“万维网演变”（The Evolution of the Web），其中包含关于网络浏览器及其实现现代浏览器功能的交互式图形，网址为[`evolutionofweb.appspot.com`](http://evolutionofweb.appspot.com)。

插件技术的引入成为了万维网承诺的误导。虽然内容连接性是 HTML 原始原则的一个标志，但内容是通过`embed`、`object`和`applet`等标签表示的，其中应用程序模块嵌入到网页上构成了黑盒，隐藏了语义网中的内容。

尽管如此，网络浏览器仍在不断发展。jQuery 等 JavaScript 框架出现，以抽象浏览器差异并提供更丰富的交互性。CSS 技术出现，以克服浏览器之间的局限性和不一致性。新浏览器出现，对网络标准的支持更好。

然而，还有一些东西缺失。尽管应用程序正在使用基于浏览器的技术进行开发，但许多应用程序功能被排除在浏览器之外。添加视频/音频播放、离线能力和甚至浏览器历史管理的一致机制都缺失。Flash 仍然被视为填补网络缺失部分的工具。

最后，在 2009 年，当 XHTML 2.0 被放弃，转而采用与早期 HTML 版本更兼容的技术时，浏览器开发围绕着 HTML5 聚集。HTML5 旨在解决浏览器中的两个主要领域：需要一种更一致、语义化的标记语言，以及需要更多原生支持的浏览器功能。当它在 2004 年推出时，预示了一系列 API，使浏览器成为真正的应用开发平台，从而更加语义化。

### 注意

**HTML5 特性**

+   **媒体 API**：这嵌入、播放和暂停多媒体内容

+   **文本轨道 API**：这读取多媒体内容的文本轨道属性

+   **拖放 API**：通过设置一个属性，原生地使元素可拖放

+   **离线应用缓存**：这为离线使用保存数据

+   **历史 API**：这增加了对后退按钮的控制

+   **Canvas API**：这在 2D 和 3D 中实际上在网络上绘制

+   **跨文档消息传递**：这克服了跨站脚本限制

+   **微数据**：这为搜索引擎提供更多语义内容以便查找

+   **MIME 类型和协议处理程序注册**：这通过处理程序扩展了应用程序以支持额外的协议

+   **Web Workers**：这产生与用户交互无关的线程

+   **Web 存储**：这将在客户端存储数据

+   **Web Sockets**：这可以在服务器和客户端之间发送双向消息

随着现代浏览器对 HTML5 支持的不断增强，对基于插件技术的依赖开始让位于基于浏览器的实现。有了允许更好地控制体验的 API，客户端终于开始实现其承诺。特别是移动网络浏览器成为了这一变革的催化剂。由于 Adobe Flash 不支持 iPhone 和 iPad 等设备，并且 Safari 浏览器对 HTML5 特性的实现日益增长，HTML5 正迅速成为移动网络应用开发的标准。然而，如果这一趋势要持续下去，浏览器制造商和应用开发者必须遵守 HTML5 的开发标准，这又把我们带回了那个标志。为了纠正过去的错误，HTML5 必须在实现上达成共识。为了培养这种共识，正在兴起一股运动，旨在在网页浏览器和应用程序中强制执行标准，并加快实施步伐，因为采用率正在逼近。HTML5 标志象征着这一努力。

### 注意

**网络超文本应用技术工作组**（**WHATWG**）于 2004 年成立，发展了 HTML，并构想 HTML5 为 HTML 标准演变的下一步。当时，W3C 正在制定 XHTML 2.0 标准；然而，在 2009 年，W3C 决定停止这一努力，并加入 WHATWG，共同致力于开发 HTML5。

2011 年 1 月，它宣布 HTML5 标准将被称为“HTML”，并且从此规范将是一个活文档。

2012 年 12 月，国际网络标准机构**万维网联盟**（**W3C**）宣布 HTML5 功能完整。尽管它还不是标准，但它最终为浏览器制造商提供了一个稳定的开发目标，以便开发 HTML5 功能。

# 语义是关键

HTML5 试图以前所未有的方式对网络上的信息进行编码。在 HTML 的先前版本中，内容是根据其应如何显示来结构化的，而不是其固有的意义。`div`标签经常被使用，但`div`标签真正意味着什么？为了解决这个问题，应用程序开发者根据网络展示的标准和最佳实践使用`id`属性将内容拆分。

例如，应用程序开发者使用以下标签：

```js
<div id="header">
<div id="footer">
```

显然的问题是，用于`id`属性的值不一定遵循标准。一个应用程序开发者可能使用`id="header"`，而另一个可能使用`id="head"`。为了根据语义标准化结构，HTML5 引入了一套新的标签，消除了这个过程的不确定性。

HTML5 引入了一套新的顶级标签，可以分为以下几类：内容、语言、布局和格式。

## 内容标签

HTML5 引入的内容标签定义了如何将新类型的内容嵌入到网页中。声音、视频和图形等内容以与文本和图像多年来相同的方式呈现。

+   `audio`: 这个标签用于嵌入声音内容。在 HTML5 之前，一些浏览器对音频的支持不一致，或者需要使用 Adobe Flash 开发的特殊播放器来播放声音。HTML5 消除了这种依赖，使音频播放器成为网页浏览器本身的一致功能。

+   `video`: 这个标签用于嵌入视频内容。与音频一样，视频内容的支持并不一致，或者需要特殊的播放器来播放。支持`video`标签的网页浏览器具有内置的视频播放器。

+   `canvas`: 这个标签允许通过 JavaScript 绘制基本的 2D 图形。然而，3D 图形并不始终得到支持，并且是可选的。

## 语言标签

随着国际化越来越受到重视，本地化对网络开发者来说一直是一个特殊的挑战。HTML5 引入了一套新的标签，以帮助使内容更容易被更广泛的受众访问。

+   `bdi`: 这个标签定义了文本的方向性。这通常用于支持从右到左阅读的语言。

+   `ruby`: 与`rt`和`rp`标签结合使用，`ruby`标签定义了东亚书法的 Ruby 注释。

## 布局标签

HTML5 提供了一套一流的标签，不仅有助于布局页面，还允许将页面完全拆分。使用 HTML5，网络开发者能够以更标准的方式共享内容部分：

+   `header`: 这个标签定义了页面、部分或文章的标题。

+   `footer`: 这个标签定义了页面、部分或文章的页脚。

+   `nav`: 这个标签定义了网站的菜单结构。这些是用于在语义上分割网站的导航链接。

+   `section`: 这个标签定义了页面的部分。`article`和`aside`标签在某种程度上是专门的区域标签。

+   `aside`: 这个标签定义了页面的侧边栏内容。通常，网页会通过将辅助内容推到一边来分割。

+   `article`: 这个标签定义了页面的主要内容。虽然`section`、`aside`、`header`和`footer`等标签定义了页面的辅助内容，但`article`标签标识了被认为是焦点的内容部分。通常，这部分内容是 URI 唯一的。

## 格式化标签

HTML5 引入了一套新的特殊标签，这些标签定义了如何识别和适当地格式化内容区域。

+   `figure`: 这个标签标识了非连续内容，这些内容被分层到文本主体中。例如，它可以用来包裹由文本主体引用的图表、图表和图形。

+   `details`: 这个标签定义了可以切换为可见或隐藏的内容。它旨在根据用户操作（如与帮助相关的内容）显示和隐藏内容。网页开发者已经构建了各种解决方案来做到这一点，并且随着 HTML5 的推出，网络浏览器负责处理。

+   `hgroup`: 这个标签将已知的`h1`-`h6`标签包裹成一个结构化的整体。当标题相关时，`hgroup`显示它们是相关的。例如，对于具有标题和副标题的文章，标题会被包裹在`h1`标签中，而副标题会被包裹在`h2`标签中。围绕它们的`hgroup`标签表示`h2`标签与`h1`标签相关联，而不是文档大纲的一部分。

+   `wbr`: 这个标签定义了一个单词断开的机会。通常，文本行是通过空格来分割的。`wbr`标签允许网页开发者指定在连续的非空格字符集中，在没有足够空间显示所有内容的情况下，可以在哪里引入换行。

+   `progress`: 这个标签表示任务的进度，可以与 JavaScript 结合使用，向用户显示进度条。

+   `time`: 这个标签是一个微格式化标签，允许指定某物是日期或时间。

+   `meter`: 这个标签是一个格式化标签，用于定义具有已知范围的标量测量。

+   `mark`: 这个标签表示对用户相关的文本。通常，这会用于突出显示段落中的特定单词。

## 表单升级

HTML5 中的表单获得了一整套全新的功能，以允许更好地验证内容并提高使用便捷性。

以下标签是 HTML5 中新增的：

+   `datalist`: 这个标签与`select`标签的工作方式类似，增加了能够预先输入以选择列表中项的功能。

+   `keygen`: 这个标签用于生成用于表单的密钥对。这通常用于客户端认证。

+   `output`: 此标签表示计算结果。它与`form`标签相关联，用于向用户显示简单的计算，尤其是在与新的表单输入类型一起使用时。此外，`input`标签获得了一组新的类型。以下输入类型是 HTML5 中新增的：

    +   `color`: 此类型显示颜色选择器，用于提交该颜色的十六进制代码。

    +   `date`: 此类型显示日期选择器，用于提交日期。

    +   `datetime`: 此类型显示日期和时间选择器，用于提交包括时区的日期和时间。

    +   `datetime-local`: 此类型显示日期和时间选择器，用于提交不包含时区的日期和时间。

    +   `email`: 此类型显示用于输入电子邮件地址的字段。

    +   `month`: 此类型显示月年选择器，用于提交月份和年份。

    +   `number`: 此类型显示一个用于输入数值的字段。

    +   `range`: 此类型限制用户在指定范围内选择数字。通常，这将显示为滑块。

    +   `search`: 此类型显示搜索字段。

    +   `tel`: 此类型显示一个字段，限制用户输入有效的电话号码。

    +   `time`: 此类型显示时间选择器。

    +   `url`: 此类型显示一个字段，限制用户输入有效的 URL。

    +   `week`: 此类型显示用于在一年中选择星期的控件。

## 输入微数据

HTML5 增加了为内容定义自定义语义的能力。类似于 HTML 之前版本中的微格式，其中一组预定义的属性允许你赋予内容的语义意义，微数据允许你创建自己的语义语言来赋予你的内容。虽然微格式依赖于通用的属性，如`class`和`rel`，但微数据引入了`itemscope`、`itemtype`和`itemprop`来描述内容。`itemscope`和`itemtype`属性允许你定义自定义类型并指示其定义位置。`itemprop`属性指向定义中的特定属性：

```js
<div itemscope itemtype="http://mysite.com/Movie">
    <h1 itemprop="title">Your Favorite Movie</h1>
    <p itemprop="summary" >
      A summary of your favorite movie.
    </p>
</div>
```

# 一堂解剖课

现在我们已经了解了 HTML5 中构建页面的许多新工具，让我们深入了解 HTML5 页面看起来是什么样子。

## 关于 DOCTYPE 的一些话

HTML 文档中的`DOCTYPE`声明始终是浏览器了解文档遵循的标准的信号。如果浏览器知道文档使用的标准，它可以更有效地处理和渲染该文档。基于 SGML 的标记语言需要这样做。

为了简化`DOCTYPE`标签，HTML5 只有一个类型：

```js
<!DOCTYPE html>
```

与之前的 HTML 版本不同，之前的版本需要引用所遵循的特定 DTD，HTML5 不是基于 SGML 的，因此不需要 DTD 引用。

## `lang` 属性

HTML5 引入了一个简化的`lang`属性来指定页面的语言。在 XHTML 中，需要一个`xmlns`属性，但 HTML5 不需要这个属性。

## 元标签同样重要

HTML5 添加了一个名为 `charset` 的新元标签。这个标签指定了文档的特定字符编码。否则，它使用所有来自 HTML 4.01 的元标签。

HTML5 包括对 `viewport` 元标签的支持。这个元标签定义了网页应该如何查看，包括如宽度和高度等参数。它还允许您定义缩放设置，如初始缩放、最小和最大缩放。它甚至允许您针对特定的密度 DPI 进行定位，如果您想根据不同的屏幕分辨率更改页面外观的话。

## 整合一切

一个基本的 HTML5 页面将如下所示：

```js
<!doctype html>
<html lang="en">
<head>
  <title>My First HTML5 Page</title>
  <meta charset="utf-8">
  <meta name="description" content="My first HTML5 page.">
  <meta name="author" content="Me">
</head>
<body>
</body>
</html>
```

我们当然会在继续的过程中添加更多内容。

# 应用程序

在本书的大部分内容中，我们将构建一个移动网络应用，以展示 HTML5 的许多功能。该应用名为 MovieNow，将成为查找、评论和预订附近电影的一站式商店。本书中我们将开发的功能如下：

+   使用地理位置查找附近的电影

+   向用户显示电影数据

+   使用 `video` 标签观看预告片

+   使用 `canvas` 标签显示评论

+   使用拖放 API 选择电影

+   与外部 API 集成

+   通过 Web Workers 显示附近的推文

# 本书涵盖的内容

在接下来的章节中，我们将将 HTML5 的各种功能构建到我们的 MoveNow 企业应用中。

第一章, *HTML5 入门套件：兼容性*，讨论了 HTML5 功能在多个网络浏览器和设备上的支持，以及绕过这些浏览器缺陷的方法。支持多个浏览器的主要驱动因素是确保在多个设备上访问企业网络应用的同时保持一致的用户体验。

第二章, *HTML5 入门套件：实用工具*，提供了开始 HTML5 企业应用开发的指南，包括可用的工具、它们的安装和使用。将讨论选择工具的商业驱动因素的综合评估。

第三章, *应用：结构和语义*，将指导您设置 MovieNow 企业应用的模板。我们将设置整体页面结构，深入讨论语义标签，并讨论微数据。

第四章, *应用：通过地理位置获取电影*，通过介绍地理位置开始 MovieNow 企业应用。我们将向您介绍地理位置 API 以及如何使用它来实现有用的功能。

第五章, *应用：通过 CSS3 显示电影数据*，涵盖了 CSS3 的布局和功能，包括一些有趣的 CSS3 效果。我们还将介绍在 Web 应用和设备上定义标准样式（包括媒体查询和 CSS3 的兼容性考虑）的最佳实践。

第六章, *应用：通过 HTML5 视频的预告片*，介绍了视频和音频标签及其在 HTML5 企业应用中的使用。我们将讨论如何通过 JavaScript 操作多媒体内容的播放，以及与不支持 HTML5 视频和音频标签的浏览器的向后兼容性。

第七章, *应用：通过 Canvas 显示评分*，介绍了 HTML5 canvas 以及如何使用绘图 API 在您的企业应用中显示图形。我们将使用绘图 API 为我们的 MovieNow 应用创建评分图表。

第八章, *应用：通过拖放选择 UI*，涵盖了拖放 API。我们将在 MovieNow 企业应用中实现拖放功能，展示事件委托和发布-订阅模式。

第九章, *应用：通过 Twitter 传播信息*，通过集成 Twitter API 讨论 HTML5 中的表单和表单验证。我们将在 MovieNow 应用内部实现推文的发布。

第十章, *应用：通过 Web Workers 消费推文*，展示了 Web Workers 和外部 API 的力量，将社交元素引入企业应用。我们将把附近的推文集成到 MovieNow 应用中。

第十一章, *完成：调试你的应用*，讨论了调试 HTML5 企业应用的方法。我们将讨论浏览器控制台和 HTTP 代理。

第十二章, *完成：测试你的应用*，涵盖了测试 HTML5 企业应用的工具。我们将涵盖功能测试套件和自动化工具。

第十三章, *完成：性能*，讨论了性能，这是任何 HTML5 企业应用的关键话题。我们将讨论策略和工具，并指导如何分析您的 HTML5 应用。

# 你需要为这本书准备的内容

由于本书介绍了已经熟悉网络基础（包括 HTML、CSS 和 JavaScript）的开发者，并介绍了 HTML5 和 CSS3 的优势，因此你需要具备网络应用开发的相关知识。

# 本书面向的对象

本书主要面向有一定网络应用开发经验的开发者，他们希望将自己的知识扩展到 HTML5 和 CSS3 的最新发展。完成本书后，读者将对 HTML5 提供的用于开发企业应用的工具集有深入的理解。

# 术语

在本书中，您将找到多种文本样式，用于区分不同类型的信息。以下是这些样式的示例及其含义的解释。

文本中的代码字如下所示：“将`html5shiv.js`从`dist`文件夹复制到您的 JavaScript 文件夹”。

代码块设置如下：

```js
<div class="geolocation-available">
  Congrats! Your browser supports Geolocation!
</div>
<div class="no-geolocation">
  Your browser doesn't support Geolocation :(
</div>
```

**新术语**和**重要词汇**以粗体显示。您在屏幕上看到的单词，例如在菜单或对话框中，在文本中显示如下：“点击**生成**按钮”。

### 注意

警告或重要提示以如下框的形式出现。

### 小贴士

小技巧和窍门看起来像这样。

# 读者反馈

我们始终欢迎读者的反馈。告诉我们您对这本书的看法——您喜欢什么或可能不喜欢什么。读者反馈对我们开发您真正从中受益的标题非常重要。

要向我们发送一般反馈，只需发送电子邮件到 `<feedback@packtpub.com>`，并在邮件主题中提及书名。

如果您需要一本书并且希望我们出版，请通过[www.packtpub.com](http://www.packtpub.com)上的**建议书名**表单或发送电子邮件到 `<suggest@packtpub.com>` 告诉我们。

如果您在某个主题上有专业知识，并且您有兴趣撰写或为书籍做出贡献，请参阅我们的作者指南[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在您已经是 Packt 图书的骄傲拥有者，我们有一些事情可以帮助您从您的购买中获得最大收益。

下载示例代码

您可以从您在[`www.packtpub.com`](http://www.packtpub.com)的账户下载您购买的所有 Packt 图书的示例代码文件。如果您在其他地方购买了这本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

## 下载本书的彩色图像

我们还为您提供了一个包含本书中使用的截图/图表彩色图像的 PDF 文件。彩色图像将帮助您更好地理解输出中的变化。您可以从[`www.packtpub.com/sites/default/files/downloads/5689_graphics.pdf`](http://www.packtpub.com/sites/default/files/downloads/5689_graphics.pdf)下载此文件。

## 下载示例代码

您可以从[`www.packtpub.com`](http://www.packtpub.com)您购买的所有 Packt 书籍的账户中下载示例代码文件。如果您在其他地方购买了这本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

## 错误清单

尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在我们的某本书中发现错误——可能是文本或代码中的错误——如果您能向我们报告这一点，我们将不胜感激。通过这样做，您可以节省其他读者的挫败感，并帮助我们改进本书的后续版本。如果您发现任何错误清单，请通过访问[`www.packtpub.com/support`](http://www.packtpub.com/support)，选择您的书籍，点击**错误提交表单**链接，并输入您的错误详细信息来报告它们。一旦您的错误得到验证，您的提交将被接受，错误将被上传到我们的网站，或添加到该标题的现有错误清单中，在“错误清单”部分下。您可以通过从[`www.packtpub.com/support`](http://www.packtpub.com/support)选择您的标题来查看任何现有错误。

## 盗版

互联网上对版权材料的盗版是一个跨所有媒体的持续问题。在 Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上发现我们作品的任何非法副本，无论形式如何，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过链接<mailto:copyright@packtpub.com>与我们联系，并提供疑似盗版材料的链接。

我们感谢您在保护我们的作者以及为我们提供有价值内容的能力方面的帮助。

## 询问

如果您在本书的任何方面遇到问题，可以通过链接<mailto:questions@packtpub.com>与我们联系，我们将尽力解决。
