# 前言

你好！欢迎来到《JavaScript 微服务实战》，这是一段探索最受欢迎的编程语言之一与不断演变的微服务架构世界的迷人交汇之旅。JavaScript 凭借其多功能性和普及性，加上微服务的模块化和可扩展性，形成了现代软件开发中完美的搭档。本书旨在连接这两个世界，提供使用 JavaScript 构建、管理和扩展微服务的全面指南。

微服务的兴起已经彻底改变了我们对软件架构的看法。那些主导着市场、提供简单性但以可扩展性和灵活性为代价的单体应用的时代已经过去了。微服务，以其独立、自包含单元的承诺，带来了一种新的开发时代：敏捷、弹性且高度可扩展。然而，权力越大，责任越大，采用微服务架构的挑战不应被低估。

在这本书中，我们将一步步引导你理解并使用 JavaScript 实现微服务的过程。每一章不仅旨在向你介绍理论概念，还提供实际操作指导，这些指导可以帮助你在现实场景中应用。

我们将从微服务简介开始，探讨其核心原则、优势和挑战。从那里，我们将深入研究微服务的内部结构，重点关注构建稳健系统所必需的通信技术和模式。在深入更高级主题，如实时数据流、保护你的微服务和将它们部署到生产环境之前，我们还将涵盖你在 JavaScript 和 Node.js 中需要的基础知识。

这本书不仅关于编写代码，还关于理解那些将允许你构建可扩展、可维护和高效微服务的架构模式和最佳实践。无论你是寻求扩展技能集的资深开发者，还是渴望探索微服务世界的初学者，这本书都是为了你的指导而设计的。

感谢你与我一起踏上这段旅程。我希望这本书不仅能提高你的技术技能，还能激发你探索微服务和 JavaScript 所能达到的极限。

让我们开始吧！

# 这本书面向的对象

本书是为那些渴望使用 JavaScript 进入微服务世界的软件开发者、架构师和 IT 专业人士而设计的。无论你是微服务的新手还是希望增强现有知识，本书都提供了实用的见解和实际经验，帮助你在一个现实世界的环境中构建、管理和扩展微服务。

如果你属于以下任何一个群体，你可能会从这本书中受益：

**JavaScript 开发者**：如果你是一位对将技能扩展到微服务架构感兴趣的 JavaScript 开发者，本书将引导你完成这个过程。你将学习如何将现有的 JavaScript 知识应用于构建可扩展和健壮的微服务，并获得最佳实践、常见挑战和有效解决方案的见解。

**软件架构师**：对于想要设计和实施微服务架构的架构师来说，本书提供了对模式、工具和策略的全面探索。你将学习如何做出明智的决定来构建和部署微服务，确保你的系统既灵活又稳健。

**DevOps 和 IT 专业人士**：如果你参与微服务的部署、监控和维护，本书将为你提供有效管理这些系统的知识。你将深入了解 CI/CD 管道、容器化、编排和监控技术，这些对于在生产环境中运行微服务至关重要。

本书将为你提供所需的实用知识和工具，帮助你成功应对微服务架构的复杂性，使用 JavaScript 定位你在当今快速发展的开发环境中的成功。

# 本书涵盖的内容

*第一章*，*微服务简介*，介绍了微服务架构，探讨了其核心原则，并将微服务定义为专注于特定功能的独立小单元。本章还对比了微服务与传统单体架构，突出了每种方法的优缺点，为本书的其余部分奠定了基础。

*第二章*，*深入微服务内部*，更深入地探讨了微服务的内部运作机制。它涵盖了微服务通信技术，包括 REST、GraphQL 和**远程过程调用**（**RPC**），并解释了同步和异步通信方法。本章还探讨了流行的通信模式，如 API 网关和消息队列，为实际应用提供了必要的理论基础。

*第三章*，*在开始之前你需要什么*，专注于在构建微服务之前你需要了解的 JavaScript 和 Node.js 的基本概念。本章涵盖了 JavaScript 引擎内部结构、异步编程、Node.js 运行环境以及线程和运行时管理在构建有效微服务中的关键作用。

*第四章*, *堆栈开发技术*，介绍了开发和管理使用 JavaScript 的微服务所需的必备工具和技术。这包括对 Node.js 和各种框架的深入探讨，选择合适的 IDE，以及 Docker 和 Git 的安装和使用。本章还涵盖了 Postman，这是在开发过程中测试 API 和与微服务交互的关键工具。

*第五章*, *基本 CRUD 微服务*，通过指导您使用 Express.js 开发第一个微服务来采取实践方法。本章涵盖了所需的工具，微服务的内部架构，以及创建和测试基本**CRUD**（**创建**、**读取/检索**、**更新**、**删除**）微服务的逐步过程，为您更复杂的实现做好准备。

*第六章*, *同步微服务*，探讨了微服务之间同步通信的创建和编排。本章侧重于使用 NestJS 构建第二个微服务，并建立服务之间的通信。

*第七章*, *异步微服务*，深入探讨了异步通信的世界，这是构建可扩展系统的一个关键方面。本章涵盖了 Apache Kafka 的异步消息实现，使用 NestJS 设置 Kafka 的基础设施，并构建异步事务服务。它还分解了 Kafka 的核心概念，并解释了如何将异步通信纳入您的微服务架构。

*第八章*, *使用微服务的实时数据流*，探讨了微服务生态系统中实时数据流的力量。本章涵盖了流的概念、其优势，以及如何使用 Node.js 实现流处理微服务。它还展示了如何将这些服务与 Apache Kafka 集成，以构建实时数据管道。

*第九章*, *保护微服务*，侧重于通过实施强大的身份验证机制来保护微服务的根本方面。本章涵盖了使用 JSON Web Tokens (JWT)进行无状态身份验证，讨论了集中式和去中心化的安全方法，并展示了如何构建专门的认证微服务。此外，还提供了确保您的微服务机密性、完整性和可用性的最佳实践，为安全的微服务架构提供了坚实的基础。

*第十章**，监控微服务*，专注于为您的微服务配备强大的可观察性和监控实践。本章涵盖了在微服务架构中日志和监控的重要性，确保您能够有效地跟踪系统的健康和性能。它介绍了基本的可观察性概念，如日志、指标和跟踪，并探讨了使用 ELK 堆栈（Elasticsearch、Logstash 和 Kibana）的集中式日志。到本章结束时，您将拥有实施日志和监控策略的坚实基础，以保持微服务的弹性和响应性*。

*第十一章*，*微服务架构*，深入探讨了微服务的先进架构模式。本章探讨了**API 网关**、**事件溯源**和**命令查询责任分离**（**CQRS**）模式，以分离读取和写入。

*第十二章*，*测试微服务*，强调了测试在维护微服务稳定性和可靠性中的重要性。本章涵盖了基本的测试策略，包括单元测试和集成测试，确保您的微服务能够承受任何需求并无缝协同工作。

*第十三章*，*为您的微服务构建 CI/CD 流水线*，揭示了通过**持续集成**（**CI**）和**持续交付**（**CD**）自动化微服务开发的过程。本章涵盖了 CI/CD 流程的基本要素，使用 GitHub Actions，构建一个强大的流水线，简化从开发到生产的过渡，并将您的应用程序部署到 Azure 云。

# 为了最大限度地利用本书

为了充分利用本书，您应该具备 JavaScript 和基本编程概念的基础知识。熟悉 Node.js，包括其运行时环境和异步编程模型，将有助于您深入微服务开发。此外，对 Web 开发和 RESTful API 的基本了解将帮助您掌握书中讨论的通信技术和模式。虽然不是强制性的，但具有 Docker、Git 和 CI/CD 流程的经验将增强您跟随后续章节中涵盖的实用示例和部署策略的能力。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Node.js（Windows 版本 v20.12.1） | Windows、macOS 或 Linux |
| Docker Desktop（Windows 版本 4.33.1） | Windows、macOS 或 Linux |
| VS Code（Windows 版本 1.92.2） | Windows、macOS 或 Linux |
| Postman（Windows 版本 11.8） | Windows、macOS 或 Linux |

虽然上述版本针对 Windows，但 Node.js、Docker Desktop、Visual Studio Code 和 Postman 在 macOS 和 Linux 上也能无缝工作。这些操作系统的用户应从官方网站下载它们适当的版本。核心功能在所有操作系统上保持一致，确保无论您的平台如何，都能获得相似的使用体验。

重要提示

如果您使用的是本书的数字版，我们建议您亲自输入代码或从本书的 GitHub 仓库（下一节中提供链接）获取代码。这样做将帮助您避免与代码复制和粘贴相关的任何潜在错误。

为了您的方便，您可以下载源代码以跟随本书的内容。然而，大多数章节也提供了详细的说明，指导您从头开始编写一切，确保您理解每个步骤。

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件[`github.com/PacktPublishing/Hands-on-Microservices-with-JavaScript`](https://github.com/PacktPublishing/Hands-on-Microservices-with-JavaScript)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富图书和视频目录的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“为了跟踪更改，我们将添加`createdAt`和`updatedAt`字段。”

代码块设置如下：

```js
{
    "name":"AccName1",
    "number":"Ac12345",
    "type":"root",
    "status":"new"
}
```

任何命令行输入或输出都应如下所示：

```js
$ cd transactionservice
```

**粗体**：表示新术语、重要单词或您在屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。以下是一个示例：“转到**终端**菜单，选择**新建终端**。”

小贴士或重要提示

看起来是这样的。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请通过电子邮件发送至 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误表**：尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将非常感激您能向我们报告。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上以任何形式遇到我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过 copyright@packtpub.com 与我们联系，并提供材料的链接。

**如果您想成为一名作者**：如果您在某个领域有专业知识，并且对撰写或参与一本书籍感兴趣，请访问 [authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《动手实践 JavaScript 微服务》，我们很乐意听到您的想法！请[点击此处直接进入此书的亚马逊评论页面](https://packt.link/r/1-788-62540-4)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载此书的免费 PDF 副本

感谢您购买此书！

您喜欢在路上阅读，但无法携带您的印刷书籍到处走吗？

您的电子书购买是否与您选择的设备不兼容？

不要担心，现在，随着每本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠不会就此结束，您还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件。

按照以下简单步骤获取好处：

1.  扫描二维码或访问以下链接

![](img/B09148_QR_Free_PDF.jpg)

[`packt.link/free-ebook/978-1-78862-540-1`](https://packt.link/free-ebook/978-1-78862-540-1)

1.  提交您的购买证明

1.  就这些！我们将直接将您的免费 PDF 和其他好处发送到您的电子邮件。

# 第一部分：微服务架构基础

在本部分中，我们将全面了解微服务架构的基础原则和内部运作。我们将探讨微服务是什么，它们与传统单体架构相比如何，以及使微服务成为强大且可扩展解决方案的各种通信技术和模式。此外，我们还将学习开发微服务所必需的 JavaScript 和 Node.js 基本概念。

本部分包含以下章节：

+   *第一章*，*微服务简介*

+   *第二章*，*深入微服务内部*

+   *第三章*，*开始之前你需要什么？*

+   *第四章*，*堆栈开发技术*
