# 前言

我对 Svelte 感到兴奋的是什么？它的简洁、优雅和实用主义设计理念。它在市场上的日益成功表明，其他程序员也有同样的感受。我并不感到惊讶。当我们为 JavaScript 生态系统编写软件时，我们有一个选择：我们可以接受并被其主要组成部分（React、Node.js、webpack、Babel 等）的复杂性所消耗，或者我们可以积极寻找那些旨在简化我们工作的边缘产品和流程。

不会让你感到惊讶的是，我把 **测试驱动开发** (**TDD**) 明确地放在这个第二阵营中。因为没有它，你所拥有的开发工作流程主要就是追逐错误和在大脑中携带大量背景信息。这始终是我认为的 *糟糕的* *旧方法*。

当我年轻时刚开始编程时，我还记得调试时的恼火经历——写一些代码，尝试运行，发现错误，然后挣扎数小时试图找出错误隐藏在我代码中的地方。这看起来像是编程的自然部分：花大量时间进行调试。而且这种情况一直持续到我的第一份工作，作为 C++ 桌面应用程序开发者。（不久我就发现了 TDD 以及它如何帮助我过上更简单、更安静、更平静的生活。）

然后还有当你计划实现下一个新功能的大致设计时所需的思维背景。你必须知道自己在哪里，已经做了什么，接下来是什么，并尽最大努力不偏离轨道。当你被调试和其他干扰所阻碍时，这很困难。

当然，你可以写一个待办事项列表或记日记，但为什么不写一些自动化测试呢？它们不仅能提醒你自己在哪里，还能检查错误。

那就是 TDD 背后的基本理念。

如果你喜欢 Svelte 因为它简化了你的生活，让你感觉像是在水中游泳而不是在泥潭中跋涉，我想你也会喜欢 TDD。这本书展示了如何以及为什么使用 TDD 来学习 Svelte。希望你喜欢它。感谢阅读！

# 这本书面向的对象

如果你是一名 Svelte 程序员，这本书就是为你准备的。我的目标是向你展示 TDD 如何提高你的工作效率。如果你已经对 TDD 比较了解，我希望你还能从比较你自己的流程和我的流程中学到很多东西。

如果你之前不了解 Svelte，但熟悉任何现代前端框架，例如 React，你应该能够跟上并随着学习逐步掌握。TDD 是一个解释新技术的绝佳平台，而且完全有可能你只需通过这本书就能学会 Svelte。

# 这本书涵盖的内容

*第一章*，*为测试做准备*，涵盖了 SvelteKit 包以及配置你的开发环境以使用 Vitest 和 Playwright 测试运行器进行有效的 TDD 工作。

*第二章*, *介绍红-绿-重构工作流程*，展示了基本的 TDD 过程是如何工作的，并讨论了为什么它是有用的。它介绍了 Vitest 测试运行器，用于编写单元测试。

*第三章*, *将数据加载到路由中*，展示了如何使用 TDD 将数据加载到 Svelte 页面组件中。它介绍了 Playwright 测试运行器，用于编写端到端测试。

*第四章*, *保存表单数据*，展示了如何实现一个基本的 HTML 表单及其提交操作。

*第五章*, *验证表单数据*，向在第四章*第四章*中构建的表单中添加表单验证规则。

*第六章*, *编辑表单数据*，展示了如何通过修改表单以在编辑模式下工作来使用 TDD 来演进系统设计。

*第七章*, *整理测试套件*，将重点转向查看更好的测试技术，从查看如何保持测试套件整洁和有序开始。

*第八章*, *创建匹配器以简化测试*，解释了一种管理测试套件复杂性的高级技术：创建和使用期望匹配器函数。

*第九章*, *从框架中提取逻辑*，讨论了如何通过将逻辑移出框架控制的模块来使你的应用程序设计更易于测试。

*第十章*, *测试驱动 API 端点*，探讨了如何使用 TDD 来实现 API 调用。

*第十一章*, *用并排实现替换行为*，展示了即使在面对复杂的重构练习时，TDD 也是如何有用的。

*第十二章*, *使用组件模拟来澄清测试*，介绍了前端自动化测试中最复杂的一部分：组件模拟。

*第十三章*, *添加 Cucumber 测试*，介绍了 Cucumber 测试框架，并展示了它如何应用于 SvelteKit 项目。

*第十四章*, *测试认证*，展示了一种为认证库编写单元测试和端到端测试的方法。

*第十五章*, *测试驱动 Svelte 存储*，简要介绍了如何有效地测试 Svelte 存储。

*第十六章*, *测试驱动服务工作者*，展示了如何使用 SvelteKit 框架编写服务工作者的自动化测试。

# 为了充分利用这本书

阅读这本书有两种方法。

第一种方法是当你面临特定的测试挑战时将其作为参考。使用索引找到你想要的内容，然后转到那一页。

第二种，也是我推荐您从它开始的方法，是逐步跟随教程，在过程中构建自己的代码库。配套的 GitHub 仓库为每个章节（如`Chapter01`）都有一个目录，然后在该目录内，还有两个目录：

+   `开始`，这是章节的起点；如果您正在跟随，应该从这里开始。

+   `完整`，其中包含所有练习的完整解决方案。

您至少需要稍微熟悉`branch`、`checkout`、`clone`、`commit`、`diff`和`merge`命令。

查看 GitHub 仓库中的`README.md`文件以获取更多信息和工作代码库的说明。

**如果您使用的是本书的数字版，我们建议您亲自输入代码或从书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从 GitHub 下载本书的示例代码文件：[`github.com/PacktPublishing/Svelte-with-Test-Driven-Development`](https://github.com/PacktPublishing/Svelte-with-Test-Driven-Development)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还提供了其他丰富的代码包，这些代码包来自我们的书籍和视频目录，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 下载彩色图像

我们还提供了一份 PDF 文件，其中包含本书中使用的截图和图表的彩色图像。您可以从这里下载：[`packt.link/GD8Lg`](https://packt.link/GD8Lg)。

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“我们可以从一个测试开始，指定这个`Birthday`组件将如何使用其`name`属性。”

代码块设置如下：

```js
import { describe, it, expect } from 'vitest';
import {
  render,
  screen
} from '@testing-library/svelte';
import Birthday from './Birthday.svelte';
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```js
describe('Birthday', () => {
  it('displays the name of the person', () => {
    render(Birthday, { name: 'Hercules' });
  });
});
```

任何命令行输入或输出都应如下编写：

```js
mkdir birthdays
cd birthdays
npm create svelte@latest
```

**粗体**：表示新术语、重要单词或您在屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。以下是一个示例：“用户点击**保存**按钮。”

小贴士或重要注意事项

看起来像这样。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：如果您对本书的任何方面有疑问，请通过电子邮件发送至 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误表**: 尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将不胜感激，如果您能向我们报告，我们将非常感谢。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**: 如果您在互联网上以任何形式发现我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过 mailto:copyright@packt.com 与我们联系，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《使用测试驱动开发学习 Svelte》，我们很乐意听听您的想法！请选择[`www.amazon.in/review/create-review/error?asin=1837638330`](https://www.amazon.in/review/create-review/error?asin=1837638330)为此书评分并分享您的反馈。

您的评论对我们和科技社区都非常重要，它将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢在路上阅读，但无法携带您的印刷书籍到处走？

您的电子书购买是否与您选择的设备不兼容？

不要担心，现在，每购买一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠远不止于此，您还可以获得独家折扣、时事通讯和每日免费内容的每日电子邮件。

按照以下简单步骤获取优惠：

1.  扫描二维码或访问以下链接

![](img/B19611_QR_Free_PDF.jpg)

[`packt.link/free-ebook/9781837638338`](https://packt.link/free-ebook/9781837638338)

1.  提交您的购买证明

1.  就这些！我们将直接将您的免费 PDF 和其他优惠发送到您的电子邮件。

# 第一部分：学习 TDD 周期

第一部分介绍了**测试驱动开发**（**TDD**）工作流程，并解释了您如何使用它来构建 Svelte 应用程序。

本部分包含以下章节：

+   *第一章*，*为测试做准备*

+   *第二章*，*介绍红-绿-重构工作流程*

+   *第三章*，*将数据加载到路由中*

+   *第四章*，*保存表单数据*

+   *第五章*，*验证表单数据*

+   *第六章*，*编辑表单数据*
