# 前言

Hello world！《*Node.js 初学者指南*》是一本旨在实现特定目标的书籍：在构建一个真实应用的同时，尽可能快地将你从零基础带到部署，并强化每一章的教训。

Node.js 多年来一直是一种领先的技术，尽管有大量资源可供学习，但本书采取了独特的方法。你在这里获得的知识，即使你决定改变技术栈的部分内容，也将保持相关性。让我现在用一个例子来说明这一点。

在整本书中，我们使用 MongoDB，一个非关系型数据库，来构建我们的项目。如果你更喜欢使用 PostgreSQL 等数据库，可能会想知道如何适应项目。我在写这本书时采取的方法将使这种过渡更加顺畅。你将拥有单元测试和一个清晰的接口来无缝管理这些更改。我专门写了一章来介绍使用 Node.js API 进行测试以及使用第三方库如 *Jest* 或 *supertest*，我们将测试集成作为一个安全网，使我们能够在不担心的情况下重构代码。

我写这本书是从 2024 年的角度出发，思考当我刚开始接触 Node.js 时希望被教授的内容。

本书涵盖了你在构建 Web 应用程序时可能会遇到的各种挑战，从 REST API 设计原则到安全性，以及使用 Docker、持续集成等正确应用分发，等等。

这本书是我过去十年里一直在向学生传授并分享给社区的内容的总结。我希望你会发现阅读这本书像写作时一样愉快。

此外，在每一章的结尾，你都会找到额外的资源，帮助你更深入地探索，并学习对你最相关的概念。

# 本书面向的对象

《*Node.js 初学者指南*》是一本全面介绍，适合那些刚开始接触 Node.js 和/或 Web 应用程序开发的新手，它能让你迅速掌握相关知识。对于那些只想刷新或扩展知识的人来说，这本书也会有所帮助。

本内容的目标受众主要有以下三个角色：

+   任何希望快速学习 Node.js 或想用 Node.js 开发 Web 应用的开发者

+   前端开发者，他们想了解更多关于后端开发的知识，或者想成为使用 Node.js 的全栈开发者

+   已经在日常使用 Node.js 的开发者，并希望扩展或刷新他们在某些领域的知识

# 本书涵盖的内容

*第一章**，Node.js 简介*，介绍了 Node.js 作为运行时环境，并解释了单线程背后的核心架构。它还将涵盖 Node.js 的版本和发布计划。

*第二章**，设置开发环境*，介绍了如何在最流行的操作系统上安装 Node.js，您还将学习如何在同一台机器上管理多个 Node.js 版本。它还将涵盖如何使用 Node.js REPL 和网页浏览器控制台来调试 Node.js 和 JavaScript 应用程序。

*第三章**，JavaScript 基础*，帮助您刷新对 JavaScript 基础知识（如运算符和循环）的了解。您还将学习如何使用特定的 JavaScript 功能，如闭包、提升和原型继承。

*第四章**，异步编程*，教您如何实现回调模式，处理承诺，并使用 Async/Await 语法，您还将学习如何正确地组合所有模式，包括错误处理

*第五章**，Node.js 核心库*，涵盖了核心库的结构，包括 Node.js 二进制的稳定性指数和命令行选项。此外，您还将学习如何使用 ESM 和 CJS 模块化任何代码，以及如何将它们结合起来。

*第六章**，外部模块和 npm*，介绍了如何使用 NPM CLI 管理依赖项，并使用 npx 在不将它们添加到您的项目的情况下使用 CLI 工具。您将学习如何构建可以在 Node.js 和浏览器中执行的等价代码，并将您的第一个包发布到 npm。我们还将讨论 npm 的替代方案，如 Yarn 或 PnPM。

*第七章**，事件驱动架构*，探讨了事件驱动架构如何包含在许多核心库中，如 `fs` 和 `http`。您将创建对文件更改做出反应的应用程序或接收 HTTP 请求的应用程序，并将学习如何在您的模块中包含事件 API 作为 API 层。

*第八章**，Node.js 中的测试*，探讨了在 Node.js 中如何进行测试以及所有可能的方法。我们将使用核心测试库和 Jest 来构建单元测试，并使用覆盖率报告来了解如何改进我们的测试策略。此外，我们还将探讨实际意义上的**测试驱动开发**（**TDD**）方法。

*第九章**，处理 HTTP 和 REST API*，介绍了构建网络应用程序的不同策略（如单页应用和服务器端渲染），以及 HTTP 如何以允许我们构建现代和稳固的 API（带有 HTTP 头部、状态码、有效载荷和版本）的方式进行结构化。我们还将学习如何使用 URL 构建强大的接口，同时在传输数据时使用 JSON 格式。

*第十章**，使用 Express 构建 Web 应用程序*，展示了如何深入使用 Express（请求、响应、重定向、状态码和头部管理），并涵盖了如何使用中间件库以及构建自己的中间件。

*第十一章**，从头开始构建 Web 应用程序项目*，我们将开始我们的项目工作，并使用 supertest 库构建一个受测试的 REST API。该项目将不断发展，我们将迭代项目，添加新功能和新的测试，以便你可以体验使用 Node.js 开发真实世界应用程序的完整开发周期。

*第十二章**，使用 MongoDB 进行数据持久化*，展示了如何设置 MongoDB 以及如何在 Node.js 中处理秘密（.env 文件和环境变量）。我们将使用 Mongoose 探索 ORM 世界，并将项目发展到使用 MongoDB 作为数据库解决方案，包括测试和覆盖率报告。

*第十三章**，使用 Passport.js 进行用户身份验证和授权*，介绍了身份验证和授权之间的区别，并详细探讨了现代网络安全如何基于密码学构建，包括如何工作**JSON Web Tokens** (**JWT**)。我们还将在这个项目中实现我们的中间件，并学习如何使用 Passport.js 来处理社交登录策略。

*第十四章**，Node.js 中的错误处理*，介绍了如何通过正确定义和处理任何类型的错误来使我们的应用程序更具弹性。我们还展示了如何优雅地关闭应用程序并避免生成僵尸进程。

*第十五章**，保护 Web 应用程序*，探讨了社交对项目的影响和攻击向量。我们将探讨 OWASP Top 10、**常见弱点枚举** (**CWE**) 和 **常见漏洞和暴露** (**CVE**) 如何共同评估风险并减轻我们的应用程序中的风险。我们还涵盖了官方 Node.js 安全最佳实践和线程模型。你将有机会通过我们一起构建的项目将这些知识付诸实践，同时探索通过探索道德黑客领域来在这个领域成长的其他方式。

*第十六章**，部署 Node.js 应用程序*，我们将把我们的应用程序部署到公共互联网，强调明确的需求和解决方案选择。我们将使用 GitHub Actions 进行 CI，并使用 DigitalOcean、PM2 和 MongoDB Atlas 作为数据库。

*第十七章**，将 Node.js 应用程序 Docker 化*，我们将使用 Docker 和 DigitalOcean 将我们的应用程序部署到公共互联网。我们还将使用 GitHub Actions 进行持续集成 (CI)。我们将探索域名设置、Cloudflare SSL 和十二要素应用程序原则。

*作者承认使用了尖端的人工智能，如 ChatGPT，其唯一目的是为了提高本书的语言和清晰度，从而确保读者有一个顺畅的阅读体验。重要的是要注意，内容本身是由作者创作的，并由专业的出版团队编辑的。*

# 要充分利用本书

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| JavaScript | Windows、macOS 或 Linux |
| Node.js 和 Node.js 核心库 | Docker |
| Docker | Node.js 20.x |
| npm 包（Express、Mongoose、Passportjs 等） |  |

**如果你使用的是本书的数字版，我们建议你亲自输入代码或从本书的 GitHub 仓库（下一节中提供链接）获取代码。这样做将帮助你避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

你可以从 GitHub（[`github.com/PacktPublishing/NodeJS-for-Beginners`](https://github.com/PacktPublishing/NodeJS-for-Beginners)）下载本书的示例代码文件。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富的图书和视频目录的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 代码实战

本书“代码实战”视频可在[`packt.link/FDJvJ`](https://packt.link/FDJvJ)查看。

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`: 表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“要使用`.nvmrc`文件，你需要在项目的根目录下创建一个名为`.nvmrc`的文件，并指定你想要使用的 Node.js 版本。”

代码块设置如下：

```js
userSchema.pre('save', async function (next) { 
  const user = this 
  if (user.isModified('password')) { 
    const salt = await bcrypt.genSalt() 
    user.password = await bcrypt.hash(user.password, salt)
  } 
  next() 
}) 
```

当我们希望引起你对代码块中特定部分的注意时，相关的行或项目将以粗体显示：

```js
userSchema.pre('save', async function (next) {
  const user = this
  if (user.isModified('password')) {
    const salt = await bcrypt.genSalt()
    user.password = await bcrypt.hash(user.password, salt)
}
 next()
})
```

任何命令行输入或输出都如下所示：

```js
encodeURIComponent('P@ssword') // P%40ssword
```

**粗体**: 表示新术语、重要单词或你在屏幕上看到的单词。例如，菜单或对话框中的单词以粗体显示。以下是一个示例：“通过右键单击页面并点击**检查**来打开 DevTools。”

小贴士或重要注意事项

看起来是这样的。

# 联系我们

我们欢迎读者的反馈。

**一般反馈**: 如果你对本书的任何方面有疑问，请通过电子邮件发送至 customercare@packtpub.com，并在邮件主题中提及书名。

**勘误表**: 尽管我们已经尽一切努力确保内容的准确性，但错误仍然可能发生。如果你在这本书中发现了错误，我们将非常感激你向我们报告。请访问[www.packtpub.com/support/errata](https://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果您在互联网上遇到我们作品的任何形式的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过版权@packt.com 与我们联系，并提供材料的链接。

**如果您想成为一名作者**：如果您在某个领域有专业知识，并且对撰写或参与一本书籍感兴趣，请访问 [authors.packtpub.com](https://authors.packtpub.com)。

# 分享您的想法

读完 *Node.js for Beginners* 后，我们非常乐意听到您的想法！请[点击此处直接进入本书的亚马逊评论页面](https://packt.link/r/1803245174)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

您喜欢随时随地阅读，但无法携带您的印刷书籍到处走？

您的电子书购买是否与您选择的设备不兼容？

请放心，现在，每购买一本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠不会就此结束，您还可以获得独家折扣、时事通讯和每日免费内容的每日访问权限

按照以下简单步骤获取好处：

1.  扫描二维码或访问以下链接

![](img/B21678_QR_Free_PDF.jpg)

[免费电子书](https://packt.link/free-ebook/9781803245171)

2. 提交您的购买证明

3. 就这些！我们将直接将您的免费 PDF 和其他优惠发送到您的电子邮件

# 第一部分：Node.js 概述和 JavaScript 语言

在 *第一部分*，您将了解 Node.js 是如何工作的，以及为什么它是今天用于构建 Web 项目的最受欢迎的工具之一。我们将一起设置开发环境，您将学习 JavaScript 语言的细节以及如何利用其异步编程。

本部分包括以下章节：

+   *第一章*, *Node.js 简介*

+   *第二章*, *设置开发环境*

+   *第三章*, *JavaScript 基础*

+   *第四章*, *异步编程*
