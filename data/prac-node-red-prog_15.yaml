- en: '*Chapter 12*: Developing a Chatbot Application Using Slack and IBM Watson'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第12章*：使用Slack和IBM Watson开发聊天机器人应用程序'
- en: In this chapter, we will create a chatbot application, using Node-RED. For the
    chatbot application UI, we'll use Slack, and we'll use IBM Watson AI for skills.
    After completing the tutorials in this chapter, you will learn how to combine
    Node-RED with an external API to create an application. This will help you create
    extensible web applications with Node-RED in the future.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，我们将使用Node-RED创建一个聊天机器人应用程序。对于聊天机器人应用程序的用户界面，我们将使用Slack，并且我们将使用IBM Watson
    AI来进行技能。完成本章的教程后，您将学会如何将Node-RED与外部API结合起来创建一个应用程序。这将帮助您在未来使用Node-RED创建可扩展的Web应用程序。
- en: 'Let''s get started with the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从以下主题开始：
- en: Creating a Slack workspace
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建Slack工作区
- en: Creating a Watson Assistant API
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建Watson助手API
- en: Enabling a connection to Slack from Node-RED
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从Node-RED启用与Slack的连接
- en: Building a chatbot application
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建聊天机器人应用程序
- en: By the end of this chapter, you will have mastered how to make a Slack chatbot
    application with Node-RED.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章结束时，您将掌握如何使用Node-RED制作Slack聊天机器人应用程序。
- en: Technical requirements
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'To progress in this chapter, you will need the following:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 要在本章中取得进展，您将需要以下内容：
- en: 'An IBM Cloud account: [https://cloud.ibm.com/](https://cloud.ibm.com/).'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IBM Cloud账户：[https://cloud.ibm.com/](https://cloud.ibm.com/)。
- en: The code used in this chapter can be found in `Chapter12` folder at [https://github.com/PacktPublishing/-Practical-Node-RED-Programming](https://github.com/PacktPublishing/-Practical-Node-RED-Programming)
    .
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章使用的代码可以在[https://github.com/PacktPublishing/-Practical-Node-RED-Programming](https://github.com/PacktPublishing/-Practical-Node-RED-Programming)的`Chapter12`文件夹中找到。
- en: Creating a Slack workspace
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建Slack工作区
- en: This hands-on tutorial uses **Slack** as the UI for your chatbot application.
    Node-RED is responsible for controlling the exchange of messages in the background
    of the chatbot application.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 这个实践教程使用**Slack**作为您的聊天机器人应用程序的用户界面。Node-RED负责控制聊天机器人应用程序背后的消息交换。
- en: 'The overall view of this chatbot application is as follows:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 这个聊天机器人应用程序的整体视图如下：
- en: '![Figure 12.1 – Application overview'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.1 – 应用程序概述'
- en: '](img/Figure_12.1_B16353.jpg)'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.1_B16353.jpg)'
- en: Figure 12.1 – Application overview
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.1 – 应用程序概述
- en: 'First of all, create a Slack workspace for use in this application with the
    following steps. If you already have a Slack workspace, you can use your existing
    one. In that case, skip the following steps and create a channel called `learning-node-red`
    in your workspace:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，使用以下步骤为此应用程序创建一个Slack工作区。如果您已经有一个Slack工作区，可以使用现有的工作区。在这种情况下，跳过以下步骤，并在您的工作区中创建一个名为`learning-node-red`的频道：
- en: Access [https://slack.com/create](https://slack.com/create), enter your email
    address, and click the **Next** button:![Figure 12.2 – Enter your email address
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问[https://slack.com/create](https://slack.com/create)，输入您的电子邮件地址，然后点击**下一步**按钮：![图12.2
    – 输入您的电子邮件地址
- en: '](img/Figure_12.2_B16353.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.2_B16353.jpg)'
- en: Figure 12.2 – Enter your email address
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.2 – 输入您的电子邮件地址
- en: Check the six-digit verification code from the email you received from Slack:![Figure
    12.3 – Check the six-digit code
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从Slack收到的电子邮件中检查六位数验证码：![图12.3 – 检查六位数验证码
- en: '](img/Figure_12.3_B16353.jpg)'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.3_B16353.jpg)'
- en: Figure 12.3 – Check the six-digit code
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.3 – 检查六位数验证码
- en: Enter the verification code in the window that is displayed after you click
    **Next** with your email address. After entering your verification code, you will
    be redirected to the next window automatically:![Figure 12.4 – Enter the verification
    code
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您点击**下一步**并输入您的电子邮件地址后显示的窗口中输入验证码。输入验证码后，您将被自动重定向到下一个窗口：![图12.4 – 输入验证码
- en: '](img/Figure_12.4_B16353.jpg)'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.4_B16353.jpg)'
- en: Figure 12.4 – Enter the verification code
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.4 – 输入验证码
- en: Give your workspace a name and click the **Next** button:![Figure 12.5 – Give
    your workspace a name
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 给您的工作区取一个名字，然后点击**下一步**按钮：![图12.5 – 给您的工作区取一个名字
- en: '](img/Figure_12.5_B16353.jpg)'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.5_B16353.jpg)'
- en: Figure 12.5 – Give your workspace a name
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.5 – 给您的工作区取一个名字
- en: Create a channel in your workspace. You can use the `Learning Node-RED`:![Figure
    12.6 – Your workspace name
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的工作区中创建一个频道。您可以使用`Learning Node-RED`：![图12.6 – 您的工作区名字
- en: '](img/Figure_12.6_B16353.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.6_B16353.jpg)'
- en: Figure 12.6 – Your workspace name
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.6 – 您的工作区名字
- en: Click **skip for now** without adding teammates:![Figure 12.7 – No teammates
    are needed for this tutorial
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**暂时跳过**而不添加队友：![图12.7 – 本教程不需要队友
- en: '](img/Figure_12.7_B16353.jpg)'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.7_B16353.jpg)'
- en: Figure 12.7 – No teammates are needed for this tutorial
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.7 – 本教程不需要队友
- en: 'Click **See Your Channel in Slack** to open the workspace you created:'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**在Slack中查看您的频道**打开您创建的工作区：
- en: '![Figure 12.8 – Click See Your Channel in Slack'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.8 – 在Slack中查看您的频道'
- en: '](img/Figure_12.8_B16353.jpg)'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.8_B16353.jpg)'
- en: Figure 12.8 – Click See Your Channel in Slack
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.8 – 在Slack中查看您的频道
- en: 'You have created the workspace for this tutorial:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 您已为本教程创建了工作区：
- en: '![Figure 12.9 – You have created the workspace'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.9 – 您已创建了工作区'
- en: '](img/Figure_12.9_B16353.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.9_B16353.jpg)'
- en: Figure 12.9 – You have created the workspace
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.9 – 您已创建了工作区
- en: Important note
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: The channel on which the chatbot resides should preferably be a channel that
    only you participate in unless you have a public purpose. This is because the
    chatbot's movement can be noisy for participants who do not like (or are not interested
    in) the chatbot.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 聊天机器人所在的频道最好是只有您参与的频道，除非有公共目的。这是因为聊天机器人的活动可能会对不喜欢（或对聊天机器人不感兴趣的）参与者造成干扰。
- en: At this point, you've got your workspace and channels ready to run your chatbot
    in Slack. Next, we will create a mechanism that will be the engine of the chatbot.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，您已经准备好在Slack中运行您的聊天机器人的工作区和频道。接下来，我们将创建一个将成为聊天机器人引擎的机制。
- en: Creating a Watson Assistant API
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建Watson助手API
- en: This hands-on tutorial uses IBM's **Watson Assistant API** as the engine for
    chatbots. Watson Assistant can use natural language analysis to interpret the
    intent and purpose of natural conversation and return an appropriate answer.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 这个实践教程使用IBM的**Watson助手API**作为聊天机器人的引擎。Watson助手可以使用自然语言分析来解释自然对话的意图和目的，并返回适当的答案。
- en: 'Details about Watson Assistant can be found at the following URL: [https://www.ibm.com/cloud/watson-assistant-2/](https://www.ibm.com/cloud/watson-assistant-2/).'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 有关Watson助手的详细信息，请访问以下网址：[https://www.ibm.com/cloud/watson-assistant-2/](https://www.ibm.com/cloud/watson-assistant-2/)。
- en: 'To use the Watson Assistant API, you need to create an instance of the Watson
    Assistant API on IBM Cloud. Follow these steps to create it:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用Watson助手API，您需要在IBM Cloud上创建Watson助手API的实例。按照以下步骤创建它：
- en: Log in to your IBM Cloud dashboard, and search `Assistant` in the **Catalog**.
    Click the **Assistant** tile on the results of your search:![Figure 12.10 – Search
    for Watson Assistant
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到IBM Cloud仪表板，并在**目录**中搜索`助手`。单击搜索结果中的**助手**图块：![图12.10 – 搜索Watson助手
- en: '](img/Figure_12.10_B16353.jpg)'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.10_B16353.jpg)'
- en: Figure 12.10 – Search for Watson Assistant
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.10 – 搜索Watson助手
- en: Create a Watson Assistant API service. Select a **region** for the Watson Assistant
    service data center. Dallas is stable so here we selected **Dallas**.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建Watson助手API服务。为Watson助手服务数据中心选择一个**区域**。达拉斯很稳定，所以我们选择了**达拉斯**。
- en: Select **Lite** for the pricing plan. Other items such as service name and resource
    group can be left at their default values.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**Lite**作为定价计划。其他项目，如服务名称和资源组，可以保留其默认值。
- en: Click the **Create** button:![Figure 12.11 – Create a Watson Assistant service
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击**创建**按钮：![图12.11 – 创建Watson助手服务
- en: '](img/Figure_12.11_B16353.jpg)'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.11_B16353.jpg)'
- en: Figure 12.11 – Create a Watson Assistant service
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.11 – 创建Watson助手服务
- en: Launch the Watson Assistant tool. Click the **Launch Watson Assistant** button
    to open the Watson Assistant console:![Figure 12.12 – Launch the Watson Assistant
    console
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动Watson助手工具。单击**启动Watson助手**按钮打开Watson助手控制台：![图12.12 – 启动Watson助手控制台
- en: '](img/Figure_12.12_B16353.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.12_B16353.jpg)'
- en: Figure 12.12 – Launch the Watson Assistant console
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.12 – 启动Watson助手控制台
- en: Create a **Skill** in your **Watson Assistant** service.
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的**Watson助手**服务中创建一个**技能**。
- en: You will be moved to the **My first skill** screen automatically when you open
    the Watson Assistant console for the first time.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 当您第一次打开Watson助手控制台时，您将自动转到**我的第一个技能**屏幕。
- en: Normally, you would create a Watson Assistant skill here, but this hands-on
    tutorial will focus on Node-RED rather than how to use Watson Assistant. Therefore,
    a skill in Watson Assistant is created by importing the definition file prepared
    in advance.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，您会在这里创建一个Watson助手技能，但是这个实践教程将专注于Node-RED而不是如何使用Watson助手。因此，通过导入预先准备的定义文件在Watson助手中创建一个技能。
- en: 'If you want to create your own skill, that''s fine. In that case, the official
    Watson Assistant documentation will help: [https://cloud.ibm.com/apidocs/assistant/assistant-v2](https://cloud.ibm.com/apidocs/assistant/assistant-v2).'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想创建自己的技能，那很好。在这种情况下，官方的Watson助手文档会帮助您：[https://cloud.ibm.com/apidocs/assistant/assistant-v2](https://cloud.ibm.com/apidocs/assistant/assistant-v2)。
- en: Click `tell me a joke`.
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击`告诉我一个笑话`。
- en: Create an assistant for this frame, set the assistant's name to `Respond Joke
    Phrase`, and click the **Create assistant** button:![Figure 12.14 – Create assistant
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为此框架创建一个助手，将助手的名称设置为`Respond Joke Phrase`，然后单击**创建助手**按钮：![图12.14 – 创建助手
- en: '](img/Figure_12.14_B16353.jpg)'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.14_B16353.jpg)'
- en: Figure 12.14 – Create assistant
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.14 – 创建助手
- en: Import **Dialog**. When your assistant is created, the settings screen of the
    created assistant is displayed. In the **Dialog** area on that settings screen,
    click the **Add dialog skill** button:![Figure 12.15 – Add dialog skill
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入**对话**。创建助手后，将显示所创建助手的设置屏幕。在该设置屏幕上的**对话**区域中，单击**添加对话技能**按钮：![图12.15 – 添加对话技能
- en: '](img/Figure_12.15_B16353.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.15_B16353.jpg)'
- en: Figure 12.15 – Add dialog skill
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.15 – 添加对话技能
- en: Select the **Import skill** tab and select the JSON file for the skill you want
    to import. Download this JSON file at [https://github.com/PacktPublishing/-Practical-Node-RED-Programming/blob/master/Chapter12/skill-Respond-Joke-Phrase.json](https://github.com/PacktPublishing/-Practical-Node-RED-Programming/blob/master/Chapter12/skill-Respond-Joke-Phrase.json).
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**导入技能**选项卡，并选择要导入的技能的JSON文件。在[https://github.com/PacktPublishing/-Practical-Node-RED-Programming/blob/master/Chapter12/skill-Respond-Joke-Phrase.json](https://github.com/PacktPublishing/-Practical-Node-RED-Programming/blob/master/Chapter12/skill-Respond-Joke-Phrase.json)下载此JSON文件。
- en: Click the **Import** button when the JSON file is selected:![Figure 12.16 –
    Import the dialog skill file
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择JSON文件后，单击**导入**按钮：![图12.16 – 导入对话技能文件
- en: '](img/Figure_12.16_B16353.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.16_B16353.jpg)'
- en: Figure 12.16 – Import the dialog skill file
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.16 – 导入对话技能文件
- en: 'You will see **Respond Joke Phrase** in the **Dialog** area:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 您将在**对话**区域看到**Respond Joke Phrase**：
- en: '![Figure 12.17 – Dialog skill imported'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.17 – 导入对话技能'
- en: '](img/Figure_12.17_B16353.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.17_B16353.jpg)'
- en: Figure 12.17 – Dialog skill imported
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.17 – 导入对话技能
- en: 'This completes the skill import. You can return simple greetings and joke phrases,
    so try out the conversation with the **Try it** feature provided in the Watson
    Assistant console:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 技能导入完成。您可以返回简单的问候和笑话短语，因此尝试使用Watson助手控制台中提供的**试一试**功能进行对话：
- en: '![Figure 12.18 – Try it'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.18 – 试一试'
- en: '](img/Figure_12.18_B16353.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.18_B16353.jpg)'
- en: Figure 12.18 – Try it
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.18 – 试一试
- en: 'The chat window will be opened when you click the **Try it** button. Try typing
    the conversation that follows in the chat window:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 单击**试一试**按钮时，将打开聊天窗口。在聊天窗口中尝试输入以下对话：
- en: '`"Hello`*"; "*`Hi";` `"Tell` `me` `jokes";` `"Do` `you` `know` `any` `jokes?"`*;
    and so on…*'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '`"你好`*"; "*`嗨";` `"告诉` `我` `笑话";` `"你` `知道` `笑话吗?"`*; 等等…'
- en: '![Figure 12.19 – Test conversation'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.19 – 测试对话'
- en: '](img/Figure_12.19_B16353.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.19_B16353.jpg)'
- en: Figure 12.19 – Test conversation
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.19 – 测试对话
- en: If you don't get a good answer, try another phrase. Watson Natural Language
    Understanding divides conversations spoken in Watson Assistant's **Try it out**
    window into classes of intents or entities. If a conversation is not divided into
    the desired classes, you can train the Assistant API in the **Try it out** window.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您得不到一个好的答案，请尝试另一个短语。Watson自然语言理解将在Watson助手的**试一试**窗口中说的对话分成意图或实体的类。如果对话没有分成所需的类，您可以在**试一试**窗口中训练助手API。
- en: Now that you've created an auto-answer conversation using Watson Assistant,
    there's one more thing to do, that is, confirmation of the Skill ID. This is the
    ID you will need later to operate Watson Assistant as an API from Node-RED.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经使用Watson Assistant创建了自动回答对话，还有一件事要做，那就是确认技能ID。这是您以后需要从Node-RED操作Watson
    Assistant作为API所需的ID。
- en: 'Check the Skill ID from the **Skills** screen by following these steps:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 通过以下步骤从**技能**屏幕检查技能ID：
- en: Click **View API Details** under the **Skills** menu at the top right of the
    **Skill** tile you created:![Figure 12.20 – Access the View API Details menu
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您创建的**技能**瓦片的右上角的**技能**菜单下点击**查看API详细信息**：![图12.20 - 访问查看API详细信息菜单
- en: '](img/Figure_12.20_B16353.jpg)'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.20_B16353.jpg)'
- en: Figure 12.20 – Access the View API Details menu
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.20 - 访问查看API详细信息菜单
- en: 'Make a note of the **Skill ID** displayed:'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记下显示的**技能ID**：
- en: '![Figure 12.21 – Check and note the Skill ID'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.21 - 检查并记录技能ID'
- en: '](img/Figure_12.21_B16353.jpg)'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.21_B16353.jpg)'
- en: Figure 12.21 – Check and note the Skill ID
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.21 - 检查并记录技能ID
- en: We have now created a chatbot service that automatically responds to chats.
    Next, let's integrate this with the Slack user interface.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经创建了一个自动回复聊天的聊天机器人服务。接下来，让我们将其与Slack用户界面集成。
- en: Enabling the connection to Slack from Node-RED
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 启用从Node-RED到Slack的连接
- en: Next, let's move on to the preparation of a Slack node on your Node-RED environment.
    Launch the Node-RED flow editor created on IBM Cloud.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，让我们继续在您的Node-RED环境中准备一个Slack节点。启动在IBM Cloud上创建的Node-RED流程编辑器。
- en: What you do in this step is to install a node to connect to Slack in your Node-RED
    environment. The method is easy. All you have to do is find and install the node
    from the **Manage palette** window, which you've done several times in other chapters.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一步中，您要做的是在您的Node-RED环境中安装一个连接到Slack的节点。这种方法很简单。您所要做的就是在**管理调色板**窗口中找到并安装节点，这在其他章节中已经做过多次。
- en: 'Follow these steps to proceed:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤继续：
- en: Important note
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: I believe that the Node-RED flow editor on your IBM Cloud has already been created
    as a service (as a Node.js application), but if you haven't done so already, refer
    to [*Chapter 6*](B16353_06_ePub_AM.xhtml#_idTextAnchor073)*, Implementing Node-RED
    in the Cloud*, to create a Node-RED service on IBM Cloud, before proceeding with
    this chapter.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 我相信您在IBM Cloud上的Node-RED流程编辑器已经作为服务（作为Node.js应用程序）创建好了，但如果您还没有这样做，请参考[*第6章*](B16353_06_ePub_AM.xhtml#_idTextAnchor073)*，在云中实现Node-RED*，在继续本章之前在IBM
    Cloud上创建一个Node-RED服务。
- en: You need to install the **node-red-contrib-slack** node to use Slack from Node-RED,
    so click **Manage palette**:![Figure 12.22 – Open the Manage palette window
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您需要安装**node-red-contrib-slack**节点才能从Node-RED中使用Slack，因此点击**管理调色板**：![图12.22
    - 打开管理调色板窗口
- en: '](img/Figure_12.22_B16353.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.22_B16353.jpg)'
- en: Figure 12.22 – Open the Manage palette window
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.22 - 打开管理调色板窗口
- en: Search the `node-red-contrib-slack` node and click the **Install** button:![Figure
    12.23 – Install the node-red-contrib-slack node
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 搜索`node-red-contrib-slack`节点并点击**安装**按钮：![图12.23 - 安装node-red-contrib-slack节点
- en: '](img/Figure_12.23_B16353.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.23_B16353.jpg)'
- en: Figure 12.23 – Install the node-red-contrib-slack node
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.23 - 安装node-red-contrib-slack节点
- en: You will see four nodes that belong to **node-red-contrib-slack** on your palette.
    You have to prepare Slack nodes for building this sample application:![Figure
    12.24 – Slack nodes will appear on your palette
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将在调色板上看到属于**node-red-contrib-slack**的四个节点。您必须为构建此示例应用程序准备Slack节点：![图12.24 -
    Slack节点将出现在您的调色板上
- en: '](img/Figure_12.24_B16353.jpg)'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.24_B16353.jpg)'
- en: Figure 12.24 – Slack nodes will appear on your palette
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.24 - Slack节点将出现在您的调色板上
- en: Make a bot in your Slack workspace by accessing the **Slack App Directory**
    via **Settings & administration** | **Manage apps** on your Slack application
    (desktop or web):![Figure 12.25 – Select Manage apps
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在Slack应用程序（桌面或Web）上通过**设置和管理** | **管理应用**访问**Slack App目录**，在您的Slack工作区中创建一个机器人：![图12.25
    - 选择管理应用
- en: '](img/Figure_12.25_B16353.jpg)'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.25_B16353.jpg)'
- en: Figure 12.25 – Select Manage apps
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.25 - 选择管理应用
- en: After moving to the Slack App Directory website, click the `https://<your workspace>.slack.com/apps`.
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移动到Slack App目录网站后，点击`https://<your workspace>.slack.com/apps`。
- en: 'The following URL is just an example: [https://packtnode-red.slack.com/apps](https://packtnode-red.slack.com/apps).'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 以下URL仅供参考：[https://packtnode-red.slack.com/apps](https://packtnode-red.slack.com/apps)。
- en: This URL is generated automatically depending on each workspace name on Slack.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 此URL根据Slack上每个工作区的名称自动生成。
- en: Click the **Get Essential Apps** button to move to the application search window:![Figure
    12.27 – Click the Get Essential Apps button
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**获取基本应用程序**按钮，转到应用程序搜索窗口：![图12.27 - 点击获取基本应用程序按钮
- en: '](img/Figure_12.27_B16353.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.27_B16353.jpg)'
- en: Figure 12.27 – Click the Get Essential Apps button
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.27 - 点击获取基本应用程序按钮
- en: Search the word `bots` and click **Bots** on the results:![Figure 12.28 – Search
    for Bots and select it
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 搜索单词`bots`并点击结果中的**Bots**：![图12.28 - 搜索Bots并选择它
- en: '](img/Figure_12.28_B16353.jpg)'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.28_B16353.jpg)'
- en: Figure 12.28 – Search for Bots and select it
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.28 - 搜索Bots并选择它
- en: Click the **Add to Slack** button on the **Bots** app screen:![Figure 12.29
    – Add the Bots app to your workspace
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**Bots**应用程序屏幕上点击**添加到Slack**按钮：![图12.29 - 将Bots应用添加到您的工作区
- en: '](img/Figure_12.29_B16353.jpg)'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.29_B16353.jpg)'
- en: Figure 12.29 – Add the Bots app to your workspace
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.29 - 将Bots应用添加到您的工作区
- en: Set the `packt-bot`.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置`packt-bot`。
- en: Click the **Add bot integration** button:![Figure 12.30 – Set your bot name
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加机器人集成**按钮：![图12.30 - 设置您的机器人名称
- en: '](img/Figure_12.30_B16353.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.30_B16353.jpg)'
- en: Figure 12.30 – Set your bot name
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.30 – 设置您的机器人名称
- en: 'On the next screen, the API token for using the bot will be generated and displayed.
    Make a note of this so that you do not forget it. This API token is used when
    creating a flow with Node-RED:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一个屏幕上，将生成并显示用于使用机器人的API令牌。记下这个令牌，以免忘记。创建Node-RED流程时会使用这个API令牌：
- en: Important note
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: Be careful when sharing bot user tokens with applications. Do not publish bot
    user tokens in public code repositories. This is because anyone can access the
    bot with this API token.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在与应用程序共享机器人用户令牌时要小心。不要在公共代码存储库中发布机器人用户令牌。这是因为任何人都可以使用这个API令牌访问机器人。
- en: '![Figure 12.31 – Confirm your API token'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.31 – 确认您的API令牌'
- en: '](img/Figure_12.31_B16353.jpg)'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.31_B16353.jpg)'
- en: Figure 12.31 – Confirm your API token
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.31 – 确认您的API令牌
- en: 'Click the **Save Integration** button to finish the bot app integration:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存集成**按钮完成Bot应用程序的集成：
- en: '![Figure 12.32 – Bot app integration is finished'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.32 – Bot应用程序集成完成'
- en: '](img/Figure_12.32_B16353.jpg)'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.32_B16353.jpg)'
- en: Figure 12.32 – Bot app integration is finished
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.32 – Bot应用程序集成完成
- en: Now you are ready. Let's move on to the flow creation procedure.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经准备好了。让我们继续进行流程创建过程。
- en: Building a chatbot application
  id: totrans-147
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建一个聊天机器人应用程序
- en: So far, you've created a chatbot engine in Watson Assistant, created a Slack
    workspace, and integrated the Bot app, which you can use in that Slack workspace.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，您已经在Watson助手中创建了一个聊天机器人引擎，创建了一个Slack工作区，并集成了Bot应用程序，您可以在该Slack工作区中使用。
- en: Here, we will combine these services with Node-RED and create a mechanism with
    Node-RED so that the bot will answer when talking in Slack's workspace.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将把这些服务与Node-RED结合起来，并创建一个机制，使得在Slack工作区中说话时，机器人会在Node-RED中回答。
- en: 'Follow these steps to create a flow:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤创建一个流程：
- en: Connect Watson Assistant to Node-RED. Access your Node-RED service dashboard
    via **Resource list** on IBM Cloud. Select the **Connections** tab and click the
    **Create connection** button:![Figure 12.33 – Create a new connection on Node-RED
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Watson助手连接到Node-RED。通过IBM Cloud上的**资源列表**访问您的Node-RED服务仪表板。选择**连接**选项卡，然后点击**创建连接**按钮：![图12.33
    – 在Node-RED上创建新连接
- en: '](img/Figure_12.33_B16353.jpg)'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.33_B16353.jpg)'
- en: Figure 12.33 – Create a new connection on Node-RED
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.33 – 在Node-RED上创建新连接
- en: Select the Watson Assistant service you created and click the **Next** button:![Figure
    12.34 – Create a new connection on Node-RED
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择您创建的Watson助手服务，然后点击**下一步**按钮：![图12.34 – 在Node-RED上创建新连接
- en: '](img/Figure_12.34_B16353.jpg)'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.34_B16353.jpg)'
- en: Figure 12.34 – Create a new connection on Node-RED
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.34 – 在Node-RED上创建新连接
- en: Click the **Connect** button with the default options to finish the connection
    setup. Doing this operation will restart the Node-RED application, which will
    take a few minutes to complete:![Figure 12.35 – Finish creating the new connection
    on Node-RED
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**连接**按钮，使用默认选项完成连接设置。执行此操作将重新启动Node-RED应用程序，这将需要几分钟来完成：![图12.35 – 完成在Node-RED上创建新连接
- en: '](img/Figure_12.35_B16353.jpg)'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.35_B16353.jpg)'
- en: Figure 12.35 – Finish creating the new connection on Node-RED
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.35 – 完成在Node-RED上创建新连接
- en: Make the flow to handle conversations on Slack.
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建处理Slack上对话的流程。
- en: You already have Slack nodes and Watson nodes that are available to use for
    this hands-on tutorial.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 您已经有了Slack节点和Watson节点，可以在这个实践教程中使用。
- en: Place a **slack-rtm-in** node, two **function** nodes, an **assistant** node,
    **slack-rtm-out**, and a **debug** node. After placing them, wire them sequentially
    as in the following figure:![Figure 12.36 – Place the nodes and wire them
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 放置一个**slack-rtm-in**节点，两个**function**节点，一个**assistant**节点，**slack-rtm-out**和一个**debug**节点。放置它们后，按照以下图示将它们依次连接起来：![图12.36
    – 放置节点并连接它们
- en: '](img/Figure_12.36_B16353.jpg)'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.36_B16353.jpg)'
- en: Figure 12.36 – Place the nodes and wire them
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.36 – 放置节点并连接它们
- en: Set the parameters for each node.
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为每个节点设置参数。
- en: 'Follow this procedure to set the parameters on each node. For the nodes that
    need to be coded, code them as follows:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤设置每个节点的参数。对于需要编码的节点，请按照以下方式进行编码：
- en: 'The **slack-rtm-in** node:'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**slack-rtm-in**节点：'
- en: 'a) Click the edit button (pencil icon) to open the **Properties** panel:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: a) 点击编辑按钮（铅笔图标）打开**属性**面板：
- en: '![Figure 12.37 – Open the Properties panel'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.37 – 打开属性面板'
- en: '](img/Figure_12.38_B16353.jpg)'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.38_B16353.jpg)'
- en: Figure 12.37 – Open the Properties panel
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.37 – 打开属性面板
- en: 'b) Enter the `packt-bot`:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: b) 输入`packt-bot`：
- en: '![Figure 12.38 – Set the properties of the configuration to connect the Slack
    app'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.38 – 设置连接Slack应用程序的配置属性'
- en: '](img/Figure_12.39_B16353.jpg)'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.39_B16353.jpg)'
- en: Figure 12.38 – Set the properties of the configuration to connect the Slack
    app
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.38 – 设置连接Slack应用程序的配置属性
- en: When you go back to the main panel of this node, you will see the configuration
    has been set in the **Slack Client** property.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 当您返回到此节点的主面板时，您会看到**Slack客户端**属性中的配置已经设置。
- en: 'c) Click the **Done** button to close this setting:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: c) 点击**完成**按钮关闭此设置：
- en: '![Figure 12.39 – Finish setting the properties of the slack-rtm-in node'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.39 – 完成设置slack-rtm-in节点的属性'
- en: '](img/Figure_12.39_B163531.jpg)'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.39_B163531.jpg)'
- en: Figure 12.39 – Finish setting the properties of the slack-rtm-in node
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.39 – 完成设置slack-rtm-in节点的属性
- en: 'The **function** node (first one):'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**function**节点（第一个）：'
- en: 'a) In the first **function** node, enter the following:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: a) 在第一个**function**节点中，输入以下内容：
- en: '[PRE0]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'You can also refer to the following figure:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以参考以下图示：
- en: '![Figure 12.40 – First function node coding'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.40 – 第一个function节点编码'
- en: '](img/Figure_12.40_B16353.jpg)'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.40_B16353.jpg)'
- en: Figure 12.40 – First function node coding
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.40 – 第一个function节点编码
- en: In this function node, the message that is posted on Slack is taken out from
    the JSON data sent from Slack and put in `msg.payload` again.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个function节点中，从Slack发送的消息被从Slack发送的JSON数据中取出，并再次放入`msg.payload`中。
- en: Another important process is to store the channel information sent from Slack
    in the Global variable in Node-RED. The channel information stored here will be
    used later when sending a response message back to Slack.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个重要的过程是将从Slack发送的频道信息存储在Node-RED的全局变量中。这里存储的频道信息将在稍后向Slack发送响应消息时使用。
- en: 'The **assistant** node:'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**助手**节点：'
- en: In the previous step, you connected Watson Assistant to Node-RED. This means
    that you can call the Assistant API from Node-RED without using an API key or
    secret.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一步中，您将Watson助手连接到了Node-RED。这意味着您可以从Node-RED调用助手API，而无需使用API密钥或密码。
- en: When I double-click the **assistant** node to open the settings panel, I don't
    see any properties such as API keys. If you see them in your settings panel, it
    means that the Watson Assistant and Node-RED connection process is failing. In
    that case, perform the connection process again.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 当我双击**助手**节点以打开设置面板时，我没有看到任何属性，比如API密钥。如果您在设置面板中看到它们，这意味着Watson助手和Node-RED连接过程失败了。在这种情况下，请重新执行连接过程。
- en: 'There is only one property to set here. Set the Watson Assistant Skill ID you
    wrote down earlier as the **Workspace ID** property in the **assistant** node''s
    settings panel:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 这里只有一个属性需要设置。在**assistant**节点的设置面板中，将您之前写下的Watson助手技能ID设置为**工作区ID**属性：
- en: '![Figure 12.41 – Set the Skill ID as the Workspace ID'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.41 - 将技能ID设置为工作区ID'
- en: '](img/Figure_12.41_B16353.jpg)'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.41_B16353.jpg)'
- en: Figure 12.41 – Set the Skill ID as the Workspace ID
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.41 - 将技能ID设置为工作区ID
- en: This completes the settings for the **assistant** node. Save your settings and
    close the settings panel.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 这完成了**助手**节点的设置。保存您的设置并关闭设置面板。
- en: 'The **function** node (the second one):'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**功能**节点（第二个节点）：'
- en: 'In the first **function** node, enter the following code:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一个**功能**节点中，输入以下代码：
- en: '[PRE1]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'You can also refer to the following figure:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以参考以下图：
- en: '![Figure 12.42 – Second function node coding'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.42 - 第二个功能节点编码'
- en: '](img/Figure_12.42_B16353.jpg)'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.42_B16353.jpg)'
- en: Figure 12.42 – Second function node coding
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.42 - 第二个功能节点编码
- en: The second function node stores the autoresponder message returned from Watson
    Assistant in `msg.payload.text`, and gets the Slack channel information saved
    in the first function node and stores it in `msg.payload.channel`.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个功能节点将Watson助手返回的自动回复消息存储在`msg.payload.text`中，并获取保存在第一个功能节点中的Slack频道信息，并将其存储在`msg.payload.channel`中。
- en: 'The `packt-bot` you created is already placed in this node property. If it
    is not set yet, please select it from the drop-down list manually. Once you click
    on **Done**, the settings will be complete:'
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您创建的`packt-bot`已经放置在此节点属性中。如果尚未设置，请从下拉列表中手动选择。单击**完成**后，设置将完成：
- en: '![Figure 12.43 – Check the property settings of the slack-rtm-out node'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.43 - 检查slack-rtm-out节点的属性设置'
- en: '](img/Figure_12.43_B16353.jpg)'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.43_B16353.jpg)'
- en: Figure 12.43 – Check the property settings of the slack-rtm-out node
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.43 - 检查slack-rtm-out节点的属性设置
- en: 'The **debug** node:'
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**调试**节点：'
- en: The debug node here simply outputs the log. No settings are required.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的调试节点只是简单地输出日志。不需要设置。
- en: Check the bot application on Slack.
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Slack上检查机器人应用。
- en: An auto-answer chatbot has been created using Slack. Let's try the conversation.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Slack创建了一个自动回答聊天机器人。让我们尝试对话。
- en: On the channel you created in your Slack workspace, add the bot app you integrated
    and click the **Add an app** link on the channel:![Figure 12.44 – Click the Add
    an app link
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的Slack工作区创建的频道上，添加您集成的机器人应用程序，并单击频道上的**添加应用**链接：![图12.44 - 单击添加应用链接
- en: '](img/Figure_12.44_B16353.jpg)'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.44_B16353.jpg)'
- en: Figure 12.44 – Click the Add an app link
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.44 - 单击添加应用链接
- en: 'Click the **Add** button to add the bot app to your channel:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击**添加**按钮将机器人应用添加到您的频道中：
- en: '![Figure 12.45 – Add the bot app you created'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.45 - 添加您创建的机器人应用'
- en: '](img/Figure_12.45_B16353.jpg)'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.45_B16353.jpg)'
- en: Figure 12.45 – Add the bot app you created
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.45 - 添加您创建的机器人应用
- en: Now, let's actually have a conversation. Mention and talk to your bot (`packt-bot`
    in the example) on the channel where you added this bot app. Since the only conversations
    we are learning with Watson Assistant this time are greetings and listening to
    jokes, we will send a message from Slack that seems to be related to either of
    these.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们真正进行一次对话。在您添加了这个机器人应用的频道上提及并与您的机器人（例如`packt-bot`）交谈。由于我们这次学习的唯一对话是问候和听笑话，我们将从Slack发送一条看起来与这两者之一相关的消息。
- en: 'First, let''s say Hello. You will see a greeting kind of response:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们打个招呼。您将看到一种问候的回应：
- en: '![Figure 12.46 – Exchanging greetings with the chatbot'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.46 - 与聊天机器人交换问候'
- en: '](img/Figure_12.46_B16353.jpg)'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.46_B16353.jpg)'
- en: Figure 12.46 – Exchanging greetings with the chatbot
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.46 - 与聊天机器人交换问候
- en: 'Then send a message like `Please` `tell` `me` `a` `joke`. It randomly responds
    with a bot-selected joke as a reply:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 然后发送一条消息，比如`请` `告诉` `我` `一个` `笑话`。它会随机回复一个机器人选定的笑话：
- en: '![Figure 12.47 – The chatbot answers some jokes'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '![图12.47 - 机器人回答一些笑话'
- en: '](img/Figure_12.47_B16353.jpg)'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_12.47_B16353.jpg)'
- en: Figure 12.47 – The chatbot answers some jokes
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.47 - 机器人回答一些笑话
- en: Great work! You finally made the chatbot application with Node-RED.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 干得好！您终于用Node-RED创建了聊天机器人应用。
- en: 'If you want the flow configuration file to make this flow in your Node-RED
    environment, you can get it here: [https://github.com/PacktPublishing/-Practical-Node-RED-Programming/blob/master/Chapter12/slack-watson-chatbot-flows.json](https://github.com/PacktPublishing/-Practical-Node-RED-Programming/blob/master/Chapter12/slack-watson-chatbot-flows.json).'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望在Node-RED环境中创建此流程的流程配置文件，可以在此处获取：[https://github.com/PacktPublishing/-Practical-Node-RED-Programming/blob/master/Chapter12/slack-watson-chatbot-flows.json](https://github.com/PacktPublishing/-Practical-Node-RED-Programming/blob/master/Chapter12/slack-watson-chatbot-flows.json)。
- en: Summary
  id: totrans-232
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we experienced how to make a chatbot application with Slack,
    Watson, and Node-RED. This time, we used Slack as a chat platform, but you can
    use any chat platforms that have APIs, such as LINE, Microsoft Teams, and so on,
    instead of Slack.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们体验了如何使用Slack、Watson和Node-RED制作聊天机器人应用程序。这次，我们使用Slack作为聊天平台，但您可以使用任何具有API的聊天平台，例如LINE、Microsoft
    Teams等，而不是Slack。
- en: This chapter is also very helpful for creating any applications that are not
    IoT-based. Node-RED can develop various applications by linking with any Web API.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 本章对于创建任何非物联网应用程序也非常有帮助。Node-RED可以通过与任何Web API链接来开发各种应用程序。
- en: In the next chapter, let's develop our own node. Of course, it can be used in
    any environment. Developing your own node with Node-RED means developing a new
    node that cannot be done with the existing nodes. This is surely the first step
    for advanced users of Node-RED.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，让我们开发自己的节点。当然，它可以在任何环境中使用。使用Node-RED开发自己的节点意味着开发一个无法通过现有节点完成的新节点。这无疑是Node-RED高级用户的第一步。
