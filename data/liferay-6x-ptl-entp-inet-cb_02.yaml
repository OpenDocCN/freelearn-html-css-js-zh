- en: Chapter 2. Authentication and Registration Process
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二章. 认证和注册流程
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Changing the default authentication settings
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 修改默认认证设置
- en: Setting up e-mail notifications
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置电子邮件通知
- en: Customizing the registration form
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自定义注册表单
- en: Overriding the default login page with the administrator-defined page
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用管理员定义的页面覆盖默认登录页面
- en: Setting up a password policy
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置密码策略
- en: Integration with CAS SSO
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与CAS SSO集成
- en: CAS and Liferay users' database
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CAS和Liferay用户数据库
- en: Liferay and the LDAP integration
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Liferay和LDAP集成
- en: 'The magic trio: Liferay, CAS, and LDAP'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 神奇的三重奏：Liferay、CAS和LDAP
- en: Introduction
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: The authentication and registration processes are very important to build intranet
    systems. In this type of software, it is necessary to protect data against non-authorized
    users. We decided to describe typical solutions that are commonly used in many
    projects. It will help you configure the out-of-the box authentication system
    in Liferay and define the password policy. You will also learn about integration
    with the most popular single sign-on mechanism (SSO). The purpose of an SSO is
    to permit a user to access multiple applications while providing their credentials
    only once. The **Central Authentication Service** (**CAS**) is a single sign-on
    protocol for the Web. It is also a software package that implements this protocol.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 认证和注册流程对于构建内部网络系统非常重要。在这种类型的软件中，必须保护数据免受未经授权的用户访问。我们决定描述在许多项目中常用的典型解决方案。这将帮助您配置Liferay的即用型认证系统并定义密码策略。您还将了解与最流行的单点登录机制（SSO）的集成。SSO的目的是允许用户一次提供凭证即可访问多个应用程序。**中央认证服务**（**CAS**）是Web的单点登录协议。它也是一个实现此协议的软件包。
- en: Changing the default authentication settings
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 修改默认认证设置
- en: Liferay provides a built-in authentication mechanism that, by default, allows
    users to log in using their e-mail address. Additionally, there are a number of
    functionalities, such as automatic log in or forgotten password functionality,
    that assist users and help them go through the authentication process. However,
    in some cases, the standard authentication behavior must be modified.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: Liferay提供了一个内置的认证机制，默认情况下允许用户使用他们的电子邮件地址登录。此外，还有一些功能，如自动登录或忘记密码功能，这些功能可以帮助用户并帮助他们完成认证过程。然而，在某些情况下，必须修改标准的认证行为。
- en: Getting ready
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Log in to Liferay as a user with administrator credentials. By default, the
    credentials are as follows:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 使用管理员凭证登录Liferay。默认情况下，凭证如下：
- en: '**E-mail**: test@liferay.com'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电子邮件**：test@liferay.com'
- en: '**Password**: test'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码**：test'
- en: How to do it…
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'In order to change the default authentication settings, perform the following
    steps:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 为了修改默认认证设置，请执行以下步骤：
- en: Log in as an administrator and go to **Admin** | **Control Panel** | **Configuration**
    | **Portal Settings** | **Authentication section**:![How to do it…](img/image00299.jpeg)
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以管理员身份登录，然后转到**管理** | **控制面板** | **配置** | **门户设置** | **认证部分**：![如何操作…](img/image00299.jpeg)
- en: Make sure that you are in the **General** tab.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保您在**常规**选项卡上。
- en: Choose the option that you prefer from the **Authentication type** drop-down
    list.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**认证类型**下拉列表中选择您喜欢的选项。
- en: Enable/disable the **Allow users to automatically login?** option.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**允许用户自动登录？**选项。
- en: Enable/disable the **Allow users to request forgotten passwords?** option.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**允许用户请求忘记密码？**选项。
- en: Enable/disable the **Allow users to request password reset links?** option.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**允许用户请求密码重置链接？**选项。
- en: Enable/disable the **Allow strangers to create accounts?** option.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**允许陌生人创建账户？**选项。
- en: Enable/disable the **Allow strangers to create accounts with a company email
    address?** option.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**允许陌生人使用公司电子邮件地址创建账户？**选项。
- en: Enable/disable the **Require strangers to verify their email address?** option.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**要求陌生人验证他们的电子邮件地址？**选项。
- en: Click on the **Save** button.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: 'In order to set only the authentication type for a particular instance of the
    **Sign in** portlet, you do not need to perform the additional steps in the **Control
    Panel** scope. In this case, it is enough to change the configuration in the Sign
    in portlet. Perform these steps:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 为了仅设置**登录**小部件特定实例的认证类型，您不需要在**控制面板**范围内执行额外的步骤。在这种情况下，只需更改登录小部件的配置即可。执行以下步骤：
- en: Go to the public page on which the **Sign in** portlet should be placed.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往放置**登录**小部件的公共页面。
- en: Click on the **Add** button.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加**按钮。
- en: Click on the **Applications** button.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**应用程序**按钮。
- en: Find the **Sign in** portlet using the search option or by browsing the list
    of available portlets.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用搜索选项或通过浏览可用小部件列表找到**登录**小部件。
- en: Click on the **Add** link next to the portlet name. The **Sign in** portlet
    with basic configuration will be added to the page.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击小部件名称旁边的**添加**链接。带有基本配置的**登录**小部件将被添加到页面上。
- en: Go to the **Sign in** portlet configuration.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往**登录**小部件配置。
- en: Choose the option that you prefer from the **Authentication type** list.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**身份验证类型**列表中选择您喜欢的选项。
- en: Click on the **Save** button.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: How it works…
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: 'In Liferay Portal, a user can be authenticated by their e-mail address, a screen
    name or a numerical sequence, or an auto-generated user ID. There are two places
    that allow you to set the preferred authentication method: the portal settings
    section and the configuration screen of the Sign in portlet. The Control Panel
    settings enable you to define the default authentication type. This setting can
    also be modified by the properties in `portal-ext.properties`:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在Liferay门户中，用户可以通过电子邮件地址、屏幕名称或数字序列，或自动生成的用户ID进行身份验证。有两个地方允许您设置首选的身份验证方法：门户设置部分和登录小部件的配置屏幕。控制面板设置允许您定义默认的身份验证类型。此设置也可以通过`portal-ext.properties`中的属性进行修改：
- en: '[PRE0]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Tip
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: Remember that more important configuration comes from GUI (Control Panel) than
    from `portal-ext.properties`.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，比`portal-ext.properties`更重要的是来自GUI（控制面板）的配置。
- en: However, the Sign in portlet configuration option allows you to decide which
    way of authentication will be used for a particular Sign in portlet. Within the
    portlet, it is possible to choose the *default* option or one of the three available
    options, described previously. The default option is the same as the `company.security.auth.type`
    property.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，登录小部件配置选项允许您决定特定登录小部件将使用哪种身份验证方式。在小部件内部，可以选择**默认**选项或之前描述的三个可用选项之一。默认选项与`company.security.auth.type`属性相同。
- en: In addition to selecting the **Authentication** type, Liferay also allows you
    to set additional parameters that influence the authorization and authentication
    processes. By default, all options, except the **Require strangers to verify their
    email address?** option, are enabled.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 除了选择**身份验证**类型外，Liferay还允许您设置影响授权和身份验证过程的其他参数。默认情况下，除了**要求陌生人验证他们的电子邮件地址？**选项外，所有选项都启用。
- en: 'The **Allow users to automatically login?** option allows you to decide whether
    the site should remember the user''s login and show the **Remember me** checkbox
    within the **Sign in** form. This option can be enabled (true) or disabled (false)
    by setting the following properties:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '**允许用户自动登录？**选项允许您决定网站是否应该记住用户的登录信息，并在**登录**表单中显示**记住我**复选框。此选项可以通过设置以下属性来启用（true）或禁用（false）：'
- en: '[PRE1]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The **Allow users to request forgotten passwords?** option is responsible for
    enabling or disabling the forgotten password functionality. This functionality
    makes it possible for users to request for a new password to be sent to their
    e-mail addresses. By default, this option is enabled in the following properties:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '**允许用户请求忘记的密码？**选项负责启用或禁用忘记密码功能。此功能使得用户可以请求将新密码发送到他们的电子邮件地址。默认情况下，此选项在以下属性中启用：'
- en: '[PRE2]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The **Allow users to request password reset links?** option is responsible
    for enabling or disabling the reset password functionality. This functionality
    allows users to request for a password reset link to be sent to their e-mail addresses.
    This option is represented by the following properties:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '**允许用户请求密码重置链接？**选项负责启用或禁用重置密码功能。此功能允许用户请求将密码重置链接发送到他们的电子邮件地址。此选项由以下属性表示：'
- en: '[PRE3]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The **Allow strangers to create accounts?** option is responsible for the availability
    of the link to create an account. This option lets you decide whether users who
    are guests to the site are allowed to create accounts by themselves. By default,
    it is enabled as follows:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '**允许陌生人创建账户？**选项负责创建账户链接的可用性。此选项让您决定网站访客是否可以自行创建账户。默认情况下，它如下启用：'
- en: '[PRE4]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The **Allow strangers to create accounts with a company email address?** option
    allows you to decide whether a new account can be created using the e-mail address
    in the domain provided in the General section of the Portal settings:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '**允许陌生人使用公司电子邮件地址创建账户**？选项允许您决定是否可以使用门户设置中“常规”部分提供的域中的电子邮件地址创建新账户：'
- en: '[PRE5]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The **Require strangers to verify their email address?** option enables an
    e-mail verification functionality. This functionality also can be enabled in `portal-ext.properties`
    by setting the following properties:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '**是否要求陌生人验证他们的电子邮件地址**？选项启用电子邮件验证功能。此功能也可以通过在`portal-ext.properties`中设置以下属性来启用：'
- en: '[PRE6]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Although the **Authentication** section consists of a number of tabs providing
    a range of additional authentication methods, all the settings gathered on the
    **General** tab of the **Authentication** tab affect only the Liferay functionality.
    They have no influence on the integration options grouped on the remaining tabs.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管**身份验证**部分包含多个标签页，提供了一系列额外的身份验证方法，但**身份验证**标签页的**常规**选项卡上收集的所有设置仅影响Liferay功能。它们对剩余标签页上分组集成的选项没有影响。
- en: 'In some cases, the preceding configuration is not enough. For instance, many
    companies have their own privacy policy that requires an `HTTPS` connection. Liferay
    provides several settings in `portal.properties`, which can be overridden in `portal-ext.properties`,
    they are as follows:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，前面的配置可能不够。例如，许多公司有自己的隐私政策，要求`HTTPS`连接。Liferay在`portal.properties`中提供了几个设置，这些设置可以在`portal-ext.properties`中覆盖，具体如下：
- en: '| Properties | Description |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| 属性 | 描述 |'
- en: '| --- | --- |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `company.security.auth.requires.https=false` | Set this to `true` to ensure
    that users login with HTTPS |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| `company.security.auth.requires.https=false` | 将此设置为`true`以确保用户使用HTTPS登录|'
- en: '| `company.security.auto.login.max.age=31536000` | Specify max age (in seconds)
    of the browser cookie that enables the *Remember me* feature |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| `company.security.auto.login.max.age=31536000` | 指定启用*记住我*功能的浏览器cookie的最大有效期（以秒为单位）|'
- en: '| `company.security.login.form.autocomple=true` | Allows users to autocomplete
    the login form based on their previously entered values |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| `company.security.login.form.autocomple=true` | 允许用户根据之前输入的值自动完成登录表单|'
- en: Tip
  id: totrans-66
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: Modification in the `portal-ext.properties` file is needed for a server restart.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 需要修改`portal-ext.properties`文件以重启服务器。
- en: There's more…
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: There are two more options strictly connected to the login and logout mechanisms.
    The first one, the **Default Landing Page** field, is located in the **Portal
    Settings** web page. This field allows you to indicate the page a user will be
    redirected to after completing the authorization and authentication. The second,
    the **Default Logout Page** field, located in **Portal Settings**, allows you
    to define the page a user will be redirected to after logging out.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 与登录和注销机制严格相关的还有两个选项。第一个选项是**默认登录页面**字段，位于**门户设置**网页上。此字段允许您指定用户在完成授权和认证后将被重定向到的页面。第二个选项是**默认注销页面**字段，位于**门户设置**中，允许您定义用户在注销后将被重定向到的页面。
- en: 'In order to set custom values to these fields, follow these steps:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 为了设置这些字段的自定义值，请按照以下步骤操作：
- en: Go to **Admin** | **Control Panel** | **Configuration** | **Portal Settings**
    | **General**.
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往**管理** | **控制面板** | **配置** | **门户设置** | **常规**。
- en: Set **Default Landing Page** to the address of the page you want users to go
    to after logging in, for example, `/web/guest/login`.
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**默认登录页面**设置为用户登录后希望访问的页面地址，例如，`/web/guest/login`。
- en: Set **Default Logout Page** to the address of the page you want users to go
    to after logging out, for example, `/web/guest/logout`.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**默认注销页面**设置为用户注销后希望访问的页面地址，例如，`/web/guest/logout`。
- en: Click on the **Save** button.
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: 'These settings could also be overridden by `portal-ext.properties` by the following
    names:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 这些设置也可以通过以下名称由`portal-ext.properties`覆盖：
- en: '[PRE7]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: See also
  id: totrans-77
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: For information on overriding the default login page, refer to the *Overriding
    the default login page with the administrator defined page* recipe.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 关于覆盖默认登录页面的信息，请参阅*使用管理员定义的页面覆盖默认登录页面*配方。
- en: Setting up e-mail notifications
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置电子邮件通知
- en: 'In Liferay, there are four automatically sent e-mail notifications. They are
    as follows:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 在Liferay中，有四种自动发送的电子邮件通知。具体如下：
- en: '**Account Created Notification**, which is sent when a user successfully creates
    a new account'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**账户创建通知**，在用户成功创建新账户时发送'
- en: '**Email Verification Notification**, which provides the e-mail verification
    link and code'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电子邮件验证通知**，提供电子邮件验证链接和代码'
- en: '**Password Changed Notification**, which informs a user that their password
    has been changed'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码更改通知**，通知用户其密码已被更改'
- en: '**Password Reset Notification**, which enables a user to reset their current
    password by providing the password reset URL'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码重置通知**，允许用户通过提供密码重置URL来重置当前密码'
- en: This recipe provides information on how these default notifications can be customized.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 本食谱提供有关如何自定义这些默认通知的信息。
- en: Getting ready
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Make sure that the Java mail session is properly configured. To check whether
    it works, look at `portal-ext.properties` and find and/or configure the following
    settings:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 确保Java邮件会话已正确配置。为了检查其是否工作，请查看`portal-ext.properties`并查找和/或配置以下设置：
- en: '[PRE8]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: How to do it…
  id: totrans-89
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'In order to change the sender''s name and e-mail address, follow these steps:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更改发件人的姓名和电子邮件地址，请按照以下步骤操作：
- en: Log in as an administrator and go to **Admin** | **Control Panel** | **Configuration**
    | **Portal Settings** | **Email Notifications**.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以管理员身份登录并前往**管理员** | **控制面板** | **配置** | **门户设置** | **电子邮件通知**。
- en: Make sure you are in the **Sender** tab.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保您处于**发件人**选项卡。
- en: Provide the sender's name and e-mail address.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供发件人的姓名和电子邮件地址。
- en: Click on the **Save** button.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: 'In order to set **Account Created Notification**, perform these steps:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 为了设置**账户创建通知**，请执行以下步骤：
- en: Go to **Admin** | **Control Panel** | **Configuration** | **Portal Settings**
    | **Email Notifications**.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往**管理员** | **控制面板** | **配置** | **门户设置** | **电子邮件通知**。
- en: Go to the **Account Created Notification** tab.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往**账户创建通知**选项卡。
- en: Set the **Enabled** option.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置**启用**选项。
- en: Provide **Subject**.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供**主题**。
- en: Provide the **Body with Password** message text.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供带有**密码**的**正文**消息文本。
- en: Provide the **Body without Password** message text.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供不带**密码**的**正文**消息文本。
- en: Click on the **Save** button.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: The following screenshot captures the preceding steps
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图捕捉了前面的步骤
- en: '![How to do it…](img/image00300.jpeg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![如何操作…](img/image00300.jpeg)'
- en: 'In addition to **Account Created Notification**, Liferay provides three tabs
    to customize. They are as follows:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 除了**账户创建通知**之外，Liferay还提供了三个选项卡以进行自定义。具体如下：
- en: '**Email Verification Notification**'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电子邮件验证通知**'
- en: '**Password Changed Notification**'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码更改通知**'
- en: '**Password Reset Notification**'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密码重置通知**'
- en: 'In order to set **Email Verification Notification**, **Password Changed Notification**,
    or **Password Reset Notification**, perform these steps:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 为了设置**电子邮件验证通知**、**密码更改通知**或**密码重置通知**，请执行以下步骤：
- en: Go to **Admin** | **Control Panel** | **Configuration** | **Portal Settings**
    | **Email Notifications**.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往**管理员** | **控制面板** | **配置** | **门户设置** | **电子邮件通知**。
- en: Go to the **Email Verification Notification**, **Password Changed Notification**,
    or **Password Reset Notification** tab.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往**电子邮件验证通知**、**密码更改通知**或**密码重置通知**选项卡。
- en: Provide the subject and body of the message.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供消息的主题和正文。
- en: Click on the **Save** button.
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: How it works…
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理…
- en: Every e-mail notification consists of the subject and the body of the message.
    Both the subject and the body of the message can be composed using a set of available
    variables called terms (different for each notification) and custom text. The
    text of the body of the message can also be provided with simple text styles.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 每封电子邮件通知都由消息的主题和正文组成。消息的主题和正文都可以使用一组称为术语的可用变量（每个通知不同）和自定义文本来编写。消息正文的文本也可以提供简单的文本样式。
- en: It is worth noticing that the **Account Created Notification** tab provides
    an additional **Enabled** option that allows you to decide whether this particular
    notification should be sent or not.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，**账户创建通知**选项卡提供了一个额外的**启用**选项，允许您决定是否发送此特定通知。
- en: 'By default, `portal.properties` contains basic e-mail notification settings
    (default sender name, default sender e-mail, subject, body, and so on). Of course,
    all these settings can be customized to specific requirements:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，`portal.properties`包含基本的电子邮件通知设置（默认发件人姓名、默认发件人电子邮件、主题、正文等）。当然，所有这些设置都可以根据特定要求进行自定义：
- en: '[PRE9]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The preceding configuration defines the default settings for every type of notification.
    For instance, the `admin.email.password.reset.body` property defines the HTML
    template for the password reset action, which is located in the `com/liferay/portlet/admin/dependencies/email_password_reset_body.tmpl`
    file.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 上述配置定义了每种类型通知的默认设置。例如，`admin.email.password.reset.body`属性定义了密码重置操作的HTML模板，该模板位于`com/liferay/portlet/admin/dependencies/email_password_reset_body.tmpl`文件中。
- en: See also
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: For information on how to configure SMTP servers, refer to the *Configuring
    Liferay with the SMTP server* recipe in [Chapter 11](part0080.xhtml#aid-2C9D01
    "Chapter 11. Quick Tricks and Advanced Knowledge"), *Quick Tricks and Advanced
    Knowledge*.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 关于如何配置SMTP服务器的信息，请参阅第11章中“配置Liferay与SMTP服务器”食谱，*快速技巧和高级知识*。
- en: Customizing the registration form
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自定义注册表单
- en: The content of the registration form and the behavior of the system after completing
    the registration process can vary, depending on the system's functional and non-functional
    requirements. The default configuration of the registration form enables you to
    gather the data strictly required to create an account. The configuration also
    provides some additional fields, such as birth date or gender, which may not be
    always desirable. This recipe describes how to change the default set of registration
    form fields and modify their basic preferences and system behavior within the
    registration and authorization processes.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 注册过程完成后，注册表单的内容和系统的行为可能会根据系统的功能和非功能需求而有所不同。默认的注册表单配置允许您收集创建账户所需的数据。配置还提供了一些额外的字段，如出生日期或性别，这些字段可能并不总是需要的。本食谱描述了如何更改默认的注册表单字段集，并在注册和授权过程中修改它们的基本首选项和系统行为。
- en: How to do it…
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'In order to customize the registration form, perform these steps:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 为了自定义注册表单，请执行以下步骤：
- en: Login as an administrator and go to **Admin** | **Control Panel** | **Configuration**
    | **Portal settings** | **Users**:![How to do it…](img/image00301.jpeg)
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以管理员身份登录并转到**管理** | **控制面板** | **配置** | **门户设置** | **用户**：![如何操作…](img/image00301.jpeg)
- en: Make sure that you are in the **Fields** tab.
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保您处于**字段**选项卡。
- en: Enable/disable the **Terms of Use Required** option.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**使用条款必填**选项。
- en: Enable/disable the **Autogenerate User Screen Names** option.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**自动生成用户屏幕名称**选项。
- en: Enable/disable the **Last Name Required** option.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**姓氏必填**选项。
- en: Enable/disable the **Enable Birthday** option.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**启用生日**选项。
- en: Enable/disable the **Enable Gender** option.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用/禁用**启用性别**选项。
- en: Click on the **Save** button.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: How it works…
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理…
- en: 'There are three tabs that group the registration form settings: the **Fields**
    tab, the **Reserved Credentials** tab, and the **Default User Associations** tab.'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 有三个选项卡将注册表单设置分组：**字段**选项卡、**预留凭据**选项卡和**默认用户关联**选项卡。
- en: 'The **Fields** tab consists of the list of options that are responsible for
    the content of the registration form and behavior of the system when a user logs
    in for the first time. Each of these options has its own representation in `portal.properties`,
    which can be overridden by `portal-ext.properties`. Remember that the highest
    priorities have settings that come from **Control Panel**. There are following
    options:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '**字段**选项卡包含负责注册表单内容和用户首次登录时系统行为的选项列表。这些选项中的每一个在`portal.properties`中都有自己的表示，可以被`portal-ext.properties`覆盖。请记住，最高优先级的设置来自**控制面板**。以下是一些选项：'
- en: 'The **Terms of Use Required** option enables and disables the terms of use
    screen, which is shown after the user''s first authorization. By default, it is
    enabled:'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**使用条款必填**选项启用和禁用使用条款屏幕，该屏幕在用户首次授权后显示。默认情况下，它被启用：'
- en: '[PRE10]'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The **Autogenerate User Screen Names** option disables the screen name field
    in the registration form and sets Liferay to create the screen name automatically
    from the e-mail address. If this option is enabled, the screen name is generated
    from the user''s e-mail address (local part of the e-mail address). By default,
    it is disabled:'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动生成用户屏幕名称**选项禁用注册表单中的屏幕名称字段，并设置Liferay自动从电子邮件地址创建屏幕名称。如果此选项启用，屏幕名称将根据用户的电子邮件地址（电子邮件地址的本地部分）生成。默认情况下，它被禁用：'
- en: '[PRE11]'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The **Last Name Required** option sets the last name as a required field. By
    default, it is disabled:'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**姓氏必填**选项将姓氏设置为必填字段。默认情况下，它被禁用：'
- en: '[PRE12]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The **Enable Birthday** option allows you to decide whether the birthday field
    should be available in the registration form. By default, it is enabled:'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**启用生日**选项允许您决定是否应在注册表中提供生日字段。默认情况下，它是启用的：'
- en: '[PRE13]'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The **Enable Gender** option allows you to decide whether the gender field
    should be available in the registration form. By default, it is enabled:'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**启用性别**选项允许您决定是否应在注册表中提供性别字段。默认情况下，它是启用的：'
- en: '[PRE14]'
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The **Reserved Credentials** tab allows you to define screen names and e-mail
    addresses that are reserved and cannot be used to create user accounts both by
    users and administrators. It also can be overwritten in the following properties:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '**保留凭据**选项卡允许您定义保留的屏幕名称和电子邮件地址，这些地址不能被用户和管理员用于创建用户账户。它也可以在以下属性中重写：'
- en: '[PRE15]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The **Default User Associations** tab provides a set of fields that enable you
    to assign sites, organization sites, roles, and user groups to each newly created
    user.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: '**默认用户关联**选项卡提供了一组字段，允许您将站点、组织站点、角色和用户组分配给每个新创建的用户。'
- en: In addition, it is also possible to extend the functionality on existing users
    using the **Apply to Existing Users** option. However, changes will take effect
    when the user signs in.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，还可以使用**应用于现有用户**选项扩展现有用户的功能。但是，更改将在用户登录时生效。
- en: There's more…
  id: totrans-151
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更多内容…
- en: 'It is possible to change the default behavior of the create account link in
    the Sign in form and use a custom page with the custom create account portlet
    instead of the default (Sign in portlet) one. In order to do so, define the URL
    where the custom registration portlet is placed and set a property in the `portal-ext.properties`
    file as follows:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 可以更改登录表单中创建账户链接的默认行为，并使用自定义创建账户小部件页面而不是默认的（登录小部件）页面。为了做到这一点，定义自定义注册小部件放置的URL，并在`portal-ext.properties`文件中设置以下属性：
- en: '[PRE16]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: See also
  id: totrans-154
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: For information about adding users, refer to the *Adding a new user* recipe
    in [Chapter 3](part0030.xhtml#aid-SJGS1 "Chapter 3. Working with a Liferay User
    / User Group / Organization"), *Working with a Liferay User / User Group / Organization*.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 关于添加用户的更多信息，请参阅[第3章](part0030.xhtml#aid-SJGS1 "第3章。与Liferay用户/用户组/组织一起工作")中的*添加新用户*食谱，*与Liferay用户/用户组/组织一起工作*。
- en: Overriding the default login page with the administrator defined page
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用管理员定义的页面覆盖默认登录页面
- en: Liferay provides the possibility to use or replace the default dialog login
    feature with a custom login page. The custom page can be used to present some
    additional information such as instructions, description of benefits, and so on.
    This recipe provides guidelines on how to set such a page within the intranet.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: Liferay提供了使用或替换默认对话框登录功能与自定义登录页面的可能性。自定义页面可以用来展示一些附加信息，例如说明、利益描述等。本食谱提供了如何在内部网络中设置此类页面的指南。
- en: How to do it…
  id: totrans-158
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'In order to set a custom page in the login process, follow these steps:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在登录过程中设置自定义页面，请按照以下步骤操作：
- en: Log in as an administrator and go to **Admin** | **Site Administration** | **Pages**.
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以管理员身份登录并转到**管理** | **站点管理** | **页面**。
- en: Make sure that you are in the **Public Pages** tab.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保您处于**公共页面**选项卡。
- en: Click on the **Add page** button.
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加页面**按钮。
- en: Provide a name for the page (for instance, login).
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为页面提供一个名称（例如，登录）。
- en: Enable the **Hide from Navigation Menu** option.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用**隐藏于导航菜单**选项。
- en: Click on the **Add page** button. The new page will be created.
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加页面**按钮。新页面将被创建。
- en: Go to the page's details by clicking on the page in the tree that was created
    and copy the **Friendly URL** value.
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过单击树中创建的页面来查看页面详情并复制**友好URL**值。
- en: Go to the created page by typing (or pasting) its address in the browser's address
    bar.
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在浏览器的地址栏中输入（或粘贴）其地址来转到创建的页面。
- en: Click on the add button (this is a **+** sign on the left-hand side).
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击添加按钮（这是左侧的**+**符号）。
- en: Click on the **Applications** tab.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**应用程序**选项卡。
- en: Find the Sign in portlet using the search function or by browsing the list of
    available portlets,
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用搜索功能或通过浏览可用小部件列表来查找登录小部件，
- en: Click on the **Add** link next to the portlet name. The Sign in portlet with
    basic configuration will be added to the page.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击小部件名称旁边的**添加**链接。带有基本配置的登录小部件将被添加到页面中。
- en: Set URL to this site in the `portal-ext.properties` file by defining the `auth.login.site.url=/login`
    property.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在`portal-ext.properties`文件中定义`auth.login.site.url=/login`属性来将此站点的URL设置为`portal-ext.properties`文件。
- en: Note
  id: totrans-173
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: If there is a custom login portlet and custom page to login, it is required
    that you disable the dialog login functionality by setting the `login.dialog.disabled=true`
    property.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 如果有自定义登录端口和自定义登录页面，则需要通过设置 `login.dialog.disabled=true` 属性来禁用对话框登录功能。
- en: How it works…
  id: totrans-175
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: As described previously, the first step is to create a new standard page containing
    a Sign in portlet. This page will be used as a new login page. The second step
    is to override the default Liferay configuration and set it to use this newly
    created login page whenever the user is navigating a site and authentication is
    needed. In order to do so, you need to set the new link in the `auth.login.site.url`
    property. It is also important to remember that when redirecting the *Sign in*
    link to the custom page, it is necessary to disable the standard login popup dialog.
    It can be achieved by setting the `login.dialog.disabled` property to `true`.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，第一步是创建一个包含登录端口的新的标准页面。此页面将用作新的登录页面。第二步是覆盖默认的 Liferay 配置，并设置在用户导航网站且需要身份验证时使用此新创建的登录页面。为了做到这一点，您需要在
    `auth.login.site.url` 属性中设置新链接。同样重要的是要记住，当将 *登录* 链接重定向到自定义页面时，需要禁用标准登录弹出对话框。这可以通过将
    `login.dialog.disabled` 属性设置为 `true` 来实现。
- en: See also
  id: totrans-177
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: 'If you want to learn about creating pages or defining page templates, refer
    to the following recipes from [Chapter 4](part0037.xhtml#aid-1394Q1 "Chapter 4. Liferay
    Site Configuration"), *Liferay Site Configuration*:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想了解创建页面或定义页面模板，请参考以下来自 [第 4 章](part0037.xhtml#aid-1394Q1 "第 4 章。Liferay 网站配置")，*Liferay
    网站配置* 的食谱：
- en: '*Creating and customizing private and public pages for the site*'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*为网站创建和自定义私有和公共页面*'
- en: '*Using page templates and site templates for quick site and page creation*'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*使用页面模板和网站模板快速创建网站和页面*'
- en: Setting up a password policy
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置密码策略
- en: The Liferay password policy creator allows you to set the password life cycle
    and rules of employing it. You can decide whether the password should be changed.
    You can also specify the password syntax, the expiration rules, the lockout options,
    and the password history.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: Liferay 密码策略创建器允许您设置密码生命周期和其使用规则。您可以决定是否需要更改密码。您还可以指定密码语法、过期规则、锁定选项和密码历史。
- en: The default password policy provided by Liferay is very simple. It enables you
    to change the password of users and specifies that the reset password link should
    be valid for one day. This recipe provides a detailed description on how to create
    a new, more restricted password policy.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: Liferay 默认提供的密码策略非常简单。它允许您更改用户的密码，并指定重置密码链接应有效期为一天。本食谱详细说明了如何创建一个新、更严格的密码策略。
- en: The password policy in this example will require the users to provide eight-character
    passwords, which cannot be found in a dictionary. Users must include numbers and
    uppercase letters in the password, and it must be changed every sixty days (it
    should not be possible to set the password that has been used last ten times).
    Additionally, the system will count the failure login attempts and block the account
    for 10 minutes after three unsuccessful tries.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 本例中的密码策略将要求用户提供八位字符的密码，这些密码在字典中找不到。用户必须在密码中包含数字和大写字母，并且每六十天必须更改一次密码（不应可能设置最后十次使用过的密码）。此外，系统将计算失败登录尝试次数，在三次不成功尝试后，将账户锁定
    10 分钟。
- en: How to do it…
  id: totrans-185
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'In order to set the described password policy, follow these steps:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 为了设置所描述的密码策略，请按照以下步骤操作：
- en: Log in as an administrator and go to **Admin** | **Control Panel** | **Users**
    | **Password policies**.
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以管理员身份登录并转到 **Admin** | **控制面板** | **用户** | **密码策略**。
- en: Click on the **Add** button.![How to do it…](img/image00302.jpeg)
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **添加** 按钮。![如何操作…](img/image00302.jpeg)
- en: Provide a name for the new password policy.
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为新密码策略提供一个名称。
- en: Provide a description of the new password policy.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供新密码策略的描述。
- en: Enable the **Changeable** option.
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用 **可更改** 选项。
- en: Set the **Reset Ticket Max Age** option to **1 Day**.
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **重置票据最大年龄** 选项设置为 **1 天**。
- en: Enable the **Syntax Checking Enabled** option.
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用 **语法检查启用** 选项。
- en: Disable the **Allow Dictionary Words** option.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 禁用 **允许字典单词** 选项。
- en: Set **Minimum Length** to **8**.
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **最小长度** 设置为 **8**。
- en: Set **Minimum Upper Case** to **1**.
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **最小大写字母** 设置为 **1**。
- en: Set **Minimum Numbers** to **1**.
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **最小数字** 设置为 **1**。
- en: Enable the **History Enabled** option.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用 **历史启用** 选项。
- en: Set the **History Count** option to **10**.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **历史计数** 选项设置为 **10**。
- en: Enable the **Expiration Enabled** option.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用 **过期启用** 选项。
- en: Set **Maximum Age** to **8 Weeks**.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**最大年龄**设置为**8 周**。
- en: Set **Warning Time** to **6 Days**.
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**警告时间**设置为**6 天**。
- en: Set the **Lockout Enabled** option.
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置**锁定启用**选项。
- en: Set **Maximum Failure** to **3**.
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**最大失败次数**设置为**3**。
- en: Set **Lockout Duration** to **10 Minutes**.
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**锁定持续时间**设置为**10 分钟**。
- en: Click on the **Save** button.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: How it works…
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: 'There are five groups of options in the new password policy form: **General**,
    **Password Syntax Checking**, **Password History**, **Password Expiration**, and
    **Lockout sections**.'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 新密码策略表单中有五组选项：**通用**、**密码语法检查**、**密码历史**、**密码过期**和**锁定部分**。
- en: 'The General section consists of the following options:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: '**通用**部分包括以下选项：'
- en: The **Changeable** option allows you to decide whether users can change their
    passwords
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可更改**选项允许您决定用户是否可以更改他们的密码'
- en: The **Change Required** option determines whether a user is required to change
    the password on first login
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**更改要求**选项确定用户是否需要在首次登录时更改密码'
- en: The **Minimum Age** option specifies the amount of time a user must wait before
    they will be allowed to change the password
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最小年龄**选项指定用户在允许更改密码之前必须等待的时间'
- en: The **Reset Ticket Max Age** option determines for how long a password reset
    link is valid
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**重置票据最大年龄**选项确定密码重置链接的有效时长'
- en: 'The **Password Syntax Checking** section consists of the following options:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: '**密码语法检查**部分包括以下选项：'
- en: The **Syntax Checking Enabled** option determines whether the password syntax
    should be checked
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**语法检查启用**选项确定是否应该检查密码语法'
- en: The **Allow Dictionary** option determines whether common words are allowed
    to be used in passwords
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**允许字典**选项确定是否允许在密码中使用常用单词'
- en: The **Minimum Alpha Numeric** option allows you to set the required minimum
    number of alphanumeric letters in the password
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最小字母数字**选项允许您设置密码中所需的最小字母数字数量'
- en: The **Minimum Length** option determines the required minimum length of the
    password
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最小长度**选项确定密码所需的最小长度'
- en: The **Minimum Lower Case** option determines the required minimum number of
    lowercase letters in the password
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最小小写字母**选项确定密码中所需的最小小写字母数量'
- en: The **Minimum Numbers** option determines the required minimum number of numbers
    in the password
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最小数字**选项确定密码中所需的最小数字数量'
- en: The **Minimum Symbols** option determines the required minimum number of symbols
    in the password
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最小符号**选项确定密码中所需的最小符号数量'
- en: The **Minimum Upper Case** option determines the minimum number of uppercase
    letters in the password
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最小大写字母**选项确定密码中的最小大写字母数量'
- en: The **Regular Expression** option determines the validation pattern for the
    user's password
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**正则表达式**选项确定用户密码的验证模式'
- en: 'The **Password History** section consists of the following options:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '**密码历史**部分包括以下选项：'
- en: The **History Enabled** option allows you to decide whether the portal should
    keep a history of the user's previous passwords in order to prevent them from
    reusing an old password
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**历史启用**选项允许您决定门户是否应该保留用户之前密码的历史记录，以防止他们重用旧密码'
- en: The **History Count** option determines the number of previous passwords, which
    are kept in the history and cannot be used while setting a new password
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**历史计数**选项确定在历史记录中保留的旧密码数量，在设置新密码时不能使用'
- en: 'The **Password Expiration** section consists of the following options:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '**密码过期**部分包括以下选项：'
- en: The **Expiration Enabled** option allows you to decide whether users are forced
    to periodically change their passwords
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**过期启用**选项允许您决定是否强制用户定期更改密码'
- en: The **Maximum Age** option determines for how long a password is valid
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最大年龄**选项确定密码的有效时长'
- en: The **Warning Time** specifies the amount of time before the password expiration
    date; a notification will be sent after this date
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**警告时间**指定密码过期前的时长；在此日期后将会发送通知'
- en: The **Grace Limit** specifies the number of times a user can log in after their
    password has expired
  id: totrans-231
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**宽限期**指定用户密码过期后可以登录的次数'
- en: 'The **Lockout** section consists of the following options:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: '**锁定**部分包括以下选项：'
- en: The **Lockout Enabled** option lets you to count the unsuccessful login attempts
    and enable account-locking mechanisms
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**锁定启用**选项让您统计失败的登录尝试并启用账户锁定机制'
- en: The **Maximum Failure** option specifies the maximum number of unsuccessful
    login attempts
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最大失败**选项指定了最大失败登录尝试次数'
- en: The **Reset Failure Count** option specifies the amount of time that an information
    of unsuccessful logins is kept
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**重置失败计数**选项指定了保留失败登录信息的时间'
- en: The **Lockout Duration** option indicates the amount of time that a user's account
    remains blocked and cannot be used
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**锁定持续时间**选项表示用户账户被锁定且无法使用的时长'
- en: Integration with CAS SSO
  id: totrans-237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 与 CAS SSO 集成
- en: 'CAS is a single sign-on protocol. The official specification introduces it
    as follows:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: CAS 是一个单点登录协议。官方规范如下介绍它：
- en: '*"The Central Authentication Service (CAS) is a single-sign-on / single-sign-off
    protocol for the web. It permits a user to access multiple applications while
    providing their credentials (such as userid and password) only once to a central
    CAS Server application."*'
  id: totrans-239
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*"中央认证服务 (CAS) 是一个用于网络的单点登录/单点登出协议。它允许用户在只向中央 CAS 服务器应用程序提供一次凭据（如用户名和密码）的情况下访问多个应用程序。"*'
- en: 'Liferay provides ready-to-use functionality based on JASIG CAS (CAS became
    a **Java in Administration Special Interest Group** (**JASIG**) project in December
    2004 and is now also known as JASIG CAS). In many projects, especially internal
    ones (for instance, intranet) it is necessary to provide single sign-on. CAS integrates
    with the following authentication mechanisms:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: Liferay 提供了基于 JASIG CAS (CAS 于 2004 年 12 月成为 **Java in Administration Special
    Interest Group** (**JASIG**) 项目，现在也被称为 JASIG CAS) 的现成功能。在许多项目中，尤其是内部项目（例如，企业内部网），提供单点登录是必要的。CAS
    与以下认证机制集成：
- en: Active Directory
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Active Directory
- en: Generic
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通用
- en: JAAS
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: JAAS
- en: JDBC
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: JDBC
- en: LDAP
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: LDAP
- en: Legacy
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 旧版
- en: RADIUS
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RADIUS
- en: SPNEGO
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SPNEGO
- en: Trusted
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 受信任
- en: X.509 certificates
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: X.509 证书
- en: This recipe covers the basic steps to install a CAS server and to integrate
    it with Liferay.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 这个配方涵盖了安装 CAS 服务器并将其与 Liferay 集成的基本步骤。
- en: How to do it…
  id: totrans-252
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'In order to install and run a CAS server that works with Liferay, there are
    four main steps:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 为了安装和运行与 Liferay 兼容的 CAS 服务器，有四个主要步骤：
- en: Install the CAS system on the Tomcat server.
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Tomcat 服务器上安装 CAS 系统。
- en: Configure an HTTPS connection.
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置 HTTPS 连接。
- en: Set the CAS server.
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置 CAS 服务器。
- en: Configure Liferay Portal.
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置 Liferay 门户。
- en: Installing the CAS system
  id: totrans-258
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 CAS 系统
- en: 'The first step is installing the CAS system on the Apache Tomcat server. The
    CAS can be deployed in the same instance as Liferay, but in the real-world example,
    it is a dedicated application server. We assume the first approach. The second
    important assumption is that we rely on Tomcat hot-deploy of archives. So, make
    sure that the `autoDeploy` option is set to `true`. This is a default setting.
    To install CAS, follow these steps:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是在 Apache Tomcat 服务器上安装 CAS 系统。CAS 可以与 Liferay 部署在同一实例中，但在实际示例中，它是一个专用应用程序服务器。我们假设第一种方法。第二个重要假设是我们依赖于
    Tomcat 的热部署存档。因此，请确保将 `autoDeploy` 选项设置为 `true`。这是一个默认设置。要安装 CAS，请按照以下步骤操作：
- en: Download the newest version of CAS from [http://downloads.jasig.org/cas/](http://downloads.jasig.org/cas/)
    and unzip archive. At this moment, 4.0 is the newest version.
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 [http://downloads.jasig.org/cas/](http://downloads.jasig.org/cas/) 下载 CAS
    的最新版本并解压存档。目前，4.0 是最新版本。
- en: 'Deploy `cas-server-4.0.0/modules/cas-server-webapp-4.0.0.war` into the Tomcat
    server by copying the `cas-server-webapp-4.0.0.war` application into the `${TOMCAT_HOME}/webapps`
    folder or using Tomcat Manager (if it is available). In the `catalina.out` logfile,
    you should see similar information:'
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 `cas-server-4.0.0/modules/cas-server-webapp-4.0.0.war` 部署到 Tomcat 服务器，通过将
    `cas-server-webapp-4.0.0.war` 应用程序复制到 `${TOMCAT_HOME}/webapps` 文件夹或使用 Tomcat 管理器（如果可用）。在
    `catalina.out` 日志文件中，你应该看到类似的信息：
- en: '[PRE17]'
  id: totrans-262
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Configuring the HTTPS connection
  id: totrans-263
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置 HTTPS 连接
- en: 'The next important step is to establish an HTTPS connection between Liferay
    and CAS. By default, CAS sends the single sign-on cookie (CASTGC) only over secure
    connections. In our case, we will use a Java *keytool* to generate the SSL certificate.
    Java keytool is a key and certificate-management utility. It allows users to manage
    their own public/private key pairs and certificates. Basically, this tool stores
    keys and certificates in the *keystore*. This is a repository implemented as a
    file and placed on the local hard drive. Our goal is to generate a certificate,
    export it as a file, and place it in the truststore (`$JAVA_HOME/jre/lib/security/cacerts`).
    These instructions set up Tomcat''s keystore file with a self-signed certificate
    (self-signed certificates should *never* be used for anything beyond development
    environment):'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个重要步骤是在Liferay和CAS之间建立HTTPS连接。默认情况下，CAS仅在安全连接上发送单点登录cookie（CASTGC）。在我们的情况下，我们将使用Java
    *keytool*生成SSL证书。Java keytool是一个密钥和证书管理工具。它允许用户管理自己的公钥/私钥对和证书。基本上，此工具将密钥和证书存储在*keystore*中。这是一个作为文件实现的存储库，并放置在本地硬盘上。我们的目标是生成一个证书，将其导出为文件，并将其放置在信任库中（`$JAVA_HOME/jre/lib/security/cacerts`）。以下说明设置了Tomcat的keystore文件，并使用自签名证书（自签名证书**绝不应**用于开发环境之外的任何用途）：
- en: 'In any directory, type the command that generates a new key and puts it in
    the local keystore called `keystore.jks`:'
  id: totrans-265
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在任何目录中，输入生成新密钥并将其放入名为`keystore.jks`的本地密钥库中的命令：
- en: '[PRE18]'
  id: totrans-266
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Note
  id: totrans-267
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Make sure that you provide the `$JAVA_HOME/jre/lib/security/cacerts` keystore
    password. Both passwords must be the same.
  id: totrans-268
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 确保您提供了`$JAVA_HOME/jre/lib/security/cacerts`密钥库密码。两个密码必须相同。
- en: 'The following list shows how the key-generation process looks:'
  id: totrans-269
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 以下列表显示了密钥生成过程：
- en: '[PRE19]'
  id: totrans-270
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Note
  id: totrans-271
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The value of the `first and last name` field mentioned previously must be set
    to a fully qualified domain name. On Windows, the fully qualified machine name
    appears as a full computer name. On Linux, this is a host name.
  id: totrans-272
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 之前提到的`first and last name`字段值必须设置为完全限定域名。在Windows上，完全限定的机器名显示为完整的计算机名。在Linux上，这是主机名。
- en: 'Export the key to a file called `tomcat.cert`:'
  id: totrans-273
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将密钥导出到名为`tomcat.cert`的文件中：
- en: '[PRE20]'
  id: totrans-274
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Import the key to the `$JAVA_HOME/jre/lib/security/cacerts` truststore:'
  id: totrans-275
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将密钥导入到`$JAVA_HOME/jre/lib/security/cacerts`信任库中：
- en: '[PRE21]'
  id: totrans-276
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Check whether your certificate was successfully imported in the Java truststore:'
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查您的证书是否成功导入到Java信任库中：
- en: '[PRE22]'
  id: totrans-278
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Edit the `server.xml` file in the `${TOMCAT_HOME}/conf` folder and uncomment
    the SSL section to open up port 8443:'
  id: totrans-279
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑`${TOMCAT_HOME}/conf`文件夹中的`server.xml`文件，取消注释SSL部分以打开端口8443：
- en: '[PRE23]'
  id: totrans-280
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Setting the CAS server
  id: totrans-281
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设置CAS服务器
- en: In this step, we will define a map of users that can be authenticated in our
    Liferay system. To achieve it, go to the `${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF`
    folder, edit `deployerConfigContext.xml`, and modify the bean definition.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 在此步骤中，我们将定义一个映射，其中包含可以在我们的Liferay系统中进行身份验证的用户。为了实现这一点，请转到`${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF`文件夹，编辑`deployerConfigContext.xml`，并修改bean定义。
- en: 'Set users list by adding them into `users` property. Here is an example:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将用户添加到`users`属性中来设置用户列表。以下是一个示例：
- en: '[PRE24]'
  id: totrans-284
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Tip
  id: totrans-285
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: Remember that a user must be created in the Liferay Portal.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 记住必须在Liferay Portal中创建用户。
- en: Configuring Liferay Portal
  id: totrans-287
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置Liferay Portal
- en: 'The last set of steps is a Liferay configuration. Our goal is to change the
    authentication type, which should be based on `screenName` (login), and enable
    the CAS authentication method. To achieve this, follow these steps:'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一步是Liferay配置。我们的目标是更改身份验证类型，该类型应基于`screenName`（登录），并启用CAS身份验证方法。为此，请按照以下步骤操作：
- en: 'In Liferay, set the authentication type based on `screenName` (login). The
    portal can authenticate users based on their e-mail addresses, `screenName`, or
    `userId`. Change the default option and set a new value of the authentication
    type in `${liferay.home}/portal-ext.properties`:'
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Liferay中，根据`screenName`（登录）设置身份验证类型。门户可以根据用户的电子邮件地址、`screenName`或`userId`对用户进行身份验证。更改默认选项，并在`${liferay.home}/portal-ext.properties`中设置新的身份验证类型值：
- en: '[PRE25]'
  id: totrans-290
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Enable the CAS authentication by setting specific properties in `${liferay.home}/portal-ext.properties`:'
  id: totrans-291
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在`${liferay.home}/portal-ext.properties`中设置特定属性来启用CAS身份验证：
- en: '[PRE26]'
  id: totrans-292
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Start the CAS server and Liferay. When the homepage loads, click on the login
    link. The system should redirect the user to the CAS login page with the HTTPS
    protocol.
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动CAS服务器和Liferay。当主页加载时，单击登录链接。系统应将用户重定向到使用HTTPS协议的CAS登录页面。
- en: 'Try authenticating yourself with the following credentials:'
  id: totrans-294
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下凭据尝试进行身份验证：
- en: '[PRE27]'
  id: totrans-295
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: How it works…
  id: totrans-296
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: 'The **Central Authentication Service** (**CAS**) provides a single sign-on
    for the applications. The main purpose of SSO is to provide user''s credentials
    only once and permit them to access all the client''s applications that support
    the SSO protocol. Therefore, CAS is divided into two parts: CAS client and CAS
    server. For clarity sake, this means that the CAS Client component (jar) is placed
    in the Liferay libraries, and the CAS server is a standalone application. The
    CAS server is responsible for authenticating users. The CAS client acquires and
    protects the identity of the granted users. Communication between clients and
    server can be implemented by four protocols:'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: '**中央认证服务**（**CAS**）为应用程序提供单一登录。SSO的主要目的是只提供一次用户凭据，并允许他们访问所有支持SSO协议的客户端应用程序。因此，CAS分为两部分：CAS客户端和CAS服务器。为了清晰起见，这意味着CAS客户端组件（jar）放置在Liferay库中，而CAS服务器是一个独立的应用程序。CAS服务器负责认证用户。CAS客户端获取并保护授予用户的身份。客户端和服务器之间的通信可以通过四种协议实现：'
- en: CAS 3.0 (enabled by default)
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CAS 3.0（默认启用）
- en: SAML 1.1
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SAML 1.1
- en: OpenID
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OpenID
- en: OAuth (1.0, 2.0)
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OAuth（1.0，2.0）
- en: 'Let''s try analyzing the login process step by step:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们逐步分析登录过程：
- en: User clicks on the **login** button in the Liferay site. The system redirects
    the user to the CAS application at `https://localhost:8443/cas-server-webapp-4.0.0/login?service=https://localhost:8443/c/portal/login`.
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户在Liferay网站上点击**登录**按钮。系统将用户重定向到`https://localhost:8443/cas-server-webapp-4.0.0/login?service=https://localhost:8443/c/portal/login`的CAS应用程序。
- en: 'User types the correct login and password and invokes the submit action. The
    CAS server authenticates the user and sets the CASTGC cookie (for example, `CASTGC=TGT-4-HASH-cas01.example.org`).
    Then, the authenticated user goes back to Liferay with the Service Ticket (ST)
    ticket parameter: `https://localhost:8443/c/portal/login?ticket=ST-6-HASH-cas01.example.org`.'
  id: totrans-304
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户输入正确的登录名和密码并调用提交操作。CAS服务器认证用户并设置CASTGCcookie（例如，`CASTGC=TGT-4-HASH-cas01.example.org`）。然后，认证后的用户带着服务票据（ST）参数返回到Liferay：`https://localhost:8443/c/portal/login?ticket=ST-6-HASH-cas01.example.org`。
- en: 'The next step is calling the validation. It is a background process that sends
    the GET request via back-channel communication and gets an XML response with username
    details: `https://localhost:8443/cas-server-webapp-4.0.0/proxyValidate?{PARAMETERS}`.'
  id: totrans-305
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是调用验证。这是一个后台过程，通过后端通道通信发送GET请求，并获取包含用户详细信息的XML响应：`https://localhost:8443/cas-server-webapp-4.0.0/proxyValidate?{PARAMETERS}`。
- en: User is successfully logged in into the Liferay system.
  id: totrans-306
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户成功登录到Liferay系统。
- en: 'In Liferay, there are two classes that implement CAS authentication:'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 在Liferay中，有两个类实现了CAS认证：
- en: '`com.liferay.portal.servlet.filters.sso.cas.CASFilter`'
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`com.liferay.portal.servlet.filters.sso.cas.CASFilter`'
- en: '`com.liferay.portal.security.auth.CASAutoLogin`'
  id: totrans-309
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`com.liferay.portal.security.auth.CASAutoLogin`'
- en: '`CASFilter` is responsible for the CAS authentication process, especially for
    login action. The most important piece of code calls validation:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: '`CASFilter`负责CAS认证过程，特别是登录操作。最重要的代码片段调用验证：'
- en: '[PRE28]'
  id: totrans-311
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Filter validates ticket and sets login as a session attribute.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 过滤器验证票据并将登录设置为会话属性。
- en: '`CASAutoLogin` reads the session `CAS_LOGIN` attribute and tries to find the
    user in the database. If the user exists in the database, the `AutoLogin` process
    returns the user''s credentials and successfully logs them in into Liferay Portal.'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: '`CASAutoLogin`读取会话`CAS_LOGIN`属性并尝试在数据库中找到用户。如果用户存在于数据库中，`AutoLogin`过程将返回用户的凭据并成功将其登录到Liferay门户。'
- en: The CAS server, without any external authentication handler, is useless. So,
    the following recipes will show how to integrate the CAS server and Liferay users'
    database or LDAP server.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 没有任何外部认证处理器的CAS服务器是无用的。因此，以下菜谱将展示如何集成CAS服务器和Liferay用户数据库或LDAP服务器。
- en: See also
  id: totrans-315
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: 'For more information on CAS and LDAP configuration, refer to the following
    recipes:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 更多关于CAS和LDAP配置的信息，请参考以下菜谱：
- en: '*CAS and the Liferay user''s database*'
  id: totrans-317
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*CAS与Liferay用户数据库*'
- en: '*Liferay and the LDAP integration*'
  id: totrans-318
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Liferay与LDAP集成*'
- en: '*The magic trio: Liferay, CAS, and LDAP*'
  id: totrans-319
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*神奇的三元组：Liferay、CAS和LDAP*'
- en: CAS and the Liferay user's database
  id: totrans-320
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: CAS与Liferay用户数据库
- en: 'The following recipe presents an idea on how to use the Liferay user functionality
    so it is authenticated by the CAS server. This idea may be used instead of LDAP
    or Active Directory systems. In small companies, where Liferay will be the main
    system that contains all user details, it would be a great concept to implement
    SSO in the following way:'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 以下配方展示了一个如何使用Liferay用户功能以便由CAS服务器进行认证的想法。这个想法可以用作LDAP或Active Directory系统的替代。在小公司中，如果Liferay将成为包含所有用户详情的主要系统，那么以下方式实现SSO将是一个很好的概念：
- en: Liferay provides user details such as login and password to the CAS server
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Liferay向CAS服务器提供用户详情，如登录名和密码
- en: When a user tries to login to the Liferay Portal, the CAS server *asks* the
    Liferay database and checks the user's data correctness
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当用户尝试登录Liferay门户时，CAS服务器会向Liferay数据库查询并检查用户数据的正确性
- en: Getting ready
  id: totrans-324
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: This recipe is in continuation with the previous one. To be ready, check whether
    the CAS server is correctly installed and is communicating with Liferay (the CAS
    client). To check it, try authenticating yourself as a default Liferay user via
    CAS by invoking `https://localhost:8443/cas-server-webapp-4.0.0/login`.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 此配方是前一个配方的延续。为了准备就绪，请检查CAS服务器是否正确安装并且正在与Liferay（CAS客户端）通信。要检查它，请尝试通过调用`https://localhost:8443/cas-server-webapp-4.0.0/login`以默认Liferay用户身份通过CAS进行身份验证。
- en: How to do it…
  id: totrans-326
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: Since 6.2 version, Liferay uses the PBKDF2WithHmacSHA1/160/128000 algorithm
    for password encryption. To configure the CAS server without any customization,
    it is necessary to change the password encryption (for instance, the SHA algorithm).
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 从6.2版本开始，Liferay使用PBKDF2WithHmacSHA1/160/128000算法进行密码加密。为了配置CAS服务器而不进行任何自定义，必须更改密码加密（例如，SHA算法）。
- en: Note
  id: totrans-328
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Warning! Changing the encryption is dangerous for existing accounts. All passwords
    stored in the database will be lost. If this happens, it is necessary to set a
    new password for every user.
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 警告！更改加密对现有账户是危险的。数据库中存储的所有密码都将丢失。如果发生这种情况，必须为每个用户设置新密码。
- en: 'In order to configure the CAS server to work with the Liferay database follow
    these steps:'
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 为了配置CAS服务器与Liferay数据库一起工作，请按照以下步骤操作：
- en: 'Add the following libraries to `${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF/lib`:'
  id: totrans-331
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下库添加到`${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF/lib`目录下：
- en: '`c3p0` (for instance, `c3p0-0.9.1.2.jar`): Download it from [https://github.com/swaldman/c3p0](https://github.com/swaldman/c3p0)'
  id: totrans-332
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`c3p0`（例如，`c3p0-0.9.1.2.jar`）：从[https://github.com/swaldman/c3p0](https://github.com/swaldman/c3p0)下载'
- en: '`cas-server-support-jdbc-4.0.0.jar`: Copy it from `cas-server-4.0.0/modules/`'
  id: totrans-333
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`cas-server-support-jdbc-4.0.0.jar`：从`cas-server-4.0.0/modules/`复制'
- en: 'Change the password encryption by setting the new one in `${liferay.home}/portal-ext.properties`:'
  id: totrans-334
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在`${liferay.home}/portal-ext.properties`中设置新密码来更改密码加密：
- en: '[PRE29]'
  id: totrans-335
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Set the `passwordEncoder` bean in the CAS server. Open `${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF/deployerConfigContext.xml`
    and define the bean:'
  id: totrans-336
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在CAS服务器中设置`passwordEncoder` bean。打开`${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF/deployerConfigContext.xml`并定义bean：
- en: '[PRE30]'
  id: totrans-337
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: The last thing is to set `dataSource` and change `primaryAuthenticationHandler`
    in `deployerConfigContext.xml`.
  id: totrans-338
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，需要在`deployerConfigContext.xml`中设置`dataSource`并更改`primaryAuthenticationHandler`。
- en: 'Set a new bean with `id="dataSource"`:'
  id: totrans-339
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置一个新的bean，其`id="dataSource"`：
- en: '[PRE31]'
  id: totrans-340
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Find and change the bean with `id="primaryAuthenticationHandler"`:'
  id: totrans-341
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查找并更改具有`id="primaryAuthenticationHandler"`的bean：
- en: '[PRE32]'
  id: totrans-342
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: How it works…
  id: totrans-343
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: The CAS server supports many common kinds of authentication systems, such as
    database, LDAP, OpenID, OAuth, Radius, Windows (NTLM), and so on. In this recipe,
    we have shown an example configuration, where Liferay database provides user detail
    to the CAS server. This type of handler is called `QueryDatabaseAuthenticationHandler`.
    CAS provides two other database handlers called `SearchModeSearchDatabaseAuthenticationHandler`
    and `BindModeSearchDatabaseAuthenticationHandler`. Information about these handlers
    is available at [https://github.com/Jasig/cas/wiki/Configuring-Authentication-Components](https://github.com/Jasig/cas/wiki/Configuring-Authentication-Components).
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: CAS服务器支持许多常见的认证系统，如数据库、LDAP、OpenID、OAuth、Radius、Windows（NTLM）等。在这个配方中，我们已经展示了一个示例配置，其中Liferay数据库向CAS服务器提供用户详情。这种处理器称为`QueryDatabaseAuthenticationHandler`。CAS还提供了两个其他数据库处理器，称为`SearchModeSearchDatabaseAuthenticationHandler`和`BindModeSearchDatabaseAuthenticationHandler`。有关这些处理器的信息，请参阅[https://github.com/Jasig/cas/wiki/Configuring-Authentication-Components](https://github.com/Jasig/cas/wiki/Configuring-Authentication-Components)。
- en: As mentioned at the beginning, both Liferay and CAS have to use the same password
    encryption algorithm (SHA1). It has to be the same because the CAS server authenticates
    users by comparing the (hashed) user's password against the password stored in
    the database. To define database connection, it was necessary to create a new
    bean called `dataSource`.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 如开头所述，Liferay和CAS必须使用相同的密码加密算法（SHA1）。必须相同，因为CAS服务器通过比较（散列的）用户的密码与数据库中存储的密码来验证用户。为了定义数据库连接，有必要创建一个名为`dataSource`的新bean。
- en: 'The last and most important step was defining the handler with the following
    query:'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 最后也是最重要的一步是使用以下查询定义处理程序：
- en: '[PRE33]'
  id: totrans-347
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: This query returns an encrypted password by the SHA1 algorithm from the Liferay
    users database. It is enough to correctly compare encoded passwords and authenticate
    the user.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 此查询返回由Liferay用户数据库通过SHA1算法加密的密码。正确比较编码的密码并验证用户就足够了。
- en: There's more…
  id: totrans-349
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多…
- en: 'Many systems provide authentication by e-mail address instead of `screenName`
    (login). By default, Liferay implements this kind of authentication. So, let''s
    change the earlier recipe and deploy e-mail authentication. To achieve it, there
    are two steps:'
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 许多系统通过电子邮件地址而不是`screenName`（登录名）提供认证。默认情况下，Liferay实现了这种认证。所以，让我们更改之前的食谱并部署电子邮件认证。为了实现它，有两个步骤：
- en: 'Change the authentication type in `${liferay.home}/portal-ext.properties`:'
  id: totrans-351
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`${liferay.home}/portal-ext.properties`中更改认证类型：
- en: '[PRE34]'
  id: totrans-352
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Modify `primaryAuthenticationHandler` in the CAS `deployerConfigContext.xml`
    file:'
  id: totrans-353
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在CAS的`deployerConfigContext.xml`文件中修改`primaryAuthenticationHandler`：
- en: '[PRE35]'
  id: totrans-354
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: At this time, we decided to use a different `authenticationHandler` called `SearchModeSearchDatabaseAuthenticationHandler`
    to show a variety of possible ways to achieve database communication.
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个时候，我们决定使用一个名为`SearchModeSearchDatabaseAuthenticationHandler`的不同`authenticationHandler`来展示多种实现数据库通信的可能方式。
- en: 'The second and very important fact is that it is not a good idea (for security
    purposes) to use the SHA1 or MD5 algorithm without SALT. Moreover, Liferay developers
    decided to use very strong encryption:'
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个非常重要的事实是，出于安全考虑，不使用SALT的SHA1或MD5算法不是一个好主意。此外，Liferay开发者决定使用非常强大的加密：
- en: '*"PBKDF2 (Password-Based Key Derivation Function 2) is a key derivation function
    that''s part of RSA''s PKCS (Public-Key Cryptography Standards) series: PKCS #5,
    version 2.0\. It''s also described in the IETF''s RFC 2898\. The PBKDF2WithHmacSHA1/160/128000
    algorithm uses a keyed-hash message authentication code using SHA-1 and generates
    160-bit hashes using 128,000 rounds."*'
  id: totrans-357
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*"PBKDF2（基于密码的密钥派生函数2）是RSA的PKCS（公钥加密标准）系列的一部分：PKCS #5，版本2.0。它也在IETF的RFC 2898中描述。PBKDF2WithHmacSHA1/160/128000算法使用基于密钥的哈希消息认证码，使用SHA-1生成160位哈希，并使用128,000轮。"*'
- en: 'If someone wants to use the same algorithm in the CAS Server, it is necessary
    to implement new `passwordEncoder` and define it in the CAS `deployerConfigContext.xml`:'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 如果有人想在CAS服务器中使用相同的算法，则必须实现新的`passwordEncoder`并在CAS的`deployerConfigContext.xml`中定义它：
- en: '[PRE36]'
  id: totrans-359
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '`LiferayPasswordEncoder` must implement the `org.jasig.cas.authentication.handler.PasswordEncoder`
    interface.'
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: '`LiferayPasswordEncoder`必须实现`org.jasig.cas.authentication.handler.PasswordEncoder`接口。'
- en: See also
  id: totrans-361
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: 'For information on CAS and LDAP, refer to the *Liferay and the LDAP integration*
    and *The magic trio: Liferay, CAS, and LDAP* recipes.'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 关于CAS和LDAP的信息，请参考*Liferay和LDAP集成*和*神奇三重奏：Liferay、CAS和LDAP*食谱。
- en: Liferay and the LDAP integration
  id: totrans-363
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Liferay和LDAP集成
- en: In many companies, LDAP (OpenLDAP, Active Directory, or other LDAP implementations)
    is the system that keeps users' details, especially login, password, e-mail address,
    name, and surname. It is a good idea to integrate Liferay with LDAP. Fortunately,
    Liferay developers thought about it. Liferay provides out-of-the-box functionality
    that can read and import users from LDAP.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多公司中，LDAP（OpenLDAP、Active Directory或其他LDAP实现）是保存用户详细信息（尤其是登录、密码、电子邮件地址、姓名和姓氏）的系统。将Liferay与LDAP集成是一个好主意。幸运的是，Liferay开发者已经考虑到了这一点。Liferay提供开箱即用的功能，可以读取和从LDAP导入用户。
- en: Getting ready
  id: totrans-365
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'To start the configuration, you need to correctly install an LDAP server such
    as OpenLDAP or Active Directory, or ApacheDS. As an example of integration, it
    will be used online as a LDAP test server:'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始配置，您需要正确安装LDAP服务器，如OpenLDAP或Active Directory，或ApacheDS。作为一个集成示例，它将作为在线的LDAP测试服务器使用：
- en: 'Server: `ldap.forumsys.com`'
  id: totrans-367
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器：`ldap.forumsys.com`
- en: 'Port: `389`'
  id: totrans-368
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 端口：`389`
- en: 'Bind DN: `cn=read-only-admin,dc=example,dc=com`'
  id: totrans-369
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 绑定DN：`cn=read-only-admin,dc=example,dc=com`
- en: 'Bind Password: `password`'
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 绑定密码：`password`
- en: 'All user passwords are: `password`.'
  id: totrans-371
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有用户密码都是：`password`。
- en: How to do it…
  id: totrans-372
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'There are two ways of configuration: by GUI or by portal properties. In this
    case, we will show configuration via **Control Panel**.'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 有两种配置方式：通过GUI或通过门户属性。在这种情况下，我们将通过**控制面板**展示配置。
- en: Log in to your Liferay instance as a super administrator (by default, it is
    `joebloggs/test`).
  id: totrans-374
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以超级管理员身份登录您的Liferay实例（默认为`joebloggs/test`）。
- en: Go to **Admin** | **Control Panel** | **Configuration** | **Portal Settings**
    | **Authentication**.
  id: totrans-375
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往 **管理** | **控制面板** | **配置** | **门户设置** | **身份验证**。
- en: Select the **LDAP** tab.
  id: totrans-376
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**LDAP**标签。
- en: Select the **Enabled** option.
  id: totrans-377
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**启用**选项。
- en: Click on the **Add** button in the LDAP servers section.
  id: totrans-378
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在LDAP服务器部分点击**添加**按钮。
- en: 'Fill in the form with the following data:'
  id: totrans-379
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下数据填写表单：
- en: '**Server name**: `<YOUR_SERVER_NAME>` (for example, `ldap.forumsys.com`).'
  id: totrans-380
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**服务器名称**：`<YOUR_SERVER_NAME>`（例如，`ldap.forumsys.com`）。'
- en: '**Default values**: `<CHOOSE ONE OF THEM>` (for example, other directory server).'
  id: totrans-381
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**默认值**：`<CHOOSE ONE OF THEM>`（例如，其他目录服务器）。'
- en: '**Connection section**: These settings contain the basic connection to LDAP.'
  id: totrans-382
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**连接部分**：这些设置包含到LDAP的基本连接。'
- en: '**Base Provider URL**: `<ldap://host:port>` (for example, `ldap://ldap.forumsys.com:389`).'
  id: totrans-383
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基础提供者URL**：`<ldap://host:port>`（例如，`ldap://ldap.forumsys.com:389`）。'
- en: '**Base DN**: `<Distinguished Name>` (for example, `dc=example,dc=com`).'
  id: totrans-384
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基础DN**：`<区分名称>`（例如，`dc=example,dc=com`）。'
- en: '**Principal**: `<LDAP administrator ID>` (for example, `cn=read-only-admin,dc=example,dc=com`).'
  id: totrans-385
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主体**：`<LDAP管理员ID>`（例如，`cn=read-only-admin,dc=example,dc=com`）。'
- en: '**Credentials**: `<LDAP administrator''s password>` (in our case is `password`).'
  id: totrans-386
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**凭据**：`<LDAP管理员密码>`（在我们的例子中是`password`）。'
- en: 'Check the configuration and click on the **Test LDAP Connection** button. It
    should be displaying the following message:'
  id: totrans-387
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查配置并点击**测试LDAP连接**按钮。它应该显示以下消息：
- en: '**Liferay has successfully connected to the LDAP server.**'
  id: totrans-388
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**Liferay已成功连接到LDAP服务器**。'
- en: '**Users section**: These settings cover search filter and user mapping functionality.'
  id: totrans-389
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户部分**：这些设置涵盖搜索过滤器和用户映射功能。'
- en: Note
  id: totrans-390
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Values in this form strictly depend on the LDAP directory schema. Administrator
    should know which fields from LDAP can map as Liferay values.
  id: totrans-391
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此表单中的值严格依赖于LDAP目录模式。管理员应知道哪些LDAP字段可以映射为Liferay值。
- en: '**Authentication Search Filter**: `<Search criteria for users login>` (for
    example, (`uid=@screen_name@`)).'
  id: totrans-392
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**身份验证搜索过滤器**：`<用户登录搜索条件>`（例如，（`uid=@screen_name@`））。'
- en: '**Import Search Filter**: `<Way to identify users>` (for example, (`objectClass=inetOrgPerson`)).'
  id: totrans-393
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**导入搜索过滤器**：`<识别用户的方式>`（例如，（`objectClass=inetOrgPerson`））。'
- en: '**User Mapping section** (maps the LDAP attribute as a Liferay value):'
  id: totrans-394
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户映射部分**（将LDAP属性映射为Liferay值）：'
- en: '**Screen Name** = `uid`'
  id: totrans-395
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**屏幕名称** = `uid`'
- en: '**Email Address** = `mail`'
  id: totrans-396
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**电子邮件地址** = `mail`'
- en: '**Password** = `userPassword`'
  id: totrans-397
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**密码** = `userPassword`'
- en: '**First Name** = `cn`'
  id: totrans-398
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**姓名** = `cn`'
- en: '**Last Name** = `sn`'
  id: totrans-399
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**姓氏** = `sn`'
- en: After configuration, try to check the correctness by clicking on **Test LDAP
    Users**. The system should list users from the LDAP directory.
  id: totrans-400
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 配置完成后，尝试通过点击**测试LDAP用户**来检查正确性。系统应列出LDAP目录中的用户。
- en: '**Groups section**: These settings map LDAP user groups to Liferay user groups.
    It is not required to fill this form. If an administrator wants to configure it,
    the steps are very similar to the example shown previously. There may be a problem
    with the **Import search filter** field. There is usually the `(objectClass=groupOfNames)`
    or `(objectClass=groupOfUniqueNames)` value.'
  id: totrans-401
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**组部分**：这些设置将LDAP用户组映射到Liferay用户组。不需要填写此表单。如果管理员想要配置它，步骤与之前显示的示例非常相似。可能存在**导入搜索过滤器**字段的问题。通常有`(objectClass=groupOfNames)`或`(objectClass=groupOfUniqueNames)`值。'
- en: Save the **LDAP Servers** and **Portal Settings** forms.
  id: totrans-402
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存**LDAP服务器**和**门户设置**表单。
- en: Log out and try to log in as an LDAP user, such as `newton`/`password`.
  id: totrans-403
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注销并尝试以LDAP用户身份登录，例如`newton`/`password`。
- en: Note
  id: totrans-404
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: There are several parameters that are unavailable in the GUI. If there are any
    problems with configuration, check out `portal.properties` under the key prefix,
    `ldap.*`. LDAP configuration is a vast subject and could be difficult to understand
    and properly configure.
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: 在GUI中不可用的参数有几个。如果配置出现问题，请检查键前缀为`ldap.*`下的`portal.properties`文件。LDAP配置是一个庞大的主题，可能难以理解和正确配置。
- en: How it works…
  id: totrans-406
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: 'Liferay provides an Authentication Pipeline mechanism that allows you to define
    many authentication types. By default, there is an enabled `LdapAuth` authenticator,
    as follows:'
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: Liferay提供了一个身份验证管道机制，允许您定义多种身份验证类型。默认情况下，有一个启用的`LdapAuth`身份验证器，如下所示：
- en: '[PRE37]'
  id: totrans-408
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: In general, every login process, instead of default authentication, tries to
    invoke a list of authenticators defined in `auth.pipeline.pre`. If any authenticator
    returns a success, it means the user is correctly logged in to the Liferay Portal.
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，每个登录过程，而不是默认认证，都会尝试调用在 `auth.pipeline.pre` 中定义的认证器列表。如果任何认证器返回成功，则表示用户已正确登录到
    Liferay 门户。
- en: 'The `LDAPAuth` class implements the `com.liferay.portal.security.auth.Authenticator`
    interface, which provides the following methods:'
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: '`LDAPAuth` 类实现了 `com.liferay.portal.security.auth.Authenticator` 接口，该接口提供了以下方法：'
- en: '`authenticateByEmailAddress`'
  id: totrans-411
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`authenticateByEmailAddress`'
- en: '`authenticateByScreenName`'
  id: totrans-412
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`authenticateByScreenName`'
- en: '`authenticateByUserId`'
  id: totrans-413
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`authenticateByUserId`'
- en: To communicate with the LDAP server, Liferay uses classes from the `javax.naming.ldap`
    package. It provides support for LDAPv3 extended operations and controls.
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 为了与 LDAP 服务器通信，Liferay 使用 `javax.naming.ldap` 包中的类。它提供了对 LDAPv3 扩展操作和控制的支持。
- en: 'The magic trio: Liferay, CAS, and LDAP'
  id: totrans-415
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 魔法三人组：Liferay、CAS 和 LDAP
- en: The next challenge is to connect Liferay, CAS, and LDAP authentication. In this
    combination, the CAS system provides single sign-on mechanism, the LDAP system
    stores the user's credentials, and Liferay uses both systems to authenticate users
    coming from LDAP. This configuration is used in many deployments. Furthermore,
    we dare to say that it should be considered as a standard solution when people
    think about intranet in their companies.
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 下一挑战是连接 Liferay、CAS 和 LDAP 认证。在这个组合中，CAS 系统提供单点登录机制，LDAP 系统存储用户的凭证，Liferay 使用这两个系统来认证来自
    LDAP 的用户。这种配置在许多部署中使用。此外，我们敢说，当人们在公司内思考内部网时，它应该被视为一个标准解决方案。
- en: Getting ready
  id: totrans-417
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Study the *Integration with CAS SSO* and *Liferay and the LDAP integration*
    recipes explained previously. Set up the system in accordance with these recipes.
    Check out the connection to the LDAP Server from Liferay and verify that the CAS
    authentication is enabled.
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: 研究之前解释的 *与 CAS SSO 集成* 和 *Liferay 与 LDAP 集成* 菜单。根据这些菜单设置系统。检查 Liferay 到 LDAP
    服务器的连接，并验证 CAS 认证是否已启用。
- en: How to do it…
  id: totrans-419
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'To integrate Liferay with CAS Server where LDAP is the authentication provider,
    follow these steps:'
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 要将 Liferay 与 CAS 服务器集成，其中 LDAP 是认证提供者，请按照以下步骤操作：
- en: Find the archive with the CAS server downloaded from [http://downloads.jasig.org/cas/](http://downloads.jasig.org/cas/).
    Copy `cas-server-4.0.0/modules/cas-server-support-ldap-4.0.0.jar` to the `${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF/lib`
    directory.
  id: totrans-421
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找到从 [http://downloads.jasig.org/cas/](http://downloads.jasig.org/cas/) 下载的 CAS
    服务器存档。将 `cas-server-4.0.0/modules/cas-server-support-ldap-4.0.0.jar` 复制到 `${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF/lib`
    目录中。
- en: By default, CAS uses the `ldaptive` library for communication with LDAP. Download
    `ldaptive.jar` ([http://central.maven.org/maven2/org/ldaptive/ldaptive/1.0.3/ldaptive-1.0.3.jar](http://central.maven.org/maven2/org/ldaptive/ldaptive/1.0.3/ldaptive-1.0.3.jar))
    and place this archive in the `${TOMCAT_HOME} /webapps/cas-server-webapp-4.0.0/WEB-INF/lib`
    directory.
  id: totrans-422
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 默认情况下，CAS 使用 `ldaptive` 库与 LDAP 进行通信。下载 `ldaptive.jar` ([http://central.maven.org/maven2/org/ldaptive/ldaptive/1.0.3/ldaptive-1.0.3.jar](http://central.maven.org/maven2/org/ldaptive/ldaptive/1.0.3/ldaptive-1.0.3.jar))
    并将此存档放置在 `${TOMCAT_HOME} /webapps/cas-server-webapp-4.0.0/WEB-INF/lib` 目录中。
- en: 'Open the `${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF/deployerConfigContext.xml`
    file and specify the following beans:'
  id: totrans-423
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 `${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF/deployerConfigContext.xml`
    文件并指定以下 Bean：
- en: First, define the bean that will be a primary authentication handler and set
    it as LDAP authentication.
  id: totrans-424
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 首先，定义将作为主要认证处理器的 Bean，并将其设置为 LDAP 认证。
- en: Note
  id: totrans-425
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Make sure that you are not using a previously configured database authentication
    handler.
  id: totrans-426
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 确保您没有使用先前配置的数据库认证处理器。
- en: 'The primary authentication handler contains mapping fields between LDAP and
    CAS. Keys are LDAP attribute names, and values are CAS attribute names. This definition
    has a reference to the authenticator bean, which will be described in the next
    section:'
  id: totrans-427
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 主要认证处理器包含 LDAP 和 CAS 之间的映射字段。键是 LDAP 属性名称，值是 CAS 属性名称。此定义引用了将在下一节中描述的认证器 Bean：
- en: '[PRE38]'
  id: totrans-428
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'The authenticator bean defines the method of authentication. It contains references
    to the DN (distinguished name) resolver and authentication handler, which is responsible
    for establishing connection. It should be included in our `deployerConfigContext.xml`
    file:'
  id: totrans-429
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 认证器 Bean 定义了认证方法。它包含对 DN（区分名称）解析器和认证处理器的引用，该处理器负责建立连接。它应包含在我们的 `deployerConfigContext.xml`
    文件中：
- en: '[PRE39]'
  id: totrans-430
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Distinguished name resolver defines resolution implementation. In this case,
    `FormatDnResolver` is used:'
  id: totrans-431
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 被区分名称解析器定义了解析实现。在这种情况下，使用`FormatDnResolver`：
- en: '[PRE40]'
  id: totrans-432
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'Next, bean definitions are responsible for establishing connection with LDAP.
    There are many settings, which are described in the `ldaptive` library documentation:'
  id: totrans-433
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 接下来，bean定义负责与LDAP建立连接。有许多设置，这些设置在`ldaptive`库文档中有描述：
- en: '[PRE41]'
  id: totrans-434
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'Add the following properties to the `${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF/cas.properties`
    file:'
  id: totrans-435
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下属性添加到`${TOMCAT_HOME}/webapps/cas-server-webapp-4.0.0/WEB-INF/cas.properties`文件中：
- en: '[PRE42]'
  id: totrans-436
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'Check in the `portal-ext.properties` file whether CAS authentication is enabled:'
  id: totrans-437
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`portal-ext.properties`文件中检查是否启用了CAS认证：
- en: '[PRE43]'
  id: totrans-438
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE43]'
- en: Restart the Tomcat server.
  id: totrans-439
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新启动Tomcat服务器。
- en: After finishing the configuration described previously, it should be possible
    to authenticate to Liferay by the CAS server and LDAP user credentials (login
    and password) such as `newton`/`password`.
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: 完成之前描述的配置后，应该可以通过CAS服务器和LDAP用户凭证（登录名和密码）如`newton`/`password`来认证Liferay。
- en: How it works…
  id: totrans-441
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何工作…
- en: Configuration for the LDAP schema in many cases is different. It is not possible
    to provide the correct configuration that will be flexible. In the configuration
    mentioned previously, highlighted phrases are sensitive and should be fitted to
    a specific LDAP schema.
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多情况下，LDAP架构的配置是不同的。无法提供灵活的正确配置。在之前提到的配置中，高亮显示的短语是敏感的，应该适应特定的LDAP架构。
- en: The biggest advantage of this solution is that there is only one place that
    stores users' credentials (LDAP server) and exactly one place that provides authentication
    mechanism (CAS SSO). Liferay is just a client of these services.
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: 这个解决方案的最大优点是，只有一个地方存储用户的凭证（LDAP服务器）和确切的一个地方提供认证机制（CAS SSO）。Liferay只是这些服务的客户端。
- en: '![How it works…](img/image00303.jpeg)'
  id: totrans-444
  prefs: []
  type: TYPE_IMG
  zh: '![如何工作…](img/image00303.jpeg)'
- en: 'Let''s follow this process:'
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们跟随这个流程：
- en: A new user wants to log in to the Liferay system. Liferay doesn't have any information
    about this user.
  id: totrans-446
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 新用户想要登录到Liferay系统。Liferay没有关于此用户的信息。
- en: Liferay checks whether CAS SSO is enabled and redirects the user to the CAS
    authentication provider.
  id: totrans-447
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Liferay检查CAS SSO是否启用，并将用户重定向到CAS认证提供者。
- en: The CAS authentication provider renders the login form.
  id: totrans-448
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: CAS认证提供者渲染登录表单。
- en: The user types the LDAP login and LDAP password and sends the request to the
    CAS server.
  id: totrans-449
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户输入LDAP登录名和LDAP密码，并将请求发送到CAS服务器。
- en: The CAS server asks the LDAP server for credentials and checks the answer from
    LDAP.
  id: totrans-450
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: CAS服务器请求LDAP服务器凭证并检查LDAP的答案。
- en: If the answer is OK, the CAS server sends a success message to the Liferay authentication
    ticket.
  id: totrans-451
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果答案是OK，CAS服务器将发送成功消息到Liferay认证票据。
- en: Liferay checks whether it has that user in its database. If it doesn't, it asks
    the LDAP server about user details such as login, name, surname, e-mail address,
    and so on.
  id: totrans-452
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Liferay检查其数据库中是否有该用户。如果没有，它将询问LDAP服务器有关用户详情，如登录名、姓名、姓氏、电子邮件地址等。
- en: Liferay creates account in its database and successfully logs in a new user.
  id: totrans-453
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Liferay在其数据库中创建账户并成功登录新用户。
- en: See also
  id: totrans-454
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: For information on how to export Liferay users, refer to the *Exporting users*
    recipe in [Chapter 3](part0030.xhtml#aid-SJGS1 "Chapter 3. Working with a Liferay
    User / User Group / Organization"), *Working with a Liferay User / User Group
    / Organization*.
  id: totrans-455
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于如何导出Liferay用户的信息，请参考第3章中的*导出用户*配方，*与Liferay用户/用户组/组织一起工作*。
- en: For information on how to build a scalable infrastructure, refer to the *Scalable
    infrastructure* recipe in [Chapter 12](part0088.xhtml#aid-2JTHG1 "Chapter 12. Basic
    Performance Tuning"), *Basic Performance Tuning*.
  id: totrans-456
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于如何构建可伸缩基础设施的信息，请参考第12章中的*可伸缩基础设施*配方，*基本性能调整*。
