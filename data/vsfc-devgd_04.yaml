- en: Chapter 4. Visualforce Custom Components
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第四章：Visualforce 自定义组件
- en: Salesforce has a large collection of standard Visualforce components such as
    `<apex:detail>`, `<apex:pageBlock>`, `<apex:pageBlockTable>`, and `<apex:relatedList>`.
    They are ready to be used in Visualforce pages, and the Force.com platform allows
    us to build our own Visualforce components which can be used in Visualforce pages.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Salesforce 拥有一系列标准 Visualforce 组件，如 `<apex:detail>`、`<apex:pageBlock>`、`<apex:pageBlockTable>`
    和 `<apex:relatedList>`。它们已准备好在 Visualforce 页面中使用，并且 Force.com 平台允许我们构建自己的 Visualforce
    组件，这些组件可以在 Visualforce 页面中使用。
- en: 'This chapter serves as an overview of Visualforce custom components and further
    explains how to create a custom component. This chapter covers the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章作为 Visualforce 自定义组件的概述，并进一步解释了如何创建自定义组件。本章涵盖了以下主题：
- en: Understanding Visualforce custom components
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解 Visualforce 自定义组件
- en: How to create and use a custom component in a Visualforce page
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何在 Visualforce 页面中创建和使用自定义组件
- en: Custom attributes and custom controllers
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自定义属性和自定义控制器
- en: Let's build our own Visualforce custom components.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们构建自己的 Visualforce 自定义组件。
- en: Understanding Visualforce custom components
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解 Visualforce 自定义组件
- en: There are lots of standard Visualforce components (such as `<apex:detail>`,
    `<apex:pageBlock>`, `<apex:pageBlockTable>`, and `<apex:relatedList>`) which can
    be reused in Visualforce pages. A standard Visualforce component is a pre-built,
    encapsulated code segment. These standard Visualforce components are built according
    to common usage.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多标准 Visualforce 组件（如 `<apex:detail>`、`<apex:pageBlock>`、`<apex:pageBlockTable>`
    和 `<apex:relatedList>`），这些组件可以在 Visualforce 页面中重用。标准 Visualforce 组件是一个预构建的、封装的代码段。这些标准
    Visualforce 组件是根据常见用法构建的。
- en: The Force.com platform allows us to develop custom Visualforce components that
    can be reused within a particular application. Custom components can be developed
    using both Apex and Visualforce. For example, suppose we want to create a customer
    summary with recent orders and we need to use this functionality in different
    locations in our order processing app. We also need to specify the number of recent
    orders. According to the specified number, the number of recent orders displayed
    in the customer's summary will be changed. The use of Visualforce custom components
    becomes the best choice for implementing such a specific requirement.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: Force.com 平台允许我们开发可在特定应用程序中重用的自定义 Visualforce 组件。自定义组件可以使用 Apex 和 Visualforce
    进行开发。例如，假设我们想要创建一个包含最近订单的客户摘要，并且需要在我们的订单处理应用程序的不同位置使用此功能。我们还需要指定最近订单的数量。根据指定的数量，客户摘要中显示的最近订单数量将会改变。使用
    Visualforce 自定义组件是实现此类特定要求的最优选择。
- en: A Visualforce custom component can have zero or more attributes to pass as parameters
    into the component. A custom component with attributes is like a parameterized
    Apex method. We can change the value of an attribute during the final usage level
    (in a Visualforce page).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: Visualforce 自定义组件可以具有零个或多个属性作为参数传递到组件中。具有属性的自定义组件类似于参数化的 Apex 方法。我们可以在最终使用级别（在
    Visualforce 页面中）更改属性的值。
- en: Creating and using a custom component
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建和使用自定义组件
- en: 'We can create a Visualforce component to use in a Visualforce page. Navigate
    to the following path to create a new Visualforce component:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以创建一个 Visualforce 组件用于在 Visualforce 页面中使用。导航到以下路径以创建一个新的 Visualforce 组件：
- en: '**Your Name** | **Setup** | **Develop** | **Components** | **New**'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '**您的姓名** | **设置** | **开发** | **组件** | **新建**'
- en: '![Creating and using a custom component](img/9818_04_01.jpg)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![创建和使用自定义组件](img/9818_04_01.jpg)'
- en: Create new Visualforce components
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 创建新的 Visualforce 组件
- en: 'We need to specify the following properties while creating a custom component:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建自定义组件时，我们需要指定以下属性：
- en: '**Label**: This custom component will be identified in the setup tools by using
    the label.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标签**：此自定义组件将通过标签在设置工具中识别。'
- en: '**Name**: This custom component will be identified in Visualforce markup by
    using `name`. This must be unique within the organization.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**名称**：此自定义组件将通过 `name` 在 Visualforce 标记中识别。必须在组织内是唯一的。'
- en: '**Description**: This gives the description of the custom component.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**描述**：这给出了自定义组件的描述。'
- en: '**Body**: The Visualforce markup must be placed within the body section.![Creating
    and using a custom component](img/9818_04_02.jpg)'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主体**：Visualforce 标记必须放置在主体部分。![创建和使用自定义组件](img/9818_04_02.jpg)'
- en: Note
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The name of the custom component should begin with a letter, and it should not
    end with an underscore. Further, spaces or two consecutive underscores should
    not be included in the name.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 自定义组件的名称应该以字母开头，并且不应该以下划线结尾。此外，名称中不应包含空格或连续的两个下划线。
- en: The maximum amount of data that a custom component can contain is 1 MB, or approximately
    1,000,000 characters.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 自定义组件可以包含的最大数据量是1 MB，或大约1,000,000个字符。
- en: We can specify the version of Visualforce and the API used with the particular
    component by using the version setting.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过使用版本设置来指定与特定组件一起使用的Visualforce版本和API。
- en: 'The body of a custom component can be defined as follows:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 自定义组件的主体可以定义如下：
- en: '[PRE0]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Tip
  id: totrans-27
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: The component markup is same as other Visualforce pages. It can be a combination
    of Visualforce and HTML tags. We can also add customized CSS and JavaScript.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 组件标记与其他Visualforce页面相同。它可以是由Visualforce和HTML标签组合而成的。我们还可以添加自定义CSS和JavaScript。
- en: 'All the markup should be defined within the `<apex:component>` tag. Our custom
    component example is a customer''s summary with recent orders. Suppose our custom
    component name is `customerSummary`, we can use this component in multiple Visualforce
    pages. The usage is as follows:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 所有标记都应该定义在`<apex:component>`标签内。我们的自定义组件示例是一个包含最近订单的客户摘要。假设我们的自定义组件名称是`customerSummary`，我们可以在多个Visualforce页面上使用此组件。使用方法如下：
- en: '[PRE1]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Custom attributes and custom controllers
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自定义属性和自定义控制器
- en: When we are creating complex custom components, we need to use some other features
    to build custom components. Mainly, we have to use custom attributes and custom
    controllers for custom components. The attributes can be defined in `<apex:component>`
    for passing values from the Visualforce page (the page that used the component)
    to the custom component or to the component's controller.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们创建复杂的自定义组件时，我们需要使用一些其他功能来构建自定义组件。主要的是，我们必须为自定义组件使用自定义属性和自定义控制器。属性可以在`<apex:component>`中定义，用于从Visualforce页面（使用组件的页面）传递值到自定义组件或组件的控制器。
- en: 'We have implemented the example explained from the beginning of this chapter.
    The following is the component markup and it contains the attribute''s and the
    component''s definitions. We have two attributes to be passed, which are customer
    ID and the number of recent orders that we want to show in the page. These two
    parameters are used to pass the values to the component''s controller:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经实现了从本章开头解释的示例。以下是对组件标记的描述，它包含了属性和组件的定义。我们有两个要传递的属性，即客户ID和我们要在页面上显示的最近订单数量。这两个参数用于将值传递到组件的控制器：
- en: '[PRE2]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The following code snippet shows the custom controller that is associated with
    the `cutomerSummary` custom component. This controller is used to manipulate the
    attribute''s values. In this example, we have queried the customer record and
    the recent order details of the particular customer. The query results of `CurrentCustomer`
    and `RecentOrderList` depend on the `CusID` and `RecentNo` values:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码片段显示了与`cutomerSummary`自定义组件关联的自定义控制器。此控制器用于操作属性值。在这个例子中，我们查询了特定客户的客户记录和最近订单详情。`CurrentCustomer`和`RecentOrderList`的查询结果取决于`CusID`和`RecentNo`的值：
- en: '[PRE3]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'This is the way of using our custom component. Here, we have passed the customer
    ID and the number of recent orders values that we want to see:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是使用我们的自定义组件的方法。在这里，我们传递了我们要看到的客户ID和最近订单数量的值：
- en: '[PRE4]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The following screenshot shows the result of the `customerSummary` custom component:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了`customerSummary`自定义组件的结果：
- en: '![Custom attributes and custom controllers](img/9818_04_03.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![自定义属性和自定义控制器](img/9818_04_03.jpg)'
- en: Summary
  id: totrans-41
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we saw an overview of Visualforce custom components. We now
    have the knowledge to create and use Visualforce custom components. With the usage
    of Visualforce custom components, we learned the mechanisms for reusing code in
    Visualforce. We have seen how to build more customizable custom components by
    using custom attributes and custom controllers.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们概述了Visualforce自定义组件。现在我们有了创建和使用Visualforce自定义组件的知识。通过使用Visualforce自定义组件，我们学习了在Visualforce中重用代码的机制。我们看到了如何通过使用自定义属性和自定义控制器来构建更可定制的自定义组件。
