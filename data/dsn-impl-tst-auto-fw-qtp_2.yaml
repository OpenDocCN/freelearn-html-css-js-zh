- en: Chapter 2. Essentials of Automation
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第2章. 自动化的基本要素
- en: In [Chapter 1](ch01.html "Chapter 1. Automation Life Cycle and Automation Goals"),
    *Automation Life Cycle and Automation Goals*, we learned about the test automation
    life cycle and automation goals. The basic features of the test automation are
    record and replay. These features allow the user to play scripts many times and
    compare expected values with actual values. This approach is simple and requires
    little or no knowledge of coding and can be applied to any supported application
    that has a graphical user interface. One should be familiar with basic QTP features,
    such as recording, replay, OR (Object Repository) creation, checkpoints, synchronization,
    actions, reporting, error handling, parameterization, and configuration. One should
    also know how to use environment variables to make the script complete and reusable.
    This chapter deals with recording or creating the test scripts, script creation
    life cycle, QTP features, and various ways of using these features to make complete
    reusable scripts. The intent of this chapter is not to gain in-depth knowledge
    but to get familiarized with these features for script creation and its enhancement.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章. 自动化生命周期和自动化目标")中，*自动化生命周期和自动化目标*，我们学习了测试自动化生命周期和自动化目标。测试自动化的基本功能是录制和回放。这些功能允许用户多次播放脚本，并将预期值与实际值进行比较。这种方法简单，且对编码知识的要求很少或没有，可以应用于任何具有图形用户界面的支持应用程序。应该熟悉基本QTP功能，如录制、回放、对象库（OR）创建、检查点、同步、动作、报告、错误处理、参数化和配置。还应该了解如何使用环境变量使脚本完整且可重用。本章旨在处理录制或创建测试脚本、脚本创建生命周期、QTP功能和各种使用这些功能创建完整可重用脚本的方法。本章的目的是熟悉这些功能，以便于脚本创建和增强。
- en: About QTP
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 关于QTP
- en: HP **QuickTest Professional** (**QTP** or QuickTest) or **Unified Functional
    Tester** (**UFT**) is the test automation tool for functional and regression test
    case automation. HP QuickTest Professional supports keyword view and scripting
    interfaces to automate the test. It uses VBScript as a scripting language to specify
    test scripts and working with the objects and controls in the application under
    test.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: HP **QuickTest Professional** (**QTP**或QuickTest)或**Unified Functional Tester**
    (**UFT**)是用于功能性和回归测试用例自动化的测试自动化工具。HP QuickTest Professional支持关键字视图和脚本接口来自动化测试。它使用VBScript作为脚本语言来指定测试脚本，并与测试中的应用程序中的对象和控件一起工作。
- en: QTP is a tool that provides support for automated software testing and framework
    creation. The basic components that support QTP in recording and replay mechanism
    are test object model, test object, and object repository. The knowledge and understanding
    of these components is helpful in creating scripts.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: QTP是一个提供自动化软件测试和框架创建支持的工具。支持QTP录制和回放机制的基本组件包括测试对象模型、测试对象和对象库。对这些组件的了解和理解有助于创建脚本。
- en: The QuickTest object model
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: QuickTest对象模型
- en: The test object model is a collection of objects and classes, which represents
    the objects in AUT. Each class has a set of properties for its identification;
    QTP uses a subset of the properties to identify the object uniquely at runtime.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 测试对象模型是一组对象和类，它表示AUT中的对象。每个类都有一组属性用于其标识；QTP使用属性的一个子集在运行时唯一地识别对象。
- en: Test script is a combination of standard VBScript statements and statements
    that use QuickTest test objects, methods, and properties. The QuickTest object
    model contains one section for each add-in environment available with the QTP
    installation, as well as a special section for utility and supplemental objects.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 测试脚本是由标准VBScript语句和用于QuickTest测试对象、方法和属性的语句组合而成的。QuickTest对象模型包含一个部分，用于表示QTP安装中可用的每个插件环境，以及一个用于实用程序和补充对象的特殊部分。
- en: Test objects
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 测试对象
- en: QTP uses a test object to represent an object in AUT. Each test object has one
    or more methods and properties that are used to perform operations and retrieve
    values for that object. Each test object has a number of identification properties
    that describe the object.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: QTP使用测试对象来表示AUT中的对象。每个测试对象都有一组方法和属性，用于执行操作和检索该对象的价值。每个测试对象都有一些标识属性，用于描述该对象。
- en: Object identification properties can be used in the object repository description,
    programmatic descriptions, checkpoints, output values, test steps, and passed
    as argument values for `GetTOProperty` and `GetROProperty` methods. A runtime
    object is the actual object in AUT on which methods are performed during the run
    session.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 对象识别属性可以用在对象存储库描述、程序性描述、检查点、输出值、测试步骤中，并作为 `GetTOProperty` 和 `GetROProperty`
    方法的参数值传递。运行时对象是在运行会话期间在 AUT 上执行方法的实际对象。
- en: Object repositories
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 对象存储库
- en: 'Set up the resources before the test is created. One of the most important
    resources for any test is object repository, which stores the test objects (and
    other object types) used in your test. QuickTest can store the test objects it
    learns in two types of object repository files: shared and local.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建测试之前设置资源。任何测试最重要的资源之一是对象存储库，它存储了测试中使用的测试对象（以及其他对象类型）。QuickTest 可以在两种类型的对象存储库文件中存储它所学习的测试对象：共享和本地。
- en: A **shared object repository** contains test objects that can be used across
    multiple actions.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 一个**共享对象存储库**包含可以在多个操作中使用的测试对象。
- en: A **local object repository** stores test objects that can only be used in one
    specific action and not in any other action.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 一个**本地对象存储库**存储只能用于特定操作的测试对象，不能用于其他操作。
- en: Record and replay
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 记录和回放
- en: Recording is a process of capturing human actions performed on AUT and simultaneously
    creating a script, which can be replayed on AUT many times.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 记录是一个捕捉在 AUT 上执行的人类动作的过程，并同时创建一个可以在 AUT 上多次回放的脚本。
- en: What happens when we record
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 记录时会发生什么
- en: 'When a user records the scripts, QTP perform various tasks as shown in following
    steps:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户记录脚本时，QTP 会执行以下步骤中的各种任务：
- en: QTP uses a test object model. It identifies the test object and operation performed
    on an object that belongs to AUT.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: QTP 使用测试对象模型。它识别属于 AUT 的测试对象和对象上执行的操作。
- en: Then it stores the test object in a local object repository on which the user
    performed the action.
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后将测试对象存储在用户执行操作的本地对象存储库中。
- en: Object identification properties of the test object are captured, which allows
    identification of the object uniquely at time of replay.
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 捕获测试对象的对象识别属性，这允许在回放时唯一地识别该对象。
- en: It provides a logical name to a test object, which makes objects' names readable.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 它为测试对象提供了一个逻辑名称，这使得对象的名称易于阅读。
- en: 'Create a test step; a test step contains test objects including parent(s),
    operation, and data, if applicable. The following code is an example of the test
    step:'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建测试步骤；测试步骤包含测试对象，包括父对象、操作和（如果适用）数据。以下代码是测试步骤的示例：
- en: '[PRE0]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'In the previous test step, `Dialog` is the class name, `Login` is its logical
    name, and it is a parent of the `WinEdit` object. `WinEdit` is the class and `Set`
    is the operation, which sets the value as `ashish` to the object whose logical
    name is `Agent Name`:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一个测试步骤中，`Dialog` 是类名，`Login` 是其逻辑名称，它是 `WinEdit` 对象的父对象。`WinEdit` 是类，`Set`
    是操作，它将值设置为 `ashish` 到逻辑名称为 `Agent Name` 的对象：
- en: 'The steps for recording are as follows:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 记录的步骤如下：
- en: Click on the **Record** button on the toolbar as shown in the following screenshot:![What
    happens when we record](img/1027EN_02_01.jpg)
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击工具栏上的**记录**按钮，如图所示：![记录时会发生什么](img/1027EN_02_01.jpg)
- en: Perform the action on the AUT.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 AUT 上执行操作。
- en: Repeat step 2 to record other test steps.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复步骤 2 以记录其他测试步骤。
- en: What happens when we replay
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 回放时会发生什么
- en: 'When QTP replays the scripts, it performs various tasks as shown in the following
    steps:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 当 QTP 回放脚本时，它执行以下步骤中的各种任务：
- en: QTP finds the test object.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: QTP 找到测试对象。
- en: 'It identifies the test object uniquely; in some cases it may be using one of
    the following items: ordinal identifiers, smart identification, and relational
    identifiers.'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 它唯一地识别测试对象；在某些情况下，它可能使用以下一项或多项：序号标识符、智能识别和关系标识符。
- en: Perform the intended operation on the runtime object.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在运行时对象上执行预期操作。
- en: 'The steps for recording are as follows:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 记录的步骤如下：
- en: 'Click on the **Run** button in the toolbar as shown in the following screenshot:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 点击工具栏上的**运行**按钮，如图所示：
- en: '![What happens when we replay](img/1027EN_02_01.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![回放时会发生什么](img/1027EN_02_01.jpg)'
- en: Script development
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 脚本开发
- en: 'The steps for script development are as follows:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本开发的步骤如下：
- en: Analyze Application Under Test.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 分析待测试的应用程序。
- en: Create OR (add a test object manually).
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建 OR（手动添加测试对象）。
- en: Add test steps.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加测试步骤。
- en: Enhance scripts by adding checkpoints, synchronization points, and so on.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过添加检查点、同步点等增强脚本。
- en: Create a structure by inserting functions, actions, loops, and control statements.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过插入函数、操作、循环和控制语句创建结构。
- en: Run and debug the test.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行和调试测试。
- en: Analyze results and report defects.
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 分析结果并报告缺陷。
- en: Drag-and-drop object from OR to expert view.
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从OR拖放对象到专家视图。
- en: We will discuss the preceding steps 4, 5, and 6 in later chapters.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在后续章节中讨论前述步骤4、5和6。
- en: Analyzing an application
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分析应用程序
- en: Determine the development environment to load the relevant QuickTest add-ins
    and provide support for the objects in AUT. Analyze the flow and plan tests and
    actions accordingly. Decide the organization of the test, and ensure that the
    test and AUT are set to match the need of the automation.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 确定开发环境以加载相关的QuickTest插件并提供对AUT中对象的支持。分析流程并相应地规划测试和操作。决定测试的组织结构，并确保测试和AUT设置为满足自动化的需求。
- en: Creating OR (adding test objects to OR)
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建OR（向OR添加测试对象）
- en: 'When an object is added to an object repository, QuickTest performs the following
    actions:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 当对象被添加到对象库时，QuickTest执行以下操作：
- en: It identifies the test object class, which represents the learned object and
    creates the appropriate test object.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 它识别测试对象类，该类代表学习到的对象并创建适当的测试对象。
- en: It reads the current value of the object's properties in AUT as well as stores
    the list of identification properties. It selects the identification properties
    that can identify the test object uniquely.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 它读取对象在AUT中的当前属性值以及存储识别属性列表。它选择可以唯一识别测试对象的识别属性。
- en: 'It chooses a unique name for the test object, generally using the value of
    one of its prominent properties: for example, `name`, if the object has one.'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 它为测试对象选择一个唯一名称，通常使用其突出属性之一的价值：例如，如果对象有一个，则使用`name`。
- en: 'Following are the ways to add the test object to OR:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是向OR添加测试对象的方法：
- en: Record a test step.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记录测试步骤。
- en: Add object to local.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将对象添加到本地。
- en: Create an object description.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建对象描述。
- en: Create a test object by using define new test objects.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过使用定义新测试对象创建测试对象。
- en: OR Manager Navigate and Learn or Add object option.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: OR管理器导航和学习或添加对象选项。
- en: Adding test objects to the local object repository from **Active Screen**.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**Active Screen**将测试对象添加到本地对象库。
- en: Recording a test step
  id: totrans-63
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 记录测试步骤
- en: Test objects are created automatically and added to the local OR when a user
    records a step. Add object to local.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户记录一个步骤时，测试对象会自动创建并添加到本地OR中。将对象添加到本地。
- en: Adding a test object to OR
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 将测试对象添加到OR
- en: 'Add a test object to the local OR through the following steps:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 通过以下步骤将测试对象添加到本地OR：
- en: Navigate to **Resources** | **Object Repository** | **Add object to local**.
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**资源** | **对象库** | **添加对象到本地**。
- en: Click on the button **Add Object to local**.
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加对象到本地**按钮。
- en: Click on the hand pointer to the object we want to add from AUT.
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击我们想要从AUT中添加的对象的手指针。
- en: Click on **OK**. The object is added to the OR as shown in the following screenshot:![Adding
    a test object to OR](img/1027EN_02_02.jpg)
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**。对象已添加到OR中，如下截图所示：![将测试对象添加到OR](img/1027EN_02_02.jpg)
- en: Creating an object description
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建对象描述
- en: 'The test object can be created without recording, by providing an object description.
    Refer to the following screenshot. The test object class name is `WinComboBox`
    and it has two description properties, which are stored with a logical name `Fly
    From`:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 测试对象可以通过提供对象描述来创建，而无需记录。请参考以下截图。测试对象类名为`WinComboBox`，它有两个描述属性，这些属性以逻辑名称`Fly
    From`存储：
- en: '![Creating an object description](img/1027EN_02_03.jpg)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![创建对象描述](img/1027EN_02_03.jpg)'
- en: 'When we record the test step to select an option from the **Fly From** combobox,
    the following script is generated:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们记录测试步骤以从**Fly From**组合框中选择一个选项时，将生成以下脚本：
- en: '[PRE1]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'We can use the object description in the test steps directly, as shown in the
    following code:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以直接在测试步骤中使用对象描述，如下所示：
- en: '[PRE2]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Both statements are the same when we replay the script, one uses an object from
    the OR and the other one uses the description directly. When we use programmatic
    description, the logical name is replaced by the pair(s) of the identification
    properties and its values.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们回放脚本时，这两个语句是相同的，一个使用OR中的对象，另一个直接使用描述。当我们使用程序性描述时，逻辑名称被替换为识别属性及其值的对。
- en: Creating a test object using Define New Test Object
  id: totrans-79
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用“定义新测试对象”创建测试对象
- en: 'To define a new object, we should know its class and its identification properties.
    Perform the following steps:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 要定义一个新对象，我们应该知道它的类及其标识属性。执行以下步骤：
- en: Navigate to **Resources** | **Object Repository** | **Define New Test Object**.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**资源** | **对象库** | **定义新测试对象**。
- en: Filter **Environment** from the **Define New Test Object** window.
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**定义新测试对象**窗口中筛选**环境**。
- en: Select the class from the **Class** drop-down box.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**类**下拉框中选择班级。
- en: Enter a logical name.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入一个逻辑名称。
- en: Provide the value for the **Identification** property (1 to n).
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供**标识**属性的值（1到n）。
- en: If required, add some identification properties.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如有需要，添加一些标识属性。
- en: Click on the **Add** button to add a test object to the OR:![Creating a test
    object using Define New Test Object](img/1027EN_02_04.jpg)
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加**按钮将测试对象添加到OR中：![使用“定义新测试对象”创建测试对象](img/1027EN_02_04.jpg)
- en: Select the environment displayed based on the loaded add-ins, select **Class**,
    and provide a logical name.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 根据加载的插件选择显示的环境，选择**类**，并提供一个逻辑名称。
- en: OR Manager Navigate and Learn and Add Object options
  id: totrans-89
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: OR管理器导航和学习以及添加对象选项
- en: How can I learn GUI Objects in one go?
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何一次性学习GUI对象？
- en: Use Navigate and Learn in the OR Manager.
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在OR管理器中使用导航和学习功能。
- en: The Navigate and Learn toolbar
  id: totrans-92
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 导航和学习工具栏
- en: 'This toolbar allows you to add multiple test objects to a shared object repository
    while you navigate through your application. Following are the steps to learn
    to navigate the object in the object repository manager:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 此工具栏允许您在导航应用程序时将多个测试对象添加到共享对象库中。以下是在对象库管理器中学习导航对象的步骤：
- en: Navigate to **Resources** | **Object Repository Manager** | **Object** | **Navigate
    and Learn** or press *F6*.![The Navigate and Learn toolbar](img/1027EN_02_05.jpg)
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**资源** | **对象库管理器** | **对象** | **导航和学习**或按*F6*。![导航和学习工具栏](img/1027EN_02_05.jpg)
- en: Select a window to learn. The selected window and its descendant objects are
    added to the active shared object repository according to a predefined object
    filter.
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择一个窗口进行学习。根据预定义的对象筛选器，选定的窗口及其后代对象被添加到活动共享对象库中。
- en: Adding a test object using the OR Manager Add Object option
  id: totrans-96
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用OR管理器的“添加对象”选项添加测试对象
- en: Navigate to **Resources** | **Object Repository Manager** | **Objects** | **Add
    Object**. Click on the hand pointer and select the window.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**资源** | **对象库管理器** | **对象** | **添加对象**。点击手指指针并选择窗口。
- en: The object filter is used for the **Navigate and Learn** option as well as the
    **Add Objects** option.![Adding a test object using the OR Manager Add Object
    option](img/1027EN_02_06.jpg)
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对象筛选器用于**导航和学习**选项以及**添加对象**选项。![使用OR管理器添加对象选项添加测试对象](img/1027EN_02_06.jpg)
- en: 'See the description of each filter in the following table:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格中说明了每个筛选器的描述：
- en: '| UI Elements | Description |'
  id: totrans-100
  prefs: []
  type: TYPE_TB
  zh: '| UI元素 | 描述 |'
- en: '| --- | --- |'
  id: totrans-101
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| **Selected object only (no descendants** **)** | This option allows you to
    select objects without descendants and add the selected ones by previously using
    selected and its properties. |'
  id: totrans-102
  prefs: []
  type: TYPE_TB
  zh: '| **仅选定的对象（无后代** **)** | 此选项允许您选择没有后代的对象，并通过先前选择及其属性添加选定的对象。 |'
- en: '| **Default object types** | This option enables adding selected objects and
    their descendants to the object repository. The objects selected are specified
    by the default filter option. |'
  id: totrans-103
  prefs: []
  type: TYPE_TB
  zh: '| **默认对象类型** | 此选项允许将选定的对象及其后代添加到对象库中。选定的对象由默认过滤器选项指定。 |'
- en: '| **All object types** | This option allows adding the objects and their descendants
    with properties and values selected previously in the object repository using
    the **Selected object types** option. |'
  id: totrans-104
  prefs: []
  type: TYPE_TB
  zh: '| **所有对象类型** | 此选项允许使用**选定的对象类型**选项在对象库中使用先前选择的具有属性和值的对象及其后代添加。 |'
- en: '| **Selected object types** | This option allows selecting and filtering the
    objects and their descendants. The selection remains valid until a user does not
    change the selection criteria. |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
  zh: '| **选定的对象类型** | 此选项允许选择和筛选对象及其后代。选择在用户不更改选择标准之前保持有效。 |'
- en: Based on the filter option, the other is added to the OR.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 根据筛选器选项，其他对象被添加到OR中。
- en: Adding test objects to the local object repository from Active Screen
  id: totrans-107
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从活动屏幕向本地对象库添加测试对象
- en: 'Select the required object from **Active Screen** and add it to the object
    repository. In order to add test objects to the object repository using **Active
    Screen**, **Active Screen** should have the object. Perform the following steps:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 从**活动屏幕**中选择所需的对象并将其添加到对象库中。为了使用**活动屏幕**将测试对象添加到对象库中，**活动屏幕**应该有该对象。执行以下步骤：
- en: Go to the **Active Screen** pane.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到**活动屏幕**面板。
- en: Select an object and right-click on it.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择一个对象并右键单击。
- en: Click on **View** / **Add Object**.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**视图**/**添加对象**。
- en: Click on the **Add to Repository** button.![Adding test objects to the local
    object repository from Active Screen](img/1027EN_02_07.jpg)
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加到库**按钮。![从活动屏幕添加测试对象到本地对象库](img/1027EN_02_07.jpg)
- en: We have selected the object button **Cancel** as shown in the preceding screenshot.
    The test object is added to the local object repository and can be used only by
    the current action. We cannot add a test object in a shared OR (in OR Manager)
    using **Active Screen**.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已选择如前图所示的“取消”对象按钮。测试对象已添加到本地对象库中，并且只能由当前动作使用。我们无法使用**活动屏幕**在共享对象库（在对象库管理器中）中添加测试对象。
- en: Adding a test step
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 添加测试步骤
- en: 'There are many ways in which we can add the steps in the scripts, as shown
    in the following steps:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在脚本中添加步骤的许多方法，如下所示：
- en: '**Recording**: Recording creates the test step when a user performs the action
    on an object in AUT.'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**录制**：当用户在AUT中执行对象操作时，录制会创建测试步骤。'
- en: '**Manually adding a step**: To add steps manually, we need to add the OR first.
    Write the class name, for example `Dialog`; the editor displays the list of dialogs.
    In case multiple dialogs are stored in OR, we can select the desired one. In case
    of a single dialog QTP, complete print the name of it in editor. When a user types
    `WinEdit`, the editor displays two objects that belong to the `WinEdit` class.
    Refer to the following screenshot:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '**手动添加步骤**：要手动添加步骤，我们需要首先添加对象库。写下类名，例如`Dialog`；编辑器显示对话框列表。如果对象库中存储了多个对话框，我们可以选择所需的对话框。如果只有一个对话框，QTP将完整打印其名称在编辑器中。当用户输入`WinEdit`时，编辑器显示属于`WinEdit`类的两个对象。参见图示：'
- en: '![Adding a test step](img/1027EN_02_08.jpg)![Adding a test step](img/1027EN_02_09.jpg)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![添加测试步骤](img/1027EN_02_08.jpg)![添加测试步骤](img/1027EN_02_09.jpg)'
- en: Press *.* on the keyboard after `WinButton("OK")`, the drop-down menu appears
    with the list of the methods available for the object. Select the appropriate
    method and complete the statement.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 在`WinButton("OK")`后按*.*键，将出现包含对象可用方法的下拉菜单。选择适当的方法并完成语句。
- en: 'Perform the following steps for the keyword view:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以进行关键字视图：
- en: Create the OR.
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建对象库。
- en: Switch to the keyword driven view.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到关键字驱动视图。
- en: Right-click on the **Item** column.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击**项目**列。
- en: Select the object from the drop-down menu in the item of the grid.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从网格项的下拉菜单中选择对象。
- en: Select the method from the **Operation** column.
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**操作**列中选择方法。
- en: Set the value, if required, in the **Value** column.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如有必要，在**值**列中设置值。
- en: Note
  id: totrans-127
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The comment will be added by QTP itself.
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注释将由QTP自动添加。
- en: If the test object is not added to the Object Repository before inserting the
    step,click on the object from the repository in the drop-down menu in the item
    column. Click on the hand pointer to add a test object from the repository in
    the selected test object window.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在插入步骤之前未将测试对象添加到对象库中，请从项目列的下拉菜单中点击对象库中的对象。点击手形指针以从所选测试对象窗口中添加对象库中的测试对象。
- en: '![Adding a test step](img/1027EN_02_10.jpg)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![添加测试步骤](img/1027EN_02_10.jpg)'
- en: '**Step Generator** from Keyword view:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键字视图中的步骤生成器**：'
- en: Create the OR (add object to OR).
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建对象库（将对象添加到对象库）。
- en: Switch to the keyword driven view and right-click on it.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到关键字驱动视图，并右键单击。
- en: Click on **Step Generator**.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**步骤生成器**。
- en: Select **Test Object** from **Category**.
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**类别**中选择**测试对象**。
- en: Select the test object from the dropdown or click on the icon (select the test
    object) to open the selected object window.
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从下拉菜单中选择测试对象或点击图标（选择测试对象）以打开所选对象窗口。
- en: Select the test object.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择测试对象。
- en: Provide arguments and click on **OK**.
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供参数并点击**确定**。
- en: 'Adding steps to **Active screen**:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 向**活动屏幕**添加步骤：
- en: Open the **Active Screen** pane (if the **Active Screen** pan is not visible,
    go to **View** | **Active**).
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开**活动屏幕**面板（如果**活动屏幕**面板不可见，请转到**视图** | **活动**）。
- en: Navigate to the object we want to add.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到我们想要添加的对象。
- en: Click on the **Step Generator** option.
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**步骤生成器**选项。
- en: Select **Test Object** from **Category**.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**类别**中选择**测试对象**。
- en: Select the test object from the dropdown or click on the icon (select the test
    object) to open the selected object window.
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从下拉菜单中选择测试对象或单击图标（选择测试对象）以打开选定的对象窗口。
- en: Select the test object.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择测试对象。
- en: Provide the arguments.
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供参数。
- en: Enhancing scripts
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 增强脚本
- en: We have learned various ways of adding test objects and creating test steps,
    now we will learn about enhancing the scripts using checkpoints, actions, synchronization
    point, reporter object, Err handling, and environment variable to make it more
    reusable and effective.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经学习了添加测试对象和创建测试步骤的各种方法，现在我们将学习如何使用检查点、动作、同步点、报告对象、错误处理和环境变量来增强脚本，使其更具可重用性和有效性。
- en: Checkpoints
  id: totrans-149
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 检查点
- en: 'A checkpoint is a verification that compares the actual value for specified
    properties or the current state of other characteristics of an object with the
    expected value or characteristics. This allows notifying the **Run Result** window
    or scripts them as to whether applications are working as expected or not. When
    a checkpoint is added to the test, QuickTest inserts a checkpoint step in the
    keyword view and adds a `CheckPoint` statement in the expert view. When a test
    is executed, QuickTest compares the expected results and actual results using
    checkpoints. If there is a mismatch, the checkpoint fails. The results of the
    checkpoint can be viewed in the **Run Results Viewer**. See the various types
    of checkpoints in the following list:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 检查点是一种验证，它将对象的指定属性的实际值或其他特性的当前状态与预期值或特性进行比较。这允许通知**运行结果**窗口或脚本，以确定应用程序是否按预期工作。当检查点添加到测试中时，QuickTest在关键字视图中插入一个检查点步骤，并在专家视图中添加一个`CheckPoint`语句。当执行测试时，QuickTest使用检查点比较预期结果和实际结果。如果存在不匹配，则检查点失败。检查点的结果可以在**运行结果查看器**中查看。以下列表显示了各种检查点的类型：
- en: '| Type | Description | How to insert | Example of use |'
  id: totrans-151
  prefs: []
  type: TYPE_TB
  zh: '| 类型 | 描述 | 如何插入 | 使用示例 |'
- en: '| --- | --- | --- | --- |'
  id: totrans-152
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| Standard checkpoint | Verifies the value of an object''s properties | Click
    on **Record** in toolbar.Navigate to **Insert** &#124; **Checkpoint** &#124; **Standard
    Checkpoint**. | Verify the property of the object |'
  id: totrans-153
  prefs: []
  type: TYPE_TB
  zh: '| 标准检查点 | 验证对象属性值 | 在工具栏中单击**记录**。转到**插入** &#124; **检查点** &#124; **标准检查点**。
    | 验证对象的属性 |'
- en: '| Image checkpoint | Verifies the properties of images | This checkpoint type
    is inserted by selecting the **Standard Checkpoint** option and then selecting
    to check a web image object. | Verify the `alt` property of the image |'
  id: totrans-154
  prefs: []
  type: TYPE_TB
  zh: '| 图片检查点 | 验证图片的特性 | 通过选择**标准检查点**选项，然后选择检查网页图片对象来插入此检查点类型。 | 验证图片的`alt`属性 |'
- en: '| Table checkpoint | Verifies the information in the web table | This checkpoint
    type is inserted by selecting the **Standard Checkpoint** option and then selecting
    to check any table object. | Verify if the value of the cell in the web table
    is correct |'
  id: totrans-155
  prefs: []
  type: TYPE_TB
  zh: '| 表格检查点 | 验证网页表格中的信息 | 通过选择**标准检查点**选项，然后选择检查任何表格对象来插入此检查点类型。 | 验证网页表格中单元格的值是否正确
    |'
- en: '| Page checkpoint | Verifies the characteristics of a web page | This checkpoint
    type is inserted by selecting the Standard Checkpoint option and then selecting
    to check a web page object. | Verify the number of links |'
  id: totrans-156
  prefs: []
  type: TYPE_TB
  zh: '| 页面检查点 | 验证网页的特性 | 通过选择标准检查点选项，然后选择检查网页对象来插入此检查点类型。 | 验证链接数量 |'
- en: '| Text checkpoint | Verifies the displayed text or text within predefined and
    post-defined values | Click on **Record** in the toolbar.Navigate to **Insert**
    &#124; **Checkpoint** &#124; **Text Checkpoint**. | Verify if the expected text
    string is displayed |'
  id: totrans-157
  prefs: []
  type: TYPE_TB
  zh: '| 文本检查点 | 验证显示的文本或预定义和后定义值内的文本 | 在工具栏中单击**记录**。转到**插入** &#124; **检查点** &#124;
    **文本检查点**。 | 验证是否显示了预期的文本字符串 |'
- en: '| Text Area checkpoint | Verify if string is displayed within a defined area
    | Click on **Record** in the toolbar.Navigate to **Insert** &#124; **Checkpoint**
    &#124; **Text Area Checkpoint**. | Verify if the string defined in area matches
    with the expected string |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '| 文本区域检查点 | 验证是否在定义的区域内显示了字符串 | 在工具栏中单击**记录**。转到**插入** &#124; **检查点** &#124;
    **文本区域检查点**。 | 验证定义区域中的字符串是否与预期字符串匹配 |'
- en: '| Bitmap checkpoint | Verifies the bitmap or part of the bitmap | Click on
    **Record** in toolbar.Navigate to **Insert** &#124; **Checkpoint** &#124; **Bitmap
    Checkpoint**. | Check if bitmap matches the expected bitmap |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| 位图检查点 | 验证位图或位图的一部分 | 在工具栏中点击**记录**。导航到**插入** &#124; **检查点** &#124; **位图检查点**。
    | 检查位图是否与预期的位图匹配 |'
- en: '| Database checkpoint | Check if the value retrieved by query matches the expected
    value | Navigate to **Insert** &#124; **Checkpoint** &#124; **Database Checkpoint**.
    | Check if the value retrieved by query matches the expected value |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| 数据库检查点 | 检查查询检索的值是否与预期值匹配 | 导航到**插入** &#124; **检查点** &#124; **数据库检查点**。 |
    检查查询检索的值是否与预期值匹配 |'
- en: '| Accessibility checkpoint | Identifies areas of a website to check for Section
    508 compliancy | Click on **Record** in toolbar.Navigate to **Insert** &#124;
    **Checkpoint** &#124; **Accessibility Checkpoint**. | Check if the images on a
    web page include `ALT` properties, required by the W3C Web |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| 可访问性检查点 | 识别网站需要检查的508合规性区域 | 在工具栏中点击**记录**。导航到**插入** &#124; **检查点** &#124;
    **可访问性检查点**。 | 检查网页上的图像是否包含W3C Web所需的`ALT`属性 |'
- en: '| XML checkpoint | Verifies data in XML documents | Navigate to **Insert**
    &#124; **Checkpoint** &#124; **XML Checkpoint**. | Check the value of an XML node
    and attributes |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '| XML检查点 | 验证XML文档中的数据 | 导航到**插入** &#124; **检查点** &#124; **XML检查点**。 | 检查XML节点和属性的值
    |'
- en: We will learn more about checkpoints in the next chapter.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在下一章中学习更多关于检查点的知识。
- en: Synchronization
  id: totrans-164
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 同步
- en: When a test runs, it may not always match up to the speed of AUT and it is required
    to wait for the following. This is known as test synchronization.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 当测试运行时，它可能无法始终匹配AUT的速度，需要等待以下情况。这被称为测试同步。
- en: Wait until a progress bar reaches 100 percent
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 等待直到进度条达到100%
- en: Status message is displayed
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 显示状态消息
- en: Wait until button is enabled
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 等待直到按钮启用
- en: Wait until a window or a pop up is displayed
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 等待直到窗口或弹出窗口显示
- en: In these scenarios, tests are either not able to perform the next step or synchronization
    times out, causing the test to fail. These issues can be resolved by various synchronization
    techniques provided by the QTP.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些情况下，测试可能无法执行下一步或同步超时，导致测试失败。这些问题可以通过QTP提供的各种同步技术来解决。
- en: 'There are several options to synchronize a test with AUT:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种选项可以将测试与AUT同步：
- en: Inserting the `Wait` statement allows a test to wait for a predefined time.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 插入`Wait`语句允许测试等待预定义的时间。
- en: Insert a synchronization point or insert the `WaitProperty` method, allowing
    a test to pause until an object property achieves the specified value.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 插入一个同步点或插入`WaitProperty`方法，允许测试暂停直到对象属性达到指定的值。
- en: The `Exist` statement allows waiting until an object exists or times out.
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`Exist`语句允许等待直到对象存在或超时。'
- en: QTP allows setting the default time-out for a web page to load.
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: QTP允许设置网页加载的默认超时时间。
- en: Increase the default synchronization time-out by navigating to **File** | **Test**
    | **Run** |**object synchronization timeout**.
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过导航到**文件** | **测试** | **运行** | **对象同步超时**来增加默认同步超时时间。
- en: 'Use the `Sync` method for a web page to wait until the page is loaded. See
    the following code:'
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`Sync`方法等待网页加载完成。请参阅以下代码：
- en: '[PRE3]'
  id: totrans-178
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Tip
  id: totrans-179
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: The synchronization point does not work when QTP is not able to identify the
    object; use `exist` or `wait` instead.
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当QTP无法识别对象时，同步点不起作用；使用`exist`或`wait`代替。
- en: Exist statements
  id: totrans-181
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Exist语句
- en: The `Exist` statement allows a test to wait for a window to open or an object
    to appear. `Exist` statements return a Boolean value indicating whether or not
    an object currently exists.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: '`Exist`语句允许测试等待窗口打开或对象出现。`Exist`语句返回一个布尔值，指示对象当前是否存在。'
- en: '[PRE4]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The first statement instructs QuickTest to wait until the default synchronization
    time. The second statement waits for a maximum of 10 seconds for the `Flights
    Table` dialog box to open.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 第一条语句指示QuickTest等待直到默认同步时间。第二条语句等待最多10秒，直到`Flights Table`对话框打开。
- en: Tip
  id: totrans-185
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: '**Downloading the example code**'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: '**下载示例代码**'
- en: You can download the example code files for all Packt books you have purchased
    from your account at [http://www.packtpub.com](http://www.packtpub.com). If you
    purchased this book elsewhere, you can visit [http://www.packtpub.com/support](http://www.packtpub.com/support)
    and register to have the files e-mailed directly to you.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从您在 [http://www.packtpub.com](http://www.packtpub.com) 的账户下载您购买的所有 Packt
    书籍的示例代码文件。如果您在其他地方购买了此书，您可以访问 [http://www.packtpub.com/support](http://www.packtpub.com/support)
    并注册，以便将文件直接通过电子邮件发送给您。
- en: Reporter objects
  id: totrans-188
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Reporter 对象
- en: This object is used to send information to the run results. It has various methods
    and properties used at runtime to decide and change the control of flow of scripts.
    The following table demonstrates methods and properties of the reporter object.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 此对象用于向运行结果发送信息。它具有在运行时用于决定和更改脚本流程控制的多种方法和属性。以下表格展示了 reporter 对象的方法和属性。
- en: '| Associated methods of the `Reporter` object | Associated properties of the
    `Reporter` object |'
  id: totrans-190
  prefs: []
  type: TYPE_TB
  zh: '| `Reporter` 对象的相关方法 | `Reporter` 对象的相关属性 |'
- en: '| --- | --- |'
  id: totrans-191
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `ReportEvent` method`ReportNote` method | `Filter` property`ReportPath` property`RunStatus`
    property |'
  id: totrans-192
  prefs: []
  type: TYPE_TB
  zh: '| `ReportEvent` 方法`ReportNote` 方法 | `Filter` 属性`ReportPath` 属性`RunStatus` 属性
    |'
- en: 'Let''s see how to use these methods and properties:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看如何使用这些方法和属性：
- en: 'It takes four arguments (`EventStatus`, `StepName`, `Details(Description)`,
    and `[, pathtosavefile]`) as shown in the following code:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 它接受四个参数（`EventStatus`、`StepName`、`Details(Description)` 和 `[, pathtosavefile]`），如下面的代码所示：
- en: '[PRE5]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '`EventStatus` is shown as a number or a constant. These constants are shown
    with the description of the message sent to the **Run Result** window as shown
    in the following table.'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: '`EventStatus` 以数字或常量的形式显示。这些常量与发送到 **运行结果** 窗口的消息描述一起显示，如下表所示。'
- en: '| 0 or micPass: | 1 or micFail: | 2 or micDone: | 3 or micWarning: |'
  id: totrans-197
  prefs: []
  type: TYPE_TB
  zh: '| 0 或 micPass: | 1 或 micFail: | 2 或 micDone: | 3 或 micWarning: |'
- en: '| --- | --- | --- | --- |'
  id: totrans-198
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| Sends the passed message to the **Run Results** window | Sends the failed
    message to the **Run Results** window | Sends the message of doneness to the **Run
    Result** window | Sends a warning message to the **Run Results** window |'
  id: totrans-199
  prefs: []
  type: TYPE_TB
  zh: '| 将传递的消息发送到 **运行结果** 窗口 | 将失败的消息发送到 **运行结果** 窗口 | 将完成的消息发送到 **运行结果** 窗口 | 将警告消息发送到
    **运行结果** 窗口 |'
- en: 'The arguments list and its descriptions are mentioned in the following table:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 参数列表及其描述如下表所示：
- en: '| Arguments | Type | Description |'
  id: totrans-201
  prefs: []
  type: TYPE_TB
  zh: '| 参数 | 类型 | 描述 |'
- en: '| --- | --- | --- |'
  id: totrans-202
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| `ReportStepName` | `String` | Name of the step that the user wants to display
    in the **Run Results** window |'
  id: totrans-203
  prefs: []
  type: TYPE_TB
  zh: '| `ReportStepName` | `String` | 用户希望在 **运行结果** 窗口中显示的步骤名称 |'
- en: '| `Details` | `String` | Sends the custom message or step description to run
    results |'
  id: totrans-204
  prefs: []
  type: TYPE_TB
  zh: '| `Details` | `String` | 将自定义消息或步骤描述发送到运行结果 |'
- en: '| `ImageFilePath` | `String` | This argument is optional. The format to store
    the images are `.bmp`, `.jpeg`, `.png`, and `.gif` format |'
  id: totrans-205
  prefs: []
  type: TYPE_TB
  zh: '| `ImageFilePath` | `String` | 此参数是可选的。存储图像的格式为 `.bmp`、`.jpeg`、`.png` 和 `.gif`
    格式 |'
- en: 'The following is the example of how to use the reporter object:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是如何使用 reporter 对象的示例：
- en: '[PRE6]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The Reporter.RunStatus object
  id: totrans-208
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Reporter.RunStatus 对象
- en: 'The `Reporter.RunStatus` object retrieves the current run status of the test.
    The following example demonstrates how to retrieve the value if it fails, and
    then exit from the test:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: '`Reporter.RunStatus` 对象检索测试的当前运行状态。以下示例演示了如何检索失败时的值，然后退出测试：'
- en: '[PRE7]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'This method also allows setting `RunStatus` as shown in the following code:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 此方法还允许将 `RunStatus` 设置如下所示：
- en: '[PRE8]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Enable or disable the mode setting:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 启用或禁用模式设置：
- en: '[PRE9]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The mode can be one of the following values with description as shown in the
    following table:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 模式可以是以下值之一，如下表所示：
- en: '| Mode | Description |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| 模式 | 描述 |'
- en: '| --- | --- |'
  id: totrans-217
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `0` or `rfEnableAll` Default. | Displays all events in run results |'
  id: totrans-218
  prefs: []
  type: TYPE_TB
  zh: '| `0` 或 `rfEnableAll` 默认。 | 在运行结果中显示所有事件 |'
- en: '| `1` or `rfEnableErrorsAndWarnings` | Displays the warning or fail status
    in run results |'
  id: totrans-219
  prefs: []
  type: TYPE_TB
  zh: '| `1` 或 `rfEnableErrorsAndWarnings` | 在运行结果中显示警告或失败状态 |'
- en: '| `2` or `rfEnableErrorsOnly` | Displays the fail status in the run results
    |'
  id: totrans-220
  prefs: []
  type: TYPE_TB
  zh: '| `2` 或 `rfEnableErrorsOnly` | 在运行结果中显示失败状态 |'
- en: '| `3` or `rfDisableAll` | Displays no events in run results |'
  id: totrans-221
  prefs: []
  type: TYPE_TB
  zh: '| `3` 或 `rfDisableAll` | 在运行结果中不显示任何事件 |'
- en: Actions
  id: totrans-222
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 动作
- en: An action is a set of statements to perform a task(s); divide the test into
    actions to decompose the functionality into smaller and manageable scripts.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 一个动作是一组执行任务（s）的语句；将测试分解为动作，以将功能分解成更小、更易于管理的脚本。
- en: Purpose of actions
  id: totrans-224
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 动作的目的
- en: Provide decomposition of scripts into manageable pieces
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供将脚本分解为可管理部分的分解
- en: Increase reusability
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提高可重用性
- en: Types of actions
  id: totrans-227
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 操作类型
- en: '**Non reusable actions**: They can be called in the same test only once and
    cannot be used in other tests.'
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**不可重用操作**：它们在同一测试中只能调用一次，且不能在其他测试中使用。'
- en: '**Reusable actions**: Reusable actions can be used in the same test multiple
    times as well as in other tests.'
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可重用操作**：可重用操作可以在同一测试中多次使用，也可以在其他测试中使用。'
- en: '**External actions**: An external action is defined in another test and is
    used as read-only in calling a test and can be modified by a stored test.'
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**外部操作**：外部操作定义在另一个测试中，并在调用测试时作为只读使用，可以被存储的测试修改。'
- en: Error handling
  id: totrans-231
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 错误处理
- en: Error handling is an important aspect that allows coming up cleanly from erroneous
    conditions. QTP provides various options in case of an error.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 错误处理是一个重要的方面，它允许从错误条件中干净地恢复。QTP 在出现错误时提供了各种选项。
- en: 'Go to **File** | **Settings** | **Run** | **Select** when an error occurs during
    a run session; the options are:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 当运行会话中出现错误时，转到**文件** | **设置** | **运行** | **选择**；选项包括：
- en: '**Pop-up message box**: A pop-up message box displays the options selected
    by the user.'
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**弹出消息框**：弹出消息框显示用户选择的选项。'
- en: '**Proceed to the next test Iteration**: Skip the current iteration and move
    to the next one.'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**进入下一个测试迭代**：跳过当前迭代并进入下一个。'
- en: '**Stop Run**: Stop the test execution.'
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**停止运行**：停止测试执行。'
- en: '**Proceed to the next step**: Skip the current step and proceed to the next
    one.'
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**进入下一步**：跳过当前步骤并进入下一步。'
- en: By specifying this action the test will come out of the error condition and
    proceed as a selected option. QTP also provides the recovery mechanism. Using
    VBScript we can handle various error situations using VBScript's `ERR` object.
    We will see how to use it in the later chapters of this book.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 通过指定此操作，测试将退出错误条件并按照所选选项继续。QTP 还提供了恢复机制。使用 VBScript，我们可以使用 VBScript 的 `ERR`
    对象处理各种错误情况。我们将在本书的后续章节中看到如何使用它。
- en: Parameterization
  id: totrans-239
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 参数化
- en: 'A parameter is a variable that holds a value(s). Parameterization allows substituting
    of values when a test is executed. QTP uses `datatable` to parameterize the test.
    Either a global or local sheet can be used for parameterization:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 参数是一个变量，它保存一个或多个值。参数化允许在执行测试时替换值。QTP 使用`datatable`来参数化测试。可以使用全局或局部工作表进行参数化：
- en: '[PRE10]'
  id: totrans-241
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![Parameterization](img/1027EN_02_12.jpg)'
  id: totrans-242
  prefs: []
  type: TYPE_IMG
  zh: '![参数化](img/1027EN_02_12.jpg)'
- en: The data defined in `DataTable` or any external data source allows parameterizing
    of the test when a test is run for a number of rows in data sources. Parameterization
    helps to make the test iterative.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 在`DataTable`或任何外部数据源中定义的数据允许在测试针对数据源中的多行运行时参数化测试。参数化有助于使测试迭代化。
- en: Environment Variables
  id: totrans-244
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 环境变量
- en: QTP allows configuring of the test using environment variables. QTP provides
    built-in variables and allows the user to define variables as well. In-built environment
    variables can be viewed by navigating to **Test** | **Setting** | **Environment**
    | **Select Built-in** from the drop down.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: QTP 允许使用环境变量配置测试。QTP 提供了内置变量，并允许用户定义变量。可以通过导航到**测试** | **设置** | **环境** | **从下拉菜单中选择内置**来查看内置环境变量。
- en: 'The following example creates a new user-defined variable named `MyVariable`
    with a value of `15`, and then retrieves the variable value and stores it in the
    `MyValue` variable:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 以下示例创建了一个名为`MyVariable`的新用户定义变量，其值为`15`，然后检索变量值并将其存储在`MyValue`变量中：
- en: '[PRE11]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'We can create the `Environment` variable using XML as shown in the following
    code and add it by navigating to **Test** | **Setting** | **Environment** | **Select
    the user define option**. Set the export file from the load variable and XML from
    an external file. Use the **Browse** option to add it. The environment variable
    file must be an XML file; use the following syntax:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用以下代码创建`Environment`变量，并通过导航到**测试** | **设置** | **环境** | **选择用户定义选项**来添加它。从加载变量设置导出文件，从外部文件设置XML。使用**浏览**选项添加它。环境变量文件必须是XML文件；使用以下语法：
- en: '[PRE12]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: QTP allows loading the specified environment variable file using the command
    `Environment.LoadFromFile(Path)`.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: QTP 允许使用命令`Environment.LoadFromFile(Path)`加载指定的环境变量文件。
- en: 'The following example loads the `Environment.xml` file:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 以下示例加载了`Environment.xml`文件：
- en: '[PRE13]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Summary
  id: totrans-253
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: The key theme of this chapter was to learn how to create scripts and concepts
    that are reliable and reusable. The smaller code examples demonstrate the usage
    of these concepts. This chapter covered the steps required to create scripts and
    enhance the scripts using checkpoints, parameterization, environment variables
    splitting the actions, and adding the reporter object to notify the results in
    the **Run Result** window. In the next chapter, the key discussion will be around
    building the key features using code that can be utilized to develop the components
    that can be used in frameworks.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的关键主题是学习如何创建可靠和可重用的脚本和概念。较小的代码示例展示了这些概念的使用方法。本章涵盖了创建脚本并使用检查点、参数化、环境变量分割操作以及向**运行结果**窗口添加报告对象来通知结果所需的步骤。在下一章中，关键讨论将围绕使用代码构建关键特性，这些代码可以用于开发可在框架中使用的组件。
