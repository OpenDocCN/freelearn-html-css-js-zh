- en: Introduction to Progressive Web Apps
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 渐进式网络应用简介
- en: Over 80% of 328 million active Twitter users are mobile. Twitter knew they needed
    their mobile experience to be faster, more reliable, and engaging. They chose
    to launch their default mobile experience as a **Progressive Web Application** (**PWA**)
    in April 2017, called Twitter Lite.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在3.28亿活跃Twitter用户中，超过80%是移动用户。Twitter知道他们需要他们的移动体验更快、更可靠、更有吸引力。他们选择在2017年4月将他们的默认移动体验作为**渐进式网络应用**（**PWA**）推出，名为Twitter
    Lite。
- en: 'Their goals were simple, faster load times, more engagement, and lower data
    consumption. They were able to achieve all three when comparing general activities
    to the non progressive web app version:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 他们的目标很简单，即更快的加载时间、更高的参与度和更低的数据消耗。在将一般活动与非渐进式网络应用版本进行比较时，他们实现了所有三个目标：
- en: 65% increase in pages per session
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每次会话页面增加65%
- en: 75% increase in Tweets sent
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发送推文数量增加75%
- en: 20% decrease in bounce rate
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跳出率降低20%
- en: '"Twitter Lite is now the fastest, least expensive, and most reliable way to
    use Twitter. The web app rivals the performance of our native apps but requires
    less than 3% of the device storage space compared to Twitter for Android."'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: “Twitter Lite现在是使用Twitter最快、最经济、最可靠的方式。该网络应用的性能与我们的原生应用相媲美，但所需的设备存储空间比Twitter
    for Android少3%以下。”
- en: — Nicolas Gallagher, the Engineering Lead for Twitter Lite
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: ——Twitter Lite的工程负责人Nicolas Gallagher
- en: This is just one example of online companies reaping the rewards that PWA offers.
    This book should serve as a starting point to arm you with the basic knowledge
    and confidence to create your first PWA.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 这只是在线公司从PWA中获得回报的一个例子。这本书应该作为起点，为您提供创建第一个PWA所需的基本知识和信心。
- en: In this book, you are going to learn how to build a PWA which will be ready
    for production use. In case you haven't created a PWA yet, you will learn how
    to make a simple PWA in the first part of this chapter.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中，您将学习如何构建一个PWA，它将准备好投入生产使用。如果您还没有创建过PWA，您将在本章的第一部分学习如何制作一个简单的PWA。
- en: This chapter will cover PWA fundamentals and the advantages they offer over
    classic websites and native applications. You will also see how to upgrade an
    existing 2048 game web application to a PWA. You will learn how to add a web manifest
    and service worker to the application, enabling PWA features using a localhost
    web server.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖PWA的基本原理以及它们相对于经典网站和原生应用的优势。您还将了解如何将现有的2048游戏网络应用升级为PWA。您将学习如何向应用添加web
    manifest和service worker，使用localhost网络服务器启用PWA功能。
- en: The purpose of this chapter is to get a general idea of how PWAs work, why you
    want to deliver PWAs, and to give you the skills to easily create PWAs with basic
    functionalities.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的目的是让您对PWA的工作原理有一个大致的了解，为什么您想要提供PWA，并为您提供轻松创建具有基本功能的PWA的技能。
- en: 'This chapter will cover the following points:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下要点：
- en: The purpose of PWA
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PWA的目的
- en: PWA advantages
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PWA优势
- en: The basic technical requirements of a PWA
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PWA的基本技术要求
- en: The three primary user experience PWA goals
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 三大主要用户体验PWA目标
- en: How to upgrade an existing website and run it locally
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何升级现有网站并在本地运行
- en: The web as we know it is entering its third decade of existence. Over this time,
    the web has gone through many changes and enhancements. While the web possesses
    some great superpowers, it also had its limitations that inhibited it from delivering
    an experience in parity with native counterparts.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 我们所熟知的网络已经进入了第三个十年。在这段时间里，网络经历了许多变化和增强。虽然网络拥有一些伟大的超级能力，但它也有一些限制，阻碍了它提供与原生应用相当的用户体验。
- en: PWAs are a way to apply native browser technology to create web solutions that
    consumers want to add to their homescreen. Meanwhile, new web APIs are progressing
    to fill additional gaps in functionality between web and native apps.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: PWAs是一种将原生浏览器技术应用于创建消费者希望添加到主屏幕的Web解决方案的方式。同时，新的Web API正在进步，以填补Web和原生应用之间功能差距的额外空白。
- en: The great thing about a PWA is existing websites can easily be upgraded to claim
    the PWA status. This can unlock new features in browsers and platforms to level
    up any website.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: PWA的伟大之处在于，现有的网站可以轻松升级以获得PWA状态。这可以在浏览器和平台上解锁新功能，提升任何网站。
- en: About a decade ago, not only was the web disrupted, but so was desktop computing
    when Apple released the iPhone. This ushered in a new era of mobile first computing.
    That era's web technology was not prepared for this rapid shift from desktops
    to handheld devices.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 大约十年前，当苹果公司发布iPhone时，不仅互联网受到了冲击，桌面计算也受到了影响。这标志着移动优先计算新时代的到来。那个时代的网络技术没有准备好应对从桌面到手持设备的快速转变。
- en: Changing to a mobile first world requires more than just responsive design techniques;
    it requires a new set of native APIs, capabilities, and coding techniques. The
    HTML, CSS, and JavaScript specifications and browsers have evolved over the past
    decade, catching up to the consumer expectations of client applications.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 转向以移动为先的世界需要不仅仅是响应式设计技术；它需要一套新的原生API、功能和编码技术。HTML、CSS和JavaScript规范以及浏览器在过去十年中不断发展，以满足客户端应用程序的消费预期。
- en: Today, we have a very rich set of native APIs and browsers, enabling everything
    from geo-location to voice input and camera manipulation. There are client platforms
    designed to provide a rich, mobile first canvas for developers to paint engaging
    user experiences.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，我们拥有非常丰富的原生API和浏览器，从地理位置到语音输入和相机操作，几乎什么都能做。有客户端平台旨在为开发者提供一个丰富、以移动为先的画布，以创作引人入胜的用户体验。
- en: In addition to great native APIs, browsers have added new features in service
    workers, web manifestations, and have begun requiring HTTPS to enable modern APIs.
    These three technical features are the core requirements to become a PWA. However,
    there is much more to the art of making a good PWA. This art requires a different
    approach to web development.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 除了优秀的原生API之外，浏览器还在服务工作者、Web清单和开始要求HTTPS以启用现代API方面添加了新功能。这三个技术特性是成为PWA的核心要求。然而，制作一个优秀的PWA的艺术远不止于此。这种艺术需要一种不同的网络开发方法。
- en: In this book, we are going to explore the requirements of a good PWA, and how
    to create new and upgrade existing websites as PWAs. Along the way, we will learn
    how to leverage new features such as IndexedDB, multi-media, and the Fetch API
    to add value to our applications.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中，我们将探讨优秀PWA的需求，以及如何将新网站和现有网站升级为PWA。在这个过程中，我们将学习如何利用新的功能，如IndexedDB、多媒体和Fetch
    API，为我们的应用程序增加价值。
- en: As this book progresses, you will learn how to use service workers for caching,
    push notifications, and background synchronization. The next chapter delves into
    the web manifest file. [Chapter 3](part0058.html#1NA0K0-f12cdcca08b54960b3d271452dc7667d), *Making
    Your Website Secure*, covers the subtleties of upgrading to HTTPS.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 随着本书的深入，您将学习如何使用服务工作者进行缓存、推送通知和后台同步。下一章深入探讨了Web清单文件。[第3章](part0058.html#1NA0K0-f12cdcca08b54960b3d271452dc7667d)，*让你的网站更安全*，涵盖了升级到HTTPS的细微之处。
- en: 'This book breaks down technical and experiential requirements so that you can
    create a good, PWA and demonstrates this with three sample applications:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 本书将技术和经验需求分解，以便您创建一个优秀的PWA，并通过三个示例应用程序来展示这一点：
- en: The first application is a simple game, 2048\. 2048 was very popular about three
    years ago and I still find it very addictive. Even though it's a simple game,
    it will demonstrate how the web can compete on an even level with common native
    applications.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一个应用程序是一个简单的游戏，2048。2048大约三年前非常流行，我仍然觉得它非常上瘾。尽管它是一个简单的游戏，但它将展示网络如何与常见的原生应用程序在同等水平上竞争。
- en: Next, we will create a photo gallery website and see how to use service worker
    caching to create an application that loads instantly and runs with or without
    a network. The application will be comparable to many popular podcast players
    like iTunes and Stitcher.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 接下来，我们将创建一个相册网站，并了解如何使用服务工作者缓存来创建一个即点即用、在有或没有网络的情况下都能运行的应用程序。该应用程序将与许多流行的播客播放器，如iTunes和Stitcher相媲美。
- en: The final application is a consumer event ticket application. This application
    will demonstrate advanced service worker techniques like cache invalidation. I
    will also cover tools you can use to validate your applications and help you scaffold
    them for quality and consistency.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后一个应用程序是一个消费者活动门票应用程序。该应用程序将展示高级服务工作者技术，如缓存失效。我还会介绍您可以使用哪些工具来验证您的应用程序，并帮助您为质量和一致性构建它们。
- en: All source code is available on GitHub, with links provided in this book. You're
    welcome to clone and fork these repositories. Make local copies and modify them
    as you wish. I would love to see how you enhance the demo applications.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 所有源代码均可在GitHub上找到，本书中提供了链接。您可随意克隆和分叉这些仓库。根据需要制作本地副本并修改它们。我很乐意看到您如何增强演示应用程序。
- en: Why we needed a new way to build websites
  id: totrans-32
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为什么我们需要一种新的方式来构建网站
- en: When Apple released the iPhone in 2007, they initially intended that applications
    to be built using HTML. They provided an initial platform to create web applications.
    However, Mac developers cried put for a better native application solution and
    Apple answered. Apple did so with the caveat of taking 30% of the application's
    revenue and controlling the applications that were distributed through a closed
    App Store.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 当苹果公司在2007年发布iPhone时，他们最初打算使用HTML来构建应用程序。他们提供了一个初始平台来创建网络应用程序。然而，Mac开发者们呼吁提供更好的本地应用程序解决方案，苹果公司做出了回应。苹果公司这样做的前提是收取应用程序收入的30%，并控制通过封闭的App
    Store分发的应用程序。
- en: The closed App Store violates the openness of the web by introducing a third-party
    gatekeeper. This creates a layer of delay as Apple reviews your application. The
    review process can result in your application being censored or denied entry.
    The one advantage App Store offers is a sense of security and trustworthiness
    for consumers.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 封闭的App Store通过引入第三方守门人而违反了网络的开放性。这导致苹果公司审查您的应用程序时产生一层延迟。审查过程可能导致您的应用程序被审查或拒绝进入。App
    Store提供的一个优势是为消费者提供一种安全和可信的感觉。
- en: To make the App Store model interesting for Apple, they decided to take a big
    cut for tax-native applications. In return, Apple handles all payment and distribution
    infrastructure for applications. However, the web has not had a problem collecting
    money from consumers, nor a distribution issue.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使App Store模式对苹果公司更有吸引力，他们决定对原生应用程序收取高额的提成。作为回报，苹果公司处理所有应用程序的支付和分发基础设施。然而，网络在从消费者那里收取金钱以及分发问题上并没有遇到问题。
- en: Credit card merchant accounts typically take 2% to 3% of a transaction. Hosting
    has become a cheap commodity, often costing $10 or less a month for most websites.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 信用卡商户账户通常收取交易额的2%到3%。托管已成为一种廉价的商品，对于大多数网站来说，每月的费用通常为10美元或更少。
- en: The next perceived problem the web has suffered from is performance. Performance
    issues are amplified on mobile devices. Smartphones and tablets have underpowered
    CPUs compared to their desktop counterparts. And while more mobile devices use
    WiFi, cellular connections, even in the developed world, are still unreliable.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 网络遇到的下一个感知问题是性能。性能问题在移动设备上被放大。与桌面电脑相比，智能手机和平板电脑的CPU性能较弱。尽管更多移动设备使用WiFi，但在发达世界，蜂窝连接仍然不可靠。
- en: When the iPhone was first released, the web was still very static compared to
    what we experience today. Up to that point, the web was not a platform with animations
    and dynamic content.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 当iPhone首次发布时，与今天我们所经历的相比，网络仍然非常静态。到那时，网络还没有动画和动态内容这一平台。
- en: Over the last decade, rich user experiences have become commonplace on the web
    with the rise of single page applications and many large frameworks. These changes
    have been driven in large part due to the user experiences consumers have come
    to expect from many native applications.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在过去十年中，随着单页应用程序和许多大型框架的兴起，丰富的用户体验在网络上变得司空见惯。这些变化在很大程度上是由消费者从许多原生应用程序中期望的用户体验所驱动的。
- en: Many developers have tried to hack their way to mimicking native application
    experiences on mobile devices. This has led to some good progress as well as some
    bad experiences and coding practices.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 许多开发者尝试通过黑客手段在移动设备上模仿本地应用程序体验。这导致了一些进步，也带来了一些不良体验和编码实践。
- en: Most bad experiences are due to a lack of awareness of the available APIs and
    how to use them. Poor coding techniques have also created more issues than perceived
    value.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数不良体验都是由于对可用的API及其使用方式缺乏了解。糟糕的编码技术也造成了比预期价值更多的问题。
- en: A common mistake I have seen a lot is the application of server-side architecture
    in the browser. While outside the scope of this book, it is important to note
    that for a good modern web user experience, you may have to let go of preconceived
    notions of how to develop websites.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 我看到的一个常见错误是在浏览器中应用服务器端架构。虽然这超出了本书的范围，但重要的是要注意，为了获得良好的现代Web用户体验，您可能不得不放弃对网站开发的先入为主的观念。
- en: 'A prime example of misunderstanding how to use the web platform and the capability
    gap can be demonstrated by an interview in 2012 with Mark Zuckerberg, at a Tech
    Crunch event. You can check out the following link for the article: [http://tcrn.ch/2hwN6HF](http://tcrn.ch/2hwN6HF)'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 2012年，马克·扎克伯格在Tech Crunch活动上的一个采访中，展示了如何误解使用Web平台和能力差距的典型案例。您可以查看以下链接获取文章：[http://tcrn.ch/2hwN6HF](http://tcrn.ch/2hwN6HF)
- en: Facebook tried to make the web its primary platform, but due to many engineering
    mistakes and browser/hardware limitations, they failed. At that point, they switched
    to native apps as a primary focus and have since created a very large, walled
    off community of data and interactions.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: Facebook试图将网络作为其主要平台，但由于许多工程错误和浏览器/硬件限制，他们失败了。在那个时刻，他们转向原生应用作为主要焦点，并从此创建了一个非常大的、封闭的数据和互动社区。
- en: As you will see later in this book, Facebook dominates the mobile native application
    space. This leaves very little room for anybody else to gain screen time.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您将在本书后面看到的那样，Facebook在移动原生应用空间中占据主导地位。这为其他人获得屏幕时间留下了很少的空间。
- en: This is where PWAs can empower businesses and organizations to engage with consumers
    at a deeper level. This book is designed to give you the tools and knowledge to
    create PWAs to reach consumers for less money and effort. The web possesses several
    superpowers that native applications can't touch. Now, with emerging native APIs,
    the web surpasses native applications.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是PWA如何使企业和组织能够更深入地与消费者互动。这本书旨在为您提供创建PWA的工具和知识，以更少的金钱和努力触及消费者。网络拥有原生应用无法触及的几个超级能力。现在，随着原生API的兴起，网络超越了原生应用。
- en: Real-world PWA examples
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 真实世界的PWA示例
- en: Flipkart, the Amazon of the Indian sub-continent, embraced PWA as soon as the
    term was first mentioned. In many ways, they are the poster child of doing a PWA
    the right way.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: Flipkart，印度次大陆的亚马逊，在PWA这个术语首次提出时就接受了它。在许多方面，他们是正确实施PWA的典范。
- en: Flipkart's consumer market consists of customers almost entirely on poor mobile
    connections. Their mobile devices have limited storage and may or may not have
    a reliable 3G connection. In fact, 63% reach the site via 2G. A client application
    experience that loads quickly and works even when the network is absent gives
    Flipkart a business advantage.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: Flipkart的消费市场几乎完全由在糟糕的移动连接上的客户组成。他们的移动设备存储空间有限，可能或可能没有可靠的3G连接。实际上，63%的用户是通过2G访问网站的。一个快速加载且在网络缺失时也能工作的客户端应用体验为Flipkart带来了商业优势。
- en: 'The Flipkart PWA ([https://developers.google.com/web/showcase/2016/flipkart](https://developers.google.com/web/showcase/2016/flipkart))
    was created by a small team of engineers in 42 days, a small investment on their
    part that has paid huge dividends by increasing conversions by 70%. These are
    just some of their published key performance indicators:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: Flipkart PWA（[https://developers.google.com/web/showcase/2016/flipkart](https://developers.google.com/web/showcase/2016/flipkart)）是由一支小型工程师团队在42天内创建的，他们在这一过程中投入的小额投资通过提高转化率70%获得了巨大的回报。以下是他们发布的一些关键性能指标：
- en: Users time on the site with Flipkart lite vs previous mobile experience, 3.5
    minutes vs 70 seconds
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与Flipkart lite相比，用户在网站上的时间比之前的移动体验长，3.5分钟比70秒
- en: 3x more time spent on site
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在网站上花费的时间增加3倍
- en: 40% higher re-engagement rate
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 40%更高的重新参与率
- en: 70% greater conversion rate among those arriving via the Add to Homescreen feature
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过“添加到主屏幕”功能到达的用户的转化率提高70%
- en: 3x lower data usage
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据使用量降低3倍
- en: Over 50% of the Weather Channel's mobile usage comes from the web. Reaching
    consumers around the world is a priority. The web offers a reliable channel to
    reach everyone, which often means lower powered devices. Re-engagement and the
    delivery of timely information, such as storm warnings, was also very important.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: The Weather Channel的移动使用量超过50%来自网络。触及全球消费者是一个优先事项。网络提供了一个可靠的渠道来触及每个人，这通常意味着低功耗设备。重新参与和及时信息（如风暴预警）的提供也非常重要。
- en: 'The Weather Channel ([https://developers.google.com/web/showcase/2016/weather-channel](https://developers.google.com/web/showcase/2016/weather-channel))
    created a PWA, implementing push notifications to deliver experiences matching
    their native application. This upgrade enabled their team to reach 178 countries
    and deliver weather forecasts while improving their load time:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: The Weather Channel（[https://developers.google.com/web/showcase/2016/weather-channel](https://developers.google.com/web/showcase/2016/weather-channel)）创建了一个PWA，通过推送通知提供与原生应用相匹配的体验。这次升级使他们的团队能够触及178个国家，并在提高加载速度的同时提供天气预报：
- en: This PWA is now available in 62 languages and 178 countries
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这个PWA现在在62种语言和178个国家可用
- en: 80% improvement in load time
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加载时间提高80%
- en: Based on this successful global test, the team will expand the PWA to its U.S
    site in 2017
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于此次成功的全球测试，团队将在2017年将PWA扩展到其美国网站
- en: Lancôme ([https://developers.google.com/web/showcase/2017/lancome](https://developers.google.com/web/showcase/2017/lancome))
    rebuilt their mobile web presence as a PWA and increased conversions by 17%. As
    they tracked mobile web usage, passing desktop, Lancôme saw their conversions
    drop. After considering a native application, they decided investing in the web
    was the right way to go.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 兰蔻([https://developers.google.com/web/showcase/2017/lancome](https://developers.google.com/web/showcase/2017/lancome))将其移动网络存在重建为PWA，转化率提高了17%。随着他们跟踪移动网络使用情况，超过桌面，兰蔻看到他们的转化率下降。在考虑原生应用后，他们决定投资于网络是正确的选择。
- en: They determined customers were not likely to download a native application,
    nor use it often. They knew a web presence would have to be done right, as doing
    so could generate more rewards. They decided to rebuild their web presence from
    the ground up as a PWA.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 他们确定客户不太可能下载原生应用，也不太可能经常使用它。他们知道必须正确地建立网络存在，因为这样做可以产生更多回报。他们决定从头开始重建他们的网络存在，作为一个PWA。
- en: 'Overall benefits:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 总体收益：
- en: 84% decrease in time until the page is interactive
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 页面交互时间缩短84%
- en: 17% increase in conversions
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 转化率增加17%
- en: 15% decrease in bounce rate
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跳出率降低15%
- en: 51% increase in mobile sessions
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 移动会话增加51%
- en: 'iOS improvements:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: iOS改进：
- en: 53% increase in mobile sessions on iOS
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: iOS上的移动会话增加53%
- en: 10% decrease in bounce rates on iOS
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: iOS上的跳出率降低10%
- en: 'Push notification benefits:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 推送通知收益：
- en: 8% of consumers who tap on a push notification make a purchase
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有8%的消费者在点击推送通知后进行购买
- en: 18% open rate from push notifications
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 推送通知的打开率提高18%
- en: 12% increase in conversion rates on recovered carts via push notifications
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过推送通知恢复购物车的转化率提高12%
- en: If you are worried about browsers that do not support PWA technology yet, take
    note of the iOS statistics. Lancôme is not alone; almost every company embracing
    PWAs have reported similar improvements on iOS. Later, you will see how to polyfill
    caching and the Add to Homescreen experience in your applications to achieve similar
    results.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您担心尚未支持PWA技术的浏览器，请注意iOS的统计数据。兰蔻(Lancôme)并不孤单；几乎每个采用PWA的公司都报告了在iOS上类似的改进。稍后，您将看到如何通过polyfill缓存和添加到主屏幕的体验在您的应用中实现类似的结果。
- en: These are just a few samples of major brands that have adopted PWAs and reported
    benefits. There are many more smaller businesses also improving because they are
    building web experiences customers want to use. The great thing is you can start
    enhancing your existing web site today using examples from this chapter.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 这些只是几个已经采用PWA并报告了收益的主要品牌的样本。还有许多更多的小型企业也在改进，因为他们正在构建客户想要使用的网络体验。好消息是，您今天就可以使用本章中的示例开始增强您现有的网站。
- en: What are PWAs?
  id: totrans-77
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是PWA？
- en: 'Two years ago, a Google Chrome engineer, *Alex Russell*, published the landmark
    blog post defining PWA. You can check the post on the following link: [http://bit.ly/2n1vQ2r](http://bit.ly/2n1vQ2r)'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 两年前，一位谷歌Chrome工程师*Alex Russell*发布了定义PWA的里程碑式博客文章。您可以在以下链接中查看文章：[http://bit.ly/2n1vQ2r](http://bit.ly/2n1vQ2r)
- en: With this blog post Alex declared that web could now stand toe to toe with native
    applications. But it goes beyond just native capabilities being added via service
    workers, and the Add to Homescreen heuristic also matters when it comes to building
    a website.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这篇博客文章，Alex宣布网络现在可以与原生应用并驾齐驱。但这不仅仅是通过服务工作者添加的原生能力，当涉及到构建网站时，添加到主屏幕的启发式方法也很重要。
- en: Another Google Chrome engineer, Chris Wilson said that Progressive Web Applications
    are a new level of thinking about the quality of your user experience.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 另一位谷歌Chrome工程师Chris Wilson表示，渐进式Web应用是关于您用户体验质量的一种新的思维方式。
- en: What the Chrome team and other browsers want you to understand is that user
    experience is the most important part of your website or application. Browsers
    are providing you with the foundation to build great applications, but it is still
    up to you to make these experiences come to life.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: Chrome团队和其他浏览器希望您理解的是，用户体验是您网站或应用最重要的部分。浏览器为您提供构建优秀应用的基础，但让这些体验变得生动还是取决于您。
- en: I tend to think that there is a confidence issue web developers have compared
    to native application developers. There is still this perception that native rules
    everything. However, this is not really true. As we'll see later, there are far
    more accessible web pages than native applications., and there is much more room
    to grow your website's brand compared to a native application.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 我倾向于认为，与原生应用程序开发者相比，网络开发者存在信心问题。仍然存在这种观念，即原生应用程序统治一切。然而，这并不完全正确。正如我们稍后将会看到的，可访问的网络页面比原生应用程序要多得多，与原生应用程序相比，你的网站品牌有更大的成长空间。
- en: Native applications serve a purpose, and that purpose is starting to fade away.
    The former head of Opera, Bruce Lawson, a very popular browser on mobile devices,
    stated (http://bit.ly/2e5Cgry) that native apps are a bridging technology.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 原生应用程序有其用途，而这种用途正开始变得过时。前Opera公司负责人布鲁斯·劳森，一个在移动设备上非常受欢迎的浏览器，表示（http://bit.ly/2e5Cgry）原生应用程序是一种过渡技术。
- en: That's a very bold statement, comparing the web to native applications. But
    it's something to think about. There are often many bridging technologies that
    lead to the real consumable product.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个非常大胆的声明，将网页与原生应用程序进行比较。但这确实值得思考。通常有许多过渡技术最终导致了真正的可消费产品。
- en: For example, Netflix began by shipping DVDs in the mail. I'm sure you could
    still do that today, but the vast majority of Netflix members simply stream and
    download video content to watch. The DVDs were a mere bridging technology to get
    the company started and form a relationship with a very loyal customer base.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，Netflix最初是通过邮寄DVD来发货的。我敢肯定你今天仍然可以这样做，但Netflix的大多数会员只是流式传输和下载视频内容来观看。DVD只是公司起步和与一个非常忠诚的客户群建立关系的过渡技术。
- en: The expenses involved in distributing those DVDs became too much for them to
    make it their primary distribution channel. As technology improved, which led
    to an increase in broadband, Netflix was able to shed the bridging distribution
    technology and focus on the original goal of getting videos and movies the living
    rooms of members all over the world.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 分发那些DVD的费用对他们来说太高，以至于他们无法将其作为主要分销渠道。随着技术的进步，宽带接入的增加，Netflix能够摆脱过渡分销技术，专注于最初的目标，即让视频和电影进入全球会员的客厅。
- en: In much the same way, mobile was a brand-new platform for building application
    experiences. And just like desktop computing, it started with native applications,
    and the web eventually won them over. The web won the desktop just as mobile technology
    emerged, and it emerged in a big way.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，移动设备是一个全新的平台，用于构建应用程序体验。就像桌面计算一样，它从原生应用程序开始，而网页最终赢得了它们的青睐。当移动技术出现时，网页也赢得了桌面，并且是以一种大规模的方式出现的。
- en: PWA signify a retooling of the web to make it a mobile first platform. Your
    applications can run faster, work offline, and ask users for permission to be
    on their homescreen. Never before have we been able to deploy these experiences
    at this level on the web.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: PWA标志着对网页的重新工具化，使其成为一个以移动设备为先的平台。你的应用程序可以运行得更快，离线工作，并请求用户允许它们出现在主屏幕上。我们以前从未能够在网页上以这种水平部署这些体验。
- en: Peak app
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 应用程序高峰
- en: Smartphone owners always lookout to download apps they think will be useful.
    If you are fortunate enough to have a consumer download your application, then
    odds are that they will delete it after one use if they find it troublesome or
    difficult to use.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 智能手机用户总是寻找他们认为有用的应用程序进行下载。如果你足够幸运，让消费者下载了你的应用程序，那么如果他们觉得使用起来麻烦或难以操作，他们很可能在第一次使用后就将其删除。
- en: According to a Nielsen study ([http://www.nielsen.com/us/en/insights/news/2015/so-many-apps-so-much-more-time-for-entertainment.html](http://www.nielsen.com/us/en/insights/news/2015/so-many-apps-so-much-more-time-for-entertainment.html))
    that average adult uses less than 30 apps per month. Over time the lack of using
    an app leads to the unused apps being purged.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 根据尼尔森的一项研究（[http://www.nielsen.com/us/en/insights/news/2015/so-many-apps-so-much-more-time-for-entertainment.html](http://www.nielsen.com/us/en/insights/news/2015/so-many-apps-so-much-more-time-for-entertainment.html)），平均成年人每月使用的应用程序不到30个。随着时间的推移，不使用应用程序会导致未使用的应用程序被清除。
- en: Several studies estimate roughly 10% of apps are used enough times to be retained.
    This means even if your app is downloaded the odds are it will eventually be removed
    and probably never used.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 几项研究估计，大约10%的应用程序使用足够频繁，可以保留。这意味着即使你的应用程序被下载，它最终也可能被删除，并且可能永远不会被使用。
- en: Brands are spending between $8-12 in advertising to earn a single application
    download. This means the true customer acquisition cost is roughly $80-120\. Good
    luck recuperating that expense.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 品牌在广告上花费8-12美元以换取单个应用程序的下载。这意味着真正的客户获取成本大约是80-120美元。祝你好运，希望你能收回这笔费用。
- en: The Apple and Google App Store's boast of 2 million or more applications. Some,
    dated, research shows nearly 60% of apps are never downloaded.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 苹果和谷歌应用商店宣称拥有200万或更多的应用程序。一些过时的研究显示，近60%的应用程序从未被下载。
- en: Apple recently made the barrier to success even higher by enforcing section
    4.2.6 of their application guideline requirements. This section gives them the
    authority to reject and remove apps at their discretion. They have been purging
    apps in mass they don't consider meet these arbitrary guidelines.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 苹果最近通过强制执行其应用程序指南要求的第4.2.6节，将成功的门槛提高得更高。这一节赋予他们根据自己意愿拒绝和删除应用程序的权力。他们一直在大量清除他们认为不符合这些任意指南的应用程序。
- en: Why have consumers stopped downloading applications? Space, both physical and
    temporal. Mobile phones and tablets only have so much disk space. Many applications
    now need 100 MB-1 GB of space. While a few 128 GB iPhones are sold, the typical
    iPhone size is 32 GB. After personal photos, videos, and music, there is little
    to no room for applications.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么消费者停止下载应用程序了？空间，无论是物理空间还是时间空间。手机和平板电脑的磁盘空间是有限的。现在许多应用程序需要100 MB-1 GB的空间。尽管销售了一些128
    GB的iPhone，但典型的iPhone容量是32 GB。在个人照片、视频和音乐之后，几乎没有空间留给应用程序。
- en: While we have become a society that can never seem to leave our mobile screens,
    there is still only so much time in a day. Market analysts pay close attention
    to what we do with our screen time. Kids watch videos and play silly games. Adults
    live in social media with Facebook and Snapchat owning their phones. Adults also
    play silly games, such as 2048.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管我们已经成为一个似乎永远离不开手机屏幕的社会，但一天中仍然只有那么多时间。市场分析师密切关注我们如何使用屏幕时间。孩子们观看视频和玩愚蠢的游戏。成年人生活在社交媒体中，Facebook和Snapchat占据了他们的手机。成年人也会玩一些愚蠢的游戏，比如2048。
- en: Out of the top five applications one these App Stores, Facebook owns three.
    The average adult spends over 2 hours a day in the Facebook universe looking at
    photos and videos. Text messaging is being replaced with Facebook Messenger. Millennials
    are addicted to Instagram, sharing, liking, and commenting on photos and videos
    non-stop.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些应用商店的前五名应用程序中，Facebook拥有三个。平均成年人每天在Facebook的世界中花费超过2小时来查看照片和视频。短信正被Facebook
    Messenger取代。千禧一代沉迷于Instagram，不停地分享、点赞和评论照片和视频。
- en: Facebook, Facebook Messenger, and Facebook-owned Instagram are the top three
    mobile applications. They are followed by YouTube, SnapChat, and Gmail. Two of
    those are owned by Google. After those applications, the distribution curve drops
    to nearly zero.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: Facebook、Facebook Messenger和Facebook拥有的Instagram是前三大移动应用程序。它们后面是YouTube、SnapChat和Gmail。其中两个由Google拥有。在这些应用程序之后，分布曲线下降到几乎为零。
- en: We, mobile consumers, have settled into usage habits and have found that the
    need for applications has passed.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 我们，作为移动消费者，已经习惯了使用习惯，并发现对应用程序的需求已经过去了。
- en: Installing an application, even if it is free, consists of eight steps, each
    step losing 20% of the initial interested base. The reason Amazon implemented
    **one click** purchasing was to eliminate friction and increase sales.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 安装一个应用程序，即使它是免费的，也需要八个步骤，每个步骤都会使最初的兴趣基础减少20%。亚马逊实施**一键**购买的原因是为了消除摩擦并增加销售额。
- en: The web is relatively frictionless. You click a link in an email or maybe search
    for something, clicking the best perceived result, and within a few seconds you
    have downloaded or installed the web page you need. Little to no friction and
    next to no device resources have been used.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 网络相对无摩擦。你点击一封电子邮件中的链接，或者搜索一些内容，点击最佳感知结果，几秒钟内你就下载或安装了你需要的网页。几乎没有摩擦，几乎没有使用设备资源。
- en: In contrast to the distribution of app usage in a given month, the average consumer
    visits over 100 websites. That is roughly 20 times more variety than their application
    distribution. This means there is more opportunity to engage customers via the
    web than native applications.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 与给定月份的应用程序使用分布相比，平均消费者访问超过100个网站。这大约是他们应用程序分布的20倍。这意味着通过网络与客户互动的机会比原生应用程序更多。
- en: The web satisfies two important consumer requirements of minimal resource investment.
    Very little time or disk space is needed. In fact, they do not need to uninstall
    your website when they clean out their device so that they can make more videos
    to share on Instagram.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 网络满足了两个重要的消费者需求：最小资源投资。所需的时间或磁盘空间非常少。实际上，当他们清理设备以便分享更多视频到 Instagram 时，他们不需要卸载你的网站。
- en: This is where PWA have risen in importance. Companies want their icons on consumer's
    devices. This symbolizes a relationship and hopefully increases sales or other
    engagement statistics. When brand engagement is cheap for the customer, they are
    more likely to take the step to make you part of their daily life.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是 PWA 之所以重要的地方。公司希望他们的图标出现在消费者的设备上。这象征着一种关系，并有望增加销售额或其他参与度统计数据。当品牌参与对消费者来说成本低廉时，他们更有可能采取步骤让你成为他们日常生活的一部分。
- en: Browsers are providing the engagement platform, but you still need to meet their
    requirements. That is what you are going to learn in this book.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 浏览器提供了参与平台，但你仍然需要满足它们的要求。这正是本书将要教授的内容。
- en: PWA features
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PWA 特性
- en: Don't mistake PWAs as a specific technology. It is more of a marketing term
    describing the usage of modern platform features to provide a certain quality
    of experience. Without good user experience, the technology does not matter.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 不要将 PWA（渐进式网络应用）误认为是特定技术。它更多的是一个营销术语，描述了使用现代平台功能来提供一定质量体验的方式。如果没有良好的用户体验，技术本身并不重要。
- en: 'The Chrome team has identified four experience factors a PWA should offer:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: Chrome 团队确定了 PWA 应该提供的四个体验因素：
- en: Fast
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 快速
- en: Reliable
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可靠
- en: Engaging
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 引人入胜
- en: Integrated
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 集成
- en: Research has shown that 53% of users will abandon a site if it takes longer
    than 3 seconds to load. Service worker caching makes page load time almost instant,
    but it cannot make animations faster. This requires knowledge of CSS animations
    and possibly JavaScript.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 研究表明，如果网站加载时间超过 3 秒，53% 的用户将放弃该网站。服务工作者缓存使得页面加载时间几乎瞬间完成，但它不能使动画更快。这需要了解 CSS
    动画和可能需要 JavaScript 的知识。
- en: Applications that stutter or jump around the screen are said to be janky. If
    you have ever loaded a web page, for example, almost any news website, and had
    the content jump up or down just as you start reading, you know what I am talking
    about. This is a very poor user experience and can easily be avoided with proper
    coding practices.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 出现卡顿或屏幕跳动现象的应用程序被称为“janky”。例如，如果你曾经加载过网页，比如几乎任何新闻网站，当你开始阅读时内容上下跳动，你就知道我在说什么了。这是一个非常差的用户体验，但可以通过适当的编码实践轻松避免。
- en: Later in this book, you are going to learn about **RAIL** (**Response, Animation,
    Idle, Load**) and the **PRPL** (**Push, Render, Pre-cache, and Lazy- load**) patterns.
    These are coding best practices offered by the Chrome team because they understand
    how browsers work. They, and the other browsers, want the web to work for everyone.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书的后面部分，你将学习关于 **RAIL**（响应、动画、空闲、加载）和 **PRPL**（推送、渲染、预缓存和懒加载）模式。这些是 Chrome
    团队提供的编码最佳实践，因为他们了解浏览器的工作原理。他们和其他浏览器厂商都希望网络对每个人都是可用的。
- en: Browser vendors are offering guidance to help developers create the class of
    web applications that will earn a place on customer's homescreens. This guidance
    starts with a mobile performance first approach.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 浏览器厂商正在提供指导，以帮助开发者创建能够在客户主屏幕上占有一席之地的网络应用程序。这种指导从以移动性能优先的方法开始。
- en: Consumers need to have confidence in an application, and they need to know that
    the application is reliable. This means it should just work when called upon.
    To enable this, a web application should load if the device is online, offline,
    and anything in-between.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 消费者需要对应用程序有信心，并且他们需要知道该应用程序是可靠的。这意味着当需要时它应该能够正常工作。为了实现这一点，一个网络应用程序应该在设备在线、离线以及介于两者之间的任何状态下都能加载。
- en: Service worker caching provides a proxy layer between the browser and the network.
    This makes the network a progressive enhancement. It also introduces a new class
    of programming web developers must master.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 服务工作者缓存在浏览器和网络之间提供了一个代理层。这使得网络成为一个渐进式增强。它还引入了程序员必须掌握的新一类编程。
- en: Later in this book, you are going to learn about different caching strategies
    and how to employ them in different scenarios to make websites just work.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书的后面部分，你将学习不同的缓存策略以及如何在不同的场景中应用它们，以使网站能够正常运行。
- en: Service workers open up a new layer of opportunity where web developers can
    add valuable features that improve performance, engagement, and data management.
    Service workers are designed to be extensible so future capabilities can be added.
    Right now, caching, push notifications, and background sync are supported, but
    there are many other features being debated in the W3C working groups.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 服务工作者为网络开发者打开了一个新的机会层，他们可以添加提高性能、参与度和数据管理的有价值功能。服务工作者被设计为可扩展的，以便未来可以添加更多功能。目前，支持缓存、推送通知和背景同步，但在W3C工作组中还在讨论许多其他功能。
- en: Push notifications give you the ability to connect with a consumer any time
    you wish, increasing engagement. As shared earlier, both the Weather Channel and
    Lancôme increased engagement via push notifications.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 推送通知让你能够在任何时候与消费者建立联系，从而增加参与度。如前所述，天气频道和兰蔻都通过推送通知增加了参与度。
- en: Background sync is a channel you can now use to let your application run when
    the network is unavailable. When connectivity is restored, you can seamlessly
    synchronize with the server without disrupting the user. Their phone may even
    be in their pocket while your application catches up.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 背景同步是一个你现在可以用来在网络不可用的情况下运行应用的通道。当连接恢复时，你可以无缝地与服务器同步，而不会打扰用户。甚至当你的应用正在同步时，他们的手机可能还在口袋里。
- en: A web application needs to engage users enough that they will want to make it
    a permanent fixture on their devices. Once your web application has the minimum
    technical requirements—a web manifest, registered service worker with a fetch
    event handler, and served via HTTPS—the browser triggers native prompts for the
    user to add the web application to their homescreen. You will delve more deeply
    into this experience as this book progresses.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 一个网络应用需要足够吸引用户，让他们愿意将其作为永久设备上的固定功能。一旦你的网络应用满足了最低的技术要求——网络清单、注册的服务工作者带有fetch事件处理器，并通过HTTPS提供服务——浏览器就会触发原生提示，让用户将网络应用添加到他们的主屏幕。随着本书的深入，你将更深入地了解这一体验。
- en: The web manifest, HTTPS, and service worker require different expertise to execute
    effectively. And in my opinion, they increase in complexity from the latter. That
    is why embracing PWA is often called a journey. It's something you can, and should,
    implement in steps.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 网络清单、HTTPS和服务工作者需要不同的专业知识才能有效执行。在我看来，它们的复杂性从后者开始增加。这就是为什么拥抱PWA通常被称为一段旅程。这是一件你可以，也应该分步骤实施的事情。
- en: PWA advantages
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PWA优势
- en: I teased you with the advantages the web has over native applications, but how
    do these advantages elevate the web's past native applications?
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 我曾向你展示了网络相对于原生应用的优势，但这些优势如何提升网络在过去的原生应用之上的地位呢？
- en: 'Let''s borrow a demonstration from the Chrome team. An XY graph can show the
    differences between the web and native applications. The vertical axis represents
    Capabilities. The x-axis represents Reach. The reach being defined is how easy
    it is to discover and quickly access the application or website:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们借鉴Chrome团队的一个演示。一个XY图可以显示网络和原生应用之间的差异。垂直轴代表功能。x轴代表覆盖范围。所定义的覆盖范围是指发现和快速访问应用或网站有多容易：
- en: '![](img/00005.jpeg)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/00005.jpeg)'
- en: For many years, native applications enjoyed a capability advantage. They had
    tight native platform APIs and hooks that enabled native applications to do things
    that the web was not designed to do. For example, native push notifications allow
    brands to send messages to customers without the application being open.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 多年来，原生应用一直享有能力优势。它们拥有紧密的本地平台API和钩子，使得原生应用能够做网络未设计去做的事情。例如，原生推送通知允许品牌在应用未打开的情况下向客户发送消息。
- en: However, apps are gated behind closed App Stores on Apple, Android, and even
    the Microsoft ecosystem. This makes finding applications very difficult. Many
    estimates show it takes between $8 and $12 a day to get a single app download.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，应用被苹果、安卓甚至微软生态系统的封闭应用商店所限制。这使得寻找应用变得非常困难。许多估计显示，每天需要花费8到12美元才能获得一个应用的下载。
- en: The web, as I mentioned earlier, simply was not ready for this shift to mobile.
    There have been several APIs such as geo-location and some web notification capabilities.
    These APIs are not necessarily on the same level with their native counterparts.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 如我之前提到的，网络本身并没有准备好适应这种向移动端的转变。已经有一些API，例如地理位置和某些网络通知功能。这些API并不一定与它们的原生对应物处于同一水平。
- en: Developers have lacked awareness of many modern APIs. Unfortunately, this lack
    of knowledge and confidence has caused websites to not take advantage of these
    capabilities.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 开发者对许多现代 API 缺乏认识。不幸的是，这种知识和信心的缺乏导致网站没有充分利用这些功能。
- en: Ten years ago, responsive design did not exist. However, today, not only do
    we have CSS media queries and a vast array of responsive CSS libraries, but we
    also have responsive images built-in to browsers. Now, websites can offer layouts
    and download appropriately sized images for all screen sizes without crazy hacks.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 十年前，响应式设计还不存在。然而，今天，我们不仅有 CSS 媒体查询和大量的响应式 CSS 库，而且浏览器还内置了响应式图片。现在，网站可以为所有屏幕尺寸提供布局和下载适当大小的图片，而无需进行疯狂的破解。
- en: Compared to their native counterparts, websites have always been easily discoverable.
    You can advertise a domain in any media channel and people know how to load it.
    Search engines are much more sophisticated than App Stores and provide an easy
    interface to find just about anything. The big advantage search engines have over
    App Stores is the ability to deeply index web content.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 与其原生版本相比，网站总是很容易被发现。你可以在任何媒体渠道中宣传一个域名，人们知道如何加载它。搜索引擎比应用商店要复杂得多，提供了一个简单的界面来查找几乎所有东西。搜索引擎相对于应用商店的一个大优势是能够深度索引网页内容。
- en: 'Search engines index pages deep within a website and thousands upon thousands
    of web pages per site. App stores can only offer a single point of entry to download
    the app. The only *page* you have control of is a sales page. In that one page,
    you need to sell your app without the customer sampling your content and experience.
    Reach is and has always been the web''s greatest superpower:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 搜索引擎索引网站深处的页面和每个网站数以千计的网页。应用商店只能提供一个下载应用的入口点。你唯一能控制的“页面”是一个销售页面。在这个页面上，你需要在不让客户体验你的内容和体验的情况下推销你的应用。触达能力和一直以来的网络最大超级力量：
- en: '![](img/00006.jpeg)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/00006.jpeg)'
- en: As the graph visualizes, the web is not only on equal footing with native applications—it
    exceeds native applications is most cases. Sure, there are still going to be edge
    cases where a native application is the best choice, but these are shrinking every
    time a browser adds a new feature.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 如图表所示，网络不仅在平等的基础上与原生应用程序并肩，而且在大多数情况下超过了原生应用程序。当然，仍然会有一些边缘情况，原生应用程序是最佳选择，但随着浏览器添加新功能，这些情况正在逐渐减少。
- en: PWA technical requirements
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: PWA 技术要求
- en: At a minimum, there are three core technical requirements to be a PWA. A website
    must have a web manifest file, be served using HTTPS, and must register a service
    worker with a fetch event handler. You will dive deeper into each one of these
    requirements in future chapters.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 至少，要成为 PWA，有三个核心技术要求。一个网站必须有一个 Web 清单文件，使用 HTTPS 提供服务，并且必须注册一个具有 fetch 事件处理器的服务工作者。你将在未来的章节中深入了解这些要求的每一个。
- en: The web manifest drives the Add to Homescreen experience. HTTPS provides a layer
    of security and trust between your application and the browser. The service worker
    provides the extensible backbone for event-driven functionality to execute on
    a separate thread from the user interface.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: Web 清单驱动着添加到主屏幕的体验。HTTPS 在你的应用程序和浏览器之间提供了一层安全性和信任。服务工作者提供了可扩展的后骨架构，用于在用户界面之外的线程上执行事件驱动功能。
- en: A PWA should also use an application shell or common HTML and CSS. This is the
    most common application of Chrome, which is used on just about every page on the
    site. If you have any experience with single page applications, you should understand
    what an application shell is.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: PWA 也应使用应用程序外壳或常见的 HTML 和 CSS。这是 Chrome 最常见的应用，它被用于网站上几乎每个页面。如果你有任何单页应用程序的经验，你应该理解应用程序外壳是什么。
- en: The application shell
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 应用程序外壳
- en: 'A typical application shell typically contains a header, a main content area,
    and a footer. Of course, this can vary by application and site. The 2048 game
    differs because there is only one web page:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 典型的应用程序外壳通常包含一个页眉、一个主要内容区域和一个页脚。当然，这可能会根据应用程序和网站而有所不同。2048 游戏不同，因为它只有一个网页：
- en: '![](img/00007.jpeg)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/00007.jpeg)'
- en: Application shells are common-place in single page applications because they
    dynamically render markup and data in the browser. This does not need to be the
    case with a PWA. The reason single page applications are so popular is their ability
    to create a more native-like transition experience because there is no request
    delay when a new page is requested.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在单页应用程序中，应用程序外壳很常见，因为它们可以在浏览器中动态渲染标记和数据。对于PWA来说，情况并不一定如此。单页应用程序之所以如此受欢迎，是因为它们能够创建更接近原生的过渡体验，因为请求新页面时没有请求延迟。
- en: Since a PWA can be cached locally, this does not mean you need a true application
    shell. If the application utilizes a cache first strategy, pages can load in a
    matter of milliseconds, often less than 100\. This is perceived as instant by
    the human mind.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 由于PWA可以本地缓存，这并不意味着你需要一个真正的应用程序外壳。如果应用程序采用先缓存策略，页面可以在毫秒级加载，通常小于100毫秒。这在人类心智中感觉是瞬间的。
- en: This does not mean you should not identify an application shell. Server and
    build rendering engines can use the application shell and an array of layouts
    to create server hosted markups. You will be exposed to this so that you can work
    as we build the photo gallery and podcast application.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 这并不意味着你不应该识别应用程序外壳。服务器和构建渲染引擎可以使用应用程序外壳和一系列布局来创建服务器托管标记。你将接触到这一点，以便在我们构建照片库和播客应用程序时工作。
- en: '2048'
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '2048'
- en: A few years ago, a popular application was a simple game called 2048\. The goal
    is to combine blocks with numbers to ultimately total 2048\. Blocks are numbered
    in multiples of 2\. You can combine adjacent blocks with the same value to create
    a new block with their combined value.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 几年前，一个流行的应用程序是一个简单的游戏，叫做2048。目标是合并带有数字的方块，最终总数达到2048。方块以2的倍数编号。你可以合并相邻的具有相同值的方块，以创建一个新方块，其值为它们的总和。
- en: '![](img/00008.jpeg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00008.jpeg)'
- en: I wasted more time playing this game than I care to admit. It is easy to play
    and highly addictive. A well-crafted brew of endorphins and gameplay.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 我在这个游戏上浪费的时间比我愿意承认的要多。它很容易玩，而且非常上瘾。这是一种很好的内啡肽和游戏体验的结合。
- en: Fortunately, there were numerous open source knock-offs available on GitHub.
    Several were web applications. I would wager that native versions distributed
    through app stores were websites wrapped in a native shell, a hybrid application.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，GitHub上有许多开源的类似版本可用。其中一些是网络应用程序。我敢打赌，通过应用商店分发的原生版本可能是包裹在原生外壳中的网站，是一种混合应用程序。
- en: 'I chose a popular repository to fork for the book. The 2048 web application
    is simple and a perfect candidate to demonstrate how to make an exemplary PWA
    example:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 我选择了一个流行的仓库来为这本书进行分支。2048网络应用程序简单，是展示如何制作一个优秀的PWA示例的完美候选：
- en: The source code
  id: totrans-155
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 源代码
- en: The original application source code is available on GitHub ([https://github.com/gabrielecirulli/2048](https://github.com/gabrielecirulli/2048)).
    You can clone the repository and open it in a browser to play the game. Just be
    forewarned that it is addictive and could distract you from learning how to create
    PWAs.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 原始应用程序源代码可在GitHub上找到（[https://github.com/gabrielecirulli/2048](https://github.com/gabrielecirulli/2048)）。你可以克隆仓库并在浏览器中打开它来玩游戏。只是提前警告，它很容易上瘾，可能会分散你学习如何创建PWA的注意力。
- en: I forked the repository in my GitHub profile ([https://github.com/docluv/2048](https://github.com/docluv/2048)).
    My version adds the manifest, icons, service workers, and applies some code upgrades
    to make the application perform better and take advantage of newer APIs and browser
    features. The original code was written very well, but this was for browser capabilities
    of 3 years ago.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 我在我的GitHub个人资料中分支了这个仓库（[https://github.com/docluv/2048](https://github.com/docluv/2048)）。我的版本添加了清单、图标、服务工作者，并对代码进行了一些升级，以提高应用程序的性能并利用新的API和浏览器功能。原始代码编写得很好，但这是为了三年前的浏览器功能。
- en: Feel free to star, clone, and fork my GitHub repository to customize it to your
    liking. A working version of the final application created in this book is available
    online ([https://2048.love2dev.com/](https://2048.love2dev.com/)).
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 随意star、clone和fork我的GitHub仓库，以根据你的喜好进行定制。本书中创建的最终应用程序的运行版本可在网上找到（[https://2048.love2dev.com/](https://2048.love2dev.com/)）。
- en: The application's code structure
  id: totrans-159
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 应用程序的代码结构
- en: Let's review how the game's source code is structured. I like this project because
    the code is simple and demonstrates how much can be accomplished with a small
    amount of code in the browser.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾一下游戏源代码的结构。我喜欢这个项目，因为代码简单，展示了在浏览器中使用少量代码可以完成多少事情。
- en: 'There are three asset folders: `js`, `meta`, and `style`. They contain JavaScript
    files, images, and style sheets that are needed to render and execute the game.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 有三个资源文件夹：`js`、`meta`和`style`。它们包含渲染和执行游戏所需的JavaScript文件、图像和样式表。
- en: You will also notice a `node_modules` folder. I added a local web server using
    `grunt connect`, which is a node module. The original game works just fine if
    you load the `index.html` file directly in the browser. However, due to security
    constraints, a service worker does not function without a web server. I will cover
    this in more detail shortly.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 你还会注意到一个`node_modules`文件夹。我使用`grunt connect`添加了一个本地网络服务器，这是一个node模块。原始游戏如果直接在浏览器中加载`index.html`文件，则运行正常。然而，由于安全限制，没有网络服务器，服务工作者无法工作。我将在稍后详细介绍这一点。
- en: 'At the root-level, there are only handful of web application files:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在根级别，只有少数几个网络应用文件：
- en: '`index.html`'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`index.html`'
- en: '`manifest.json`'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`manifest.json`'
- en: '`sw.js`'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sw.js`'
- en: '`favicon.ico`'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`favicon.ico`'
- en: 'The nice thing about the 2048 code is that it only requires a single HTML file.
    The `manifest.json` and `sw.js` files add the PWA functionality we are after.
    The `favicon.ico` file is the icon loaded by the browser for the address bar:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 2048代码的优点在于它只需要一个HTML文件。`manifest.json`和`sw.js`文件添加了我们追求的PWA（渐进式网络应用）功能。`favicon.ico`文件是浏览器为地址栏加载的图标：
- en: '![](img/00009.jpeg)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00009.jpeg)'
- en: Adding node modules to the project
  id: totrans-170
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将node模块添加到项目中
- en: The original repository is a stand-alone game, meaning it does not require a
    web server to execute, just a browser. You can right-click the `index.html` file
    and choose to open it in your favorite browser. You can still do this after registering
    a service worker and may not notice any differences. But if you open the browser
    console (*F12* Developer Tools), you will most likely see an error.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 原始仓库是一个独立游戏，这意味着它不需要网络服务器来执行，只需要一个浏览器。你可以右键点击`index.html`文件，选择在您喜欢的浏览器中打开它。在注册服务工作者之后，你仍然可以这样做，可能不会注意到任何区别。但是，如果你打开浏览器控制台（*F12*
    开发者工具），你很可能会看到一个错误。
- en: This error can be attributed to service worker requirements. Service workers,
    like most new APIs supported by browsers, require HTTPS protocol. This requirement
    raises the default security level and gives the browsers a minimum level of trust
    in your site ownership.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 这种错误可以归因于服务工作者（service worker）的要求。服务工作者，就像大多数浏览器支持的新的API一样，需要HTTPS协议。这一要求提高了默认的安全级别，并使浏览器对您的网站所有权有最低程度的信任。
- en: The service worker specification relaxes this requirement for localhost addresses.
    Localhost is a common way to reference your local machine, which is typically
    a development environment. Because it is unlikely you are going to hack yourself,
    browsers tend to let you do what you want—except when you open files directly
    from the file system.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 服务工作者规范放宽了对localhost地址的要求。localhost是一种常见的引用本地机器的方式，通常是开发环境。由于你不太可能自己攻击自己，浏览器通常会允许你做你想做的事情——除了当你直接从文件系统中打开文件时。
- en: When localhost is used to load an asset, the browser is making a traditional
    network request, which requires a web server to respond. This means you, the user
    of the local machine, has gone through the effort of launching a local web server.
    This is not something the average consumer knows how to do.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用localhost加载资源时，浏览器正在发起一个传统的网络请求，这需要一个网络服务器来响应。这意味着你，作为本地机器的用户，已经费尽心思启动了一个本地网络服务器。这不是普通消费者知道如何做的事情。
- en: A file, opened from the file system, is different. Anyone can send you an `index.html`
    file that loads scary code, designed to steal your identity or worse show endless
    loops of cat videos! By not honoring the direct file system, access browsers are
    protecting you from registering a malicious service worker script. Trusting a
    localhost web server makes development easier by avoiding the messy process of
    registering a localhost SSL certificate.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 从文件系统打开的文件是不同的。任何人都可以发送一个`index.html`文件给你，该文件加载了令人恐惧的代码，旨在窃取你的身份或更糟的是展示无穷无尽的猫视频！通过不尊重直接文件系统，访问浏览器正在保护你免受恶意服务工作者脚本注册的影响。信任localhost网络服务器可以通过避免注册localhost
    SSL证书的繁琐过程来简化开发。
- en: There are a variety of local web servers you can run. In recent years, my preference
    is node connect, which I execute as a Grunt task ([https://love2dev.com/blog/make-a-local-web-server-with-grunt-connect/](https://love2dev.com/blog/make-a-local-web-server-with-grunt-connect/)).
    Because connect is a node module, you can launch it directly from the command
    line or a custom script. There are modules for your favorite task runner, such
    as Gulp and so on. Besides, node is cross-platform, so everyone can use connect.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以运行各种本地网络服务器。近年来，我更倾向于使用 node connect，我将它作为一个 Grunt 任务执行（[https://love2dev.com/blog/make-a-local-web-server-with-grunt-connect/](https://love2dev.com/blog/make-a-local-web-server-with-grunt-connect/)）。因为
    connect 是一个节点模块，您可以直接从命令行或自定义脚本中启动它。还有针对您喜欢的任务运行器，如 Gulp 等等的模块。此外，node 是跨平台的，所以每个人都可以使用
    connect。
- en: If you are familiar with installing node modules, you can skip ahead. If node
    and connect are new to you, this section will serve as a simple primer to get
    you up and running to run all the samples applications in this book on your local
    machine.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您熟悉安装节点模块，您可以跳过这一部分。如果 node 和 connect 对您来说是新的，本节将作为一个简单的入门指南，帮助您在本地机器上运行本书中的所有示例应用程序。
- en: The first step to loading a node module is to install them from [https://www.npmjs.com/](https://www.npmjs.com/)
    or one of the emerging package manager sites. You can manage this from the command
    line if you like, or you can define the modules needed in a `package.json` file.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 加载节点模块的第一步是从 [https://www.npmjs.com/](https://www.npmjs.com/) 或其他新兴的包管理网站安装它们。如果您喜欢，可以通过命令行来管理，或者您可以在
    `package.json` 文件中定义所需的模块。
- en: You can read more about the `package.json` format here ([https://docs.npmjs.com/files/package.json](https://docs.npmjs.com/files/package.json)).
    For our purposes, `grunt` and the `grunt-contrib-connect` module are `devDependencies`.
    You could also define a dependencies section if this were a node application.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在此处阅读有关 `package.json` 格式的更多信息（[https://docs.npmjs.com/files/package.json](https://docs.npmjs.com/files/package.json)）。就我们的目的而言，`grunt`
    和 `grunt-contrib-connect` 模块是 `devDependencies`。如果您这是一个节点应用程序，您也可以定义一个依赖项部分。
- en: 'Grunt is a task runner that gained popularity several years ago and is still
    my preferred task runner. Task runners, and there seems to be a new one every
    week, help you organize repeatable tasks into repeatable recipes. I use Grunt
    and custom node scripts to build and deploy my PWAs. Think about your task runner
    as a command-line control panel to manage your application:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: Grunt 是一种在几年前获得流行并仍然是我的首选任务运行器。任务运行器，似乎每周都有一个新版本，帮助您将可重复的任务组织成可重复的食谱。我使用 Grunt
    和自定义节点脚本来构建和部署我的 PWA。将您的任务运行器视为一个命令行控制面板来管理您的应用程序：
- en: '[PRE0]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Both Grunt and the Grunt connect module are node packages and must be downloaded
    in order to execute. The `package.json` file gives npm a configuration so it can
    manage your packages. This way, you can quickly set up your project on any machine
    without having to maintain your node dependencies as part of the source code.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: Grunt 和 Grunt connect 模块都是节点包，必须下载才能执行。`package.json` 文件为 npm 提供了配置，以便它可以管理您的包。这样，您就可以快速在任何机器上设置您的项目，而无需将节点依赖项作为源代码的一部分进行维护。
- en: If you have cloned the sample repository, you will note that the node modules
    were excluded from the source code. That's because they are not part of the application
    itself. They are a dependency and npm helps you recreate the desired environment.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您已经克隆了示例仓库，您会注意到节点模块被排除在源代码之外。这是因为它们不是应用程序本身的一部分。它们是一个依赖项，npm 帮助您重新创建所需的开发环境。
- en: 'To install the packages, you need to open a command line and change to your
    source code''s folder. Next, you must execute the following command:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装这些包，您需要打开命令行并切换到您的源代码文件夹。接下来，您必须执行以下命令：
- en: '[PRE1]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: This kicks off the npm installation process, which downloads your modules and
    their dependency chain. When completed, you have everything you need to run or
    build your application.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 这将启动 npm 安装过程，下载您的模块及其依赖链。完成后，您将拥有运行或构建应用程序所需的一切。
- en: 'Next, you will need to create a `gruntfile.js`. This is where you tell Grunt
    what tasks you want to run and how you want them to run. If you want to know the
    details of using Grunt, visit their website ([https://gruntjs.com/](https://gruntjs.com/)):'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，您需要创建一个 `gruntfile.js` 文件。这是您告诉 Grunt 您想运行哪些任务以及如何运行它们的地方。如果您想了解使用 Grunt
    的详细信息，请访问他们的网站（[https://gruntjs.com/](https://gruntjs.com/))：
- en: '[PRE2]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Since we are only using the connect module, the 2048 gruntfile is very simple.
    You need to tell Grunt to load the connect module, then register the task to run
    in the `initConfig` function.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们只使用connect模块，2048的Gruntfile非常简单。你需要告诉Grunt加载connect模块，然后在`initConfig`函数中注册任务。
- en: 2048 is a very simple application, which keeps our customization to a minimum.
    I arbitrarily chose port 15000 to serve the application and chose to have `keepalive`
    open. There are many options you can define. More details are available on the
    `grunt-contrib-connect` npm page ([https://www.npmjs.com/package/grunt-contrib-connect](https://www.npmjs.com/package/grunt-contrib-connect)).
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 2048是一个非常简单的应用程序，它将我们的定制化保持在最低限度。我随意选择了端口15000来提供服务，并选择保持`keepalive`开启。你可以定义许多选项。更多详细信息可以在`grunt-contrib-connect`
    npm页面找到（[https://www.npmjs.com/package/grunt-contrib-connect](https://www.npmjs.com/package/grunt-contrib-connect)）。
- en: 'The only task left to do is start the connect web server. This is done from
    the command line. If you still have the command line open from when you performed
    the npm install, you can reuse it. If not, repeat the process of opening a command
    line and changing to the project''s folder:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 剩下的唯一任务是启动connect网络服务器。这是通过命令行完成的。如果你在执行npm install时仍然打开了命令行，你可以重用它。如果没有，重复打开命令行并切换到项目文件夹的过程：
- en: '[PRE3]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Execute `grunt connect` and you should see the preceding example output. Note
    that the command continues to execute. This is because it is a server, listening
    to requests on port 15000\. You cannot execute additional commands at this prompt.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 执行`grunt connect`，你应该会看到前面的示例输出。请注意，命令会继续执行。这是因为它是一个服务器，正在监听端口15000的请求。你无法在这个提示符下执行其他命令。
- en: You can now load the 2048 game in your browser by entering `http://localhost:15000`
    in the address bar.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以在浏览器中通过在地址栏输入`http://localhost:15000`来加载2048游戏。
- en: Adding a manifest
  id: totrans-195
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 添加清单文件
- en: Adding a web manifest file should be the first step in upgrading an existing
    website. You can create your site's manifest file in a matter of minutes. In the
    tooling chapter, I will review a few online resources that can help automate the
    process.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 添加Web清单文件应该是升级现有网站的第一步。你可以在几分钟内创建你网站的清单文件。在工具章节中，我将回顾一些可以帮助自动化此过程的在线资源。
- en: 'Registering a PWA''s web manifest requires a special link element in the HTML
    `head` element. The following code shows how the 2048 manifest file is registered:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 注册PWA的Web清单需要在HTML的`head`元素中添加一个特殊的链接元素。以下代码显示了如何注册2048清单文件：
- en: '[PRE4]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: If you are familiar with referencing a style sheet, this syntax should look
    familiar. The difference is the `rel` attribute value being manifest. The `href`
    value points to the manifest file. You are free to name it anything, but manifest
    is the most common name.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你熟悉引用样式表，这个语法应该看起来很熟悉。区别在于`rel`属性值是manifest。`href`值指向清单文件。你可以自由命名它，但manifest是最常见的名称。
- en: The next chapter will go into more manifest file details. You can reference
    the project's `manifest.json` file to see how the 2048 game is configured. It
    contains the application's name, default URL, primary colors, and an array of
    icon image references.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将详细介绍清单文件。你可以参考项目的`manifest.json`文件来查看2048游戏的配置。它包含应用程序的名称、默认URL、主要颜色以及一个图标图像引用数组。
- en: Adding a service worker
  id: totrans-201
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 添加服务工作者
- en: Next, you need to register a service worker. This is done in what I call the
    client-side code, which is the JavaScript you are accustomed to writing. Service
    workers execute in a separate thread from the UI. I think about it as a background
    process. You still need to register the service worker for the site.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，你需要注册一个服务工作者。这是在所谓的客户端代码中完成的，即你习惯于编写的JavaScript。服务工作者在UI的独立线程中执行。我认为它是一个后台进程。你仍然需要为网站注册服务工作者。
- en: For simple registrations, like this example, my preferred method is a script
    block at the bottom of my site's markup. First, detect if service workers are
    supported. If they are, then attempt to register the site's service work. If the
    browser does not support service workers, skip the registration code so no exceptions
    occur.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 对于像这个例子这样的简单注册，我首选的方法是在我网站标记的底部添加一个脚本块。首先，检测是否支持服务工作者。如果支持，那么尝试注册网站的服务工作者。如果浏览器不支持服务工作者，则跳过注册代码以避免出现异常。
- en: Registration is done by calling the `navigator.serviceWorker.register` function.
    It accepts a single argument, which is a path to the service worker file. I will
    review more rules around this in later chapters.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 注册是通过调用 `navigator.serviceWorker.register` 函数来完成的。它接受一个参数，即服务工作者文件的路径。我将在后面的章节中回顾更多关于这个问题的规则。
- en: 'The register function returns a promise. You can add code to log successful
    registration as follows:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 注册函数返回一个承诺。你可以添加代码来记录成功的注册，如下所示：
- en: '[PRE5]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: We will start diving into details about service workers in Chapter 5, *The Service
    Worker Life Cycl*e. To help you understand the example code, let me introduce
    some service worker fundamentals. Service workers are completely asynchronous.
    They enter an idle or sleep state if they are not needed. They wake up or spin
    up completely in response to the operating system or browser firing and events.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在第 5 章 *服务工作者生命周期*中开始深入了解关于服务工作者细节。为了帮助你理解示例代码，让我介绍一些服务工作者基础知识。服务工作者是完全异步的。如果它们不需要，它们会进入空闲或睡眠状态。当操作系统或浏览器触发事件时，它们会唤醒或完全启动。
- en: All logic execution is a product of events. You must register event handlers
    to execute your service worker logic. The 2048 service worker registers event
    handlers for the install, activate, and fetch events.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 所有逻辑执行都是事件的结果。你必须注册事件处理程序来执行你的服务工作者逻辑。2048 服务工作者为安装、激活和获取事件注册了事件处理程序。
- en: 'The 2048 game service worker pre-caches the entire application in the install
    event. You will learn more about caching strategies in Chapter 6, *Master the
    Cache API – Manage Web Assets in a Podcast Application*. For now, we will cache
    the application so it is available all the time, without any network chatter:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 2048 游戏服务工作者在安装事件中预缓存了整个应用程序。你将在第 6 章 *掌握缓存 API – 在播客应用程序中管理网络资产*中了解更多关于缓存策略的内容。现在，我们将缓存应用程序，使其始终可用，没有任何网络通信：
- en: '[PRE6]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The 2048 service worker caches assets in the install event. The application
    assets are defined in an array in the server worker code. The cache API provides
    an interface to a special storage designed specifically to persist response objects.
    I will defer the details to later chapters:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 2048 服务工作者在安装事件中缓存资产。应用程序资产在服务器工作者代码中的一个数组中定义。缓存 API 提供了一个接口，用于一个专门为持久化响应对象而设计的特殊存储。我将把细节推迟到后面的章节中：
- en: '[PRE7]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: The service worker also has an activate and a fetch event handler. A fetch event
    handler must be registered before the add to homescreen feature can be triggered.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 服务工作者也有激活和获取事件处理程序。在触发添加到主屏幕功能之前，必须注册获取事件处理程序。
- en: 'The fetch event fires when the browser requests an asset from the network.
    This could be an image, stylesheet, script, AJAX call, and so on. The `event`
    parameter contains the request object and can be used to check your cache to see
    if the asset is available:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 当浏览器从网络请求资产时，获取事件会被触发。这可能是一个图像、样式表、脚本、AJAX 调用等等。`event` 参数包含请求对象，可以用来检查你的缓存以查看资产是否可用：
- en: '[PRE8]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Without a fetch event handler, your application cannot work offline. There is
    no requirement that the handler catch any requests, just that it is registered.
    It is a minimal check for offline capability.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 没有获取事件处理程序，你的应用程序无法离线工作。没有要求处理程序捕获任何请求，只需注册即可。这是离线功能的最小检查。
- en: In the example fetch event handler, all caches are interrogated to see if there
    is an existing match to the request. If so, the locally cached version is returned.
    If not, the request is passed to the network.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 在示例中的获取事件处理程序中，所有缓存都会被查询以查看是否存在与请求匹配的现有条目。如果存在，则返回本地缓存的版本。如果不存在，则请求会被传递到网络。
- en: 'That''s it; congratulations! Your website is now a PWA, at least on your local
    machine:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 就这样；恭喜！你的网站现在至少在你的本地机器上是一个 PWA：
- en: '![](img/00010.jpeg)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/00010.jpeg)'
- en: At this point, loading the 2048 localhost site in Chrome should cause an add
    to homescreen prompt being displayed. If not, reload the page once or twice and
    apply focus to the browser tab. If you are still not seeing the prompt, check
    the console for any error messages and debug them accordingly.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，在 Chrome 中加载 2048 本地站点应该会显示添加到主屏幕的提示。如果没有，请重新加载页面一次或两次，并将焦点应用到浏览器标签页上。如果你仍然没有看到提示，请检查控制台中的任何错误消息并相应地进行调试。
- en: Summary
  id: totrans-221
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, you have learned the basics of PWAs by updating a basic game
    website. We also reviewed what progressive websites are and why they were created.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你通过更新一个基本的游戏网站学习了 PWAs 的基础知识。我们还回顾了渐进式网站是什么以及为什么它们被创建。
- en: In the next chapter, you will learn more details about the homescreen prompt
    experience and how to make a proper web manifest file.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，你将了解更多关于主屏幕提示体验的细节以及如何制作一个合适的Web清单文件。
