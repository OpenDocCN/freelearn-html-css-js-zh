- en: Building an Express Application
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建Express应用程序
- en: Express.js is a Node.js web application framework. Express.js makes it easier
    to use Node.js and leverages its power. In this chapter, we will be creating an
    application using solely Express.js. Express.js is also a `node` package. We can
    use an application generator tool, which lets us create a skeleton of an express
    app easily, or we can simply create one ourselves from scratch.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Express.js是一个Node.js Web应用程序框架。Express.js使得使用Node.js更加容易并发挥其能力。在本章中，我们将仅使用Express.js创建一个应用程序。Express.js也是一个`node`包。我们可以使用应用程序生成器工具，让我们轻松地创建一个Express应用程序的框架，或者我们可以从头开始自己创建一个。
- en: 'In the previous chapter, we learned about what `npm` is, what a package is,
    and how to install a package.  In this chapter, we will cover the following elements:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们了解了`npm`是什么，什么是包，以及如何安装包。在本章中，我们将涵盖以下元素：
- en: What Node.js is and what it can do
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Node.js是什么以及它能做什么
- en: The benefits it adds
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它所增加的好处
- en: The basic programming of Node.js
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Node.js的基本编程
- en: Node.js core and custom modules
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Node.js核心和自定义模块
- en: An introduction to Express.js
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Express.js简介
- en: Creation of an application using Express.js
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Express.js创建应用程序
- en: Routes in Express.js
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Express.js中的路由
- en: 'MVC architecture: what it is and what value it adds when implemented in an
    application'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MVC架构：它是什么，以及在应用程序中实现时增加了什么价值
- en: File naming conventions for the application
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序的文件命名约定
- en: Folder reorganization to incorporate MVC
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件夹重新组织以整合MVC
- en: View creation for the Express.js application
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为Express.js应用程序创建视图
- en: There are a lot of `npm` packages out there that can let us create a skeleton
    for an Express.js application. One such package is `express-generator`. This lets
    us scaffold the whole application in seconds. It will create all the necessary
    files and folders in a modular structure. It generates the file structures in
    such a way that is very easy to understand. The only thing that we need to do is
    to define the template views and the routes.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 有很多`npm`包可以让我们为Express.js应用程序创建一个框架。其中一个包是`express-generator`。这让我们可以在几秒钟内创建整个应用程序的框架。它会以模块化结构创建所有必要的文件和文件夹。它以非常易于理解的方式生成文件结构。我们唯一需要做的就是定义模板视图和路由。
- en: We can modify this structure as per our needs and requirements as well. This
    is very handy when we are on a tight deadline and want to build an application
    in a day or so. The process is extremely simple.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以根据自己的需求修改这个结构。当我们时间紧迫，想在一天内构建一个应用程序时，这非常方便。这个过程非常简单。
- en: '`express-generator` is only one of many tools that are available to create
    a scaffold or a modular structure of an express application. Each generator tool
    may have its own way of building the file structure as per their standard which
    can be easily customized.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '`express-generator`只是许多可用于创建Express应用程序的脚手架或模块化结构的工具之一。每个生成器工具可能都有自己的构建文件结构的方式，可以很容易地定制。'
- en: If you are a beginner and want to understand how the folder structure works,
    I recommend you build the application from scratch. We will be discussing this
    further in this chapter.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你是初学者，并且想了解文件夹结构是如何工作的，我建议你从头开始构建应用程序。我们将在本章中进一步讨论这一点。
- en: To get started, first we need to learn more about Node.js before diving into
    Express.js.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始，首先我们需要在深入Express.js之前更多地了解Node.js。
- en: Introduction to Node.js
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Node.js简介
- en: Node.js is a JavaScript runtime build on a JavaScript engine. It is an open
    source framework used for server-side management. Node.js is lightweight and efficient
    and runs on various platforms, such as Windows, Linux, and macOS.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: Node.js是建立在JavaScript引擎上的JavaScript运行时。它是用于服务器端管理的开源框架。Node.js轻量高效，并在各种平台上运行，如Windows、Linux和macOS。
- en: 'Node.js was created by Ryan Dahl in 2009\. JavaScript used to be used mostly
    for client-side scripting, but Node.js enables JavaScript to be used on the server
    side as well. The invention of Node.js introduced the use of a single programming
    language in web applications. Node.js brings with it a lot of benefits, some of
    which are as follows:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: Node.js是由Ryan Dahl于2009年创建的。JavaScript过去主要用于客户端脚本编程，但Node.js使得JavaScript也可以用于服务器端。Node.js的发明引入了在Web应用程序中使用单一编程语言的概念。Node.js带来了许多好处，其中一些如下：
- en: '**Event-driven programming**: It means changing the state of an object from
    one to another. Node.js uses event-driven programming, which means it uses a user''s
    interactive actions, such as mouse clicks, and key presses, to change the state
    of objects.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 事件驱动编程：它意味着将对象的状态从一个状态改变为另一个状态。Node.js使用事件驱动编程，这意味着它使用用户的交互操作，如鼠标点击和按键按下，来改变对象的状态。
- en: '**Non-blocking I/O**: The non-blocking I/O, or non-synchronous I/O, means an
    asynchronous I/O. A synchronous process waits until the current running process
    is completed and, hence, blocks the process. On the other hand, the asynchronous process
    does not need to wait for that process to finish, which makes it fast and reliable
    as well.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 非阻塞I/O：非阻塞I/O，或者非同步I/O，意味着异步I/O。同步进程会等待当前运行的进程完成，因此会阻塞进程。另一方面，异步进程不需要等待该进程完成，这使得它快速且可靠。
- en: '**Single threading**: Single threading means that JavaScript runs in only a
    single event loop. Since an asynchronous process allows us to have multiple processes
    concurrently, it may seem like all these processes run in their own specific thread.
    But Node.js handles asynchronous a little differently. The event loop in Node.js
    triggers the next callback function that is scheduled for execution after the
    corresponding event has occurred.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单线程：单线程意味着JavaScript只在一个事件循环中运行。由于异步进程允许我们同时拥有多个进程，似乎所有这些进程都在自己的特定线程中运行。但是Node.js处理异步的方式有些不同。Node.js中的事件循环在相应事件发生后触发下一个被安排执行的回调函数。
- en: Understanding Node.js
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解Node.js
- en: Before diving into Node.js programming, let's first look into some fundamentals
    of Node.js. Node.js runs on the JavaScript V8 engine. The JavaScript V8 engine
    was built by *The Chromium Project* for Google Chrome and Chromium web browsers.
    It is an open source project written in C++. This engine is used for both client-
    and server-side web applications with JavaScript.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在深入研究Node.js编程之前，让我们先了解一些Node.js的基础知识。Node.js在JavaScript V8引擎上运行。JavaScript
    V8引擎是由*Chromium项目*为Google Chrome和Chromium网络浏览器构建的。它是一个用C++编写的开源项目。该引擎用于客户端和服务器端的JavaScript
    Web应用程序。
- en: Node.js programming
  id: totrans-27
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Node.js编程
- en: 'Let''s start by running a `node` process. Open the Terminal and type this command:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先运行一个`node`进程。打开终端并输入以下命令：
- en: '[PRE0]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This will start a new `node` process. We can write normal JavaScript here.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这将启动一个新的`node`进程。我们可以在这里编写普通的JavaScript。
- en: 'So, for example, we can write in the new Node shell the following JavaScript
    command:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，我们可以在新的Node shell中写入以下JavaScript命令：
- en: '[PRE1]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: It returns `1` when we type `a` and press enter.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们输入`a`并按回车时，它返回`1`。
- en: We can also run a file with the `.js` extension in a `node` process. Let's create
    a folder called `tutorial` in the root directory with the command `mkdir tutorial`
    and create a file inside it called `tutorial.js`.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以在`node`进程中运行带有`.js`扩展名的文件。让我们在根目录中创建一个名为`tutorial`的文件夹，命令是`mkdir tutorial`，并在其中创建一个名为`tutorial.js`的文件。
- en: 'Now, in the Terminal, let''s go into that directory with the following command:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，在终端中，让我们用以下命令进入该目录：
- en: '[PRE2]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'We should see something similar to the following:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该看到类似以下的东西：
- en: '![](img/db7d6f63-3df3-4fd9-842e-fc4f6177ef4b.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](img/db7d6f63-3df3-4fd9-842e-fc4f6177ef4b.png)'
- en: This does not return anything because we haven't written anything for `tutorial.js`
    yet.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 这不会返回任何东西，因为我们还没有为`tutorial.js`编写任何内容。
- en: 'Now, let''s add some code to the `tutorial.js`:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们在`tutorial.js`中添加一些代码：
- en: '[PRE3]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Now, run the file with this command:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，用以下命令运行文件：
- en: '[PRE4]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: We will see an output that says `Hello World`. This is how we execute files
    in Node.js.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将看到一个输出，上面写着`Hello World`。这就是我们在Node.js中执行文件的方式。
- en: Other than running on the V8 engine and executing JavaScript codes in a web
    browser, Node.js also provides a server running environment. This is the most
    powerful feature of Node.js. Node.js provides an HTTP module of itself that enables
    a non-blocking HTTP implementation. Let's build a simple web server to understand
    this.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 除了在V8引擎上运行并在Web浏览器中执行JavaScript代码之外，Node.js还提供了一个服务器运行环境。这是Node.js最强大的功能。Node.js提供了自己的HTTP模块，可以实现非阻塞的HTTP。让我们构建一个简单的Web服务器来理解这一点。
- en: 'On the same file, in `tutorial.js`, overwrite the file with the following code:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在同一个文件中，在`tutorial.js`中，用以下代码覆盖文件：
- en: '[PRE5]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Here, the  `var http = require('http');` code requires the HTTP module into our
    application. It means that now we can access the functions defined in the HTTP
    library via the `http` variable. Now we need to create a web server. The preceding
    code tells Node.js to run the web server in the 8080 port. The `function` parameter
    in the `createServer` method takes two arguments, `req` and `res`, which are the
    short form of request and response respectively. The first thing that we need
    to do inside that function is to set the HTTP header. This is basically defining
    what type of response we want from that request. Then, we define what we want
    to get in the response by using `res.send`. Finally, we ask the web server to
    listen to port 8080.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，`var http = require('http');`的代码将HTTP模块引入了我们的应用程序。这意味着现在我们可以通过`http`变量访问HTTP库中定义的函数。现在我们需要创建一个Web服务器。前面的代码告诉Node.js在8080端口运行Web服务器。`createServer`方法中的`function`参数接受两个参数，`req`和`res`，它们分别是请求和响应的简写。在该函数内部，我们需要做的第一件事是设置HTTP头。这基本上是定义我们希望从该请求中得到的响应类型。然后，我们通过`res.send`定义我们想要在响应中获取的内容。最后，我们要求Web服务器监听8080端口。
- en: 'When we run this code with `$ node tutorial.js`, the output looks like this:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们用`$ node tutorial.js`运行这段代码时，输出看起来像这样：
- en: '![](img/154a4a5f-59e2-4837-b2c7-7962c1eb24ed.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](img/154a4a5f-59e2-4837-b2c7-7962c1eb24ed.png)'
- en: 'When we type that URL in our browser, we should be able to see this:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们在浏览器中输入该URL时，我们应该能够看到这个：
- en: '![](img/d553340f-ee2f-4961-af8b-28c4b6269826.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d553340f-ee2f-4961-af8b-28c4b6269826.png)'
- en: That's how Node.js works as a server program.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是Node.js作为服务器程序的工作方式。
- en: To exit the `node` console, press *Ctrl* *+* *C* twice.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 要退出`node`控制台，请按两次*Ctrl* *+* *C*。
- en: Node.js modules
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Node.js模块
- en: A Node.js module is just a plain JavaScript file that consists of reusable code.
    Every module has its own specific functionality. We can think of it as a library.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 一个Node.js模块只是一个包含可重用代码的普通JavaScript文件。每个模块都有其特定的功能。我们可以将其视为一个库。
- en: For example, if we want to segregate all our user-related activities in our
    application, we create a module for it, which will handle all the data libraries
    about the users.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果我们想在我们的应用程序中将所有与用户相关的活动分隔开，我们可以为其创建一个模块，该模块将处理有关用户的所有数据库。
- en: The way we use a module in Node.js is via `require`. The example we just showed
    you about creating a web server is also a Node.js module.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在Node.js中使用模块的方式是通过`require`。我们刚刚展示的创建Web服务器的示例也是一个Node.js模块。
- en: Node.js core modules
  id: totrans-59
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Node.js核心模块
- en: 'There are two types of modules in Node.js. The core modules are the modules
    that are built in Node.js. They come in while we install Node.js. These are also
    called built-in modules. There are a lot of core modules in Node.js:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: Node.js有两种类型的模块。核心模块是内置在Node.js中的模块。它们在我们安装Node.js时就存在了。这些也被称为内置模块。Node.js中有很多核心模块：
- en: Debugger
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调试器
- en: Filesystem
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件系统
- en: HTTP
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: HTTP
- en: Path
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 路径
- en: Process
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 进程
- en: Events
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 事件
- en: 'If you want to look into more details about each of the core modules, you can
    visit the documentation at:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想了解每个核心模块的更多细节，可以访问文档：
- en: '[https://nodejs.org/api/.](https://nodejs.org/api/)'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://nodejs.org/api/.](https://nodejs.org/api/)'
- en: Custom modules
  id: totrans-69
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自定义模块
- en: These are the modules we create ourselves on top of Node.js. Since Node.js has
    a very large ecosystem, there are tons of different modules out there to grab
    for free according to our needs. We can build one ourselves or just use someone
    else's module. This is another aspect in which Node.js is powerful. It gives us
    the flexibility of using the modules from the community or we can build them by
    ourselves.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是我们在Node.js之上自己创建的模块。由于Node.js拥有一个非常庞大的生态系统，有大量不同的模块可以根据我们的需求免费获取。我们可以自己构建一个，也可以使用别人的模块。这是Node.js强大的另一个方面。它给了我们使用社区模块的灵活性，或者我们可以自己构建它们。
- en: 'We can view the list of all existing available modules at [https://www.npmjs.com/browse/depended](https://www.npmjs.com/browse/depended):'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在[https://www.npmjs.com/browse/depended](https://www.npmjs.com/browse/depended)上查看所有现有可用模块的列表：
- en: '![](img/72db803d-bbff-45a8-8283-f529bfecf3a4.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](img/72db803d-bbff-45a8-8283-f529bfecf3a4.png)'
- en: Introducing Express.js
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍Express.js
- en: Express.js is a minimalist server-side web framework for Node.js. It is built
    on top of Node.js to make it easy to manage the Node.js server. The most important
    strength of Express.js is that it makes the routing very, very easy. The robust
    API that it provides is very easy to configure. It is easy to receive requests
    from the frontend and easy to connect to the database. Express.js is also the
    most popular web framework for Node.js. It uses the **Model View Controller**
    (**MVC**) design pattern, which we will be discussing later on in this chapter.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: Express.js是一个用于Node.js的极简的服务器端Web框架。它是建立在Node.js之上的，以便轻松管理Node.js服务器。Express.js最重要的优势是它使路由非常非常容易。它提供的强大API非常容易配置。它很容易接收来自前端的请求，也很容易连接到数据库。Express.js也是Node.js最流行的Web框架。它使用**模型视图控制器**（**MVC**）设计模式，我们将在本章后面讨论。
- en: Installing Express.js
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装Express.js
- en: 'We have already covered how to install `node` modules via `npm`. Similarly,
    we can install Express.js via NPM using this command:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经介绍了如何通过`npm`安装`node`模块。同样，我们可以使用以下命令通过NPM安装Express.js：
- en: '[PRE6]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'This is an easy way to install `node` modules. But, while building an application,
    we''re going to need lots of different kinds of modules. We will also want to
    share these modules across our multiple applications. Hence, to make a module
    available globally, we will have to install it globally. For that, `npm` provides
    the option of adding `-g` when installing `node` modules. So, now we can use:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 这是安装`node`模块的一种简单方式。但是，在构建应用程序时，我们将需要许多不同类型的模块。我们还希望在多个应用程序之间共享这些模块。因此，为了使模块全局可用，我们必须全局安装它。为此，`npm`在安装`node`模块时提供了添加`-g`的选项。所以，现在我们可以使用：
- en: '[PRE7]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: This will install Express.js globally, which allows us to use the `express`
    command across multiple applications.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这将全局安装Express.js，这允许我们在多个应用程序中使用`express`命令。
- en: Creating an Express.js application
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建Express.js应用程序
- en: Now that we have installed Express.js, let's get started creating an application
    using Express.js.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经安装了Express.js，让我们开始使用Express.js创建应用程序。
- en: 'We will name our application `express_app`.  Building an outline of an express
    application is very simple using the `express` command. We can simply use:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将把我们的应用程序命名为`express_app`。使用`express`命令非常简单地构建一个Express应用程序的大纲。我们可以简单地使用：
- en: '[PRE8]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The output is as follows:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/5ed5de2e-8500-4b09-bdeb-7eb0ee523acf.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5ed5de2e-8500-4b09-bdeb-7eb0ee523acf.png)'
- en: 'The command creates a lot of files and folders in our application. Let''s have
    a quick look at these:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令会在我们的应用程序中创建许多文件和文件夹。让我们快速看一下这些：
- en: '`package.json`: This file contains a list of all the `node` packages that we
    have installed in the application and an introduction to the application.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`package.json`：这个文件包含了我们在应用程序中安装的所有`node`包的列表和应用程序的介绍。'
- en: '`app.js`: This file is the main entry page for an express application. The
    web server code resides in this file.'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`app.js`：这个文件是Express应用程序的主入口页面。Web服务器代码驻留在这个文件中。'
- en: '`public`: We can use this folder to insert our assets such as images, stylesheets,
    or custom JavaScript code.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`public`：我们可以使用这个文件夹来插入我们的资产，如图像、样式表或自定义JavaScript代码。'
- en: '`views`: This folder contains all of our view files that are going to be rendered
    in the browser. It has the main layout file (which contains the basic HTML templating
    for a view file), an `index.jade` file (which extends the layout file and only
    has the content that is changeable or dynamic), and an `error.jade` file (which
    displays when we need to display some sort of error messaging to our frontend).'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`views`：这个文件夹包含了所有将在浏览器中呈现的视图文件。它有一个主布局文件（包含视图文件的基本HTML模板），一个`index.jade`文件（扩展布局文件，只包含可变或动态的内容），以及一个`error.jade`文件（在需要向前端显示某种错误消息时显示）。'
- en: '`routes`: This folder has a whole list of all the routes that we will be building
    access different pages of the application. We will discuss more on this in further
    sections.'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`routes`：这个文件夹包含了我们将要构建的访问应用程序不同页面的所有路由的完整列表。我们将在后续章节中更多地讨论这个问题。'
- en: '`bin`: This folder contains the executable files for Node.js.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`bin`：这个文件夹包含了Node.js的可执行文件。'
- en: 'So, these are the basic things that we need to know. Now, use your favorite
    text editor to work on the application and let''s get started. Now, if we look
    at `package.json`, there are certain packages that we did not install but that
    are listed in the dependencies:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，这些是我们需要知道的基本事情。现在，使用你喜欢的文本编辑器来处理应用程序，让我们开始吧。现在，如果我们查看`package.json`，会发现有一些包我们没有安装，但在依赖项中列出了：
- en: '![](img/e44f9b6c-a3d5-47be-b601-fb8687b29f77.png)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e44f9b6c-a3d5-47be-b601-fb8687b29f77.png)'
- en: 'This is because these are the Express.js dependencies for any application.
    This means, when we create an application using the `express` command, it will
    automatically install all the dependencies that it needs. For example, the dependencies
    listed in the preceding `package.json` file do the following things:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 这是因为这些是任何应用程序的Express.js依赖项。这意味着，当我们使用`express`命令创建应用程序时，它将自动安装所有需要的依赖项。例如，前面`package.json`文件中列出的依赖项做了以下事情：
- en: '**body-parser**: This is used to parse the parameters of the body that we provide
    when making an HTTP request'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**body-parser**：用于解析我们在发出HTTP请求时提供的body参数'
- en: '**debug**: This is a JavaScript utility package that provides pretty formatting
    to what `console.log` returns'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**debug**：这是一个JavaScript实用程序包，可以对`console.log`返回的内容进行漂亮的格式化'
- en: We can install or remove packages via the `package.json` file as well. Just
    add or remove the name of the package in the `package.json` file to install or
    remove it. Then run `$ npm install`.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以通过`package.json`文件安装或删除包。只需在`package.json`文件中添加或删除包的名称以安装或删除它。然后运行`$ npm
    install`。
- en: '**express**: This is a Node.js JavaScript framework and is used for building
    scalable web applications on top of Node.js.'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**express**：这是一个Node.js JavaScript框架，用于构建可扩展的Web应用程序。'
- en: '**jade**: As mentioned previously, this is the default templating engine for
    Node.js. We should have seen a warning while creating the application with the `express`
    command, saying The default view engine will not be jade in future releases. This
    is because `jade` is going to be replaced by `pug`; `jade` was copyrighted by
    a company and the name was later changed to `pug`.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**jade**：如前所述，这是Node.js的默认模板引擎。在使用`express`命令创建应用程序时，应该会看到一个警告，指出默认视图引擎在将来的版本中将不再是jade。这是因为`jade`将被`pug`取代；`jade`曾经是一家公司拥有的，后来更名为`pug`。'
- en: 'The express generator uses the outdated `jade` templating engine. To change
    the templating engine, run the following steps:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: express生成器使用过时的`jade`模板引擎。要更改模板引擎，请执行以下步骤：
- en: 'In the `package.json` file, remove the `"jade": "~1.11.0"`, line and run:'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '在`package.json`文件中，删除`"jade": "~1.11.0"`一行，并运行：'
- en: '[PRE9]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Now, to install the new `pug` templating engine, run:'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，要安装新的`pug`模板引擎，请运行：
- en: '[PRE10]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'If we look into the `package.json` file, we should see a line similar to this:'
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们查看`package.json`文件，应该会看到类似于以下内容的一行：
- en: '`"pug": "^2.0.0-rc.4"`.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '`"pug": "^2.0.0-rc.4"`.'
- en: 'Rename the files in the `views` folder:'
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重命名`views`文件夹中的文件：
- en: '`error.jade` to `error.pug`'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`error.jade` to `error.pug`'
- en: '`index.jade` to `index.pug`'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`index.jade` to `index.pug`'
- en: '`layout.jade` to `layout.pug`'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`layout.jade` to `layout.pug`'
- en: 'Finally, in `app.js`, remove the line which says:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，在`app.js`中删除以下行：
- en: '[PRE11]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Add the following line to use `pug` as the view engine:'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加以下行以使用`pug`作为视图引擎：
- en: '[PRE12]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '**morgan**: This is middleware for logging the HTTP requests'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**morgan**：这是用于记录HTTP请求的中间件'
- en: '**serve-favicon**: This is for displaying a favicon in the browser to identify
    our application'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**serve-favicon**：用于在浏览器中显示一个favicon以识别我们的应用程序'
- en: It's not necessary to have all these dependencies for our application. They
    come from installing Express.js. Just dig around for what you want and then add
    or remove the packages as per your application needs.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的应用程序来说，并不需要所有这些依赖项。它们来自安装Express.js。只需查找您想要的内容，然后根据应用程序的需要添加或删除包。
- en: 'For now, we will leave it as it is. The `express` command just adds the dependencies
    to our `package.json` file and creates a skeleton for our application. In order
    to actually install these modules and packages listed in the `package.json` file,
    we need to run:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将保持原样。`express`命令只是将依赖项添加到我们的`package.json`文件中，并为我们的应用程序创建一个框架。为了实际安装`package.json`文件中列出的这些模块和包，我们需要运行：
- en: '[PRE13]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: This command will actually install all the dependencies. Now, if we look into
    the folder structure, we can see a new folder is being added called `node_modules`.
    This is the place where all of the packages that we installed within that application
    reside.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 这个命令将实际安装所有的依赖项。现在，如果我们查看文件结构，我们会看到一个名为`node_modules`的新文件夹被添加。这是我们在该应用程序中安装的所有包的所在地。
- en: 'Now, the first thing that we want to do is to set up a web server. For that,
    add the following line in the `app.js` file:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们要做的第一件事是设置一个Web服务器。为此，在`app.js`文件中添加以下行：
- en: '[PRE14]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Now, run the following command:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，运行以下命令：
- en: '[PRE15]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'This will spin up our application server. Now, when we go to the `http://localhost:3000/` URL,
    we should be able to get this:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 这将启动我们的应用程序服务器。现在，当我们访问`http://localhost:3000/`URL时，我们应该能够得到这个：
- en: '![](img/e5dbd016-ed59-4dbf-8aeb-ba560d247a0b.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e5dbd016-ed59-4dbf-8aeb-ba560d247a0b.png)'
- en: That's it. We have successfully created an Express application.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 就是这样。我们已经成功创建了一个Express应用程序。
- en: Express router
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Express路由器
- en: 'Let''s move on to the Express router. As mentioned earlier in the chapter,
    one of the most important aspects of Express.js is that it provides easy routing
    for the application. Routing is the definition of the URL for an application.
    If we look at `app.js`, we will see a section such as:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续学习Express路由器。正如本章前面提到的，Express.js最重要的一个方面之一是为应用程序提供了简单的路由。路由是应用程序的URL的定义。如果我们查看`app.js`，我们会看到类似于以下内容的部分：
- en: '[PRE16]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'This means that when we access a web page, and when a request is made to the
    home page, the express router redirects it to a router called `index.` Now, look
    at `routes/index.js`, which has the following code:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着当我们访问一个网页，并且当请求发送到主页时，express路由器会将其重定向到一个名为`index`的路由器。现在，查看`routes/index.js`，其中包含以下代码：
- en: '[PRE17]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'This means that when we access the home page, it renders a page called `index` that
    resides inside `views/index.pug` and passes a parameter for the `title` to be
    displayed on the page. Now, look at the `index.pug` file in the views folder,
    which has the following code:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着当我们访问主页时，它会渲染一个名为`index`的页面，该页面位于`views/index.pug`中，并传递一个`title`参数以在页面上显示。现在，查看`views`文件夹中的`index.pug`文件，其中包含以下代码：
- en: '[PRE18]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'This means it uses the layout from the `layout.pug` file and displays an `h1`
    title as well as a paragraph that renders the title that we passed from the route
    file. Hence, the output is as follows:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着它使用了`layout.pug`文件的布局，并显示了一个`h1`标题以及一个渲染我们从路由文件传递的标题的段落。因此，输出如下：
- en: '![](img/79f3e138-a5bb-4c1b-81e3-bde7992002d1.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](img/79f3e138-a5bb-4c1b-81e3-bde7992002d1.png)'
- en: Pretty simple and straightforward, right?
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 非常简单和直接了当，对吧？
- en: Request object
  id: totrans-140
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 请求对象
- en: 'A request object is an object that contains the information about the HTTP
    request. The properties of the request are:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 请求对象是一个包含有关HTTP请求信息的对象。请求的属性有：
- en: '**query: **This contains information about the parsed query strings. Accessed
    via `req.query`.'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**query: **这包含有关解析查询字符串的信息。通过`req.query`访问。'
- en: '**params: **This contains information about the parsed routing parameter. Accessed
    via `req.params`.'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**params: **这包含有关解析路由参数的信息。通过`req.params`访问。'
- en: '**body: **This contains information about the parsed request body. Accessed
    via `req.body`.'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**body: **这包含有关解析请求体的信息。通过`req.body`访问。'
- en: Response object
  id: totrans-145
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 响应对象
- en: After receiving the `request` on `req` variable, the `res` object is something
    that we send back as the `response` we want.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在`req`变量上接收到`request`后，`res`对象是我们作为`response`发送回去的东西。
- en: 'The properties of the response are:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 响应的属性包括：
- en: '**send: **This is used for sending a response to the views. Accessed via `res.send`.
    It takes two parameters, the status code, and the response body.'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**send: **用于向视图发送响应。通过`res.send`访问。它接受两个参数，状态码和响应体。'
- en: '**status: **If we want to send the success or failure of the application, `res.status`
    is used. This is the HTTP status code.'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**status: **如果我们想要发送应用程序的成功或失败，使用`res.status`。这是HTTP状态码。'
- en: '**redirect: **`res.redirect` is used when we want to redirect to a certain
    page rather than sending responses in other formats.'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**redirect: **当我们想要重定向到特定页面而不是以其他格式发送响应时，使用`res.redirect`。'
- en: Introduction to MVC
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: MVC介绍
- en: The MVC model is essential when building applications regardless of any programming
    languages. The MVC architecture makes it easy to organize our application's structure
    and separate out logic parts and view parts. We can incorporate this MVC structure
    at any time, even if we have completed half of our application. The best time
    to implement it is at the start of any application.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 无论使用何种编程语言，构建应用程序时MVC模型都是必不可少的。MVC架构使得组织应用程序的结构和分离逻辑部分和视图部分变得容易。我们可以随时引入这种MVC结构，即使我们已经完成了应用程序的一半。最好的实施时间是在任何应用程序开始时。
- en: 'As the name suggests, there are three parts to it:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 顾名思义，它有三个部分：
- en: '**Model: **All of the application''s business logic resides under these `models`.
    These deal with the database. They handle all the logic parts of the application.'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Model: **应用程序的所有业务逻辑都驻留在这些`models`下。它们处理数据库。它们处理应用程序的所有逻辑部分。'
- en: '**View: **Everything that the browser renders—what users see—is handled by
    these view files. It deals with whatever we send to the client.'
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**View: **浏览器渲染的一切——用户所见的一切——都由这些视图文件处理。它处理我们发送给客户端的任何内容。'
- en: '**Controller: **`Controllers` basically connect these `models` and views. It
    is responsible to take the logical calculations done in `models` to the `views`
    sections:'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Controller: **`Controllers`基本上连接这些`models`和视图。它负责将在`models`中进行的逻辑计算传递到`views`部分：'
- en: '![](img/ed9038d2-b132-4c49-abd4-ca54af97f786.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ed9038d2-b132-4c49-abd4-ca54af97f786.png)'
- en: It is not necessary to implement the MVC platform in the application we build.
    The JavaScript is pattern agnostic, which means we can create our own folder structure.
    Unlike other programming languages, we can choose whatever structure is easiest
    for us.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们构建的应用程序中，不需要实现MVC平台。JavaScript是一种模式不可知的语言，这意味着我们可以创建自己的文件夹结构。与其他编程语言不同，我们可以选择最适合我们的结构。
- en: Why MVC?
  id: totrans-159
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为什么要使用MVC？
- en: 'There are a lot of benefits that are added when we implement an MVC architecture
    into our application:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 将MVC架构应用到我们的应用程序中时，会增加很多好处：
- en: Clear segregation of business logic and views. This separation allows us to
    reuse the business logic throughout the whole application.
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 清晰地分离业务逻辑和视图。这种分离允许我们在整个应用程序中重用业务逻辑。
- en: The development process becomes faster. This is obvious since the parts are
    clearly separated out. We can just add our views to our views folder and add logic
    inside the `models` folder.
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开发过程变得更快。这是显而易见的，因为各部分被清晰地分离出来。我们只需将视图添加到我们的视图文件夹中，并在`models`文件夹中添加逻辑。
- en: It is easy to modify existing code. This is very handy when multiple developers
    are working on the same project. Anyone can pick up the application from anywhere
    and start making changes to it.
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 修改现有代码变得容易。当多个开发人员在同一个项目上工作时，这非常方便。任何人都可以从任何地方接手应用程序并开始对其进行更改。
- en: Changing the folder structure to incorporate MVC
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 改变文件夹结构以包含MVC
- en: Now that we know enough about MVC, let's modify the folder structure of the
    application we created, called `express_app`. First of all, we need to create
    these three folders in the root directory. There is already a views folders so
    we can skip that. Let's go ahead and create `models` and `controllers` folders.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了足够多关于MVC的知识，让我们修改我们创建的应用程序`express_app`的文件结构。首先，我们需要在根目录中创建这三个文件夹。已经有一个视图文件夹，所以我们可以跳过它。让我们继续创建`models`和`controllers`文件夹。
- en: After that, in our `app.js`, we need to include our controller files. To do
    that, we first have to introduce a new package called filesystem. This module
    makes it easy to perform operations related to files, such as reading/writing
    to the file.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的`app.js`中，我们需要包含我们的控制器文件。为了做到这一点，我们首先要引入一个叫做文件系统的新包。这个模块使得执行与文件相关的操作变得容易，比如读取/写入文件。
- en: 'So, to add this package to our application, run:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，要将这个包添加到我们的应用程序中，运行：
- en: '[PRE19]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: This `--save` argument is used when we want a `node` module to only be installed
    within our application. Also, after installation, this package will be automatically
    included in our `package.json`.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们只想要将一个`node`模块安装到我们的应用程序中时，使用`--save`参数。此外，在安装后，这个包将自动包含在我们的`package.json`中。
- en: '![](img/e78d5486-a74d-46e8-8cba-51a0992af1e4.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e78d5486-a74d-46e8-8cba-51a0992af1e4.png)'
- en: 'Now, we will need to require this module and use it to include all of our files
    that reside in the controller. For that, add these lines of code in our `app.js`.
    Make sure you add these lines before our web server running code:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们需要引入这个模块并使用它来包含控制器中的所有文件。为此，在我们的`app.js`中添加这些代码行。确保在我们的web服务器运行代码之前添加这些行：
- en: '[PRE20]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Let''s move ahead with adding a route to our controller. Let''s create a folder
    in the root of the application called `controllers` and add an `index.js` file
    to the `controllers` folder and paste the following code:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续添加一个路由到我们的控制器。让我们在应用程序的根目录中创建一个名为`controllers`的文件夹，并在`controllers`文件夹中添加一个名为`index.js`的文件，并粘贴以下代码：
- en: '[PRE21]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Now, all of our routes will be handled by the controller files, which means
    we don''t need the codes in `app.js` that control the routing. Hence, we can remove
    these lines from the file:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们所有的路由都将由控制器文件处理，这意味着我们不需要在控制路由的`app.js`中的代码。因此，我们可以从文件中删除这些行：
- en: '[PRE22]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Actually, we don't need that `routes` folder any longer. Let's also remove the
    `routes` folder.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，我们不再需要`routes`文件夹。让我们也删除`routes`文件夹。
- en: 'Similarly, let''s add a new route that controls all the user-related operations.
    For that, add a new file to the `controllers` folder called `users.js` and paste
    the following code inside it:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，让我们添加一个新的路由来控制所有与用户相关的操作。为此，在`controllers`文件夹中添加一个名为`users.js`的新文件，并在其中粘贴以下代码：
- en: '[PRE23]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Now, let''s restart our node server for the app with:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: '现在，让我们重新启动我们的应用程序的node服务器： '
- en: '[PRE24]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'With this, when we visit `http://localhost:3000/users`, we will be able to
    see the following:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 有了这个，当我们访问`http://localhost:3000/users`时，我们将能够看到以下内容：
- en: '![](img/f1e95c69-0473-449b-952c-2451add9a98e.png)'
  id: totrans-183
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f1e95c69-0473-449b-952c-2451add9a98e.png)'
- en: We have successfully set up a `controllers` and `views` part of the MVC architecture.
    We will cover more on `models` part in further sections.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经成功设置了MVC架构的`controllers`和`views`部分。我们将在后续章节中更多地涵盖`models`部分。
- en: In the previous chapter, we talked about GitHub and how to use it for making
    code history by making small commits. Don't forget to set up a repo and continuously
    push code to GitHub.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们谈到了GitHub以及如何使用它来通过进行小的提交来制作代码历史。不要忘记设置一个repo并持续将代码推送到GitHub。
- en: The npm packages are stored in the `node_modules` directory, which we should
    not push to GitHub. To ignore such files, we can add a file called `.gitignore`
    and specify the files we do not want to push to GitHub.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: npm软件包存储在`node_modules`目录中，我们不应该将其推送到GitHub。为了忽略这些文件，我们可以添加一个名为`.gitignore`的文件，并指定我们不想推送到GitHub的文件。
- en: 'Let''s create a file within our application as well, called `.gitignore`, and
    add the following content:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在我们的应用程序中创建一个名为`.gitignore`的文件，并添加以下内容：
- en: '[PRE25]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: This way, when we install any packages, it will not show up as the code difference
    while making commits to GitHub.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 这样，当我们安装任何软件包时，它不会显示为提交到GitHub时的代码差异。
- en: We are having to restart our `node` server every time we make some changes to
    our code which is very time-consuming. To ease this process, `node` provides a
    package called `nodemon`, which automatically restarts the server every time we
    make changes to the code.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 每次我们对代码进行更改时，都必须重新启动我们的`node`服务器，这非常耗时。为了简化这个过程，`node`提供了一个名为`nodemon`的软件包，它会在我们对代码进行更改时自动重新启动服务器。
- en: 'To install the package, run:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装软件包，请运行：
- en: '[PRE26]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'To run the server, use the following command:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 要运行服务器，请使用以下命令：
- en: '[PRE27]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: File naming conventions
  id: totrans-195
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 文件命名约定
- en: When developing an application, we need to follow a certain convention to name
    the files. As we go on building the application, we will have a whole lot of files,
    which can get messy. MVC allows for having parallel naming conventions across
    different folders, which can lead to the same filenames inside different folders.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 在开发应用程序时，我们需要遵循一定的命名约定来命名文件。随着应用程序的构建，我们将拥有大量文件，这可能会变得混乱。MVC允许在不同文件夹中具有并行命名约定，这可能导致不同文件夹中具有相同的文件名。
- en: We can work on such filenames as well if that is what we find to be easy and
    maintainable. Otherwise, we can just append the type of filename to each file, as
     in the following example; for a controller file to handle the user-related activities,
    we can leave it as `controllers/users.js`, or we can rename it to `controllers/users_controller.js`.
    We will be using `controllers/users` for our application.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这是我们发现易于维护的方式，我们也可以处理这样的文件名。否则，我们可以只向每个文件附加文件类型，如以下示例中所示；对于处理与用户相关的活动的控制器文件，我们可以将其保留为`controllers/users.js`，或者将其重命名为`controllers/users_controller.js`。我们将在我们的应用程序中使用`controllers/users`。
- en: 'The same goes for `models`, `services`, or any other folders that need to be
    shared among different areas throughout the application. For this application,
    we will be using the following naming convention:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 对于`models`、`services`或任何其他需要在应用程序中不同区域之间共享的文件夹，情况也是如此。对于这个应用程序，我们将使用以下命名约定：
- en: '![](img/2ecb07df-3666-4060-b1af-b197789c09df.png)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2ecb07df-3666-4060-b1af-b197789c09df.png)'
- en: Remember, there is no official naming convention in Node.js. We can definitely
    customize the way we find simpler. We will discuss more about creating `models`
    in further chapters. That will require us to create a connection with Mongo, which
    we will describe in further chapters.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，在Node.js中没有官方的命名约定。我们绝对可以自定义我们发现更简单的方式。我们将在后续章节中讨论更多关于创建`models`的内容。这将要求我们与Mongo建立连接，我们将在后续章节中描述。
- en: Creating view files for the Express.js application
  id: totrans-201
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为Express.js应用程序创建视图文件
- en: 'We learned about how to create `controllers` in the last section. In this section,
    we will talk about how to add and customize view files. If you remember, we have
    this code in `controllers/users.js`:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一节中，我们学习了如何创建`controllers`。在本节中，我们将讨论如何添加和自定义视图文件。如果你记得，我们在`controllers/users.js`中有这段代码：
- en: '[PRE28]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Let''s change a line that renders the `index` file to this:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们更改渲染`index`文件的一行为：
- en: '[PRE29]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: This means that the controller wants to load the `users` file, which is in the
    `views` folder. Let's go ahead and create a `users.pug` file in the `views` folder.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着控制器想要加载`users`文件，该文件位于`views`文件夹中。让我们继续在`views`文件夹中创建一个`users.pug`文件。
- en: 'After creating the file, paste in the following code; this is the same code
    as in the `index.pug` file in our `views` folder:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 创建文件后，粘贴以下代码；这与我们`views`文件夹中的`index.pug`文件中的代码相同：
- en: '[PRE30]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Now, if we used `nodemon`, we don''t have to restart our server; just reload
    the browser with the location `http://localhost:3000/users`. This should render
     the following:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如果我们使用`nodemon`，我们不必重新启动服务器；只需重新加载位置为`http://localhost:3000/users`的浏览器。这应该呈现如下内容：
- en: '![](img/bd386ef4-752b-4a54-9206-abf4b85a3bd4.png)'
  id: totrans-210
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bd386ef4-752b-4a54-9206-abf4b85a3bd4.png)'
- en: Now that we know how to connect `controllers` and `views` and how to create
    view files, let's get a little bit more information on the code of the file.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们知道如何连接`controllers`和`views`以及如何创建视图文件，让我们对文件的代码有更多了解。
- en: 'The first line says:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 第一行说：
- en: '[PRE31]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'What this means is that it is asking to extend the views that are already in
    the `layout.pug` file. Now, look at `layout.pug`:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着它要求扩展已经在`layout.pug`文件中的视图。现在，看看`layout.pug`：
- en: '[PRE32]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: This is a simple HTML file with `doctype`, `HTML`, `head`, and `body` tags.
    Inside the `body` tag, it says to block content, which means it yields the content
    from any other files that are written under this `block content` statement. If
    we look at `users.jade`, we can see that the content is written under the block
    content statement. Now, this is very useful because we don't have to repeat the
    entire HTML tags in every view file that we create.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个简单的HTML文件，包括`doctype`，`HTML`，`head`和`body`标签。在`body`标签内，它说要阻止内容，这意味着它会产生在此`block
    content`语句下编写的任何其他文件的内容。如果我们看`users.jade`，我们可以看到内容是在`block content`语句下编写的。现在，这非常有用，因为我们不必在创建的每个视图文件中重复整个HTML标签。
- en: 'Also, if we look at `users.js` inside the controller, there''s a line that
    says:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，如果我们查看控制器内的`users.js`，会有一行说：
- en: '[PRE33]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The render method has two parameters: the view that it wants to load and the
    variables that it wants to pass to that view. In this example, `Users` is passed
    to the title variable. And in `users.jade` in the `views` folder, we have:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: render方法有两个参数：它想要加载的视图和要传递给该视图的变量。在这个例子中，`Users`被传递给了title变量。在`views`文件夹中的`users.jade`中，我们有：
- en: '[PRE34]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'This renders that variable inside both the `h1` tag and the `p` tag. This way,
    we can pass any content that we want from `controllers` to views. Let''s add a
    new variable called `description` to the `render` method in the `users.js` controller:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 这将在`h1`标签和`p`标签内呈现该变量。这样，我们可以从`controllers`传递任何我们想要的内容到视图中。让我们在`users.js`控制器的`render`方法中添加一个名为`description`的新变量：
- en: '[PRE35]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Also, let''s make a place where this would be rendered in `users.pug`:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，让我们创建一个在`users.pug`中呈现的地方：
- en: '[PRE36]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'If we reload the browser, we''ll get:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们重新加载浏览器，我们会得到：
- en: '![](img/cbaf19b7-8457-426c-b195-65b17ac8dd2b.png)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cbaf19b7-8457-426c-b195-65b17ac8dd2b.png)'
- en: That's how we create the views for an express application. Now, go ahead and
    add views as you wish for our application.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是我们为express应用程序创建视图的方式。现在，继续根据我们应用程序的需要添加视图。
- en: Always make sure that you commit and push the changes into GitHub. The smaller
    the commit, the more maintainable the code is.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 始终确保将更改提交并推送到GitHub。提交越小，代码就越易维护。
- en: Summary
  id: totrans-229
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we learned what Node.js is and what Express.js is. We learned
    how to create an application using Express.js and learned about the MVC architecture.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了Node.js是什么，Express.js是什么。我们学习了如何使用Express.js创建应用程序，并了解了MVC架构。
- en: In the next chapter, we will talk about MongoDB and its queries. We will also
    talk about using Mongoose for fast development and Mongoose queries and validations.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将讨论MongoDB及其查询。我们还将讨论使用Mongoose进行快速开发以及Mongoose查询和验证。
