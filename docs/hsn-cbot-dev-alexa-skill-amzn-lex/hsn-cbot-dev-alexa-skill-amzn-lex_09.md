# 第九章：复习和持续开发

在本书中，我们涵盖了许多主题，并在许多不同的领域学习了技能。我们将这些技能结合起来，在 Alexa 和 Lex 平台上设计和创建复杂的聊天机器人。

本章将涵盖以下内容：

+   回顾本书中我们学到的技能

+   讨论如何继续你的聊天机器人开发探索

+   讨论聊天机器人的未来

# 我们学到了什么

本书涵盖了大量的技能，既有技术性的也有非技术性的。

# 对话设计

覆盖的第一个主题是对话设计。这是本书最重要的部分之一，因为每个好的聊天机器人都需要经过这个设计阶段。无论是 Alexa 技能、Lex 聊天机器人，还是使用不同技术构建的聊天机器人，都无关紧要。

在设计聊天机器人时，我们总是试图从一个完美的用户对话开始。从一个完美的对话开始意味着用户很可能会获得我们聊天机器人的最佳体验。

使用完美的对话，我们可以开始构建我们的流程图。这些图提供了更多技术结构，使我们能够指定我们正在保存哪些数据，我们正在调用哪些 API，以及从一个流程触发另一个流程。创建一系列相互链接的简短流程图非常强大，因为它提供了在聊天机器人成熟过程中连接新入口点和功能的灵活性。

# 亚马逊网络服务

接下来，我们介绍了**亚马逊网络服务**（**AWS**）以及我们可以使用的工具。我们首先通过 Lambda 控制台创建了一个 AWS Lambda，然后使用内置的测试功能进行了检查。

虽然在控制台中创建 Lambda 对于简单的函数来说很棒，但我们通常需要更多的功能和一个更可靠的体验。我们讨论了两种其他选项——**Cloud9**和**本地编辑**——并提到了它们的优点和局限性。

本地编辑有一些很好的优点，但缺乏轻松创建和更新 Lambda 的能力。为了解决这个问题，我们学习了`aws-cli`以及我们如何使用它来控制我们的 AWS 产品。使用`aws-cli`，我们创建了一个构建脚本，可以将我们的本地文件打包在一起，并将它们部署到 AWS。有了这个脚本，我们现在拥有了一个功能强大的开发环境，并且部署变得容易。

# 亚马逊 Alexa

然后是开始构建一些聊天机器人。我们从 Alexa 开始，了解了构成聊天机器人的组件。我们学习了如何使用意图、话语和槽位，以便用户能够与我们的聊天机器人进行交互。

为了使这个技能发挥作用，我们需要创建一个 Lambda 来处理请求。我们使用了`alexa-sdk`来使创建发送给用户的响应变得更加容易。

在一个可工作的 Alexa 技能的基础上，我们学习了如何使用内置的测试工具进行测试。这样，我们可以像用户一样测试它，但同时又能够看到我们的技能在后台是如何运作的。

一旦我们测试了聊天机器人，我们就准备好发布它。Alexa 技能需要发布到 Alexa 技能商店，我们学习了如何遵循这一流程，使我们的技能对公众可用。

# Amazon S3

为了增加我们所有聊天机器人的实用性，我们需要能够访问大量存储的数据。为此，我们学习了如何创建一个 S3 存储桶，在其中存储数据，然后从我们的 Lambdas 中访问这些数据。有了这种数据访问，我们可以向用户提供他们请求的主题的更多信息。

# 使用 API

然后，我们学习了如何访问第三方 API，以进一步提高我们聊天机器人的实用性。我们以 `openWeatherMaps` API 为例，这使我们能够访问我们无法自己生成的实时信息。

为了做到这一点，我们还学习了 `axios` 和如何进行 API 请求。有了这些技能，你将能够向 API 发送请求，为你的聊天机器人添加新功能。我们还探讨了处理错误的最两种最佳方式——使用 `try`/`catch` 和 `to()` 方法。我们讨论了为什么你可能想使用其中一种而不是另一种，以及为什么错误处理很重要。

# Amazon Lex

学习了 Amazon Lex 之后，我们开始构建基于文本的聊天机器人。我们看到了 Lex 和 Alexa 之间的相似之处和不同之处，并基于我们的现有知识创建了我们的第一个 Lex 聊天机器人。

我们了解到，每个意图都可以返回硬编码的响应或触发 Lambda。能够从每个意图触发不同的 Lambda 允许我们创建许多非常定制的 Lambda，以完成我们想要的确切操作。

当我们从 Lex 触发 Lambda 时，它期望一个非常明确的响应格式。不幸的是，目前还没有 `lex-sdk`，所以我们自己构建了一个。我们看到了五种不同的响应类型，并为每种类型创建了方法。这使得我们能够更容易地创建所需的响应。

# Dynamo DB

虽然 S3 对于存储大量可能不会经常变化的数据来说很棒，但它并不是存储经常变化的数据的理想选择。为了存储这类数据，我们学习了 DynamoDB。这是亚马逊的非关系型数据库，它使我们能够轻松地存储、访问和更新信息。我们使用它来存储用于在线商店的购物车。

我们创建了一个 `Dynamo` 类，它具有获取、写入、更新和删除这些 Dynamo 表的方法，这样我们就不必每次都编写长而复杂的代码。

# 发布 Lex 聊天机器人

如果你的用户无法访问它，那么能够构建一个令人惊叹的聊天机器人是没有意义的。我们学习了如何通过将我们的聊天机器人集成到 Facebook、Slack 和 Twilio 等平台上，利用这些平台庞大的现有用户基础。

我们还构建了一个 API 服务，使我们能够将我们的聊天机器人集成到更广泛的应用中。基于这个 API，我们为我们的聊天机器人创建了自己的前端界面。这很好，因为它让我们能够使其看起来和工作方式完全符合我们的期望。

# 高级功能

本书的前七章教我们如何通过使用其他服务如 S3、DynamoDB 和外部 API 来创建强大的 Alexa 技能和 Lex 聊天机器人。在第八章“提升您的聊天机器人的用户体验”中，我们探讨了 Lex 和 Alexa 内置的一些高级功能。

我们首先学习了如何为 Lex 创建信息卡片。这使我们能够向用户发送比之前发送的基本消息更多的视觉信息。添加这些卡片极大地提升了用户体验。

然后我们学习了 Alexa 中的短语槽位以及它们如何用于捕获那些选项过多而无法创建自定义槽位类型的信息。能够将如此广泛范围的输入捕获到槽位中，使我们的技能更加可靠和健壮。

我们最后学习的是 Lex 中的话语监控。这是我们可以查看 Lex 检测到的话语和它错过的话语的地方，这让我们了解了用户如何与我们的聊天机器人互动。这也提供了一个机制，可以轻松地将我们错过的话语添加到现有的意图中。

# 继续您的学习

现在您已经完成了这本书，您对语音和基于文本的聊天机器人有了很好的理解。您能够构建复杂的、多流程的聊天机器人，并集成其他服务如 S3、DynamoDB 和外部 API。如果您喜欢学习如何构建这些系统，那么您正处于继续您旅程的绝佳位置。

您的学习方向有很多，我将为您概述一些可能性——一些专门针对 Alexa 或 Lex，还有一些非常适合两者共同学习。

# Alexa

如果您非常喜欢为 Alexa 构建技能，那么在学习上我会选择两个方向。

# Amazon Echo Spot 和 Amazon Echo Show

**Amazon Echo Spot**和**Amazon Echo Show**是带有屏幕的 Amazon Alexa 设备。这意味着您可以为用户提供视觉信息以及语音响应。与 Lex 上的卡片一样，额外的视觉信息可以使用户体验更加丰富。

Echo 设备屏幕的一大优势是您可以向用户提供图片。仅使用语音向用户介绍产品可能会非常困难，但有了图片，用户体验会更加流畅。您还可以播放视频，进行幻灯片放映，或创建包含大量不同信息的自定义显示。

# 构建函数库

如果你喜欢构建 Alexa 技能并且想要开始构建更多，那么在构建多个技能时，你可能会想要使用相同的方法。有两种选择——每次都复制代码，或者创建一个方法 Lambda 库。第一种方法适用于少量技能，但随着技能数量的增加，这会变得令人烦恼。

第二种方法设置起来会花费更多时间，但会使构建未来的技能变得更加容易。这种设置的架构类似于 Lex 的工作方式，其中每个意图触发一个单独的 Lambda。不幸的是，目前这还不被支持，但我们可以使用 Lambda 调用函数来创建相同的效果。这让我们可以从我们的`handlers`对象中触发 Lambda。

这种方法的优点是，常见的意图可以触发相同的 Lambda，减少重复代码，同时独特的意图仍然可以在主处理 Lambda 中构建。

# Lex

如果你想要学习更多特定于 Lex 的技能，那么最好的方向是学习如何将其集成到更多的服务中。

Lex 原生不支持数百种消息服务，能够将你的聊天机器人集成到这些服务中将会是一项非常棒的技能。你可以尝试将你的聊天机器人集成到 Telegram、Twitter、微信或其他任何消息服务中。为此，你可能需要将消息映射到该特定服务的正确格式。格式之间的映射可能相当复杂，但学习这项技能是非常有用的。

一旦你构建了一个将 Lex 集成到这些消息平台的机制，你就可以宣传你的集成或你能够构建一个集成到公司自己的消息平台的机制。许多公司都希望能够在现有的消息平台上添加聊天机器人。

# Alexa 和 Lex

通过使用既适用于 Alexa 也适用于 Lex 的技能来继续你的学习，可能是你时间的最佳利用方式，而且有很多不同的方向可以探索。

# 改进构建过程

随着你构建更多的 Alexa 技能和 Lex 聊天机器人，你可能会对不得不打开 Alexa 技能套件或 Lex 控制台来添加新的语音或更改意图感到沮丧。幸运的是，我们有`aws-cli`和`ask-cli`可以使用，这样我们就可以在不上网的情况下构建和更新我们的技能和聊天机器人。

你可能还记得第二章中提到的`aws-cli`，*AWS 和 Amazon CLI 入门*，我们用它来允许我们从本地机器构建 Lambda。你也可以使用`aws-cli`为 Lex 聊天机器人做类似的事情，而`ask-cli`为 Alexa 技能提供了类似的功能。对于这两个系统，学习曲线相当陡峭，你最终会阅读大量的文档，但能够在不使用浏览器的情况下构建新的聊天机器人或技能是非常有用的。

你可以选择将聊天机器人或技能的完整结构保存为电脑上的文件，或者你可以创建一个系统，根据更简单的配置文件生成这些文件。后者的优点是配置文件应该更容易阅读和理解，这使得确定需要更改的内容变得容易得多。

一旦你建立了这个系统，你应能在几分钟内为一个新的机器人创建一个新的配置文件。如果你使用这个系统，没有任何阻止你仍然使用在线的 Alexa 技能套件或 Lex 控制台来检查、编辑和更新你的技能和聊天机器人的。

如果你正在考虑将构建聊天机器人或 Alexa 技能作为一项工作，那么这个工具将非常有价值。

# 集成更多 AWS 服务

在这本书中，我们学习了如何使用 S3 和 DynamoDB 来提高我们的技能和聊天机器人的功能。目前有超过 100 个 AWS 服务，其中一些可以用来为你的聊天机器人添加更多功能。

这里有一些服务集成的想法：

+   对于数据库存储，可以使用 Amazon Redshift 或 Amazon ElastiCache，采用不同的方法。

+   Amazon Cognito，允许用户登录以访问现有的订单和聊天，或提供与用户信息相匹配的结果

+   Amazon Transcribe 和 Amazon Simple Email Service，在用户与 Alexa 聊天时发送包含他们所说内容的电子邮件

随着可用服务的数量，你可以用 Alexa 和 Lex 构建和做的事情仅限于你的想象力。

# 集成其他 API

在线可用的 API 数量令人难以置信！仅仅浏览一份顶级 API 列表就能给你一些惊人的想法。比如一个你可以询问特定产品的聊天机器人，它会搜索 eBay 上的这些产品，让你可以在聊天中出价，而无需离开聊天！还有一个人口普查 API，可以用来构建一个 Alexa 技能，你可以用它来了解美国任何地区的人口、就业统计、经济、新房数量等等。

如果你正在寻找自己聊天机器人的想法，我强烈建议查看可用的 API 以及你可以用它们做什么。你可能会在一个 API 上找到一个功能，它可以与另一个 API 上的功能结合，创建一个功能强大的聊天机器人。

# 聊天机器人的未来

聊天机器人在过去十年中取得了长足的进步，现在通常通过 Amazon Echo 和 Google Home 在家庭中使用。技术上，它们取得了飞跃性的进步，AI 和机器学习的改进带来了更好的语言理解，以及语音到文本技术，这些技术为 Echo 和 Google Home 设备提供了动力。

我预计聊天机器人的增长将继续，我们将开始看到它们在广泛的领域中应用，并通过各种设备使用。随着它们的改进，它们将被信任执行越来越复杂和重要的任务，并将彻底改变许多行业。例如，客户服务行业已经在改变，多个银行和零售网站以及电话系统上已经有了聊天机器人。

# 语言理解

要能够正确地回应某人，你需要理解他们在说什么，这样你才能构建正确的回应。随着机器学习的采用，这已经得到了很大的改善，但远非完美。

可能出现的一个问题是存在两个具有相似表述或相同关键词的意图。当用户说一个相似的表述时，它会与两个意图相似地匹配，因此无法选择触发哪一个。一个具有“什么时候足球比赛？”表述的意图和另一个具有“足球比赛在哪里？”意图的聊天机器人很可能感到困惑，无法处理请求。

另一个问题可能是拼写错误和打字错误。Lex 目前似乎能够很好地处理打字错误和拼写错误，但确实有几次这些错误导致了问题。

随着机器学习和语言理解的提高，我预计这些问题将会减少。

# 与语音交互工作

就像语言理解一样，能够响应用户的请求意味着能够理解他们所说的话。在语音系统中，这涉及到将语音声波转换为文本。虽然如果你说话清晰且口音中性，这可以工作得非常好，但当人们说话很快或带有浓重口音时，通常会有问题。

当文本是由口音浓重的用户生成时，它往往会被误解，产生的文本也没有意义。这意味着当它被传递到语言理解系统中时，语音无法与意图匹配。这对那些无法与这些设备交互的口音浓重的用户来说可能非常令人沮丧。这是在基于语音的聊天机器人成为商业应用中常见之前需要克服的一个重大障碍。

# 改进的设备交互

能够通过基于语音和文本的对话与越来越多的设备和系统交互，这是聊天机器人融入我们日常生活扩展的关键。好事是，可以将 Alexa 软件安装到 Raspberry Pi Zero 上，这是一个价值 10 美元的计算机芯片。这意味着将语音交互添加到任何设备都可以既便宜又相对简单。现在已经在汽车、智能镜子、智能桌面上看到了 Alexa 的集成，还有更多。

我认为聊天界面将在可穿戴设备领域显著增长的另一个领域是。蓝牙免提系统正变得越来越小，更加隐蔽，它们可以非常容易地集成语音聊天系统。在一天中的任何时刻，你都可以询问 Alexa 天气或当天的会议，并立即得到回应。这将克服一些人对语音系统将他们的回应投影给房间内每个人都能听到的安全担忧。

带内置语音和文本聊天机器人的智能手表将提供另一种我们将看到聊天机器人融入我们生活的方式。与耳塞相比，手表的优势在于它们有屏幕，允许聊天机器人显示视觉媒体或向用户展示信息，而无需全部说出来。查看天气比听下五天的天气预报要方便得多，而你只关心下周三的天气。

我能想象在不久的将来使用聊天机器人的最后一款可穿戴设备是智能眼镜。类似于谷歌眼镜的眼镜将允许你以与智能手表相同的方式接收视觉信息，但你甚至不需要低头看手腕。将聊天机器人添加到这种增强现实系统可能会非常强大。

聊天机器人能够集成到可穿戴设备中最强大的方式可能是多个系统的集成。使用耳塞进行基于语音的聊天，但使用智能手表或智能眼镜来显示视觉信息，将结合两者的优点。

# 连接的设备

在聊天机器人变得普遍之前，需要克服的第二个障碍是能够连接到这些智能家居系统或远程控制解决方案的设备数量。你现在可以得到智能开关、咖啡机和甚至可以通过聊天界面控制的门锁。

在未来，我预计将会有越来越多的设备配备类似的控制系统。我可以想象一台洗衣机，你只需通过和 Alexa 对话就能设置并启动它，最终甚至是一个厨房，其中每个设备和电器都可以通过语音控制。想象一下告诉 Alexa 将烤箱调至 180 度，并在达到正确的温度时通知你，而你正坐着看电视，然后准备烤火鸡并让 Alexa 打开烤箱，以便你直接放入。烤箱随后可以称重火鸡，并在准备烤土豆前 50 分钟设置提醒。

除了集成聊天机器人的家用电器之外，我预计在未来 10-20 年内，商业中的聊天机器人数量将增加。银行柜员可能会变成一个由基于语音的聊天机器人驱动的动画人物屏幕。你可以从控制机器人熟食店的聊天机器人那里购买新鲜肉类和奶酪。这些机器人可以以与当前人类工人完全相同的方式工作，询问布里奶酪轮是否足够大，同时保持刀的位置。

除了商业应用之外，我还预计公共服务信息将开始整合聊天机器人。你到达购物中心停车场，想要找到特定的商店。你只需走到一个信息标志前，询问商店在哪里，它就会在地图上显示方向，告诉你如何到达那里，甚至可以将方向发送到你的智能手表或智能眼镜。

# 独特的基于语音的系统

为了推动刚刚提到的集成和设备，需要改变基于语音的聊天机器人的构建方式。如果你想构建一个处理用户语音的系统，那么你的两个主要选择是构建一个 Alexa 技能或一个 Google Home 动作。这对于集成到已经运行这些系统的设备来说很棒，但公司不会希望将 Alexa 作为你的银行柜员聊天机器人系统。

随着能够创建无需在 Alexa 或 Google Home 上运行的自定义语音聊天机器人系统的出现，市场需要发生变化。目前，这通过 Amazon Lex 成为可能，因为它已被构建来处理语音交互，但我希望看到能够执行此操作的系统范围的扩大。

# 通用人工智能

当前聊天机器人存在的大多数问题将逐渐得到解决，它们的性能将逐步提高，但下一个重大进步将是**通用人工智能**的创建。

通用人工智能是一个概念，即一个系统可以处理任何请求。这听起来可能并不遥远，比如 IBM Watson 正在构建一个可以统治 Jeopardy 和其他问答游戏的系统，但能够回答简单问题只是挑战的一部分。

问题始于系统必须确定它需要哪些其他信息来满足请求以及如何请求这些信息。如果有人让你找到他们的班级毕业照片，你可能会问他们上了哪所学校以及哪一年毕业。你利用自己对班级照片的知识来决定你需要询问学校和年份才能准确找到他们的班级照片。我们的大脑在这些任务上非常擅长，但构建一个能够为现在或未来的每一个可能的请求解决这个问题的人工智能系统是一个艰巨的任务。为每一个可能的问题构建意图是不可能的，因此系统需要收集它关于该主题的信息，确定它还需要了解什么来回答问题，然后以人类的方式请求这些数据片段。

另一个问题是与外部系统的集成。在这本书中，我们使用 API 来访问第三方存储的数据。为了使用这些 API，我们需要一个 API 密钥，即使如此，我们也只能访问通过 API 提供的数据和功能。如果我们想创建一个聊天机器人，它能帮我们完成每周的超市购物，送货上门并付款，我们就需要获得一个允许我们完成所有这些的 API。创建这样的 API 是大多数超市不会考虑的事情。

在我的工作中，将聊天机器人集成到客户的现有系统中是一个主要的难题，以确保其功能正常。拥有一个可以访问世界上每个 API 的通用人工智能系统是不现实的，即使如此，也有一些系统没有通过 API 公开。

# 改善人们的看法

提高人们对聊天机器人的接受度的一个主要障碍是改善人们对聊天机器人的看法。当聊天机器人最初出现时，它们的功能非常有限，无法处理许多话语的变化，并且往往证明比有用更令人沮丧。现代聊天机器人已经取得了很大的进步，但仍然有许多老旧的系统使用起来非常令人沮丧。即使现代聊天机器人系统也有其局限性，正如我们之前讨论的，它们仍然可能因为意图识别错误或语音理解不当而让用户感到失望。

随着系统的改进，更好的系统将拥有更好的用户留存率，而老旧的系统将被取代。我预计人们关于聊天机器人的看法将持续改善。随着像 Alexa 和 Google Home 这样的系统在家庭中变得越来越普遍，年轻一代将在与聊天机器人的互动中成长，与之互动将变得像呼吸一样自然。

# 摘要

这本书通过构建越来越复杂的 Alexa 技能和 Lex 聊天机器人，为我们提供了一个实用的聊天机器人入门介绍。我们学习了从完美的对话开始，并创建流程图来可视化用户与聊天机器人的对话路径。利用这些流程图，我们通过使用语句和槽位构建了意图，这些语句和槽位在 Lambda 中处理。

我们通过使用 S3 存储、DynamoDB 数据库和外部 API 来改进了聊天机器人的功能和能力。为了提升用户体验，我们还学习了如何使用 SSML 来改变 Alexa 与我们的用户交流的方式，学习了如何创建卡片以提供更多视觉信息，以及学习了在 Alexa 中关于搜索查询槽位类型的内容，以便收集更广泛的槽位值。

最后，我们讨论了几种构建在本书所学内容之上的优秀方法，以及我们对聊天机器人未来发展的预期。
