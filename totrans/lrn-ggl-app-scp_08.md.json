["```js\n// Replace with your spreadsheet's ID.\nvar ss = SpreadsheetApp\n    .openById(\"spreadsheet's id\");\n\nvar SheetOrders = ss.getSheetByName(\"Orders\");\nvar SheetStock = ss.getSheetByName(\"Stock\");\n```", "```js\nfunction doGet(){\n  var template = HtmlService.createTemplateFromFile(\"Order\");\n  var html = template.evaluate();\n  return HtmlService.createHtmlOutput(html);\n}\n```", "```js\n<!-- Order.html -->\n<!DOCTYPE html>\n<html>\n\n  <head>\n    <base target=\"_top\">\n  </head>\n\n  <body>\n    <form>\n      <table>\n        <tr>\n        <td><label>Select Item:</label></td>\n        <td>\n          <select>\n            <option value=\"Item 1\">Item 1</option>\n            <option value=\"Item 2\">Item 2</option>\n            <option value=\"Item 3\">Item 3</option>\n            <option value=\"Item 4\">Item 4</option>\n            <option value=\"Item 5\">Item 5</option>\n          </select>\n        </td>\n        </tr>\n\n        <tr>\n        <td><label>Unit price:</label></td>\n        <td><input type=\"text\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Quantity:</label></td>\n        <td><input type=\"number\" value=\"1\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Total price:</label></td>\n        <td><input type=\"text\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Deliver to:</label></td>\n        <td><textarea placeholder=\"Enter delivery address.\">\n        </textarea></td>\n        </tr>\n\n        <tr>\n        <td><label>Phone:</label></td>\n        <td><input placeholder=\"Enter phone number.\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>E-Mail:</label></td>\n        <td><input placeholder=\"Enter email address.\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Payment details:</label></td>\n        <td><input type=\"text\"\n              placeholder=\"Enter payment details.\" /></td>\n        </tr>\n      </table>\n\n      <br />\n      <input type=\"button\" value=\"Submit\" />\n    </form>\n  </body>\n\n</html>\n```", "```js\nfunction doGet(){\n  var template = HtmlService.createTemplateFromFile(\"Order\");\n  template.pricelist = getPrice();\n\n  var html = template.evaluate();\n  return HtmlService.createHtmlOutput(html);\n}\n```", "```js\nfunction getPrice(){\n  var data = SheetStock.getDataRange().getValues();\n\n  // remove header row.\n  data.shift();\n\n  return data;\n}\n```", "```js\n<td>\n  <select id=\"item\" name=\"item\">\n    <? for(var i in pricelist){ ?>\n      <option value=\"<?= pricelist[i][0] ?>\" > <?= pricelist[i][0] ?></option>\n    <? } ?>\n  </select>\n</td>\n```", "```js\n<td><input id=\"unit_price\" name=\"unit_price\" type=\"text\" readonly value=\"<?= pricelist[0][1] ?>\" /></td>\n```", "```js\n  <body>\n    <form>\n      <table>\n        <tr>\n        <td><label>Select Item:</label></td>\n        <td><select id=\"item\" name=\"item\">\n          <? for(var i in pricelist){ ?>\n              <option value=\"<?= pricelist[i][0] ?>\" ><?= pricelist[i][0] ?></option>\n          <? } ?>\n        </select></td>\n        </tr>\n\n        <tr>\n        <td><label>Unit price:</label></td>\n        <td><input id=\"unit_price\" name=\"unit_price\" type=\"text\" readonly value=\"<?= pricelist[0][1] ?>\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Quantity:</label></td>\n        <td><input id=\"quantity\" name=\"quantity\" type=\"number\" value=\"1\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Total price:</label></td>\n        <td><input id=\"total_price\" name=\"total_price\" type=\"text\" readonly value=\"<?= pricelist[0][1] ?>\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Deliver to:</label></td>\n        <td><textarea name=\"delivery_address\"\n              placeholder=\"Enter delivery address.\">\n              </textarea></td>\n        </tr>\n\n        <tr>\n        <td><label>Phone:</label></td>\n        <td><input name=\"phone\" type=\"phone\"\n              placeholder=\"Enter phone number.\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>E-Mail:</label></td>\n        <td><input name=\"email\" type=\"email\"\n              placeholder=\"Enter email address.\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Payment details:</label></td>\n        <td><input name=\"payment_details\" type=\"text\" placeholder=\"Enter payment details.\" /></td>\n        </tr>\n      </table>\n\n      <br />\n      <input class=\"blue\" id=\"btnSubmit\" type=\"button\" value=\"Submit\" />\n    </form>\n  </body>\n```", "```js\n  <head>\n    <base target=\"_top\">\n\n    <link rel=\"stylesheet\" href=\"//ssl.gstatic.com/docs/script/css/add-ons1.css\" />\n\n    <script src=\"img/jquery.min.js\"></script>\n\n    <script>\n        // On document load, assigns events to elements.\n        $(function(){\n        $(\"#item\").change(getUnitPrice);\n        $(\"#quantity\").change(calcTotalPrice);\n        $(\"#btnSubmit\").click(submit);\n      });\n\n      /*\n       * Retrieves corresponding unit price for the selected item\n       * and calculates the total price.\n       *\n       */\n      function getUnitPrice(){\n        google.script.run\n        .withSuccessHandler(function(price){\n          $(\"#unit_price\").val(price);\n          calcTotalPrice();\n        })\n        .getPrice( $(\"#item\").prop(\"selectedIndex\") );\n      };\n\n      function calcTotalPrice(){\n        $(\"#total_price\").val( $(\"#unit_price\").val() * $(\"#quantity\").val() );\n      };\n\n      function submit(){\n        // Remove already displayed messages, if any.\n        $(\"#success,#error\").remove();\n\n        this.disabled = true;\n\n        google.script.run\n          .withSuccessHandler(function(msg,elm){\n             elm.disabled = false;\n             showSuccess(msg,elm);\n           })\n          .withFailureHandler(function(msg, elm){\n             elm.disabled = false;\n             showError(msg, elm);\n           })\n          .withUserObject(this)\n          .postOrder( this.parentNode );\n          // submit button's parent, i.e. form.\n      }\n\n      function showSuccess(msg,elm) {\n        var span = $('<span id=\"success\"> <font color=\"green\"> ' + msg + '</font></span>');\n\n        $(elm).after(span);\n      }\n\n      function showError(msg,elm) {\n        var span = $('<span id=\"error\" class=\"error\"> ' + msg + '</span>');\n\n        $(elm).after(span);\n      }\n    </script>\n  </head>\n```", "```js\nfunction getPrice(index){\n  var data = SheetStock.getDataRange().getValues();\n\n  // remove header row.\n  data.shift();\n\n  return typeof index == \"undefined\" ? data : data[index][1];\n}\n```", "```js\nfunction isValidEmail_(email) {\n  var regex = /^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,6})?$/;\n  return regex.test(email);\n}\n```", "```js\nfunction postOrder(form){\n\n  // Validate user email\n  if( !isValidEmail_(form.email) )\n    throw \"please provide a valid email id.\";\n\n  /*\n   *  Date used as order number, \n   *  which helps to have distinctive number.\n   *  However, you may use any other number or string.\n   *\n   *  Prepend 'new' with '+' to get 'value' (number) of the date.\n   *\n   */\n  var orderNumber = +new Date();\n\n  // Construct form element values in an array.\n  var order = [\n    orderNumber,\n    form.item,\n    form.unit_price,\n    form.quantity,\n    form.total_price,\n    form.delivery_address,\n    form.phone,\n    form.email,\n    form.payment_details\n  ];\n\n  SheetOrders.appendRow(order);\n\n  var htmlBody = \"<p>Order number: \" + orderNumber + \"</p>\";\n  htmlBody += \"<p>Item: \" + form.item + \"</p>\";\n  htmlBody += \"<p>Unit price: \" + form.unit_price + \"</p>\";\n  htmlBody += \"<p>Quantity: \" + form.quantity + \"</p>\";\n  htmlBody += \"<p>Total price: \" + form.total_price + \"</p>\";\n  htmlBody += \"<p>Delivery address: \" + form.delivery_address\n              + \"</p>\";\n\n  htmlBody += \"<p>Phone number: \" + form.phone + \"</p>\";\n  htmlBody += \"<p>Payment details: \" + form.payment_details\n              + \"</p>\";\n\n  htmlBody += \"<p>Please quote the order number in your \" + \"correspondence.</p>\";\n\n  // Send an e-mail to the user.\n  MailApp.sendEmail({\n    to: form.email,\n    subject: \"Order placed\",\n    htmlBody: htmlBody\n  });\n\n  htmlBody += \"<p>&nbsp;</p>\";\n  htmlBody += '<p>Click <a href=\"'\n              + ScriptApp.getService().getUrl()\n              + '?order_number=' + orderNumber\n              + '\" >here</a> to dispatch the order.</p>';\n\n  /*\n   * Send an e-mail to the Accounts department with the same * content as to the user e-mail, additionally a clickable URL * with the order number appended as a query to the published * URL.\n   *\n   */\n  MailApp.sendEmail({\n    to: \"Accounts department email id\",\n    subject: \"Order - \" + orderNumber,\n    htmlBody: htmlBody\n  });\n\n  // Return confirmation message to user.\n  return \"Order placed successfully and more details \" \\+ \"has been sent to \" + form.email;\n};\n```", "```js\n<!-- Dispatch.html -->\n<!DOCTYPE html>\n<html>\n  <head>\n    <base target=\"_top\">\n    <link rel=\"stylesheet\" href=\"//ssl.gstatic.com/docs/script/css/add-ons1.css\" />\n    <script src=\"img/jquery.min.js\"></script>\n\n    <script>\n      // On document load, assign submit function to the submit\n      //  button's click event\n      $(function(){\n        $(\"#btnSubmit\").click(submit);\n      });\n\n      function submit(){\n        // Remove already displayed messages, if any.\n        $(\"#success,#error\").remove();\n        this.disabled = true;\n\n        google.script.run\n          .withSuccessHandler(function(msg,elem){\n             elem.disabled = false;\n             showSuccess(msg,elem);\n           })\n          .withFailureHandler(function(msg, elm){\n             elm.disabled = false;\n             showError(msg, elm);\n           })\n          .withUserObject(this)\n          .dispatchOrder( this.parentNode );\n      }\n\n      function showSuccess(msg,elm) {\n        var span = $('<span id=\"success\"> <font color=\"green\"> ' + msg + '</font></span>');\n        $(elm).after(span);\n      }\n\n      function showError(msg,elm) {\n        var span = $('<span id=\"error\" class=\"error\"> ' + msg + '</span>');\n        $(elm).after(span);\n      }\n    </script>\n  </head>\n\n  <body>\n    <form>\n      <table>\n        <tr>\n        <td><label>Order number:</label></td>\n        <td><input name=\"order_number\" type=\"text\" readonly value=\"<?= order[0] ?>\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Item:</label></td>\n        <td><input type=\"text\" readonly\n             value=\"<?= order[1] ?>\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Quantity:</label></td>\n        <td><input type=\"number\" readonly\n             value=\"<?= order[3] ?>\" /></td>\n        </tr>\n\n        <tr>\n        <td><label>Deliver to:</label></td>\n        <td><textarea readonly value=\"<?= order[5] ?>\"> </textarea></td>\n        </tr>\n\n        <tr>\n        <td><label>Shipment details:</label></td>\n        <td><textarea name=\"shipment_details\" placeholder=\"Enter shipment details.\" >\n              </textarea></td>\n        </tr>\n\n        <tr>\n        <td><input name=\"email\" type=\"hidden\"\n             value=\"<?= order[7] ?>\" /></td>\n        </tr>\n      </table>\n\n      <br />\n      <input class=\"blue\" id=\"btnSubmit\" type=\"button\" value=\"Submit\" />\n    </form>\n  </body>\n</html>\n```", "```js\nhttps://script.google.com/macros/s/AKfycbwRUVS6z5rjrAw8M- au9_ICYzixTVB3msLOCmoF5JCBVFNzY_7k/exec?order_number=1451875765851\n\n```", "```js\nfunction doGet(e){\n  var orderNumber = e.parameter.order_number;\n\n  if(orderNumber){\n\n    /*\n     *  If order number present in query string\n     *  then serve dispatch form to order processing unit.\n     *\n     */\n    var template = HtmlService.createTemplateFromFile(\"Dispatch\");\n    var data = SheetOrders.getDataRange().getValues();\n\n    for(var i in data){\n      if( data[i][0] == orderNumber ){\n        template.order = data[i];\n        break;\n      }\n    };\n\n  } else {\n\n    /*\n     *  If order number not present in query string\n     *  then serve order form to the user.\n     *\n     */\n    var template = HtmlService.createTemplateFromFile(\"Order\");\n    template.pricelist = getPrice();\n\n  };\n\n  var html = template.evaluate();\n  return HtmlService.createHtmlOutput(html);\n}\n```", "```js\nfunction dispatchOrder(form){\n  // Shipment details column number minus 1.\n  const SHIPMENT_DETAILS = 9;\n\n  var orderNumber = form.order_number;\n  var deliveryAddress = form.delivery_address;\n  var userEmail = form.email;\n  var shipmentDetails = form.shipment_details;\n\n  var data = SheetOrders.getDataRange().getValues();\n\n  for(var i = 0; i < data.length; i++){\n    if(data[i][0] == orderNumber){\n      SheetOrders.getRange(i+1, SHIPMENT_DETAILS+1)\n        .setValue(shipmentDetails);\n\n      var htmlBody = \"<p>Order number: \"\n          + orderNumber + \" has been dispatched to </p>\"\n          + \"<p>\" + deliveryAddress + \"</p>\"\n          + \"<p>By \" + shipmentDetails + \"</p>\"\n          + \"<p>&nbsp;</p>\"\n          + '<p>Click <a href=\"' + ScriptApp.getService().getUrl()\n          + '?order_number=' + orderNumber\n          + '&delivered=true\" >here</a> '\n          + 'to acknowledge the delivery.</p>';\n\n      // Send email to the user\n      MailApp.sendEmail({\n        to: userEmail,\n        subject: \"Order dispatched\",\n        htmlBody: htmlBody\n      });\n\n      // Return confirmation to the dispatch team.\n      return \"Shipment details updated and user notified by \" \\+ \"an e-mail.\";\n    }\n  };\n\n  // Displays error if query order_number not found in sheet.\n  throw \"Order number not found.\";\n};\n```", "```js\nhttps://script.google.com/macros/s/AKfycbwaqlj_kBAn9LLav0qv6GmXlWk-hwIosHA- 1_1YoMutiiuGy84/exec?order_number=1451875765851&delivered=true\n\n```", "```js\nfunction doGet(e){\n  var delivered = e.parameter.delivered;\n\n  if(delivered){\n    // If order delivered then just update delivery date.\n    updateDelivery(e);\n\n    // Returning text content is enough, HtmlService not needed.\n    return ContentService.createTextOutput(\"Thank you!\");\n  }\n\n  var orderNumber = e.parameter.order_number;\n\n  if(orderNumber){\n\n    /*\n     *  If order number present in query string\n     *  then serve dispatch form to order processing unit.\n     *\n     */\n    var template = HtmlService.createTemplateFromFile(\"Dispatch\");\n    var data = SheetOrders.getDataRange().getValues();\n\n    for(var i in data){\n      if( data[i][0] == orderNumber ){\n        template.order = data[i];\n        break;\n      }\n    };\n\n  } else {\n\n    /*\n     *  If order number not present in query string\n     *  then serve order form to the user.\n     *\n     */\n    var template = HtmlService.createTemplateFromFile(\"Order\");\n    template.pricelist = getPrice();\n\n  };\n\n  var html = template.evaluate();\n  return HtmlService.createHtmlOutput(html);\n}\n```", "```js\nfunction updateDelivery(e){\n  // Delivery date column number minus one.\n  const DELIVERED_ON = 10;\n\n  var orderNumber = e.parameter.order_number;\n  var deliveryDate = new Date();\n  var data = SheetOrders.getDataRange().getValues();\n\n  // Update delivery date on matched order number.\n  for(var i = 0; i < data.length; i++){\n    if(\"\"+data[i][0] == orderNumber){\n      SheetOrders.getRange(i+1, DELIVERED_ON+1)\n        .setValue(deliveryDate);\n    }\n  };\n}\n```"]