<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch08"/>Chapter 8. Waterfall, Funnel, Pyramid, and Heatmap Charts</h1></div></div></div><p>In this chapter, we explore some of the more unusual charts, such as waterfall and funnel charts, by using simple sales and accounting figures. We experiment with how we can link both the charts together with related information. Then, we move on to investigate how to plot a pyramid chart and assess the flexibility of Highcharts by imitating a financial pyramid chart from a proper commercial report. Finally, we study the heatmap chart and tweak various specific options with real-life statistics in a step-by-step approach. In this chapter, we will cover the following topics:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Constructing a waterfall chart</li><li class="listitem" style="list-style-type: disc">Making a funnel chart</li><li class="listitem" style="list-style-type: disc">Joining both waterfall and funnel charts</li><li class="listitem" style="list-style-type: disc">Plotting a commercial pyramid chart</li><li class="listitem" style="list-style-type: disc">Exploring a heatmap chart with inflation data</li><li class="listitem" style="list-style-type: disc">Experimenting with the dataClasses and nullColor options of a heatmap chart</li></ul></div><div><div><div><div><h1 class="title"><a id="ch08lvl1sec53"/>Constructing a waterfall chart</h1></div></div></div><p>A waterfall chart<a id="id497" class="indexterm"/> is a type of column chart where the positive and negative<a id="id498" class="indexterm"/> values are accumulated along the <em>x</em> axis categories. The start and end of adjacent columns are aligned on the same level, with columns going up or down depending on the values. They are mainly used to present cash flow at a higher level.</p><p>To use a waterfall chart, the <code class="literal">highcharts-more.js</code> library<a id="id499" class="indexterm"/> must be included:</p><div><pre class="programlisting">&lt;script type="text/javascript" 
 src="img/highcharts-more.js"&gt;&lt;/script&gt;</pre></div><p>Let's start with a simple waterfall, with a couple of values for income and expenditure. The following is the series configuration:</p><div><pre class="programlisting">            series: [{
                type: 'waterfall',
                upColor: Highcharts.getOptions().colors[0],
                color: '#E64545',
                data: [{
                    name: 'Product Sales',
                    y: 63700
                }, {
                    name: 'Renew Contracts',
                    y: 27000
                }, {
                    name: 'Total Revenue',
                    isIntermediateSum: true,
                    color: '#4F5F70'
                }, {
                    name: 'Expenses',
                    y: -43000
                }, {
                    name: 'Net Profit',
                    isSum: true,
                    color: Highcharts.getOptions().colors[1]
                }]
           }]</pre></div><p>First, we specify the series <code class="literal">type</code> as <code class="literal">waterfall</code>, then assign a color value (blue) to the <code class="literal">upColor</code> option, which sets the default color for any columns with positive values. In the next line, we declare another color value (red) which is for columns with negative values. The data point entries are the same as a normal column chart, except those columns representing the total sum so far. These columns are specified with the <code class="literal">isIntermediateSum</code> and <code class="literal">isSum</code> Boolean options without <em>y</em> axis values. The waterfall chart will display those as <a id="id500" class="indexterm"/>accumulated columns. We specify the accumulated columns with another color since they are neither income nor expenditure.</p><p>Finally, we need to enable the data labels to show the value flow, which is the sole purpose of a waterfall chart. The following is the <code class="literal">plotOptions</code> setting with the data label styling and formatting:</p><div><pre class="programlisting">      plotOptions: {
          series: {
              borderWidth: 0,
              dataLabels: {
                  enabled: true,
                  style: {
                      fontWeight: 'bold'
                  },
                  color: 'white',
                  formatter: function() {
                      return Highcharts.numberFormat(this.y / 1000, 1, '.') + ' k';
                  }
              }
          }
      },</pre></div><p>Here is a screenshot <a id="id501" class="indexterm"/>of the waterfall chart:</p><div><img src="img/7451OS_08_01.jpg" alt="Constructing a waterfall chart"/></div><div><div><div><div><h2 class="title"><a id="ch08lvl2sec59"/>Making a horizontal waterfall chart</h2></div></div></div><p>Let's assume that we need to plot a <a id="id502" class="indexterm"/>slightly more complicated waterfall chart, as we<a id="id503" class="indexterm"/> have a few more figures for revenue, expenses, and expenditure plans. Moreover, we need to display multiple stages of accumulated income. Instead of having a traditional waterfall chart with vertical columns, we declare the <code class="literal">inverted</code> option to switch the columns to horizontal. Since the columns are more compacted, the data labels may not fit inside the columns. Therefore, we put the data labels at the end of the columns. Here is<a id="id504" class="indexterm"/> a summary <a id="id505" class="indexterm"/>of the changes:</p><div><pre class="programlisting">            chart: {
                renderTo: 'container',
                inverted: true
            },
            ....,
            plotOptions: {
                series: {
                    borderWidth: 0,
                    dataLabels: {
                        enabled: true,
                        inside: false,
                        style: {
                            fontWeight: 'bold'
                        },
                        color: '#E64545',
                        formatter: ....
                    }
                }
            },
            series: [{
                type: 'waterfall',
                upColor: Highcharts.getOptions().colors[0],
                color: '#E64545',
                name: 'Q1 Revenue',
                data: [{
                    name: 'Product A Sales',
                    y: 63700,
                    dataLabels: {
                        color: Highcharts.getOptions().colors[0]
                    }
                }, {
                    name: 'Product B Sales',
                    y: 33800,
                    dataLabels: {
                        color: Highcharts.getOptions().colors[0]
                    }
                }, {
                    // Product C &amp; Renew Maintenance
                    ....
                }, {
                    name: 'Total Revenue',
                    isIntermediateSum: true,
                    color: '#4F5F70',
                    dataLabels: {
                        color: '#4F5F70'
                    }
                }, {
                    name: 'Staff Cost',
                    y: -83000
                }, {
                    // Staff Cost, Office Rental and Tax
                    ....
                }, {
                    name: 'Net Profit',
                    isSum: true,
                    color: Highcharts.getOptions().colors[1],
                    dataLabels: {
                        color: Highcharts.getOptions().colors[1]
                    }
            }]</pre></div><p>The following is the new<a id="id506" class="indexterm"/> look of the<a id="id507" class="indexterm"/> waterfall chart:</p><div><img src="img/7451OS_08_02.jpg" alt="Making a horizontal waterfall chart"/></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec54"/>Constructing a funnel chart</h1></div></div></div><p>As the name implies, the shape of a funnel <a id="id508" class="indexterm"/>chart is that of a funnel. A funnel chart is another way of showing how data flows in a diminished fashion. For example, it can be used to show the stages from the number of sale leads, demos, and meetings to actual sales, or the number of job applicants that pass through exams, interviews, and an offer to actual acceptance.</p><p>The funnel chart is packaged as a separate module which needs to include the JavaScript file as follows:</p><div><pre class="programlisting">&lt;script type="text/javascript" src="img/funnel.js"&gt;&lt;/script&gt;</pre></div><p>In this funnel chart example, we will plot a product starting from web visits and leading to product sales. Here is the series configuration:</p><div><pre class="programlisting">series: [{
      type: 'funnel',
      width: '60%',
      height: '80%',
      neckWidth: '20%',
      dataLabels: {
          format: '{point.name} - {y}',
          color: '#222'
      },
      title: {
          text: "Product from Web Visits to Sales"
      },
      data: [{
          name: 'Website visits',
          y: 29844
      }, {
          name: 'Product downloads',
          y: 9891
      }, {
          ....
      }]
}]</pre></div><p>Apart from the series type option, Highcharts simply draws the set of data points in a funnel shape configuration. We use the <code class="literal">neckWidth</code> option to control the width of the narrow part of the funnel as a ration of the plot area. The same applies to the <code class="literal">width</code> and <code class="literal">height</code> options. Here is a screenshot illustrating this:</p><div><img src="img/7451OS_08_03.jpg" alt="Constructing a funnel chart"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec55"/>Joining both waterfall and funnel charts</h1></div></div></div><p>So far, we have explored<a id="id509" class="indexterm"/> both waterfall and funnel charts. Both<a id="id510" class="indexterm"/> types of chart have been used in sales data. In this section, we are going to join the previous waterfall and funnel examples together, so that when the client clicks on a horizontal bar (let's say <strong>Product B sales</strong>), the waterfall chart is zoomed into the funnel chart to show the prospect ratio of the product. To achieve that, we use the drilldown feature (described and demonstrated in <a class="link" href="ch02.html" title="Chapter 2. Highcharts Configurations">Chapter 2</a>, <em>Highcharts Configurations</em>).</p><p>First, we set the data point with a drilldown identifier, like <code class="literal">productB</code>. Then, we import the whole funnel series configuration from the previous example into the drilldown option with the matching <code class="literal">id</code> value. Finally, we relocate the drill up back button to the bottom of the screen. The final change should be as follows:</p><div><pre class="programlisting">             series: [{
                type: 'waterfall',
                ....
                data: [{
                    ....
                }, {
                    name: 'Product B Sales',
                    y: 33800,
                    drilldown: 'productB',
                    ....
               }]
             }],
             drilldown: {
                drillUpButton: {
                    position: {
                        verticalAlign: 'bottom',
                        align: 'center',
                        y: -20
                    }
                },
                series: [{
                    type: 'funnel',
                    id: 'productB',</pre></div><p>Now, we <a id="id511" class="indexterm"/>have a fully interactive chart, from a <a id="id512" class="indexterm"/>revenue breakdown waterfall chart to the product prospect funnel chart. The following is the waterfall chart with the drilldown:</p><div><img src="img/7451OS_08_05.jpg" alt="Joining both waterfall and funnel charts"/></div><p>Clicking on the <strong>product B sales</strong> column, the chart transforms to a funnel to dissect the sales from product activities:</p><div><img src="img/7451OS_08_04.jpg" alt="Joining both waterfall and funnel charts"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec56"/>Plotting a commercial pyramid chart</h1></div></div></div><p>A pyramid chart is the<a id="id513" class="indexterm"/> inverse of a funnel chart, but in a pyramid shape, generally used for representing a top-down hierarchical ordering of data. Since this is a part of the funnel chart module, <code class="literal">funnel.js</code> is required.</p><p>The default order for data entries is that the last entry in the series data array is shown at the top of the pyramid. This can be corrected by switching the <code class="literal">reverse</code> option to false. Let's take a real-life example for this exercise. The following is a picture of the Global Wealth Pyramid chart taken from the Credit Suisse Global Wealth Databook 2013:</p><div><img src="img/7451OS_08_06.jpg" alt="Plotting a commercial pyramid chart"/></div><p>As we can see, it looks stylish<a id="id514" class="indexterm"/> with data labels along each side as well as in the middle. Let's make an initial attempt to reproduce the chart:</p><div><pre class="programlisting">        title: {
            text: "The global wealth pyramid",
            align: 'left',
            x: 0,
            style: {
                fontSize: '13px',
                fontWeight: 'bold'
            }
        },
        credits: {
            text: 'Source: James Davies, ....',
            position: {
                align: 'left',
                verticalAlign: 'top',
                y: 40,
                x: 10
            },
            style: {
                fontSize: '9px'
            }
        },
        series: [{
            type: 'pyramid',
            width: '70%',
            reversed: true,
                dataLabels: {
                    enabled: true,
                    format: '&lt;b&gt;{point.name}&lt;/b&gt; ({point.y:,.1f}%)',
                },
            data: [{
                name: '3,207 m',
                y: 68.7,
                color: 'rgb(159, 192, 190)'
            }, {
                name: '1,066 m',
                y: 22.9,
                color: 'rgb(140, 161, 191)'
            }, {
                name: '361 m',
                y: 7.7,
                color: 'rgb(159, 165, 157)'
            }, {
                name: '32 m',
                y: 0.7,
                color: 'rgb(24, 52, 101)'
            }]
        }]</pre></div><p>First, we move the title and credits to the top-left corner. Then, we copy the color and percentage values into the series, which gives us the following chart:</p><div><img src="img/7451OS_08_07.jpg" alt="Plotting a commercial pyramid chart"/></div><p>There are two main <a id="id515" class="indexterm"/>problems when compared to the original: the scale of each layer is wrong and the data labels are either missing or in the wrong place. As we can see, the reality is that the rich population is actually much smaller than the original chart showed, amusingly a single pixel. In the next section, we are going to see how far we can push Highcharts to make the financial chart.</p><div><div><div><div><h2 class="title"><a id="ch08lvl2sec60"/>Plotting an advanced pyramid chart</h2></div></div></div><p>Let face it. The layers in the <a id="id516" class="indexterm"/>original chart do not reflect their true percentage, proved in the previous chart. So we need to rig the ratio values to make them similar to the original chart. Secondly, the repositioning of data labels is limited in a pyramid chart. The only way to move the data label into the center of each layer of a pyramid chart is to disable the connectors and gradually adjust the <code class="literal">distance</code> option in <code class="literal">plotOptions.pyramid.dataLabels</code>. However, this only allows us a single label per data layer and we can only apply the same positional settings to all the labels.</p><p>So how can we put extra data labels <a id="id517" class="indexterm"/>along each side of the layer and the titles along the bottom of the pyramid? The answer (after hours of trial and error) is to use multiple y axes and <code class="literal">plotLines</code>. The idea is to have three y axes to put data labels on the left, center, and right side of the pyramid. Then, we hide all the y axes' interval lines and their labels. We place the y axis title at the bottom of the axis line with no rotation, we only rotate for the left (<strong>Wealth</strong>) and right (<strong>Total Wealth</strong>) axes.</p><p>We disable the remaining y axis title. The trick is to use the x axis title instead for the center label (<strong>Number of adults</strong>), because it sits on top of the pyramid. Here is the code snippet for the configuration of these axes:</p><div><pre class="programlisting">        chart: {
            renderTo: 'container',
            // Force axes to show the title
            showAxes: true,
            ....
        },
        xAxis: {
            title: {
                text: "Number of adults (percentage of world population)"
            },
            // Only want the title, not the line
            lineWidth: 0
        },
        yAxis: [{
            // Left Y-axis
            title: {
                align: 'low',
                text: 'Wealth',
                rotation: 0,
                x: 30
            },
            // Don't show the numbers
            labels: {
                enabled: false
            },
            gridLineWidth: 0,
            min: 0,
            max: 100,
            reversed: true,
            ....
        }, {
            // Center Y-axis
            title: {
                text: ''
            },
            // Same setting to hide the labels and lines
            ....
        }, {
            // Right Y-axis
            opposite: true,
            title: {
                align: 'low',
                text: 'Total Wealth &lt;br&gt;(percent of world)',
                rotation: 0,
                x: -70
           },
            // Same setting to hide the labels and lines
            ....</pre></div><p>The following screenshot demonstrates the titles aligned at the base of pyramid chart:</p><div><img src="img/7451OS_08_08.jpg" alt="Plotting an advanced pyramid chart"/></div><p>The next part is to<a id="id518" class="indexterm"/> simply create a <code class="literal">plotLine</code> for each y-axis in each layer of the pyramid and set the label for these <code class="literal">plotLines</code>. Since we know the data value range of each pyramid layer, we can set the same <code class="literal">y</code> value for <code class="literal">plotLines</code> across all the y axes to display the labels on the same level. Here is an example of a <code class="literal">plotLines</code> option for the left y-axis:</p><div><pre class="programlisting">            plotLines: [{
                value: 40,
                label: {
                    text: '&lt; USD 10,000',
                    x: 20
                },
                width: 1, 
            }, {
                value: 30,
                label: {
                    text: 'USD 10,000 - 100,000',
                    x: 35
                },
                width: 1
            }, {</pre></div><p>We do the same for the center<a id="id519" class="indexterm"/> labels instead of using the points' data labels. Note that the x position here caters for the data in this chart. If the graph has dynamic data, a new x position must be calculated to fit the new data. Here is the final look in Highcharts:</p><div><img src="img/7451OS_08_09.jpg" alt="Plotting an advanced pyramid chart"/></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec57"/>Exploring a heatmap chart with inflation data</h1></div></div></div><p>Heatmap is the latest <a id="id520" class="indexterm"/>chart addition in Highcharts 4. As its <a id="id521" class="indexterm"/>name implies, the data values are represented in temperature colors, where the data is arranged in a grid-based layout, so the chart expresses three-dimensional data. The heatmap appeals to some readers because of the instant awareness of the data trend it generates, as temperature is one of the most natural things to sense. The chart is generally used for demonstrating climate data, but it has been used for other purposes. Let's explore the heatmap chart with some real-life data. Here, we use it to show the inflation of various countries, as in this example in the<a id="id522" class="indexterm"/> Wall Street Journal (<a class="ulink" href="http://blogs.wsj.com/economics/2011/01/27/feeling-the-heat-comparing-global-inflation/">http://blogs.wsj.com/economics/2011/01/27/feeling-the-heat-comparing-global-inflation/</a>):</p><div><img src="img/7451OS_08_10.jpg" alt="Exploring a heatmap chart with inflation data"/></div><p>In Highcharts, the heatmap module was released as part of the Highmaps extension, which can be used as part of Highmaps or as a module of Highcharts. In order to load a heatmap as a Highcharts module, it includes the following library:</p><div><pre class="programlisting">&lt;script src="img/heatmap.js"&gt;&lt;/script&gt;</pre></div><p>First, the months are<a id="id523" class="indexterm"/> sketched along the y axis, whereas the x axis holds the country names. So we need to invert the chart:</p><div><pre class="programlisting">        chart: {
            renderTo: 'container',
            type: 'heatmap',
            inverted: true
        },</pre></div><p>The next step is to set <a id="id524" class="indexterm"/>both x and y axes as categories with specific labels. Then, we set the x axis without interval lines. As for the y axis, we position the labels at the top of the cells by assigning the opposite option to true and including an offset distance to make sure the axis lines are not too close:</p><div><pre class="programlisting">  xAxis: {
      tickWidth: 0,
      // Only show a subset of countries
      categories: [ 
          'United States', 'Japan', 'United Kingdom', 
          'Venezuela', 'Singapore', 'Switzerland', 'China' 
      ]
  },
  yAxis: {
      title: { text: null },
      opposite: true,
      offset: 8,
      categories: [ 'Aug 2010', 'Sept', 'Oct', 'Nov', 'Dec', ...</pre></div><p>There is one more axis that we need to <a id="id525" class="indexterm"/>configure, <code class="literal">colorAxis</code> (see <a class="ulink" href="http://api.highcharts.com/highmaps">http://api.highcharts.com/highmaps</a>), which is specific to heatmap charts and Highmaps. The <code class="literal">colorAxis</code> option is similar to <code class="literal">x/yAxis</code>, which shares a number of options with it. The major difference is that <code class="literal">colorAxis</code> is the definition in mapping between the color and value. There are two ways to define color mapping: discrete and linear color range.</p><p>In this example, we<a id="id526" class="indexterm"/> demonstrate how to define multiple <a id="id527" class="indexterm"/>linear color ranges. As we can see, the inflation example has an asymmetric color scale, so that it ranges from -6.6 percent to 36 percent, but notice that the color between -0.1 percent and 0.1 percent is gray. In order to imitate the color scale closely, we use the <code class="literal">stops</code> option to define fragments of discrete spectrums. The <code class="literal">stops</code> option takes an array of tuples of ratio range and color, and we transform the inflation and color values from the example into a number of ratios (we take the range from -1 percent to 30 percent instead because of the subset samples):</p><div><pre class="programlisting">          colorAxis: {
                min: -0.9,
                max: 30,
                stops: [
                    [0, '#1E579F'],
                    // -6.6
                    [0.085, '#467CBA'],
                    // -6
                    [0.1, '#487EBB'],
                    // -2
                    [0.2, '#618EC4'],
                    // -1
                    [0.225, '#7199CA'],
                    // -0.2
                    [0.245, '#9CB4D9'],
                    // Around 0
                    [0.25, '#C1C1C1'],
                    // Around 0.2
                    [0.256, '#ECACA8'],
                    // Around 10
                    [0.5, '#D02335'],
                    // Around 20
                    [0.75, '#972531'],
                    [1.0, '#93212E']
                ],
                labels: {
                    enabled: true
                }
          }</pre></div><p>Additionally, we replicate the title (top-left), color scale legend (top-right), and credits (bottom-right) as in the original chart, with the following configurations:</p><div><pre class="programlisting">    title: {
        text: "Feeling the Heat: Global Inflation",
        align: 'left',
        style: {
            fontSize: '14px'
        }
    },
    subtitle: {
        text: "From Aug 2010 - Aug 2011",
        align: 'left',
        style: {
            fontSize: '12px'
        }
    },
    legend: {
        align: 'right',
        verticalAlign: 'top',
        floating: true,
        x: -60,
        y: -5
    },
    credits: {
        text: 'Sources: CEIC Data; national statistical ....',
        position: {
            y: -30
        }
    },  </pre></div><p>The final step is to define<a id="id528" class="indexterm"/> the three-dimensional data and switch <a id="id529" class="indexterm"/>the <code class="literal">dataLabels</code> option on:</p><div><pre class="programlisting">        series: [{
            dataLabels: {
                enabled: true,
                color: 'white'
            },
            // Country Category Index, Month/Year Index, Inflation
            data: [ 
                // US
                [ 0, 0, 1.1 ],
                [ 0, 1, 1.1 ],
                ....,
                // Japan
                [ 1, 0, -0.9 ],
                [ 1, 1, -0.6 ],</pre></div><p>Here is the display:</p><div><img src="img/7451OS_08_11.jpg" alt="Exploring a heatmap chart with inflation data"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec58"/>Experimenting with dataClasses and nullColor options in a heatmap</h1></div></div></div><p>An alternative<a id="id530" class="indexterm"/> way to <a id="id531" class="indexterm"/>define the color axis is to<a id="id532" class="indexterm"/> have a specific range of values <a id="id533" class="indexterm"/>associated with a color. Let's plot another heatmap chart. In this example, we reconstruct a <a id="id534" class="indexterm"/>graph taken from <a class="ulink" href="http://kindofnormal.com/truthfacts">http://kindofnormal.com/truthfacts</a>, shown here:</p><div><img src="img/7451OS_08_12.jpg" alt="Experimenting with dataClasses and nullColor options in a heatmap"/></div><p>To recreate the <a id="id535" class="indexterm"/>preceding chart, we first use an inverted heatmap to emulate it as a <a id="id536" class="indexterm"/>bar chart, but the bars itself are composed of cells with a<a id="id537" class="indexterm"/> gradual change of color. We treat each block as a unit of y axis value <a id="id538" class="indexterm"/>and every two intervals associates with a color value. Hence, the range along the y-axis is between 0 and 8. Here is the trimmed configuration:</p><div><pre class="programlisting">     yAxis: {
         title: { text: null },
         gridLineWidth: 0,
         minorTickWidth: 1,
         max: 8,
         min: 0,
         offset: 8,
         labels: {
             style: { .... },
             formatter: ....,</pre></div><p>Then, we specify the <code class="literal">colorAxis</code> with <code class="literal">dataClasses</code> options which divide the value range into four groups of color:</p><div><pre class="programlisting">     colorAxis: {
         dataClasses: [{
             color: '#2D5C18',
             from: 0,
             to: 2
         }, {
             color: '#3B761D',
             from: 2,
             to: 4
         }, {
             color: '#70AD28',
             from: 4,
             to: 6
         }, {
             color: '#81C02E',
             from: 6,
             to: 8
         }]
     },</pre></div><p>In order to make the bar appear as being composed of multiple blocks, we set the border width and the border color the same as the chart background color:</p><div><pre class="programlisting">   plotOptions: {
       heatmap: {
           nullColor: '#D2E4B4',
           borderWidth: 1,
           borderColor: '#D2E4B4',
       },
   },</pre></div><p>Notice that there is <a id="id539" class="indexterm"/>a <code class="literal">nullColor</code> option; this is to set the color for a data point with null <a id="id540" class="indexterm"/>value. We assign the null data point the same color as the<a id="id541" class="indexterm"/> background. We will see later what this null color can do in a <a id="id542" class="indexterm"/>heatmap.</p><p>In heatmaps, unlike column charts, we can specify the distance and grouping between columns. The only way to have a gap between categories is to fake it, hence a category with an empty title:</p><div><pre class="programlisting">     xAxis: {
            tickWidth: 0,
            categories: [ 'Food', '', 'Water', '', 'Sleep', 
                          '', 'Internet' ],
            lineWidth: 0,
            ....,
     },</pre></div><p>Since we are emulating a bar chart in which the change of color values correlate to y-axis values, the z-value is the same as the y-value. Here is the series data configuration for <strong>Food</strong> and <strong>Water</strong> categories:</p><div><pre class="programlisting">series: [{
    data: [  [ 0, 7, 7 ], [ 0, 6, 6 ], [ 0, 5, 5 ], [ 0, 4, 4 ],
             [ 0, 3, 3 ], [ 0, 2, 2 ], [ 0, 1, 1 ], [ 0, 0, 0 ],
             [ 2, 0, 0 ], [ 2, 1, 1 ], [ 2, 2, 2 ], [ 2, 3, 3 ],
             [ 2, 4, 4 ], [ 2, 5, 5 ],</pre></div><p>The first group of data points have zero values on the inverted x axis which is the index to the categories—<strong>Food</strong>. The group has a full range of eight data points. The next has a group of six data points (value two on the x axis because of the dummy category, see <code class="literal">xAxis.categories</code> in preceding code) which corresponds to six blocks in the <strong>Water</strong> category.</p><p>For the sake of <a id="id543" class="indexterm"/>demonstrating how <code class="literal">nullColor</code> works, instead of displaying a block<a id="id544" class="indexterm"/> of cells as in the original chart, let's change it slightly<a id="id545" class="indexterm"/> to have a fraction unit of cells. In the <strong>Sleep</strong> and <strong>Internet</strong> <a id="id546" class="indexterm"/>categories, we are going to change the values to 1.5 and 0.25 respectively. The trick to displaying a heatmap cell that is not in a full block is to use the <code class="literal">nullColor</code> option, that is, a fraction of the unit value is assigned to null and the color for the null value is the same as the chart background color to "hide" the rest of the unit:</p><div><pre class="programlisting">        [ 4, 0, 0 ],
        [ 4, 1, 1 ],
        [ 4, 1.5, null ],

        [ 6, 0, 0 ],
        [ 6, 0.25, null ]</pre></div><p>Here is a screenshot of the reproduction in Highcharts:</p><div><img src="img/7451OS_08_13.jpg" alt="Experimenting with dataClasses and nullColor options in a heatmap"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec59"/>Summary</h1></div></div></div><p>In this chapter, we have learned how to plot waterfall and funnel charts with fabricated sales data. We familiarized ourselves with and tested the flexibilities of Highcharts by reconstructing a pyramid chart from a financial report. We examined the construction of a heatmap chart and studied the color axis property with different examples.</p><p>In the next chapter, we will investigate that long-awaited Highcharts feature, 3D charts. We will explore how to apply 3D orientation on charts and plot a gallery of various series charts in 3D.</p></div></body></html>