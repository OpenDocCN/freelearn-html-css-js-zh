["```js\nUSE `sakila` ;\n\nCREATE  TABLE IF NOT EXISTS `sakila`.`menu` (\n  `id` INT NOT NULL AUTO_INCREMENT ,\n  `text` VARCHAR(45) NOT NULL ,\n  `iconCls` VARCHAR(15) NULL ,\n  `className` VARCHAR(45) NULL ,\n  `menu_id` INT NULL ,\n  PRIMARY KEY (`id`) ,\n  INDEX `fk_menu_menu1_idx` (`menu_id` ASC) ,\n  CONSTRAINT `fk_menu_menu1`\n  FOREIGN KEY (`menu_id` )\n  REFERENCES `sakila`.`menu` (`id` )\n    ON DELETE NO ACTION\n    ON UPDATE NO ACTION)\n  ENGINE = InnoDB;\n\nCREATE  TABLE IF NOT EXISTS `sakila`.`permissions` (\n  `menu_id` INT NOT NULL ,\n  `groups_id` INT NOT NULL ,\n  PRIMARY KEY (`menu_id`, `groups_id`) ,\n  INDEX `fk_permissions_groups1_idx` (`groups_id` ASC) ,\n  CONSTRAINT `fk_permissions_menu1`\n  FOREIGN KEY (`menu_id` )\n  REFERENCES `sakila`.`menu` (`id` )\n    ON DELETE NO ACTION\n    ON UPDATE NO ACTION,\n  CONSTRAINT `fk_permissions_groups1`\n  FOREIGN KEY (`groups_id` )\n  REFERENCES `sakila`.`groups` (`id` )\n    ON DELETE NO ACTION\n    ON UPDATE NO ACTION)\n  ENGINE = InnoDB;\n});\n```", "```js\nINSERT INTO `menu` (`id`,`text`,`iconCls`,`className`,`menu_id`) \nVALUES \n(1,'menu1','fa fa-group fa-lg',NULL,NULL),\n(2,'menu11','xf0c0','panel',1),\n(3,'menu12','xf007','panel',1),\n(4,'staticData','fa fa-database fa-lg',NULL,NULL),\n(5,'actors','xf005','panel',4),\n(6,'categories','xf013','panel',4),\n(7,'languages','xf1ab','panel',4),\n(8,'cities','xf018','panel',4),\n(9,'countries','xf0ac','panel',4),\n(10,'cms','fa fa-film fa-lg',NULL,NULL),\n(11,'films','xf1c8','panel',10),\n(12,'reports','fa fa-line-chart fa-lg',NULL,NULL),\n(13,'salesfilmcategory','xf200','panel',12);\n\nINSERT INTO `permissions` (`menu_id`,`groups_id`) VALUES \n(1,1), (2,1), (3,1), (4,1), (5,1), (6,1), (7,1),\n(8,1), (9,1), (10,1), (11,1), (12,1), (13,1);\n```", "```js\nExt.define('Packt.model.menu.Accordion', {\n    extend: 'Ext.data.Model',\n\n    fields: [ //#1\n        { name: 'id', type: 'int'}, //#2\n        { name: 'text' },\n        { name: 'iconCls' }\n    ]\n});\n```", "```js\nExt.define('Packt.model.menu.TreeNode', {\n    extend: 'Ext.data.Model',\n\n    fields: [\n        { name: 'id', type: 'int'},\n        { name: 'text' },\n        { name: 'iconCls' },\n        { name: 'className' },\n        { name: 'parent_id', mapping: 'menu_id'} //#1\n    ]\n});\n```", "```js\nhasMany: {\n    model: 'Packt.model.menu.TreeNode',\n    foreignKey: 'parent_id',\n    name: 'items' //#1\n}\n```", "```js\nrequires: [\n    'Packt.model.menu.TreeNode'\n],\n```", "```js\nExt.define('Packt.store.Menu', {\n    extend: 'Ext.data.Store',\n\n    requires: [\n        'Packt.util.Util' //#1\n    ],\n\n    model: 'Packt.model.menu.Accordion', //#2\n\n    proxy: {\n        type: 'ajax',             //#3\n        url: 'php/menu/list.php', //#4\n\n        reader: { //#5\n            type: 'json',\n            rootProperty: 'data'\n        },\n        listeners: {\n            exception: function(proxy, response, operation){ //#6\n              Packt.util.Util.showErrorMsg(response.responseText);\n            }\n        }\n    }\n});\n```", "```js\n{\n  \"data\":[\n    {\n      \"id\":\"1\",\n      \"text\":\"menu1\",\n      \"iconCls\":\"fa fa-group fa-lg\",\n      \"items\":[\n        {\n          \"id\":\"2\",\n          \"text\":\"menu11\",\n          \"iconCls\":\"xf0c0\",\n          \"className\":\"panel\",\n          \"menu_id\":\"1\",\n          \"leaf\":true\n        },\n        {\n          \"id\":\"3\",\n          \"text\":\"menu12\",\n          \"iconCls\":\"xf007\",\n          \"className\":\"panel\",\n          \"menu_id\":\"1\",\n          \"leaf\":true\n        }\n      ]\n    }\n  ]\n}\n```", "```js\n<?php\nrequire('menuFunctions.php'); // #1\n\nsession_start(); // #2\n\n$userName = $_SESSION['username']; // #3\n\n$permissions = retrievePermissions($userName); // #4\n$modules = retrieveModules($permissions);      // #5\n$result = retrieveMenuOptions($modules, $permissions); // #6\n\necho json_encode(array( // #7\n    \"data\" => $result\n));\n```", "```js\nfunction retrievePermissions($userName){\n\n    require('../db/db.php'); // #8\n\n    $sqlQuery = \"SELECT p.menu_id menuId FROM User u \"; // #9\n    $sqlQuery .= \"INNER JOIN permissions p ON u.groups_id = p.groups_id \";\n    $sqlQuery .= \"INNER JOIN menu m ON p.menu_id = m.id \";\n    $sqlQuery .= \"WHERE u.username = '$userName' \";\n\n    $permissions = [];\n\n    if ($resultDb = $mysqli->query($sqlQuery)) { // #10\n        while($user = $resultDb->fetch_assoc()) { // #11\n            $permissions[] =  $user['menuId'];\n        }\n    }\n\n    $resultDb->free(); // #12\n    $mysqli->close();  // #13\n\n    return $permissions; // #14\n}\n```", "```js\nfunction retrieveModules($permissions){\n\n    require('../db/db.php');\n\n    $inClause = '(' . join(',',$permissions) . ')'; // #15\n\n    $sqlQuery = \"SELECT id, text, iconCls FROM menu WHERE menu_id IS NULL AND id in $inClause\"; // #16\n\n    $modules = [];\n\n    if ($resultDb = $mysqli->query($sqlQuery)) { // #17\n        while($module = $resultDb->fetch_assoc()) {\n            $modules[] = $module;\n\n        }\n    }\n\n    $resultDb->free();\n    $mysqli->close();\n\n    return $modules; // #18\n}\n```", "```js\nfunction retrieveMenuOptions($modules, $permissions){\n\n    require('../db/db.php');\n\n    $inClause = '(' . join(',',$permissions) . ')'; // #1\n\n    $result = [];\n\n    foreach ($modules as $module) { // #2\n\n        $sqlQuery = \"SELECT * FROM menu WHERE menu_id = '\"; // #3\n        $sqlQuery .= $module['id'] .\"' AND id in $inClause\";\n\n        if ($resultDb = $mysqli->query($sqlQuery)) { // #4\n\n            $count = $resultDb->num_rows; // #5\n            if ($count > 0){ // #6\n                $module['items'] = array(); // #7\n                while ($item = $resultDb->fetch_assoc()) {\n                    $module['items'][] = $item; // #8\n                }\n            }\n            $result[] = $module; // #9\n        }\n    }\n    $resultDb->close();\n    $mysqli->close();\n\n    return $result; // #10\n}\n```", "```js\nExt.define('Packt.view.menu.Accordion', {\n    extend: 'Ext.panel.Panel',\n    xtype: 'mainmenu', // #1\n\n    width: 250, // #2\n    layout: {\n        type: 'accordion', // #3\n        multi: true        // #4\n    },\n    collapsible: true, // #3\n    split: true,       // #4\n    iconCls: 'fa fa-sitemap fa-lg', // #5\n    title: translations.menu  // #6\n});\n```", "```js\nmenu: 'menu',\n```", "```js\nExt.define('Packt.view.menu.Tree', {\n    extend: 'Ext.tree.Panel',\n    xtype: 'menutree',\n\n    border: 0,\n    autoScroll: true,\n    rootVisible: false\n});\n```", "```js\n{\n xtype: 'mainmenu',\n    region: 'west'\n}\n```", "```js\nExt.define('Packt.controller.Menu', {\n    extend: 'Ext.app.Controller',\n\n    init: function(application) {\n\n     this.control({ // #1\n            \"menutree\": { // #2\n                itemclick: this.onTreePanelItemClick // #3\n            },\n            \"mainmenu\": {\n                render: this.renderDynamicMenu // #4\n            }\n        });\n    }\n});\n```", "```js\n\"{selector}\": {\n    event1: this.methodToBeExecuted1,\n    event2: this.methodToBeExecuted2\n}\n```", "```js\nrenderDynamicMenu: function(view, options) {\n  console.log('menu rendered');\n}\n```", "```js\nonTreePanelItemClick: function(view, record, item, index, event, options){ },\n```", "```js\ncontrollers: [\n    'Root',\n 'Menu'\n],\n```", "```js\nvar dynamicMenus = [];  //#1\n\nview.body.mask('Loading Menus... Please wait...');  //#2\n\nthis.getMenuStore().load(function(records, op, success){ //#3\n\n    Ext.each(records, function(root){ //#4\n\n        var menu = Ext.create('Packt.view.menu.Tree',{ //#5\n            title: translations[root.get('text')],     //#6\n            iconCls: root.get('iconCls')               //#7\n        });\n\n        var treeNodeStore = root.items(),     //#8\n            nodes = [],\n   item;\n\n        for (var i=0; i<treeNodeStore.getCount(); i++){ //#9\n            item = treeNodeStore.getAt(i);              //#10\n\n            nodes.push({                      //#11\n                text: translations[item.get('text')],\n                leaf: true,                   //#12\n                glyph: item.get('iconCls'),   //#13\n                id: item.get('id'),\n                className: item.get('className')\n            });\n        }\n       menu.getRootNode().appendChild(nodes); //#14\n        dynamicMenus.push(menu); //#15\n    });\n    view.add(dynamicMenus); //#16\n    view.body.unmask();     //#17\n});\n```", "```js\nstores: [\n    'Menu'\n],\n```", "```js\niconCls: 'fa fa-key fa-lg'\n```", "```js\nglyph:'xf084@FontAwesome'\n```", "```js\nglyph:'xf084'\n```", "```js\nglyphFontFamily: 'FontAwesome'\n```", "```js\nrequires: [\n    'Packt.overrides.tree.ColumnOverride'\n],\n```", "```js\nmenu1 : 'Security',\nmenu11 : 'Groups and Permissions',\nmenu12 : 'Users',\nstaticData: 'Static Data',\nactors: 'Actors',\ncategories: 'Categories',\nlanguages: 'Languages',\ncities: 'Cities',\ncountries: 'Countries',\ncms: 'Content Management',\nfilms: 'Films',\nreports: 'Reports',\nsalesfilmcategory: 'Sales by Film Category'\n```", "```js\nonTreePanelItemClick: function(view, record, item, index, event, options){\n    var mainPanel = this.getMainPanel(); // #1\n\n    var newTab = mainPanel.items.findBy( // #2\n        function (tab){ \n           return tab.title === record.get('text'); // #3\n    });\n\n    if (!newTab){ // #4\n        newTab = mainPanel.add({            // #5\n            xtype: record.get('className'), // #6\n            closable: true,                 // #7\n            glyph: record.get('glyph'),     // #8\n            title: record.get('text')       // #9\n        });\n    }\n    mainPanel.setActiveTab(newTab); // #10\n}\n```", "```js\nrefs: [\n    {\n        ref: 'mainPanel',\n        selector: 'mainpanel'\n    }\n],\n```"]