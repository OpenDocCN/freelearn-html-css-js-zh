<html><head></head><body><div class="chapter" title="Chapter&#xA0;7.&#xA0;Defining Actions on Objects"><div class="titlepage"><div><div><h1 class="title"><a id="ch07"/>Chapter 7. Defining Actions on Objects</h1></div></div></div><p>Let's go further with the gameplay in Babylon.js. The framework provides an <code class="literal">ActionManager</code> class that allows us to manage and execute actions when a trigger is raised by the engine.</p><p>For example, imagine a scene with a button. When the button is pushed (left-click), the light(s) in the scene should be turned off, except one. This is only an example. In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Defining actions on objects</li><li class="listitem" style="list-style-type: disc">Using conditions to control the actions graph</li><li class="listitem" style="list-style-type: disc">Using the Actions Builder in 3ds Max</li></ul></div><div class="section" title="Defining actions on objects"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec29"/>Defining actions on objects</h1></div></div></div><p>The Babylon.js framework comes with a collection of distinct actions. You'll find actions that can play a sound, stop a sound, interpolate a property of an object, set a value of an object property, and so on.</p><div class="section" title="Enable actions on an object"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec52"/>Enable actions on an object</h2></div></div></div><p>The only entities that can handle <code class="literal">ActionManager</code> are the scene and the meshes in the scene. Each Babylon.js mesh has its own action manager reference. To enable actions on a mesh, just create a new reference to the mesh, as follows:</p><pre class="programlisting">myMesh.actionManager = new BABYLON.ActionManager(scene);</pre><p>The <code class="literal">ActionManager</code> constructor takes only the scene as a parameter.</p><p>Let's create your first action in a scene composed of a box and a plane. The action must change the box's position on the <span class="emphasis"><em>y</em></span> axis from <code class="literal">0</code> to <code class="literal">6</code> when the user left-clicks on the box. The only thing to do is to call the <code class="literal">.registerAction</code> function on <code class="literal">ActionManager</code> of the box, as shown in the following:</p><pre class="programlisting">myMesh.actionManager = new BABYLON.ActionManager(scene);&#13;
myMesh.actionManager.registerAction(new BABYLON.SetValueAction(&#13;
  // The trigger type&#13;
  BABYLON.ActionManager.OnLeftPickTrigger,&#13;
  // The target&#13;
  myMesh,&#13;
  // Property to modify&#13;
  "position.y",&#13;
  // The new value&#13;
  6,&#13;
  // The condition&#13;
  null&#13;));</pre><p>For a moment, let's consider the condition as <code class="literal">null</code> and explain it in the next topic.</p><p>If we look more closely, an action is triggered by a trigger (here, <code class="literal">BABYLON.ActionManager.OnLeftPickTrigger</code>). There are several types of triggers available only for the meshes, as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">OnPickTrigger</code>: When the object is picked (click).</li><li class="listitem" style="list-style-type: disc"><code class="literal">OnLeftPickTrigger</code>: When the object is picked (left-click only).</li><li class="listitem" style="list-style-type: disc"><code class="literal">OnRightPickTrigger</code>: When the object is picked (right-click only).</li><li class="listitem" style="list-style-type: disc"><code class="literal">OnCenterPickTrigger</code>: When the object is picked (mouse wheel click only).</li><li class="listitem" style="list-style-type: disc"><code class="literal">OnPointerOverTrigger</code>: When the pointer is over the object (entering).</li><li class="listitem" style="list-style-type: disc"><code class="literal">OnPointerOutTrigger</code>: When the pointer is out of the object (exiting).</li><li class="listitem" style="list-style-type: disc"><code class="literal">OnIntersectionEnterTrigger</code>: When the object intersects another object.</li><li class="listitem" style="list-style-type: disc"><code class="literal">OnIntersectionExitTrigger</code>: When the object finishes intersecting another object.</li><li class="listitem" style="list-style-type: disc"><code class="literal">NothingTrigger</code>: Only used for chained actions. Let's see the next sub-topic.</li></ul></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note11"/>Note</h3><p>
<span class="strong"><strong>Note</strong></span>: all picking triggers require that meshes are pickable: <code class="literal">myMesh.isPickable = true;</code>
</p></div></div><p>Also, there are several types of triggers available only on scenes. Indeed, scenes can have <code class="literal">ActionManager</code> as well, as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">OnEveryFrameTrigger</code>: This raises the associated actions in every frame rendered by Babylon.js</li><li class="listitem" style="list-style-type: disc"><code class="literal">OnKeyDownTrigger</code>: When the user presses a key (keyboard)</li><li class="listitem" style="list-style-type: disc"><code class="literal">OnKeyUpTrigger</code>: When the user finishes pressing a key (keyboard)</li></ul></div><p>As you can guess, some triggers need parameters. Triggers such as <code class="literal">OnIntersectionEnterTrigger</code>, <code class="literal">OnIntersectionExitTrigger</code>, <code class="literal">OnKeyDownTrigger</code> and <code class="literal">OnKeyUpTrigger</code>. To configure a trigger that needs parameters, just provide a JavaScript object that will contain the trigger type and the parameter, instead of the giving directly the trigger type as argument in the action's constructor. Consider the previous example with <code class="literal">OnIntersectionEnterTrigger</code> in the following:</p><pre class="programlisting">myMesh.actionManager.registerAction(new BABYLON.SetValueAction(&#13;
  // The trigger, the structure is the same for&#13;
  // OnIntersectionExitTrigger&#13;
  {&#13;
    trigger: BABYLON.ActionManager.OnIntersectionEnterTrigger,&#13;
    parameter: myOtherMeshReference&#13;
  },// The target&#13;
  myMesh,&#13;
  // Property to modify&#13;
  "position.y",&#13;
  // The new value&#13;
  6,&#13;
  // The condition&#13;
  null&#13;));</pre><p>For the <code class="literal">OnKeyDownTrigger</code> and <code class="literal">OnKeyUpTrigger</code>, the structure is the same and the parameter is the key. Consider the following for example:</p><pre class="programlisting">myMesh.actionManager.registerAction(new BABYLON.SetValueAction(&#13;
  // The trigger, the structure is the same for&#13;
  // OnKeyUpTrigger&#13;
  {&#13;
    trigger: BABYLON.ActionManager.OnKeyDownTrigger,&#13;
    parameter: "d" // When the user pushes the key "d"&#13;
  },&#13;
  // The target&#13;
  myMesh,&#13;
  // Property to modify&#13;
  "position.y",&#13;
  // The new value&#13;
  6,&#13;
  // The condition&#13;
  null&#13;));</pre><p>Let's look more closely at the following parameters of an action:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The trigger</strong></span>: This determines when the action is triggered by the action manager. You can see the trigger as an event type.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The target</strong></span>: This represents the object (not necessarily a mesh or a scene in all the cases; however, a JavaScript object in general) that will be modified by the action.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The property to modify</strong></span>: This represents the property of the target that will be modified by the action.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The new value</strong></span>: This represents the new value affected to the property of the target. This can be a number, string, object, and so on.</li></ul></div><p>Almost all the available actions work with these parameters.</p></div><div class="section" title="Chain actions on an object"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec53"/>Chain actions on an object</h2></div></div></div><p>The <code class="literal">ActionManager</code> class of Babylon.js allows you to construct a graph of actions. All the registered actions will be checked (to verify the trigger) and executed (if the check concludes) at same time and repeatedly. However, imagine the following as your scenario:</p><p>When the user left-clicks on the box, the new position on the <span class="emphasis"><em>y</em></span> axis is <code class="literal">0</code> and when the user left-clicks once again on the box, the new rotation on the <span class="emphasis"><em>y</em></span> axis is <code class="literal">PI / 4</code>.</p><p>The second action (left-click again) must be executed only when the first action is executed. To perform this action, you can call the <code class="literal">.then</code> function in an action. Consider the following as an example:</p><pre class="programlisting">myMesh.actionManager.registerAction(new BABYLON.SetValueAction(&#13;
  BABYLON.ActionManager.OnLeftPickTrigger,&#13;
  myMesh,&#13;
  "position.y",&#13;
  6,&#13;
  null&#13;
  )&#13;
  // Will be executed on the second left-click&#13;
  .then(new BAYBLON.SetValueAction(&#13;
  BABYLON.ActionManager.NothingTrigger,&#13;
  myMesh,&#13;
  "rotation.y",&#13;
  Math.PI / 4,&#13;
  null&#13;));</pre><p>This method is available for all actions.</p></div><div class="section" title="The available actions"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec54"/>The available actions</h2></div></div></div><p>Now, let's enumerate all the available actions, as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.SwitchBooleanAction</code>: This switches a Boolean property (false to true, or true to false). Consider the following, for example:</li></ul></div><pre class="programlisting">      new BABYLON.SwitchBooleanAction(trigger, target, &#13;
        propertyToModify (boolean), condition);</pre><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.SetValueAction</code>: This sets a new value to the property, similar to the preceding examples.</li><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.IncrementValueAction</code>: This increments the value of a property (only available with number values) by the specified value. Consider the following for example:<p>
</p><pre class="programlisting">       new BABYLON.IncrementValueAction(trigger, target, &#13;
         propertyToModify (number), valueToIncrement)</pre></li><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.PlayAnimationAction</code>: This plays an animation available in the object, such as a character or button must be <code class="literal">BABYLON.Node</code>. <a class="link" href="ch09.html" title="Chapter 9. Create and Play Animations">Chapter 9</a>, <span class="emphasis"><em>Create and Play Animations</em></span> for how to set up and play with animations. Consider the following, for example:<pre class="programlisting">        new BABYLON.PlayAnimationAction(trigger, target, startFram&#13;
          e, endFrame, loop);</pre><p>Animations work with frames, from 0 to 200, for example. The action specifies the start frame and end frame (25 to 35, for example). The loop parameter is a Boolean that specifies if the played animation is looped.</p></li><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.StopAnimationAction</code>: This stops the animation of the target object. Consider the following example:</li></ul></div><pre class="programlisting">        new BABYLON.StopAnimationAction(trigger, target);</pre><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.DoNothingAction:</code> This does nothing. It is used to control the graph and bypass a click, for example. Consider the following example:</li></ul></div><pre class="programlisting">        new BABYLON.DoNothingAction(trigger);</pre><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.ExecuteCodeAction</code>: This executes your own function. Consider the following example:</li></ul></div><pre class="programlisting">      new BABYLON.ExecuteCodeAction(trigger, (evt: ActionEvent) =&gt;      {&#13;
        console.log("executing action !");&#13;
        console.log(evt.source);&#13;
        console.log(evt.pointerX);&#13;
        console.log(evt.pointerY);&#13;
        console.log(evt.meshUnderPointer);&#13;
        console.log(evt.sourceEvent);&#13;
        console.log(evt.additionalData);&#13;
      });</pre><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.SetParentAction</code>: This sets a new parent for the target object. The target must be BABYLON.Node (mesh, light, camera, and so on). Consider the following example:</li></ul></div><pre class="programlisting">         new BABYLON.SetParentAction(trigger, target, &#13;
            theParentReference);</pre><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.PlaySoundAction</code>: This plays a sound. Just provide a <code class="literal">BABYLON.Sound</code> reference. Consider the following example:</li></ul></div><pre class="programlisting">      new BABYLON.PlaySoundAction(trigger, theSoundReference);</pre><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.StopSoundAction</code>: This stops a sound. Just provide the <code class="literal">BABYLON.Sound</code> reference. Consider the following example:</li></ul></div><pre class="programlisting">       new BABYLON.StopSoundAction(trigger, theSoundReference);</pre><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.InterpolateValueAction</code>: This interpolates a value (creates an animation) of the target object <code class="literal">BABYLON.Node</code>. Consider the following  example:<pre class="programlisting">       new BABYLON.InterpolateValueAction(trigger, target, &#13;
         propertyToInterpolate, finalValue, durationInMS);</pre><p>The property to interpolate must be of the <code class="literal">number</code>, <code class="literal">BABYLON.Color3</code>, <code class="literal">BABYLON.Vector3</code>, or <code class="literal">BABYLON.Quaternion</code> type.</p><p>For example, the property to interpolate can be <code class="literal">position</code> and the value <code class="literal">new BABYLON.Vector3(0, 6, 0)</code>.
</p></li><li class="listitem" style="list-style-type: disc"><code class="literal">BABYLON.CombineAction</code>: This is a special action. It allows simultaneous execution of multiple actions anywhere in the graph. Consider the following example:<pre class="programlisting">       new BABYLON.CombineAction(trigger, childrenActions);</pre><p>
<code class="literal">childrenActions</code> is an array of <code class="literal">BABYLON.Action</code>. It contains the simultaneously executed actions.</p></li></ul></div></div></div></div>
<div class="section" title="Using conditions to control the actions graphs"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec30"/>Using conditions to control the actions graphs</h1></div></div></div><p>In the previous sub-topic (the available actions), the conditions in actions were bypassed. In fact, every action can have a condition that controls whether the ActionManager executes the action or not. The conditions can check whether a value is one of the following states compared to another value:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Equal</li><li class="listitem" style="list-style-type: disc">Lesser</li><li class="listitem" style="list-style-type: disc">Greater</li><li class="listitem" style="list-style-type: disc">Different</li></ul></div><p>There are three types of condition, as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">
State condition: This checks whether the <code class="literal">.state</code> property of <code class="literal">BABYLON.Node</code> is equal to the given state. A state is a string.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Value condition</strong></span>: This checks whether a property is equal, lesser, greater, or different from a given value.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Predicate condition</strong></span>: This calls a custom method that will return <code class="literal">true</code> or <code class="literal">false</code>.</li></ul></div><p>If an action has a condition, the action will be executed only if the condition returns <code class="literal">true</code>.</p><p>Adding conditions to your actions graph shows all the power of the Actions Builder, which comes in the next topic. To understand the following example, before practicing with conditions, you can access this demo (<a class="ulink" href="http://www.babylonjs.com/Demos/ActionBuilder/">http://www.babylonjs.com/Demos/ActionBuilder/</a>) made by the artist Michel Rousseau, who used only actions and conditions to create the interactions in the scene.</p><p>The principle is that you must activate the three buttons in order to turn the main light off.</p><p>As a developer, the theory is as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">When the user clicks on a button (<code class="literal">OnLeftPickTrigger</code> for each button):
<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If the button is pressed (<code class="literal">StateCondition</code>), un-press the button and turn off the light (<code class="literal">SetValueAction</code>)</li><li class="listitem" style="list-style-type: disc">If the button isn't pressed (<code class="literal">StateCondition</code>), press the button and turn on the light (<code class="literal">SetValueAction</code>)</li></ul></div></li><li class="listitem" style="list-style-type: disc">At every frame (<code class="literal">OnEveryFrameTrigger</code>):
<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If the three buttons are pressed (chained <code class="literal">StateCondition</code>), set the main light's diffuse color to black (turn off) (<code class="literal">SetValueAction</code>)</li><li class="listitem" style="list-style-type: disc">If one of the three buttons isn't pressed (<code class="literal">StateCondition</code> on each button), set the main light's diffuse color to white (turn on) (<code class="literal">SetValueAction</code>)</li></ul></div></li></ul></div><p>The theory can be performed with actions by chaining the conditions (to check whether the three buttons are pressed) and the actions in the graph. Of course, the Actions Builder will allow you to have a real representation on the graph instead of having it in your mind. You'll just have to manipulate it to train and learn the proper way to think with actions.</p><div class="section" title="State condition"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec55"/>State condition</h2></div></div></div><p>The state condition checks whether the <code class="literal">.state</code> property of <code class="literal">BABYLON.Node</code> is equal to the given state.</p><p>Consider the following example with <code class="literal">BABYLON.StateCondition</code>:</p><pre class="programlisting">myMesh.state = "isUp";&#13;
// If mesh state is "isDown", make position.y up&#13;
var condition1 = new BABYLON.StateCondition(myMesh.actionManager,&#13;
myMesh, "isDown");&#13;
myMesh.actionManager.registerAction(new BABYLON.SetValueAction(&#13;
  BABYLON.ActionManager.OnLeftPickTrigger, myMesh,&#13;
    "position.y", 6, condition1);&#13;
// Else if mesh state is "isUp", make position.y down&#13;
var condition2 = new BABYLON.StateCondition(myMesh.actionManager,&#13;
  myMesh, "isUp");&#13;
myMesh.actionManager.registerAction(new BABYLON.SetValueAction(&#13;
  BABYLON.ActionManager.OnLeftPickTrigger, myMesh,&#13;
    "position.y", 0, condition2);</pre></div><div class="section" title="Predicate condition"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec56"/>Predicate condition</h2></div></div></div><p>The predicate condition executes a custom function that will return true or false. It is particularly useful if the condition has to test multiple values or manipulate objects using TypeScript before it returns true or false. Let's create the same example as we did earlier using a predicate condition, as follows:</p><pre class="programlisting">myMesh.position.y = 6;&#13;
// If mesh position.y is 6, set it to 0&#13;
var condition1 = new BABYLON.PredicateCondition(myMesh.actionManag&#13;
er, () =&gt; {&#13;
  return myMesh.position.y === 6;&#13;
});&#13;
myMesh.actionManager.registerAction(new BABYLON.SetValueAction(&#13;
  BABYLON.ActionManager.OnLeftPickTrigger, myMesh,&#13;
    "position.y", 0, condition1);&#13;
// Else if mesh position.y is 0, set it to 6&#13;
var condition2 = new BABYLON.PredicateCondition(myMesh.actionManag&#13;
er, () =&gt; {&#13;
  return myMesh.position.y === 0;&#13;
});&#13;
myMesh.actionManager.registerAction(new BABYLON.SetValueAction(&#13;
  BABYLON.ActionManager.OnLeftPickTrigger, myMesh,&#13;
    "position.y", 6, condition2);</pre></div><div class="section" title="Value condition"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec57"/>Value condition</h2></div></div></div><p>The value condition is a way to automatically check whether a value is equal, lesser, greater, or different without writing a predicate condition. Let's create the previous example again using <code class="literal">BABYLON.ValueCondition</code>, as follows:</p><pre class="programlisting">myMesh.position.y = 6;&#13;
// If mesh position.y is 6, set it to 0&#13;
var condition1 = new BABYLON.ValueCondition(myMesh.actionManager,   myMesh, "position.y", 6, BABYLON.ValueCondition.IsEqual);&#13;
myMesh.actionManager.registerAction(new BABYLON.SetValueAction(&#13;
  BABYLON.ActionManager.OnLeftPickTrigger, myMesh, "position.y", 0    , condition1);&#13;
// Else if mesh position.y is 0, set it to 6&#13;
var condition2 = new BABYLON.ValueCondition(myMesh.actionManager, myMesh, "position.y", 0, BABYLON.ValueCondition.IsEqual);&#13;
myMesh.actionManager.registerAction(new BABYLON.SetValueAction(&#13;
  BABYLON.ActionManager.OnLeftPickTrigger, myMesh, "position.y", 6    , condition2);</pre><p>The value condition works like an action, you have to specify the target (<code class="literal">myMesh</code>), the property (<code class="literal">position.y</code>), and the value to test (<code class="literal">0</code> and <code class="literal">6</code>).</p></div></div>
<div class="section" title="Using the Actions Builder in 3ds Max"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec31"/>Using the Actions Builder in 3ds Max</h1></div></div></div><p>Creating actions can save lines of code. The Babylon.js solution also provides a way for 3ds Max artists and you, as a developer to create actions, including conditions, without any lines of code.</p><p>The Actions Builder allowed Michel Rousseau to create actions and scenarios in his scenes without any lines of code, as shown in the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The Mansion scene: <a class="ulink" href="http://www.babylonjs.com/?MANSION">http://www.babylonjs.com/?MANSION</a></li><li class="listitem" style="list-style-type: disc">The Actions Builder scene: <a class="ulink" href="http://www.babylonjs.com/?AB">http://www.babylonjs.com/?AB</a></li></ul></div><p>To do this, you can simply use the Actions Builder, which is a part of the 3ds Max plugin of Babylon.js. The Actions Builder is located in the <code class="literal">BabylonActionsBuilder</code> folder available in the 3ds Max plugin in the GitHub repository. You can copy and paste the folder into the 3ds Max plugins directory, which is typically located at <code class="literal">C:\Program Files\Autodesk\3ds Max 2013\bin\assemblies</code>, as you can see in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="graphics/image_07_001.png" alt="Using the Actions Builder in 3ds Max"/></div><p>
</p><div class="section" title="How it works"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec58"/>How it works</h2></div></div></div><p>To use the Actions Builder, simply select an object in 3ds Max, right-click on it, select the <span class="strong"><strong>Babylon...</strong></span> menu, and open <span class="strong"><strong>Babylon Actions Builder</strong></span>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note12"/>Note</h3><p>
<span class="strong"><strong>Note:</strong></span> To edit the scene actions, select nothing in the 3ds Max scene, right-click on the void, select the <span class="strong"><strong>Babylon...</strong></span> menu, and open <span class="strong"><strong>Babylon Actions Builder</strong></span>.</p></div></div><p>
</p><div class="mediaobject"><img src="graphics/image_07_002.png" alt="How it works"/></div><p>
</p><p>The Actions Builder window appears. You are now able to add actions to your object without any lines of code. In the Actions Builder, all actions are available, except the actions that execute the code (<code class="literal">BABYLON.ExecuteCodeAction</code> and <code class="literal">BABYLON.PredicateCondition</code>).</p><p>
</p><div class="mediaobject"><img src="graphics/image_07_003.png" alt="How it works"/></div><p>
</p><p>On the left-hand side, there is a list of triggers, actions, and conditions. To add an action or condition, you have to start with a trigger. Simply Drag'n'drop the required trigger on the root node (ourMesh).</p><p>
</p><div class="mediaobject"><img src="graphics/image_07_004.png" alt="How it works"/></div><p>
</p><p>Now, the child action will be executed once the user left-clicks on the <span class="strong"><strong>ourBox</strong></span> object, which is a mesh.</p><p>Once you added the wanted trigger, you can <span class="emphasis"><em>drag'n'drop</em></span> any action or a condition in the graph. For example, let's add <code class="literal">BABYLON.InterpolateValueAction</code>, as shown in the following image:</p><p>
</p><div class="mediaobject"><img src="graphics/image_07_005.png" alt="How it works"/></div><p>
</p><p>If you click on the added action, a few menus will appear on the right-hand side. These menus will correspond to the parameters of the constructor of the action. You will retrieve the target, property, and value parameters, as shown in the following image:</p><p>
</p><div class="mediaobject"><img src="graphics/image_07_006.png" alt="How it works"/></div><p>
</p><p>The equivalent of the <code class="literal">.then</code> function in the Actions Builder consists of adding a child action to an action.</p><p>Let's also add a condition to the graph and a child action of the interpolate value action (equivalent to <code class="literal">.then</code>). As for triggers and actions, <span class="emphasis"><em>drag'n'drop</em></span> a value condition (<code class="literal">BABYLON.ValueCondition</code>) on the interpolate value action, as shown in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="graphics/image_07_007.png" alt="How it works"/></div><p>
</p><p>Here, Action 1 will be executed when the user left-clicks on the mesh. Once Action 1 is executed, Action 2 is executed only if the value condition returns <code class="literal">true</code>.</p></div><div class="section" title="Managing multiple pipelines"><div class="titlepage"><div><div><h2 class="title"><a id="ch07lvl2sec59"/>Managing multiple pipelines</h2></div></div></div><p>Using TypeScript, you can add multiple branches of actions to your object by calling the  <code class="literal">.registerAction</code> function in the <code class="literal">ActionManager</code> object. With the Actions Builder, you can simply add another trigger that will handle a new graph of actions, as shown in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="graphics/image_07_008.png" alt="Managing multiple pipelines"/></div><p>
</p><p>With this configuration, the first actions of each trigger will be executed simultaneously, except if there are conditions and if the condition of an action returns false.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch07lvl1sec32"/>Summary</h1></div></div></div><p>You are now able to create actions in your projects and save a lot of lines of code. You know how to use the <code class="literal">BABYLON.ActionManager</code> class, how to add actions, the different triggers, and how to control the graph using conditions. You are also able to work with artists and 3ds Max using the Actions Builder and save more lines of code.</p><p>In the next chapter, let's concentrate on the rendering part using post-processes (effects). It'll be an occasion to introduce the notion of HDR, SSAO, blurring, blooming, and so on. It's one of the favorite parts of the 3D developers to create special effects such as post-processes.</p></div></body></html>