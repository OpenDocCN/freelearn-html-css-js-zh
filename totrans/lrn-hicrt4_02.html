<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Highcharts Configurations</h1></div></div></div><p>All Highcharts graphs share the same configuration structure and it is crucial for us to become familiar with the core components. However, it is not possible to go through all the configurations within the book. In this chapter, we will explore the functional properties that are most used and demonstrate them with examples. We will learn how Highcharts manages layout, and then explore how to configure axes, specify single series and multiple series data, followed by looking at formatting and styling tool tips in both JavaScript and HTML. After that, we will get to know how to polish our charts with various types of animations and apply color gradients. Finally, we will explore the <code class="literal">drilldown</code> interactive feature. In this chapter, we will cover the following topics:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Understanding Highcharts layout</li><li class="listitem" style="list-style-type: disc">Framing the chart with axes</li><li class="listitem" style="list-style-type: disc">Revisiting the series config</li><li class="listitem" style="list-style-type: disc">Styling the tool tips</li><li class="listitem" style="list-style-type: disc">Animating charts</li><li class="listitem" style="list-style-type: disc">Expanding colors with gradients</li><li class="listitem" style="list-style-type: disc">Constructing a chart with a <code class="literal">drilldown</code> series</li></ul></div><div><div><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Configuration structure</h1></div></div></div><p>In the Highcharts configuration<a id="id85" class="indexterm"/> object, the components at the top level represent the skeleton structure of a chart. The following is a list of the major components that are covered in this chapter:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">chart</code>: This has<a id="id86" class="indexterm"/> configurations for the top-level chart properties such as layouts, dimensions, events, animations, and user interactions</li><li class="listitem" style="list-style-type: disc"><code class="literal">series</code>: This is an <a id="id87" class="indexterm"/>array of series objects (consisting of data and specific options) for single and multiple series, where the series data can be specified in a number of ways</li><li class="listitem" style="list-style-type: disc"><code class="literal">xAxis</code>/<code class="literal">yAxis/zAxis</code>: This has<a id="id88" class="indexterm"/> configurations for all the axis properties such as labels, styles, range, intervals, plotlines, plot bands, and backgrounds</li><li class="listitem" style="list-style-type: disc"><code class="literal">tooltip</code>: This has the <a id="id89" class="indexterm"/>layout and format style configurations for the series data tool tips</li><li class="listitem" style="list-style-type: disc"><code class="literal">drilldown</code>: This has <a id="id90" class="indexterm"/>configurations for drilldown series and the ID field associated with the main series</li><li class="listitem" style="list-style-type: disc"><code class="literal">title</code>/<code class="literal">subtitle</code>: This<a id="id91" class="indexterm"/> has the layout and style configurations for the chart title and subtitle</li><li class="listitem" style="list-style-type: disc"><code class="literal">legend</code>: This has the<a id="id92" class="indexterm"/> layout and format style configurations for the chart legend</li><li class="listitem" style="list-style-type: disc"><code class="literal">plotOptions</code>: This<a id="id93" class="indexterm"/> contains all the plotting options, such as display, animation, and user interactions, for common series and specific series types</li><li class="listitem" style="list-style-type: disc"><code class="literal">exporting</code>: This has<a id="id94" class="indexterm"/> configurations that control the layout and the function of print and export features</li></ul></div><p>For reference information concerning all <a id="id95" class="indexterm"/>configurations, go to <a class="ulink" href="http://api.highcharts.com">http://api.highcharts.com</a>.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Understanding Highcharts' layout</h1></div></div></div><p>Before we start to learn how <a id="id96" class="indexterm"/>Highcharts layout works, it is imperative that we understand some basic concepts first. To do that, let's first recall the chart example used in <a class="link" href="ch01.html" title="Chapter 1. Web Charts">Chapter 1</a>, <em>Web Charts</em>, and set a couple of borders to be visible. First, set a border around the plot area. To do that we can set the options of <code class="literal">plotBorderWidth</code> and <code class="literal">plotBorderColor</code> in the <code class="literal">chart</code> section, as follows:</p><div><pre class="programlisting">        chart: {
                renderTo: 'container',
                type: 'spline',
                plotBorderWidth: 1,
                plotBorderColor: '#3F4044'
        },</pre></div><p>The second border is set around the Highcharts container. Next, we extend the preceding <code class="literal">chart</code> section with additional settings:</p><div><pre class="programlisting">        chart: {
                renderTo: 'container',
                ....
                borderColor: '#a1a1a1',
                borderWidth: 2,
                borderRadius: 3
        },</pre></div><p>This sets the container border color with a width of <code class="literal">2</code> pixels and corner radius of <code class="literal">3</code> pixels.</p><p>As we can see, there is a border around the container and this is the boundary that the Highcharts display cannot exceed:</p><div><img src="img/7451OS_02_01.jpg" alt="Understanding Highcharts' layout"/></div><p>By default, Highcharts<a id="id97" class="indexterm"/> displays have three different areas: spacing, labeling, and plot area. The plot area is the area inside the inner rectangle that contains all the plot graphics. The labeling area is the area where labels such as title, subtitle, axis title, legend, and credits go, around the plot area, so that it is between the edge of the plot area and the inner edge of the spacing area. The spacing area is the area between the container border and the outer edge of the labeling area.</p><p>The following screenshot shows three different kinds of areas. A gray dotted line is inserted to illustrate the boundary between the spacing and labeling areas.</p><div><img src="img/7451OS_02_02.jpg" alt="Understanding Highcharts' layout"/></div><p>Each chart label position can be operated in one of the following two layouts:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Automatic layout</strong>: Highcharts <a id="id98" class="indexterm"/>automatically adjusts the plot area size based on the labels' positions in the labeling area, so the plot area does not overlap with the label element at all. Automatic layout is the simplest way to configure, but has less control. This is the default way of positioning the chart elements.</li><li class="listitem" style="list-style-type: disc"><strong>Fixed layout</strong>: There is <a id="id99" class="indexterm"/>no concept of labeling area. The chart label is specified in a fixed location so that it has a floating effect on the plot area. In other words, the plot area side does not automatically adjust itself to the adjacent label position. This gives the user full control of exactly how to display the chart.</li></ul></div><p>The spacing area controls the offset of the Highcharts display on each side. As long as the chart margins are not defined, increasing or decreasing the spacing area has a global effect on the plot area measurements in both automatic and fixed layouts.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec22"/>Chart margins and spacing settings</h2></div></div></div><p>In this section, we will see how chart margins<a id="id100" class="indexterm"/> and <a id="id101" class="indexterm"/>spacing settings<a id="id102" class="indexterm"/> have an effect on<a id="id103" class="indexterm"/> the overall layout. Chart margins can be configured with the properties <code class="literal">margin</code>, <code class="literal">marginTop</code>, <code class="literal">marginLeft</code>, <code class="literal">marginRight</code>, and <code class="literal">marginBottom</code>, and they are not enabled by default. Setting chart margins has a global effect on the plot area, so that none of the label positions or chart spacing configurations can affect the plot area size. Hence, all the chart elements are in a fixed layout mode with respect to the plot area. The <code class="literal">margin</code> option is an array of four margin values covered for each direction, the same as in CSS, starting from north and going clockwise. Also, the <code class="literal">margin</code> option has a lower precedence than any of the directional <code class="literal">margin</code> options, regardless of their order in the <code class="literal">chart</code> section.</p><p>Spacing configurations are enabled by default with a fixed value on each side. These can be configured in the <code class="literal">chart</code> section with the property names <code class="literal">spacing</code>, <code class="literal">spacingTop</code>, <code class="literal">spacingLeft</code>, <code class="literal">spacingBottom</code>, and <code class="literal">spacingRight</code>.</p><p>In this example, we<a id="id104" class="indexterm"/> are going to increase or decrease the <code class="literal">margin</code> or <code class="literal">spacing</code> property <a id="id105" class="indexterm"/>on each side of the chart and <a id="id106" class="indexterm"/>observe the effect. The following are the chart<a id="id107" class="indexterm"/> settings:</p><div><pre class="programlisting">            chart: {
                renderTo: 'container',
                type: ...
                marginTop: 10,
                marginRight: 0,
                spacingLeft: 30,
                spacingBottom: 0
            },</pre></div><p>The following screenshot shows what the chart looks like:</p><div><img src="img/7451OS_02_03.jpg" alt="Chart margins and spacing settings"/></div><p>The <code class="literal">marginTop</code> property fixes the plot area's top border <code class="literal">10</code> pixels away from the container border. It also changes the top border into fixed layout for any label elements, so the chart title and subtitle float on top of the plot area. The <code class="literal">spacingLeft</code> property increases the spacing area on the left-hand side, so it pushes the <em>y</em> axis title further in. As it is in automatic layout (without declaring <code class="literal">marginLeft</code>), it also pushes the plot area's west border in. Setting <code class="literal">marginRight</code> to <code class="literal">0</code> will override all the default spacing on the chart's right-hand side and change it to fixed layout mode. Finally, setting <code class="literal">spacingBottom</code> to <code class="literal">0</code> <a id="id108" class="indexterm"/>makes the legend touch the lower bar of the container, so <a id="id109" class="indexterm"/>it also stretches the plot area downwards. This<a id="id110" class="indexterm"/> is because the bottom edge is still in automatic layout <a id="id111" class="indexterm"/>even though <code class="literal">spacingBottom</code> is set to <code class="literal">0</code>.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec23"/>Chart label properties</h2></div></div></div><p>Chart labels <a id="id112" class="indexterm"/>such as <code class="literal">xAxis.title</code>, <code class="literal">yAxis.title</code>, <code class="literal">legend</code>, <code class="literal">title</code>, <code class="literal">subtitle</code>, and <code class="literal">credits</code> share common property names, as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">align</code>: This is for<a id="id113" class="indexterm"/> the horizontal alignment of the label. Possible keywords are <code class="literal">'left'</code>, <code class="literal">'center'</code>, and <code class="literal">'right'</code>. As for the axis title, it is <code class="literal">'low'</code>, <code class="literal">'middle'</code>, and <code class="literal">'high'</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">floating</code>: This is to give the<a id="id114" class="indexterm"/> label position a floating effect on the plot area. Setting this to <code class="literal">true</code> will cause the label position to have no effect on the adjacent plot area's boundary.</li><li class="listitem" style="list-style-type: disc"><code class="literal">margin</code>: This is<a id="id115" class="indexterm"/> the margin setting between the label and the side of the plot area adjacent to it. Only certain label types have this setting.</li><li class="listitem" style="list-style-type: disc"><code class="literal">verticalAlign</code>: This is <a id="id116" class="indexterm"/>for the vertical alignment of the label. The keywords are <code class="literal">'top'</code>, <code class="literal">'middle'</code>, and <code class="literal">'bottom'</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">x</code>: This is for <a id="id117" class="indexterm"/>horizontal positioning in relation to alignment.</li><li class="listitem" style="list-style-type: disc"><code class="literal">y</code>: This is for<a id="id118" class="indexterm"/> vertical positioning in relation to alignment.</li></ul></div><p>As for the labels' <code class="literal">x</code> and <code class="literal">y</code> positioning, they are not used for absolute positioning within the chart. They are designed for fine adjustment with the label alignment. The following diagram shows the coordinate directions, where the center represents the label location:</p><div><img src="img/7451OS_02_04.jpg" alt="Chart label properties"/></div><p>We can experiment with these properties with a simple example of the <code class="literal">align</code> and <code class="literal">y</code> position settings, by placing both title and subtitle next to each other. The title is shifted to the left with <code class="literal">align</code> set to <code class="literal">'left'</code>, whereas the subtitle alignment is set to <code class="literal">'right'</code>. In order to make both titles appear on the same line, we change the subtitle's <code class="literal">y</code> position to <code class="literal">15</code>, which is the same as the title's default <code class="literal">y</code> value:</p><div><pre class="programlisting"> title: {
     text: 'Web browsers ...',
     align: 'left'
 },
 subtitle: {
     text: 'From 2008 to present',
     align: 'right',
     y: 15
 },</pre></div><p>The following is a screenshot showing both titles aligned on the same line:</p><div><img src="img/7451OS_02_05.jpg" alt="Chart label properties"/></div><p>In the following subsections, we will experiment with how changes in alignment for each label element affect the layout behavior of the plot area.</p><div><div><div><div><h3 class="title"><a id="ch02lvl3sec04"/>Title and subtitle alignments</h3></div></div></div><p>Title and subtitle have the <a id="id119" class="indexterm"/>same layout properties, and the only differences are that the default values and title have the <code class="literal">margin</code> setting. Specifying <code class="literal">verticalAlign</code> for any value changes from the default automatic layout to fixed layout (it internally switches <code class="literal">floating</code> to <code class="literal">true</code>). However, manually setting the subtitle's <code class="literal">floating</code> property to <code class="literal">false</code> does not switch back to automatic layout. The following is an example of <code class="literal">title</code> in automatic layout and <code class="literal">subtitle</code> in fixed layout:</p><div><pre class="programlisting">    title: {
       text: 'Web browsers statistics'
    },
    subtitle: {
       text: 'From 2008 to present',
       verticalAlign: 'top',
       y: 60    
    },</pre></div><p>The <code class="literal">verticalAlign</code> property for the subtitle is set to <code class="literal">'top'</code>, which switches the layout into fixed layout, and the <code class="literal">y</code> offset is increased to <code class="literal">60</code>. The <code class="literal">y</code> offset pushes the subtitle's position further down. Due to the fact that the plot area is not in an automatic layout relationship to the subtitle anymore, the top border of the plot area goes above the subtitle. However, the plot area is still in automatic layout towards the title, so the title is still above the plot area:</p><div><img src="img/7451OS_02_06.jpg" alt="Title and subtitle alignments"/></div></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec05"/>Legend alignment</h3></div></div></div><p>Legends show different <a id="id120" class="indexterm"/>behavior for the <code class="literal">verticalAlign</code> and <code class="literal">align</code> properties. Apart from setting the alignment to <code class="literal">'center'</code>, all other settings in <code class="literal">verticalAlign</code> and <code class="literal">align</code> remain in automatic positioning. The following is an example of a legend located on the right-hand side of the chart. The <code class="literal">verticalAlign</code> property is switched to the middle of the chart, where the horizontal <code class="literal">align</code> is set to <code class="literal">'right'</code>:</p><div><pre class="programlisting">          legend: {
                align: 'right',
                verticalAlign: 'middle',
                layout: 'vertical'
          },</pre></div><p>The <code class="literal">layout</code> property is assigned to <code class="literal">'vertical'</code> so that it causes the items inside the legend box to be displayed in a vertical manner. As we can see, the plot area is automatically resized for the legend box:</p><div><img src="img/7451OS_02_07.jpg" alt="Legend alignment"/></div><p>Note that the border decoration around the legend box is disabled in the newer version. To display a round border around the legend box, we can add the <code class="literal">borderWidth</code> and <code class="literal">borderRadius</code> options using the following:</p><div><pre class="programlisting">          legend: {
                align: 'right',
                verticalAlign: 'middle',
                layout: 'vertical',
                borderWidth: 1,
                borderRadius: 3
          },</pre></div><p>Here is the legend box<a id="id121" class="indexterm"/> with a round corner border:</p><div><img src="img/7451OS_02_56.jpg" alt="Legend alignment"/></div></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec06"/>Axis title alignment</h3></div></div></div><p>Axis titles do not <a id="id122" class="indexterm"/>use <code class="literal">verticalAlign</code>. Instead, they use the <code class="literal">align</code> setting, which is either <code class="literal">'low'</code>, <code class="literal">'middle'</code>, or <code class="literal">'high'</code>. The title's <code class="literal">margin</code> value is the distance between the axis title and the axis line. The following is an example of showing the y-axis title rotated horizontally instead of vertically (which it is by default) and displayed on the top of the axis line instead of next to it. We also use the <code class="literal">y</code> property to fine-tune the title location:</p><div><pre class="programlisting">            yAxis: {
                title: {
                    text: 'Percentage %',
                    rotation: 0,
                    y: -15,
                    margin: -70,
                    align: 'high'
                },
                min: 0
            },</pre></div><p>The following is a<a id="id123" class="indexterm"/> screenshot of the upper-left corner of the chart showing that the title is aligned horizontally at the top of the <em>y</em> axis. Alternatively, we can use the <code class="literal">offset</code> option instead of <code class="literal">margin</code> to achieve the same result.</p><div><img src="img/7451OS_02_08.jpg" alt="Axis title alignment"/></div></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec07"/>Credits alignment</h3></div></div></div><p>Credits is a bit different from <a id="id124" class="indexterm"/>other label elements. It only supports the <code class="literal">align</code>, <code class="literal">verticalAlign</code>, <code class="literal">x</code>, and <code class="literal">y</code> properties in the <code class="literal">credits.position</code> property (shorthand for <code class="literal">credits: { position: … }</code>), and is also not affected by any spacing setting. Suppose we have a graph without a legend and we have to move the credits to the lower-left area of the chart, the following code snippet shows how to do it:</p><div><pre class="programlisting">            legend: {
                enabled: false
            },
            credits: {
                position: { 
                   align: 'left'
                },
                text: 'Joe Kuan',
                href: 'http://joekuan.wordpress.com'
            },</pre></div><p>However, the credits text is off the edge of the chart, as shown in the following screenshot:</p><div><img src="img/7451OS_02_09.jpg" alt="Credits alignment"/></div><p>Even if we move the <code class="literal">credits</code> label to<a id="id125" class="indexterm"/> the right with <code class="literal">x</code> positioning, the label is still a bit too close to the <em>x</em> axis interval label. We can introduce extra <code class="literal">spacingBottom</code> to put a gap between both labels, as follows:</p><div><pre class="programlisting">            chart: {
                   spacingBottom: 30,
                    ....
            },
            credits: {
                position: { 
                   align: 'left',
                   x: 20,
                   y: -7
                },
            },
            ....</pre></div><p>The following is a screenshot of the credits with the final adjustments:</p><div><img src="img/7451OS_02_10.jpg" alt="Credits alignment"/></div></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec24"/>Experimenting with an automatic layout</h2></div></div></div><p>In this section, we will examine the automatic layout feature<a id="id126" class="indexterm"/> in more <a id="id127" class="indexterm"/>detail. For the sake of simplifying the example, we will start with only the chart title and without any chart spacing settings:</p><div><pre class="programlisting">     chart: {
         renderTo: 'container',
         // border and plotBorder settings
         borderWidth: 2,
         .....
     },
     title: {
            text: 'Web browsers statistics,
     },</pre></div><p>From the preceding example, the chart title should appear as expected between the container and the plot area's borders:</p><div><img src="img/7451OS_02_11.jpg" alt="Experimenting with an automatic layout"/></div><p>The space between the title and the top border of the container has the default setting <code class="literal">spacingTop</code> for the spacing area (a default value of 10-pixels high). The gap between the title and the top border of the plot area is the default setting for <code class="literal">title.margin</code>, which is 15-pixels high.</p><p>By setting <code class="literal">spacingTop</code> in the <code class="literal">chart</code> section to <code class="literal">0</code>, the chart title moves up next to the container top border. Hence the size of the plot area is automatically expanded upwards, as follows:</p><div><img src="img/7451OS_02_12.jpg" alt="Experimenting with an automatic layout"/></div><p>Then, we set <code class="literal">title.margin</code> to <code class="literal">0</code>; the plot area border moves further up, hence the height of the plot area increases further, as follows:</p><div><img src="img/7451OS_02_13.jpg" alt="Experimenting with an automatic layout"/></div><p>As you may notice, there is still a<a id="id128" class="indexterm"/> gap of a few pixels <a id="id129" class="indexterm"/>between the top border and the chart title. This is actually due to the default value of the title's <code class="literal">y</code> position setting, which is 15 pixels, large enough for the default title font size.</p><p>The following is the chart configuration for setting all the spaces between the container and the plot area to <code class="literal">0</code>:</p><div><pre class="programlisting">chart: {
     renderTo: 'container',
     // border and plotBorder settings
     .....
     spacingTop: 0
},
title: {
     text: null,
     margin: 0,
     y: 0
}</pre></div><p>If we set <code class="literal">title.y</code> to <code class="literal">0</code>, all the gap between the top edge of the plot area and the top container edge closes up. The following is the final screenshot of the upper-left corner of the chart, to show the effect. The chart title is not visible anymore as it has been shifted above the container:</p><div><img src="img/7451OS_02_14.jpg" alt="Experimenting with an automatic layout"/></div><p>Interestingly, if we work backwards to the first example, the default distance between the top of the plot area and the top of the container is calculated as:</p><p><em>spacingTop + title.margin + title.y = 10 + 15 + 15 = 40</em></p><p>Therefore, changing any of these three variables will automatically adjust the plot area from the top container bar. Each of these offset variables actually has its own purpose in the automatic layout. Spacing is for the gap between the container and the chart content; thus, if we want to display a chart nicely spaced with other elements on a web page, spacing elements should be used. Equally, if we want to use a specific font size for the label elements, we should consider<a id="id130" class="indexterm"/> adjusting<a id="id131" class="indexterm"/> the <code class="literal">y</code> offset. Hence, the labels are still maintained at a distance and do not interfere with other components in the chart.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec25"/>Experimenting with a fixed layout</h2></div></div></div><p>In the preceding section, we have<a id="id132" class="indexterm"/> learned how the plot area dynamically <a id="id133" class="indexterm"/>adjusted itself. In this section, we will see how we can manually position the chart labels. First, we will start with the example code from the beginning of the <em>Experimenting with automatic layout</em> section and set the chart title's <code class="literal">verticalAlign</code> to <code class="literal">'bottom'</code>, as follows:</p><div><pre class="programlisting">chart: {
    renderTo: 'container',
    // border and plotBorder settings    .....
},
title: {
    text: 'Web browsers statistics',
    verticalAlign: 'bottom'
},</pre></div><p>The chart title is moved to the bottom of the chart, next to the lower border of the container. Notice that this setting has changed the title into floating mode; more importantly, the legend still remains in the default automatic layout of the plot area:</p><div><img src="img/7451OS_02_15.jpg" alt="Experimenting with a fixed layout"/></div><p>Be aware that we haven't specified <code class="literal">spacingBottom</code>, which has a default value of 15 pixels in height when applied to the chart. This means that there should be a gap between the title and the container bottom border, but none is shown. This is because the <code class="literal">title.y</code> position has a default value of 15 pixels in relation to spacing. According to the diagram in the <em>Chart label properties</em> section, this positive <code class="literal">y</code> value pushes the title towards the bottom border; this compensates for the space created by <code class="literal">spacingBottom</code>.</p><p>Let's make a bigger change to the <code class="literal">y</code> offset position this time to show that <code class="literal">verticalAlign</code> is floating on top of the plot area:</p><div><pre class="programlisting"> title: {
     text: 'Web browsers statistics',
     verticalAlign: 'bottom',
     y: -90
 },</pre></div><p>The negative <code class="literal">y</code> value moves the title up, as shown here:</p><div><img src="img/7451OS_02_16.jpg" alt="Experimenting with a fixed layout"/></div><p>Now the title is <a id="id134" class="indexterm"/>overlapping the plot area. To demonstrate that <a id="id135" class="indexterm"/>the legend is still in automatic layout with regard to the plot area, here we change the legend's <code class="literal">y</code> position and the <code class="literal">margin</code> settings, which is the distance from the axis label:</p><div><pre class="programlisting">               legend: {
                   margin: 70,
                   y: -10
               },</pre></div><p>This has pushed up the bottom side of the plot area. However, the chart title still remains in fixed layout and its position within the chart hasn't been changed at all after applying the new legend setting, as shown in the following screenshot:</p><div><img src="img/7451OS_02_17.jpg" alt="Experimenting with a fixed layout"/></div><p>By now, we should have a better understanding of how to position label elements, and their layout policy relating to the plot area.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Framing the chart with axes</h1></div></div></div><p>In this section, we are<a id="id136" class="indexterm"/> going to look into the configuration of axes in Highcharts in terms of their functional area. We will start off with a plain line graph and gradually apply more options to the chart to demonstrate the effects.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec26"/>Accessing the axis data type</h2></div></div></div><p>There are two ways to specify <a id="id137" class="indexterm"/>data for a chart: categories and series data. For displaying intervals with specific names, we should use the <code class="literal">categories</code> field that expects an array of strings. Each entry in the categories array is then associated with the series data array. Alternatively, the axis interval values are embedded inside the series data array. Then, Highcharts extracts the series data for both axes, interprets the data type, and formats and labels the values appropriately.</p><p>The following is a straightforward example showing the use of categories:</p><div><pre class="programlisting">    chart: {
        renderTo: 'container',
        height: 250,
        spacingRight: 20 
    },
    title: {
        text: 'Market Data: Nasdaq 100'
    },
    subtitle: {
        text: 'May 11, 2012'
    },
    xAxis: {
        categories: [ '9:30 am', '10:00 am', '10:30 am', 
                      '11:00 am', '11:30 am', '12:00 pm', 
                      '12:30 pm', '1:00 pm', '1:30 pm', 
                      '2:00 pm', '2:30 pm', '3:00 pm', 
                      '3:30 pm', '4:00 pm' ],
        labels: {
            step: 3
        }
    },
    yAxis: {
        title: {
            text: null
        }
    },
    legend: {
        enabled: false
    },
    credits: {
        enabled: false
    },
    series: [{
        name: 'Nasdaq',
        color: '#4572A7',
        data: [ 2606.01, 2622.08, 2636.03, 2637.78, 2639.15, 
                2637.09, 2633.38, 2632.23, 2632.33, 2632.59, 
                2630.34, 2626.89, 2624.59, 2615.98 ]
    }]</pre></div><p>The preceding code <a id="id138" class="indexterm"/>snippet produces a graph that looks like the following screenshot:</p><div><img src="img/7451OS_02_18.jpg" alt="Accessing the axis data type"/></div><p>The first name in the categories field corresponds to the first value, <strong>9:30 am</strong>, 2606.01, in the series data array, and so on.</p><p>Alternatively, we can specify the time values inside the series data and use the <code class="literal">type</code> property of the <em>x</em> axis to format the time. The <code class="literal">type</code> property supports <code class="literal">'linear'</code> (default), <code class="literal">'logarithmic'</code>, or <code class="literal">'datetime'</code>. The <code class="literal">'datetime'</code> setting automatically interprets the time in the series data into human-readable form. Moreover, we can use the <code class="literal">dateTimeLabelFormats</code> property to predefine the custom format for the time unit. The option can also accept multiple time unit formats. This is for when we don't know in advance how long the time span is in the series data, so each unit in the resulting graph can be per hour, per day, and so on. The following example shows how the graph is specified with predefined hourly and minute formats. The syntax of the format string is based on the PHP <code class="literal">strftime</code> function:</p><div><pre class="programlisting">    xAxis: {
        type: 'datetime',
         // Format 24 hour time to AM/PM
         dateTimeLabelFormats: {

             hour: '%I:%M %P',
             minute: '%I %M'
         }           
    },
    series: [{
        name: 'Nasdaq',
        color: '#4572A7',
        data: [ [ Date.UTC(2012, 4, 11, 9, 30), 2606.01 ], 
                 [ Date.UTC(2012, 4, 11, 10), 2622.08 ],  
                 [ Date.UTC(2012, 4, 11, 10, 30), 2636.03 ],
                 .....
               ]
    }]</pre></div><p>Note that the <em>x</em> axis is in the 12-hour time format, as shown in the following screenshot:</p><div><img src="img/7451OS_02_19.jpg" alt="Accessing the axis data type"/></div><p>Instead, we can define the<a id="id139" class="indexterm"/> format handler for the <code class="literal">xAxis.labels.formatter</code> property to achieve a similar effect. Highcharts provides a utility routine, <code class="literal">Highcharts.dateFormat</code>, that converts the timestamp in milliseconds to a readable format. In the following code snippet, we define the <code class="literal">formatter</code> function using <code class="literal">dateFormat</code> and <code class="literal">this.value</code>. The keyword <code class="literal">this</code> is the axis's interval object, whereas <code class="literal">this.value</code> is the UTC time value for the instance of the interval:</p><div><pre class="programlisting">    xAxis: {
        type: 'datetime',
        labels: {
            formatter: function() {
                return Highcharts.dateFormat('%I:%M %P', this.value);
            }
        }
    },</pre></div><p>Since the time values of our data points are in fixed intervals, they can also be arranged in a cut-down version. All we need is to define the starting point of time, <code class="literal">pointStart</code>, and the regular interval between <a id="id140" class="indexterm"/>them, <code class="literal">pointInterval</code>, in milliseconds:</p><div><pre class="programlisting">series: [{
    name: 'Nasdaq',
    color: '#4572A7',
    pointStart: Date.UTC(2012, 4, 11, 9, 30),
    pointInterval: 30 * 60 * 1000,
    data: [ 2606.01, 2622.08, 2636.03, 2637.78, 
            2639.15, 2637.09, 2633.38, 2632.23, 
            2632.33, 2632.59, 2630.34, 2626.89, 
            2624.59, 2615.98 ]
}] </pre></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec27"/>Adjusting intervals and background</h2></div></div></div><p>We have learned how to use<a id="id141" class="indexterm"/> axis categories and series data arrays <a id="id142" class="indexterm"/>in the last section. In this section, we will see how to format interval lines and the background style to produce a graph with more clarity.</p><p>We will continue from the previous example. First, let's create some interval lines along the <em>y</em> axis. In the chart, the interval is automatically set to 20. However, it would be clearer to double the number of interval lines. To do that, simply assign the <code class="literal">tickInterval</code> value to <code class="literal">10</code>. Then, we use <code class="literal">minorTickInterval</code> to put another line in between the intervals to indicate a semi-interval. In order to distinguish between interval and semi-interval lines, we set the semi-interval lines, <code class="literal">minorGridLineDashStyle</code>, to a dashed and dotted style.</p><div><div><h3 class="title"><a id="note05"/>Note</h3><p>There are nearly a dozen line style settings available in Highcharts, from <code class="literal">'Solid'</code> to <code class="literal">'LongDashDotDot'</code>. Readers can refer to the online manual for possible values.</p></div></div><p>The following is the first step to create the new settings:</p><div><pre class="programlisting">            yAxis: {
                title: {
                    text: null
                },
                tickInterval: 10,
                minorTickInterval: 5,
                minorGridLineColor: '#ADADAD',
                minorGridLineDashStyle: 'dashdot'
           }</pre></div><p>The interval lines should look like the following screenshot:</p><div><img src="img/7451OS_02_20.jpg" alt="Adjusting intervals and background"/></div><p>To make the graph even <a id="id143" class="indexterm"/>more presentable, we add a striping<a id="id144" class="indexterm"/> effect with shading using <code class="literal">alternateGridColor</code>. Then, we change the interval line color, <code class="literal">gridLineColor</code>, to a similar range with the stripes. The following code snippet is added into the <code class="literal">yAxis</code> configuration:</p><div><pre class="programlisting">                gridLineColor: '#8AB8E6',
                alternateGridColor: {
                    linearGradient: {
                        x1: 0, y1: 1,
                        x2: 1, y2: 1
                    },
                    stops: [ [0, '#FAFCFF' ],
                             [0.5, '#F5FAFF'] ,
                             [0.8, '#E0F0FF'] ,
                             [1, '#D6EBFF'] ]
                  }</pre></div><p>We will discuss the color gradient later in this chapter. The following is the graph with the new shading background:</p><div><img src="img/7451OS_02_21.jpg" alt="Adjusting intervals and background"/></div><p>The next step is to apply <a id="id145" class="indexterm"/>a more professional look to the <em>y</em> axis <a id="id146" class="indexterm"/>line. We are going to draw a line on the <em>y</em> axis with the <code class="literal">lineWidth</code> property, and add some measurement marks along the interval lines with the following code snippet:</p><div><pre class="programlisting">                 lineWidth: 2,
                 lineColor: '#92A8CD',
                 tickWidth: 3,
                 tickLength: 6,
                 tickColor: '#92A8CD',
                 minorTickLength: 3,
                 minorTickWidth: 1,
                 minorTickColor: '#D8D8D8'</pre></div><p>The <code class="literal">tickWidth</code> and <code class="literal">tickLength</code> properties add the effect of little marks at the start of each interval line. We apply the same color on both the interval mark and the axis line. Then we add the ticks <code class="literal">minorTickLength</code> and <code class="literal">minorTickWidth</code> into the semi-interval lines in a smaller size. This gives a nice measurement mark effect along the axis, as shown in the following screenshot:</p><div><img src="img/7451OS_02_22.jpg" alt="Adjusting intervals and background"/></div><p>Now, we apply a similar <a id="id147" class="indexterm"/>polish to the <code class="literal">xAxis</code> configuration, as<a id="id148" class="indexterm"/> follows:</p><div><pre class="programlisting">           xAxis: {
               type: 'datetime',
               labels: {
                   formatter: function() {
                       return Highcharts.dateFormat('%I:%M %P', this.value);
                   },
               },
               gridLineDashStyle: 'dot',
               gridLineWidth: 1,
               tickInterval: 60 * 60 * 1000,
               lineWidth: 2,
               lineColor: '#92A8CD',
               tickWidth: 3,
               tickLength: 6,
               tickColor: '#92A8CD',
           },</pre></div><p>We set the <em>x</em> axis interval lines to the hourly format and switch the line style to a dotted line. Then, we apply the same color, thickness, and interval ticks as on the <em>y</em> axis. The following is the resulting screenshot:</p><div><img src="img/7451OS_02_23.jpg" alt="Adjusting intervals and background"/></div><p>However, there are some <a id="id149" class="indexterm"/>defects along the <em>x</em> axis line. To begin <a id="id150" class="indexterm"/>with, the meeting point between the <em>x</em> axis and <em>y</em> axis lines does not align properly. Secondly, the interval labels at the <em>x</em> axis are touching the interval ticks. Finally, part of the first data point is covered by the y-axis line. The following is an enlarged screenshot showing the issues:</p><div><img src="img/7451OS_02_24.jpg" alt="Adjusting intervals and background"/></div><p>There are two ways to resolve the axis line alignment problem, as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Shift the plot area 1 pixel away from the x axis. This can be achieved by setting the <code class="literal">offset</code> property of <code class="literal">xAxis</code> to <code class="literal">1</code>.</li><li class="listitem" style="list-style-type: disc">Increase the x-axis line width to 3 pixels, which is the same width as the y-axis tick interval.</li></ul></div><p>As for the x-axis label, we can simply solve the problem by introducing the <code class="literal">y</code> offset value into the <code class="literal">labels</code> setting.</p><p>Finally, to avoid the first data point touching the y-axis line, we can impose <code class="literal">minPadding</code> on the <em>x</em> axis. What this does is to add padding space at the minimum value of the axis, the first point. The <code class="literal">minPadding</code> value is based on the ratio of the graph width. In this case, setting the property to <code class="literal">0.02</code> is equivalent to shifting along the <em>x</em> axis 5 pixels to the right (250 px * 0.02). The following are the additional settings to improve the chart:</p><div><pre class="programlisting">    xAxis: {
        ....
        labels: {
               formatter: ...,
               y: 17
        },
        .....
        minPadding: 0.02,
        offset: 1
    }</pre></div><p>The following screenshot <a id="id151" class="indexterm"/>shows that the issues have been <a id="id152" class="indexterm"/>addressed:</p><div><img src="img/7451OS_02_25.jpg" alt="Adjusting intervals and background"/></div><p>As we can see, Highcharts has a comprehensive set of configurable variables with great flexibility.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec28"/>Using plot lines and plot bands</h2></div></div></div><p>In this section, we are going to<a id="id153" class="indexterm"/> see how we can use Highcharts to place<a id="id154" class="indexterm"/> lines or bands along the axis. We will continue with the example from the previous section. Let's draw a couple of lines to indicate the day's highest and lowest index points on the y axis. The <code class="literal">plotLines</code> field accepts an array of object configurations for each plot line. There are no width and color default values for <code class="literal">plotLines</code>, so we need to specify them explicitly in order to see the line. The following is the code snippet for the plot lines:</p><div><pre class="programlisting">      yAxis: {
              ... ,
              plotLines: [{
                   value: 2606.01,
                   width: 2,
                   color: '#821740',
                   label: {
                       text: 'Lowest: 2606.01',
                       style: {
                           color: '#898989'
                       }
                   }
              }, {
                   value: 2639.15,
                   width: 2,
                   color: '#4A9338',
                   label: {
                       text: 'Highest: 2639.15',
                       style: {
                           color: '#898989'
                       }
                   }
              }]
        }</pre></div><p>The following screenshot shows what it should look like:</p><div><img src="img/7451OS_02_26.jpg" alt="Using plot lines and plot bands"/></div><p>We can improve the look <a id="id155" class="indexterm"/>of the chart slightly. First, the text label for<a id="id156" class="indexterm"/> the top plot line should not be next to the highest point. Second, the label for the bottom line should be remotely covered by the series and interval lines, as follows:</p><div><img src="img/7451OS_02_27.jpg" alt="Using plot lines and plot bands"/></div><p>To resolve these issues, we can assign the plot line's <code class="literal">zIndex</code> to <code class="literal">1</code>, which brings the text label above the interval lines. We also set the <code class="literal">x</code> position of the label to shift the text next to the point. The following are the new changes:</p><div><pre class="programlisting">             plotLines: [{
                   ... ,
                   label: {
                       ... ,
                       x: 25
                   },
                   zIndex: 1
                   }, {
                   ... ,
                   label: {
                       ... ,
                       x: 130
                   },
                   zIndex: 1
              }]</pre></div><p>The following graph shows the label has been moved away from the plot line and over the interval line:</p><div><img src="img/7451OS_02_28.jpg" alt="Using plot lines and plot bands"/></div><p>Now, we are going to change<a id="id157" class="indexterm"/> the preceding example with a plot<a id="id158" class="indexterm"/> band area that shows the index change between the market's opening and closing values. The plot band configuration is very similar to plot lines, except that it uses the <code class="literal">to</code> and <code class="literal">from</code> properties, and the <code class="literal">color</code> property accepts gradient settings or color code. We create a plot band with a triangle text symbol and values to signify a positive close. Instead of using the <code class="literal">x</code> and <code class="literal">y</code> properties to fine-tune label position, we use the <code class="literal">align</code> option to adjust the text to the center of the plot area (replace the plotLines setting from the above example):</p><div><pre class="programlisting">              plotBands: [{
                   from: 2606.01,
                   to: 2615.98,
                   label: {
                       text: '▲ 9.97 (0.38%)',
                       align: 'center',
                       style: {
                           color: '#007A3D'
                       }
                   },
                   zIndex: 1,
                   color: {
                       linearGradient: {
                           x1: 0, y1: 1,
                           x2: 1, y2: 1
                       },
                       stops: [ [0, '#EBFAEB' ],
                                [0.5, '#C2F0C2'] ,
                                [0.8, '#ADEBAD'] ,
                                [1, '#99E699'] 
                       ]
                   }
              }]</pre></div><div><div><h3 class="title"><a id="note06"/>Note</h3><p>The triangle is an <a id="id159" class="indexterm"/>alt-code character; hold down the left <em>Alt</em> key and enter <code class="literal">30</code> in the number keypad. See <a class="ulink" href="http://www.alt-codes.net">http://www.alt-codes.net</a> for more details.</p></div></div><p>This produces a chart with a<a id="id160" class="indexterm"/> green plot band highlighting a positive <a id="id161" class="indexterm"/>close in the market, as shown in the following screenshot:</p><div><img src="img/7451OS_02_29.jpg" alt="Using plot lines and plot bands"/></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec29"/>Extending to multiple axes</h2></div></div></div><p>Previously, we ran through most <a id="id162" class="indexterm"/>of the axis configurations. Here, we explore how we can use multiple axes, which are just an array of objects containing axis configurations.</p><p>Continuing from the previous stock market example, suppose we now want to include another market index, Dow Jones, along with Nasdaq. However, both indices are different in nature, so their value ranges are vastly different. First, let's examine the outcome by displaying both indices with the common <em>y</em> axis. We change the title, remove the fixed interval setting on the y axis, and include data for another series:</p><div><pre class="programlisting">            chart: ... ,
            title: {
                text: 'Market Data: Nasdaq &amp; Dow Jones'
            },
            subtitle: ... ,
            xAxis: ... ,
            credits: ... ,
            yAxis: {
                title: {
                    text: null
                },
                minorGridLineColor: '#D8D8D8',
                minorGridLineDashStyle: 'dashdot',
                gridLineColor: '#8AB8E6',
                alternateGridColor: {
                    linearGradient: {
                        x1: 0, y1: 1, 
                        x2: 1, y2: 1
                    },
                    stops: [ [0, '#FAFCFF' ],
                             [0.5, '#F5FAFF'] ,
                             [0.8, '#E0F0FF'] ,
                             [1, '#D6EBFF'] ]
                },
                lineWidth: 2,
                lineColor: '#92A8CD',
                tickWidth: 3,
                tickLength: 6,
                tickColor: '#92A8CD',
                minorTickLength: 3,
                minorTickWidth: 1,
                minorTickColor: '#D8D8D8'
            },
            series: [{
              name: 'Nasdaq',
              color: '#4572A7',
              data: [ [ Date.UTC(2012, 4, 11, 9, 30), 2606.01 ], 
                         [ Date.UTC(2012, 4, 11, 10), 2622.08 ],  
                         [ Date.UTC(2012, 4, 11, 10, 30), 2636.03 ], 
                         ...
                       ]
            }, {
              name: 'Dow Jones',
              color: '#AA4643',
              data: [ [ Date.UTC(2012, 4, 11, 9, 30), 12598.32 ], 
                         [ Date.UTC(2012, 4, 11, 10), 12538.61 ],  
                         [ Date.UTC(2012, 4, 11, 10, 30), 12549.89 ], 
                         ...
                       ]
            }]</pre></div><p>The following is the <a id="id163" class="indexterm"/>chart showing both market indices:</p><div><img src="img/7451OS_02_30.jpg" alt="Extending to multiple axes"/></div><p>As expected, the index changes that occur during the day have been normalized by the vast differences in value. Both lines look roughly straight, which falsely implies that the indices have hardly changed.</p><p>Let us now explore putting both indices onto separate <em>y</em> axes. We should remove any background decoration on the <em>y</em> axis, because we now have a different range of data shared on the same background.</p><p>The following is the new setup for <code class="literal">yAxis</code>:</p><div><pre class="programlisting">           yAxis: [{  
                title: {
                    text: 'Nasdaq'
                },
              }, {
                title: {
                    text: 'Dow Jones'
                },
                opposite: true
            }],</pre></div><p>Now <code class="literal">yAxis</code> is an<a id="id164" class="indexterm"/> array of axis configurations. The first entry in the array is for Nasdaq and the second is for Dow Jones. This time, we display the axis title to distinguish between them. The <code class="literal">opposite</code> property is to put the Dow Jones y axis onto the other side of the graph for clarity. Otherwise, both <em>y</em> axes appear on the left-hand side.</p><p>The next step is to align indices from the y-axis array to the series data array, as follows:</p><div><pre class="programlisting">            series: [{
                name: 'Nasdaq',
                color: '#4572A7',
                yAxis: 0,
                data: [ ... ]
            }, {
                name: 'Dow Jones',
                color: '#AA4643',
                yAxis: 1,
                data: [ ... ]
            }]          </pre></div><p>We can clearly see the movement of the indices in the new graph, as follows:</p><div><img src="img/7451OS_02_31.jpg" alt="Extending to multiple axes"/></div><p>Moreover, we can <a id="id165" class="indexterm"/>improve the final view by color-matching the series to the axis lines. The <code class="literal">Highcharts.getOptions().colors</code> property contains a list of default colors for the series, so we use the first two entries for our indices. Another improvement is to set <code class="literal">maxPadding</code> for the <em>x</em> axis, because the new y-axis line covers parts of the data points at the high end of the <em>x</em> axis:</p><div><pre class="programlisting">            xAxis: {
                ... ,
                minPadding: 0.02,
                maxPadding: 0.02
                },
            yAxis: [{
                title: {
                    text: 'Nasdaq'
                },
                lineWidth: 2,
                lineColor: '#4572A7',
                tickWidth: 3,
                tickLength: 6,
                tickColor: '#4572A7'
            }, {
                title: {
                    text: 'Dow Jones'
                },
                opposite: true,
                lineWidth: 2,
                lineColor: '#AA4643',
                tickWidth: 3,
                tickLength: 6,
                tickColor: '#AA4643'
            }],</pre></div><p>The following screenshot shows the improved look of the chart:</p><div><img src="img/7451OS_02_32.jpg" alt="Extending to multiple axes"/></div><p>We can extend the <a id="id166" class="indexterm"/>preceding example and have more than a couple of axes, simply by adding entries into the <code class="literal">yAxis</code> and <code class="literal">series</code> arrays, and mapping both together. The following screenshot shows a 4-axis line graph:</p><div><img src="img/7451OS_02_49.jpg" alt="Extending to multiple axes"/></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec17"/>Revisiting the series config</h1></div></div></div><p>By now, we should have<a id="id167" class="indexterm"/> an idea of what the <code class="literal">series</code> property does. In this section, we are going to examine it in more detail.</p><p>The <code class="literal">series</code> property is an array of series configuration objects that contain data- and series-specific options. It allows us to specify single-series data and multiple-series data. The purpose of series objects is to inform Highcharts of the format of the data and how the data is presented in the chart.</p><p>All data values in the chart are specified through the <code class="literal">data</code> field. The <code class="literal">data</code> field is highly flexible and can take an array in a number of forms, as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Numerical values</li><li class="listitem" style="list-style-type: disc">An array with <em>x</em> and <em>y</em> values</li><li class="listitem" style="list-style-type: disc">A point object with properties describing the data point</li></ul></div><p>The first two options have already been examined in the <em>Accessing the axis data type</em> section. In this section, we will explore the third option. Let's use the single-series Nasdaq example and we will specify the series data through a mixture of numerical values and objects:</p><div><pre class="programlisting">         series: [{
              name: 'Nasdaq',
              pointStart: Date.UTC(2012, 4, 11, 9, 30),
              pointInterval: 30 * 60 * 1000,
              data: [{ 
                    // First data point
                    y: 2606.01,
                    marker: {
                        symbol: 'url(./sun.png)' 
                        }
                    }, 2622.08, 2636.03, 2637.78, 
                  { 
                    // Highest data point
                    y: 2639.15,
                    dataLabels: {
                        enabled: true
                    },
                    marker: { 
                        fillColor: '#33CC33',
                        radius: 5
                    }
                  }, 2637.09, 2633.38, 2632.23, 2632.33, 
                     2632.59, 2630.34, 2626.89, 2624.59, 
                  {
                    // Last data point
                    y: 2615.98,
                    marker: {
                        symbol: 'url(./moon.png)' 
                        } 
                  }]
            }]</pre></div><p>The first and last data<a id="id168" class="indexterm"/> points are objects that have <em>y</em> axis values and image files to indicate the opening and closing of the market. The highest data point is configured with a different color and data label. The size of the data point is also set slightly larger than the default. The rest of the data arrays are just numerical values, as shown in the following screenshot:</p><div><img src="img/7451OS_02_33.jpg" alt="Revisiting the series config"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec18"/>Exploring PlotOptions</h1></div></div></div><p>The<code class="literal"> plotOptions</code> object<a id="id169" class="indexterm"/> is a wrapper <a id="id170" class="indexterm"/>object for config objects for each series type supported in Highcharts. These configurations have properties such as <code class="literal">plotOptions.line.lineWidth</code>, common to other series types, as well as other configurations such as <code class="literal">plotOptions.pie.center</code> that is only specific to the pie series type. Among the specific series, there is <code class="literal">plotOptions.series</code>, which is used for common plotting options shared by the whole series.</p><p>The preceding <code class="literal">plotOptions</code> object can form a chain of precedence between <code class="literal">plotOptions.series</code>, <code class="literal">plotOptions.{series-type}</code>, and the series configuration. For example, <code class="literal">series[x].shadow</code> (where <code class="literal">series[x].type</code> is <code class="literal">'pie'</code>) has a higher precedence than <code class="literal">plotOptions.pie.shadow</code>, which in turn has a higher precedence than <code class="literal">plotOptions.series.shadow</code>.</p><p>The purpose of this is that <a id="id171" class="indexterm"/>the chart is composed of multiple different series types. For example, in a chart with multiple series of columns and a single line series, the common properties between column and line can be defined in <code class="literal">plotOptions.series.*</code>, whereas <code class="literal">plotOptions.column</code> and <code class="literal">plotOptions.line</code> hold their own specific property values. Moreover, properties in <code class="literal">plotOptions.{series-type}.*</code> can be further overridden by the same series type specified in the series array.</p><p>The following is a reference for the configurations in precedence. The higher-level ones have lower precedence, which means that configurations defined in the lower level of the chain can override properties defined in the higher level of the chain. For the series array, the preference is valid if <code class="literal">series[x].type</code> or the default series type value is the same as the series type in <code class="literal">plotOptions</code>:</p><div><pre class="programlisting">chart.type
    series[x].type

plotOptions.series.{seriesProperty}
    plotOptions.{series-type}.{seriesProperty}
        series[x].{seriesProperty}

plotOptions.points.events.*
       series[x].data[y].events.*

plotOptions.series.marker.*
       series[x].data[y].marker.*</pre></div><p>The <code class="literal">plotOptions</code> object contains <a id="id172" class="indexterm"/>properties controlling how a series type is presented in the chart—for example inverted charts, series colors, stacked column charts, user interactions with the series, and so on. All these options will be covered in detail when we study each type of chart. Meanwhile, we will explore the concept of <code class="literal">plotOptions</code> with a monthly Nasdaq graph. The graph has five different series data types: open, close, high, low, and volume. Normally, this data is used for plotting daily stock charts (OHLCV). We compact them into a single chart for the purpose of demonstrating <code class="literal">plotOptions</code>.</p><div><img src="img/7451OS_02_34.jpg" alt="Exploring PlotOptions"/></div><p>The following is the chart<a id="id173" class="indexterm"/> configuration code for generating the preceding graph:</p><div><pre class="programlisting">            chart: {
                renderTo: 'container',
                height: 250,
                spacingRight: 30
            },
            title: {
                text: 'Market Data: Nasdaq 100'
            },
            subtitle: {
                text: '2011 - 2012'
            },
            xAxis: {
                categories: [ 'Jan', 'Feb', 'Mar', 'Apr', 
                              'May', 'Jun', 'Jul', 'Aug', 
                              'Sep', 'Oct', 'Nov', 'Dec' ],
                labels: {
                    y: 17
                },
                gridLineDashStyle: 'dot',
                gridLineWidth: 1,
                lineWidth: 2,
                lineColor: '#92A8CD',
                tickWidth: 3,
                tickLength: 6,
                tickColor: '#92A8CD',
                minPadding: 0.04,
                offset: 1
            },
            yAxis: [{
                title: {
                    text: 'Nasdaq index'
                },
                min: 2000,               
                minorGridLineColor: '#D8D8D8',
                minorGridLineDashStyle: 'dashdot',
                gridLineColor: '#8AB8E6',
                alternateGridColor: {
                    linearGradient: {
                        x1: 0, y1: 1,
                        x2: 1, y2: 1
                    },
                    stops: [ [0, '#FAFCFF' ],                      
                             [0.5, '#F5FAFF'] ,
                             [0.8, '#E0F0FF'] ,
                             [1, '#D6EBFF'] ]
                },
                lineWidth: 2,
                lineColor: '#92A8CD',
                tickWidth: 3,
                tickLength: 6,
                tickColor: '#92A8CD'
            }, {
                title: {
                    text: 'Volume'
                },
                lineWidth: 2,
                lineColor: '#3D96AE',
                tickWidth: 3,
                tickLength: 6,
                tickColor: '#3D96AE',
                opposite: true
            }],
            credits: {
                enabled: false
            },
            plotOptions: {
                column: {
                    stacking: 'normal'
                },
                line: {
                    zIndex: 2,
                    marker: {
                        radius: 3,
                        lineColor: '#D9D9D9',
                        lineWidth: 1
                    },
                    dashStyle: 'ShortDot'
                }
            },
            series: [{
              name: 'Monthly High',
              // Use stacking column chart - values on 
              // top of monthly low to simulate monthly
              // high
              data: [ 98.31, 118.08, 142.55, 160.68, ... ],
              type: 'column',
              color: '#4572A7'
            }, {
              name: 'Monthly Low',
              data: [ 2237.73, 2285.44, 2217.43, ... ],
              type: 'column',
              color: '#AA4643'
            }, {
              name: 'Open (Start of the month)',
              data: [ 2238.66, 2298.37, 2359.78, ... ],
              color: '#89A54E'
            }, {
              name: 'Close (End of the month)',
              data: [ 2336.04, 2350.99, 2338.99, ... ],
              color: '#80699B'
            }, {
              name: 'Volume',
              data: [ 1630203800, 1944674700, 2121923300, ... ],
              yAxis: 1,
              type: 'column',
              stacking: null,
              color: '#3D96AE'
            }]
        }</pre></div><p>Although the graph looks <a id="id174" class="indexterm"/>slightly complicated, we will go through the code step-by-step. First, there are two entries in the <code class="literal">yAxis</code> array: the first is for the Nasdaq index; the second y axis, displayed on the right-hand side (<code class="literal">opposite: true</code>), is for the volume trade. In the series array, the first and second series are specified as column series types (<code class="literal">type: 'column'</code>), which override the default series type <code class="literal">'line'</code>. Then the <code class="literal">stacking</code> option is defined as <code class="literal">'normal'</code> in <code class="literal">plotOptions.column</code>, which stacks the monthly high on top of the monthly low column (deep blue and black columns). Strictly speaking, the stacked column chart is used for displaying the ratio of data belonging to the same category. For the sake of demonstrating <code class="literal">plotOptions</code>, we used the stacked column chart to show the upper and lower ends of monthly trade. To do that, we take the difference between monthly high and monthly low and substitute the differences back into the monthly high series. So in the code, we can see that the data values in the monthly high series are much smaller than the monthly low.</p><p>The third and fourth series are the market open and market close index. Both take the default line series type and inherit options defined from <code class="literal">plotOptions.line</code>. The <code class="literal">zIndex</code> option is assigned to <code class="literal">2</code> to overlay both line series on top of the fifth volume series; otherwise, both lines are covered by the volume columns. The <code class="literal">marker</code> object configurations are to reduce the default data point size, as the whole graph is already compacted with columns and lines.</p><p>The last column series is the volume trade, and the <code class="literal">stacking</code> option in the series is manually set to <code class="literal">null</code>, which overrides the inherited option from <code class="literal">plotOptions.column</code>. This resets the series back to the non-stacking option, displaying as a separate column. Finally, the <code class="literal">yAxis</code> index option is<a id="id175" class="indexterm"/> set to align with the y axis of the volume series (<code class="literal">yAxis: 1</code>).</p></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec19"/>Styling tooltips</h1></div></div></div><p>Tool tips in <a id="id176" class="indexterm"/>Highcharts are enabled by the <code class="literal">tooltip.enabled</code> Boolean option, which is <code class="literal">true</code> by default. In Highcharts 4, the default shape of the tooltip box has been changed to callout. The following shows the new style of tooltip:</p><div><img src="img/7451OS_02_57.jpg" alt="Styling tooltips"/></div><p>For the older style of tooltip shape, we can set the <code class="literal">tooltip.shape</code> option to <code class="literal">square</code>, which we will use in the following exercises.</p><p>Tooltip's content<a id="id177" class="indexterm"/> formats are flexible, which can be defined via a callback handler or in the HTML style. We will continue from the example in the previous section. As the chart is packed with multiple lines and columns, we can first enable the crosshair tool tip to help us align the data points onto the axes. The <code class="literal">crosshairs</code> configuration can take either a Boolean value to activate the feature or an object style for the crosshair line style. The following is the code snippet to set up crosshairs with an array of x- and y-axis configurations for the gray color and dash line styles:</p><div><pre class="programlisting">            tooltip : {
                shape: 'square',
                crosshairs: [{
                     color: '#5D5D5D',
                     dashStyle: 'dash',
                     width: 2
                }, {
                     color: '#5D5D5D',
                     dashStyle: 'dash',
                     width: 2
                }]
            },</pre></div><div><div><h3 class="title"><a id="note07"/>Note</h3><p>Again, the <code class="literal">dashStyle</code> option uses the same common line style values in Highcharts. See the crosshairs reference manual for all the possible values.</p></div></div><p>The following screenshot shows the view when hovering over a data point in the market close series. We see a tool tip box appear next to the pointer and gray crosshairs for both axes:</p><div><img src="img/7451OS_02_35.jpg" alt="Styling tooltips"/></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec30"/>Formatting tooltips in HTML</h2></div></div></div><p>Highcharts provides <a id="id178" class="indexterm"/>template options such as <code class="literal">headerFormat</code>, <code class="literal">pointFormat</code>, and <code class="literal">footerFormat</code> to construct the tool tip by specific template variables (or macros). These<a id="id179" class="indexterm"/> specific variables are series and point, and we can use their properties such as <code class="literal">point.x</code>, <code class="literal">point.y</code>, <code class="literal">series.name</code>, and <code class="literal">series.color</code> within the template. For instance, the default tool tip setting uses <code class="literal">pointFormat</code>, which has the default value of the following code snippet:</p><div><pre class="programlisting">&lt;span style="color:{series.color}"&gt;{series.name}&lt;/span&gt;: &lt;b&gt;{point.y}&lt;/b&gt;&lt;br/&gt;</pre></div><p>Highcharts internally translates the preceding expression into SVG text markups, so only a subset of HTML syntax can be supported, which is <code class="literal">&lt;b&gt;</code>, <code class="literal">&lt;br&gt;</code>, <code class="literal">&lt;strong&gt;</code>, <code class="literal">&lt;em&gt;</code>, <code class="literal">&lt;i&gt;</code>, <code class="literal">&lt;span&gt;</code>, <code class="literal">&lt;href&gt;</code>, and font style attributes in CSS. However, if we want to have more flexibility in polishing the content, and the ability to include image files, we need to use the <code class="literal">useHTML</code> option for full HTML tool tips. This option allows us to do the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Use other HTML tags such as <code class="literal">&lt;img&gt;</code> inside the tool tip</li><li class="listitem" style="list-style-type: disc">Create a tool tip in real HTML content, so that it is outside the SVG markups</li></ul></div><p>Here, we can format an HTML table inside a tool tip. We will use <code class="literal">headerFormat</code> to create a header column for the category and a bottom border to separate the header from the data. Then, we will use <code class="literal">pointFormat</code> to set up an icon image along with the series name and data. The image file is based on the <code class="literal">series.index</code> macro, so different series have different image icons. We use the <code class="literal">series.color</code> macro to highlight the series name with the same color in the chart and apply the <code class="literal">series.data</code> macro for the series value:</p><div><pre class="programlisting">      tooltip : {
         useHTML: true,
         shape: 'square',
         headerFormat: '&lt;table&gt;&lt;thead&gt;&lt;tr&gt;' + 
             '&lt;th style="border-bottom: 2px solid #6678b1; color: #039" ' + 
             'colspan=2 &gt;{point.key}&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;',
         pointFormat: '&lt;tr&gt;&lt;td style="color: {series.color}"&gt;' + 
             '&lt;img src="img/series_{series.index}.png" ' + 
             'style="vertical-align:text-bottom; margin-right: 5px" &gt;' + 
             '{series.name}: &lt;/td&gt;&lt;td style="text-align: right; color: #669;"&gt;' +
             '&lt;b&gt;{point.y}&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;',
         footerFormat: '&lt;/tbody&gt;&lt;/table&gt;'
      },</pre></div><p>When we hover over a data point, the template variable <code class="literal">point</code> is substituted internally for the hovered point object, and the series is replaced by the <code class="literal">series</code> object containing the data point.</p><p>The following is the <a id="id180" class="indexterm"/>screenshot of the new tool tip. The icon next to the series <a id="id181" class="indexterm"/>name indicates market close:</p><div><img src="img/7451OS_02_36.jpg" alt="Formatting tooltips in HTML"/></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec31"/>Using the callback handler</h2></div></div></div><p>Alternatively, we can <a id="id182" class="indexterm"/>implement the tool tip through the callback handler in JavaScript. The tool tip handler is declared through the <code class="literal">formatter</code> option. The major difference between template options and the handler is that we can disable the tool tip display for certain points by setting conditions and returning the Boolean to <code class="literal">false</code>, whereas for template options we cannot. In the callback example, we use the <code class="literal">this.series</code> and <code class="literal">this.point</code> variables for the series name and values for the data point that is hovered over.</p><p>The following is an example of the handler:</p><div><pre class="programlisting">     formatter: function() {                    
          return '&lt;span style="color:#039;font-weight:bold"&gt;' + 
                 this.point.category + 
                 '&lt;/span&gt;&lt;br/&gt;&lt;span style="color:' + 
                 this.series.color + '"&gt;' + this.series.name + 
                 '&lt;/span&gt;: &lt;span style="color:#669;font-weight:bold"&gt;' + 
                 this.point.y + '&lt;/span&gt;';
     }</pre></div><p>The preceding handler code<a id="id183" class="indexterm"/> returns an SVG text tool tip with the series name, category, and value, as shown in the following screenshot:</p><div><img src="img/7451OS_02_37.jpg" alt="Using the callback handler"/></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec32"/>Applying a multiple-series tooltip</h2></div></div></div><p>Another flexible tooltip feature is to <a id="id184" class="indexterm"/>allow all the series data to be displayed inside the same tooltip. This simplifies user interaction by looking up multiple series data in one action. To enable this feature, we need to set the <code class="literal">shared</code> option to <code class="literal">true</code>.</p><p>We will continue with the previous example for a multiple series tooltip. The following is the new tooltip code:</p><div><pre class="programlisting">         shared: true,
         useHTML: true,
         shape: 'square',
         headerFormat: '&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th colspan=2 &gt;' +   
                       '{point.key}&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;',pointFormat:  '&lt;tr&gt;&lt;td style="color: {series.color}"&gt;' +
                       '{series.name}: &lt;/td&gt;' + 
                       '&lt;td style="text-align: right; color: #669;"&gt; ' +
                       '&lt;b&gt;{point.y}&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;',footerFormat: '&lt;/tbody&gt;&lt;/table&gt;'</pre></div><p>The preceding code snippet will produce the following screenshot:</p><div><img src="img/7451OS_02_38.jpg" alt="Applying a multiple-series tooltip"/></div><p>As previously discussed, we<a id="id185" class="indexterm"/> will use the monthly high and monthly low series to plot stacked columns that are actually used for plotting data within the same category. Therefore, the tooltip for the monthly high series is showing the subtracted values that we previously put in. To correct this within the tooltip, we can use the handler to apply different properties for the monthly high series, as follows:</p><div><pre class="programlisting">   shared: true,
   shape: 'square',
   formatter: function() {
       return '&lt;span style="color:#039;font-weight:bold"&gt;' +         
           this.x + '&lt;/span&gt;&lt;br/&gt;' +   
           this.points.map(function(point, idx) {return '&lt;span style="color:' + point.series.color +
                   '"&gt;' + point.series.name + 
                   '&lt;/span&gt;: &lt;span style="color:#669;font-weight:bold"&gt;' + 
                     Highcharts.numberFormat((idx == 0) ? point.total : point.y) + '&lt;/span&gt;';}).join('&lt;br/&gt;');
       }</pre></div><p><code class="literal">point.total</code> is the total of the difference and the monthly low series value. The following screenshot shows the new corrected monthly high value:</p><div><img src="img/7451OS_02_39.jpg" alt="Applying a multiple-series tooltip"/></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec20"/>Animating charts</h1></div></div></div><p>There are two types of<a id="id186" class="indexterm"/> animations in Highcharts: initial and update animations. An initial animation is the animation that happens when the series data is ready and the chart is displayed. An update animation occurs after the initial animation, when the series data or any parts of the chart anatomy have been changed.</p><p>The initial animation configurations can be specified through <code class="literal">plotOptions.series.animation</code> or <code class="literal">plotOptions.{series-type}.animation</code>, whereas the update animation is configured via the <code class="literal">chart.animation</code> property.</p><p>All Highcharts animations use jQuery implementation. The <code class="literal">animation</code> property can be a Boolean value or a set of options. For Boolean values, it is <code class="literal">true</code>. Highcharts can use jQuery for swing animation. These are the options:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">duration</code>: This is the<a id="id187" class="indexterm"/> time, in milliseconds, to complete the animation.</li><li class="listitem" style="list-style-type: disc"><code class="literal">easing</code>: This is the type<a id="id188" class="indexterm"/> of animation jQuery provides. The variety of animations can be extended by importing the jQuery UI plugin. A good <a id="id189" class="indexterm"/>reference can be found at <a class="ulink" href="http://plugindetector.com/demo/easing-jquery-ui/">http://plugindetector.com/demo/easing-jquery-ui/</a>.</li></ul></div><p>Here, we continue the example from the previous section. We will apply the animation settings to <code class="literal">plotOptions.column</code> and <code class="literal">plotOptions.line</code>, as follows:</p><div><pre class="programlisting">            plotOptions: {
                column: {
                    ... ,
                    animation: {
                        duration: 2000,
                        easing: 'swing'
                    }
                },
                line: {
                    .... ,                    
                    animation: {
                        duration: 3000,
                        easing: 'linear'
                    }
                }
            },</pre></div><p>The animations are<a id="id190" class="indexterm"/> tuned into at a much slower pace, so we can see the difference between linear and swing animations. The line series appears at a linear speed along the x axis, whereas the column series expands upwards at a linear speed and then decelerates sharply when approaching the end of the display. The following is a screenshot showing an ongoing linear animation:</p><div><img src="img/7451OS_02_40.jpg" alt="Animating charts"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec21"/>Expanding colors with gradients</h1></div></div></div><p>Highcharts not only supports single<a id="id191" class="indexterm"/> color values, but also allows complex color <a id="id192" class="indexterm"/>gradient definitions. In Highcharts, the color gradient is based on the SVG linear color gradient standard, which is composed of two sets of information as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">linearGradient</code>: This gives a gradient direction for a color spectrum made up of two sets of x and y coordinates; ratio values are between 0 and 1, or in percentages</li><li class="listitem" style="list-style-type: disc"><code class="literal">stops</code>: This gives a sequence of colors to be filled in the spectrum, and their ratio positions within the gradient direction</li></ul></div><p>We can use the previous stock market example with only the volume series, and redefine <code class="literal">yAxis alternateGridColor</code> as follows:</p><div><pre class="programlisting">       yAxis: [{
            title: { text: 'Nasdaq index' },
            ....     

            alternateGridColor: {
                linearGradient: [ 10, 250, 400, 250 ],                       
                    stops: [ 
                           [ 0, 'red' ],
                        [ 0.2, 'orange' ],
                        [ 0.5, 'yellow' ] ,
                        [ 0.8, 'green' ] ,
                        [ 1, 'lime' ] ]
            }</pre></div><p><code class="literal">linearGradient</code> is an<a id="id193" class="indexterm"/> array of coordinate values that are arranged in<a id="id194" class="indexterm"/> the x1, y1, x2, y2 order. The values can be absolute coordinates, percentage strings, or ratio values between 0 and 1. The difference is that colors defined in coordinate values can be affected by the chart size, whereas percentage and ratio values avoid that.</p><div><div><h3 class="title"><a id="note08"/>Note</h3><p>The array syntax for absolute position gradients is deprecated because it doesn't work in the same way in both SVG and VML, it also doesn't scale well with varying chart sizes.</p></div></div><p>The <code class="literal">stops</code> property has an array of tuples: the first value is the offset ranging from 0 to 1 and the second value is the color definition. The offset and color values define where the color is positioned within the spectrum. For example, <code class="literal">[0, 'red' ]</code> and <code class="literal">[0.2, 'orange' ]</code> mean starting with red at the beginning and gradually changing the color to orange in a horizontal direction towards the position at <em>x = 80 (0.2 * 400)</em>, before changing from orange at <em>x = 80</em> to yellow at <em>x = 200</em>, and so on. The following is a screenshot of the multicolor gradient:</p><div><img src="img/7451OS_02_45.jpg" alt="Expanding colors with gradients"/></div><p>As we can see, the red <a id="id195" class="indexterm"/>and orange colors do not appear on the chart because <a id="id196" class="indexterm"/>the gradient is based on coordinates. Hence, depending on the size of the chart, the position of the y axis exceeds the red and orange coordinates in this example. Alternatively, we can specify <code class="literal">linearGradient</code> in terms of percentage, as follows:</p><div><pre class="programlisting">linearGradient: [ '20%', 250, '90%', 250 ]</pre></div><p>This means <code class="literal">linearGradient</code> stretches from <code class="literal">20%</code> of the width of the chart to <code class="literal">90%</code>, so that the color bands are not limited to the size of the chart. The following screenshot shows the effect of the new <code class="literal">linearGradient</code> setting:</p><div><img src="img/7451OS_02_46.jpg" alt="Expanding colors with gradients"/></div><p>The chart background now has the complete color spectrum. As for specifying ratio values between 0 and 1, <code class="literal">linearGradient</code> must be defined in an object style, otherwise the values will be treated as coordinates. Note that the ratio values are referred to as the fraction over the plot area only, and not the whole chart.</p><div><pre class="programlisting">linearGradient: { x1: 0, y1: 0, x2: 1, y2: 0 }</pre></div><p>The preceding line of code is an alternative way to set the horizontal gradient.</p><div><img src="img/7451OS_02_47.jpg" alt="Expanding colors with gradients"/></div><p>The following line of code adjusts the vertical gradient:</p><div><pre class="programlisting"> linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 }</pre></div><p>It produces a gradient background in a vertical direction. We also set the <code class="literal">'Jan'</code> and <code class="literal">'Jul'</code> data points individually as point objects with linear shading in a vertical direction:</p><div><img src="img/7451OS_02_50.jpg" alt="Expanding colors with gradients"/></div><p>Moreover, we can<a id="id197" class="indexterm"/> manipulate Highcharts standard colors to<a id="id198" class="indexterm"/> trigger a color gradient in the series plot. This approach is taken from a post in a Highcharts forum experimenting with the look of 3D charts. Before plotting a chart, we need to overwrite the default series color with a gradient color. The following code snippet replaces the first series color with horizontal blue gradient shading. Note that the ratio gradient values in this example are referring to the width of the series column:</p><div><pre class="programlisting">     $(document).ready(function() {

          Highcharts.getOptions().colors[0] = {
                  linearGradient: { x1: 0, y1: 0, x2: 1, y2: 0 },
                  stops: [ [ 0, '#4572A7' ],
                           [ 0.7, '#CCFFFF' ],
                           [ 1, '#4572A7' ] ]
           };

           var chart = new Highcharts.Chart({  ...</pre></div><p>The following is a screenshot of a <a id="id199" class="indexterm"/>column chart with color<a id="id200" class="indexterm"/> shading:</p><div><img src="img/7451OS_02_48.jpg" alt="Expanding colors with gradients"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec22"/>Zooming data with the drilldown feature</h1></div></div></div><p>Highcharts provides an easy way to <a id="id201" class="indexterm"/>zoom data interactively between two series of<a id="id202" class="indexterm"/> data. This feature is implemented as a separate module. To use the feature, users need to include the following JavaScript:</p><div><pre class="programlisting">&lt;script type="text/javascript" 
 src="img/drilldown.js"&gt;&lt;/script&gt;</pre></div><p>There are two ways to build an interactive drilldown chart: synchronous and asynchronous. The former method requires users to supply both top and detail levels of data in advance, and arrange both levels of data inside the configuration. Both levels of data are specified as standard Highcharts <code class="literal">series</code> configs, except that the zoom-in series is located inside the <code class="literal">drilldown</code> property. To join both levels, the top-level series must provide the option <code class="literal">series.data[x].drilldown</code>, with a matching name to the option <code class="literal">drilldown.series.[y].id</code> in the detail level.</p><p>Let's revisit the web browser statistic example and plot the data in a column chart. We will go through column series in more detail later in the book. The following is the <code class="literal">series</code> config for the top-level data:</p><div><pre class="programlisting">      series: [{
          type: 'column',
          name: 'Web browsers',
          colorByPoint: true,
          data: [{
              name: 'Chrome', y: 55.8, drilldown: 'chrome'
          }, {
              name: 'Firefox', y: 26.8, drilldown: 'firefox',
          }, {
              name: 'Internet Explorer', y: 9, drilldown: 'ie'
          }, {
              name: 'Safari', y: 3.8
          }]
      }],</pre></div><p>Each column is defined with a <code class="literal">drilldown</code> option and assigned a specific name. Note that it is not mandatory to make all the data points zoomable. The preceding example demonstrates the <code class="literal">Safari</code> column without the <code class="literal">drilldown</code> property.</p><p>To correspond to each of the <code class="literal">drilldown</code> assignments, an array of series data (detail level) is configured to match <a id="id203" class="indexterm"/>against the values. The following shows the<a id="id204" class="indexterm"/> setup of the drilldown data:</p><div><pre class="programlisting">            drilldown: {
               series: [{
                    id: 'chrome',
                    name: 'Chrome',
                    data: [{
                        name: 'C 32', y: 1
                    }, {
                        name: 'C 31', y: 49
                    }, {
                                           T.
                    }]
               }, {
                    id: 'firefox',
                    name: 'Firfox',
                    data: [{
                        name: 'FF 26', y: 6.9
                    }, {
                        name: 'FF 25', y: 13.3
                    }, {
                                                    w.
                    }]
                                       ….
               }]
            }</pre></div><p>This produces the following screenshot:</p><div><img src="img/7451OS_02_51.jpg" alt="Zooming data with the drilldown feature"/></div><p>As we can see, the category labels<a id="id205" class="indexterm"/> along the x-axis are decorated in a dark color<a id="id206" class="indexterm"/> and underlined (the default style). They are clickable, and appear different when compared to the non-drilldown column, Safari. When we click on the Firefox column, or the label, the column animates and zooms into multiple columns along with a back button at the top right corner, as shown in the following screenshot:</p><div><img src="img/7451OS_02_52.jpg" alt="Zooming data with the drilldown feature"/></div><p>Let's modify the chart with<a id="id207" class="indexterm"/> more styles. There are properties within <a id="id208" class="indexterm"/>the <code class="literal">drilldown</code> option for smartening the data labels such as <code class="literal">activeAxisLabelStyle</code> and <code class="literal">activeDataLabelStyle</code> that take a configuration object of CSS styles. In the following code, we polish the category labels with features such as hyperlinks, blue color, and underlines. Additionally, we change the cursor style into the browser-specific zoom-in icon:</p><div><div><h3 class="title"><a id="tip04"/>Tip</h3><p>webkit-zoom-in is the browser-specific cursor name for Chrome and Safari; moz-zoom-in/out is for Firefox.</p></div></div><div><pre class="programlisting">            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                     }
                }
            },
            drilldown: {
                activeAxisLabelStyle: {
                    textDecoration: 'none',
                    cursor: '-webkit-zoom-in',
                    color: 'blue'
                },
                activeDataLabelStyle: {
                    cursor: '-webkit-zoom-in',
                    color: 'blue',
                    fontStyle: 'italic'
                },
                series: [{
                    ....
                }]
            }</pre></div><p>The following screenshot shows the new text label style as well as the new cursor icon over the category label:</p><div><img src="img/7451OS_02_53.jpg" alt="Zooming data with the drilldown feature"/></div><p>Another great flexibility in <a id="id209" class="indexterm"/>Highcharts is that the top and detail level charts<a id="id210" class="indexterm"/> are not limited to the same type of series. The drilldown series can be any series best suited for presenting the detail data. This can be accomplished by assigning a different series <code class="literal">type</code> in the detail level. The following is the further code update for the example, in which the Internet Explorer column is zoomed in and presented in a donut (or ring) chart. We also set the data labels for the pie chart to show both the version name and percentage value:</p><div><pre class="programlisting">            plotOptions: {
                column: {
                    ....
                },
                pie: {
                    dataLabels: {
                        enabled: true,
                        format: '{point.name} - {y}%'
                    }
                }
            },
            drilldown: {
                activeAxisLabelStyle: {
                    ....
               },
                activeDataLabelStyle: {
                    ....
               },
               series: [{
                    id: 'ie',
                    name: 'Internet Explorer',
                    type: 'pie',
                    innerSize: '30%',
                    data: [{
                        ....
                    }],
               }, {
                   ....
               }]
          }</pre></div><p>The following is the<a id="id211" class="indexterm"/> screenshot<a id="id212" class="indexterm"/> of the donut chart:</p><div><img src="img/7451OS_02_54.jpg" alt="Zooming data with the drilldown feature"/></div><p>The preceding donut<a id="id213" class="indexterm"/> chart is slightly misleading because the total<a id="id214" class="indexterm"/> value of all the data labels is 9 percent, but the presentation of the donut chart gives the impression of 100 percent in total. In order to clarify that 9 percent is the total value, we can take advantage of the Highcharts Renderer engine (we will explore this further in <a class="link" href="ch05.html" title="Chapter 5. Pie Charts">Chapter 5</a>, <em>Pie Charts</em>) to display an SVG text box in the middle of the ring. However, the <code class="literal">drilldown</code> option only allows us to declare series-specific options. Moreover, we would like the 9 percent text box to appear only when clicking on the 'Internet Explorer' column.</p><p>One trick to achieve that is to use Highcharts events, which will be examined further in <a class="link" href="ch11.html" title="Chapter 11. Highcharts Events">Chapter 11</a>, <em>Highcharts Events</em>. Here, we use the events specific to the <code class="literal">drilldown</code> action. The basic idea is that, when the <code class="literal">drilldown</code> event is triggered, we check the data point being clicked is <strong>Internet Explorer</strong>. If so, then we create a textbox using the chart's renderer engine. In the <code class="literal">drillup</code> event (triggered when the <strong>Back to …</strong> button is clicked), we remove the text box if it exists:</p><div><pre class="programlisting">    chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            events: {
                drilldown: function(event) {
                    // According to Highcharts documentation, 
                    // the clicked data point is embedded inside 
                    // the event object
                    var point = event.point;
                    var chart = point.series.chart;
                    var renderer = chart.renderer;
                    if (point.name == 'Internet Explorer') {
                        // Create SVG text box from 
                        // Highcharts Renderer
                        // chart center position based on
                        // it's dimension
                        pTxt = renderer.text('9%',
                                 (chart.plotWidth / 2) + 
                                 chart.plotLeft - 43, 
                                 (chart.plotHeight / 2) +    
                                 chart.plotTop + 25)
                               .css({
                                   fontSize: '45px',
                                   // Google Font
                                   fontFamily: 'Old Standard TT',
                                   fontStyle: 'italic',
                                   color: 'blue'
                               }).add();
                    }
                },  // drilldown
                drillup: function() {
                    pTxt &amp;&amp; (pTxt = pTxt.destroy());
                }
           }</pre></div><p>Here is the refined<a id="id215" class="indexterm"/> chart with <a id="id216" class="indexterm"/>the textbox centered in the chart:</p><div><img src="img/7451OS_02_55.jpg" alt="Zooming data with the drilldown feature"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec23"/>Summary</h1></div></div></div><p>In this chapter, major configuration components were discussed and experimented with, and examples shown. By now, we should be comfortable with what we have covered already and ready to plot some of the basic graphs with more elaborate styles.</p><p>In the next chapter, we will explore the line, area, and scatter graphs supported by Highcharts. We will apply configurations that we have learned in this chapter and explore the series-specific style options to plot charts in an artistic style.</p></div></body></html>