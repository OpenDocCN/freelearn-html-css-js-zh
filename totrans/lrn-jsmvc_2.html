<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;DocumentJS"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. DocumentJS</h1></div></div></div><p>Source code alone is insufficient; documentation is an important part of software engineering. <span class="strong"><strong>DocumentJS</strong></span> <a id="id85" class="indexterm"/>is a powerful, yet simple tool designed to easily create searchable documentation for any JavaScript codebase.</p><p>In this chapter, we will to get an overview of DocumentJS. We will learn how it works and learn to generate its documentation.</p><p>The following are the key features of <a id="id86" class="indexterm"/>DocumentJS:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Flexible and easy to extend</li><li class="listitem" style="list-style-type: disc">Support Markdown: <a class="ulink" href="http://en.wikipedia.org/wiki/Markdown">http://en.wikipedia.org/wiki/Markdown</a></li><li class="listitem" style="list-style-type: disc">Integrated documentation viewer with API search</li><li class="listitem" style="list-style-type: disc">Works with any JavaScript code and not only with JavaScriptMVC</li></ul></div><p>If you are familiar with JSDoc, YUIDoc, YARD, or similar documentation syntax/tools in then DocumentJS can be learned a, few minutes.</p><p>The documentation for <a id="id87" class="indexterm"/>DocumentJS can be found at <a class="ulink" href="http://javascriptmvc.com/docs.html#!DocumentJS">http://javascriptmvc.com/docs.html#!DocumentJS</a>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note07"/>Note</h3><p><span class="strong"><strong>Markdown</strong></span> is a text-to-HTML <a id="id88" class="indexterm"/>conversion tool that allows you to write using an easy-to-read and easy-to-write plain text format (<a class="ulink" href="http://daringfireball.net/projects/markdown">http://daringfireball.net/projects/markdown</a>).</p></div></div><div class="section" title="How does DocumentJS work?"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec17"/>How does DocumentJS work?</h1></div></div></div><p>The architecture of <a id="id89" class="indexterm"/>DocumentJS is organized around types and tags.</p><p><span class="strong"><strong>Types</strong></span> represent every relatively <a id="id90" class="indexterm"/>
<a id="id91" class="indexterm"/>independent part of the JavaScript code that we may want to comment, such as classes, functions (methods), or attributes.</p><p>Tags provide additional information to types, such as parameters and returns.</p><p>DocumentJS parses JavaScript and <a id="id92" class="indexterm"/>
<a id="id93" class="indexterm"/>Markdown <a id="id94" class="indexterm"/>files to produce JSONP files that are used by JMVCDoc to render documentation.</p></div></div>
<div class="section" title="Writing the documentation"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec18"/>Writing the documentation</h1></div></div></div><p>Let's add a documentation <a id="id95" class="indexterm"/>
<a id="id96" class="indexterm"/>to our <code class="literal">Todo</code> list application in <a class="link" href="ch01.html" title="Chapter 1. Getting Started with JavaScriptMVC">Chapter 1</a>, <span class="emphasis"><em>Getting Started with JavaScriptMVC</em></span>.</p><p>To add the main documentation page, create a Markdown file <code class="literal">todo.md</code> in the <code class="literal">Todo/todo</code> directory with the following content:</p><div class="informalexample"><pre class="programlisting">@page index TodoApp
@description TodoApp is simple todo application.

# TodoApp documentation

Here we can add some more documentation formatted by [Markdown][1]!

[1]: http://daringfireball.net/projects/markdown/syntax "Check out Markdown syntax"</pre></div><p>Then, add these documentation blocks to the <code class="literal">todo.js</code> file:</p><div class="informalexample"><pre class="programlisting">steal(
    'jquery/class',
    'jquery/model',
    'jquery/util/fixture',
    'jquery/view/ejs',
    'jquery/controller',
    'jquery/controller/route',
    function ($) {

        /**
<span class="strong"><strong>         * @class Todo</strong></span>
<span class="strong"><strong>         * @parent index</strong></span>
<span class="strong"><strong>         * @constructor</strong></span>
<span class="strong"><strong>         * @author Wojciech Bednarski</strong></span>
<span class="strong"><strong>         * Creates a new todo.</strong></span>
<span class="strong"><strong>         */</strong></span>
        $.Model('Todo',{

<span class="strong"><strong>                /**</strong></span>
<span class="strong"><strong>                 * @function findAll</strong></span>
<span class="strong"><strong>                 * Get all todos</strong></span>
<span class="strong"><strong>                 * @return {Array} an array contains objects with all todos</strong></span>
<span class="strong"><strong>                 */</strong></span>
                findAll: 'GET /todos',

<span class="strong"><strong>                /**</strong></span>
<span class="strong"><strong>                 * @function findOne</strong></span>
<span class="strong"><strong>                 * Get todo by id</strong></span>
<span class="strong"><strong>                 * @return {Object} an objects contains single todo</strong></span>
<span class="strong"><strong>                 */</strong></span>
                findOne: 'GET /todos/{id}',

<span class="strong"><strong>                /**</strong></span>
<span class="strong"><strong>                 * @function create</strong></span>
<span class="strong"><strong>                 * Create todo</strong></span>
<span class="strong"><strong>                 * @param {Object} todo</strong></span>
<span class="strong"><strong>                 * Todo object</strong></span>
<span class="strong"><strong>                 * @codestart</strong></span>
<span class="strong"><strong>                 * {name: 'read a book by Alfred Szklarski'}</strong></span>
<span class="strong"><strong>                 * @codeend</strong></span>
<span class="strong"><strong>                 *</strong></span>
<span class="strong"><strong>                 * @return {Object} an object contains newly created todo</strong></span>
<span class="strong"><strong>                 * @codestart</strong></span>
<span class="strong"><strong>                 * {</strong></span>
<span class="strong"><strong>                 *     id:   577,</strong></span>
<span class="strong"><strong>                 *     name: 'read a book by Alfred Szklarski'</strong></span>
<span class="strong"><strong>                 * }</strong></span>
<span class="strong"><strong>                 * @codeend</strong></span>
<span class="strong"><strong>                 *</strong></span>
<span class="strong"><strong>                 * ### Example:</strong></span>
<span class="strong"><strong>                 * @codestart</strong></span>
<span class="strong"><strong>                 * var todo = new Todo({name: 'read a book by Alfred Szklarski'});</strong></span>
<span class="strong"><strong>                 * todo.save(function (todo) {</strong></span>
<span class="strong"><strong>                 *     console.log(todo);</strong></span>
<span class="strong"><strong>                 * });</strong></span>
<span class="strong"><strong>                 * @codeend</strong></span>
<span class="strong"><strong>                 */</strong></span>
                create:  'POST /todos',

<span class="strong"><strong>                /**</strong></span>
<span class="strong"><strong>                 * @function update</strong></span>
<span class="strong"><strong>                 * Update todo by id</strong></span>
<span class="strong"><strong>                 * @return {Object} an object contains updated todo</strong></span>
<span class="strong"><strong>                 */</strong></span>
                update:  'PUT /todos/{id}',

<span class="strong"><strong>                /**</strong></span>
<span class="strong"><strong>                 * @function destroy</strong></span>
<span class="strong"><strong>                 * Destroy todo by id</strong></span>
<span class="strong"><strong>                 * @return {Object} an object contains destroyed todo</strong></span>
<span class="strong"><strong>                 */</strong></span>
                destroy: 'DELETE /todos/{id}'
            },
            {

            }
        );

        // Fixtures
        (function () {
            var TODOS = [
                // list of todos
                {
                    id:   1,
                    name: 'read The Good Parts'
                },
                {
                    id:   2,
                    name: 'read Pro Git'
                },
                {
                    id:   3,
                    name: 'read Programming Ruby'
                }
            ];

            // findAll
            $.fixture('GET /todos', function () {
                return [TODOS];
            });

            // findOne
            $.fixture('GET /todos/{id}', function (orig) {
                return TODOS[(+orig.data.id) - 1];
            });

            // create
            var id = 4;
            $.fixture('POST /todos', function () {
                return {
                    id: (id++)
                };
            });

            // update
            $.fixture('PUT /todos/{id}', function () {
                return {};
            });

            // destroy
            $.fixture('DELETE /todos/{id}', function () {
                return {};
            });
        }());

<span class="strong"><strong>        /**</strong></span>
<span class="strong"><strong>         * @class Todos</strong></span>
<span class="strong"><strong>         * Creates a new Todos controller</strong></span>
<span class="strong"><strong>         * @parent index</strong></span>
<span class="strong"><strong>         * @constructor</strong></span>
<span class="strong"><strong>         * @param {String} DOMElement DOM element</strong></span>
<span class="strong"><strong>         * @return {Object}</strong></span>
<span class="strong"><strong>         */</strong></span>
        $.Controller('Todos', {
            // init method is called when new instance is created
            'init': function (element, options) {
                this.element.html('todos.ejs', Todo.findAll());
            },

            // add event listener to strong element on click
            'li strong click': function (el, e) {
                // trigger custom event
                el.trigger('selected', el.closest('li').model());

                // log current model to the console
                console.log('li strong click', el.closest('.todo').model());
            },

            // add event listener to em element on click
            'li .destroy click': function (el, e) {
                // call destroy on the model to prevent memory leaking
                el.closest('.todo').model().destroy();
            },

            // add event listener to Todo model on destroyed
            '{Todo} destroyed': function (Todo, e, destroyedTodo) {
                // remove element from the DOM tree
                destroyedTodo.elements(this.element).remove();

                console.log('destroyed: ', destroyedTodo);
            }
        });

<span class="strong"><strong>        /**</strong></span>
<span class="strong"><strong>         * @class Routing</strong></span>
<span class="strong"><strong>         * Creates application router</strong></span>
<span class="strong"><strong>         * @parent index</strong></span>
<span class="strong"><strong>         * @constructor</strong></span>
<span class="strong"><strong>         * @param {String} DOMElement DOM element</strong></span>
<span class="strong"><strong>         * @return {Object}</strong></span>
<span class="strong"><strong>         */</strong></span>
        $.Controller('Routing', {
            init: function () {
                new Todos('#todos');
            },

            // the index page
            'route': function () {
                console.log('default route');
            },

            // handle URL witch hash
            ':id route': function (data) {
                Todo.findOne(data, $.proxy(function (todo) {
                    // increase font size for current todo item
                    todo.elements(this.element).animate({fontSize: '125%'}, 750);
                }, this));
            },

            // add event listener on selected
            '.todo selected':  function (el, e, todo) {
                // pass todo id as a parameter to the router
                $.route.attr('id', todo.id);
            }
        });

        // create new Routing controller instance
        new Routing(document.body);
    }
);</pre></div><div class="section" title="Type directives"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec16"/>Type directives</h2></div></div></div><p>Type directives represent <a id="id97" class="indexterm"/>
<a id="id98" class="indexterm"/>JavaScript constructs that you may want to document:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">@page</code>: This adds a <a id="id99" class="indexterm"/><a id="id100" class="indexterm"/>standalone page</li><li class="listitem" style="list-style-type: disc"><code class="literal">@attribute</code>: These are the <a id="id101" class="indexterm"/><a id="id102" class="indexterm"/>document values on an object</li><li class="listitem" style="list-style-type: disc"><code class="literal">@function</code>: These are <a id="id103" class="indexterm"/><a id="id104" class="indexterm"/>document functions</li><li class="listitem" style="list-style-type: disc"><code class="literal">@class</code>: This documents a <a id="id105" class="indexterm"/><a id="id106" class="indexterm"/>class</li><li class="listitem" style="list-style-type: disc"><code class="literal">@prototype</code>: This is added to <a id="id107" class="indexterm"/><a id="id108" class="indexterm"/>the previous class or a constructor's prototype functions</li><li class="listitem" style="list-style-type: disc"><code class="literal">@static</code>: This is added to the <a id="id109" class="indexterm"/><a id="id110" class="indexterm"/>previous class or constructor's static functions</li><li class="listitem" style="list-style-type: disc"><code class="literal">@add</code>: This adds the docs to a <a id="id111" class="indexterm"/><a id="id112" class="indexterm"/>class or constructor described in another file</li></ul></div></div><div class="section" title="Tag directives"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec17"/>Tag directives</h2></div></div></div><p>Tag directives provide <a id="id113" class="indexterm"/>additional information to the comments:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">@alias</code>: This specifies other <a id="id114" class="indexterm"/><a id="id115" class="indexterm"/>commonly used names for class or constructor</li><li class="listitem" style="list-style-type: disc"><code class="literal">@author</code>: This specifies the <a id="id116" class="indexterm"/><a id="id117" class="indexterm"/>author of a class</li><li class="listitem" style="list-style-type: disc"><code class="literal">@codestart</code>: This <a id="id118" class="indexterm"/><a id="id119" class="indexterm"/>specifies the start of a code block</li><li class="listitem" style="list-style-type: disc"><code class="literal">@codeend</code>: This specifies <a id="id120" class="indexterm"/><a id="id121" class="indexterm"/>end of a code block</li><li class="listitem" style="list-style-type: disc"><code class="literal">@constructor</code>: This <a id="id122" class="indexterm"/><a id="id123" class="indexterm"/>documents a contractor function and its parameters</li><li class="listitem" style="list-style-type: disc"><code class="literal">@demo</code>: This is the <a id="id124" class="indexterm"/><a id="id125" class="indexterm"/>placeholder for an application demo</li><li class="listitem" style="list-style-type: disc"><code class="literal">@description</code>: This is <a id="id126" class="indexterm"/><a id="id127" class="indexterm"/>used to add a short description</li><li class="listitem" style="list-style-type: disc"><code class="literal">@download</code>: This is used to <a id="id128" class="indexterm"/><a id="id129" class="indexterm"/>adds download link</li><li class="listitem" style="list-style-type: disc"><code class="literal">@iframe</code>: This is used to add <a id="id130" class="indexterm"/><a id="id131" class="indexterm"/>an iframe with example code</li><li class="listitem" style="list-style-type: disc"><code class="literal">@hide</code>: This hides the <a id="id132" class="indexterm"/><a id="id133" class="indexterm"/>class view</li><li class="listitem" style="list-style-type: disc"><code class="literal">@inherits</code>: This specifies what <a id="id134" class="indexterm"/><a id="id135" class="indexterm"/>the Class or Constructor inherits</li><li class="listitem" style="list-style-type: disc"><code class="literal">@parent</code>: This specifies <a id="id136" class="indexterm"/><a id="id137" class="indexterm"/>under which parent the current type should be located</li><li class="listitem" style="list-style-type: disc"><code class="literal">@param</code>: This specifies a <a id="id138" class="indexterm"/><a id="id139" class="indexterm"/>function parameter</li><li class="listitem" style="list-style-type: disc"><code class="literal">@plugin</code>: This specifies a <a id="id140" class="indexterm"/><a id="id141" class="indexterm"/>plugin by which an object gets stolen</li><li class="listitem" style="list-style-type: disc"><code class="literal">@return</code>: This specifies <a id="id142" class="indexterm"/><a id="id143" class="indexterm"/>what a function returns</li><li class="listitem" style="list-style-type: disc"><code class="literal">@scope</code>: This forces the current <a id="id144" class="indexterm"/><a id="id145" class="indexterm"/>type to start the scope</li><li class="listitem" style="list-style-type: disc"><code class="literal">@tag</code>: This specifies <a id="id146" class="indexterm"/><a id="id147" class="indexterm"/>the tags for searching</li><li class="listitem" style="list-style-type: disc"><code class="literal">@test</code>: This specifies the <a id="id148" class="indexterm"/><a id="id149" class="indexterm"/>links for test cases</li><li class="listitem" style="list-style-type: disc"><code class="literal">@type</code>: This sets the type <a id="id150" class="indexterm"/><a id="id151" class="indexterm"/>for <a id="id152" class="indexterm"/>the current commented code</li><li class="listitem" style="list-style-type: disc"><code class="literal">@image</code>: This adds an <a id="id153" class="indexterm"/><a id="id154" class="indexterm"/>image</li></ul></div></div></div>
<div class="section" title="Generating the documentation"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec19"/>Generating the documentation</h1></div></div></div><p>All we need to do to generate the <a id="id155" class="indexterm"/>documentation is run the <code class="literal">doc</code> command from the command line (inside the <code class="literal">Todo</code> directory):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ./documentjs/doc todo</strong></span>
<span class="strong"><strong>PROCESSING SCRIPTS</strong></span>

<span class="strong"><strong>  todo/todo.js</strong></span>
<span class="strong"><strong>  todo/todo.md</strong></span>

<span class="strong"><strong>GENERATING DOCS -&gt; todo/docs</strong></span>

<span class="strong"><strong>Using default page layout.  Overwrite by creating: todo/summary.ejs</strong></span>
</pre></div><p>This generates the documentation, which we can browse by opening <code class="literal">docs.html</code> located in the <code class="literal">Todo/todo</code> directory:</p><div class="mediaobject"><img src="graphics/0205_02_01.jpg" alt="Generating the documentation"/></div><p>We can customize the look and feel of the <a id="id156" class="indexterm"/>documentation by changing the <code class="literal">summary.ejs</code> template file. Simply copy the template from <code class="literal">documentjs/jmvcdoc</code> to <code class="literal">Todo/todo</code> and modify it.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec20"/>Summary</h1></div></div></div><p>In this chapter, we have learned what it DocumentJS is and how to write and generate its documentation. </p><p>One good habit that every programmer should have is that he or she must document the codebase and keep it up to date.</p></div></body></html>