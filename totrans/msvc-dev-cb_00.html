<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Preface</h1>
                </header>
            
            <article>
                


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Why microservices?</h1>
                </header>
            
            <article>
                
<p><span class="author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">Microservices has become an increasingly popular subject over the last few years. As with any new architectural concept, there is plenty of room for misunderstanding. Even the term microservices is confusing. Newcomers are often unsure about the appropriate size of a microservice</span> <span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z h-lparen">(</span><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">hint: it's not actually about the size of the code base) and can get stuck on how to get started with this architectural style.</span></p>
<p><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">Service-oriented architectures are nothing new. Web services were being promoted by various companies in the 1990s as a solution to large, inflexible code bases. The promise was that web services would provide reusable capabilities that could be easily consumed by your code bases. Technologies such as SOAP and WSDL started gaining adoption, but never seemed to deliver on the ease of use promise. Meanwhile, open source languages such as PHP, Ruby, and Python with frameworks such as Symfony, Rails, and Django made developing monolithic web-centric code bases easier.</span></p>
<p><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">Fast forward a couple of decades and we started seeing a renewed interest in services. So, what's changed? For one, with the advent of rich web and mobile applications, every system is now a distributed system. Thanks to the advent of cloud computing, compute and storage resources are cheaper than they've ever been. Containers are changing the way we think about deploying and operating our services. Many consumer services are outgrowing their monolithic code bases, and teams are finding them hard to scale. Microservices can help with many of these challenges.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Microservice prerequisites</h1>
                </header>
            
            <article>
                
<p><span class="author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">Microservices aren't a panacea. While they have many benefits</span> <span class="author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z h-lparen">(</span><span class="author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">which we'll discuss later), they also introduce some specific challenges. Before deciding to make the move to microservices, it's important to have certain infrastructure and tooling in place. Martin Fowler has written about Microservices Prerequisites (<a href="https://martinfowler.com/bliki/MicroservicePrerequisites.html">https://martinfowler.com/bliki/MicroservicePrerequisites.html</a>)</span><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">, as has Phil Calcado (<a href="http://philcalcado.com/2017/06/11/calcados_microservices_prerequisites.html">http://philcalcado.com/2017/06/11/calcados_microservices_prerequisites.html</a></span><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">)</span><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">. I won't repeat what others have written; instead, I will just say that it pays to have a certain amount of automation and monitoring in place before you start developing microservices. Your teams should be comfortable sharing on-call duties and you should have a system for managing alerts and escalations, such as PagerDuty (<a href="http://pagerduty.com/">http://pagerduty.com/</a>)</span><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Microservices benefits</h1>
                </header>
            
            <article>
                
<p>The various benefits of microservices are as discussed in the next sections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Scaling</h1>
                </header>
            
            <article>
                
<p><span class="author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">In a monolithic code base, scaling is an</span> <span class="author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">all-or-nothing approach. Microservices make it easier to scale separate parts of your application based on their own needs. For example, you might have a particular part of your application that is in the critical path of every user request</span> <span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z h-lparen">(</span><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">that is, authentication/authorization services), whereas other parts are only used by a subset of your users</span> <span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z h-lparen">(</span><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">that is, search or messaging). Different traffic patterns will translate to different scaling needs and different techniques that should be used to scale a service. A service that requires a read for every request from a user should use a data store that makes reads cheap. Services that do not need to provide strongly consistent results can take advantage of extensive caching. </span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Team organization</h1>
                </header>
            
            <article>
                
<p><span class="author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">When teams of engineers are working on separate code bases with separate deployments, they are able to make a lot of decisions independently, without the need to coordinate with other teams in the organization. This means that engineers are free to commit code, design their own code review processes, and deploy to production without always needing to coordinate. In a monolith, it's not uncommon for engineers to have to get their changes into a queue that is then deployed at a set time with changes from other teams. If something goes wrong</span> <span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z h-lparen">(</span><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">poison deploys are one of the most common causes of outages), then the whole change set gets rolled back, delaying work by multiple teams. Microservices help you avoid this by allowing teams to move with more autonomy.</span></p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reliability</h1>
                </header>
            
            <article>
                
<p><span class="author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">When a monolith fails, it tends to fail completely. A database is unavailable, and then the application tries to use stale connections in a connection pool, eventually the threads or processes serving requests lock up, and users are left with a white screen of death or a inoperable mobile application. Microservices allow you to decide on a case-by-case basis how a failure in a particular part of your application should be treated. If your service cannot reach a database, perhaps it's better to return a stale cache, or an empty response. If your service has to throw up its hands and start returning HTTP 503 responses, upstream services can respond by applying back pressure, allowing the service to catch up. Microservices give you much more freedom to isolate failures in your system, resulting in a happier experience for your users.</span></p>
<p><span class=" author-d-4z65zz66zl57z75zyiz66zfr2fz87zwz89znujgz72zva2qurwfz69zz78zz74zp0mz88zdz68z0hz89zmz65zz78zz86zlsz84z">This book will serve as a handy reference for many of the subjects that will come up as you develop microservices. We'll start with recipes that will help you make the transition from a monolith to a suite of microservices. Subsequent chapters will address specific areas or challenges that come up when choosing how best to architect and manage your microservices. Recipes that cover code will include working, simple, tested examples that you can use in your own applications. My hope is that this book will help you think about, plan, and execute the development of microservice-based applications. Enjoy!</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Who this book is for</h1>
                </header>
            
            <article>
                
<p>I<span class="sugar_field">f you are a developer who would like to build effective and scalable microservices, then this book is for you. Basic knowledge of the microservices architecture is assumed.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">What this book covers</h1>
                </header>
            
            <article>
                
<p><a href="d5b36f18-79eb-4c0a-bbde-3e94733ef97c.xhtml">Chapter 1</a>, <em>Breaking the Monolith</em><span>, shows how to make the transition from monolith to microservices, with the recipes focused on architectural design.</span> You'll learn how to manage some of the initial challenges when you begin to develop features using this new architectural style.</p>
<p><a href="ab796ed6-2bb5-4fc1-b6db-6283ab5c54b4.xhtml">Chapter 2</a>, <em>Edge Services</em><span>, teaches you how to use open source software to expose your services to the public internet, control routing, extend your service's functionality, and handle a number of common challenges when deploying and scaling microservices.</span></p>
<p><span> </span><a href="f17e8591-c928-44a7-b4b3-fb1f0bf9fcfe.xhtml">Chapter 3</a>, <em>Inter-Service Communication</em><span>, discusses recipes that will enable you to confidently handle the various kinds of interactions we're bound to require in a microservice architecture.</span></p>
<p><a href="21f75d15-5ff8-42f7-b96c-281dcfa2e008.xhtml">Chapter 4</a>, <span><em>Client Patterns</em>, discusses techniques for modeling dependent service calls and aggregating responses from various services to create client-specific APIs. We'll also discuss managing different microservices environments and making RPC consistent with JSON and HTTP, as well as the gRPC and Thrift binary protocols.</span></p>
<p><a href="b569ef24-285f-40bf-97b0-0ac9c1a79494.xhtml">Chapter 5</a>, <em>Reliability Patterns</em><span>, discusses a number of useful reliability patterns that can be used when designing and building microservices to prepare for and reduce the impact of system failures, both expected and unexpected.<br/></span></p>
<p><a href="5c67f295-78fb-4ae9-a596-39f384f6e9f2.xhtml">Chapter 6</a>, <em>Security</em><span>, includes recipes that will help you learn a number of good practices to consider when building, deploying, and operating microservices.<br/></span></p>
<p><a href="fc3632cc-83c0-44ff-b11d-87f556f7b46b.xhtml">Chapter 7</a>, <em>Monitoring and Observability</em><span>, introduces several tenants of monitoring and observability. We'll demonstrate how to modify our services to emit structured logs. We'll also take a look at metrics, using a number of different systems for collecting, aggregating, and visualizing metrics. </span></p>
<p><a href="1bd9cb03-f167-4c1c-9351-cf55eccd97cc.xhtml">Chapter 8</a>, <em>Scaling</em><span>, discusses load testing using different tools. We will also set up auto-scaling groups in AWS, making them scalable on demand. This will be followed by strategies for capacity planning.<br/></span></p>
<p><a href="f38de7a8-a845-4594-9d66-8402e9f0c14b.xhtml"/><a href="f38de7a8-a845-4594-9d66-8402e9f0c14b.xhtml">Chapter 9</a>, <em>Deploying Microservices</em><span>, discusses containers, orchestration, and scheduling, and various methods for safely shipping changes to users. The recipes in this chapter should serve as a good starting point, especially if you're accustomed to deploying monoliths on virtual machines or bare metal servers.<br/></span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">To get the most out of this book</h1>
                </header>
            
            <article>
                
<p>This books assumes basic knowledge of microservices architectures. Other instructions are mentioned in the respective recipes as needed.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Download the example code files</h1>
                </header>
            
            <article>
                
<p>You can download the example code files for this book from your account at <a href="http://www.packtpub.com">www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a href="http://www.packtpub.com/support" target="_blank">www.packtpub.com/support</a> and register to have the files emailed directly to you.</p>
<p class="mce-root"/>
<p>You can download the code files by following these steps:</p>
<ol>
<li>Log in or register at <a href="http://www.packtpub.com/support" target="_blank">www.packtpub.com</a>.</li>
<li>Select the <span class="packt_screen">SUPPORT</span> tab.</li>
<li>Click on <span class="packt_screen">Code Downloads &amp; Errata</span>.</li>
<li>Enter the name of the book in the <span class="packt_screen">Search</span> box and follow the onscreen instructions.</li>
</ol>
<p>Once the file is downloaded, please make sure that you unzip or extract the folder using the latest version of:</p>
<ul>
<li>WinRAR/7-Zip for Windows</li>
<li>Zipeg/iZip/UnRarX for Mac</li>
<li>7-Zip/PeaZip for Linux</li>
</ul>
<p><span>The code bundle for the book is also hosted on GitHub at</span> <a href="https://github.com/PacktPublishing/Microservices-Development-Cookbook">https://github.com/PacktPublishing/Microservices-Development-Cookbook</a><span>. We also have other code bundles from our rich catalog of books and videos available at</span> <strong><span class="Object"><a href="https://github.com/PacktPublishing/" target="_blank">https://github.com/PacktPublishing/</a></span></strong><span>. Check them out!</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Conventions used</h1>
                </header>
            
            <article>
                
<p>There are a number of text conventions used throughout this book.</p>
<p><kbd>CodeInText</kbd>: <span>Indicates c</span>ode words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. <span>Here is an example:</span> "<span>Open the newly created service object in the </span><kbd>app/services/attachments_service.rb</kbd> <span>file and move the responsibility for uploading the file to the</span> <kbd>AttachmentsService#upload</kbd> <span>method.</span>"</p>
<p>A block of code is set as follows:</p>
<pre style="color: black">class AttachmentsService<br/><br/>  def upload(message_id, user_id, file_name, data, media_type)<br/>    message = Message.find_by!(message_id, user_id: user_id)<br/>    file = StorageBucket.files.create(<br/>      key:  file_name,<br/>      body: StringIO.new(Base64.decode64(data), 'rb'),<br/>      public: true<br/>    )</pre>
<p class="mce-root"/>
<p>Any command-line input or output is written as follows:</p>
<pre style="color: black;padding-left: 30px"><strong>brew install docker-compose</strong></pre>
<p><strong>Bold</strong>: Indicates a new term, an important word, or w<span>ords that you see onscreen. For example, words in menus or dialog boxes appear in the text like this. Here is an example: "Installing and managing a Kubernetes cluster is beyond the scope of this book. Luckily, a project called <strong>Minikube</strong> allows you to easily run a single-node Kubernetes cluster on your development machine.</span><span>"</span></p>
<div class="packt_infobox">Warnings or important notes appear like this.</div>
<div class="packt_tip">Tips and tricks appear like this.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Sections</h1>
                </header>
            
            <article>
                
<p>In this book, you will find several headings that appear frequently (<em>Getting ready</em>, <em>How to do it...</em>).</p>
<p>To give clear instructions on how to complete a recipe, use these sections as follows:</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This section tells you what to expect in the recipe and describes how to set up any software or any preliminary settings required for the recipe.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>This section contains the steps required to follow the recipe.</p>
<p> </p>
<p> </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Get in touch</h1>
                </header>
            
            <article>
                
<p>Feedback from our readers is always welcome.</p>
<p class="mce-root"><strong>General feedback</strong>: Email <kbd>feedback@packtpub.com</kbd> and mention the book title in the subject of your message. If you have questions about any aspect of this book, please email us at <kbd>questions@packtpub.com</kbd>.</p>
<p><strong>Errata</strong>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit <a href="http://www.packtpub.com/submit-errata" target="_blank">www.packtpub.com/submit-errata</a>, selecting your book, clicking on the Errata Submission Form link, and entering the details.</p>
<p><strong>Piracy</strong>: If you come across any illegal copies of our works in any form on the internet, we would be grateful if you would provide us with the location address or website name. Please contact us at <kbd>copyright@packtpub.com</kbd> with a link to the material.</p>
<p class="mce-root"><strong>If you are interested in becoming an author</strong>: If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please visit <a href="http://authors.packtpub.com/" target="_blank">authors.packtpub.com</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reviews</h1>
                </header>
            
            <article>
                
<p>Please leave a review. Once you have read and used this book, why not leave a review on the site that you purchased it from? Potential readers can then see and use your unbiased opinion to make purchase decisions, we at Packt can understand what you think about our products, and our authors can see your feedback on their book. Thank you!</p>
<p>For more information about Packt, please visit <a href="https://www.packtpub.com/" target="_blank">packtpub.com</a>.<a href="https://www.packtpub.com/" target="_blank"/></p>


            </article>

            
        </section>
    </body></html>