<html><head></head><body><div class="chapter" title="Chapter&#xA0;15.&#xA0;AngularJS &#x2013; Google's In-Demand Framework"><div class="titlepage"><div><div><h1 class="title"><a id="ch15"/>Chapter 15. AngularJS – Google's In-Demand Framework</h1></div></div></div><p>Angular is an application framework that helps you create web applications. It builds off of HTML and JavaScript to make the creation of dynamic applications easier. Angular extends and is a superset of JavaScript at the same time. You can use plain old JavaScript and Angular to build your application.</p><p>This creates a double-edged sword. On the positive side, it is much easier to build dynamic user interfaces and keep your code maintainable and testable. On the other side, you must learn the overall concept of how an Angular application is built, which Angular piece goes where. This is very different to any other JavaScript application you may have built.</p><p>If all you have ever built is <a class="indexterm" id="id3220"/>user interfaces with <span class="strong"><strong>jQuery</strong></span>, <span class="strong"><strong>BackBone</strong></span>, or plain old JavaScript, then <a class="indexterm" id="id3221"/>much of Angular will seem new and different.</p><p>We will try to cover Angular in a hierarchical way. We will start at the top with containers that hold other parts and objects and end functions that can be used across many objects. We will also touch upon testing, as it is a core part of how Angular is built.</p><p>Let's not waste any more time and jump right to it.</p><p>All of the examples assume that you have loaded Angular so that the <code class="literal">angular</code> object is available.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note77"/>Note</h3><p>If you are <a class="indexterm" id="id3222"/>unsure on how to load Angular, visit the official Angular page at <a class="ulink" href="https://angularjs.org/">https://angularjs.org/</a>.</p></div></div><div class="section" title="Modules (ngApp)"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec119"/>Modules (ngApp)</h1></div></div></div><p>This is the high-level <a class="indexterm" id="id3223"/>container for all the other parts of your application. There are more functions than those listed here, but they will be described in the section they relate to. For example, you can use <code class="literal">module.controller</code> to create a controller, but <a class="indexterm" id="id3224"/>this function will be under the controller section.</p><div class="section" title="module"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec574"/>module</h2></div></div></div><p>Modules are the first <a class="indexterm" id="id3225"/>basic building block of an Angular application:</p><div class="informalexample"><pre class="programlisting">angular.module(moduleName, [dependencies], [configFunction])
angular.module(moduleName)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1049"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">moduleName</code>: This is <a class="indexterm" id="id3226"/>a string that will identify the module. It should be unique.</li><li class="listitem" style="list-style-type: disc"><code class="literal">dependencies(optional)</code>: This is an array of module names that this module is dependent on.</li><li class="listitem" style="list-style-type: disc"><code class="literal">configFunction(optional)</code>: This is a function that will configure the module. See <span class="emphasis"><em>config</em></span> section.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1050"/>Return value</h3></div></div></div><p>This is an Angular module object.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1051"/>Description</h3></div></div></div><p>This function will <a class="indexterm" id="id3227"/>either create a new module or retrieve a module. This depends on whether we pass in an array of dependencies. If dependencies are omitted, then a module is retrieved. Conversely, if we include an array of modules to load (the array can also be empty), then a module will be created.</p><p>When you have a group of objects that work together, it is a good idea to put them into a module. Do not worry about creating too many modules. A module should have one and only one clear function. Then, all the objects that it needs to accomplish that function would be packaged with it.</p><p>Here are a few examples of creating modules:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">This creates a new module: <code class="literal">var firstModule = angular.module('firstModule', []);</code></li><li class="listitem" style="list-style-type: disc">This retrieves a module named <code class="literal">firstModule</code>: <code class="literal">var firstModule = angular.module('firstModule');</code></li><li class="listitem" style="list-style-type: disc">This creates a <a class="indexterm" id="id3228"/>module that relies on <code class="literal">firstModule</code>: <code class="literal">var secondModule = angular.module('secondModule', ['firstModule']);</code></li></ul></div></div></div><div class="section" title="config"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec575"/>config</h2></div></div></div><p>This <a class="indexterm" id="id3229"/>allows you to configure providers:</p><div class="informalexample"><pre class="programlisting">module.config(configFunction)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1052"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">configFunction</code> function <a class="indexterm" id="id3230"/>is the function that will be executed.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1053"/>Return value</h3></div></div></div><p>This is an Angular module object.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1054"/>Description</h3></div></div></div><p>This is the <a class="indexterm" id="id3231"/>function that should be used to configure providers. We will cover providers later in this chapter, but there are a few examples in this section. This allows for providers to be created before the module actually executes.</p><p>The providers will be injected into this function when called. For example, you can use <code class="literal">$provide</code> or <code class="literal">$routeProvider</code> and they will be available. If you want to use a custom provider, it would have to be created before <code class="literal">config</code>. The custom object will need <code class="literal">provider</code> appended to the name for it to be available in <code class="literal">config</code>.</p><p>Here are a couple of examples using providers:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">This example uses <code class="literal">$provide</code>. The provider will be available later as <code class="literal">firstProvider</code>:<div class="informalexample"><pre class="programlisting">firstModule.config(function ($provide) {
  $provide.provider('firstProvider', function () {
    this.$get = function () {
      return function () { alert('First!'); }
    }
  });
});</pre></div></li><li class="listitem" style="list-style-type: disc">This example creates a provider first. It is injected as <code class="literal">firstProvider</code> in <code class="literal">config</code> and used later:<div class="informalexample"><pre class="programlisting">firstModule.provider('first', function () {
  this.$get = function () {
    return function () { alert('First!'); }
  }
});
firstModule.config(function (firstProvider) {
  console.log(firstProvider);
});</pre></div></li></ul></div></div></div><div class="section" title="run"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec576"/>run</h2></div></div></div><p>This <a class="indexterm" id="id3232"/>function is executed after config:</p><div class="informalexample"><pre class="programlisting">module.run(runFunction)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1055"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">runFunction</code> function <a class="indexterm" id="id3233"/>is the function that will be executed.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1056"/>Return value</h3></div></div></div><p>This is an Angular module object.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1057"/>Description</h3></div></div></div><p>The <code class="literal">run()</code> function gets <a class="indexterm" id="id3234"/>executed after <code class="literal">config</code>. At this point, all modules will be loaded. It is the first function called after the module is initialized after <code class="literal">config</code>. What you do in this function will depend on the module.</p><p>Here is an example that sets a scope variable. The variable will be available in the module in later functions:</p><div class="informalexample"><pre class="programlisting">firstModule.run(function ($rootScope) {
  $rootScope.test = 'test';
});</pre></div></div></div></div></div>
<div class="section" title="Routing (ngRoute)"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec120"/>Routing (ngRoute)</h1></div></div></div><p>The <code class="literal">ngRoute</code> <a class="indexterm" id="id3235"/>module is a module that will allow you to configure routing in your application. Routing is listening for changes to the location and then automatically responding to those changes with a new controller and template. It uses <code class="literal">ngView</code>, <code class="literal">$routeProvider</code>, and <code class="literal">$route</code>.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note78"/>Note</h3><p>Your module will need to depend on <code class="literal">ngRoute</code> to use these directives and services. We will also need to include the Angular route JavaScript in our HTML.</p></div></div><div class="section" title="ngView"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec577"/>ngView</h2></div></div></div><p>This <a class="indexterm" id="id3236"/>works <a class="indexterm" id="id3237"/>with the <code class="literal">$route</code> service as a spot for content:</p><div class="informalexample"><pre class="programlisting">&lt;ng-view [onload=''] [autoscroll='']/&gt;
&lt;element ng-view [onload=''] [autoscroll='']/&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1058"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">onload(Angular expression)</code>: This evaluates on load.</li><li class="listitem" style="list-style-type: disc"><code class="literal">autoscroll(Angular expression)</code>: Whether or not <code class="literal">$anchorScroll</code> is used with this <a class="indexterm" id="id3238"/><code class="literal">ngView</code>. By default, it is disabled. Otherwise, it will evaluate whether the expression is true or not.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1059"/>Return value</h3></div></div></div><p>This is a directive.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1060"/>Description</h3></div></div></div><p>When routing, you will need <a class="indexterm" id="id3239"/>to mark a part of your application where dynamic content can be loaded. This is what <code class="literal">ngView</code> does. When a route is matched, it will load the new content where <code class="literal">ngView</code> is. An example will be provided for all of <code class="literal">ngRoute</code> at the end of the section.</p></div></div><div class="section" title="$routeProvider"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec578"/>$routeProvider</h2></div></div></div><p>This is <a class="indexterm" id="id3240"/>a provider that lets you configure <a class="indexterm" id="id3241"/>routes:</p><div class="informalexample"><pre class="programlisting">$routeProvider.when(path, route)
$routeProvider.otherwise(route)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1061"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">path(string)</code>: This is what the location will be matched against. It can contain <a class="indexterm" id="id3242"/>named groups by using a colon (<code class="literal">:group</code>), can include a star to match multiple parts (<code class="literal">:group*</code>), and can be optional (<code class="literal">:group?</code>).</li><li class="listitem" style="list-style-type: disc"><code class="literal">route(object)</code>: This object tells Angular what to do when the route matches. The <a class="indexterm" id="id3243"/>object can have these properties (not an inclusive list):<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">controller</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">template</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">templateUrl</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">resolve</code></li></ul></div></li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1062"/>Return value</h3></div></div></div><p>This returns <code class="literal">$routeProvider</code>, so it is chainable.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1063"/>Description</h3></div></div></div><p>This is the provider that <a class="indexterm" id="id3244"/>can be used to configure all of the routes. It can be injected into <code class="literal">module.config</code>.</p></div></div><div class="section" title="$route"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec579"/>$route</h2></div></div></div><p>This is the <a class="indexterm" id="id3245"/>actual service that provides which route definition has been <a class="indexterm" id="id3246"/>matched. This is an object that can be injected directly into a controller.</p><div class="section" title="Properties"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1064"/>Properties</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">current(object)</code>: This object has the current variables based on the route that was matched. This <a class="indexterm" id="id3247"/>will include <code class="literal">$route</code>, <code class="literal">loadedTemplateUrl</code>, <code class="literal">locals</code>, <code class="literal">params</code>, and <code class="literal">scope</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">routes(object)</code>: This has all the routes configured.</li></ul></div></div><div class="section" title="Events"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1065"/>Events</h3></div></div></div><p>These events can be <a class="indexterm" id="id3248"/>listened for the <code class="literal">$route</code> object:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">$routeChangeStart</code>: This event is fired before the actual route change</li><li class="listitem" style="list-style-type: disc"><code class="literal">$routeChangeSuccess</code>: This event is fired after a route has been resolved</li><li class="listitem" style="list-style-type: disc"><code class="literal">$routeChangeError</code>: This event is fired if any of the route promises are rejected</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1066"/>Description</h3></div></div></div><p>This is a service that <a class="indexterm" id="id3249"/>can be injected into each controller. The controller can then look at the properties to get information about the route that was matched. The routing matching will happen without your intervention and then you can update your <a class="indexterm" id="id3250"/>controller's scope when the route is loaded.</p></div></div><div class="section" title="$routeParams"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec580"/>$routeParams</h2></div></div></div><p>This is a <a class="indexterm" id="id3251"/>service that will return the parameters of the loaded route. This <a class="indexterm" id="id3252"/>will only give you parameters after a route has resolved, so you may need to use <code class="literal">$route.current.params</code>. This can be injected into a controller.</p><p>Here is an example using all of the directives and services in <code class="literal">ngRoute</code>. First, we have an HTML body tag. This will also include an inline template named <code class="literal">main.html</code>. This template will echo out the <code class="literal">$route</code> and <code class="literal">$routeParams</code> objects:</p><div class="informalexample"><pre class="programlisting">&lt;body ng-app="firstModule"&gt;
  &lt;div ng-view&gt;&lt;/div&gt;
  &lt;a href="#/main/1"&gt;Main&lt;/a&gt;

  &lt;script type="text/ng-template" id="main.html"&gt;
    &lt;pre&gt;$routeParams = {{$routeParams}}&lt;/pre&gt;
    &lt;pre&gt;$route = {{$route}}&lt;/pre&gt;
  &lt;/script&gt;

&lt;/body&gt;</pre></div><p>Here is the script that will execute this. First is the creation of the module, then the configuration of <code class="literal">$routeProvider</code> and, finally, the definition of a controller for the provider to use:</p><div class="informalexample"><pre class="programlisting">var firstModule = angular.module('firstModule', ['ngRoute']);

firstModule.config(function ($routeProvider) {
  $routeProvider.when('/main/:id', {
    controller: 'MainController',
    templateUrl: 'main.html'
  });
});

firstModule.controller('MainController', function ($scope, $route, $routeParams) {
  $scope.$route = $route;
  $scope.$routeParams = $routeParams;
});</pre></div></div></div>
<div class="section" title="Dependency injection"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec121"/>Dependency injection</h1></div></div></div><p>Angular <a class="indexterm" id="id3253"/>makes use of dependency injection everywhere. Dependency <a class="indexterm" id="id3254"/>injection is when a function does not initialize the dependencies it needs. Instead, they are injected into the function as parameters. For example, when a module needs a route provider, it asks for one. The module does not care how or when the route provider was created; it just wants a reference.</p><p>You actually use the injector in everything you do in Angular. Angular just does it for you. We will look at <code class="literal">$injector</code> and understand how it works but, most likely, you will not need to use these functions.</p><div class="section" title="Dependency injection in Angular"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec581"/>Dependency injection in Angular</h2></div></div></div><p>We will <a class="indexterm" id="id3255"/>quickly cover the common ways that objects are injected into functions in Angular. Using a controller as an example, we will cover the two most common <a class="indexterm" id="id3256"/>methods. Both of these are using Angular's injection behind the scenes:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Defining the variables in a function</strong></span>: You just have to pass the name of the object you need injected. Here is an example that uses <code class="literal">$scope</code> and a service:<div class="informalexample"><pre class="programlisting">firstModule.controller('DIController', function ($scope, customService) {
  //$scope and customService are available here
  console.log($scope);
  console.log(customService);
});</pre></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Using an array to list the dependencies</strong></span>: You can get the exact same result using an array. The <a class="indexterm" id="id3257"/>elements of the array will be the objects you need as strings. Finally, you will just need to have a function as the last element in the array. The function can even rename the variable if needed. Here is the same example in the array format:<div class="informalexample"><pre class="programlisting">firstModule.controller('DIController', ['$scope', 'customService', function (newScope, custom) {
  // newScope and custom are available here
  console.log(newScope);
  console.log(custom);
}]);</pre></div></li></ul></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note79"/>Note</h3><p>Only the array format is minification safe. The first function will not work once the source has been minified.</p></div></div></div><div class="section" title="injector"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec582"/>injector</h2></div></div></div><p>Use this <a class="indexterm" id="id3258"/>to <a class="indexterm" id="id3259"/>get an Angular <a class="indexterm" id="id3260"/>injector that you can invoke:</p><div class="informalexample"><pre class="programlisting">angular.injector(modules)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1067"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">modules(array)</code> <a class="indexterm" id="id3261"/>array is a list of the modules you want to load. You must include <code class="literal">ng</code>.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1068"/>Return value</h3></div></div></div><p>This returns an injector object. See <code class="literal">$injector</code> section.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1069"/>Description</h3></div></div></div><p>You can create this object <a class="indexterm" id="id3262"/>to use Angular's injector object. List out the references you want and then invoke your function.</p><p>Here is an example that gets a reference to the <code class="literal">$http</code> service:</p><div class="informalexample"><pre class="programlisting">var injector = angular.injector(['ng']);
var injectTest = function ($http) { console.log($http); };
injector.invoke(injectTest);</pre></div></div></div><div class="section" title="$injector"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec583"/>$injector</h2></div></div></div><p>You will very <a class="indexterm" id="id3263"/>rarely ever need to create an injector in Angular. It will <a class="indexterm" id="id3264"/>be provided for you. You can get a reference to the injector by injecting it or retrieving it from a current module. Here are examples for both:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You can get a reference from any element inside of the module:<div class="informalexample"><pre class="programlisting">var injector = angular.element(document.body).injector();</pre></div></li><li class="listitem" style="list-style-type: disc">You can have it injected into a function. Here is an example using <code class="literal">config</code>:<div class="informalexample"><pre class="programlisting">firstModule.config(function ($routeProvider, $injector) {
  console.log($injector);
});</pre></div></li></ul></div><div class="section" title="Methods"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1070"/>Methods</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">annotation</code>: This <a class="indexterm" id="id3265"/>returns an array of the objects that will be injected</li><li class="listitem" style="list-style-type: disc"><code class="literal">get(name)</code>: This returns the service with its name</li><li class="listitem" style="list-style-type: disc"><code class="literal">invoke(function)</code>: This will execute the function injecting the dependencies</li><li class="listitem" style="list-style-type: disc"><code class="literal">has(name)</code>: This <a class="indexterm" id="id3266"/>allows you to determine whether a service exists</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1071"/>Description</h3></div></div></div><p>Angular will do this automatically for you, but it is always good to have an idea of what is happening. This is especially <a class="indexterm" id="id3267"/>true with something that works just like <code class="literal">$injector</code>. Each time a function executes with dependencies, Angular will invoke the function from the injector, sending the correct parameters if they have been created and registered.</p></div></div></div>
<div class="section" title="Controllers"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec122"/>Controllers</h1></div></div></div><p>Controllers are <a class="indexterm" id="id3268"/>one of the core units of any Angular application. Controllers are used to create a small part of a module that requires its own scope. Each module can have many controllers. Controllers should be small and focused on one task.</p><p>Each controller should really only worry about the data and any events that modify that data. This means a controller should not modify the DOM, change output or input, or share state with another controller. Each of these should use the Angular solution, directives or filters, and services, respectively.</p><p>Controllers are created from a module reference, so they are tied to modules. Here is an example of creating a simple controller:</p><div class="informalexample"><pre class="programlisting">firstModule.controller('SimpleController', ['$scope', function ($scope) {
  $scope.hey = "HEY!";
  console.log($scope);
}]);</pre></div><p>This module can <a class="indexterm" id="id3269"/>then be attached to a DOM element with <code class="literal">ngController</code>:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-controller="SimpleController"&gt;
  {{ hey }}
&lt;/div&gt;</pre></div><div class="section" title="ngController"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec584"/>ngController</h2></div></div></div><p>This is a core <a class="indexterm" id="id3270"/>part of how Angular maps to the model-view-controller <a class="indexterm" id="id3271"/>pattern.</p><div class="informalexample"><pre class="programlisting">&lt;element ng-controller /&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1072"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">ng-controller(expression)</code> attribute is a string that will tell Angular which controller <a class="indexterm" id="id3272"/>is tied to this element.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1073"/>Description</h3></div></div></div><p>A controller needs a <a class="indexterm" id="id3273"/>part of the document to attach. This directive will bind the controller, with its scope, to this element.</p><p>If a controller has been defined in a route, then you should not add this directive to the page. The router will take care of binding to the correct element.</p><p>Here is an example of using <code class="literal">ngcontroller</code> to create an alias for the controller:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-controller="SimpleController as simple"&gt;
  {{ simple.hey }}
&lt;/div&gt;</pre></div></div></div><div class="section" title="$scope"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec585"/>$scope</h2></div></div></div><p>This is the most <a class="indexterm" id="id3274"/>important part of a controller. This is the where you should <a class="indexterm" id="id3275"/>place everything you are tracking for this controller. This includes any functions that modify the scope.</p><p>The <code class="literal">$scope</code> controller is injected into the controller by declaring a dependency to it (see dependency injection). There are built-in functions and properties (see Scopes), but because it is just a JavaScript object, you can add your own functions and properties. These will map directly to the template in the controller.</p><p>Here is an example of a controller that defines one property, <code class="literal">hey</code>, and a function, <code class="literal">changeHey</code>. It is important to note that there are no references to DOM references at all in this function:</p><div class="informalexample"><pre class="programlisting">firstModule.controller('SimpleController', ['$scope', function ($scope) {
  $scope.hey = "HEY!";
  $scope.changeHey = function () {
    $scope.hey = $scope.hey === 'HEY!' ? 'OK!' : 'HEY!';
  };
}]);</pre></div><p>Here is the template with all the data binding in the HTML document:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-controller="SimpleController"&gt;
  {{ hey }}
  &lt;input type="text" ng-model="hey"/&gt;
  &lt;button ng-click="changeHey()"&gt;{{hey}}&lt;/button&gt;
&lt;/div&gt;</pre></div><p>Angular will know <a class="indexterm" id="id3276"/>what <code class="literal">hey</code> is in this element because it is scoped to just <code class="literal">SimpleController</code>.</p></div><div class="section" title="Data binding and templates"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec586"/>Data binding and templates</h2></div></div></div><p>A controller <a class="indexterm" id="id3277"/>uses HTML as its templating language. You can <a class="indexterm" id="id3278"/>bind a value from the controller's scope just by surrounding it in double brackets <code class="literal">({{ }})</code>. That is really all there is to it!</p><p>For some elements such as <code class="literal">input</code>, <code class="literal">select</code>, and <code class="literal">textarea</code>, you cannot just add the value of a <code class="literal">scope</code> object to bind them. You will have to use the <code class="literal">ngModel</code> directive.</p><p>The <code class="literal">$scope</code> section has a great example of binding scope values to the template.</p></div><div class="section" title="Event binding"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec587"/>Event binding</h2></div></div></div><p>Angular <a class="indexterm" id="id3279"/>uses directives to bind events. In the <code class="literal">$scope</code> section, the <a class="indexterm" id="id3280"/>example uses <code class="literal">ngClick</code> to listen for the click event on a button.</p><p>See the <span class="emphasis"><em>Directives</em></span>, <span class="emphasis"><em>Event Binding</em></span> section for a list of the most used event directives.</p></div></div>
<div class="section" title="Scope"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec123"/>Scope</h1></div></div></div><p>The <code class="literal">$scope</code> object <a class="indexterm" id="id3281"/>that gets injected into controllers has some functionality. In addition to this, we will look at the hierarchies and digest cycle of scopes.</p><div class="section" title="Digest cycle"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec588"/>Digest cycle</h2></div></div></div><p>This is an important <a class="indexterm" id="id3282"/>concept to understand with scopes. The digest cycle, from a high level, is a cycle that checks to see whether any scope variables have been changed. If they have, it then executes a function. Take binding a scope variable to the template with <code class="literal">{{variable}}</code>. The digest cycle will now watch this variable and, anytime it changes, it will update the template. If the variable is bound anywhere else, it will be updated as well. This is how Angular "magically" makes values auto update.</p><p>A few things to keep in mind is that not everything in the scope is watched. The easiest way to have it watched is to bind it. You can also manually watch values. Also, remember that performance issues can arise when you are watching many variables. The digest cycle goes through all the watchers.</p></div><div class="section" title="$digest"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec589"/>$digest</h2></div></div></div><p>This is <a class="indexterm" id="id3283"/>how <a class="indexterm" id="id3284"/>you can start the digest cycle:</p><div class="informalexample"><pre class="programlisting">scope.$digest()</pre></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1074"/>Description</h3></div></div></div><p>This will manually kick off the digest cycle for the scope. In most cases, this does not need to be called. For example, <code class="literal">$digest</code> does not need to be called after updating a value from a click event when handled through Angular. Angular will start the digest cycle for you. A good rule of thumb is that if you are changing or updating a value from an Angular event or directive in a controller, you would not need to call <code class="literal">$digest</code>.</p><p>One case where you may need to call it is when dealing with an asynchronous call in a custom directive.</p></div></div><div class="section" title="$watch"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec590"/>$watch</h2></div></div></div><p>This allows <a class="indexterm" id="id3285"/>you <a class="indexterm" id="id3286"/>to watch a value or computed value in the digest cycle:</p><div class="informalexample"><pre class="programlisting">scope.$watch(watch, listener)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1075"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">watch(string or function)</code>: This is what you want to watch. A string will be evaluated as an <a class="indexterm" id="id3287"/>expression. The function will have access to the scope through the first parameter. Using a function allows you to watch not only for values, but also calculated values of variables in the scope.</li><li class="listitem" style="list-style-type: disc"><code class="literal">listener(function)</code>: This function will have the <code class="literal">function(newVal, oldVal, scope)</code> signature. This is the function that will execute when the value changes.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1076"/>Return value</h3></div></div></div><p>This is a function to deregister the watch.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1077"/>Description</h3></div></div></div><p>This is how to manually add a <a class="indexterm" id="id3288"/>watch to the digest cycle. There are two main reasons to do this. The first is that you will need to run a custom function when a value changes. The other is that you will need to watch a combination or calculation of a value in <code class="literal">$scope</code>.</p><p>Here is an example that has a watch for a string and a function. The basis of the example is from <span class="emphasis"><em>Controllers</em></span>, <span class="emphasis"><em>$scope</em></span> sections. The first watch listens for the <code class="literal">hey</code> variable in the scope. The other one watches to see whether the value of <code class="literal">hey</code> has three or more characters. It will only fire when this threshold <a class="indexterm" id="id3289"/>has been crossed and not fire again until it is crossed in the opposite direction:</p><div class="informalexample"><pre class="programlisting">$scope.$watch('hey', function (newVal, oldVal, scope) {
  alert('Hey was changed from ' + oldVal + ' to ' + newVal);
});

$scope.$watch(function (scope) {
  return scope.hey.length &gt;= 3;
}, function (newVal, oldVal, scope) {
  console.log('Hey listener');
});</pre></div></div></div><div class="section" title="$apply"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec591"/>$apply</h2></div></div></div><p>This is <a class="indexterm" id="id3290"/>a way <a class="indexterm" id="id3291"/>to manually start the digest cycle:</p><div class="informalexample"><pre class="programlisting">scope.$apply(func)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1078"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">func(function or string)</code> attribute is a <a class="indexterm" id="id3292"/>string, it would be evaluated as an expression. If it is a function, the function would be executed.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1079"/>Return value</h3></div></div></div><p>This is the return value of the function or expression.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1080"/>Description</h3></div></div></div><p>This will manually kick off the <a class="indexterm" id="id3293"/>digest cycle. Much like <code class="literal">$digest</code>, this should not be called for the most part, except for specific situations. The most common situation is when a scope value has been changed outside of Angular, for example, an asynchronous AJAX call that has a reference to a scope value. The update happens outside of the digest loop and Angular does not know as it did not use any Angular methods.</p><p>This leads to a best practice to always use Angular's services and functions. If you do so, you should never have to run <code class="literal">$apply</code>.</p><p>Another best practice is to run your function inside <code class="literal">$apply</code>. Angular will catch any errors that are thrown and you can deal with them the Angular way.</p><p>Here is an example that updates the scope inside <code class="literal">setTimeout</code> after 2 seconds. As the digest loop has finished, it will <a class="indexterm" id="id3294"/>not see this change unless <code class="literal">$apply</code> is called:</p><div class="informalexample"><pre class="programlisting">setTimeout(function () {
  $scope.$apply(function () { $scope.hey = 'Updated from setTimeout'; });
}, 2000);</pre></div></div></div><div class="section" title="Hierarchies"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec592"/>Hierarchies</h2></div></div></div><p>Angular <a class="indexterm" id="id3295"/>applications only have one root scope but many child scopes. When a variable is referenced, it will check the current scope it is in and then check the parent. This will happen all the way up to the root scope. This is very similar to how JavaScript objects work with the prototype property. You can find more about this in <a class="link" href="ch08.html" title="Chapter 8. JavaScript Implementations, Syntax Basics, and Variable Types">Chapter 8</a>, <span class="emphasis"><em>JavaScript Object-orientated Programming</em></span>.</p></div></div>
<div class="section" title="Services"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec124"/>Services</h1></div></div></div><p>The role services <a class="indexterm" id="id3296"/>play in an Angular application is clear, but there can be confusion around the creation of services. This is because there are three very similar ways to create a service in Angular. We will look at each of these and why they should be used.</p><p>A service in Angular is an object that can be an authority on data (meaning it is the only source of some data). A great example is the route provider as it is the only object that provides route information. It is a singleton that all modules utilize, a way to keep data in sync between controllers, or all of these! A great example of a service that you will most likely need is <code class="literal">$http</code>. It makes AJAX requests for you. You can build a service that returns data from your API and you do not have to worry about creating AJAX calls in each and every controller.</p><p>Another example is the <code class="literal">$route</code> and <code class="literal">$routeParams</code> services. When you have a reference to the <code class="literal">$route</code> service, you can always find out what route has been matched. The <code class="literal">$routeParams</code> service will let you know the parameters.</p><p>Services should be used anytime you have the need to write the same code more than once. You can pull it out and put it into a service. In addition to this, services should be created for any data that will be used by more than one controller. The controller can then ask the service for the data. This will keep this data the same across multiple controllers.</p><p>All of the functions <a class="indexterm" id="id3297"/>listed can be called from the module or off the <code class="literal">$provide</code> injectable object.</p><p>Factory, service, and provider will all rely on an HTML template of this:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-controller="SimpleController"&gt;
  {{ service }}
&lt;/div&gt;</pre></div><div class="section" title="Factory"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec593"/>Factory</h2></div></div></div><p>This is the <a class="indexterm" id="id3298"/>method to create factories:</p><div class="informalexample"><pre class="programlisting">module.factory(name, getFunction)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1081"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">name(string)</code>: This is <a class="indexterm" id="id3299"/>the name that the service will be known by. This can be used for dependency injection.</li><li class="listitem" style="list-style-type: disc"><code class="literal">getFunction(function or array)</code>: This is the function that will return the service. This can also be an array that lists the dependencies.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1082"/>Return value</h3></div></div></div><p>This is an Angular module object.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1083"/>Description</h3></div></div></div><p>The service factory is great when <a class="indexterm" id="id3300"/>you need a singleton. No configuration other than what is done in the <code class="literal">factory()</code> function is done. The object will be the same each time it is injected.</p><p>Here is a simple example that will return the name of the service. The example also creates a dependency on <code class="literal">$http</code>:</p><div class="informalexample"><pre class="programlisting">firstModule.factory('firstFactory', ['$http', function ($http) {
  var serviceName = 'firstFactory';
  return {
    getName: function(){return serviceName;}
  };
}]);</pre></div></div></div><div class="section" title="Service"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec594"/>Service</h2></div></div></div><p>Services <a class="indexterm" id="id3301"/>can be initialized with <code class="literal">new</code> keyword:</p><div class="informalexample"><pre class="programlisting">module.service(name, constructor)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1084"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">name(string)</code>: This <a class="indexterm" id="id3302"/>is the name of the service</li><li class="listitem" style="list-style-type: disc"><code class="literal">constructor(function or array)</code>: This will be the function that is called as the constructor</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1085"/>Return value</h3></div></div></div><p>This is an Angular module object.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1086"/>Description</h3></div></div></div><p>The key distinction <a class="indexterm" id="id3303"/>between a service and a factory is that it can be initialized with <code class="literal">new</code>. Here is an example that depends on <code class="literal">$http</code>:</p><div class="informalexample"><pre class="programlisting">firstModule.service('firstService', ['$http', function ($http) {
  return function (name) {
    var serviceName = name;

    this.getName = function () {
      return serviceName;
    };
  };
}]);</pre></div><p>Here is the controller that will initialize the service:</p><div class="informalexample"><pre class="programlisting">firstModule.controller('SimpleController', ['$scope', 'firstService', function ($scope, firstService) {
  var first = new firstService('First Service Name');
  var second = new firstService('Second Service Name');
  $scope.service = second.getName();
}]);</pre></div></div></div><div class="section" title="Provider"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec595"/>Provider</h2></div></div></div><p>The function that <a class="indexterm" id="id3304"/>provides the most control of the setup of a provider:</p><div class="informalexample"><pre class="programlisting">module.provider(name, provider)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1087"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">name(string)</code>: This <a class="indexterm" id="id3305"/>is the name of the provider</li><li class="listitem" style="list-style-type: disc"><code class="literal">provider(function or array)</code></li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1088"/>Return value</h3></div></div></div><p>This is an Angular module object.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1089"/>Description</h3></div></div></div><p>This is the final and most <a class="indexterm" id="id3306"/>complex way to build a service. It must return an object with a <code class="literal">$get</code> method. You should use this when you must have this object ready for configuration. This is the only provider that can be injected during the configuration phase of application startup. The word "provider" will be appended to the name of this. For example, if you named your provider <code class="literal">my</code>, it will be injected using <code class="literal">myProvider</code>. Here is an example provider that has its name injected during configuration. First up is the provider definition:</p><div class="informalexample"><pre class="programlisting">firstModule.provider('first', function () {
  var serviceName;

  return {
    configSet: function (name) {
      serviceName = name;
    },
    $get: function () {
      return {
        getName: function () { return serviceName; }
      };
    }
  }
});</pre></div><p>Next is the configuration. Notice <a class="indexterm" id="id3307"/>how it is injected using <code class="literal">firstProvider</code>:</p><div class="informalexample"><pre class="programlisting">firstModule.config(['firstProvider', function (firstProvider) {
  firstProvider.configSet('firstProvider123');
}]);</pre></div><p>Finally, here is the controller:</p><div class="informalexample"><pre class="programlisting">firstModule.controller('SimpleController', ['$scope', 'first', function ($scope, firstProvider) { 
  $scope.test = firstProvider.getName();
}]);</pre></div></div></div><div class="section" title="Value"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec596"/>Value</h2></div></div></div><p>This <a class="indexterm" id="id3308"/>sets a <a class="indexterm" id="id3309"/>value in the module:</p><div class="informalexample"><pre class="programlisting">module.value(name, value)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1090"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">name(string)</code>: This is <a class="indexterm" id="id3310"/>the name of the value</li><li class="listitem" style="list-style-type: disc"><code class="literal">value(object)</code>: This can be anything</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1091"/>Return value</h3></div></div></div><p>This is an Angular module object.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1092"/>Description</h3></div></div></div><p>A value is something that is set and then can be injected later. Values can only be injected into a controller or service, not <a class="indexterm" id="id3311"/>during configuration.</p><p>Here is a simple example of value:</p><div class="informalexample"><pre class="programlisting">firstModule.value('appTitle', 'First App');</pre></div></div></div><div class="section" title="Constant"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec597"/>Constant</h2></div></div></div><p>This <a class="indexterm" id="id3312"/>creates <a class="indexterm" id="id3313"/>a constant variable in a module:</p><div class="informalexample"><pre class="programlisting">module.constant(name, value)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1093"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">name(string)</code>: This <a class="indexterm" id="id3314"/>is the name of the value</li><li class="listitem" style="list-style-type: disc"><code class="literal">value(object)</code>: This can be anything</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1094"/>Return value</h3></div></div></div><p>This is an Angular module object.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1095"/>Description</h3></div></div></div><p>This is very similar to value, except <a class="indexterm" id="id3315"/>that this can be used in the <code class="literal">config</code> function and that the value cannot be decorated.</p><p>Here is a simple example of constant:</p><div class="informalexample"><pre class="programlisting">firstModule.constant('appTitle', 'First App');</pre></div></div></div><div class="section" title="$http"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec598"/>$http</h2></div></div></div><p>This is the <a class="indexterm" id="id3316"/>service <a class="indexterm" id="id3317"/>used to make HTTP calls:</p><div class="informalexample"><pre class="programlisting">$http(config)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1096"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">config(object)</code>: This <a class="indexterm" id="id3318"/>object has the following properties:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">method(string)</code>: This is the HTTP method.</li><li class="listitem" style="list-style-type: disc"><code class="literal">url(string)</code>: This is the URL.</li><li class="listitem" style="list-style-type: disc"><code class="literal">params(string or object)</code>: This is the params for the request. An object will be mapped key to value for this.</li><li class="listitem" style="list-style-type: disc"><code class="literal">data(string or object)</code>: This is the data to be sent in the request.</li><li class="listitem" style="list-style-type: disc"><code class="literal">headers(object)</code>: This sets the headers for the request.</li><li class="listitem" style="list-style-type: disc"><code class="literal">xsrfHeadername(string)</code>: This is the name of the header for XSRF.</li><li class="listitem" style="list-style-type: disc"><code class="literal">xsrfCookieName(string)</code>: This is the name of the cookie for XSRF.</li><li class="listitem" style="list-style-type: disc"><code class="literal">cache(Boolean)</code>: This is used to decide whether to cache data or not.</li><li class="listitem" style="list-style-type: disc"><code class="literal">responseType(string)</code>: This is used to decide what the request type <a class="indexterm" id="id3319"/>will be.</li></ul></div></li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1097"/>Return value</h3></div></div></div><p>A promise will be returned.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1098"/>Description</h3></div></div></div><p>If you are familiar with <a class="indexterm" id="id3320"/>jQuery's AJAX function, then you are familiar with this. This is Angular's way of making any <code class="literal">XMLHttpRequests</code>. For most things, you will use one of the convenience methods that make using <code class="literal">$http</code> easier.</p></div></div><div class="section" title="Convenience methods"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec599"/>Convenience methods</h2></div></div></div><p>You can use all <a class="indexterm" id="id3321"/>of the HTTP methods as functions: <code class="literal">GET</code>, <code class="literal">POST</code>, <code class="literal">HEAD</code>, <code class="literal">PUT</code>, <code class="literal">DELETE</code>, and <code class="literal">PATCH</code>. We will just look at <code class="literal">GET</code>, <code class="literal">POST</code>, and <code class="literal">JSONP</code> closely.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note80"/>Note</h3><p>
<code class="literal">GET</code>, <code class="literal">POST</code>, and <code class="literal">JSONP</code> will cover most, if not all, of many people's needs for <code class="literal">$http</code>. If this does <a class="indexterm" id="id3322"/>not, view the <code class="literal">$http</code> documentation at <a class="ulink" href="https://docs.angularjs.org/api/ng/service/$http">https://docs.angularjs.org/api/ng/service/$http</a>.</p></div></div><p>Each function <a class="indexterm" id="id3323"/>will take the URL as the first parameter and a <code class="literal">config</code> object, which is the same <code class="literal">config</code> object that <code class="literal">$http()</code> gets.</p><div class="section" title="GET"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1099"/>GET</h3></div></div></div><p>This is a <a class="indexterm" id="id3324"/>
<code class="literal">GET</code> request:</p><div class="informalexample"><pre class="programlisting">$http.get(url, config)</pre></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec861"/>Description</h4></div></div></div><p>This executes a simple <code class="literal">GET</code> request. Here is an example of a factory that uses <code class="literal">$http.get</code>:</p><p>Here is the <a class="indexterm" id="id3325"/>factory:</p><div class="informalexample"><pre class="programlisting">firstModule.factory('httpService', ['$http', function ($http) {
  return {
    test: function () { return $http.get('test', {params: 'test'}); }
  }
}]);</pre></div><p>This returns a promise that the controller can then use:</p><div class="informalexample"><pre class="programlisting">firstModule.controller('SimpleController', ['$scope', 'httpService', function ($scope, httpService) {
  httpService.test().success(function (data, status) {
    console.log(data);
  })
  .error(function (data, status) { console.log('An error occured');});
}]);</pre></div></div></div><div class="section" title="POST"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1100"/>POST</h3></div></div></div><p>This is a <a class="indexterm" id="id3326"/>
<code class="literal">POST</code> request:</p><div class="informalexample"><pre class="programlisting">$http.post(url, config)</pre></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec862"/>Description</h4></div></div></div><p>This will make a <code class="literal">POST</code> request. Here is a factory that makes a <code class="literal">POST</code> and an example that uses localhost. Remember that you must be running a server that responds to <code class="literal">POST</code> requests for this to work:</p><div class="informalexample"><pre class="programlisting">firstModule.factory('httpService', ['$http', function ($http) {
  return {
    test: function () { return $http.post('http://localhost/post', { data: 'HEY' }); }
  }
}]);</pre></div></div><div class="section" title="jsonp"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec863"/>jsonp</h4></div></div></div><p>When you have to make a <a class="indexterm" id="id3327"/>cross origin request, you should use <code class="literal">JSONP</code>. This will allow you to use the data instead of the request being blocked based on security.</p></div></div></div><div class="section" title="Notable services"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec600"/>Notable services</h2></div></div></div><p>I will list out <a class="indexterm" id="id3328"/>some useful services that can be injected, with a short blurb about each:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">$anchorScroll</code>: This parameter allows you to scroll to the element in the hash</li><li class="listitem" style="list-style-type: disc"><code class="literal">$animate</code>: This parameter allows DOM manipulations</li><li class="listitem" style="list-style-type: disc"><code class="literal">$cacheFactory</code>: This allows caching</li><li class="listitem" style="list-style-type: disc"><code class="literal">$http</code>: See <code class="literal">$http</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">$interval</code>: This uses Angular's way to call <code class="literal">setInterval</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">$location</code>: This gets the information about <code class="literal">window.location</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">$rootScope</code>: This returns the root scope for the application</li><li class="listitem" style="list-style-type: disc"><code class="literal">$route</code>: See <code class="literal">Routing</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">$q</code>: This allows promises to be added in our project</li><li class="listitem" style="list-style-type: disc"><code class="literal">$timeout</code>: This uses Angular's way to call <code class="literal">setTimout</code></li></ul></div><p>This is not a comprehensive list as Angular has many services and can create and include more. These are the ones that you will most likely use in your applications.</p></div></div>
<div class="section" title="Promises"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec125"/>Promises</h1></div></div></div><p>In JavaScript, many <a class="indexterm" id="id3329"/>actions are asynchronous. A great example of this is an AJAX request. When the request is sent, you do not know when or even if a request will be returned. This is where promises come in.</p><p>A promise is an object that will promise to run a function once an asynchronous event has happened. In our example, the event will be the request returning. This could be in a few milliseconds or longer, depending on the timeout setting.</p><p>In addition to tracking successful events, promises can be rejected. This allows the object that was waiting for the response to do something different.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note81"/>Note</h3><p>Visit <a class="ulink" href="https://promisesaplus.com/">https://promisesaplus.com/</a> for the complete specification for using promises in <a class="indexterm" id="id3330"/>JavaScript. Promises or promise-like objects are applicable in almost any JavaScript that you may write.</p></div></div><div class="section" title="$q"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec601"/>$q</h2></div></div></div><p>This is the <a class="indexterm" id="id3331"/>service <a class="indexterm" id="id3332"/>that implements promises:</p><div class="informalexample"><pre class="programlisting">$q.defer()</pre></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1101"/>Return value</h3></div></div></div><p>This returns a deferred object.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1102"/>Description</h3></div></div></div><p>This is the core of building <a class="indexterm" id="id3333"/>and using promises. The first thing is to get a deferred object, which will have to resolve and reject functions. When the action is successful, call the <code class="literal">resolve</code> function; when it fails, call <code class="literal">reject</code>. Finally, return the promise with <code class="literal">defer.promise</code>.</p><p>With the promise, you can call <code class="literal">then</code>, which takes two functions. The first will be called when <code class="literal">resolve</code> is called, and the second will be called when <code class="literal">reject</code> is called. The promise can be passed around and have <code class="literal">then</code> called multiple times.</p><p>Anytime you are doing anything asynchronous, you should use promises. With Angular, you should use <code class="literal">$q</code> as it is tied in with rootscope.</p><p>Here is an example where a function will succeed when the number is even and fail when the number is odd. Then, it is executed twice, logging to the console, whether it succeeded or failed. Note that the function is created in the controller, but a utility function like this should be put a service into production:</p><div class="informalexample"><pre class="programlisting">firstModule.controller('SimpleController', ['$scope', '$q', function ($scope, $q) {
  function qTest(number) {
    console.log($q);
    var defer = $q.defer();

    if (number % 2 === 0) {
      defer.resolve(number);
    } else {
      defer.reject(number);
    }
    return defer.promise;
  };

  qTest(2)
    .then(function (n) { console.log('succeeded!'); }, function (n) { console.log('failed!'); });

  qTest(3)
    .then(function (n) { console.log('succeeded!'); }, function (n) { console.log('failed!'); });

}]);</pre></div></div></div></div>
<div class="section" title="Expressions"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec126"/>Expressions</h1></div></div></div><p>Expressions are a <a class="indexterm" id="id3334"/>feature of Angular. They are a subset of JavaScript commands in addition to some Angular function. Expressions are used in many places in Angular. For example, anytime you bind data, you can use an expression. This makes understanding expressions important.</p><p>An expression will be evaluated to a value, to a true statement, to a function in scope, or to a variable in scope. This makes them powerful, but they do have some limitations.</p><div class="section" title="Expressions in JavaScript"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec602"/>Expressions in JavaScript</h2></div></div></div><p>You can use some <a class="indexterm" id="id3335"/>JavaScript, but not all JavaScript in an expression. Here are some of the things that you can and cannot do in JavaScript using expressions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You can use a <a class="indexterm" id="id3336"/>string, number, Boolean, array literal, or object literal</li><li class="listitem" style="list-style-type: disc">You can use any operators, for example, <code class="literal">a + b</code>, <code class="literal">a &amp;&amp; b</code>, or <code class="literal">a || b</code></li><li class="listitem" style="list-style-type: disc">You can access properties on an object or look up values in an array</li><li class="listitem" style="list-style-type: disc">You can make function calls</li><li class="listitem" style="list-style-type: disc">You cannot use flow control statements in an expression, for example, an <code class="literal">if</code> statement</li></ul></div><div class="section" title="Context"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1103"/>Context</h3></div></div></div><p>When an expression is <a class="indexterm" id="id3337"/>evaluated in Angular, it will use the scope that it is in. This means that you can use any object or function that is accessible in the scope. One difference is that you will not get access to the global <code class="literal">window</code>. For example, you will not be able to use <code class="literal">window.alert</code> in an expression.</p></div></div></div>
<div class="section" title="Directives"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec127"/>Directives</h1></div></div></div><p>Directives are what <a class="indexterm" id="id3338"/>Angular uses to connect to the <span class="strong"><strong>Document Object </strong></span><a class="indexterm" id="id3339"/>
<span class="strong"><strong>Model</strong></span> (<span class="strong"><strong>DOM</strong></span>). This allows Angular to separate the concerns of what each part of the application should do. This means that a controller should never touch the DOM. A controller should only work through directives to change the DOM.</p><div class="section" title="Normalization"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec603"/>Normalization</h2></div></div></div><p>When using <a class="indexterm" id="id3340"/>directives, Angular must parse the DOM and figure out what <a class="indexterm" id="id3341"/>directives apply to it. This is done by normalizing all the elements and tags. Normalization will remove any ";" "," " -", or" _". It will also remove <code class="literal">x-</code> and <code class="literal">data-</code> from the beginning of any attributes. For example, when looking for <code class="literal">ngModel</code>, all <a class="indexterm" id="id3342"/>of the following will match:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">x-ng:model</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">data-ng_model</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-model</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">ng:model</code></li></ul></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note82"/>Note</h3><p>If you are concerned with HTML 5 validation, then you should use the <code class="literal">data-</code> normalization.</p></div></div></div><div class="section" title="Scope"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec604"/>Scope</h2></div></div></div><p>Scopes inside <a class="indexterm" id="id3343"/>directives can become very confusing. We will look at a few examples <a class="indexterm" id="id3344"/>of the different ways to use scope.</p><p>First up is just inheriting the scope. This means that the directive will use whatever value the variable has in the controller's scope. In this example, <code class="literal">test</code> will have to be set in the controller's scope:</p><div class="informalexample"><pre class="programlisting">firstModule.directive('firstTest', function () {
  return {
    template: 'This is the test directive. Test: {{test}}'
  };
});</pre></div><div class="section" title="@ binding"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1104"/>@ binding</h3></div></div></div><p>The next scope modification will be to isolate the scope. You can set the scope property of the returned Directive <a class="indexterm" id="id3345"/>Definition Object (see the next section). What you use here will change how the scope is built. An <code class="literal">@</code> symbol will read in the value as a one-way bind into the scope. An <code class="literal">=</code> symbol will create a two-way bind. Each of these can have the name of the attribute used after them.</p><p>For example, to bind one way to the attribute scope-test, use: <code class="literal">@scopeTest</code>. Here is an example that does that:</p><div class="informalexample"><pre class="programlisting">firstModule.directive('firstTest', function () {
  return {
    restrict: 'AE',
    scope: {
      test: '@scopeTest'
    },
    template: 'This is the test directive. Test: {{test}}'
  };
});</pre></div><p>This can be used <a class="indexterm" id="id3346"/>like this:</p><div class="informalexample"><pre class="programlisting">&lt;div first-test scope-test="Scope Test Value"&gt;&lt;/div&gt;</pre></div></div><div class="section" title="= binding"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1105"/>= binding</h3></div></div></div><p>Here is the example <a class="indexterm" id="id3347"/>using <code class="literal">=</code>. The controller will need to have a variable in scope to pass to the directive. Here is the directive:</p><div class="informalexample"><pre class="programlisting">firstModule.directive('firstTest', function () {
  return {
    restrict: 'AE',
    scope: {
      test: '='
    },
    template: 'This is the test directive. Test: {{test}}'
  };
});</pre></div><p>The directive is then used like this:</p><div class="informalexample"><pre class="programlisting">&lt;div first-test test="fromControllerScope"&gt;&lt;/div&gt;</pre></div><p>Notice that the attribute used to connect the scope was called <code class="literal">test</code>. This is because we only used <code class="literal">=</code>, instead of <code class="literal">=nameOfVariable</code>.</p></div><div class="section" title="&amp; binding"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1106"/>&amp; binding</h3></div></div></div><p>This is the final way is to <a class="indexterm" id="id3348"/>pass a function in. This is done with <code class="literal">&amp;</code>. When creating a directive with isolated scope, you run into a problem with letting the controller know when to take an action. For example, when a button is clicked, the <code class="literal">&amp; binding</code> allows the controller to pass in the reference to a function and have the directive execute it.</p><p>Here is an example directive:</p><div class="informalexample"><pre class="programlisting">firstModule.directive('firstTest', function () {
  return {
    restrict: 'AE',
    scope: {
      testAction: '&amp;'
    },
    template: '&lt;button ng-click="testAction()"&gt;Action!&lt;/button&gt;'
  };
});</pre></div><p>The template now has a button that will call <code class="literal">testAction</code> when clicked. The <code class="literal">testAction</code> parameter that will execute is passed in from the controller and lives in the directive's scope.</p><p>Here is the DOM of this directive:</p><div class="informalexample"><pre class="programlisting">&lt;div first-test test-action="functionFromController()"&gt;&lt;/div&gt;</pre></div><p>Another situation comes up <a class="indexterm" id="id3349"/>where you will need to pass information from the directive to the controller, for example, the event object or a variable from the scope. Here is an example that shows how Angular makes the <code class="literal">$event</code> object available in functions.</p><p>Here is the directive:</p><div class="informalexample"><pre class="programlisting">firstModule.directive('firstTest', function () {
  return {
    restrict: 'AE',
    scope: {
      testAction: '&amp;'
    },
    template: '&lt;button&gt;Action!&lt;/button&gt;',
    link: function ($scope, element) {
      element.on('click', function (e) {
        $scope.$apply(function () {
          $scope.testAction({ $e: e, $fromDirective: 'From Directive' });
        });
      });
    }
  };
});</pre></div><p>The key is the <code class="literal">link</code> property. This runs after compilation of the directive and is bound to the instance of the directive. This is important if you have a repeating directive. Next you listen for click using a jQuery-like API called JQLite. From here, we must call <code class="literal">$apply</code> because we are outside of Angular and it will not pick up any changes made here. Finally, we executed the expression that was passed in creating two variables, <code class="literal">$e</code> and <code class="literal">$fromDirective</code>, that will be available in the function in the controller.</p><p>Here is what the directive will look like in the DOM:</p><div class="informalexample"><pre class="programlisting">&lt;div first-test test-action="functionFromController($e, $fromDirective)"&gt;&lt;/div&gt;</pre></div><p>The two variables, <code class="literal">$e</code> and <code class="literal">$fromDirective</code>, need to be called the same thing as you defined in the directive.</p></div></div><div class="section" title="Modifying DOM"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec605"/>Modifying DOM</h2></div></div></div><p>Angular makes <a class="indexterm" id="id3350"/>very clear separation of concerns. This helps prevent hard-to-trace bugs from appearing. One of the separations is that controllers should not modify the DOM. Where does one modify the DOM then? In directives.</p><p>Directives are the only piece of your Angular application that should have any knowledge of what elements are in the DOM. When a DOM modification needs to be made, it should be the directive that does it.</p><p>Angular includes a jQuery-like library called jQLite. It has many of jQuery's DOM manipulation functions. If you know jQuery, you already know jQLite.</p><p>Here is a simple example of a directive that adds a <code class="literal">div</code> element when a button is clicked. The example uses jQLite's <code class="literal">append</code> function:</p><div class="informalexample"><pre class="programlisting">firstModule.directive('firstTest', function () {
  return {
    restrict: 'AE',
    scope: {
      testAction: '&amp;'
    },
    template: '&lt;button&gt;Add a DIV!&lt;/button&gt;',
    link: function ($scope, element) {
      element.on('click', function (e) {
        element.append('&lt;div&gt;I was added!&lt;/div&gt;');
      });
    }
  };
});</pre></div></div><div class="section" title="Event binding"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec606"/>Event binding</h2></div></div></div><p>In an Angular <a class="indexterm" id="id3351"/>application, only directives should be listening for DOM <a class="indexterm" id="id3352"/>events, for example, the click event. This makes it very clear where the handlers reside.</p><p>Here is an example that binds to the click event of the element and logs to the console:</p><div class="informalexample"><pre class="programlisting">firstModule.directive('firstTest', function () {
  return {
    restrict: 'AE',
    scope: {
      testAction: '&amp;'
    },
    template: '&lt;button&gt;Add a DIV!&lt;/button&gt;',
    link: function ($scope, element) {
      element.on('click', function (e) {
        console.log(e);
      });
    }
  };
});</pre></div><p>Additionally, directives <a class="indexterm" id="id3353"/>can let a controller pass in a function and execute it <a class="indexterm" id="id3354"/>when an event happens (see <code class="literal">=</code> binding). Finally, the directive can even pass parameters into the controller from the directive. A great example is the event object that is returned from the event (see <code class="literal">&amp;</code> binding).</p></div><div class="section" title="Directive definition object"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec607"/>Directive definition object</h2></div></div></div><p>The directive <a class="indexterm" id="id3355"/>definition object is the object that tells Angular <a class="indexterm" id="id3356"/>how to build a directive.</p><p>Here are the most used properties and a quick overview of what they do:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">priority</code>: A directive with a higher priority will be compiled first. This defaults to <code class="literal">0</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">scope</code>: See <span class="emphasis"><em>Directives, Scope</em></span> section for a much more in depth overview.</li><li class="listitem" style="list-style-type: disc"><code class="literal">controller</code>: This can be confusing, but controller is used to share logic between directives. Another directive can share the code in the controller by using require and listing the name of the required directive. That directive's controller will be injected into the <code class="literal">link</code> function. The function will have the following definition: <code class="literal">function($scope, $element, $attrs, $transclude)</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">require</code>: A string of the directive that is required. Prepending <code class="literal">?</code> will make this optional, <code class="literal">^</code> will search the element and parents throwing an error if not found, and <code class="literal">?^</code> will search the element and parents, but is optional. The function instance will be shared across directives.</li><li class="listitem" style="list-style-type: disc"><code class="literal">restrict</code>: This will restrict the ways you can define the directive in the DOM. Here are the options, with <code class="literal">E</code> and <code class="literal">A</code> being the most commonly used ones:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">E: This stands for element</li><li class="listitem" style="list-style-type: disc">A: This stands for attribute and default</li><li class="listitem" style="list-style-type: disc">C: This stands for class</li><li class="listitem" style="list-style-type: disc">M: This stands for comment</li></ul></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">template</code>: HTML as a string or a function that returns a string that has the definition of <code class="literal">function(element, attrs)</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">templateUrl</code>: Loads the template from this URL.</li><li class="listitem" style="list-style-type: disc"><code class="literal">link</code>: This is where any DOM manipulations or listeners are put. This function <a class="indexterm" id="id3357"/>will have this definition: <code class="literal">function(scope, element, attrs, requiredController, transcludeFunction)</code>. If another directive is required, then its <code class="literal">controller</code> property would be the <code class="literal">requiredController</code> parameter.</li></ul></div><div class="section" title="Controller vs link"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1107"/>Controller vs link</h3></div></div></div><p>When to use the <a class="indexterm" id="id3358"/>
<code class="literal">controller</code> or <code class="literal">link</code> function can be very confusing when building directives. You should view the <code class="literal">controller</code> function as the interface that another directive can use. When a directive is required by another directive, the controller return value is injected into the <code class="literal">link</code> function. This will be the fourth parameter. The object is then accessible from <code class="literal">link</code>. The <code class="literal">link</code> function is used for any DOM manipulations or listeners.</p></div></div><div class="section" title="Key directives"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec608"/>Key directives</h2></div></div></div><p>Here are <a class="indexterm" id="id3359"/>some of <a class="indexterm" id="id3360"/>the most often used directives.</p><div class="section" title="ngApp"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1108"/>ngApp</h3></div></div></div><p>This is the root of your Angular application:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-app&gt;&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec864"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">ng-app(string)</code> attribute <a class="indexterm" id="id3361"/>is the name of the default module.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec865"/>Description</h4></div></div></div><p>This will set the root <a class="indexterm" id="id3362"/>element of the application. This can be put on any element, including the root HTML element.</p><p>This will automatically bootstrap Angular loading the module that is defined in <code class="literal">ng-app</code>.</p></div></div><div class="section" title="ngModel"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1109"/>ngModel</h3></div></div></div><p>This binds data <a class="indexterm" id="id3363"/>from the scope to elements:</p><div class="informalexample"><pre class="programlisting">&lt;input ng-model [ng-required ng-minlength ng-maxlength ng-pattern ng-change ng-trim]&gt;&lt;/input&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec866"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">ng-model(string)</code>: This will be a variable in the scope</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-required(boolean)</code>: This sets this input as required</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-minlength(int)</code>: This sets the minimum length</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-maxlength(int)</code>: This sets the maximum length</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-pattern(string)</code>: This is the regular expression that the value must match</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-change(expression)</code>: This <a class="indexterm" id="id3364"/>is the Angular expression that will execute on value change</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-trim(boolean)</code>: This <a class="indexterm" id="id3365"/>decides whether or not to trim the value</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec867"/>Description</h4></div></div></div><p>This is used to bind variables in the controller's scope to input elements (text, select, or textarea). This will be a two-way binding, so any changes in the variable will update all occurrences of it.</p><p>Here is a simple example with text input:</p><div class="informalexample"><pre class="programlisting">&lt;input ng-model="test" type="text"/&gt;
  {{test}}</pre></div></div></div><div class="section" title="ngDisabled"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1110"/>ngDisabled</h3></div></div></div><p>This can <a class="indexterm" id="id3366"/>disable an element:</p><div class="informalexample"><pre class="programlisting">&lt;input ng-disabled&gt;&lt;/input&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec868"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If the <code class="literal">ng-disabled(expression)</code> attribute evaluates to true, the input will be disabled.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec869"/>Description</h4></div></div></div><p>This allows you to disable <a class="indexterm" id="id3367"/>an input easily through code. The expression can bind to a scope variable or just evaluate what is in the expression.</p><p>Here is a simple example that disables a text input:</p><div class="informalexample"><pre class="programlisting">&lt;input ng-disabled="true" type="text"/&gt;</pre></div></div></div><div class="section" title="ngChecked"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1111"/>ngChecked</h3></div></div></div><p>This can <a class="indexterm" id="id3368"/>make <a class="indexterm" id="id3369"/>an element checked:</p><div class="informalexample"><pre class="programlisting">&lt;input ng-checked&gt;&lt;/input&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec870"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">ng-checked(expression)</code> attribute is the Angular expression that should evaluate to a JavaScript Boolean value.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec871"/>Description</h4></div></div></div><p>This is the Angular way to <a class="indexterm" id="id3370"/>check or uncheck a checkbox based on something in the controller.</p><p>Here is an example:</p><div class="informalexample"><pre class="programlisting">&lt;input ng-checked="true" type="checkbox"/&gt;</pre></div></div></div><div class="section" title="ngClass"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1112"/>ngClass</h3></div></div></div><p>This sets <a class="indexterm" id="id3371"/>the <a class="indexterm" id="id3372"/>class of an element:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-class&gt;&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec872"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">ng-class(expression)</code> attribute can be a string, array, or an object map.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec873"/>Description</h4></div></div></div><p>When the expression is a string or array, then the value of the string or the values of the array will be applied as classes to the element. These can be tied to variables in the scope, of course.</p><p>Here is an example of using a string to set the class. Here is the style that will be applied:</p><div class="informalexample"><pre class="programlisting">.double { font-size: 2em; }</pre></div><p>Here is the code to apply it:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-class="classString"&gt;Text&lt;/div&gt;
&lt;input type="text" ng-model="classString" /&gt;</pre></div><p>The class is tied to the value of the <code class="literal">classString</code> variable. The input is bound so that any change will update the class on <code class="literal">div</code>. Once you type in double, it will apply the style.</p><p>Here is an example using an object map. The object's property name is the class that will be applied and the value must be <code class="literal">true</code>. Here is a similar example utilizing the same class:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-class="{double: classString}"&gt;Text&lt;/div&gt;
&lt;input type="text" ng-model="classString" /&gt;</pre></div><p>You will notice that once you type anything into the input, the class will be applied. This is because a non-blank string will be <code class="literal">true</code>. You can use this to apply as many classes as needed using more properties.</p></div></div><div class="section" title="ngClassOdd and ngClassEvent"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1113"/>ngClassOdd and ngClassEvent</h3></div></div></div><p>These set <a class="indexterm" id="id3373"/>the class of an odd or even element, respectively:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-class-odd&gt;&lt;/element&gt;
&lt;element ng-class-even&gt;&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec874"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">ng-class-odd</code> or <code class="literal">ng-class-even(expression)</code> attributes must evaluate to a <a class="indexterm" id="id3374"/>string or an array of strings that will become <a class="indexterm" id="id3375"/>the class(es) for the element.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec875"/>Description</h4></div></div></div><p>These two directives are related and can even be applied to the same element. If a repeated element is odd, then <code class="literal">ng-class-odd</code> will evaluate and the same is true for <code class="literal">ng-class-even</code>.</p><p>Here is an example that will make every odd element twice the size and every even element half the size. Here are the styles:</p><div class="informalexample"><pre class="programlisting">.odd { font-size: 2em; }
.even { font-size: .5em; }</pre></div><p>Here are the elements. The <code class="literal">ul</code> attribute creates the data to be repeated, and each <code class="literal">span</code> parameter statically sets the class to either odd or even. You can use variables in scope as well:</p><div class="informalexample"><pre class="programlisting">&lt;ul ng-init="numbers=[1,2,3,4]"&gt;
  &lt;li ng-repeat="number in numbers"&gt;
  &lt;span ng-class-even="'even'" ng-class-odd="'odd'"&gt;{{number}}&lt;/span&gt;
  &lt;/li&gt;
&lt;/ul&gt;</pre></div></div></div><div class="section" title="ngRepeat"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1114"/>ngRepeat</h3></div></div></div><p>This is a <a class="indexterm" id="id3376"/>template that can be repeated:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-repeat&gt;&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec876"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">ng-repeat(repeat_expression)</code> attribute is similar to an expression, but it has a few syntax <a class="indexterm" id="id3377"/>differences. Go to the description for the full explanation.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec877"/>Description</h4></div></div></div><p>Many times you will have data that has a similar template, but changes for each row of data. This is where <code class="literal">ng-repeat</code> comes in. The <code class="literal">ng-repeat</code> function will repeat the HTML that you have for each item in the repeat expression.</p><p>The repeat expression is an expression that tells <code class="literal">ng-repeat</code> what items are going to be looped over. Here is a rundown of some expressions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">item in collection</code>: This is the classic foreach statement. It will loop over each item in a collection (an array, for example). The <code class="literal">item</code> parameter will be available inside the template.</li><li class="listitem" style="list-style-type: disc"><code class="literal">(key, value) in collection</code>: If your data is in an object and you want to be able to associate the name of the property to the value, then you will need to do use this.</li><li class="listitem" style="list-style-type: disc"><code class="literal">item in collection track by grouping</code>: This allows for grouping. The grouping will only give you one item for each unique value of grouping.</li><li class="listitem" style="list-style-type: disc"><code class="literal">repeat expression | filter</code>: You can filter any of these expressions to give you a <a class="indexterm" id="id3378"/>subset of the data.</li></ul></div><p>Here is an example using an unordered list. Here is the controller:</p><div class="informalexample"><pre class="programlisting">firstModule.controller('SimpleController', ['$scope', function ($scope) { 
  $scope.items = [{id: 1, name: 'First' }, {id: 2, name: 'Second'}];
}]);</pre></div><p>Here is the HTML for the controller:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-controller="SimpleController"&gt;
  &lt;ul&gt;
    &lt;li ng-repeat="item in items track by item.id"&gt;
      ID: {{item.id}}
      Name: {{item.name}}
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;</pre></div></div></div><div class="section" title="ngShow and ngHide"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1115"/>ngShow and ngHide</h3></div></div></div><p>These <a class="indexterm" id="id3379"/>can <a class="indexterm" id="id3380"/>show or hide elements, respectively:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-show&gt;&lt;/element&gt;
&lt;element ng-hide&gt;&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec878"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">ng-show</code> or <code class="literal">ng-hide(expression)</code> attributes will be evaluated to <code class="literal">true</code> or <code class="literal">false</code>, and the element will either by shown or hidden.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec879"/>Description</h4></div></div></div><p>These directives allow you to show or hide content based on the data in the scope.</p><p>Here is an example that uses a <a class="indexterm" id="id3381"/>counter to show or hide elements. You can use <code class="literal">ng-hide</code> and use the opposite logic. Here is the controller:</p><div class="informalexample"><pre class="programlisting">firstModule.controller('SimpleController', ['$scope', function ($scope) {
  $scope.count = 0;
  $scope.increase = function () { $scope.count++; };
}]);</pre></div><p>Next is the HTML:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-controller="SimpleController"&gt;
  &lt;div ng-show="count == 0"&gt;Count is zero: {{count}}&lt;/div&gt;
  &lt;div ng-show="count &gt; 0"&gt;Count is greater than zero: {{count}}&lt;/div&gt;
  &lt;button ng-click="increase()"&gt;Increase Count&lt;/button&gt;
&lt;/div&gt;</pre></div></div></div><div class="section" title="ngSwitch"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1116"/>ngSwitch</h3></div></div></div><p>This <a class="indexterm" id="id3382"/>creates a switch statement:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-switch&gt;
&lt;element ng-switch-when&gt;&lt;/element&gt;
&lt;element ng-switch-default&gt;&lt;/element&gt;
&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec880"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">ng-switch(expression)</code>: This is an expression that returns a value. This value will be <a class="indexterm" id="id3383"/>used when evaluating <code class="literal">ng-switch-when</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-switch-when(expression)</code>: When the value matches this expression, then this element will be visible.</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-switch-default</code>: This element will show when <code class="literal">ng-switch-when</code> does not match.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec881"/>Description</h4></div></div></div><p>This directive works much like the JavaScript <code class="literal">switch</code> statement. Different cases are tested against, and the one that matches is used. If none of the cases match, then a default element is used.</p><p>Here is an example that jumps between even and odd. Here is the controller:</p><div class="informalexample"><pre class="programlisting">firstModule.controller('SimpleController', ['$scope', function ($scope) {
  $scope.count = 0;
  $scope.increase = function () { $scope.count++; };
}]);</pre></div><p>Then comes the HTML:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-controller="SimpleController"&gt;
  &lt;div ng-switch="count % 2"&gt;
    &lt;div ng-switch-when="0"&gt;Count is Even: {{count}}&lt;/div&gt;
    &lt;div ng-switch-when="1"&gt;Count is Odd: {{count}}&lt;/div&gt;
  &lt;/div&gt;
  &lt;button ng-click="increase()"&gt;Increase Count&lt;/button&gt;
&lt;/div&gt;</pre></div></div></div><div class="section" title="ngClick"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1117"/>ngClick</h3></div></div></div><p>This is used <a class="indexterm" id="id3384"/>to define the click handler:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-click&gt;&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec882"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">ng-click(expression)</code> attribute is what will be evaluated when the element is clicked. A function <a class="indexterm" id="id3385"/>can be used, and the event object is available using the <code class="literal">function($event)</code> function definition. Any other variables in scope can be passed as well, for example, <code class="literal">$indexin</code> a repeater.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec883"/>Description</h4></div></div></div><p>This directive allows you to run JavaScript on the click of an element. Usually, this is used with a function that is in the scope.</p><p>Here is an example that will increment a <code class="literal">scope</code> variable. First, here are the controller's scope variables:</p><div class="informalexample"><pre class="programlisting">$scope.counter = 0;
$scope.functionFromController = function (e) { $scope.counter++; };</pre></div><p>Next, this is the element with the <code class="literal">ng-click</code> directive. In this example, you do not use the event object, but it demonstrates how to get it to the controller function:</p><div class="informalexample"><pre class="programlisting">&lt;button ng-click="functionFromController($event)"&gt;Click Me!&lt;/button&gt;
{{counter}}</pre></div></div></div><div class="section" title="ngDblclick"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1118"/>ngDblclick</h3></div></div></div><p>This is <a class="indexterm" id="id3386"/>used to define the double-click handler:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-dblclick&gt;&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec884"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">ng-dblclick(expression)</code> function, a function can be used and the event object is available using the <code class="literal">function($event)</code> function definition. Any other variables in scope <a class="indexterm" id="id3387"/>can be passed as well, for example, <code class="literal">$index</code> in a repeater.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec885"/>Description</h4></div></div></div><p>This directive is very similar to <code class="literal">ngClick</code>. When the element is double-clicked, the expression will be evaluated.</p><p>This is an example of a div that will increment a counter when double-clicked. Here are the controller's variables:</p><div class="informalexample"><pre class="programlisting">$scope.counter = 0;
$scope.functionFromController = function (e) { $scope.counter++; };</pre></div><p>Here is the element and directive:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-dblclick="functionFromController($event)"&gt;Double Click Me!&lt;/div&gt;
{{counter}}</pre></div></div></div><div class="section" title="ngMousedown, ngMouseup, ngMouseover, ngMouseenter, and ngMouseleave"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1119"/>ngMousedown, ngMouseup, ngMouseover, ngMouseenter, and ngMouseleave</h3></div></div></div><p>These <a class="indexterm" id="id3388"/>are <a class="indexterm" id="id3389"/>used to define the mouse event handlers:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-mousedown&gt;&lt;/element&gt;
&lt;element ng-mouseup&gt;&lt;/element&gt;
&lt;element ng-mouseover&gt;&lt;/element&gt;
&lt;element ng-mouseenter&gt;&lt;/element&gt;
&lt;element ng-mouseleave&gt;&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec886"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">In the <code class="literal">ng-mouse*(expression)</code> function, a statement or function can be used, and the event <a class="indexterm" id="id3390"/>object is available using the <code class="literal">function($event)</code> <a class="indexterm" id="id3391"/>function definition. Any other variables in the scope can be passed <a class="indexterm" id="id3392"/>as well, for example, <code class="literal">$index</code> in a repeater.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec887"/>Description</h4></div></div></div><p>These are grouped together <a class="indexterm" id="id3393"/>as they are all related. When the <a class="indexterm" id="id3394"/>mouse takes the action (down, up, over, enter, or leave), the <a class="indexterm" id="id3395"/>expression will be evaluated.</p><p>This example <a class="indexterm" id="id3396"/>is a little crazy, but it demonstrates how to use these events. Here is <a class="indexterm" id="id3397"/>the relevant portion of the controller:</p><div class="informalexample"><pre class="programlisting">$scope.counter = 0;
$scope.functionFromController = function (e) { $scope.counter++; };</pre></div><p>Here are the <a class="indexterm" id="id3398"/>directives:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-mousedown="functionFromController($event)" ng-mouseup="functionFromController($event)"
  ng-mouseenter="functionFromController($event)" ng-mouseleave="functionFromController($event)"
  ng-mouseover="functionFromController($event)"&gt;Mouse Over Me!&lt;/div&gt;
{{counter}}</pre></div></div></div><div class="section" title="ngMousemove"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1120"/>ngMousemove</h3></div></div></div><p>This is used to <a class="indexterm" id="id3399"/>define the mouse move handler:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-mousemove&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec888"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">In the <code class="literal">ng-mousemove(expression)</code> function, a statement or function can be used, and the event object is <a class="indexterm" id="id3400"/>available using the <code class="literal">function($event)</code> function definition. Any other variables in the scope can be passed as well, for example, <code class="literal">$index</code> in a repeater.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec889"/>Description</h4></div></div></div><p>This fires when the mouse moves. Unless the directive is on the entire page, the event will be limited to only the element it is applied to.</p><p>Here is an example that will display the mouse's <span class="emphasis"><em>x</em></span> and <span class="emphasis"><em>y</em></span> coordinates. Here are the relevant scope variables:</p><div class="informalexample"><pre class="programlisting">$scope.x = 0;
$scope.y = 0;
$scope.functionFromController = function (e) {
  $scope.x = e.pageX;
  $scope.y = e.pageY;
};</pre></div><p>Then comes the directive:</p><div class="informalexample"><pre class="programlisting">&lt;div ng-mousemove="functionFromController($event)"&gt;Move the mouse to see the x and y coordinates!&lt;/div&gt;
{{x}}
{{y}}</pre></div></div></div><div class="section" title="ngKeydown, ngKeyup, and ngKeypress"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1121"/>ngKeydown, ngKeyup, and ngKeypress</h3></div></div></div><p>These are <a class="indexterm" id="id3401"/>used to define the key press handlers:</p><div class="informalexample"><pre class="programlisting">&lt;element ng-keydown&gt;&lt;/element&gt;
&lt;element ng-keyup&gt;&lt;/element&gt;
&lt;element ng-keypress&gt;&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec890"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">In the <code class="literal">ng-key*(expression)</code> function, a statement or function can be used, and the event object is available <a class="indexterm" id="id3402"/>using the <code class="literal">function($event)</code> function definition. Any other variables in the scope can be passed as <a class="indexterm" id="id3403"/>well, for example, <code class="literal">$index</code> in a repeater.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec891"/>Description</h4></div></div></div><p>These will fire <a class="indexterm" id="id3404"/>when the key is pressed or released.</p><p>Here is an <a class="indexterm" id="id3405"/>example that will retrieve the key code from the key that was pressed down. Here <a class="indexterm" id="id3406"/>are the relevant <code class="literal">scope</code> variables:</p><div class="informalexample"><pre class="programlisting">$scope.keyCode = 0;
$scope.functionFromController = function (e) {
  $scope.keyCode = e.keyCode;
};</pre></div><p>Next comes the directive:</p><div class="informalexample"><pre class="programlisting">&lt;input type="text" ng-keydown="functionFromController($event)"/&gt;
Which key: {{keyCode}}</pre></div></div></div><div class="section" title="ngSubmit"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1122"/>ngSubmit</h3></div></div></div><p>These are used to <a class="indexterm" id="id3407"/>define the submit handler:</p><div class="informalexample"><pre class="programlisting">&lt;form ng-submit&gt;&lt;/form&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec892"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">In the <code class="literal">ng-submit(expression)</code> function, a statement or function can be used, and the event object is <a class="indexterm" id="id3408"/>available using the <code class="literal">function($event)</code> function definition. Any other variables in the scope can be passed as well, for example, <code class="literal">$index</code> in a repeater.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec893"/>Description</h4></div></div></div><p>This directive is used to capture the <code class="literal">submit</code> event of a form. If the form does not have an action attribute, then this will prevent the form from reloading the current page.</p><p>Here is a simple example that <a class="indexterm" id="id3409"/>logs the event object to console on <code class="literal">submit</code>. Here is the directive:</p><div class="informalexample"><pre class="programlisting">&lt;form ng-submit="functionFromController($event)"&gt;&lt;input type="submit" id="submit" value="Submit" /&gt;&lt;/form&gt;</pre></div><p>Next comes the <a class="indexterm" id="id3410"/>controller code:</p><div class="informalexample"><pre class="programlisting">$scope.functionFromController = function (e) {
  console.log(e);
};</pre></div></div></div><div class="section" title="ngFocus and ngBlur"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1123"/>ngFocus and ngBlur</h3></div></div></div><p>These are used <a class="indexterm" id="id3411"/>to define <a class="indexterm" id="id3412"/>the focus and blur handlers, respectively:</p><div class="informalexample"><pre class="programlisting">&lt;input, select, textarea, a, window ng-focus&gt;&lt;/input&gt;
&lt;input, select, textarea, a, window ng-blurs&gt;&lt;/input&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec894"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">In the <code class="literal">ng-focus(expression)</code> function, a statement or function can be used, and the event object is <a class="indexterm" id="id3413"/>available using the <code class="literal">function($event)</code> function <a class="indexterm" id="id3414"/>definition. Any other variables in the scope can be passed as well, for example, <code class="literal">$index</code> in a repeater.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec895"/>Description</h4></div></div></div><p>The <code class="literal">ngFocus</code> handler will fire when the element gains focus, and <code class="literal">ngBlur</code> will fire when it loses focus. Here is an example with a text input that logs the event to console:</p><div class="informalexample"><pre class="programlisting">&lt;input type="text" ng-focus="functionFromController($event)"/&gt;</pre></div><p>Here is the controller code:</p><div class="informalexample"><pre class="programlisting">$scope.functionFromController = function (e) {
  console.log(e);
};</pre></div></div></div><div class="section" title="ngCopy, ngCut, and ngPaste"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1124"/>ngCopy, ngCut, and ngPaste</h3></div></div></div><div class="informalexample"><pre class="programlisting">&lt;element ng-copy&gt;&lt;/element&gt;
&lt;element ng-cut&gt;&lt;/element&gt;
&lt;element ng-paste&gt;&lt;/element&gt;</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec896"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">ng-copy</code><a class="indexterm" id="id3415"/>, <code class="literal">ng-cut</code>, or <code class="literal">ng-paste(expression)</code>: A <a class="indexterm" id="id3416"/>statement or function can be used, and the event object is <a class="indexterm" id="id3417"/>available using the <code class="literal">function($event)</code> function definition. Any other variables in the scope can be passed as <a class="indexterm" id="id3418"/>well, for example, <code class="literal">$index</code> in a repeater.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec897"/>Description</h4></div></div></div><p>These are the <a class="indexterm" id="id3419"/>events that will be fired when text is either cut, copied, or <a class="indexterm" id="id3420"/>pasted. Here <a class="indexterm" id="id3421"/>is an example that uses all three:</p><div class="informalexample"><pre class="programlisting">&lt;input type="text" ng-cut="functionFromController($event)" ng-copy="functionFromController($event)" ng-paste="functionFromController($event)" /&gt;</pre></div><p>Here <a class="indexterm" id="id3422"/>is <a class="indexterm" id="id3423"/>the controller code:</p><div class="informalexample"><pre class="programlisting">$scope.functionFromController = function (e) {
  console.log(e);
};</pre></div></div></div></div></div>
<div class="section" title="Globals"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec128"/>Globals</h1></div></div></div><p>This next group of <a class="indexterm" id="id3424"/>functions can be executed from anywhere in Angular without having to inject them. They are mainly utility functions that allow you to do things easier or do things the Angular way.</p><div class="section" title="Extend"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec609"/>Extend</h2></div></div></div><p>This <a class="indexterm" id="id3425"/>provides <a class="indexterm" id="id3426"/>a way to combine two objects:</p><div class="informalexample"><pre class="programlisting">angular.extend(srcObject, destObject)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1125"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">srcObject(object)</code>: The <a class="indexterm" id="id3427"/>object that extends will copy the properties from</li><li class="listitem" style="list-style-type: disc"><code class="literal">Destobject(object)</code>: The object that extends will copy the properties to</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1126"/>Return value</h3></div></div></div><p>This returns a reference of <code class="literal">destObject</code>.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1127"/>Description</h3></div></div></div><p>In JavaScript, there is <a class="indexterm" id="id3428"/>no in-built way to extend an object using another object. This function does just that.</p><p>Here is a simple example that will extend one object with the other's property:</p><div class="informalexample"><pre class="programlisting">var first = { first: '1' };
var second = { second: '2' };
var extended = angular.extend(first, second);
//extended will be {first:'1', second:'2'}</pre></div></div></div><div class="section" title="noop"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec610"/>noop</h2></div></div></div><p>This is the no <a class="indexterm" id="id3429"/>operation function:</p><div class="informalexample"><pre class="programlisting">angular.noop()</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1128"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">any</code> or <a class="indexterm" id="id3430"/><code class="literal">none</code> functions are used as these functions does nothing, you can pass in no parameters or as many as you want.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1129"/>Return value</h3></div></div></div><p>This will return <code class="literal">undefined</code>.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1130"/>Description</h3></div></div></div><p>It is useful to have a <a class="indexterm" id="id3431"/>function do no operation (<code class="literal">noop</code>). A great example of this is when you have a function as a parameter that is optional. If it is not passed in, you can run <code class="literal">noop</code> instead.</p><p>This is a simple example that demonstrates the scenario explained earlier:</p><div class="informalexample"><pre class="programlisting">function test(doSomething) {
  var callback = cb || angular.noop;
  callback('output');
}</pre></div></div></div><div class="section" title="isUndefined"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec611"/>isUndefined</h2></div></div></div><p>This <a class="indexterm" id="id3432"/>checks <a class="indexterm" id="id3433"/>to see whether something is undefined:</p><div class="informalexample"><pre class="programlisting">angular.isUndefined(object)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1131"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">object(any type)</code> function <a class="indexterm" id="id3434"/>can be any variable.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1132"/>Return value</h3></div></div></div><p>This returns a Boolean value.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1133"/>Description</h3></div></div></div><p>This states whether <a class="indexterm" id="id3435"/>or not the variable is defined.</p></div></div><div class="section" title="Copy"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec612"/>Copy</h2></div></div></div><p>This makes <a class="indexterm" id="id3436"/>a <a class="indexterm" id="id3437"/>copy of an object:</p><div class="informalexample"><pre class="programlisting">angular.copy(srcObject, [destObject])</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1134"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">srcObject(any type)</code>: This <a class="indexterm" id="id3438"/>is the source object to be copied.</li><li class="listitem" style="list-style-type: disc"><code class="literal">destObject(same type as srcObject)</code>: This is optional. If it is supplied, it would be the destination of the copy operation.</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1135"/>Return value</h3></div></div></div><p>This function returns the copy of <code class="literal">srcObject</code>. If <code class="literal">destObject</code> is supplied, it would be returned.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1136"/>Description</h3></div></div></div><p>When you need to make a <a class="indexterm" id="id3439"/>copy of an object instead of modifying the original object, use this function.</p></div></div><div class="section" title="Bind"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec613"/>Bind</h2></div></div></div><p>This <a class="indexterm" id="id3440"/>binds a <a class="indexterm" id="id3441"/>function to an object:</p><div class="informalexample"><pre class="programlisting">angular.bind(self, function, [args..])</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1137"/>Parameters</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">self(object)</code>: This <a class="indexterm" id="id3442"/>will set <code class="literal">this</code> (the inner self-reference) in the function</li><li class="listitem" style="list-style-type: disc"><code class="literal">Function(function)</code>: This is the function that is being bound</li><li class="listitem" style="list-style-type: disc"><code class="literal">Args(any type)</code>: These are the arguments that will be bound to the function</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1138"/>Return value</h3></div></div></div><p>This is the new bound function.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1139"/>Description</h3></div></div></div><p>This creates a new <a class="indexterm" id="id3443"/>bound function that will execute in the context of self. This allows you to define a function and then execute it many times in different contexts. This is further extended by binding arguments as well.</p><p>This is a contrived example, but demonstrates the principles. First is a function that depends on the context to execute. It will add the first parameter to <code class="literal">this</code> and multiply that result:</p><div class="informalexample"><pre class="programlisting">function addAndMultiply(toAdd, toMultiply) {
  return (this + toAdd) * toMultiply;
}</pre></div><p>Next, you will use <code class="literal">angular.bind</code> to create a new function:</p><div class="informalexample"><pre class="programlisting">var newFunc = angular.bind(4, addAndMultiply, 1);</pre></div><p>This can be executed, and <a class="indexterm" id="id3444"/>the return value will be 5 times the multiplier. In <code class="literal">newFunc</code>, <code class="literal">this</code> is <code class="literal">4</code>, and <code class="literal">toAdd</code> is <code class="literal">1</code>, so the inner parens will always be <code class="literal">5</code>. For example this will return <code class="literal">10</code>:</p><div class="informalexample"><pre class="programlisting">newFunc(2);</pre></div></div></div></div>
<div class="section" title="Forms"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec129"/>Forms</h1></div></div></div><p>Forms are a core <a class="indexterm" id="id3445"/>part of sending data to a server in HTML. As a result of this, Angular has some extra features that work with forms.</p><div class="section" title="ngModel"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec614"/>ngModel</h2></div></div></div><p>Each form input will <a class="indexterm" id="id3446"/>need <code class="literal">ngModel</code> defined to store the value in the scope. See <span class="emphasis"><em>Directives</em></span>, <span class="emphasis"><em>ngModel</em></span> for more information.</p><p>Here is a simple <a class="indexterm" id="id3447"/>form that binds two text inputs:</p><div class="informalexample"><pre class="programlisting">&lt;form name="form"&gt;
  First Name: &lt;input type="text" name="firstname" ng-model="data.firstName" /&gt;
  Last Name: &lt;input type="text" name="lastName" ng-model="data.lastName" /&gt;
&lt;/form&gt;
{{data.firstName}} {{data.lastName}}</pre></div></div><div class="section" title="CSS classes"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec615"/>CSS classes</h2></div></div></div><p>Angular will <a class="indexterm" id="id3448"/>automatically add CSS classes to the form and elements that you <a class="indexterm" id="id3449"/>can then target with CSS. Here is the list of CSS classes and when they are applied:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">ng-valid</code>: This denotes that the form or element is valid</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-invalid</code>: This denotes that the form or element is invalid</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-pristine</code>: This denotes that the control has not been changed</li><li class="listitem" style="list-style-type: disc"><code class="literal">ng-dirty</code>: This <a class="indexterm" id="id3450"/>denotes that the control has been changed</li></ul></div></div><div class="section" title="Validation"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec616"/>Validation</h2></div></div></div><p>Angular has <a class="indexterm" id="id3451"/>features that make validation very easy. First, Angular will use any of the HTML 5 input types. These allow the browser to do some validation, but Angular <a class="indexterm" id="id3452"/>will still track any errors.</p><p>Next, you can use any of the built-in validation directives of <code class="literal">ngModel</code>. The list is <code class="literal">required</code>, <code class="literal">pattern</code>, <code class="literal">minLength</code>, <code class="literal">maxLength</code>, <code class="literal">min</code>, and <code class="literal">max</code>. See <span class="emphasis"><em>Directives</em></span>, <span class="emphasis"><em>ngModel</em></span> for more info about each. When an input fails validation, the value will not be passed into the bound scope variable.</p><p>Here is an example that sets a minimum length on <code class="literal">firstName</code>:</p><div class="informalexample"><pre class="programlisting"> &lt;form name="form"&gt;
  First Name: &lt;input type="text" name="firstname" ng-minlength="10" ng-model="data.firstName" /&gt;
  Last Name: &lt;input type="text" name="lastName" ng-model="data.lastName" /&gt;
&lt;/form&gt;
{{data.firstName}} {{data.lastName}}</pre></div><p>When a form is given a <code class="literal">name</code> attribute, it is bound to the scope as that name. When inputs are given names in a form, they are bound to that form. This allows you to use other directives with these values.</p><p>Here is an example <a class="indexterm" id="id3453"/>that will show an error message when the text input does not meet the minimum length of 10:</p><div class="informalexample"><pre class="programlisting">&lt;form name="form"&gt;
  First Name: &lt;input type="text" name="firstname" ng-minlength="10" ng-model="data.firstName" /&gt;
  &lt;div ng-show="form.firstname.$invalid"&gt;First name must be 10 characters!&lt;/div&gt;
  Last Name: &lt;input type="text" name="lastName" ng-model="data.lastName" /&gt;
&lt;/form&gt;
{{data.firstName}} {{data.lastName}}</pre></div><p>The validation message will only show when the field is invalid.</p><p>The form will have <code class="literal">$dirty</code>, <code class="literal">$invalid</code>, <code class="literal">$pristine</code>, and <code class="literal">$valid</code> as properties that can be used in directives or in scope. The inputs will have the same properties and additionally an <code class="literal">$error</code> object that will have each of the failed validations as a property. In the preceding example, this means that <code class="literal">form.firstname.$error.minLength</code> will return <code class="literal">true</code> when the input has failed that validation and <code class="literal">false</code> when it is valid.</p><div class="section" title="Custom validators"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1140"/>Custom validators</h3></div></div></div><p>When you need to <a class="indexterm" id="id3454"/>create your own logic, you can build a custom validator. You will need to create a new directive, require <code class="literal">ngModel</code>, and pass the value through the <code class="literal">$parsers</code> object of the <code class="literal">ngModel</code> controller when it is passed into the <code class="literal">link</code> function. Then, use <code class="literal">$setValidity</code> based on whether or not the value passed validation.</p><p>Here is an example of a custom validator where you cannot have the value of the input set to <code class="literal">josh</code>:</p><div class="informalexample"><pre class="programlisting">firstModule.directive('notJosh', function () {
  return {
    require: 'ngModel',
    link: function (scope, element, attrs, ctrl) {
      ctrl.$parsers.unshift(function (viewValue) {
        if (viewValue.toUpperCase() === 'JOSH') {
          ctrl.$setValidity('notJosh', false);
          return undefined
        }
        else {
          ctrl.$setValidity('notJosh', true);
          return viewValue;
        }
      });
    }
  }
});</pre></div></div></div></div>
<div class="section" title="Testing"><div class="titlepage"><div><div><h1 class="title"><a id="ch15lvl1sec130"/>Testing</h1></div></div></div><p>Testing should always <a class="indexterm" id="id3455"/>be a major part of any development project. Angular has been built from the beginning to be testable. It has clear separation of concerns; for example, you do not need to build a full DOM to test a controller. Angular also uses dependency injection everywhere, which makes mocking up objects very easy.</p><div class="section" title="Unit testing with Jasmine and Karma"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec617"/>Unit testing with Jasmine and Karma</h2></div></div></div><p>
<span class="strong"><strong>Jasmine</strong></span> and <span class="strong"><strong>Karma</strong></span> are two tools that allow you to quickly and easily test your Angular code.</p><div class="section" title="Jasmine"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1141"/>Jasmine</h3></div></div></div><p>This is the <a class="indexterm" id="id3456"/>actual unit testing library that we will use. Jasmine is a <a class="indexterm" id="id3457"/>behavior-driven testing framework and is really easy to write.</p></div><div class="section" title="Karma"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1142"/>Karma</h3></div></div></div><p>Karma is the test <a class="indexterm" id="id3458"/>runner that will watch your files and automatically kick off your tests. It runs on Node.js, so you must have it installed. You can then <a class="indexterm" id="id3459"/>install Karma with <code class="literal">npm</code>:</p><div class="informalexample"><pre class="programlisting"> install karma-jasmine</pre></div><p>Karma can watch your test files and rerun them whenever any of the files change. You can also debug tests in the browser if there are any issues. It is a great complement to Jasmine, and Google recommends both for testing.</p></div></div><div class="section" title="ngMock"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec618"/>ngMock</h2></div></div></div><p>The <code class="literal">ngMock</code> handler is <a class="indexterm" id="id3460"/>used to help mock up your application when testing. When testing, you will not want to create an entire DOM to load just one module. This <a class="indexterm" id="id3461"/>is where <code class="literal">ngMock</code> can create a controller instance for use, and we can then test it.</p><div class="section" title="Module"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1143"/>Module</h3></div></div></div><p>This allows <a class="indexterm" id="id3462"/>you to load a module:</p><div class="informalexample"><pre class="programlisting">module(moduleName)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec898"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">moduleName(string)</code> <a class="indexterm" id="id3463"/>function take</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec899"/>Description</h4></div></div></div><p>You do not have a root <a class="indexterm" id="id3464"/>element to put <code class="literal">ng-app</code> on, so <code class="literal">module</code> allows us to load a module to get access to its controllers, services, and directives. You should only use this function in tests after loading <code class="literal">ngMock</code>.</p></div></div><div class="section" title="Inject"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1144"/>Inject</h3></div></div></div><p>This <a class="indexterm" id="id3465"/>gets <a class="indexterm" id="id3466"/>the Angular inject services:</p><div class="informalexample"><pre class="programlisting">inject(toBeInjected)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec900"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">toBeInjected(function)</code> function works much like other injected functions. <a class="indexterm" id="id3467"/>List out the objects to be injected, and they will be available in the function body.</li></ul></div></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec901"/>Description</h4></div></div></div><p>Use inject to get access to built-in Angular services, such as <code class="literal">$controller</code> and <code class="literal">$compile</code>, or use it to get <a class="indexterm" id="id3468"/>access to a loading module's services.</p><p>Inject can load dependencies if they are wrapped with underscores. For example, inject would load <code class="literal">$compile</code> if it is used as <code class="literal">_$compile_</code>. This is done because in a test, we will need to create a reference to the <code class="literal">$compile</code> service, and most likely, we would want to use <code class="literal">$compile</code> as the variable name. The underscores allow you to inject it and use the <code class="literal">$compile</code> variable.</p></div></div><div class="section" title="$httpBackend"><div class="titlepage"><div><div><h3 class="title"><a id="ch15lvl3sec1145"/>$httpBackend</h3></div></div></div><p>This <a class="indexterm" id="id3469"/>can <a class="indexterm" id="id3470"/>create a mock response:</p><div class="informalexample"><pre class="programlisting">$httpBackend.when(requestType, url, [requestParameters], [headers])
$httpBackend.expect(requestType, url, [requestParameters], [headers])
$httpBackend.respond(response)</pre></div><div class="section" title="Parameters"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec902"/>Parameters</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">requestType(string)</code>: This is the HTTP method of the request</li><li class="listitem" style="list-style-type: disc"><code class="literal">url(string)</code>: This <a class="indexterm" id="id3471"/>is the URL of the request</li><li class="listitem" style="list-style-type: disc"><code class="literal">requestParameters(object)</code>: These are the parameters of the request</li><li class="listitem" style="list-style-type: disc"><code class="literal">headers(object)</code>: These are the headers for the request</li><li class="listitem" style="list-style-type: disc"><code class="literal">response(string, object)</code>: This is the response of the request</li></ul></div></div><div class="section" title="Return value"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec903"/>Return value</h4></div></div></div><p>This returns a handler that can call <code class="literal">respond</code>.</p></div><div class="section" title="Description"><div class="titlepage"><div><div><h4 class="title"><a id="ch15lvl4sec904"/>Description</h4></div></div></div><p>Making AJAX calls is a <a class="indexterm" id="id3472"/>perfect example of something that should not be done in a unit test. There are too many things out of your control for unit testing. The <code class="literal">$httpBackend</code> handler is provided by <code class="literal">ngMock</code> so that you can create a mock response.</p><p>The handler must match the expected method and URL at the very least. You can also match the optional parameters and headers if you plan on making specific requests with them.</p><p>When the request is matched, you can send back a string or object as the response. This allows you to create a test that uses <code class="literal">$httpBackend</code>, as you know what the response is going to be.</p><p>The difference between <a class="indexterm" id="id3473"/>
<code class="literal">expect</code> and <code class="literal">when</code> is that <code class="literal">expect</code> has to be called in the test, whereas <code class="literal">when</code> does not have that requirement.</p></div></div></div><div class="section" title="Unit testing controllers"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec619"/>Unit testing controllers</h2></div></div></div><p>Here is an <a class="indexterm" id="id3474"/>example of a simple unit test for a controller. First, you must create a controller and then load it in our test:</p><div class="informalexample"><pre class="programlisting">var firstModule = angular.module('firstModule', ['ngMock']);
firstModule.controller('SimpleController', ['$scope', function ($scope) {
  $scope.test = 'HEY!';
}]);</pre></div><p>You can now create the test. In the test, you must load the <code class="literal">firstModule</code> module, inject <code class="literal">$controller</code>, and create an instance of <code class="literal">SimpleController</code>. Here is the test:</p><div class="informalexample"><pre class="programlisting">describe('SimpleController', function () {
  var scope = {};
  var simpleCtrl;
  beforeEach(module('firstModule'));

  it("should have a scope variable of test", inject(function ($controller) {
    expect(scope.test).toBe(undefined);
    simpleCtrl = $controller('SimpleController', { $scope: scope });
    expect(scope.test).toBe('HEY!');
  }));
});</pre></div></div><div class="section" title="Unit testing directives"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec620"/>Unit testing directives</h2></div></div></div><p>This example <a class="indexterm" id="id3475"/>will show you how to test a directive. First, create the directive:</p><div class="informalexample"><pre class="programlisting">firstModule.directive('simpleDirective', function () {
  return {
    restrict: 'E',
    scope:{
      test: '@'
    },
    replace: true,
    template: '&lt;div&gt;This is an example {{test}}.&lt;/div&gt;'
  };
});</pre></div><p>Next, you will need to <a class="indexterm" id="id3476"/>load the module, inject <code class="literal">$compiler</code> and <code class="literal">$rootscope</code>, compile the directive, and finally, start the digest loop at least once to bind any values:</p><div class="informalexample"><pre class="programlisting">describe('simpleDirective', function () {
  var $compile, $rootScope;
  beforeEach(module('firstModule'));
  beforeEach(inject(function (_$compile_, _$rootScope_) {
    $compile = _$compile_;
    $rootScope = _$rootScope_;
  }));

  it('should have our compiled text', function () {
    var element = $compile('&lt;simple-directive test="directive"&gt;&lt;/simple-directive&gt;')($rootScope);
    $rootScope.$digest();
    expect(element.html()).toContain('This is an example directive.');
  });

});</pre></div></div><div class="section" title="Unit testing services"><div class="titlepage"><div><div><h2 class="title"><a id="ch15lvl2sec621"/>Unit testing services</h2></div></div></div><p>The final <a class="indexterm" id="id3477"/>testing example will test a service. First, create a service:</p><div class="informalexample"><pre class="programlisting">firstModule.factory('firstFactory', ['$http', function ($http) {
  return {
    addOne: function () {
      return $http.get('/test', {})
      .then(function (res) {
        return res.data.value + 1;
      });
    }
  }
}]);</pre></div><p>Next, you will <a class="indexterm" id="id3478"/>have to load the module, inject <code class="literal">$httpBackend</code> and the service factory, create a response, and load the response. Notice the use of <code class="literal">$httpBackend.flush()</code>. This will send the response to any open requests:</p><div class="informalexample"><pre class="programlisting">describe('firstFactory', function () {
  var $httpBackend, testingFactory, handler;

  beforeEach(module('firstModule'));
  beforeEach(inject(function (_$httpBackend_, firstFactory) {
    $httpBackend = _$httpBackend_;
    handler = $httpBackend.expect('GET', '/test')
    .respond({ value: 1 });
    testingFactory = firstFactory;
  }));

  it('should run the GET request and add one', function () {
    testingFactory.addOne()
    .then(function (data) {
      expect(data).toBe(2);
    });
    $httpBackend.flush();

  });
});</pre></div></div></div></body></html>