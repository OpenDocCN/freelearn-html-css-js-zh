<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Line, Area, and Scatter Charts</h1></div></div></div><p>In this chapter, we will learn about line, area, and scatter charts and explore their plotting options in more details. We will also learn how to create a stacked area chart and projection charts. Then, we will attempt to plot the charts in a slightly more artistic style. The reason for that is to provide us with an opportunity to utilize various plotting options. In this chapter, we will cover the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Introducing line charts</li><li class="listitem" style="list-style-type: disc">Sketching an area chart</li><li class="listitem" style="list-style-type: disc">Highlighting and raising the base level</li><li class="listitem" style="list-style-type: disc">Mixing line and area series</li><li class="listitem" style="list-style-type: disc">Combining scatter and area series</li></ul></div><div><div><div><div><h1 class="title"><a id="ch03lvl1sec24"/>Introducing line charts</h1></div></div></div><p>First let's start with a <a id="id217" class="indexterm"/>single-series line chart. We will use one of the many data sets provided by<a id="id218" class="indexterm"/> <em>The World Bank</em> organization at <a class="ulink" href="http://www.worldbank.org">www.worldbank.org</a>. The following is the code snippet to create a simple line chart that shows the percentage of population aged 65 and above in Japan for the past three decades:</p><div><pre class="programlisting">        var chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container'
            },
            title: {
                text: 'Population ages 65 and over (% of total)'
            },
            credits: { 
                         position: {
                         align: 'left',
                         x: 20
                     },
                     text: 'Data from The World Bank'
            },
            yAxis: {
                       title: {
                       text: 'Percentage %'
                   }
            },
            xAxis: {
                categories: ['1980', '1981', '1982', ... ],
                labels: {
                            step: 5
                        }
                   },
            series: [{
                         name: 'Japan - 65 and over',
                         data: [  9, 9, 9, 10, 10, 10, 10 ... ]
                    }]
});</pre></div><p>The following is the<a id="id219" class="indexterm"/> display of the simple chart:</p><div><img src="img/7451OS_03_01.jpg" alt="Introducing line charts"/></div><p>Instead of specifying the year number manually as strings in categories, we can use the <code class="literal">pointStart</code> option in the <code class="literal">series</code> config to initiate the <em>x</em> axis value for the first point. So we have an empty <code class="literal">xAxis</code> config and <code class="literal">series</code> config, as follows:</p><div><pre class="programlisting">            xAxis: {
            },
            series: [{
                pointStart: 1980,
                name: 'Japan - 65 and over',
                data: [  9, 9, 9, 10, 10, 10, 10 ... ]       
            }]</pre></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec33"/>Extending to multiple-series line charts</h2></div></div></div><p>We can include several <a id="id220" class="indexterm"/>more line series and emphasize the Japan series by<a id="id221" class="indexterm"/> increasing the line width to be <code class="literal">6</code>-pixels wide, as follows:</p><div><pre class="programlisting">            series: [{
                lineWidth: 6,
                name: 'Japan',
                data: [  9, 9, 9, 10, 10, 10, 10 ... ]       
            }, {
                Name: 'Singapore',
                data: [ 5, 5, 5, 5, ... ]
            }, {
                   // Norway, Brazil, and South Africa series data...
                                ...
            }]</pre></div><p>By making that line thicker, the line series for the Japanese population becomes the focus in the chart, as shown in the following screenshot:</p><div><img src="img/7451OS_03_02.jpg" alt="Extending to multiple-series line charts"/></div><p>Let's move on to a more <a id="id222" class="indexterm"/>complicated line graph. For the sake of <a id="id223" class="indexterm"/>demonstrating inverted line graphs, we use the <code class="literal">chart.inverted</code> option to flip the y and x axes to opposite orientations. Then, we change the line colors of the axes to match the same series colors as in the previous chapter. We also disable data point markers for all the series, and finally align the second series to the second entry on the y-axis array, as follows:</p><div><pre class="programlisting">            chart: {
                renderTo: 'container',
                inverted: true
            },
            yAxis: [{
                title: {
                    text: 'Percentage %'
                },
                lineWidth: 2,
                lineColor: '#4572A7'
            }, {
                title: {
                    text: 'Age'
                },
                opposite: true,
                lineWidth: 2,
                lineColor: '#AA4643'
            }],            
            plotOptions: {
                series: {
                    marker: {
                        enabled: false
                    }
                }
            },
            xAxis: {
               categories: [ '1980', '1981', '1982', ...,
                             '2009', '2010' ],
               labels: {
                   step: 5
               }
            },
            series: [{
                name: 'Japan - 65 and over',
                type: 'spline',
                data: [ 9, 9, 9, ... ] 
            }, {
                name: 'Japan - Life Expectancy',
                yAxis: 1,
                data: [ 76, 76, 77, ... ]
            }]</pre></div><p>The following is the<a id="id224" class="indexterm"/> inverted <a id="id225" class="indexterm"/>graph with double y axes:</p><div><img src="img/7451OS_03_03.jpg" alt="Extending to multiple-series line charts"/></div><p>The data representation <a id="id226" class="indexterm"/>of the chart may look slightly odd as the<a id="id227" class="indexterm"/> usual time labels are swapped to the <em>y</em> axis and the data trend is difficult to comprehend. The <code class="literal">inverted</code> option is normally used for showing data in a non-continuous form and in a bar format. If we interpret the data from the graph, 12 percent of the population is 65 or over in 1990, and the life expectancy is 79.</p><p>Setting <code class="literal">plotOptions.series.marker.enabled</code> to <code class="literal">false</code> switches off all the data point markers. If we want to display a point marker for a particular series, we can either switch off the marker globally and then turn the marker on for individual series, or the other way round:</p><div><pre class="programlisting">            plotOptions: {
                series: {
                    marker: {
                        enabled: false
                    }
                }
            },
            series: [{
                marker: {
                    enabled: true
                },
                name: 'Japan - 65 and over',
                type: 'spline',
                data: [ 9, 9, 9, ... ] 
            }, {</pre></div><p>The following graph<a id="id228" class="indexterm"/> demonstrates that only the 65-and-over series <a id="id229" class="indexterm"/>has point markers:</p><div><img src="img/7451OS_03_15.jpg" alt="Extending to multiple-series line charts"/></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec25"/>Highlighting negative values and raising the base level</h1></div></div></div><p>Sometimes, we may want <a id="id230" class="indexterm"/>to highlight both positive and negative regions in<a id="id231" class="indexterm"/> different colors. In such cases, we can specify the series color for negative values with the series option, <code class="literal">negativeColor</code>. Let's create a simple example with inflation data, containing both positive and negative data. Here is the series configuration:</p><div><pre class="programlisting">    plotOptions: {
        line: {
            negativeColor: 'red'
        }
    },
    series: [{
        type: 'line',
        color: '#0D3377',
        marker: {
             enabled: false
        },
        pointStart: 2004, 
        data:[ 2.9, 2.8, 2.4, 3.3, 4.7, 
               2.3, 1.1, 1.0, -0.3, -2.1
        ]
    }]</pre></div><p>We assign the color <a id="id232" class="indexterm"/>red for negative inflation values and disable the markers<a id="id233" class="indexterm"/> in the line series. The line series color is defined by another color, blue, which is used for positive values. The following is the graph showing the series in separate colors:</p><div><img src="img/7451OS_03_21.jpg" alt="Highlighting negative values and raising the base level"/></div><p>Let's create another slightly more advanced example, in which we define the negative territory in terms of the subject. We plot another inflation chart, but based on the <strong>European Central Bank</strong> (<strong>ECB</strong>)<a id="id234" class="indexterm"/> definition of healthy inflation that is 2 percent. Anything below that level is regarded as unhealthy for the economy, so we set the color below that threshold to red. Beside the color threshold, we also set up a plotline on the y-axis to indicate the cut-off level. The following is our first try to set up the chart:</p><div><pre class="programlisting">         yAxis: {
             title: { text: null },
             min: 0, 
             max: 4,
             plotLines: [{
                 value: 2,
                 width: 3,
                 color: '#6FA031',
                 zIndex: 1,
                 label: {
                     text: 'ECB....',
                     ....
                 }
             }]
         },
         xAxis: { type: 'datetime' },
         plotOptions: {
             line: { lineWidth: 3 }
         },
         series: [{
             type: 'line',
             name: 'EU Inflation (harmonized), year-over-year (%)',
             color: '#0D3377',
             marker: { enabled: false },
             data:[ 
                 [ Date.UTC(2011, 8, 1), 3.3 ],
                 [ Date.UTC(2011, 9, 1), 3.3 ],
                 [ Date.UTC(2011, 10, 1), 3.3 ],
                 ....</pre></div><p>We set up a green <a id="id235" class="indexterm"/>plotline along the y-axis at the value 2, 3 pixels<a id="id236" class="indexterm"/> wide. The <code class="literal">zIndex</code> option is to avoid the interval line appearing on top of the plot line. With the inflation line series, we disable the markers and also set the line width to 3 pixels wide. The following is the initial attempt without thresholding:</p><div><img src="img/7451OS_03_19.jpg" alt="Highlighting negative values and raising the base level"/></div><p>Let's apply the <a id="id237" class="indexterm"/>threshold level to the lines series. The default negative <a id="id238" class="indexterm"/>color on the y-axis level is at 0 value. As for this particular example, the base level for a negative color would be 2. To raise the base level to 2, we set the <code class="literal">threshold</code> property along with the <code class="literal">negativeColor</code> option:</p><div><pre class="programlisting">    plotOptions: {
        line: {
            lineWidth: 3,
            negativeColor: 'red',
            threshold: 2
        }
    },</pre></div><p>The preceding modification turns part of the line series red to indicate an alert:</p><div><img src="img/7451OS_03_20.jpg" alt="Highlighting negative values and raising the base level"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec26"/>Sketching an area chart</h1></div></div></div><p>In this section, we are going to<a id="id239" class="indexterm"/> use our very first example and turn it into a more stylish graph (based on the design of a wind energy poster by Kristin Clute): an area spline chart. An <strong>area spline chart</strong><a id="id240" class="indexterm"/> is generated using the combined properties of area and spline charts. The main data line is plotted as a spline curve and the region underneath the line is filled in a similar color with a gradient and opaque style:</p><div><img src="img/7451OS_03_04.jpg" alt="Sketching an area chart"/></div><p>First, we want to make the <a id="id241" class="indexterm"/>graph easier for viewers to look up the values for the current trend, so we move the y-axis values to the right side of the chart, where they will be closest to the most recent year:</p><div><pre class="programlisting">            yAxis: {  ....
                opposite: true
            }</pre></div><p>The next thing is to remove the interval lines and have a thin axis line along the y axis:</p><div><pre class="programlisting">          yAxis: { ....
              gridLineWidth: 0,
              lineWidth: 1,
          }</pre></div><p>Then, we simplify the y-axis title with a percentage sign and align to the top of the axis:</p><div><pre class="programlisting">            yAxis: { ....
                title: {
                    text: '(%)',
                    rotation: 0,
                    x: 10,
                    y: 5,
                    align: 'high'
                },
            }</pre></div><p>As for the x axis, we thicken the axis line with red and remove the interval ticks:</p><div><pre class="programlisting">            xAxis: { ....
                lineColor: '#CC2929',
                lineWidth: 4,
                tickWidth: 0,
                offset: 2
            }</pre></div><p>For the chart title, we move <a id="id242" class="indexterm"/>the title to the right of the chart, increase the margin between the chart and the title, and then adopt a different font for the title:</p><div><pre class="programlisting">            title: {
                text: 'Population ages 65 and over (% of total) - Japan ',
                margin: 40,
                align: 'right',
                style: {
                   fontFamily: 'palatino'
                }
            }</pre></div><p>After that, we are going to modify the whole series presentation, so we first change the <code class="literal">chart.type</code> property from <code class="literal">'line'</code> to <code class="literal">'areaspline'</code>. Notice that setting the properties inside this <code class="literal">series</code> object will overwrite the same properties defined in <code class="literal">plotOptions.areaspline</code> and so on in <code class="literal">plotOptions.series</code>.</p><p>Since so far there is only one series in the graph, there is no need to display the legend box. We can disable it with the <code class="literal">showInLegend</code> property. We then smarten the area part with a gradient color and the spline with a darker color:</p><div><pre class="programlisting">       series: [{
            showInLegend: false,
            lineColor: '#145252',
            fillColor: {
                linearGradient: { 
                    x1: 0, y1: 0, 
                    x2: 0, y2: 1 
                },
                stops:[ [ 0.0, '#248F8F' ] ,
                        [ 0.7, '#70DBDB' ],
                        [ 1.0, '#EBFAFA' ] ]
            },
            data: [ ... ]
       }] </pre></div><p>After that, we introduce a couple of data labels along the line to indicate that the ranking of old age population has increased over time. We use the values in the series data array corresponding to the year 1995 and 2010, and then convert the numerical value entries into data point objects. Since we only want to show point markers for these two years, we turn off markers globally in <code class="literal">plotOptions.series.marker.enabled</code> and set the marker on individually<a id="id243" class="indexterm"/> inside the point objects, accompanied by style settings:</p><div><pre class="programlisting">                plotOptions: {
                    series: {
                        marker: {
                            enabled: false
                        }
                    }
                }, 
                series: [{ ...,
                    data:[ 9, 9, 9, ...,
                           { marker: {
                                 radius: 2, 
                                 lineColor: '#CC2929', 
                                 lineWidth: 2, 
                                 fillColor: '#CC2929',
                                 enabled: true 
                                },
                             y: 14
                           }, 15, 15, 16, ... ]
                }]</pre></div><p>We then set a bounding box around the data labels with round corners (<code class="literal">borderRadius</code>) in the same border color (<code class="literal">borderColor</code>) as the x axis. The data label positions are then finely adjusted with the <code class="literal">x</code> and <code class="literal">y</code> options. Finally, we change the default implementation of the data label formatter. Instead of returning the point value, we print the country ranking:</p><div><pre class="programlisting">                series: [{ ...,
                    data:[ 9, 9, 9, ...,
                           { marker: {
                                ...
                             },
                             dataLabels: {
                                enabled: true,
                                borderRadius: 3,
                                borderColor: '#CC2929',
                                borderWidth: 1,
                                y: -23,
                                formatter: function() {
                                    return "Rank: 15th";
                                }
                             },
                             y: 14
                          }, 15, 15, 16, ... ]
                }]</pre></div><p>The final touch is to apply a gray background to the chart and add extra space for <code class="literal">spacingBottom</code>. The extra space for <code class="literal">spacingBottom</code> is to avoid the credit label and x-axis label getting too close together, because we have disabled the legend box:</p><div><pre class="programlisting">            chart: {
                renderTo: 'container',
                spacingBottom: 30,
                backgroundColor: '#EAEAEA'             
            },</pre></div><p>When all these <a id="id244" class="indexterm"/>configurations are put together, it produces the chart shown in the screenshot at the start of this section.</p></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec27"/>Mixing line and area series</h1></div></div></div><p>In this section, we are going <a id="id245" class="indexterm"/>to explore different plots including line and area<a id="id246" class="indexterm"/> series together, as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating a projection chart, where a single trend line is joined with two series in different line styles</li><li class="listitem" style="list-style-type: disc">Plotting an area spline chart with another step line series</li><li class="listitem" style="list-style-type: disc">Exploring a stacked area spline chart, where two area spline series are stacked on top of each other</li></ul></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec34"/>Simulating a projection chart</h2></div></div></div><p>The projection chart has a <a id="id247" class="indexterm"/>spline area with the section of real data, and continues in a dashed line with the projection data. To do that we separate the data into two series, one for real data and the other for projection data. The following is the series configuration code for the data from the year 2015 to 2024. This data is based on the National Institute of <a id="id248" class="indexterm"/>Population and Social Security Research report (<a class="ulink" href="http://www.ipss.go.jp/pp-newest/e/ppfj02/ppfj02.pdf">http://www.ipss.go.jp/pp-newest/e/ppfj02/ppfj02.pdf</a>):</p><div><pre class="programlisting">            series: [{
                name: 'project data',
                type: 'spline',
                showInLegend: false, 
                lineColor: '#145252',                
                dashStyle: 'Dash',
                data: [ [ 2015, 26 ], [ 2016, 26.5 ],
                          ... [ 2024, 28.5 ] ]
            }]</pre></div><p>The future series is configured as a spline in a dashed line style and the legend box is disabled, because we want to show both series as being part of the same series. Then we set the future (second) series color the same as the first series. The final part is to construct the series data. As we specify the x-axis time data with the <code class="literal">pointStart</code> property, we need to align the projection data after 2014. There are two approaches that we can use to specify the time <a id="id249" class="indexterm"/>data in a continuous form, as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Insert null values into the second series data array for padding, to align with the real data series</li><li class="listitem" style="list-style-type: disc">Specify the second series data in <code class="literal">tuples</code>, an array with both time and projection data</li></ul></div><p>Here we are going to use the second approach because the series presentation is simpler. The following is the screenshot for the future data series only:</p><div><img src="img/7451OS_03_16.jpg" alt="Simulating a projection chart"/></div><p>The real data series is exactly the same as the graph in the screenshot at the start of the <em>Sketching an area chart</em> section, except without the point markers and data labels decorations. The next step is to join both series together, as follows:</p><div><pre class="programlisting">            series: [{
                name: 'real data',
                type: 'areaspline',
                .... 
            }, {
                name: 'project data',
                type: 'spline',
                ....
            }]</pre></div><p>Since there is no overlap between <a id="id250" class="indexterm"/>both series data, they produce a smooth projection graph:</p><div><img src="img/7451OS_03_09.jpg" alt="Simulating a projection chart"/></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec35"/>Contrasting a spline with a step line</h2></div></div></div><p>In this section, we are <a id="id251" class="indexterm"/>going to plot an area spline series with another<a id="id252" class="indexterm"/> line series, but in step presentation. The step line transverses vertically and horizontally according to changes in series data only. It is generally used for presenting discrete data: data without continuous/gradual movement.</p><p>For the purpose of showing a step line, we will continue from the first area spline example. First of all, we need to enable the legend by removing the disabled <code class="literal">showInLegend</code> setting and also remove <code class="literal">dataLabels</code> in the series data.</p><p>Next is to include a new series—<strong>Ages 0 to 14</strong>—in the chart with the default line type. Then, we change the line style slightly into different steps. The following is the configuration for both series:</p><div><pre class="programlisting">            series: [{
                name: 'Ages 65 and over',
                type: 'areaspline',
                lineColor: '#145252',
                pointStart: 1980,
                fillColor: {
                    ....
                },
                data: [ 9, 9, 9, 10, ...., 23 ]
            }, {
              name: 'Ages 0 to 14',
              // default type is line series
              step: true,
              pointStart: 1980,
              data: [ 24, 23, 23, 23, 22, 22, 21,
                      20, 20, 19, 18, 18, 17, 17, 16, 16, 16,
                      15, 15, 15, 15, 14, 14, 14, 14, 14, 14,
                      14, 14, 13, 13 ]
            }]</pre></div><p>The following <a id="id253" class="indexterm"/>screenshot shows <a id="id254" class="indexterm"/>the second series in line step style:</p><div><img src="img/7451OS_03_05.jpg" alt="Contrasting a spline with a step line"/></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec36"/>Extending to the stacked area chart</h2></div></div></div><p>In this section, we are<a id="id255" class="indexterm"/> going to turn both series into area splines and stack them on top of each other to create a stacked area chart. As the data series are stacked together, we can observe the series quantities as individual, proportional, and total amounts.</p><p>Let's change the second series into another <code class="literal">'areaspline'</code> type:</p><div><pre class="programlisting">              name: 'Ages 0 to 14',
              type: 'areaspline',
              pointStart: 1980,
              data: [ 24, 23, 23, ... ]</pre></div><p>Set the <code class="literal">stacking</code> option to <code class="literal">'normal'</code> as a default setting for <code class="literal">areaspline</code>, as follows:</p><div><pre class="programlisting">           plotOptions: {
                areaspline: {
                  stacking: 'normal'
                }
           }</pre></div><p>This sets both area graphs stacked on top of each other. By doing so, we can observe from the data that both age groups roughly compensate for each other to make up a total of around 33 percent of the overall population, and the <strong>Ages 65 and over</strong> group is increasingly outpaced in the later stage:</p><div><img src="img/7451OS_03_06.jpg" alt="Extending to the stacked area chart"/></div><p>Suppose we have three<a id="id256" class="indexterm"/> area spline series and we only want to stack two of them (although it is clearer to do that in a column chart rather than in an area spline chart). As described in the <em>Exploring PlotOptions</em> section in <a class="link" href="ch02.html" title="Chapter 2. Highcharts Configurations">Chapter 2</a>, <em>Highcharts Configurations</em>, we can set the <code class="literal">stacking</code> option in <code class="literal">plotOptions.series</code> to <code class="literal">'normal'</code>, and manually turn off <code class="literal">stacking</code> in the third series configuration. The following is the series configuration with another series:</p><div><pre class="programlisting">            plotOptions: {
                series: {
                  marker: {
                     enabled: false
                  },
                  stacking: 'normal'
                }
            },
            series: [{
                name: 'Ages 65 and over',
                ....
            }, {
                name: 'Ages 0 to 14',
                ....
            }, {
                name: 'Ages 15 to 64',
                type: 'areaspline',
                pointStart: 1980,
                stacking: null,
                data: [ 67, 67, 68, 68, .... ]
            }]</pre></div><p>This creates an area spline<a id="id257" class="indexterm"/> graph with the third series <strong>Ages 15 to 64</strong> covering the other two stacked series, as shown in the following screenshot:</p><div><img src="img/7451OS_03_17.jpg" alt="Extending to the stacked area chart"/></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec37"/>Plotting charts with missing data</h2></div></div></div><p>If a series has missing data, then <a id="id258" class="indexterm"/>the default action of Highcharts is to display the series as a broken line. There is an option—<code class="literal">connectNulls</code>—that allows a series line to continue even if there is missing data. The default value for this option is <code class="literal">false</code>. Let's examine the default behavior by setting two spline series with null data points. We also enable the point markers, so that we can clearly view the missing data points:</p><div><pre class="programlisting">            series: [{
                name: 'Ages 65 and over',
                connectNulls: true,
                ....,
                // Missing data from 2004 - 2009
                data: [ 9, 9, 9, ..., null, null, null, 22, 23 ]

            }, {
                name: 'Ages 0 to 14',
                ....,
                // Missing data from 1989 - 1994
                data: [ 24, 23, 23, ..., 19, null, null, ..., 13 ]
            }]</pre></div><p>The following is a chart with the spline series presenting missing points in different styles:</p><div><img src="img/7451OS_03_18.jpg" alt="Plotting charts with missing data"/></div><p>As we can see, the <strong>Ages 0 to 14</strong> series <a id="id259" class="indexterm"/>has a clear broken line, whereas <strong>Ages 65 and over</strong> is configured by setting <code class="literal">connectNulls</code> to <code class="literal">true</code>, which joins the missing points with a spline curve. If the point marker is not enabled, we wouldn't be able to notice the difference.</p><p>However, we should use this option with caution and it should certainly never be enabled with the <code class="literal">stacking</code> option. Suppose we have a stacked area chart with both series and there is missing data only in the <strong>Ages 0 to 14</strong> series, which is the bottom series. The default action for the missing data will make the graph look like the following screenshot:</p><div><img src="img/7451OS_03_07.jpg" alt="Plotting charts with missing data"/></div><p>Although the bottom series does <a id="id260" class="indexterm"/>show the broken part, the stack graph overall still remains correct. The same area of the top series drops back to single-series values and the overall percentage is still intact.</p><p>The problem arises when we set the <code class="literal">connectNulls</code> option to <code class="literal">true</code> and do not realize that there is missing data in the series. This results in an inconsistent graph, as follows:</p><div><img src="img/7451OS_03_08.jpg" alt="Plotting charts with missing data"/></div><p>The bottom series covers a<a id="id261" class="indexterm"/> hole left from the top series that contradicts the stack graph's overall percentage.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec28"/>Combining the scatter and area series</h1></div></div></div><p>Highcharts also<a id="id262" class="indexterm"/> supports a scatter chart that enables us to plot the <a id="id263" class="indexterm"/>data trend from a large set of data samples. Here we are going to use the scatter series differently, which makes our chart a bit like a poster chart.</p><p>First, we are going to use a subset of the <code class="literal">'Ages 0 to 14'</code> data and set the series to the <code class="literal">scatter</code> type:</p><div><pre class="programlisting">              name: 'Ages 0 to 14',
              type: 'scatter',
              data: [ [ 1982, 23 ], [ 1989, 19 ], 
                      [ 2007, 14 ], [ 2004, 14 ], 
                      [ 1997, 15 ], [ 2002, 14 ], 
                      [ 2009, 13 ], [ 2010, 13 ] ]</pre></div><p>Then, we will enable the data labels for the <code class="literal">scatter</code> series and make sure the <code class="literal">marker</code> shape is always <code class="literal">'circle'</code>, as follows:</p><div><pre class="programlisting">          plotOptions: {
              scatter: {
                  marker: {
                      symbol: 'circle'
                  },
                  dataLabels: {
                      enabled: true
                  }
              }
          }</pre></div><p>The preceding code <a id="id264" class="indexterm"/>snippet gives <a id="id265" class="indexterm"/>us the following graph:</p><div><img src="img/7451OS_03_10.jpg" alt="Combining the scatter and area series"/></div><div><div><h3 class="title"><a id="tip05"/>Tip</h3><p>Highcharts provides a list of marker symbols as well as allowing users to supply their own marker icons (see <a class="link" href="ch02.html" title="Chapter 2. Highcharts Configurations">Chapter 2</a>, <em>Highcharts Configurations</em>). The list of supported symbols contains: circle, square, diamond, triangle, and triangle-down.</p></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec38"/>Polishing a chart with an artistic style</h2></div></div></div><p>The next step is to format <a id="id266" class="indexterm"/>each scatter point into a bubble style with <a id="id267" class="indexterm"/>the <code class="literal">radius</code> property and manually set the data label font size proportional to the percentage value.</p><div><div><h3 class="title"><a id="note09"/>Note</h3><p>The reason we used the scatter series instead of the bubble series is because most of the material in this chapter was written for the first edition; this chart was created with an earlier version of Highcharts that didn't support the bubble series.</p></div></div><p>Then use the <code class="literal">verticalAlign</code> property<a id="id268" class="indexterm"/> to adjust the labels to center inside the enlarged <a id="id269" class="indexterm"/>scatter points. The various sizes of scatter points require us to present each data point with different attributes. Therefore, we need to change the series data definition into an array of point object configurations, such as:</p><div><pre class="programlisting">            plotOptions: {
              scatter: {
                  marker: {
                      symbol: 'circle'
                  },
                  dataLabels: {
                      enabled: true,
                      verticalAlign: 'middle'
                  }
              }
            },
            data: [ { 
                dataLabels: {
                    style: { 
                        fontSize: '25px' 
                    } 
                }, 
                marker: { radius: 31 }, 
                y: 23, 
                x: 1982 
                }, { 
                dataLabels: {
                    style: { 
                        fontSize: '22px' 
                    } 
                }, 
                marker: { radius: 23 }, 
                y: 19, 
                x: 1989 
            }, .....</pre></div><p>The following screenshot shows a graph with a sequence of data points, starting with a large marker size and font, then gradually becoming smaller according to their percentage values:</p><div><img src="img/7451OS_03_11.jpg" alt="Polishing a chart with an artistic style"/></div><p>Now, we have two issues <a id="id270" class="indexterm"/>with the preceding graph. First, the scatter series <a id="id271" class="indexterm"/>color (the default second series color) clashes with the gray text labels inside the markers, making them hard to read.</p><p>To resolve this issue, we will change the scatter series to a lighter color with the gradient setting:</p><div><pre class="programlisting">        color: {
            linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
            stops: [ [ 0, '#FF944D' ],
                     [ 1, '#FFC299' ] ]
        },</pre></div><p>Then, we give the scatter points a darker outline in <code class="literal">plotOptions</code>, as follows:</p><div><pre class="programlisting">             plotOptions: {
                 scatter: {
                      marker: {
                           symbol: 'circle',
                           lineColor: '#E65C00',
                           lineWidth: 1
                      },</pre></div><p>Secondly, the data points are blocked by the end of the axes' ranges. The issue can be resolved by introducing extra padding spaces into both axes:</p><div><pre class="programlisting">                  yAxis: {
                       .....,
                       maxPadding: 0.09
                  }, 
                  xAxis: {
                       .....,
                       maxPadding: 0.02
                  }</pre></div><p>The following is the new look for the graph:</p><div><img src="img/7451OS_03_12.jpg" alt="Polishing a chart with an artistic style"/></div><p>For the next part, we will <a id="id272" class="indexterm"/>put up a logo and some decorative text. There<a id="id273" class="indexterm"/> are two ways to import an image into a chart—the <code class="literal">plotBackgroundImage</code> option or the <code class="literal">renderer.image</code> API call. The <code class="literal">plotBackgroundImage</code> option brings the whole image into the chart background, which is not what we intend to do. The <code class="literal">renderer.image</code> method offers more control over the location and size of the image. The following is the call after the chart is created:</p><div><pre class="programlisting">      var chart = new Highcharts.Chart({
                      ...
                  });
      chart.renderer.image('logo.png', 240, 10, 187, 92).add();</pre></div><p><code class="literal">logo.png</code> is the URL path for the logo image file. The next two parameters are the x and y positions (starting from 0, where 0 is the upper-left corner) of the chart where the image will be displayed. The last two parameters are the width and height of the image file. The <code class="literal">image</code> call basically returns an <code class="literal">element</code> object and the subsequent <code class="literal">.add</code> call puts the returned image object into the renderer.</p><p>As for the decorative text, it <a id="id274" class="indexterm"/>is a red circle with white bold text in a different size. They <a id="id275" class="indexterm"/>are all created from the renderer. In the following code snippet, the first renderer call is to create a red circle with x and y locations, and radius size. Then SVG attributes are immediately set with the <code class="literal">attr</code> method that configures the transparency and outline in a darker color. The next three renderer calls are to create text inside the red circle and set up the text using the <code class="literal">css</code> method for font size, style, and color. We will revisit <code class="literal">chart.renderer</code> as part of the Highcharts API in <a class="link" href="ch10.html" title="Chapter 10. Highcharts APIs">Chapter 10</a>, <em>Highcharts APIs</em>:</p><div><pre class="programlisting">        // Red circle at the back
        chart.renderer.circle(220, 65, 45).attr({
             fill: '#FF7575',
            'fill-opacity': 0.6,
             stroke: '#B24747',
            'stroke-width': 1
        }).add();
        // Large percentage text with special font
        chart.renderer.text('37.5%', 182, 63).css({
             fontWeight: 'bold',
             color: '#FFFFFF',
             fontSize: '30px',
             fontFamily: 'palatino'
        }).add();
        // Align subject in the circle
        chart.renderer.text('65 and over', 184, 82).css({
            'fontWeight': 'bold',
        }).add();
        chart.renderer.text('by 2050', 193, 96).css({
            'fontWeight': 'bold',
        }).add();</pre></div><p>Finally, we move the legend box to the top of the chart. In order to locate the legend inside the plot area, we need to set the <code class="literal">floating</code> property to <code class="literal">true</code>, which forces the legend into a fixed layout mode. Then, we remove the default border line and set the legend items list into a vertical direction:</p><div><pre class="programlisting">            legend: {
                floating: true,
                verticalAlign: 'top',
                align: 'center',
                x: 130,
                y: 40,
                borderWidth: 0,
                layout: 'vertical'
            },</pre></div><p>The following is our final <a id="id276" class="indexterm"/>graph <a id="id277" class="indexterm"/>with the decorations:</p><div><img src="img/7451OS_03_13.jpg" alt="Polishing a chart with an artistic style"/></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec29"/>Summary</h1></div></div></div><p>In this chapter, we have explored the usage of line, area, and scatter charts. We have seen how much flexibility Highcharts can offer to make a poster-like chart.</p><p>In the next chapter, we will learn how to plot column and bar charts with their plotting options.</p></div></body></html>