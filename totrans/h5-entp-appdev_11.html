<html><head></head><body><div class="chapter" title="Chapter&#xA0;11.&#xA0;Finishing Up: Debugging Your App"><div class="titlepage"><div><div><h1 class="title"><a id="ch11"/>Chapter 11. Finishing Up: Debugging Your App</h1></div></div></div><a id="id618" class="indexterm"/><p>The debugging process can require a considerable amount of time during the development process. There may be unforeseen behavior, edge cases, and even typos that need to be found and resolved. For that reason, it is necessary to optimize as much as possible and the most important first step is in selecting the right tools. Any development process has to involve testing and debugging; even if your application is working perfectly as expected you should execute test cases and analyze performance to ensure its integrity as you make it evolve and introduce new features. This chapter covers a series of tools for debugging and analyzing performance in your enterprise applications.</p><p>This chapter will cover the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">What to look for</li><li class="listitem" style="list-style-type: disc">Which tools to use</li><li class="listitem" style="list-style-type: disc">Playing with HTML and CSS</li><li class="listitem" style="list-style-type: disc">Step by step with JavaScript</li><li class="listitem" style="list-style-type: disc">Mobile debugging</li><li class="listitem" style="list-style-type: disc">Web debugging proxies</li></ul></div><div class="section" title="What to look for"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec85"/>What to look for</h1></div></div></div><p>The debugging process on the client focuses on elements interpreted by a browser. Unless we are using an external plugin (like the Adobe Flash Player), we need to debug:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">HTML to find incorrect styles or test changes in our tag structure</li><li class="listitem" style="list-style-type: disc">CSS to verify correctness of styles or test changes on them</li><li class="listitem" style="list-style-type: disc">JavaScript to validate code execution, find possible errors, or test changes in our code</li></ul></div><p>Additionally, we should test the load time of assets (<code class="literal">media</code>, <code class="literal">html</code>, <code class="literal">css</code>, and <code class="literal">js</code> files) and execution time of JavaScript (profiling). </p></div></div>
<div class="section" title="Which tools to use"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec86"/>Which tools to use</h1></div></div></div><p>Most modern browsers now provide tools for debugging web applications. Because cross-browser compatibility is important, we need to know how they work. In general, every debugger gives you the ability to do the following:<a id="id619" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Inspect and modify HTML in real time and select visual elements on the page and show its equivalents in HTML code (<span class="strong"><strong>HTML</strong></span> | <span class="strong"><strong>Elements</strong></span>)</li><li class="listitem" style="list-style-type: disc">Inspect and modify CSS in real time (<span class="strong"><strong>HTML</strong></span> |<span class="strong"><strong>Elements</strong></span> or <span class="strong"><strong>CSS</strong></span> | <span class="strong"><strong>Resources</strong></span> | <span class="strong"><strong>Style</strong></span>)</li><li class="listitem" style="list-style-type: disc">Inspect and modify (or declare) JavaScript in real time and create breakpoints to stop code execution and inspect step by step (<span class="strong"><strong>Console</strong></span> | <span class="strong"><strong>Script</strong></span> | <span class="strong"><strong>Sources</strong></span>)</li><li class="listitem" style="list-style-type: disc">Analysis of loading time of each asset (<span class="strong"><strong>Network</strong></span> | <span class="strong"><strong>Net</strong></span> | <span class="strong"><strong>Timeline</strong></span> | <span class="strong"><strong>Instrument</strong></span>)</li></ul></div><p>Let us take a look at some of the most popular browsers' debugging tools:<a id="id620" class="indexterm"/>
</p><div class="mediaobject"><img src="graphics/5689_11_02.jpg" alt="Which tools to use"/><div class="caption"><p>Firefox 15.0.1 Firebug (plugin)</p></div></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip63"/>Tip</h3><a id="id621" class="indexterm"/><p>The Firebug plugin<a id="id622" class="indexterm"/> is not installed by default on Firefox. You will need to go to <a class="ulink" href="http://getfirebug.com/">http://getfirebug.com/</a> and click on <span class="strong"><strong>Install Firebug </strong></span>from Firefox.</p></div></div><div class="mediaobject"><img src="graphics/5689_11_03.jpg" alt="Which tools to use"/><div class="caption"><p>Chrome 22.0.1229.79 Developer Tools</p></div></div><a id="id623" class="indexterm"/><p>For our purposes and because it is one of the most robust tools, we are going to walk through the Firebug plugin for Firefox. Many of the same basic concepts (HTML inspection, script debugging, use of the console) exist in the developer tools provided in other browsers.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note26"/>Note</h3><p>There are many debugging tools available for Internet Explorer in particular. In addition to the Developer Tools included in Internet Explorer 8 and 9, there is <a id="id624" class="indexterm"/>DebugBar (<a class="ulink" href="http://www.debugbar.com/">http://www.debugbar.com/</a>) and dynaTrace (<a class="ulink" href="http://www.compuware.com/application-performance-management/ajax-performance-testing.html">http://www.compuware.com/application-performance-management/ajax-performance-testing.html</a>).<a id="id625" class="indexterm"/>
</p></div></div></div>
<div class="section" title="Playing with HTML and CSS"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec87"/>Playing with HTML and CSS</h1></div></div></div><a id="id626" class="indexterm"/><a id="id627" class="indexterm"/><p>In Firebug, you can explore your HTML DOM objects using the <span class="strong"><strong>HTML</strong></span> tab<a id="id628" class="indexterm"/>:</p><div class="mediaobject"><img src="graphics/5689_11_05.jpg" alt="Playing with HTML and CSS"/></div><a id="id629" class="indexterm"/><a id="id630" class="indexterm"/><p>Hovering on each tag, it is possible to see its corresponding rendered element highlighted. If you decide to navigate through the rendered page, you can click on the Inspect button.</p><div class="mediaobject"><img src="graphics/5689_11_06.jpg" alt="Playing with HTML and CSS"/></div><p>The Inspect button allows you to select areas of the rendered page to see the corresponding HTML code.</p><div class="mediaobject"><img src="graphics/5689_11_07.jpg" alt="Playing with HTML and CSS"/></div><p>By clicking on <span class="strong"><strong>Edit</strong></span>, it is possible to modify your HTML code within the browser itself. Of course, you are not modifying the page itself but rather the browser's local copy. The rendered page changes automatically as a result of the modifications. This is very useful in trying out changes to your HTML structure and getting instant feedback before implementing them in your code. <a id="id631" class="indexterm"/>
<a id="id632" class="indexterm"/>
</p><p>The right-hand side panel allows us to view styles of the DOM object selected, including references to the file and line number (in the right-hand side highlighted in blue). The <span class="strong"><strong>Style</strong></span> tab<a id="id633" class="indexterm"/> groups the styles by priority; you can modify or create properties or modify selectors in this tab with a double-click.</p><div class="mediaobject"><img src="graphics/5689_11_08.jpg" alt="Playing with HTML and CSS"/></div><a id="id634" class="indexterm"/><a id="id635" class="indexterm"/><p>
<span class="strong"><strong>Computed</strong></span> lists the computed styles, which are a merger of browser, user, and author-applied styles where relative values are calculated. For example, if a <code class="literal">div</code> tag has a style of <code class="literal">width:50%</code>, and it is surrounded by a <code class="literal">div</code> set to <code class="literal">width:760px</code>, then the computed style will be <code class="literal">width:380px</code>.</p><div class="mediaobject"><img src="graphics/5689_11_09.jpg" alt="Playing with HTML and CSS"/></div><a id="id636" class="indexterm"/><a id="id637" class="indexterm"/><p>
<span class="strong"><strong>Layout</strong></span> displays a graphic representation of the padding, border, and margin applied based on the CSS box model.</p><div class="mediaobject"><img src="graphics/5689_11_10.jpg" alt="Playing with HTML and CSS"/></div><a id="id638" class="indexterm"/><a id="id639" class="indexterm"/><p>
<span class="strong"><strong>DOM</strong></span> shows the selected DOM's object properties. There is a wealth of information here including the <code class="literal">document</code> object as a "browseable" tree and the ability to see the JavaScript global namespace to see which objects have been loaded. </p><div class="mediaobject"><img src="graphics/5689_11_11.jpg" alt="Playing with HTML and CSS"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip64"/>Tip</h3><a id="id640" class="indexterm"/><a id="id641" class="indexterm"/><p>You can use the <span class="strong"><strong>CSS</strong></span> tab to modify your styles as they are in each <code class="literal">css</code> file.</p></div></div></div>
<div class="section" title="Step by step with JavaScript"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec88"/>Step by step with JavaScript</h1></div></div></div><a id="id642" class="indexterm"/><a id="id643" class="indexterm"/><p>The <span class="strong"><strong>Script</strong></span> tab allows you to inspect all JavaScript files used.  </p><div class="mediaobject"><img src="graphics/5689_11_12.jpg" alt="Step by step with JavaScript"/></div><a id="id644" class="indexterm"/><p>After selecting the file that you wish to inspect, you can execute a step-by-step execution of your JavaScript code. Find the line where you want to stop and click on the line number to create a breakpoint. A graphic representing the breakpoint will appear. <a id="id645" class="indexterm"/>
</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip65"/>Tip</h3><p>Minified JavaScript files will generally show up as a single line when viewed in the <span class="strong"><strong>Script</strong></span> tab<a id="id646" class="indexterm"/>. It is useful to include "unminified" files in debug versions of your page.</p></div></div><div class="mediaobject"><img src="graphics/5689_11_13.jpg" alt="Step by step with JavaScript"/></div><a id="id647" class="indexterm"/><p>Now refresh the browser and you will see how the execution stops on that line.<a id="id648" class="indexterm"/>
</p><div class="mediaobject"><img src="graphics/5689_11_14.jpg" alt="Step by step with JavaScript"/></div><a id="id649" class="indexterm"/><p>The right-hand side panel will show you variables available in the present scope. You can use this to change variable values, input your own variables, or check expressions.</p><div class="mediaobject"><img src="graphics/5689_11_15.jpg" alt="Step by step with JavaScript"/></div><a id="id650" class="indexterm"/><p>In the top-right corner you will find controls to continue code execution:<a id="id651" class="indexterm"/>
</p><div class="mediaobject"><img src="graphics/5689_11_16.jpg" alt="Step by step with JavaScript"/></div><p>The play symbol continues the code execution, the small yellow arrow pointing down continues execution to the next line and will enter a function if one is invoked, the large yellow arrow pointing down continues execution to the next line in the current execution context and passes over functions that are invoked, and the last yellow arrow steps out of a function. Of course, you can always hover over each button to get this information as there is usually a tool tip for each button. This allows you to control how you want to step through your code. You can stop by placing a breakpoint where you want to understand how a particular block of code is evaluating. You can then step through each line of code thereafter, executing method invocations you are not concerned about or stepping out entirely to a calling method. At each step, you can see what variables get set, what is available in the current scope, and really get a sense for what your code is doing.</p><div class="section" title="JavaScript console"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec83"/>JavaScript console</h2></div></div></div><a id="id652" class="indexterm"/><p>The <span class="strong"><strong>Console</strong></span> tab logs JavaScript errors, warnings, and Ajax calls. You can force your code to write to the console using the following in your JavaScript code:</p><div class="informalexample"><pre class="programlisting">console.log("CONTENT TO WRITE"); </pre></div><p>This is particularly useful for writing messages out to understand how your code is executing. You can write debug statements to show particular variable values or just indicate that a specific block is executing. You can print objects too and inspect them in Firebug.</p><p>The console object includes other useful debugging methods such as <code class="literal">info()</code>, <code class="literal">warn()</code>, and <code class="literal">error()</code> to give you more enhanced debugging feedback.</p><div class="mediaobject"><img src="graphics/5689_11_17.jpg" alt="JavaScript console"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip66"/>Tip</h3><p>It is good practice to remove or comment out all <code class="literal">console</code> calls in your code when you deploy to production as some browsers do not support it and will break and stop execution entirely. One solution for this is to create a script that removes these lines and include it in your build process. Oftentimes, such a script also packages and minifies your code.</p></div></div><p>An interesting feature of the console is that it lets you write code and execute it in real time. You can find a prompt at the bottom that allows you to enter code.</p><p>Let us say you want to print all images inside the object with the <code class="literal">movies-near-me</code> ID, you can write this in your console:<a id="id653" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">$("#movies-near-me img").each(function(){console.log($(this).attr("src"))})</pre></div><p>You should see the following result:</p><div class="mediaobject"><img src="graphics/5689_11_18.jpg" alt="JavaScript console"/></div></div><div class="section" title="Analyzing load times"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec84"/>Analyzing load times</h2></div></div></div><a id="id654" class="indexterm"/><p>The <span class="strong"><strong>Net</strong></span> tab<a id="id655" class="indexterm"/> compiles all network calls including status, domain, file size, IP, and load time. You can use this section to verify where performance problems lie.</p><div class="mediaobject"><img src="graphics/5689_11_19.jpg" alt="Analyzing load times"/></div></div><div class="section" title="JavaScript profiling"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec85"/>JavaScript profiling</h2></div></div></div><a id="id656" class="indexterm"/><p>The <span class="strong"><strong>Console</strong></span> tab<a id="id657" class="indexterm"/> provides a profile tool to analyze performance of our JavaScript code. To execute a profile, click on the <span class="strong"><strong>Profile</strong></span> button, then execute your JavaScript action (or refresh the page if you want to profile the main JavaScript execution) and click on the <span class="strong"><strong>Profile</strong></span> button again.</p><div class="mediaobject"><img src="graphics/5689_11_20.jpg" alt="JavaScript profiling"/></div><p>No need to worry if the functions are registered as <span class="strong"><strong>anonymous</strong></span>. The <span class="strong"><strong>File</strong></span> field gives the exact line of code.<a id="id658" class="indexterm"/>
</p></div></div>
<div class="section" title="Mobile debugging"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec89"/>Mobile debugging</h1></div></div></div><p>Debugging HTML, CSS, and JavaScript can be painful in mobile web applications, particularly if we are using a touch device. Remote debugging provides a way to test your<a id="id659" class="indexterm"/> enterprise web applications in mobile devices using your desktop or laptop. </p><p>Chrome supports remote debugging via USB for Android devices: <a class="ulink" href="https://developers.google.com/chrome/mobile/docs/debugging">https://developers.google.com/chrome/mobile/docs/debugging</a>.</p><p>Firefox 15 introduces remote debugging for Android too: <a class="ulink" href="https://hacks.mozilla.org/2012/08/remote-debugging-on-firefox-for-android/">https://hacks.mozilla.org/2012/08/remote-debugging-on-firefox-for-android/</a>
</p><p>Previous to Version 6, iOS devices had a simple interface inside the device for debugging. </p><div class="mediaobject"><img src="graphics/5689_11_21.jpg" alt="Mobile debugging"/></div><p>Safari 6.0.1 (Mac only) and iOS 6 support remote debugging. To start remote debugging in any iOS 6:<a id="id660" class="indexterm"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In the device (iPhone, iPad, or iPod) go to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Safari</strong></span> | <span class="strong"><strong>Advanced</strong></span> and enable the <span class="strong"><strong>Web Inspector</strong></span> option<a id="id661" class="indexterm"/>.</li><li class="listitem">Open Safari in a Mac computer.</li><li class="listitem">Open the web application to debug using Safari in your iOS device.</li><li class="listitem">Connect the device to your Mac computer using a USB cable.</li><li class="listitem">If you don't have the <span class="strong"><strong>Develop</strong></span> menu item on Safari (Mac), open <span class="strong"><strong>Safari</strong></span> | <span class="strong"><strong>Preferences</strong></span> | <span class="strong"><strong>Advanced</strong></span> and check <span class="strong"><strong>Show Develop menu in the menu bar</strong></span>.</li><li class="listitem"><span class="strong"><strong>Go to Develop</strong></span> | <span class="strong"><strong>Device name</strong></span> and then choose the <span class="strong"><strong>web application</strong></span>.</li><li class="listitem">You should now see a web inspector.</li><li class="listitem">There is also an online tool called JConsole, which allows you to remotely control and debug browsers in other windows and even devices. It works by giving you a script reference to include in the application you are debugging. It then provides a console to which you can send <code class="literal">console.log</code> messages and other debugging information. More information can be found at <a class="ulink" href="http://jsconsole.com/remote-debugging.html">http://jsconsole.com/remote-debugging.html</a>.</li></ol></div></div>
<div class="section" title="Web debugging proxies"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec90"/>Web debugging proxies</h1></div></div></div><p>A proxy is a piece of hardware that acts as an intermediary between the client and server. Application of software proxies as a way to debug web applications is a widely used practice, the main purpose of which involves inspecting data from requests and viewing the server responses.<a id="id662" class="indexterm"/>
</p><p>On the Windows platform, we recommend Fiddler. It can be found at <a class="ulink" href="http://www.fiddler2.com/fiddler2/">http://www.fiddler2.com/fiddler2/</a>. If you are using a Mac, you can use Charles, which is found at <a class="ulink" href="http://www.charlesproxy.com/">http://www.charlesproxy.com/</a>. Both are web proxies that record the communication between server and client.</p><p>Simply open the application, turn on the capture, and load your web application. Here you can see Charles capturing MovieNow requests:</p><div class="mediaobject"><img src="graphics/5689_11_22.jpg" alt="Web debugging proxies"/></div><p>It is possible to simulate responses using proxies as well. For example, in Charles you <a id="id663" class="indexterm"/>can go to <span class="strong"><strong>Tools</strong></span> and then <span class="strong"><strong>Map Local...</strong></span> to use local files or services as the response to your application. You can use <span class="strong"><strong>Rewrite...</strong></span> in the same menu to modify part of a response and send it back to your application. This is a valuable feature for testing edge cases.</p><div class="mediaobject"><img src="graphics/5689_11_23.jpg" alt="Web debugging proxies"/></div><p>If you want to use Charles with an iOS device and carry out remote debugging, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Get your Mac IP using the <a id="id664" class="indexterm"/><code class="literal">ipconfig getifaddr en1.</code> command in Terminal.</li><li class="listitem">Activate the option <span class="strong"><strong>Enable Mac OS X Proxy</strong></span> in the <span class="strong"><strong>Proxy</strong></span> menu.</li><li class="listitem">Connect your iOS device to the same network used by your Mac computer running Charles.</li><li class="listitem">In your iOS device, go to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Wi-Fi</strong></span> and click on the blue arrow for your connection and in the <span class="strong"><strong>HTTP Proxy</strong></span> section insert your Mac IP and the port used by Charles (by default it is 8888).</li><li class="listitem">Go to Safari in your iOS device and navigate.</li><li class="listitem">A warning should show in Charles informing you that a new connection has been attempted. Click on <span class="strong"><strong>Allow</strong></span>.</li><li class="listitem">Now you should be able to record your traffic.<a id="id665" class="indexterm"/></li></ol></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec91"/>Summary</h1></div></div></div><p>In this chapter, we covered useful debugging tools including mobile and web proxies as well as ways of manipulating HTML, CSS, and JavaScript in the browser in order to debug our applications. As developers, it is good practice for us to understand all the available options for debugging our code. While debugging errors that happen only in one browser, we must pay special attention to the technical restrictions and features of that browser because these limitations are often the cause. For example, complicated JavaScript code can be slow in browsers like Internet Explorer 7. Using the tools available for that browser gives us insight into the internals of that browser and thus knowledge about preventing bugs in the future.</p><p>In the next chapter, we will go over testing tools and frameworks for enterprise application projects and the advantages of automated functional testing.</p></div></body></html>