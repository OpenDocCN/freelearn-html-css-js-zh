<html><head></head><body><div class="chapter" title="Chapter&#xA0;5.&#xA0;Advanced Widgets"><div class="titlepage"><div><div><h1 class="title"><a id="ch05"/>Chapter 5. Advanced Widgets</h1></div></div></div><p>Wijmo includes many advanced widgets commonly used in web development. These components of applications are often implemented with libraries or plugins. In this chapter, we cover the tooltip, upload, video, and editor widgets. The main advantage of using these Wijmo widgets over other libraries for the developer is its consistent API. For the user, the interface components look more consistent.</p><div class="section" title="Using the tooltip widget"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec24"/>Using the tooltip widget</h1></div></div></div><p>Browsers,<a id="id187" class="indexterm"/> by default, display a textbox or balloon when hovering over image elements that have title attributes. To make these text balloons user friendly, Wijmo's tooltip widget uses JavaScript and CSS to enhance them. By default, Wijmo shows the text in the <code class="literal">title</code> attribute<a id="id188" class="indexterm"/> of the tooltip elements. Consider a simple example with an input element:</p><div class="informalexample"><pre class="programlisting">&lt;input title="Instructions for the form go here" type="text" /&gt;</pre></div><p>Calling <code class="literal">$("input[title]").wijtooltip()</code> generates a tooltip that shows when hovering over the element. In addition, the jQuery selector only applies the tooltip on those input elements that have titles. In this section, we explore how to position the tooltip, load AJAX content within it, and change its style.</p><div class="section" title="Positioning the tooltip widget"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec21"/>Positioning the tooltip widget</h2></div></div></div><p>Wijmo<a id="id189" class="indexterm"/> uses jQuery UI's position method which takes four main parameters:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Field</p>
</th><th style="text-align: left" valign="bottom">
<p>Values</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">my</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">left</code>/<code class="literal">right</code>/<code class="literal">center</code>/<code class="literal">top</code>/<code class="literal">bottom</code>/<code class="literal">center</code>
</p>
</td><td style="text-align: left" valign="top">
<p>The <a id="id190" class="indexterm"/>position on the element being moved</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">at</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">left</code>/<code class="literal">right</code>/<code class="literal">center</code>/<code class="literal">top</code>/<code class="literal">bottom</code>/<code class="literal">center</code>
</p>
</td><td style="text-align: left" valign="top">
<p>The <a id="id191" class="indexterm"/>position on the target element to be aligned against</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">of</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">selector</code>
</p>
</td><td style="text-align: left" valign="top">
<p>The <a id="id192" class="indexterm"/>target element to be positioned against</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">offset</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">Integer</code>
</p>
</td><td style="text-align: left" valign="top">
<p>The<a id="id193" class="indexterm"/> x y offset that specifies how much to move horizontally and vertically</p>
</td></tr></tbody></table></div><p>The syntax <a id="id194" class="indexterm"/>reads almost like a sentence. Suppose we wanted to position a box with ID <code class="literal">move-it</code> so that its top left is at the right bottom of the target; then we could use the <code class="literal">position</code> method in the following way:</p><div class="informalexample"><pre class="programlisting">$("#move-it").position({
  "my": "left top",
  "at": "right bottom",
  "of": $("#target")
});</pre></div><p>The following screenshot depicts the elements in the preceding example as boxes:</p><div class="mediaobject"><img src="graphics/6067OT_5_01.jpg" alt="Positioning the tooltip widget"/></div><p>jQuery UI has an example page where you can play around with the different position settings<a id="id195" class="indexterm"/> at <a class="ulink" href="http://jqueryui.com/position/">http://jqueryui.com/position/</a>.</p><p>In the<a id="id196" class="indexterm"/> context of the tooltip, the <code class="literal">my</code> parameter specifies the position of the tooltip arrow. The following diagram shows each of the configurations for <a id="id197" class="indexterm"/>the <code class="literal">my</code> parameter:</p><div class="mediaobject"><img src="graphics/6067OT_5_02.jpg" alt="Positioning the tooltip widget"/></div><p>The <code class="literal">at</code> parameter for the tooltip works exactly the same way as with jQuery UI's position method.</p></div><div class="section" title="Loading AJAX content in the tooltip widget"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec22"/>Loading AJAX content in the tooltip widget</h2></div></div></div><p>A commonly<a id="id198" class="indexterm"/> used pattern for tooltips is loading external content. Wijmo tooltips have the <code class="literal">ajaxCallback</code> option<a id="id199" class="indexterm"/> for inserting content into the tooltip. Our example sends a request to the server and displays its response. We set the <code class="literal">data-id</code> attribute<a id="id200" class="indexterm"/> on the links to be the indexes of the content we want. For instance, this link refers to the first element in a table:</p><div class="informalexample"><pre class="programlisting">&lt;a href="#" data-id="0"&gt;link text&lt;/a&gt;</pre></div><p>Since you're sending the request to the server, <code class="literal">data-id</code> would be the primary key of the row in the table or model you're querying. The following code snippet demonstrates how to retrieve AJAX content:</p><div class="informalexample"><pre class="programlisting">$(document).ready(function () {
  $("a[data-id]").wijtooltip({
    position: { my: 'left bottom', at: 'right top' },
    ajaxCallback: function () {
      var $tooltip = this;
      $.get(url, { id: $tooltip.attr("data-id") }, function (text)
        {
          $tooltip.wijtooltip("option", "content", text);
      });
    }
  });
});</pre></div><p>In <a id="id201" class="indexterm"/>the <code class="literal">ajaxCallback</code> function<a id="id202" class="indexterm"/>, the ID associated with each link is retrieved with <code class="literal">$tooltip.attr("data-id")</code>, which returns the value of the <code class="literal">data-id</code> attribute. This ID is then <a id="id203" class="indexterm"/>used to retrieve the tooltip contents, which is set with <code class="literal">$tooltip.wijtooltip("option", "content", "text")</code>.</p></div><div class="section" title="Styling the tooltip widget"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec23"/>Styling the tooltip widget</h2></div></div></div><p>By default, Wijmo styles<a id="id204" class="indexterm"/> tooltips using the theme you selected, but we want tooltips to stand out from the rest of the user interface. By applying a few CSS classes, we can quickly change a Rocket-themed tooltip to a customized tooltip as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6067OT_5_03.jpg" alt="Styling the tooltip widget"/></div><p>When styling the tooltip, the idea is to set the border, background, and text colors without overriding the default theme classes such as <code class="literal">.ui-container</code>. We do this by setting the colors on the tooltip classes:</p><div class="informalexample"><pre class="programlisting">.wijmo-wijtooltip-container {
  color: #ffffff;
  background-color: slategray;
}
  .wijmo-wijtooltip-pointer-inner {
    border-right-color: slategray !important;
}
  .wijmo-wijtooltip, .wijmo-wijtooltip-pointer {
    border: 3px solid lawngreen;
}</pre></div><p>The <code class="literal">.wijmo-wijtooltip-pointer-inner</code> class<a id="id205" class="indexterm"/> is applied to the tail in the speech bubble, so we set its background color to be the same as the <code class="literal">.wijmo-wijtooltip-container</code> class. The text color is also set within the <code class="literal">.wijmo-wijtooltip-container</code> class. Finally, we set the border colors on the tooltip and the pointer.</p><p>To make <a id="id206" class="indexterm"/>it easier to adjust the colors, I set the tooltip to show automatically with the <code class="literal">closeBehavior</code> option<a id="id207" class="indexterm"/> set to <code class="literal">sticky</code>. Making the tooltip sticky makes it stay on the page after moving the mouse outside of the <code class="literal">target</code> element<a id="id208" class="indexterm"/>. In this case, it's the label. The complete example is as follows:</p><div class="informalexample"><pre class="programlisting">&lt;!DOCTYPE HTML&gt;
&lt;html&gt;
&lt;head&gt;
...
  
  &lt;script id="scriptInit" type="text/javascript"&gt;
    $(document).ready(function () {
      $("[title]").wijtooltip({
      modal: true
    });
    $("[title]").wijtooltip("option","closeBehavior","sticky");
      $("[title]").wijtooltip ("show");
    });
  &lt;/script&gt;
  &lt;style&gt;
    .wijmo-wijtooltip-container {
      color: #ffffff;
      background-color: slategray;
   }
    .wijmo-wijtooltip-pointer-inner {
      border-right-color: slategray !important;
   }
    .wijmo-wijtooltip, .wijmo-wijtooltip-pointer {
      border: 3px solid lawngreen;
    }
    &lt;/style&gt;
  &lt;/head&gt;
&lt;body&gt;
  &lt;label id="tooltip" title="tooltip"&gt;&lt;/label&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div></div></div></div>
<div class="section" title="Using the upload widget with the ProgressBar element"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec25"/>Using the upload widget with the ProgressBar element</h1></div></div></div><p>The <a id="id209" class="indexterm"/>Wijmo <code class="literal">upload</code> widget can upload <a id="id210" class="indexterm"/>multiple files at once, and supports a progress bar. File uploads use <code class="literal">HttpHandler</code> to reduce the load on the server.</p><div class="mediaobject"><img src="graphics/6067OT_5_04.jpg" alt="Using the upload widget with the ProgressBar element"/></div><p>When initialized, the upload widget only has the <span class="strong"><strong>Upload files</strong></span> button<a id="id211" class="indexterm"/> as shown in the preceding screenshot. Once a file is selected, the upload file user interface has the <span class="strong"><strong>Upload files</strong></span> button to open the file browser, a <span class="strong"><strong>Cancel All</strong></span> button, and <a id="id212" class="indexterm"/>an <span class="strong"><strong>Upload All</strong></span> button<a id="id213" class="indexterm"/>. Each file that is selected has an individual upload or cancel button next to it. While uploading, the upload progress is shown in a progress bar element.</p><p>We will look at an example of replacing file inputs in web forms, where the file uploads are submitted with the form:</p><div class="informalexample"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;

...
&lt;script id="scriptInit" type="text/javascript"&gt;
  $(document).ready(function () {
    varprogressbar = $("#progressbar");
    //Initializes the wijupload with file-input element.
    var upload = $("#upload").wijupload({
      totalUpload: function () {
      progressbar.show();
    },
    //Hide the progress-bar when upload action finished.
    totalComplete: function () {
      progressbar.fadeOut(1500, function () {
        if (supportXhr) {
          $("#progressbar").wijprogressbar("option", "value", 0);
        }
      });
    },
    //Get the total progress of wijupload and update the //progress-bar.
    totalProgress: function (e, data) {
      if (supportXhr) {
        $("#progressbar").wijprogressbar("option", "maxValue", data.total);
        $("#progressbar").wijprogressbar("option", "value", data.loaded);
        }
      },
      action: $("form").attr("action")
    });
    supportXhr = $("#upload").wijupload("supportXhr");
    if (supportXhr) {
      progressbar.wijprogressbar({ value: 0 });
    } 
    progressbar.hide();
  });
  &lt;/script&gt;
  &lt;style&gt;
    #progressbar-container {
      height: 5em;
    }
    form {
      width: 800px;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;form action=""&gt;
  &lt;input id="upload" type="file" multiple/&gt;
  &lt;div id="progressbar-container"&gt;
  &lt;div id="progressbar"&gt;&lt;/div&gt;
  &lt;/div&gt;
  &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><p>With <code class="literal">supportXhr = $("#upload").wijupload("supportXhr")</code>, we check whether the<a id="id214" class="indexterm"/> upload widget can be hooked up with <a id="id215" class="indexterm"/>AJAX to display file upload progress. Although hidden, the progress bar is initialized when AJAX hooks are available.</p><p>The <code class="literal">upload</code> widget is initialized with three event handlers to enable the progress bar. First, <code class="literal">totalUpload</code> is the event that gets fired when the <span class="strong"><strong>Upload All</strong></span> button<a id="id216" class="indexterm"/> is clicked. In this example, we show the progress bar. Since <code class="literal">&lt;div id="progressbar"&gt;&lt;/div&gt;</code> is an empty element, calling the jQuery <code class="literal">show</code> method does not render anything visible. Next, the <code class="literal">totalComplete</code> event is triggered when all the files<a id="id217" class="indexterm"/> have been uploaded. We fadeout the progress bar and set its value to zero for its next use. Finally, as the file is getting uploaded, the function defined for <code class="literal">totalProgress</code> receives the upload progress and the number<a id="id218" class="indexterm"/> of <a id="id219" class="indexterm"/>bytes uploaded to display in the progress bar. The <code class="literal">action</code> option for the upload <a id="id220" class="indexterm"/>widget is the URL where the form is submitted on the server.</p></div>
<div class="section" title="Applying Wijmo themes to HTML5 videos"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec26"/>Applying Wijmo themes to HTML5 videos</h1></div></div></div><p>The Wijmo<a id="id221" class="indexterm"/> video widget works with the HTML5 <a id="id222" class="indexterm"/>video tag and adds controls using jQuery UI theming. The video player has the common play/stop, volume, and full-screen controls. To initialize the widget, just call the <code class="literal">wijvideo</code> method on a video element. To support all browsers, the video element needs to have the video encoded in at least two formats. The browser support for each format is as follows:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Browser</p>
</th><th style="text-align: left" valign="bottom">
<p>MP4</p>
</th><th style="text-align: left" valign="bottom">
<p>WebM</p>
</th><th style="text-align: left" valign="bottom">
<p>Ogg</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>Internet Explorer 9+</p>
</td><td style="text-align: left" valign="top">
<p>YES</p>
</td><td style="text-align: left" valign="top">
<p>NO</p>
</td><td style="text-align: left" valign="top">
<p>NO</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Chrome 6+</p>
</td><td style="text-align: left" valign="top">
<p>YES</p>
</td><td style="text-align: left" valign="top">
<p>YES</p>
</td><td style="text-align: left" valign="top">
<p>YES</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Firefox 3.6+</p>
</td><td style="text-align: left" valign="top">
<p>NO</p>
</td><td style="text-align: left" valign="top">
<p>YES</p>
</td><td style="text-align: left" valign="top">
<p>YES</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Safari 5+</p>
</td><td style="text-align: left" valign="top">
<p>YES</p>
</td><td style="text-align: left" valign="top">
<p>NO</p>
</td><td style="text-align: left" valign="top">
<p>NO</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Opera 10.6+ </p>
</td><td style="text-align: left" valign="top">
<p>NO</p>
</td><td style="text-align: left" valign="top">
<p>YES</p>
</td><td style="text-align: left" valign="top">
<p>YES</p>
</td></tr></tbody></table></div><p>For older browsers that don't support HTML5 such as IE8, it is recommended to not use the video widget. However, you can insert text content to display a message in place of the video. The full markup looks like the following:</p><div class="informalexample"><pre class="programlisting">&lt;video width="520" height="340"controls="controls"&gt;
  &lt;source src="movie.mp4" type="video/mp4"&gt;
  &lt;source src="movie.ogg" type="video/ogg"&gt;
    Your browser does not support the video tag.
&lt;/video&gt;</pre></div><p>If you change the width or height, the video automatically resizes to fit the area. To initialize the video widget, we would call <code class="literal">$("video").wijvideo()</code>.</p></div>
<div class="section" title="Using the editor widget"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec27"/>Using the editor widget</h1></div></div></div><p>The Wijmo<a id="id223" class="indexterm"/> editor allows non-technical users to manage and write HTML content. Unlike other HTML editing tools for the browser on the market, Wijmo sports a Microsoft Office 2007 style Ribbon UI, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/6067OT_5_05.jpg" alt="Using the editor widget"/></div><div class="mediaobject"><img src="graphics/6067OT_5_06.jpg" alt="Using the editor widget"/></div><p>The Ribbon UI automatically resizes to fit within the textarea dimensions that create the widget, as shown in the preceding screenshot. It supports three views for editing HTML. For non-technical users, there is a <span class="strong"><strong>WYSIWYG</strong></span> view that acts like Microsoft Word. The formatting and layout is exactly what you see in the editor. In addition, there is a source code view for those who know HTML. Furthermore, the <span class="strong"><strong>split</strong></span> view is a combination of these two so that the HTML and its preview are both visible. To initialize an editor, just call the <code class="literal">wijeditor</code> method on a textarea; for example, <code class="literal">$("#wijeditor").wijeditor({ mode: "ribbon"})</code>.</p><div class="section" title="Using the editor widget with BBCode for forums"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec24"/>Using the editor widget with BBCode for forums</h2></div></div></div><p>For forum <a id="id224" class="indexterm"/>and blog use, the editor supports<a id="id225" class="indexterm"/> BBCode, namely tags such as <code class="literal">[url=http://example.com]Example[/url]</code>. If BBCode is used, the source view is in the BBCode format. The editor must be initialized in the <code class="literal">bbcode</code> mode:</p><div class="informalexample"><pre class="programlisting">&lt;textarea id="wijeditor" style="width: 450px; height: 200px;"&gt;Editor content&lt;/textarea&gt;</pre></div><p>Calling <code class="literal">$("#wijeditor").wijeditor({ mode: "bbcode"})</code> generates <a id="id226" class="indexterm"/>an <a id="id227" class="indexterm"/>editor with BBCode controls.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec28"/>Summary</h1></div></div></div><p>In this chapter, we learned about the tooltip, upload, video, and editor widgets. These widgets are commonly used in web applications. We took a look at customizing the tooltip styling so that it stands out from the rest of the UI and loading AJAX content in it. We've seen how to upload multiple files with Wijmo while showing a progress bar, a video widget, and the Ribbon style editor. In the next chapter, you will learn how to combine Wijmo with Knockout to build interactive user interfaces.</p></div></body></html>