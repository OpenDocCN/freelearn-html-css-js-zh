<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Google Maps JavaScript API Basics"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Google Maps JavaScript API Basics</h1></div></div></div><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating a simple map in a custom DIV element</li><li class="listitem" style="list-style-type: disc">Creating a simple fullscreen map</li><li class="listitem" style="list-style-type: disc">Moving from the Web to mobile devices</li><li class="listitem" style="list-style-type: disc">Changing map properties programmatically</li><li class="listitem" style="list-style-type: disc">Changing base maps</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Introduction</h1></div></div></div><p>Location <a id="id0" class="indexterm"/>is becoming a very popular topic day by day, and Google<a id="id1" class="indexterm"/> is one of the main game changers in this area. Most websites have a contact page with Google Maps showing the location of the business. This is the simplest usage of the Google Maps JavaScript API. There are also other advanced usages of it to show different information on maps. This whole book contains multiple usage recipes on the Google Maps JavaScript API, from beginner to advanced topics. There are different parts that make up the Google Maps JavaScript API such as the raster/vector layers, controls, events, and services, which are all covered in the following chapters.</p><p>There are both open source and commercial alternatives to the Google Maps JavaScript API, such as <a id="id2" class="indexterm"/>OpenLayers, <a id="id3" class="indexterm"/>Leaflet, <a id="id4" class="indexterm"/>Bing Maps, <a id="id5" class="indexterm"/>MapQuest, and Here <a id="id6" class="indexterm"/>Maps (formerly, Nokia Maps), but the Google Maps JavaScript API has great support in base maps, satellite images, and the API itself. For example, the API can be used to show only one location or all the data of a government agency on a map.</p><p>The Google Maps JavaScript API is not a free tool to show maps, but its free usage limit is enough for most developers. There is a limit of 25,000 map loads per day per site, which is counted when a map is initialized on a web page.</p></div></div>
<div class="section" title="Creating a simple map in a custom DIV element"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Creating a simple map in a custom DIV element</h1></div></div></div><p>When you work with mapping applications, creating a map is the most important task you can do. The map is the main part of the application with which the users interact and where all the visualization occurs. This part may seem trivial, but all of the following chapters rely on this part of the application.</p><p>This recipe will guide you through the process of creating a simple map view on a web page.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note02"/>Note</h3><p>As described in the preface, we need a web server to host our HTML, JavaScript, and CSS files and a web browser to interpret them on the client side.</p></div></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec07"/>Getting ready</h2></div></div></div><p>As already stated, the <a id="id7" class="indexterm"/>Google Maps JavaScript API works with HTML, CSS, and <a id="id8" class="indexterm"/>JavaScript code. So a text editor with HTML, JavaScript, and CSS handling capabilities would be a good friend to have on hand while exploring this book.</p><p>For Mac users, there are lots of commercial or free text editors such as<a id="id9" class="indexterm"/> TextWrangler, <a id="id10" class="indexterm"/>BBEdit, <a id="id11" class="indexterm"/>Sublime Text, or<a id="id12" class="indexterm"/> WebStorm. They all handle HTML, JavaScript, and CSS beautifully.</p><p>For Windows users as well, there are different text editors, but <span class="strong"><strong>Notepad++</strong></span>
<a id="id13" class="indexterm"/> is the most used and recommended one.</p><p>Choosing an editor depends on your computer usage habits, so there is no exact solution or recommendation to users to select a particular type of editor. Everyone has different perceptions that affect these choices.</p><p>You can find the source code at <code class="literal">Chapter 1/ch01_simple_map.html</code>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>
<span class="strong"><strong>Downloading the example code</strong></span>
</p><p>You can download the example code files for all Packt books you have purchased from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div></div></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec08"/>How to do it…</h2></div></div></div><p>Here are the steps we will use to create our first map using the Google Maps JavaScript API.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new empty <a id="id14" class="indexterm"/>file named <code class="literal">map.html</code> and insert<a id="id15" class="indexterm"/> the following code block into it. This block is required for every app that uses the Google Maps JavaScript API. You must insert your Google Maps JavaScript API key into the URL in the following code.<div class="informalexample"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;!-- Include Google Maps JS API --&gt;
        &lt;script type="text/javascript"
        src="https://maps.googleapis.com/maps/api/js?key=INSERT_YOUR_MAP_API_KEY_HERE&amp;sensor=false"&gt;&lt;/script&gt;</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip03"/>Tip</h3><p>Please ensure that you have your Google Maps JavaScript API key from the Google APIs Console (<a class="ulink" href="http://code.google.com/apis/console">http://code.google.com/apis/console</a>) and replace it with <code class="literal">YOUR_API_KEY</code>. If you do not change that part of the code, your map cannot be seen due to Google's API rules. Also make sure to change the API key before publishing your map's document on another location or production environment.</p></div></div></li><li class="listitem">The following part is required in order to place the map where needed. In the <code class="literal">&lt;head&gt;</code> section, add the HTML styling code to create a map that is 800 px in width and 500 px in height with the <code class="literal">&lt;style&gt;</code> element as follows:<div class="informalexample"><pre class="programlisting">&lt;style type="text/css"&gt;
    #mapDiv { width: 800px; height: 500px; }
&lt;/style&gt;</pre></div></li><li class="listitem">Add the following JavaScript lines to the code to run with the Google Maps JavaScript API. Do not forget to define the <code class="literal">map</code> object outside the function in order to access it from every part of the code.<div class="informalexample"><pre class="programlisting">  &lt;!-- Map creation is here --&gt;
  &lt;script type="text/javascript"&gt;
    //Defining map as a global variable to access from //other functions
  var map;
  function initMap() {
    //Enabling new cartography and themes
    google.maps.visualRefresh = true;

    //Setting starting options of map
    var mapOptions = {
      center: new google.maps.LatLng(39.9078, 32.8252),
      zoom: 10,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    //Getting map DOM element
    var mapElement = document.getElementById('mapDiv');

    //Creating a map with DOM element which is just //obtained
    map = new google.maps.Map(mapElement, mapOptions);
  }</pre></div></li><li class="listitem">Add the following <a id="id16" class="indexterm"/>lines to finish the code. This part<a id="id17" class="indexterm"/> defines the <code class="literal">&lt;html&gt;</code> tags where the map will be added and when to initialize the map.<div class="informalexample"><pre class="programlisting">        google.maps.event.addDomListener(window, 'load', initMap);
    &lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
      &lt;b&gt;My First Map &lt;/b&gt;
      &lt;div id="mapDiv"&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></div></li><li class="listitem">Enter the URL of your local server, where your <code class="literal">map.html</code> file is stored, in your favorite browser and take a look at the result. You will see a map with navigation controls at the top-left corner and the base map control at the top-right corner.<div class="mediaobject"><img src="graphics/8825OT_01_01.jpg" alt="How to do it…"/></div></li></ol></div><p>As evident from the preceding screenshot, we have created our simple map with the Google Maps JavaScript API.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec09"/>How it works...</h2></div></div></div><p>Let's start <a id="id18" class="indexterm"/>examining the code step by step. First, the HTML5 document is<a id="id19" class="indexterm"/> defined with the code <code class="literal">&lt;!DOCTYPE html&gt;</code>. Then the <code class="literal">&lt;html&gt;</code> and <code class="literal">&lt;head&gt;</code> tags are added.</p><p>Before the <code class="literal">&lt;style&gt;</code> element, the Google Maps JavaScript API is included as a reference using the <code class="literal">&lt;script&gt;</code> element as follows:</p><div class="informalexample"><pre class="programlisting">&lt;script type="text/javascript"
          src="https://maps.googleapis.com/maps/api/js?key= INSERT_YOUR_MAP_API_KEY_HERE&amp;sensor=false"&gt;
   &lt;/script&gt;</pre></div><p>Then a new <code class="literal">&lt;script&gt;</code> tag is added to the code. After the <code class="literal">&lt;head&gt;</code> section, the <code class="literal">&lt;body&gt;</code> section starts.</p><div class="informalexample"><pre class="programlisting">    &lt;body&gt;</pre></div><p>The following line of code listens to the load of the document. This event triggers the <code class="literal">initMap</code> function when the page is fully loaded. This prevents unpredictable behaviors that would arise from DOM and its related elements.</p><div class="informalexample"><pre class="programlisting">google.maps.event.addDomListener(window, 'load', initMap);</pre></div><p>Finally, we have the HTML tags to create our page. The <code class="literal">&lt;div&gt;</code> element with <code class="literal">id="mapDiv"</code> is the place where our map will be shown. This element gets its style from the CSS tags defined previously, which has a width of 800 px and a height of 500 px.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>The styling of the <code class="literal">mapDiv</code> element is directly related to CSS rules that can be found on the W3Schools website (<a class="ulink" href="http://www.w3schools.com/css">http://www.w3schools.com/css</a>) in detail.</p></div></div><p>As stated previously, <a id="id20" class="indexterm"/>the main JavaScript code that initializes the map will be <a id="id21" class="indexterm"/>explained in detail. First, the <code class="literal">map</code> object is defined as a global object to access the map from every function that is added later.</p><div class="informalexample"><pre class="programlisting">var map;</pre></div><p>Then the <code class="literal">initMap</code> function is defined as follows:</p><div class="informalexample"><pre class="programlisting">function initMap() {

}</pre></div><p>Before creating a map, the following code is called to change the map's theme to the latest one that was announced at Google IO 2013 in May 2013. This theme is the new look used in the new Google Maps. Both the cartography and styles of components are fresh and up to date; however, using this new feature is optional. If you don't use the following line of code, you'd use the old theme.</p><div class="informalexample"><pre class="programlisting">google.maps.visualRefresh = true;</pre></div><p>Then, the map options would be defined as follows:</p><div class="informalexample"><pre class="programlisting">   var mapOptions = {
        center: new google.maps.LatLng(39.9078, 32.8252),
        zoom: 10,
        mapTypeId: google.maps.MapTypeId.ROADMAP
   };</pre></div><p>There are three important parameters for the map options.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">center</code>: This is the center of the map in latitudes and longitudes. The previously defined parameters are the coordinates of Ankara, Turkey. If you don't know how to get the coordinates of a place, refer to the recipes given in <a class="link" href="ch05.html" title="Chapter 5. Understanding Google Maps JavaScript API Events">Chapter 5</a>, <span class="emphasis"><em>Understanding Google Maps JavaScript API Events</em></span>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">zoom</code>: This parameter is an integer that defines the level in which the map is shown. Google Maps have zoom levels from 0 (world level) to 21+ (street level). Users see more details but less area when the zoom level increases.</li><li class="listitem" style="list-style-type: disc"><code class="literal">mapTypeId</code>: This parameter defines the types of base maps shown on the map. The details of this parameter are given in the later recipes of this chapter.</li></ul></div><p>Before creating the map object, it is necessary to get the <code class="literal">div</code> element to where the map will be shown. This is done via the classic DOM method, <code class="literal">getElementById</code>, as follows:</p><div class="informalexample"><pre class="programlisting">    var mapElement = document.getElementById('mapDiv');</pre></div><p>Finally, we have everything in place to create a map object:</p><div class="informalexample"><pre class="programlisting">    map = new google.maps.Map(mapElement, mapOptions);</pre></div><p>This code<a id="id22" class="indexterm"/> gets the <code class="literal">mapElement</code> and <code class="literal">mapOptions</code> objects to<a id="id23" class="indexterm"/> create the map. The first parameter is the <code class="literal">div</code> element where the map will be placed and the other is the <code class="literal">mapOptions</code> object that holds the starting parameters of the map. The preceding line of code creates the map with the given options at the given <code class="literal">div</code> element and returns the map object to interact with the map later.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>This recipe is the simplest one in the book but also the most important one to get started with the Google Maps JavaScript API. There are lots of parameters or options of the map, which will be discussed in the later chapters and recipes.</p><p>Also remember that in the following recipes, the basic code will not be included in the book in order to provide you with more recipes. Only those lines of code that are changed or required are given in the following chapters and recipes, but you will have access to the complete code with all the omitted lines from the Packt Publishing website (<a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a>)</p></div></div></div></div>
<div class="section" title="Creating a simple fullscreen map"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Creating a simple fullscreen map</h1></div></div></div><p>Applications can be mapped in different formats. Some of them show a map after a mouse click or an event, and some of them are shown directly in fullscreen mode.</p><p>This recipe will show you how to create a <a id="id24" class="indexterm"/>fullscreen map that will be used both in web or mobile applications.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Getting ready</h2></div></div></div><p>As stated before, some recipes will show only the changed lines in the code in order to make way for more recipes. This recipe is the modified version of the previous recipe, <span class="emphasis"><em>Creating a simple map in a custom DIV element</em></span>.</p><p>You can find the source code at <code class="literal">Chapter 1/ch01_full_screen_map.html</code>.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec11"/>How to do it…</h2></div></div></div><p>You can easily create a simple fullscreen map by following the given steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Let's start by creating a new empty file named <code class="literal">full_screen_map.html</code>. Then, copy all of the code in the previous HTML file (<code class="literal">map.html</code>) and paste it into this file.</li><li class="listitem">Find the following lines of code in the new file:<div class="informalexample"><pre class="programlisting">    &lt;style type="text/css"&gt;
         #mapDiv { width: 800px; height: 500px; }
    &lt;/style&gt;</pre></div></li><li class="listitem">Add the following lines and change them according to the new values stated. The <code class="literal">width</code> and <code class="literal">height</code> values are changed to <code class="literal">100%</code> in order to make the map full screen in the browser viewport. Also, the margin value of the <code class="literal">body</code> element is changed to <code class="literal">0</code> to remove all the spaces around the map.<div class="informalexample"><pre class="programlisting">&lt;style type="text/css"&gt;
    html { height: 100% }
    body { height: 100%; margin: 0; }
    #mapDiv { width: 100%; height: 100%; }
&lt;/style&gt;</pre></div></li><li class="listitem">Enter the URL of <a id="id25" class="indexterm"/>your local server, where your <code class="literal">full_screen_map.html</code> file is stored, in your favorite browser and take a look at the result. You will see the map with navigation controls at the top-left corner and the base map control at the top-right corner that fills the entire browser area.<div class="mediaobject"><img src="graphics/8825OT_01_02.jpg" alt="How to do it…"/></div></li></ol></div><p>Thus we have successfully created a simple fullscreen map.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec12"/>How it works...</h2></div></div></div><p>The Google Maps <a id="id26" class="indexterm"/>JavaScript API uses the <code class="literal">div</code> component of the HTML standard to show the map. The <code class="literal">div</code> component gets its style and properties from CSS rules, which are defined at the top, in the <code class="literal">&lt;head&gt;</code> element. The <code class="literal">width</code> and <code class="literal">height</code> attributes of <code class="literal">#mapdiv</code> show that the <code class="literal">div</code> component will fill the entire browser space. You can easily modify these <code class="literal">width</code> and <code class="literal">height</code> properties to change the map dimensions according to your needs.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>There's more...</h2></div></div></div><p>The size of the map is directly related to CSS styles, and there is no direct relation between the map size and the Google Maps JavaScript API. The <code class="literal">DIV</code> element that holds the Google Maps JavaScript API's base maps and overlays is just a blank container, and as the <code class="literal">DIV</code> elements get larger, so does your map.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec14"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Creating a simple map in a custom DIV element</em></span> recipe</li></ul></div></div></div>
<div class="section" title="Moving from the Web to mobile devices"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Moving from the Web to mobile devices</h1></div></div></div><p>Mobile devices <a id="id27" class="indexterm"/>are getting more popular nowadays; all the popular websites are preparing their mobile apps or sites in order for people to access them anywhere. Mapping applications have also become more popular since accessing the location of a device with proper APIs was introduced in HTML5.</p><p>In this recipe, we will prepare a mapping application that will run on mobile browsers in full screen, and it will zoom to the location of a device with the help of the W3C Geolocation API. This API is also accessible from desktop browsers to get your location.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec15"/>Getting ready</h2></div></div></div><p>This code will be run on a mobile device or simulator, so make sure that your code will be accessible from your mobile device or simulator. In this recipe, I suggest you upload the code to a hosting server or website so that it could be accessed easily from your mobile device or simulator.</p><p>You can find the source code at <code class="literal">Chapter 1/ch01_mobile_map.html</code>.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec16"/>How to do it…</h2></div></div></div><p>If you want to create a <a id="id28" class="indexterm"/>map that is optimum for mobile devices, you should follow<a id="id29" class="indexterm"/> the given steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Let's start by creating a new empty file named <code class="literal">mobile_map.html</code>. Then, copy all of the code in the HTML file (<code class="literal">map.html</code>) that was introduced in the <span class="emphasis"><em>Creating a simple map in a custom DIV element</em></span> recipe, and paste it into the new file.</li><li class="listitem">Find the following lines of code in the new file:<div class="informalexample"><pre class="programlisting">&lt;!-- Include Google Maps JS API --&gt;
&lt;script type="text/javascript"
    src="https://maps.googleapis.com/maps/api/js?key=INSERT_YOUR_MAP_API_KEY_HERE&amp;sensor=false"&gt;
&lt;/script&gt;</pre></div></li><li class="listitem">Insert the following line before the previous code block. This line tells mobile browsers that the current web application is designed for mobile devices:<div class="informalexample"><pre class="programlisting">&lt;meta name="viewport" content="initial-scale=1.0, user-scalable=no" /&gt;</pre></div></li><li class="listitem">Add the following <code class="literal">CSS</code> styles in order to make the map fullscreen.<div class="informalexample"><pre class="programlisting">    &lt;style type="text/css"&gt;
        html { height: 100% }
        body { height: 100%; margin: 0; }
        #mapDiv { width: 100%; height: 100%; }
    &lt;/style&gt;</pre></div></li><li class="listitem">Then, add the<a id="id30" class="indexterm"/> following code block after creating the <code class="literal">map</code> object. This<a id="id31" class="indexterm"/> code block will check whether your browser supports the Geolocation API and sets the center of the map according to the coordinates of the device.<div class="informalexample"><pre class="programlisting">if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
        var lat = position.coords.latitude;
        var lng = position.coords.longitude;
        //Creating LatLng object with latitude and //longitude.
        var devCenter =  new google.maps.LatLng(lat, lng);
        map.setCenter(devCenter);
        map.setZoom(15);
    });
}</pre></div></li><li class="listitem">Upload your file to a proper hosting site and check this URL on your mobile device or simulator. You will be asked whether to allow the reading of your location or not. If you allow it, you will see the map of your location.<div class="mediaobject"><img src="graphics/8825OT_01_03.jpg" alt="How to do it…"/></div></li></ol></div><p>This is how we achieve<a id="id32" class="indexterm"/> the goal of creating a simple map for mobile <a id="id33" class="indexterm"/>devices.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec17"/>How it works...</h2></div></div></div><p>The <code class="literal">&lt;meta&gt;</code> tags are used by browsers and search engines, and they are not visible to the users. They help browsers know how to behave. In our case, the following <code class="literal">&lt;meta&gt;</code> tag is used to tell browsers that the current website is optimized for mobile browsers:</p><div class="informalexample"><pre class="programlisting">&lt;meta name="viewport" content="initial-scale=1.0, user-scalable=no" /&gt;</pre></div><p>This <code class="literal">&lt;meta&gt;</code> tag solves zooming problems when the user pinches in or out, because pinching in or out should zoom the map in or out respectively and not the document itself.</p><p>In order to get the device location, the W3C Geolocation API implemented by browsers is used. There is a navigator namespace in the HTML5 standard, and the Geolocation subnamespace is checked first if the browser has support for the Geolocation API. If <code class="literal">navigator.geolocation</code> returns an object, we can get the coordinates with the help of the <code class="literal">getCurrentPosition</code> function. The callback function gets the latitude and longitude of the device and creates the <code class="literal">google.maps.LatLng</code> object. Then, the <code class="literal">setCenter</code> method of the <code class="literal">map</code> object is triggered with the <code class="literal">devCenter</code> object that was created before. This will change the center of the map according to the device location.</p><p>The last line of the <a id="id34" class="indexterm"/>callback function is used to set the zoom level of the map. This can be <a id="id35" class="indexterm"/>changed according to your needs.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec18"/>There's more...</h2></div></div></div><p>The HTML5 standard is still in progress, and there can be changes in the W3 Geolocation API. If you want to get more information about geolocation, refer to the W3C documentation site (<a class="ulink" href="http://dev.w3.org/geo/api/spec-source.html">http://dev.w3.org/geo/api/spec-source.html</a>).</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec19"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Creating a simple map in a custom DIV element</em></span> recipe</li></ul></div></div></div>
<div class="section" title="Changing map properties programmatically"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Changing map properties programmatically</h1></div></div></div><p>Until this recipe, the <a id="id36" class="indexterm"/>map has been interactive within itself. Users can zoom in/out, drag the map, change the user interface, or enable/disable mouse interactivity. If you want to play with the map outside of it, you should access the map and change the properties you want, or you can change the properties programmatically in different cases. Changing map properties programmatically is one of the important parts of the Google Maps JavaScript API. In most mapping applications, a user searches for a place, and the application should focus on that point on the map. This is possible with the <code class="literal">map</code> object's functions. There are lots of map functions, but we will cover only the most used ones.</p><p>In this recipe, we will create a mapping application that a user can interact with outside the map. Buttons are used in order to interact with the map.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec20"/>Getting ready</h2></div></div></div><p>Before you continue, a map object must be created in order to interact with it. If a map object is not defined, you will get an error. These kinds of problems occur due to JavaScript's asynchronous behavior in most cases.</p><p>You can find the source code at <code class="literal">Chapter 1/ch01_interaction_map.html</code>.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec21"/>How to do it…</h2></div></div></div><p>Changing the map<a id="id37" class="indexterm"/> properties is quite easy if you follow the given steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Let's start by creating a new empty file named <code class="literal">interaction_map.html</code>. Then, copy all of the code in the HTML file (<code class="literal">map.html</code>) that was introduced in the <span class="emphasis"><em>Creating a simple map in a custom DIV element</em></span> recipe and paste it into the new file.</li><li class="listitem">Add the following functions after the <code class="literal">initmap()</code> function. These functions are called by the buttons defined in HTML, which are used to interact with the map. Functions are explained later in this recipe.<div class="informalexample"><pre class="programlisting">function zoomToIstanbul () {
    var istanbul = new google.maps.LatLng(41.0579,29.0340);
    map.setCenter(istanbul);
}

function zoomToStreet () {
    map.setZoom(18);
}

function disableDrag () {
    map.setOptions ({ draggable: false });
}

function setMaxZoom () {
    map.setOptions ({ maxZoom: 12 });
}

function setMinZoom () {
    map.setOptions ({ minZoom: 5 });
}

function changeUI () {
    map.setOptions ({ disableDefaultUI: true });
}

function disableScroll () {
    map.setOptions ({ scrollwheel: false });
}</pre></div></li><li class="listitem">Next, add the following function to listen to the click events of the buttons defined in the HTML code in step 5.<div class="informalexample"><pre class="programlisting">function startButtonEvents () {
    document.getElementById('btnZoomToIst' ).addEventListener('click', function(){
        zoomToIstanbul();
    });
    document.getElementById('btnZoomToStr' ).addEventListener('click', function(){
        zoomToStreet();
    });
    document.getElementById('btnDisableDrag' ).addEventListener('click', function(){
        disableDrag();
    });
    document.getElementById('btnMaxZoom' ).addEventListener('click', function(){
        setMaxZoom();
    });
    document.getElementById('btnMinZoom' ).addEventListener('click', function(){
        setMinZoom();
    });
    document.getElementById('btnChangeUI' ).addEventListener('click', function(){
        changeUI();
    });
    document.getElementById('btnDisableScroll' ).addEventListener('click', function(){
        disableScroll();
    });
}</pre></div></li><li class="listitem">The <code class="literal">startButtonEvents</code> function <a id="id38" class="indexterm"/>must be called on initializing the map, so the following line of code is added:<div class="informalexample"><pre class="programlisting">startButtonEvents();</pre></div></li><li class="listitem">Then, add the following HTML lines of code inside the <code class="literal">&lt;body&gt;</code> tag. These are the <code class="literal">&lt;button&gt;</code> tags to be shown on the web page. Each <code class="literal">button</code> element listens for the click event to fire the related function.<div class="informalexample"><pre class="programlisting">&lt;input id="btnZoomToIst" type="button" value="Zoom To Istanbul"&gt;
&lt;input id="btnZoomToStr" type="button" value="Zoom To Street Level"&gt;
&lt;input id="btnDisableDrag" type="button" value="Disable Drag"&gt;
&lt;input id="btnMaxZoom" type="button" value="Set Max Zoom to 12"&gt;
&lt;input id="btnMinZoom" type="button" value="Set Min Zoom to 5"&gt;
&lt;input id="btnChangeUI" type="button" value="Change UI"&gt;
&lt;input id="btnDisableScroll" type="button" value="Disable Scroll Zoom"&gt;</pre></div></li><li class="listitem">Enter the URL <a id="id39" class="indexterm"/>of your local server, where your <code class="literal">interaction_map.html</code> file is stored, in your favorite browser and take a look at the result. You will see the map with buttons at the top. Each button triggers a different function to interact with the map.<div class="mediaobject"><img src="graphics/8825OT_01_04.jpg" alt="How to do it…"/></div></li></ol></div><p>As a result of the recipe, we can change map properties programmatically.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec22"/>How it works...</h2></div></div></div><p>Each JavaScript function<a id="id40" class="indexterm"/> defined previously is used to change the different sides of the map. The ones most used are to change the center and zoom level of the map. Most of the time, people just move from one location to another on a map. For example, if you are showing the locations of a coffee chain, the map should focus on each of the locations of the coffee shops. The following code creates a <code class="literal">google.maps.LatLng</code> object that will be the input of the <code class="literal">setCenter()</code> function. The <code class="literal">41.0579</code> and <code class="literal">29.0340</code> values are the latitude and longitude of Istanbul, Turkey respectively. You will replace these coordinate values with your own coordinate values to change the center of the map. This function will only change the center of the map, not the zoom level.</p><div class="informalexample"><pre class="programlisting">       var istanbul = new google.maps.LatLng(41.0579,29.0340);
       map.setCenter(istanbul);</pre></div><p>If you want to zoom in or out of the map in order to cover/show an area, you should also play with the zoom value. For example, your coffee shop location at zoom level 6 cannot provide effective guidance to your customers. It should at least be at level 15 or more to see the street names and the exact location. This can be done with the following code:</p><div class="informalexample"><pre class="programlisting">       map.setZoom(18);</pre></div><p>In some cases, you don't want users to interact with the map, such as fixing the map location, by disabling mouse drags or wheel scrolls. These are some examples of the <code class="literal">google.maps.MapOptions</code> object's properties. These properties are directly related to the properties of the map. If you want to change one or more properties of the map, you should create a JSON object and call the following map function:</p><div class="informalexample"><pre class="programlisting">        map.setOptions ({
            draggable: false,
            maxZoom: 12
        });</pre></div><p>With the <code class="literal">setOptions()</code> function, you can also enable or disable the default controls, but this will be reviewed in <a class="link" href="ch04.html" title="Chapter 4. Working with Controls">Chapter 4</a>, <span class="emphasis"><em>Working with Controls</em></span>. You can set one or more properties with the <code class="literal">setOptions()</code> function. You can find short explanations with comments next to the properties:</p><div class="informalexample"><pre class="programlisting">        map.setOptions ({
            draggable: false, //Disables the map drag
            maxZoom: 12, //Sets maximum zoom level
            minZoom: 5, //Sets minimum zoom level
            disableDefaultUI: true, //Removes the default controls
            scrollwheel: false //Disables the mouse scroll wheel
        });</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip04"/>Tip</h3><p>
<span class="strong"><strong>Accessing a map object</strong></span>
</p><p>Be aware of defining a map object as a global object in order to access it anywhere. This can be a problem in some cases while writing in JavaScript. Please check the following link to get more information on JavaScript and Scopes : <a class="ulink" href="http://coding.smashingmagazine.com/2009/08/01/what-you-need-to-know-about-javascript-scope/">http://coding.smashingmagazine.com/2009/08/01/what-you-need-to-know-about-javascript-scope/</a>.</p></div></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec23"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Creating a simple map in a custom DIV element</em></span> recipe</li></ul></div></div></div>
<div class="section" title="Changing base maps"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Changing base maps</h1></div></div></div><p>Base maps<a id="id41" class="indexterm"/> are one of the most important parts of the process of mapping the APIs. Base maps show the roads, satellite images, or terrains, which can be used for different situations. For example, a road map can be suitable for showing the location of your coffee shop, but a satellite image cannot. Satellite images can also be suitable for showing parcel information to check whether they are drawn correctly. The Google Maps JavaScript API has four different base maps such as <span class="strong"><strong>ROADMAP</strong></span>, <span class="strong"><strong>SATELLITE</strong></span>, <span class="strong"><strong>HYBRID</strong></span>, and <span class="strong"><strong>TERRAIN</strong></span>. All of these base maps can be seen in the following screenshot wherein they can be compared to each other.</p><div class="mediaobject"><img src="graphics/8825OT_01_05.jpg" alt="Changing base maps"/></div><p>In this recipe, we will go <a id="id42" class="indexterm"/>through the Google Maps base maps and learn how to change them programmatically.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec24"/>Getting ready</h2></div></div></div><p>In this recipe, we will use the JavaScript arrays in order to make the input parameters of a function readable. I suggest you check Google for the JavaScript arrays if you don't have any experience.</p><p>You can find the source code at <code class="literal">Chapter 1/ch01_base_map.html</code>.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec25"/>How to do it…</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">If you follow the given steps, you can change the base maps of your map.</li><li class="listitem">Let's start by creating a new empty file named <code class="literal">base_map.html</code>. Then, copy all of the code in the HTML file (<code class="literal">map.html</code>) that is introduced in the <span class="emphasis"><em>Creating a simple map in a custom DIV element</em></span> recipe and paste it into the new file.</li><li class="listitem">Add the following<a id="id43" class="indexterm"/> function after the <code class="literal">initMap()</code> function. It will listen to the click events of the buttons added to the HTML code in step 4. It simply sets the base map according to the IDs of the buttons.<div class="informalexample"><pre class="programlisting">function startButtonEvents () {
    document.getElementById('btnRoad' ).addEventListener('click', function(){
        map.setMapTypeId(google.maps.MapTypeId.ROADMAP);
    });
    document.getElementById('btnSat' ).addEventListener('click', function(){
        map.setMapTypeId(google.maps.MapTypeId.SATELLITE);
    });
    document.getElementById('btnHyb' ).addEventListener('click', function(){
        map.setMapTypeId(google.maps.MapTypeId.HYBRID);
    });
    document.getElementById('btnTer' ).addEventListener('click', function(){
        map.setMapTypeId(google.maps.MapTypeId.TERRAIN);
    });
}</pre></div></li><li class="listitem">The <code class="literal">startButtonEvents</code> function must be called upon initializing the map, so the following line of code is added after the map is initialized.<div class="informalexample"><pre class="programlisting">startButtonEvents();</pre></div></li><li class="listitem">Then, add the following HTML lines of code before the map's <code class="literal">div</code> element. These are the HTML buttons to change the base map:<div class="informalexample"><pre class="programlisting">&lt;input id="btnRoad" type="button" value="RoadMap"&gt;
&lt;input id="btnSat" type="button" value="Satellite"&gt;
&lt;input id="btnHyb" type="button" value="Hybrid"&gt;
&lt;input id="btnTer" type="button" value="Terrain"&gt;</pre></div></li><li class="listitem">Enter the URL of<a id="id44" class="indexterm"/> your local server, where your <code class="literal">base_map.html</code> file is stored, in your favorite browser, and take a look at the result. You will see the map with buttons at the top. Each button changes the base maps according to their names.<div class="mediaobject"><img src="graphics/8825OT_01_06.jpg" alt="How to do it…"/></div></li></ol></div><p>As shown in the preceding screenshot, you can easily change the base maps that are provided by Google.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec26"/>How it works...</h2></div></div></div><p>Most of the magic is done by the API itself; you just choose the map type you want to switch to.</p><p>These map types are predefined, but there is a possibility to add your own base maps or styled maps to the API and switch to them. Adding your own base maps or styled maps are introduced in <a class="link" href="ch02.html" title="Chapter 2. Adding Raster Layers">Chapter 2</a>, <span class="emphasis"><em>Adding Raster Layers</em></span>.</p><p>You can also define the starting base map at the <code class="literal">mapOptions</code> object as follows:</p><div class="informalexample"><pre class="programlisting">   var mapOptions = {
        center: new google.maps.LatLng(39.9078, 32.8252),
        zoom: 10,
        mapTypeId: google.maps.MapTypeId.TERRAIN
   };</pre></div><p>After changing the map <a id="id45" class="indexterm"/>options, your map will be opened with the <code class="literal">TERRAIN</code> base map type.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec27"/>There's more...</h2></div></div></div><p>Changing base maps may seem to be an easy topic, but the math and tech behind them is not as easy as using them. The base maps and overlays used in the Google Maps JavaScript API are processed in the Web Mercator projection system. In this projection system, the angles are preserved, but the size and shape of large objects change. As a result, the poles seem to be bigger than North America, which is not true at all. This projection is a good way to show the whole world in the same map.</p><p>Please check the later chapters for detailed information or check the Wikipedia article at <a class="ulink" href="https://en.wikipedia.org/wiki/Mercator_projection">https://en.wikipedia.org/wiki/Mercator_projection</a>.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec28"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <span class="emphasis"><em>Creating a simple map in a custom DIV element</em></span> recipe</li></ul></div></div></div></body></html>