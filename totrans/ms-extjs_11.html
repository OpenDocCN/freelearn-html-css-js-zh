<html><head></head><body><div class="chapter" title="Chapter&#xA0;11.&#xA0;Preparing for Production and Themes"><div class="titlepage"><div><div><h1 class="title"><a id="ch11"/>Chapter 11. Preparing for Production and Themes</h1></div></div></div><p>We completed our application in the preceding chapter. Now, it is time to create a nice theme to put a personal touch on the application and also prepare to deploy it on production. After all, we have been working on the development environment, and when we want to go live, we cannot simply deploy all the files; we need to do some preparation first. So, in this chapter, we will cover:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating custom themes</li><li class="listitem" style="list-style-type: disc">Packaging the application for production</li></ul></div><div class="section" title="Before we start"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec57"/>Before we start</h1></div></div></div><p>The main tool we are going to use in this chapter is Sencha Cmd<a id="id950" class="indexterm"/>. With Sencha Cmd, we will be able to create custom themes and make the production build. We always need to make sure the Sencha Cmd version we are using is compatible with the Ext JS version we are using. If you downloaded the preceding version of Ext JS from the Sencha website, please also get the latest Sencha Cmd (it will be compatible).</p><p>So far, this is what we have developed throughout this book:</p><div class="mediaobject"><img src="graphics/0457OT_11_01.jpg" alt="Before we start"/></div><p>All the code we <a id="id951" class="indexterm"/>created is inside <code class="literal">app</code>, <code class="literal">index.html</code>, <code class="literal">php</code>, <code class="literal">resources</code> (custom image icon, font, and custom locale files), and <code class="literal">sass</code> (custom application CSS). The other folders and files were created by Sencha Cmd, as you learned in <a class="link" href="ch02.html" title="Chapter 2. Getting Started">Chapter 2</a>, <span class="emphasis"><em>Getting Started</em></span>.</p></div></div>
<div class="section" title="Creating a new theme"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec58"/>Creating a new theme</h1></div></div></div><p>The first task<a id="id952" class="indexterm"/> we will perform in this chapter is to create a new theme for our project. To do so, we will use Sencha Cmd and the terminal application of the operating system.</p><p>Sencha Cmd now has the capability to generate the complete file structure we need to create a brand new theme.</p><p>So, let's create a <a id="id953" class="indexterm"/>new theme step by step. First, with the terminal open, change the directory to the project's root folder. Then, we will use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sencha generate theme masteringextjs-theme</strong></span>
</pre></div><p>The output for the preceding command is as follows:</p><div class="mediaobject"><img src="graphics/0457OT_11_02.jpg" alt="Creating a new theme"/></div><p>Here, <code class="literal">masteringextjs-theme</code> is the <a id="id954" class="indexterm"/>name of our theme. This <a id="id955" class="indexterm"/>command will create a new directory with the name of our theme inside the <code class="literal">packages</code> folder, as follows:</p><div class="mediaobject"><img src="graphics/0457OT_11_03.jpg" alt="Creating a new theme"/></div><p>The <code class="literal">package.json</code> file contains some configurations of the theme used by Sencha Cmd, such as theme name, version, and dependencies.</p><p>The <code class="literal">sass</code> directory<a id="id956" class="indexterm"/> contains all the Sass files of our theme. Inside this directory, we will find three more main directories:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">var</code>: This<a id="id957" class="indexterm"/> contains Sass variables.</li><li class="listitem" style="list-style-type: disc"><code class="literal">src</code>: This <a id="id958" class="indexterm"/>contains Sass rules and mixins. These rules and mixins use variables declared on files inside the <code class="literal">sass/var</code> directory.</li><li class="listitem" style="list-style-type: disc"><code class="literal">etc</code>: This <a id="id959" class="indexterm"/>contains additional utility functions and mixins.</li></ul></div><p>All the files that we create must match the classpath of the component we are styling. For example, if we want to style the button component, we need to create the styles inside the file <code class="literal">sass/var/button/Button.scss</code>; if want to style the Component Panel, we need to create styles inside the file <code class="literal">sass/var/panel.scss</code>.</p><p>The <code class="literal">resources</code> folder <a id="id960" class="indexterm"/>contains images and other static resources that will be used by our theme.</p><p>The <code class="literal">overrides</code> folder<a id="id961" class="indexterm"/> contains all the JavaScript overrides to components that might be required for theming these components.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip36"/>Tip</h3><p>Spend some time exploring the contents of the following directories that we can find inside the <code class="literal">packages</code> folder to get more familiar with this way of organizing the Sass files: <code class="literal">ext-theme-classic</code>, <code class="literal">ext-theme-gray</code>, and <code class="literal">ext-theme-neptune</code>.</p></div></div><p>By default, any theme that we create uses <code class="literal">ext-theme-classic</code> as a base (the classic Ext JS blue theme). We are going to change to the <code class="literal">Neptune</code> theme that we have been using until now. To change the theme base, open the <code class="literal">package.json</code> file and locate the <code class="literal">extend</code> property. Change its value from <code class="literal">ext-theme-classic</code> to <code class="literal">ext-theme-neptune</code>. The content of <code class="literal">package.json</code> will be something like this:</p><div class="informalexample"><pre class="programlisting">{
    "name": "masteringextjs-theme",
    "type": "theme",
    "creator": "anonymous",
    "summary": "Short summary",
    "detailedDescription": "Long description of package",
    "version": "1.0.0",
    "compatVersion": "1.0.0",
    "format": "1",
    "slicer": {
        "js": [
            {
                "path": "${package.dir}/sass/example/custom.js",
                "isWidgetManifest": true
            }
        ]
    },
    "output": "${package.dir}/build",
    "local": true,
    "requires": [],
<span class="strong"><strong>    "extend": "ext-theme-neptune"</strong></span>
}</pre></div><p>We can use any Ext JS theme<a id="id962" class="indexterm"/> as the base theme of our custom theme. These are the possible options:</p><div class="mediaobject"><img src="graphics/0457OT_11_04.jpg" alt="Creating a new theme"/></div><p>We can use any <a id="id963" class="indexterm"/>theme package from Ext JS. We can find these packages inside <code class="literal">ext/packages</code>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note93"/>Note</h3><p>You can try the Theme Viewer example from the Ext JS example pages to try each theme.</p></div></div><p>After the theme structure is created, and we have changed the base theme, let's build it. To build it, we are going to use the terminal and Sencha Cmd again. Change the directory to <code class="literal">packages/masteringextjs-theme</code> and type the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sencha package build</strong></span>
</pre></div><p>The result will be somewhat like the following screenshot:</p><div class="mediaobject"><img src="graphics/0457OT_11_05.jpg" alt="Creating a new theme"/></div><p>The result of<a id="id964" class="indexterm"/> this <a id="id965" class="indexterm"/>command will be the creation of the <code class="literal">build</code> directory inside the <code class="literal">packages/masteringextjs-theme</code> folder, as follows:</p><div class="mediaobject"><img src="graphics/0457OT_11_06.jpg" alt="Creating a new theme"/></div><p>Inside this <code class="literal">build</code> folder, we<a id="id966" class="indexterm"/> can find the <code class="literal">resources</code> folder, and inside the resources folder we can find a file named <code class="literal">masteringextjs-theme-all.css</code>, which contains all the styles for all the components we styled on our theme (which is none so far, but we will get there). Even <a id="id967" class="indexterm"/>though we created a complete theme (styled all components), it is not 100 percent certain that we will use all the components in our application. Sencha Cmd has the ability to filter and create a CSS file with only the components we are going to use in our project. For this reason, we do not need to include <code class="literal">masteringextjs-theme-all.css</code> manually in our application.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note94"/>Note</h3><p>A <code class="literal">masteringextjs-theme</code>.<code class="literal">pkg</code> file will also be created inside <code class="literal">build/ masteringextjs-theme</code>. We can use this file to distribute the theme package to other developers. For more information, please read <a class="ulink" href="http://docs.sencha.com/cmd/5.x/cmd_packages/cmd_packages.html">http://docs.sencha.com/cmd/5.x/cmd_packages/cmd_packages.html</a>.</p></div></div><p>So let's set up our project so that it can use our theme. Inside <code class="literal">app.json</code>, locate the theme entry and change it to:</p><div class="informalexample"><pre class="programlisting">"theme": "masteringextjs-theme",</pre></div><p>With <code class="literal">sencha app watch</code> being executed in a terminal, we will be able to see that <code class="literal">Packt-all.css</code> will be overwritten. When we refresh the application, there will be no changes because we have not started to customize our theme yet.</p><p>For the next steps, it is very important to keep <code class="literal">sencha app watch</code> executed while we make the changes. This way we will be able to see the modifications by simply refreshing the browser.</p><div class="section" title="Changing the base color"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec108"/>Changing the base color</h2></div></div></div><p>Let's start <a id="id968" class="indexterm"/>customizing the theme right now! Let's go back to the <code class="literal">packages/masteringextjs-theme</code> folder. Here's how we customize the theme:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Inside the <code class="literal">sass/var</code> folder, create a new file named <code class="literal">Component.scss</code>. Let's add the following content to it:<div class="informalexample"><pre class="programlisting">$base-color: #317040 !default;</pre></div></li><li class="listitem">In the preceding code, we are declaring a Sass variable named <code class="literal">$base-color</code> with a greenish value. This will change the base color of the theme from blue to green. Let's apply the changes on our theme and see the changes.</li><li class="listitem">Open the browser and we will have something like the following screenshot:<div class="mediaobject"><img src="graphics/0457OT_11_07.jpg" alt="Changing the base color"/></div></li></ol></div><p>With a single line, we <a id="id969" class="indexterm"/>have a complete new theme! We can continue to add more styles to our custom theme and customize each and every component.</p></div><div class="section" title="Customizing components"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec109"/>Customizing components</h2></div></div></div><p>Let's make<a id="id970" class="indexterm"/> some changes in our theme. Inside <code class="literal">Component.scss</code>, add the following code:</p><div class="informalexample"><pre class="programlisting">$neutral-color: #8DF98B !default;</pre></div><p>The output will be the following:</p><div class="mediaobject"><img src="graphics/0457OT_11_08.jpg" alt="Customizing components"/></div><p>Note how the <a id="id971" class="indexterm"/>button background, the Grid Column header, and the Panel header inside the accordion menu have changed.</p><p>Let's go ahead and create some other files so that we can add more custom styles, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create the following files and folders:<div class="mediaobject"><img src="graphics/0457OT_11_09.jpg" alt="Customizing components"/></div></li><li class="listitem">Inside <code class="literal">Accordion.scss</code>, we will add the following code:<div class="informalexample"><pre class="programlisting">$accordion-header-color: #336600 !default;</pre></div><p>This will change the color of the header title of the panels inside the accordion menu.</p></li><li class="listitem">Inside <a id="id972" class="indexterm"/><code class="literal">Panel.scss</code>, we will add the following code:<div class="informalexample"><pre class="programlisting">$panel-light-header-color: #336600 !default;</pre></div><p>This color will be used to create a different shade of green for the Panel component.</p></li><li class="listitem">Inside <code class="literal">Bar.scss</code>, we will add the following code:<div class="informalexample"><pre class="programlisting">$tabbar-background-gradient: 'bevel' !default;</pre></div><p>This will change the gradient of the tab panel bar. Possible values can be found at <a class="ulink" href="http://goo.gl/fapTBA">http://goo.gl/fapTBA</a>.</p></li><li class="listitem">Inside <code class="literal">Tab.scss</code>, we will add the following code:<div class="informalexample"><pre class="programlisting">$tab-base-color-active: #E6F5EB !default;
$tab-base-color-focus-over: #339933 !default;
$tab-base-color-focus-active: #B2E0C2 !default;</pre></div><p>This will change the tab color to different shades of green.</p><p>So far, this is the output we have:</p><div class="mediaobject"><img src="graphics/0457OT_11_10.jpg" alt="Customizing components"/></div><p>Try comparing it to the previous output screenshot.</p></li><li class="listitem">Inside<a id="id973" class="indexterm"/> <code class="literal">Button.scss</code>, we will add the following code:<div class="informalexample"><pre class="programlisting">$packt-background-color: #669999 !default;
$packt-mate-gradient: 'matte' !default;
$packt-light-color: #339933 !default;
$packt-dark-color: #006600 !default;

$button-default-base-color: $packt-background-color;
$button-default-base-color-over: $packt-dark-color;
$button-default-base-color-pressed: $packt-dark-color;
$button-default-base-color-disabled: mix(#000, $packt-dark-color, 8%);
$button-default-border-color: $packt-dark-color !default;

$button-small-font-weight: bold !default;
$button-medium-font-weight: bold !default;
$button-large-font-weight: bold !default;

$button-default-color: #fff !default;

$button-default-glyph-color: $button-default-color;

$button-small-border-radius: 1px !default;
$button-medium-border-radius: 1px !default;
$button-large-border-radius: 1px !default;

$button-default-background-gradient: $packt-mate-gradient;
$button-default-background-gradient-disabled: $packt-mate-gradient;
$button-default-background-gradient-over: $packt-mate-gradient;
$button-default-background-gradient-pressed: $packt-mate-gradient;

$button-toolbar-border-color: $packt-background-color;

$button-toolbar-background-color: $packt-light-color;
$button-toolbar-background-color-over: $packt-dark-color;
$button-toolbar-background-color-pressed: $packt-dark-color;
$button-toolbar-background-color-disabled: mix(#000, $packt-dark-color, 8%);

$button-toolbar-color: #fff !default;

$button-toolbar-background-gradient: $packt-mate-gradient;
$button-toolbar-background-gradient-disabled: $packt-mate-gradient;
$button-toolbar-background-gradient-focus: $packt-mate-gradient;
$button-toolbar-background-gradient-over: $packt-mate-gradient;
$button-toolbar-background-gradient-pressed: $packt-mate-gradient;

$button-default-glyph-color: #fff !default;</pre></div><p>This will be the output for our new custom buttons:</p><div class="mediaobject"><img src="graphics/0457OT_11_11.jpg" alt="Customizing components"/></div></li></ol></div><p>The <a id="id974" class="indexterm"/>buttons (normal ones and the ones placed inside a toolbar) look very different now.</p><div class="section" title="Some useful tips while creating new themes"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl3sec60"/>Some useful tips while creating new themes</h3></div></div></div><p>There is no recipe or <a id="id975" class="indexterm"/>detailed tutorial on how to create a completely customized theme in Ext JS. Usually, the names of the Sass variables used by Ext JS are self-explanatory. For example, <code class="literal">$button-default-glyph-color</code> is the color used to render the glyphs for buttons.</p><p>The following are some tips that could prove useful in the process of creating Ext JS themes:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Try learning Sass and Compass. Sass and Compass have mixins and useful functions to work with colors, among other functionalities (<a class="ulink" href="http://sass-lang.com/documentation/file.SASS_REFERENCE.html">http://sass-lang.com/documentation/file.SASS_REFERENCE.html</a>).</li><li class="listitem" style="list-style-type: disc">Take a look at the variables and the current values used by the theme you are using as the base theme. You can find its source code at <code class="literal">ext/packages/ext-theme-neptune/sass/var</code>.</li><li class="listitem" style="list-style-type: disc">Experiment! The best way to learn something new is to practice it. A good approach can be to copy the original file (for example, <code class="literal">Button.scss</code>) from the directory listed previously, start changing the variable values, and see what happens!</li><li class="listitem" style="list-style-type: disc">While experimenting, try using different colors (with contrast, such as red, yellow, black, blue, or any other color of your preference) so you can see exactly what is being changed in the theme!</li><li class="listitem" style="list-style-type: disc">Consult <a id="id976" class="indexterm"/>the documentation. Each class in Ext JS has a section of the Sass variables used, with a description and possible values. Make sure to make the most of it:<div class="mediaobject"><img src="graphics/0457OT_11_12.jpg" alt="Some useful tips while creating new themes"/></div></li></ul></div></div></div><div class="section" title="Creating custom UIs"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec110"/>Creating custom UIs</h2></div></div></div><p>Ext JS<a id="id977" class="indexterm"/> also supports UIs, which are special themes that can be applied to specific components. For example, let's say that for the buttons <span class="strong"><strong>Print</strong></span>, <span class="strong"><strong>Export to PDF</strong></span> and <span class="strong"><strong>Export to Excel</strong></span>, we want to apply a different theme. We can create a UI.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">The first step is checking the documentation for what UIs, known as <span class="strong"><strong>CSS Mixins</strong></span>, are available:<div class="mediaobject"><img src="graphics/0457OT_11_13.jpg" alt="Creating custom UIs"/></div></li><li class="listitem">Then, check all the variables needed to create this mixin. We can declare the custom<a id="id978" class="indexterm"/> variables inside the <code class="literal">masteringextjs-theme/sass/var/button/Button.scss</code> file we created earlier, as follows:<div class="informalexample"><pre class="programlisting">$button-packt-custom-color: #336600 !default;
$packt-custom-base-color: #C2E0D1 !default;

$button-packt-custom-small-border-radius: $button-small-border-radius;
$button-packt-custom-small-border-width: 1px;

$button-packt-custom-base-color: $packt-custom-base-color;
$button-packt-custom-base-color-over: $packt-dark-color;
$button-packt-custom-base-color-focus: $packt-dark-color;
$button-packt-custom-base-color-pressed: $packt-dark-color;
$button-packt-custom-base-color-disabled: lighten($button-packt-custom-base-color, 40%);

$button-packt-custom-small-border-radius: 0px;
$button-packt-custom-small-border-width: 1px;

$button-packt-custom-border-color: darken($button-packt-custom-base-color, 20%);
$button-packt-custom-border-color-over:$button-packt-custom-border-color;
$button-packt-custom-border-color-focus:$button-packt-custom-border-color;
$button-packt-custom-border-color-pressed:$button-packt-custom-border-color-over;
$button-packt-custom-border-color-disabled:lighten($button-packt-custom-border-color, 40%);

$button-packt-custom-small-padding: 2px;
$button-packt-custom-small-text-padding: 4px;

$button-packt-custom-background-color:$button-packt-custom-base-color;
$button-packt-custom-background-color-over:$button-packt-custom-border-color;
$button-packt-custom-background-color-focus:$button-packt-custom-background-color;
$button-packt-custom-background-color-pressed:$button-packt-custom-base-color-pressed;
$button-packt-custom-background-color-disabled:$button-packt-custom-base-color-disabled;

$button-packt-custom-background-gradient: 'mate';
$button-packt-custom-background-gradient-over: 'mate';
$button-packt-custom-background-gradient-focus: 'mate';
$button-packt-custom-background-gradient-pressed: 'mate-reverse';
$button-packt-custom-background-gradient-disabled: 'mate';

$packt-custom-font-size: 12px;
$packt-custom-font-family: helvetica , arial , verdana , sans-serif;

$button-packt-custom-color-over: #fff !default;
$button-packt-custom-color-focus: $button-packt-custom-color-over;
$button-packt-custom-color-pressed: $button-packt-custom-color-over;
$button-packt-custom-color-disabled: $button-packt-custom-color-over;

$button-packt-custom-small-font-size: $packt-custom-font-size;
$button-packt-custom-small-font-size-over: $packt-custom-font-size;
$button-packt-custom-small-font-size-focus: $packt-custom-font-size;
$button-packt-custom-small-font-size-pressed: $packt-custom-font-size;
$button-packt-custom-small-font-size-disabled: $packt-custom-font-size;

$button-packt-custom-small-font-weight: $button-small-font-weight;
$button-packt-custom-small-font-weight-over: $button-small-font-weight;
$button-packt-custom-small-font-weight-focus: $button-small-font-weight;
$button-packt-custom-small-font-weight-pressed: $button-small-font-weight;
$button-packt-custom-small-font-weight-disabled: $button-small-font-weight;

$button-packt-custom-small-font-family: $packt-custom-font-family;
$button-packt-custom-small-font-family-over: $packt-custom-font-family;
$button-packt-custom-small-font-family-focus: $packt-custom-font-family;
$button-packt-custom-small-font-family-pressed: $packt-custom-font-family;
$button-packt-custom-small-font-family-disabled: $packt-custom-font-family;

$button-packt-custom-small-icon-size: 16px;
$button-packt-custom-glyph-color: $button-packt-custom-color;
$button-packt-custom-glyph-opacity: .5;
$button-packt-custom-small-arrow-width: 12px;
$button-packt-custom-small-arrow-height: 12px;
$button-packt-custom-small-split-width: 14px;
$button-packt-custom-small-split-height: 14px;</pre></div></li><li class="listitem">Then, we<a id="id979" class="indexterm"/> are going to create a new file <code class="literal">masteringextjs-theme/sass/src/button/Button.scss</code> with our custom UI:<div class="informalexample"><pre class="programlisting">@include extjs-button-ui(
  $ui: 'custom-btn-small',

  $border-radius: $button-packt-custom-small-border-radius,
  $border-width: $button-packt-custom-small-border-width,

  $border-color: $button-packt-custom-border-color,
  $border-color-over: $button-packt-custom-border-color-over,
  $border-color-focus: $button-packt-custom-border-color-focus,
  $border-color-pressed: $button-packt-custom-border-color-pressed,
  $border-color-disabled: $button-packt-custom-border-color-disabled,

  $padding: $button-packt-custom-small-padding,
  $text-padding: $button-packt-custom-small-text-padding,

  $background-color: $button-packt-custom-background-color,
  $background-color-over: $button-packt-custom-background-color-over,
  $background-color-focus: $button-packt-custom-background-color-focus,
  $background-color-pressed: $button-packt-custom-background-color-pressed,
  $background-color-disabled: $button-packt-custom-background-color-disabled,

  $background-gradient: $button-packt-custom-background-gradient,
  $background-gradient-over: $button-packt-custom-background-gradient-over,
  $background-gradient-focus: $button-packt-custom-background-gradient-focus,
  $background-gradient-pressed: $button-packt-custom-background-gradient-pressed,
  $background-gradient-disabled: $button-packt-custom-background-gradient-disabled,

  $color: $button-packt-custom-color,
  $color-over: $button-packt-custom-color-over,
  $color-focus: $button-packt-custom-color-focus,
  $color-pressed: $button-packt-custom-color-pressed,
  $color-disabled: $button-packt-custom-color-disabled,

  $font-size: $button-packt-custom-small-font-size,
  $font-size-over: $button-packt-custom-small-font-size-over,
  $font-size-focus: $button-packt-custom-small-font-size-focus,
  $font-size-pressed: $button-packt-custom-small-font-size-pressed,
  $font-size-disabled: $button-packt-custom-small-font-size-disabled,

  $font-weight: $button-packt-custom-small-font-weight,
  $font-weight-over: $button-packt-custom-small-font-weight-over,
  $font-weight-focus: $button-packt-custom-small-font-weight-focus,
  $font-weight-pressed: $button-packt-custom-small-font-weight-pressed,
  $font-weight-disabled: $button-packt-custom-small-font-weight-disabled,

  $font-family: $button-packt-custom-small-font-family,
  $font-family-over: $button-packt-custom-small-font-family-over,
  $font-family-focus: $button-packt-custom-small-font-family-focus,
  $font-family-pressed: $button-packt-custom-small-font-family-pressed,
  $font-family-disabled: $button-packt-custom-small-font-family-disabled,

  $icon-size: $button-packt-custom-small-icon-size,
  $glyph-color: $button-packt-custom-glyph-color,
  $arrow-width: $button-packt-custom-small-arrow-width,
  $arrow-height: $button-packt-custom-small-arrow-height,
  $split-width: $button-packt-custom-small-split-width,
  $split-height: $button-packt-custom-small-split-height,
  $opacity-disabled: $button-opacity-disabled,
  $inner-opacity-disabled: $button-inner-opacity-disabled
);</pre></div></li></ol></div><p>Note that we are<a id="id980" class="indexterm"/> assigning our custom variables to the mixin variables needed to create this UI. As the button has three sizes in Ext JS, for now, we are going to declare the custom UI only for the small button, but it can be done for the other sizes as well.</p><div class="section" title="Applying the UI"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl3sec61"/>Applying the UI</h3></div></div></div><p>In our <a id="id981" class="indexterm"/>code, we are going to create a new file <code class="literal">app/view/base/CustomButton.js</code> with the following content:</p><div class="informalexample"><pre class="programlisting">Ext.define('Packt.view.base.CustomButton', {
    extend: 'Ext.button.Button',
    xtype: 'custom-btn',

    ui: 'custom-btn'
});</pre></div><p>Then, we are going to replace the <code class="literal">xtype</code> class of the buttons to which we want to apply this UI (creating a super class is easier than applying the <code class="literal">ui</code> configuration to each component, but the choice of doing it or not is up to you). We are going to replace the <code class="literal">xtype</code> configuration for the <span class="strong"><strong>Print</strong></span>, <span class="strong"><strong>Export to PDF</strong></span> and <span class="strong"><strong>Export to Excel</strong></span> buttons as shown by the following code (<code class="literal">Films.js</code> file):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>xtype: 'custom-btn',</strong></span>
text: 'Print',</pre></div><p>If we try to execute our application again, this will be the output:</p><div class="mediaobject"><img src="graphics/0457OT_11_14.jpg" alt="Applying the UI"/></div><p>Note that the <a id="id982" class="indexterm"/>
<span class="strong"><strong>Print</strong></span> and <span class="strong"><strong>Export</strong></span> buttons look different from the <span class="strong"><strong>Add</strong></span> button.</p><p>We can create as many UIs as we need and for any component that supports it. It is also possible to create UIs that are not part of a theme, meaning we can create it inside the <code class="literal">masteringextjs/sass</code> folder following the same structure we followed in this topic.</p><p>Now, all you have to do is free the designer who exists inside yourself!</p></div></div></div>
<div class="section" title="Packaging the application for production"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec59"/>Packaging the application for production</h1></div></div></div><p>Our theme<a id="id983" class="indexterm"/> is created, so now the only thing left is to make the<a id="id984" class="indexterm"/> production build and deploy the code on the production web server. Again, we will use Sencha Cmd to do it for us.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">To do a production build, we need to have a terminal opened. We also need to change the directory to the application's root directory and type the following command:<div class="informalexample"><pre class="programlisting">sencha app build</pre></div><p>Here's how the command looks on the terminal:</p><div class="mediaobject"><img src="graphics/0457OT_11_15.jpg" alt="Packaging the application for production"/></div></li><li class="listitem">Once the <a id="id985" class="indexterm"/>command execution is completed, it will create a new directory called <code class="literal">build/production/NameofTheApp</code>. As our application namespace is <code class="literal">Packt</code>, it creates the directory <code class="literal">build/production/Packt</code>, as follows:<div class="mediaobject"><img src="graphics/0457OT_11_16.jpg" alt="Packaging the application for production"/></div><p>What this command does is get all the code we developed (inside the <code class="literal">app</code> folder) plus the Ext JS code we really need to run the application and put it inside the <code class="literal">all-classes.js</code> file. Then, using<a id="id986" class="indexterm"/> <span class="strong"><strong>YUI Compressor</strong></span>, Sencha Cmd will minimize the code and obfuscate the JavaScript code; this way, we will have a very small JavaScript file that the user will need to load. Also, Sencha Cmd will evaluate all the components our application is using, filter the CSS that is not needed, and put it inside the <code class="literal">resources/Packt-all.css</code> file. All our custom images (icon images) will also be copied from the development environment to the <code class="literal">production</code> folder (inside the <code class="literal">resources</code> folder as well).</p></li><li class="listitem">The next<a id="id987" class="indexterm"/> step now is to make sure that the production build is working as expected. To access the development environment we use <code class="literal">http://localhost/masteringextjs</code>. To test the production build, we need to access <code class="literal">http://localhost/masteringextjs/build/production/Packt</code>. When we test it, we will see that it is not working as we really expect. We will get some errors.</li><li class="listitem">Next, we need to copy the <code class="literal">php</code> folders to the <code class="literal">production</code> folder as well, as shown in the following screenshot:<div class="mediaobject"><img src="graphics/0457OT_11_17.jpg" alt="Packaging the application for production"/></div></li><li class="listitem">We should <a id="id988" class="indexterm"/>also copy <code class="literal">ext/packages/ext-locale/build</code> and the locale files we are going to use.<p>And now, we can test the application again. It should work as expected.</p></li></ol></div><div class="section" title="Compiling ext-locale"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec111"/>Compiling ext-locale</h2></div></div></div><p>Here's a quick <a id="id989" class="indexterm"/>note about the <code class="literal">ext-locale</code> package: if you are using only one locale, you can add the <code class="literal">ext-locale</code> package in <code class="literal">requires</code> of <code class="literal">app.json</code> and a new entry <code class="literal">"locale" : "es"</code> with the code of the locale you want to use. Ext JS will compile the required files.</p><p>If you are using multiple locales, there are two options: doing like we did (manually copying the files) or making a production build for each locale. You can see an example of how to do it by exploring <code class="literal">app.json</code> and the source code of the<a id="id990" class="indexterm"/> <span class="strong"><strong>EXT JS Kitchen Sink</strong></span> example (<a class="ulink" href="http://dev.sencha.com/ext/5.0.1/examples/kitchensink/">http://dev.sencha.com/ext/5.0.1/examples/kitchensink/</a>).</p></div><div class="section" title="What to deploy in production"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec112"/>What to deploy in production</h2></div></div></div><p>Always<a id="id991" class="indexterm"/> remember that we have the <code class="literal">app</code> folder and all the code developed as our development environment. And inside the <code class="literal">production</code> folder, we have all the code that should be deployed in production.</p><p>So, let's say <a id="id992" class="indexterm"/>we want to deploy this application right now. Simply transfer all the content from <code class="literal">masteringextjs/build/production/Packt</code> to the desired folder on your web server, as follows:</p><div class="mediaobject"><img src="graphics/0457OT_11_18.jpg" alt="What to deploy in production"/></div><p>Happy production code!</p></div><div class="section" title="Benefits"><div class="titlepage"><div><div><h2 class="title"><a id="ch11lvl2sec113"/>Benefits</h2></div></div></div><p>What are <a id="id993" class="indexterm"/>the benefits of the production build? Can we just deploy the development code? We can deploy the development code as is in production, but it is not recommended. With the production build, we boost the performance while loading the files, but the file is minimized, which makes the code harder to read as well.</p><p>For example, let's do the following testing: open the application on the browser, log in, and open the <span class="strong"><strong>Actors</strong></span> screen from the static data module.</p><p>Using the development code, we will have the following result from Chrome Developer Tools (or Firebug):</p><div class="mediaobject"><img src="graphics/0457OT_11_19.jpg" alt="Benefits"/></div><p>The application <a id="id994" class="indexterm"/>made <span class="strong"><strong>657</strong></span> <span class="strong"><strong>requests</strong></span>, resulting in <span class="strong"><strong>7.7 MB</strong></span> of data transferred to the user, and it took <span class="strong"><strong>17.50 s</strong></span> to complete it. This is a lot, and talking about <span class="strong"><strong>7.7 MB</strong></span> to be transferred to the user is unacceptable!</p><p>Now let's see the results using the production build:</p><div class="mediaobject"><img src="graphics/0457OT_11_20.jpg" alt="Benefits"/></div><p>The application made <span class="strong"><strong>47 requests</strong></span> and <span class="strong"><strong>1.9 MB transferred</strong></span>. The most important change is the size of the data transferred: from <span class="strong"><strong>7.7 MB</strong></span> to <span class="strong"><strong>1.9 MB</strong></span>! This is a great improvement although <span class="strong"><strong>1.9 MB</strong></span> is still a large amount of data to be transferred. The files will be cached, and this number will decrease even more.</p><p>Another thing to notice is the files that are being loaded. In the development environment, we can see each Ext JS class being loaded by the browser:</p><div class="mediaobject"><img src="graphics/0457OT_11_21.jpg" alt="Benefits"/></div><p>At the end of it, it is <a id="id995" class="indexterm"/>going to be more than 400 JavaScript files being loaded just to render the <span class="strong"><strong>Login</strong></span> screen.</p><p>If we try the production build, we will have the following:</p><div class="mediaobject"><img src="graphics/0457OT_11_22.jpg" alt="Benefits"/></div><p>Only one JavaScript file is being loaded with the application's source code and the required Ext JS SDK code (<code class="literal">app.js</code>).</p><p>So, for performance purposes, always deploy the production build. Use the development code only for development purposes.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note95"/>Note</h3><p>If the application starts to grow, the amount of data that will be transferred to the browser will be greater than 2 MB, which is not good. You can create separate small applications and combine them as in a portal application. This way, the user will be able to download only the application files to the portion of the application that is going to be used at that moment and will not need to download all the application's source at once. This link contains a good discussion about the topic: <a class="ulink" href="http://goo.gl/az8uVT">http://goo.gl/az8uVT</a>.</p></div></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch11lvl1sec60"/>Summary</h1></div></div></div><p>In this chapter, we learned how to create a new theme, and we also learned how to create custom component UIs. You learned why it is important to make a production build and how to do it, including the difference between the files from the development environment to the production environment.</p><p>I hope you have enjoyed this book! Now, let the creativity flow to create really awesome Ext JS apps!</p></div></body></html>