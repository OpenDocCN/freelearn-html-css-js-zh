<html><head></head><body>
<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch13" class="calibre1"/>Chapter 13. Animation with Less</h1></div></div></div><p class="calibre7">How many times have you seen animated sites using Flash? OK, a fair few. I'll also bet that you wanted to skip the animation as soon as you could, right?</p><p class="calibre7">Yep, I thought so; not many hands going down now…</p><p class="calibre7">We cannot forget the bad old days of sites that used Flash, where we frequently wanted to skip badly designed animations, which often didn't provide any useful content but instead made sites slow. Sounds familiar?</p><p class="calibre7">Thankfully, things have moved on; over the next few pages, we'll see how you can use CSS3 animations instead to achieve the same effects that otherwise would have required Flash. The use of CSS3 animations eliminates the need for a heavy Flash plugin (for modern browsers), and provided they are done properly, can make a site faster, more enjoyable to browse, and engaging to the end user. We'll delve into the use of Less to simplify the process of coding some real-world examples in order to make our development workflow much easier.</p><p class="calibre7">In this chapter, we will cover the following topics:</p><div><ul class="itemizedlist"><li class="listitem">How a CSS animation works</li><li class="listitem">Transitions and transformations</li><li class="listitem">Animated menus</li><li class="listitem">Simplifying the animation markup with Less</li></ul></div><p class="calibre7">Intrigued? Let's make a start…</p></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_1"><a id="ch13lvl1sec106" class="calibre1"/>Introducing animations</h1></div></div></div><p class="calibre7">Back in <a id="id961" class="calibre1"/>the early days of the Internet, it was common to see animated GIFs that were often liberally plastered over a website—the excuse often being that they "look cool," even if they didn't really serve any purpose!</p><p class="calibre7">Nowadays, animation is being used more and more on the Internet—this is often in the form of SVG images, background videos, sounds, and so on. This increasingly used technologies such as Flash, but with the advent of HTML5, designers have found ways to recreate many effects natively in the browser without the use of Flash.</p><p class="calibre7">Today, browser vendors are adding more and more functionalities to each version of their product; this means that CSS3 animation is gaining ground to the likes of Flash, such that Adobe has stopped developing Flash for the mobile platform, preferring to concentrate on HTML5.</p><p class="calibre7">Over the next<a id="id962" class="calibre1"/> few pages, we'll be taking a tour of CSS3 animations, looking at various elements such as transitions and transforms, and how we can use Less to help simplify the process of developing animations. You might be surprised to learn that there aren't a lot of new techniques to master when using Less to produce an animation—in fact, all of the techniques we've covered so far can be used to help make development easier.</p><p class="calibre7">Let's start though with a quick look at what makes a good animation—after all, there is no point in creating them if they aren't successful!</p></div></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch13lvl1sec107" class="calibre1"/>Creating a good animation</h1></div></div></div><p class="calibre7">How often <a id="id963" class="calibre1"/>have you looked at a site only to find that it looks like the inside of someone's brain in the middle of a migraine? Too many sites fall victim to the temptation to animate everything—animation is a secret ingredient that can make the most impact when care has been taken over its use.</p><p class="calibre7">So, what makes a good animation? This will depend on the context of the site, but there are some good tips that every designer should follow:</p><div><ul class="itemizedlist"><li class="listitem">Don't overdo the attention grabbers—visitors want to feel in control of their browsing experience, so plastering a subscription dialog just when they reach the information they need is a big no-no! Use it to highlight something they might have missed, not to distract them.</li><li class="listitem">Animation works well when it is used to highlight context and navigation features; a good example is an animated sidebar that provides useful local information. The contents of the sidebar will change frequently, so the use of animation will help to point out new information to users.</li><li class="listitem">On some sites, telling a story is one way to use animation. While this might be an overkill for some sites, the popular full-page scroll effect works well, as it suggests that there is more to be read, which helps to keep the user interested.</li><li class="listitem">If an animation is used, then make it physical and believable. You can use any effect on the elements, such as bouncing or shaking, but if they aren't believable, then users will find them a distraction and a big turn-off!</li></ul></div><p class="calibre7">Let's move<a id="id964" class="calibre1"/> on now and turn the focus of our attention to something more in-depth: how do animations work? This is the key to creating successful animations. As we are about to see, the different types of animation appear similar, but they have some key differences; this can affect how we use them to develop effects on our site.</p></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch13lvl1sec108" class="calibre1"/>How a CSS animation works</h1></div></div></div><p class="calibre7">We've<a id="id965" class="calibre1"/> talked about animations in general, but the term covers no fewer than four different types that we can use within Less. They are animations, transitions, 2D transforms, and 3D transforms.</p><p class="calibre7">There are two out of these four properties where particular attention should be paid to how they work: animations and transitions. This doesn't mean that transforms are any less important—that's not the case. They merely work in a different way to transitions and are easier to understand and use.</p><p class="calibre7">Animations <a id="id966" class="calibre1"/>and transitions can appear to provide<a id="id967" class="calibre1"/> the same result but work in different ways. The two crucial differences are:</p><div><ul class="itemizedlist"><li class="listitem">Transitions work on a two-state basis—they change an element from the starting position to the finishing position if we switch CSS states or if a pseudo-class has been triggered, such as <code class="email">:hover</code> or <code class="email">:focus</code></li><li class="listitem">Animations can use multiple <code class="email">@keyframes</code> or positions set between the starting and finishing state</li></ul></div><p class="calibre7">The remaining two animation properties, 2D and 3D transforms, don't work in the same way—they can manipulate the size and appearance of an element, but usually in situ (although they can be used while the element is moving).</p><p class="calibre7">Now that we've seen how animations work, it's an opportune moment to get to know each type of animation property in more detail.</p></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch13lvl1sec109" class="calibre1"/>Introducing animation types</h1></div></div></div><p class="calibre7">When we talk<a id="id968" class="calibre1"/> about creating animations, this could be taken to mean that we're moving content; while this is perfectly true, we're not limited to simply moving elements. We could equally transition elements from one state to another or bend and manipulate their appearance on the screen. Let's take a look at each animation type in more detail, beginning with animations.</p></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch13lvl2sec107" class="calibre1"/>Animating content</h2></div></div></div><p class="calibre7">Animating <a id="id969" class="calibre1"/>content is used to move objects and can be used <a id="id970" class="calibre1"/>as an alternative to using Flash. They define what happens to a set of element's properties—we can control how these properties behave when defining our animation, including their frequency.</p><p class="calibre7">The key difference between animations and transitions is that animations can be fired without any user interaction, as soon as a page loads. Transitions can only be fired when an element becomes active, such as a <code class="email">button</code> element or a <code class="email">div</code> element.</p><p class="calibre7">A simple animation will follow this format:</p><div><pre class="programlisting">animation: &lt;name of animation&gt; &lt;duration of the animation&gt;</pre></div><p class="calibre7">Let's test this by creating a simple animation that changes the color of a box. For this, we will need a copy of the code download that accompanies this book; from this, extract a copy of <code class="email">animatebox.html</code> and <code class="email">animatebox.css</code>.</p><p class="calibre7">If we run the demo, we can expect to see the box go through several shades of purple before reverting to the original color, as shown in the following screenshot:</p><div><img src="img/00121.jpeg" alt="Animating content" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">The key to this is <code class="email">@keyframes animbox</code> in our CSS; this contains the changes that should be made in each keyframe within our animation. We've had to include it twice in order to allow support for Chrome, Safari, and Opera:</p><div><pre class="programlisting">/* Chrome, Safari, Opera */
@-webkit-keyframes animbox { 
  0% { background: #85486d; }
  25% { background: #9F6287; }
  50% { background: #B87BA0; }
  100% { background: #D295BA; }
}

/* Standard syntax */
@keyframes animbox {
  0% { background: #85486d; }
  25% { background: #9F6287; }
  50% { background: #B87BA0; }
  100% { background: #D295BA; }
}</pre></div><p class="calibre7">The<a id="id971" class="calibre1"/> animation is a little jittery—this will be due to the<a id="id972" class="calibre1"/> large gaps within each keyframe; we could use smaller gaps for a smoother experience.</p><div><h3 class="title2"><a id="note65" class="calibre1"/>Note</h3><p class="calibre7">You can <a id="id973" class="calibre1"/>learn more about the different attributes for CSS3 animations at <a class="calibre1" href="http://www.w3schools.com/css/css3_animations.asp">http://www.w3schools.com/css/css3_animations.asp</a>.</p></div><p class="calibre7">Let's continue and take a look at how transitions work.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch13lvl2sec108" class="calibre1"/>Transitioning elements</h2></div></div></div><p class="calibre7">Transitions <a id="id974" class="calibre1"/>are effectively animations that change the <a id="id975" class="calibre1"/>state of an element from its original state to a new state; the key difference in animations is that transitions can only take place when they are explicitly triggered—for example, if a mouse hovers over a DIV or button.</p><p class="calibre7">A simple transition will follow this format:</p><div><pre class="programlisting">transition: &lt;the css property you want to add the effect to&gt; &lt;the effect duration&gt;</pre></div><p class="calibre7">Let's test this by creating a simple transition that increases the size of a box. For this, we will need a copy of the code download that accompanies this book; from this, extract a copy of <code class="email">transitionbox.html</code> and <code class="email">transitionbox.css</code>. If we run the demo, we can expect to see the box increase in size before reverting to the original size:</p><div><img src="img/00122.jpeg" alt="Transitioning elements" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">The key<a id="id976" class="calibre1"/> to this is the transition code for the <code class="email">#transitionbox</code> DIV<a id="id977" class="calibre1"/> in our CSS—this contains the changes that should be made in each keyframe within our animation. We've had to include it twice to allow support for WebKit browsers:</p><div><pre class="programlisting">    -webkit-transition: width 2s; transition: width 2s;</pre></div><p class="calibre7">We can always adjust the time taken for the animation to perform, should 2 seconds not be sufficient.</p><div><h3 class="title2"><a id="note66" class="calibre1"/>Note</h3><p class="calibre7">You can learn<a id="id978" class="calibre1"/> more about the different attributes for CSS3 animations at <a class="calibre1" href="http://www.w3schools.com/css/css3_transitions.asp">http://www.w3schools.com/css/css3_transitions.asp</a>.</p></div><p class="calibre7">Let's move on now and take a look at the remaining two options, which are 2D and 3D transforms.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch13lvl2sec109" class="calibre1"/>Transforming elements</h2></div></div></div><p class="calibre7">At first <a id="id979" class="calibre1"/>glance, you'd be forgiven for thinking that<a id="id980" class="calibre1"/> transforms are identical to transitions; after all, you can easily<a id="id981" class="calibre1"/> use <code class="email">translate()</code> to move an object, whereas you can use an animation otherwise.</p><p class="calibre7">However, there are two key differences: transitions can be applied as part of animating an element, whereas transforms are completely independent. Transitions allow you to apply changes to<a id="id982" class="calibre1"/> just about any CSS property, whereas<a id="id983" class="calibre1"/> transforms will be used to move, scale, turn, spin, or stretch any element on the page:</p><div><img src="img/00123.jpeg" alt="Transforming elements" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">A simple transform will follow this format:</p><div><pre class="programlisting">transform: &lt;the transform action you want to use&gt;(&lt;the value to apply to the transform&gt;)</pre></div><p class="calibre7">Let's test this by creating two simple transforms: the first transform performs a 2D rotation on a box, and the second performs a 3D rotation along the <em class="calibre9">x</em> axis of the second box.</p><p class="calibre7">For this, we will need a copy of the code download that accompanies this book; from it, extract a copy of <code class="email">transformbox.html</code> and <code class="email">transformbox.css</code>. If we run the demo, we can expect to see both the boxes rotate when hovering over either of these; the box on the left-hand side is rotated by 30 degrees, and the box on the right-hand side is rotated on its <em class="calibre9">x</em> axis by 130 degrees, as shown in the screenshot at the start of this section.</p><p class="calibre7">The key to this is the transform code in our CSS—for the first box, we're rotating it by 30 degrees; the second is being rotated on its <em class="calibre9">x</em> axis by 130 degrees. Note how the support for 2D transforms is much better than that for 3D transforms; we still need to use the <code class="email">webkit</code> prefix for most desktop browsers:</p><div><pre class="programlisting">#transform2dbox:hover { 
  transform: rotate(30deg); 
} 

#transform3dbox:hover {
  -webkit-transform: rotateX(130deg); /* Chrome, Safari, Opera */
  transform: rotateX(130deg);
}</pre></div><p class="calibre7">Once support for browsers has improved on the 3D transform, we can then remove the first line in the second demo.</p><div><h3 class="title2"><a id="note67" class="calibre1"/>Note</h3><p class="calibre7">You can <a id="id984" class="calibre1"/>learn more about the different attributes for CSS3 transforms at <a class="calibre1" href="http://www.w3schools.com/css/css3_2dtransforms.asp">http://www.w3schools.com/css/css3_2dtransforms.asp</a> and <a class="calibre1" href="http://www.w3schools.com/css/css3_3dtransforms.asp">http://www.w3schools.com/css/css3_3dtransforms.asp</a>.</p></div><p class="calibre7">We've<a id="id985" class="calibre1"/> talked a little about support for CSS3 animations <a id="id986" class="calibre1"/>as part of exploring these mini demos; now is an opportune moment to cover support in more detail.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch13lvl2sec110" class="calibre1"/>Supporting animations in browsers</h2></div></div></div><p class="calibre7">One small <a id="id987" class="calibre1"/>point that we need to cover<a id="id988" class="calibre1"/> before moving on is browser support. Here <a id="id989" class="calibre1"/>you should have no trouble while working with animations; all the key elements of CSS3 animations have been supported by the major browsers for some time:</p><div><table border="1" class="calibre15"><colgroup class="calibre16"><col class="calibre17"/><col class="calibre17"/><col class="calibre17"/><col class="calibre17"/><col class="calibre17"/></colgroup><thead class="calibre18"><tr class="calibre19"><th valign="bottom" class="calibre20">
<p class="calibre21">IE</p>
</th><th valign="bottom" class="calibre20">
<p class="calibre21">Firefox</p>
</th><th valign="bottom" class="calibre20">
<p class="calibre21">Chrome</p>
</th><th valign="bottom" class="calibre20">
<p class="calibre21">Safari</p>
</th><th valign="bottom" class="calibre20">
<p class="calibre21">Opera</p>
</th></tr></thead><tbody class="calibre22"><tr class="calibre19"><td valign="top" class="calibre23">
<p class="calibre21">10+</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">5+</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">5+</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">4+</p>
</td><td valign="top" class="calibre23">
<p class="calibre21">12+</p>
</td></tr></tbody></table></div><p class="calibre7">Do check out<a id="id990" class="calibre1"/> the site <strong class="calibre8">Can I Use</strong> (<a class="calibre1" href="http://www.caniuse.com">http://www.caniuse.com</a>), as some of the newer elements of animation might still require vendor prefixes at the time of writing.</p><p class="calibre7">Mobile support is equally well-supported; the only exception to this is Opera Mini, which lacks support for animations. Chrome for Android was a little buggy at the start, but this issue has since been resolved, so support will not be an issue. It is important to remember though that mobile devices don't have fast processors, so complex animations will run slowly and should be kept to a minimum on this platform.</p><p class="calibre7">Right, enough <a id="id991" class="calibre1"/>of the theory! Let's<a id="id992" class="calibre1"/> move on to what you all have been waiting for: writing <a id="id993" class="calibre1"/>some code.</p></div></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch13lvl1sec110" class="calibre1"/>Simplifying the animation markup with Less</h1></div></div></div><p class="calibre7">Okay, we're<a id="id994" class="calibre1"/> finally at the point where I am sure <a id="id995" class="calibre1"/>you're itching to get to: writing some code! Don't worry, we're almost there. I just want to cover a small but key point, about how we can use Less to make coding animations simpler. To illustrate this, we're going to rework the critical parts of the animation demo we created earlier in this chapter.</p><p class="calibre7">If we take a look back at the key parts of the animation demo, we have this:</p><div><pre class="programlisting">/* Chrome, Safari, Opera */
@-webkit-keyframes animbox {
  0% { background: #85486d; }
  25% { background: #9F6287; }
  50% { background: #B87BA0; }
  100% { background: #D295BA; }
}

/* Standard syntax */
@keyframes animbox {
  0% { background: #85486d; }
  25% { background: #9F6287; }
  50% { background: #B87BA0; }
  100% { background: #D295BA; }
}</pre></div><p class="calibre7">Seems pretty reasonable, right? Well, as always, we can do better! Let's see how:</p><div><ol class="orderedlist"><li class="listitem" value="1">The first change that we can make is save <code class="email">animatebox.css</code> as <code class="email">animatebox.less</code>—we'll introduce some mixins, so saving it as a Less file will allow us to compile it into valid CSS later in this exercise.</li><li class="listitem" value="2">We need to modify the HTML markup to include a reference to our new Less file and the Less library; so, go ahead and add the following in between the <code class="email">&lt;head&gt;</code> markup:<div><pre class="programlisting">  &lt;link rel="stylesheet/less" href="css/animatebox-updated.less"&gt;
  &lt;script src="img/less.min.js"&gt;&lt;/script&gt;</pre></div></li><li class="listitem" value="3">Next, let's turn the <code class="email">@keyframes</code> code into a generic animation mixin—remove the existing two blocks at the end of the code (lines 15-29) and then replace it with the following code:<div><pre class="programlisting">.keyframes (@name, @color0, @color25, @color50, @color100) {
    @-webkit-keyframes @name { 
        0% {background: @color0} 
        25%  {background: @color25;}
        50%  {background: @color50;}
        100% {background: @color100;}
    }
        
    @keyframes @name { 
        0% {background: @color0} 
        25%  {background: @color25;}
        50%  {background: @color50;}
        100% {background: @color100;}
    }
}</pre></div></li><li class="listitem" value="4">Next, we add a new mixin that references the <code class="email">@keyframes</code> code we've just created:<div><pre class="programlisting">.keyframes(animbox, #85486d, #9F6287, #B87BA0, #B87BA0);</pre></div></li></ol><div></div><p class="calibre7">If we <a id="id996" class="calibre1"/>rerun the demo, we should see no change in <a id="id997" class="calibre1"/>the effect. So what's different and why have we done what we've done here? Well, there are several benefits of what we've done.</p><p class="calibre7">We moved the <code class="email">@keyframes</code> code into its own mixin—while the code might not seem shorter here, the benefits will really show when we create larger, more complex animations that have to be repeated to allow vendor prefixing.</p><p class="calibre7">The <code class="email">.keyframes</code> mixin <a id="id998" class="calibre1"/>can now go into our own mixin library; this means that we can import the library into future projects:</p><div><pre class="programlisting">@import "animations.less";</pre></div><p class="calibre7">Reference the mixin in our code:</p><div><pre class="programlisting">.some-animation {
  .keyframes(…);
  …
}</pre></div><p class="calibre7">Using Less to simplify our code isn't necessarily about making it shorter; it's also about making it reusable and easier to add to future projects!</p><div><h3 class="title2"><a id="tip31" class="calibre1"/>Tip</h3><p class="calibre7">There's an updated demo available in the code—extract and run <code class="email">animatebox-updated.html</code> to view the results.</p></div><p class="calibre7">Let's move<a id="id999" class="calibre1"/> on and work on a practical use of<a id="id1000" class="calibre1"/> Less. How many times have you designed a menu for a site, only to think that it is becoming very code repetitive and needs animating? Okay, probably a little bit of a contrived question, but it could be possible…</p></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch13lvl1sec111" class="calibre1"/>Creating animated menus</h1></div></div></div><p class="calibre7">Menus are<a id="id1001" class="calibre1"/> the doyen of many a site; we all need some form of navigation, but styling the navigation menus is very much left to the imagination of the site's designer.</p><p class="calibre7">We can even go further and add some useful effects to menus; we can at least animate the drop-down motion so that they glide in a little more gracefully. To do this, we're going to revisit an exercise from an earlier instance in the book—remember, back in <a class="calibre1" title="Chapter 4. Working with Variables, Mixins, and Functions" href="part0041_split_000.html#page">Chapter 4</a>, <em class="calibre9">Working with Variables, Mixins, and Functions</em>, where we created a simple web page using some Less functions? Well, we're going to add a menu to that page and when we're done, it will look something similar to this:</p><div><img src="img/00124.jpeg" alt="Creating animated menus" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Okay, let's make a start:</p><div><ol class="orderedlist"><li class="listitem" value="1">For this exercise, we need a copy of the code download that accompanies this book; from it, extract a copy of <code class="email">menus.html</code>. This contains a copy of the code from <a class="calibre1" title="Chapter 4. Working with Variables, Mixins, and Functions" href="part0041_split_000.html#page">Chapter 4</a>, <em class="calibre9">Working with Variables, Mixins, and Functions</em>, with the additional <a id="id1002" class="calibre1"/>markup for our menus and some cosmetic changes to import Less files.</li><li class="listitem" value="2">Next, crack open a text editor of your choice and add the following code to a new file—we'll break it down and go through it section by section, beginning with the main container for our menu:<div><pre class="programlisting">#navigation { 
  width: 788px; height: 35px; font-family: 'Kite One', sans-serif; font-weight: normal; font-size: 14px;
  ul { position: relative; z-index: 1000; list-style: none; margin: 0; padding: 0; }
}</pre></div></li><li class="listitem" value="3">Next come the top-level menu entries:<div><pre class="programlisting">#navigation &gt; ul &gt; li {
  position: relative; float: left; margin-right: 10px;
  &amp;:hover ul ul { height: 0; } 
  &amp;:hover ul { height: 220px; } 
  &amp; &gt; a:hover ul { height: 220px; }
}</pre></div></li><li class="listitem" value="4">These entries need to be turned into links; so, go ahead and add in this style rule:<div><pre class="programlisting">#navigation &gt; ul &gt; li &gt; a { 
  background-color: #2c2c2c; color: #aaaaaa; display: block; padding: 8px 14px; text-decoration: none; transition: background-color 0.3s ease 0s; 
  &amp;:hover { 
    background-color: #666666; color: #eeeeee;
    ul ul { height: 0; }
  }
}</pre></div></li><li class="listitem" value="5">Some of our submenus have second-level submenus, so we need to cater to these submenus in our styling:<div><pre class="programlisting">#navigation ul ul {
  width: 340px; position: absolute; z-index: 100; height: 0; overflow: hidden; transition: height 0.3s ease-in; 
  li { 
    background-color: #eaeaea; width: 170px; 
    transition: background-color 0.3s ease; 
    &amp;:hover { 
      background-color: #999; 
      &amp; &gt; a { color: #ffffff; }
            &amp; &gt; ul { height: 220px; }
    }
  }
}</pre></div></li><li class="listitem" value="6">This<a id="id1003" class="calibre1"/> style caters to our first-level submenus:<div><pre class="programlisting">#navigation ul ul li a { 
  display: block; text-decoration: none; margin: 0 12px;     padding: 5px 0; color: #4c4c4c; 
  &amp;:hover { 
    color: #ffffff; 
    &amp; &gt; ul { height: 220px; }
  }
}</pre></div></li><li class="listitem" value="7">Last, but by no means least—this provides the container for our second-level submenus:<div><pre class="programlisting">#navigation ul ul ul {
  left: 170px; width: 170px; 
  li a { border: 0 !important; }
}</pre></div></li><li class="listitem" value="8">We need an arrow to tell the users of our submenus, so let's add an arrow now:<div><pre class="programlisting">.arrow { background: url(arrow.png) right center no-repeat;
}</pre></div></li><li class="listitem" value="9">Save the file as <code class="email">menus.less</code>. Our <code class="email">menus.html</code> file already has a link to it, along with a link to <code class="email">base.less</code>; the latter contains the original code from <a class="calibre1" title="Chapter 4. Working with Variables, Mixins, and Functions" href="part0041_split_000.html#page">Chapter 4</a>, <em class="calibre9">Working with Variables, Mixins, and Functions</em>, but in a suitably renamed file.</li></ol><div></div><p class="calibre7">At this point, if we preview the results, we can see the new menu, as shown in the screenshot at the start of this exercise.</p><p class="calibre7">So, what have we done here? In this instance, we've kept it very simple; most of the styles in <code class="email">menus.less</code> are there to provide the basic styles to render our menu.</p><p class="calibre7">We've added three transition statements in though to add a subtle touch to our menu so that they each glide in more smoothly and then suddenly appear. Remember, animating elements can <a id="id1004" class="calibre1"/>provide that extra sense of dynamism to a site; in this instance, if the transform styles were not understood, then the menus will still work but will not render so gracefully on the screen.</p></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch13lvl1sec112" class="calibre1"/>Libraries using Less</h1></div></div></div><p class="calibre7">Over the last few pages, we've created some great demos of varying complexity—they show off something of what can be done with animations and how we can use Less.</p><p class="calibre7">The<a id="id1005" class="calibre1"/> trouble is, there's one small but crucial problem here. How many <a id="id1006" class="calibre1"/>of you have noticed that we've created each demo from scratch, with all the mixins included? I thought so, one of the precepts of Less is DRY or Don't Repeat Yourself.</p><p class="calibre7">If we take a look back at <a class="calibre1" title="Chapter 4. Working with Variables, Mixins, and Functions" href="part0041_split_000.html#page">Chapter 4</a>, <em class="calibre9">Working with Variables, Mixins, and Functions</em>, one of the subjects we covered was the use of external libraries within our code. Doing this means that we can avoid the need to write lots of mixins—while our examples here might have been a little too simple to warrant the use of an external library, we will definitely need to use at least one external library in a more complex site.</p><p class="calibre7">Thankfully, we can continue the same precept of DRY when working with animations; there are a number of Less-based libraries available that handle animation properties (and this<a id="id1007" class="calibre1"/> includes<a id="id1008" class="calibre1"/> both<a id="id1009" class="calibre1"/> transitions <a id="id1010" class="calibre1"/>and transforms):</p><div><ul class="itemizedlist"><li class="listitem">LESS<a id="id1011" class="calibre1"/> Prefixer (<a class="calibre1" href="http://lessprefixer.com/">http://lessprefixer.com/</a>)</li><li class="listitem">More-or-less (<a class="calibre1" href="http://more-or-less.org/">http://more-or-less.org/</a>)</li><li class="listitem">Animate.less (<a class="calibre1" href="https://github.com/machito/animate.less">https://github.com/machito/animate.less</a>)</li><li class="listitem">LESS<a id="id1012" class="calibre1"/> Hat (<a class="calibre1" href="https://github.com/madebysource/lesshat">https://github.com/madebysource/lesshat</a>)</li><li class="listitem">Bootstrap's LESS <a id="id1013" class="calibre1"/>(<a class="calibre1" href="https://github.com/twbs/bootstrap/">https://github.com/twbs/bootstrap/</a>)</li><li class="listitem">LESS Elements (<a class="calibre1" href="http://www.lesselements.com/">http://www.lesselements.com/</a>)</li></ul></div><p class="calibre7">We <a id="id1014" class="calibre1"/>can <a id="id1015" class="calibre1"/>even<a id="id1016" class="calibre1"/> go <a id="id1017" class="calibre1"/>one step further—if there isn't a library available in Less that is to your liking, then we can always use a plain CSS library.</p><p class="calibre7">The trick here is to resave it as a Less file and incorporate it in the usual manner. Over time, we can then convert it piecemeal as our skills improve. The beauty of this is that Less will still compile the original version as normal—don't forget, Less is after all a superset of CSS. With this in mind, let's take a look at a few examples of pure CSS animation libraries:</p><div><ul class="itemizedlist"><li class="listitem">Magic<a id="id1018" class="calibre1"/> CSS (<a class="calibre1" href="https://github.com/miniMAC/magic">https://github.com/miniMAC/magic</a>)</li><li class="listitem">Animate.css (<a class="calibre1" href="https://github.com/daneden/animate.css">https://github.com/daneden/animate.css</a>)</li><li class="listitem">Effeckt.css (<a class="calibre1" href="https://github.com/h5bp/Effeckt.css)">https://github.com/h5bp/Effeckt.css</a>)</li></ul></div><p class="calibre7">Now<a id="id1019" class="calibre1"/> that <a id="id1020" class="calibre1"/>we've seen the details of some of the libraries we could use, let's take a moment to try converting one of them to Less. I hear you ask, "Why should I do it?" Simple, while there are some good Less libraries available, you might as well find a CSS animation library that is more to your liking but that doesn't have a Less version available. If you do, then we need to convert it to use Less!</p></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch13lvl2sec111" class="calibre1"/>Converting from other libraries</h2></div></div></div><p class="calibre7">The <a id="id1021" class="calibre1"/>beauty about Less is that it is a <a id="id1022" class="calibre1"/>superset of CSS—this means that the conversion of an existing CSS library to its Less equivalent is easier than it might first seem. The trick behind it is all in the planning—to prove this, let's work through a simple example using the Magic CSS animation library.</p><p class="calibre7">Let's begin by downloading a copy of the library—we can do this by browsing to <a class="calibre1" href="https://raw.githubusercontent.com/miniMAC/magic/master/magic.css">https://raw.githubusercontent.com/miniMAC/magic/master/magic.css</a> and then saving a copy locally. Open a copy of <code class="email">magic.css</code> in the text editor of your choice and then resave it as <code class="email">magic.less</code>—that's it!</p><p class="calibre7">Sorry to disappoint you if you were expecting more; technically though, this is the minimum requirement to convert a library to its Less equivalent. We can then compile this using Crunch!, or if you have configured Sublime Text as detailed in <a class="calibre1" title="Chapter 2. Building a Less Development Toolkit" href="part0025_split_000.html#page">Chapter 2</a>, <em class="calibre9">Building a Less Development Toolkit</em>, then the compilation will have taken place to the point of saving your work.</p><p class="calibre7">Now, we could stay with this, but…there's a fair amount of repetition in our code, which isn't ideal; we can definitely do better. Let's fix the repetition now:</p><div><ol class="orderedlist"><li class="listitem" value="1">Create a new file and save it as <code class="email">keyframes.less</code> in the same folder as the original <code class="email">magic.less</code> file.</li><li class="listitem" value="2">Look for <code class="email">@-moz-keyframes magic {</code> on or around line 468—select from this line down to the end, which will be on or around line 4595.</li><li class="listitem" value="3">Cut and paste this in the <code class="email">keyframes.less</code> file you've just created and then save the file.</li><li class="listitem" value="4">Revert to <code class="email">magic.less</code>. You need to import the new file you've just created; so, go ahead and add this line at the top:<div><pre class="programlisting">@import "keyframes.less";</pre></div></li><li class="listitem" value="5">You can also improve the animation classes by adding the following lines immediately below the <code class="email">@import</code> statement:<div><pre class="programlisting">.vendor(@property, @value) {
  -webkit-@{property}: @value;
  -moz-@{property}: @value;
  -ms-@{property}: @value;
  -o-@{property}: @value;
  @{property}: @value;
}</pre></div></li><li class="listitem" value="6">Now comes the tedious part: you need to convert each of your animation classes to use the new mixin. Let's take the first, which is <code class="email">.magictime</code>:<div><pre class="programlisting">.magictime {
  -webkit-animation-duration: 1s;
  -moz-animation-duration: 1s;
  -ms-animation-duration: 1s;
  -o-animation-duration: 1s;
  animation-duration: 1s;
  -webkit-animation-fill-mode: both;
  -moz-animation-fill-mode: both;
  -ms-animation-fill-mode: both;
  -o-animation-fill-mode: both;
  animation-fill-mode: both;
}</pre></div></li><li class="listitem" value="7">We can easily convert the animation classes—the trick behind this is to use <strong class="calibre8">Search and Replace</strong> within a tool such as Sublime Text. We can update both the <code class="email">animation-duration</code> and <code class="email">animation-fill-mode</code> lines to use the Less mixin and then remove the remaining lines.</li><li class="listitem" value="8">Once the search and replace work has been completed, the remaining lines can be removed completely. We will end up with this as the first example:<div><pre class="programlisting">.magictime {
  .vendor(animation-duration, 1s);
  .vendor(animation-fill-mode, both);
}</pre></div></li><li class="listitem" value="9">We can then use the same process until we've converted all the animation classes within <code class="email">magic.less</code>.</li></ol><div></div><p class="calibre7">At this<a id="id1023" class="calibre1"/> point, we will have a half-converted <a id="id1024" class="calibre1"/>CSS file—this will work perfectly well. However, we can use the same principles to convert the <code class="email">keyframes.less</code> file at the same time—this is something that I will leave for you to work out! Hint: there's an example in the code download, if you really get stuck…</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch13lvl2sec112" class="calibre1"/>Using vendor prefixes – a warning</h2></div></div></div><p class="calibre7">Having<a id="id1025" class="calibre1"/> said this, there is one important point<a id="id1026" class="calibre1"/> we must visit: we've spent all this time converting the files, yet we're potentially following a bad practice! Huh—how does this work, I hear you ask?</p><p class="calibre7">Well, some of you will argue that this process is an antipattern—a practice that should not be followed, as it can make the CSS more verbose than it really needs to be.</p><div><h3 class="title2"><a id="note68" class="calibre1"/>Note</h3><p class="calibre7">For more<a id="id1027" class="calibre1"/> information on anti-patterns, you can refer to Mark Daggett's useful article that is worth a read and is available at <a class="calibre1" href="http://markdaggett.com/blog/2011/12/04/css-anti-patterns/">http://markdaggett.com/blog/2011/12/04/css-anti-patterns/</a>.</p></div><p class="calibre7">We can add to this, as vendor prefixes will come and go; moving them into one file may help reduce the amount of code we need to write, but it will assume that vendor prefixes remain the same for all the properties. This won't be the case—the trouble is, we can't remove any one of them until such time that none of the animation properties need it, and that is not likely to be for some time!</p><p class="calibre7">I've used the process here purely to illustrate how it can be done—it doesn't mean that it should be done. A better<a id="id1028" class="calibre1"/> process is to use an Autoprefixer, such as Alejandro Beltrán's Autoprefixer, which is available at <a class="calibre1" href="https://github.com/ai/autoprefixer">https://github.com/ai/autoprefixer</a>. There is a plugin available for Autoprefixer to allow it to <a id="id1029" class="calibre1"/>work in Sublime Text—this can be downloaded from <a class="calibre1" href="https://github.com/sindresorhus/sublime-autoprefixer">https://github.com/sindresorhus/sublime-autoprefixer</a>.</p><p class="calibre7">Okay, let's take<a id="id1030" class="calibre1"/> a break from coding for a moment<a id="id1031" class="calibre1"/> and move on. We've spent some time using Less to create our animations and converting some from CSS. There is one nagging question though, which I am sure you will be asking too: is using CSS really any better than using JavaScript, or is there more to it than what it first seems?</p></div></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch13lvl1sec113" class="calibre1"/>Using CSS or JavaScript</h1></div></div></div><p class="calibre7">If you've <a id="id1032" class="calibre1"/>spent time using JavaScript (and more likely, jQuery), then you will <a id="id1033" class="calibre1"/>know that we can use it to produce some complex animations. Achieving the same results in CSS might be a little bit of an eye-opener for some, but they may ask: which is better? If you thought CSS, then you'd be right…and wrong! Let me explain.</p><p class="calibre7">Conventional wisdom has always said that CSS is better—after all, JavaScript and jQuery use custom animation handlers that will repeat code between 30 and 60 times a second. This puts more pressure on a browser than a browser just running pure CSS.</p><p class="calibre7">However, lots of people have argued in favor of either; there are clear arguments for or against using either technology in a site. For example, in a post for the CSS-Tricks site, Jack Doyle (the creator of the professional animation library GSAP), puts forth a detailed case on why using CSS3 animations isn't always the right way forward; CSS3 still has a long way to go to match the likes of Flash.</p><p class="calibre7">The developer, David Walsh, has written an equally useful article that also explains why there might be cases where we should use CSS or JavaScript and that limitations in the former might require use of the latter. However, to really turn the tables, head over to <a class="calibre1" href="http://css3.bradshawenterprises.com/blog/jquery-vs-css3-transitions/">http://css3.bradshawenterprises.com/blog/jquery-vs-css3-transitions/</a>; you can see a great demo that proves JavaScript libraries, such as jQuery, actually perform worse than CSS when they are used to animate lots of elements!</p><div><h3 class="title2"><a id="note69" class="calibre1"/>Note</h3><p class="calibre7">David's article is available at <a class="calibre1" href="http://davidwalsh.name/css-js-animation">http://davidwalsh.name/css-js-animation</a>; it is definitely worth a read!</p></div><p class="calibre7">There is no right or wrong answer; the only way to be sure is to test your animations using tools such as Chrome's Developer toolbar to gauge the impact on the browser. A good rule of thumb though is to use vanilla CSS for animations and 2D transformations. If, however, your animation involves complicated timeline-based effects or you are moving a lot of elements, then JavaScript will be a better choice (animations frequently need to use more code than JavaScript to create the same effects).</p><p class="calibre7">Only testing<a id="id1034" class="calibre1"/> will tell whether you've made the right choice; start with seeing how<a id="id1035" class="calibre1"/> much you can achieve in CSS, and fallback to using JavaScript if CSS can't handle your requirements or places too much demand on the browser to manage the effect efficiently.</p><div><h3 class="title2"><a id="note70" class="calibre1"/>Note</h3><p class="calibre7">You can read the posting in full at <a class="calibre1" href="http://css-tricks.com/myth-busting-css-animations-vs-javascript/">http://css-tricks.com/myth-busting-css-animations-vs-javascript/</a>.</p></div><p class="calibre7">Okay, let's move on; we've seen now why it is important to choose whether we need to use jQuery instead of using Less/CSS. Assuming that you are still using Less/CSS to provide some form of animation, there are some tips we can use to help improve the performance of these animations; so, let's take a look at those now.</p></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch13lvl1sec114" class="calibre1"/>Improving the animation's performance</h1></div></div></div><p class="calibre7">Working <a id="id1036" class="calibre1"/>with CSS animations can be very rewarding, but we must be careful of the performance—if not done with care, animations can lead to unnecessary demands on the browser or can drain the battery power if you are working on a mobile device!</p><p class="calibre7">Unfortunately, a number of factors exist, which can affect performance and over which we may not have any control:</p><div><ul class="itemizedlist"><li class="listitem"><strong class="calibre8">Browser performance</strong>: All <a id="id1037" class="calibre1"/>browsers<a id="id1038" class="calibre1"/> behave differently with CSS3 and JavaScript.</li><li class="listitem"><strong class="calibre8">GPU performance</strong>: Some browsers now offload animation and transition operations <a id="id1039" class="calibre1"/>to the GPU, in<a id="id1040" class="calibre1"/> which case, the speed/performance is limited by the GPU. If you're on an integrated Intel GPU, it's not likely to be very smooth compared with a discrete NVIDIA or AMD graphics card.</li><li class="listitem"><strong class="calibre8">CPU performance</strong>: The <a id="id1041" class="calibre1"/>main <a id="id1042" class="calibre1"/>CPU will be used if the browser doesn't offload to the GPU (and therefore, become the bottleneck).</li><li class="listitem"><strong class="calibre8">The number of other tabs/windows opened in a browser</strong>: Browsers often share<a id="id1043" class="calibre1"/> processes across tabs, so other animations or CPU-consuming operations occurring in other tabs or browsers could create performance degradation.</li><li class="listitem"><strong class="calibre8">The use of gradients or box-shadow properties in our CSS code</strong>: This can cause<a id="id1044" class="calibre1"/> big performance hits, so avoid using these when animating elements.</li></ul></div><p class="calibre7">Currently, the <a id="id1045" class="calibre1"/>best way to improve performance is to limit the number of things that are being animated or transitioned at the same time.</p></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch13lvl2sec113" class="calibre1"/>Forcing hardware acceleration for a CSS animation</h2></div></div></div><p class="calibre7">All <a id="id1046" class="calibre1"/>is not lost <a id="id1047" class="calibre1"/>though—we can force browsers to <a id="id1048" class="calibre1"/>trigger hardware acceleration in the desktop or mobile browser by the addition of a simple property, <code class="email">transform: translateZ(0);</code>, in our code. This will hand over the rendering to the GPU, not the CPU.</p><p class="calibre7">As an example, if we have a class called <code class="email">.animate</code>, it would look similar to this:</p><div><pre class="programlisting">.accelarate {
<strong class="calibre8">  -webkit-transform: translateZ(0);</strong>
<strong class="calibre8">  -moz-transform: translateZ(0);</strong>
<strong class="calibre8">  -ms-transform: translateZ(0);</strong>
<strong class="calibre8">  -o-transform: translateZ(0);</strong>
<strong class="calibre8">  transform: translateZ(0);</strong>

  //Add other properties below this line...
  ...
}</pre></div><p class="calibre7">Notice how we need to add the vendor prefixes for each browser? The <code class="email">translateZ(0)</code> property is still experimental, so all the vendor prefixes are required to ensure full support. Browser support is good, but care needs to be taken, as overusing it can cause performance issues and battery draining.</p><p class="calibre7">A good test to see whether performance is being impacted is to use Chrome's <strong class="calibre8">Timeline</strong> and <strong class="calibre8">Profiles</strong> option in the <strong class="calibre8">Developer tools</strong> option. Do check out the article by Addy Osmani at <a class="calibre1" href="http://addyosmani.com/blog/performance-optimisation-with-timeline-profiles/">http://addyosmani.com/blog/performance-optimisation-with-timeline-profiles/</a>, where<a id="id1049" class="calibre1"/> he talks about how to use development tools to gauge performance. It is 2-3 years old, and there have been some changes in how development tools <a id="id1050" class="calibre1"/>work, but the principles are<a id="id1051" class="calibre1"/> still valid.</p></div></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch13lvl1sec115" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">Animating elements on a web page or a site is like crossing a fine line—one wrong foot can turn a site that looks stunning into a real dog's dinner of a mess that will turn off everyone who visits it! Throughout this chapter, we covered the basics of animation and saw how we can use Less to simplify the process. Before we move on to the next chapter, let's take a moment to recap what we learned.</p><p class="calibre7">We kicked off with a simple introduction to what makes a good animation before moving on to examine how a CSS animation works. We then explored the different types of animations before covering off the all-important browser support for the technology.</p><p class="calibre7">Next, we took a look at how we can simplify the creation of animation styles by reworking a simple animation demo to use Less. We then moved on to create a more real-world example in the form of a simple menu demo, which uses transitions to animate the drop-down elements. With the demo completed, we moved on to examine how we can use Less libraries to help with our animation styling, and saw that the principles from <a class="calibre1" title="Chapter 4. Working with Variables, Mixins, and Functions" href="part0041_split_000.html#page">Chapter 4</a>, <em class="calibre9">Working with Variables, Mixins, and Functions</em>, could easily be applied when developing animation styles. We covered a few examples of CSS animation libraries before taking a look at how we could convert one of them to its Less equivalent.</p><p class="calibre7">Before continuing, we discussed the importance of monitoring vendor prefixes and how some see the use of vendor mixins as an antipractice that should be discouraged. We then discussed how performance can be impacted by some factors that are outside our control, before taking a look at how we can enable hardware acceleration to improve performance.</p><p class="calibre7">Phew! What a tour! However, it's not over yet: in the final chapter of this book, we'll take a look at how you can contribute to and help extend the Less library. After all, it wouldn't be where it is today without our help…!</p></div></body></html>