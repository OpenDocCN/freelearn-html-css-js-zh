<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch08"/>Chapter 8. Advanced PhoneGap</h1></div></div></div><p>
<em>Enter globalization and localization if you want your application to reach users of multiple countries and cultures. Your application should be able to support multiple languages/locales and this can be achieved by using the Globalization API and libraries related to localization. Think of support for multiple gestures if you want the application to be more advanced and user-friendly.</em>
</p><p>In this chapter, you will:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Learn how to use the Globalization API to support the locale of the mobile app user</li><li class="listitem" style="list-style-type: disc">Learn how to localize the application by showing the content in multiple languages based on the user's choice</li><li class="listitem" style="list-style-type: disc">Get an overview of the libraries providing gesture support</li><li class="listitem" style="list-style-type: disc">Learn how to implement multiple touch gestures to enhance the user experience</li><li class="listitem" style="list-style-type: disc">Learn how to remove the 300 ms delay introduced during click events</li></ul></div><div><div><div><div><h1 class="title"><a id="ch08lvl1sec72"/>Using the Globalization API</h1></div></div></div><p>In computing, globalization, internationalization, and localization are means of adapting computer software to<a id="id605" class="indexterm"/> different languages, regional differences, and the technical requirements of a target market. Let's see these in detail.</p><p>The term <strong>localization</strong> refers<a id="id606" class="indexterm"/> to all the activities needed before <a id="id607" class="indexterm"/>your app can be deployed in different languages and according to local cultural conventions. Before starting to localize an app, you have to <strong>internationalize</strong> your code<a id="id608" class="indexterm"/> by removing any language <a id="id609" class="indexterm"/>and cultural dependencies and design your code in order for it to be adapted to various languages without engineering changes. You can then localize your app, translate client-facing content and labels, and otherwise adapt it so that it works well in a particular locale.</p><p>The term <strong>locale</strong> refers<a id="id610" class="indexterm"/> to a collection of settings or preferences to be used in localization. A locale is often described<a id="id611" class="indexterm"/> as a language and country pair such as en-US, de-AT, it-IT, and so on.</p><p>The term <strong>globalization</strong> stands<a id="id612" class="indexterm"/> for the combination of internationalization and localization.</p><p>There are some odd-looking abbreviations in which a number is used to indicate the number of letters between the first and last letters used to refer to internationalization, localization, and<a id="id613" class="indexterm"/> globalization:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">i18n</code>: This stands for internationalization</li><li class="listitem" style="list-style-type: disc"><code class="literal">l10n</code>: This stands for localization</li><li class="listitem" style="list-style-type: disc"><code class="literal">g11n</code>: This stands for globalization</li></ul></div><div><div><h3 class="title"><a id="note38"/>Note</h3><p>Software internationalization is a huge topic because it covers plurals, dates, special characters, and so on. Discussing all of them is beyond the scope of this book. If you are interested in learning more about internationalization, take a look at the GNU<a id="id614" class="indexterm"/> project gettext (<a class="ulink" href="http://www.gnu.org/software/gettext/manual/">http://www.gnu.org/software/gettext/manual/</a>), the<a id="id615" class="indexterm"/> globalize project (<a class="ulink" href="https://github.com/jquery/globalize">https://github.com/jquery/globalize</a>), or the <a id="id616" class="indexterm"/>Jed project (<a class="ulink" href="http://slexaxton.github.io/Jed/">http://slexaxton.github.io/Jed/</a>).</p></div></div><p>PhoneGap offers great support for localization through the Globalization API that is accessible through the <code class="literal">globalization</code> object. You can install the plugin to your project as shown here:</p><div><pre class="programlisting">
<strong>$ cordova plugin add cordova-plugin-globalization</strong>
</pre></div><p>The <code class="literal">globalization</code> object is a child of the <code class="literal">navigator</code> object, and therefore has global scope. In order to access the <code class="literal">globalization</code> object, it's enough to type the following line of code:</p><div><pre class="programlisting">var globalization = navigator.globalization;</pre></div><p>The <code class="literal">globalization</code> object exposes several asynchronous methods that have a similar signature. In fact, usually most methods accept an argument, a success and a failure handler, and optionally an <code class="literal">options</code> object:</p><div><pre class="programlisting">globalization.methodName(argument, onSuccess, onError, options);</pre></div><p>Not all the methods accept an argument and the <code class="literal">options</code> object; some of them accept only a success and a failure handler. The failure handler receives a <code class="literal">GlobalizationError</code> object as an argument. There are two properties defined on this object: <code class="literal">message</code> and <code class="literal">code</code>. The first one contains a string describing the error details; the second one contains an integer equal to one of the following pseudo constants defined in the <code class="literal">GlobalizationError</code> object:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">GlobalizationError.UNKNOWN_ERROR</code> (return value <code class="literal">0</code>): This means a generic error occurred</li><li class="listitem" style="list-style-type: disc"><code class="literal">GlobalizationError.FORMATTING_ERROR</code> (return value <code class="literal">1</code>): This means an error occurred during a<a id="id617" class="indexterm"/> formatting operation</li><li class="listitem" style="list-style-type: disc"><code class="literal">GlobalizationError.PARSING_ERROR</code> (return value <code class="literal">2</code>): This means an error occurred during a parsing operation</li><li class="listitem" style="list-style-type: disc"><code class="literal">GlobalizationError.PATTERN_ERROR</code> (return value <code class="literal">3</code>): This means an error occurred while recovering a currency, date, or number pattern</li></ul></div><p>The Globalization API<a id="id618" class="indexterm"/> exposes the following methods defined in the <code class="literal">navigator.globalization</code> object:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">getPreferredLanguage</code>: This returns the string identifier for the device's current language; the string is stored in the <code class="literal">value</code> property of the object received as an argument in the<a id="id619" class="indexterm"/> success handler (for example, <code class="literal">{value: ‘English'}</code>)</li><li class="listitem" style="list-style-type: disc"><code class="literal">getLocaleName</code>: This returns<a id="id620" class="indexterm"/> the locale identifier according to the device's current language; the string is stored in the <code class="literal">value</code> property of the object<a id="id621" class="indexterm"/> received as an argument in the success handler (for example, <code class="literal">{value: ‘en'}</code>)</li><li class="listitem" style="list-style-type: disc"><code class="literal">dateToString</code>: This returns a date formatted as a string according to the client's locale and time zone; the<a id="id622" class="indexterm"/> method accepts a <code class="literal">Date</code> object as the first argument and an optional <code class="literal">options</code> object as the last argument:<div><pre class="programlisting">var globalization = navigator.globalization;

var today = new Date();
globalization.dateToString(today, onSuccess, onError);</pre></div><p>The returned result is stored in the <code class="literal">value</code> property of the object received as an argument in the success handler (for example, <code class="literal">{value: ‘06/14/2013 12:49 PM'}</code>).</p></li><li class="listitem" style="list-style-type: disc"><code class="literal">stringToDate</code>: This parses a <a id="id623" class="indexterm"/>date formatted as a string, and depending on the device's preferences and calendar, returns the corresponding <code class="literal">Date</code> object as an argument in the success handler.</li><li class="listitem" style="list-style-type: disc"><code class="literal">getDatePattern</code>: This returns an object received as an argument in the success handler containing the<a id="id624" class="indexterm"/> following:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">A pattern string to format and parse dates according to the device's preferences</li><li class="listitem" style="list-style-type: disc">The time zone of the device</li><li class="listitem" style="list-style-type: disc">The difference in seconds between the device's time zone and the universal time and the offset in seconds between the device's non-daylight saving time zone</li><li class="listitem" style="list-style-type: disc">The client's daylight saving time zone (for example, <code class="literal">{pattern: ‘dd/MM/yyyy HH:mm', timezone: ‘CEST', utc_offset: 3600, dst_offset: 3600}</code>)</li></ul></div><p>This method accepts an optional <code class="literal">options</code> object through which it's possible to specify the format length (that is, <code class="literal">short</code>, <code class="literal">medium</code>, <code class="literal">long</code>, or <code class="literal">full</code>) and the data to be returned (that is, <code class="literal">date</code>, <code class="literal">time</code>, or <code class="literal">date and time</code>)</p></li><li class="listitem" style="list-style-type: disc"><code class="literal">getDateNames</code>: This returns <a id="id625" class="indexterm"/>an array of names of the months or days of the week, depending on the device's settings; the array is stored in<a id="id626" class="indexterm"/> the <code class="literal">value</code> property of the object received as an argument in the success handler (that is, <code class="literal">{value: Array[12]}</code>)</li><li class="listitem" style="list-style-type: disc"><code class="literal">isDayLightSavingsTime</code>: This returns a Boolean stating whether daylight saving time is in effect for a given <code class="literal">Date</code> object passed as the first argument using the device's time zone and <a id="id627" class="indexterm"/>calendar; the value is stored in the <code class="literal">dst</code> property of the object received as an argument in the success handler (for example, <code class="literal">{dst: true}</code>)</li><li class="listitem" style="list-style-type: disc"><code class="literal">getFirstDayOfWeek</code>: This returns the first day of the week as a number, depending on the device's user preferences and calendar, assuming that the days of the week are numbered <a id="id628" class="indexterm"/>starting from <code class="literal">1</code> (= Sunday); the string is stored in the <code class="literal">value</code> property of the object received as an argument in the success handler (for example, <code class="literal">{value: 1}</code>)</li><li class="listitem" style="list-style-type: disc"><code class="literal">numberToString</code>: This returns the number passed as the first argument formatted as a string <a id="id629" class="indexterm"/>according to the client's locale and preferences; the number is stored in the <code class="literal">value</code> property of the object received as an argument in the success handler (for example, <code class="literal">{value: ‘12,456,246'}</code>)</li><li class="listitem" style="list-style-type: disc"><code class="literal">stringToNumber</code>: This returns the string passed as the first argument formatted as a number according<a id="id630" class="indexterm"/> to the client's locale and preferences; the number is stored in the <code class="literal">value</code> property of the object received as an argument in the success handler (for example, <code class="literal">{value: 1250.04}</code>)</li><li class="listitem" style="list-style-type: disc"><code class="literal">getNumberPattern</code>: This returns<a id="id631" class="indexterm"/> an object received as an argument in the success handler containing the following:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">A pattern string to format and parse numbers according to the device's preferences</li><li class="listitem" style="list-style-type: disc">The number of fractional digits to use when parsing and formatting numbers, the rounding increment to use when parsing and formatting, and so on (for example, <code class="literal">{decimal: ‘.', fraction: 0, grouping: ‘,', negative: ‘-', pattern: ‘#,##0.###', positive: ‘', rounding: 0, symbol: ‘.'}</code>)</li></ul></div></li><li class="listitem" style="list-style-type: disc"><code class="literal">getCurrencyPattern</code>: This returns an object received as an argument in the success handler containing a pattern string to format and parse currencies according to the currency code<a id="id632" class="indexterm"/> passed as the first argument, the device's preferences, the number of fractional digits to use when parsing and formatting numbers, the rounding increment to use when parsing and formatting, the ISO 4217 currency code for the pattern, and so on (for example, <code class="literal">{code: ‘EUR', decimal: ‘.', fraction: 2, grouping: ‘,', pattern: ‘$#,##0.00;(¤#,##0.00)', rounding: 0}</code>)<div><div><h3 class="title"><a id="tip14"/>Tip</h3><p>Both the <code class="literal">numberToString</code> and <code class="literal">stringToNumber</code> methods accept an optional <code class="literal">options</code> object; through the <code class="literal">type</code> property of this object, you can specify the format of the number (for example, <code class="literal">decimal</code>, <code class="literal">percent</code>, or <code class="literal">currency</code>).</p></div></div></li></ul></div><p>Through the combination of the data provided by the methods of the <code class="literal">globalization</code> object, it's possible to handle very complex scenarios and provide a highly localized app to the end user. The<a id="id633" class="indexterm"/> Globalization API is a very powerful tool that allows you to work in conjunction with other JavaScript libraries.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec73"/>Localizing your app</h1></div></div></div><p>From a development perspective, the common practice is to place the text in resource strings that are loaded at the<a id="id634" class="indexterm"/> execution time depending on the user settings. There are several techniques you can use<a id="id635" class="indexterm"/> to globalize your app such as storing the translations in <strong>portable object</strong> (<strong>PO</strong>) files, creating a JSON object containing all of them, or loading the localization files dynamically when the app starts. The goal is to deploy an app that is able to select the relevant language resource file at runtime<a id="id636" class="indexterm"/> and to handle culture-aware number and date parsing and formatting, plurals, currencies, special characters, validation, and so on.</p><p>In the following example, we will learn how to load different language strings in the application using a simple JavaScript library.</p></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec74"/>Time for action – rendering localized messages</h1></div></div></div><p>Refer to the following<a id="id637" class="indexterm"/> steps to render different messages in your app according to the device's language settings:</p><div><ol class="orderedlist arabic"><li class="listitem">Open the command-line tool and create a new PhoneGap project called <code class="literal">Globalization</code>:<div><pre class="programlisting">
<strong>$ cordova create Globalization</strong>
</pre></div></li><li class="listitem">Add the Globalization API plugin using the following command:<div><pre class="programlisting">
<strong>$ cordova plugin add cordova-plugin-globalization</strong>
</pre></div></li><li class="listitem">Using the command-line tool, add the platform you want to use for this test (Android, Blackberry, iOS, or Windows Phone 8):<div><pre class="programlisting">
<strong>$ cordova platforms add android</strong>
</pre></div></li><li class="listitem">Download and <a id="id638" class="indexterm"/>save the <code class="literal">l10n.js</code> file available at <a class="ulink" href="https://github.com/marcelklehr/html10n.js">https://github.com/marcelklehr/html10n.js</a> in the <code class="literal">www/js</code> folder.</li><li class="listitem">Go to the <code class="literal">www</code> folder and create the JSON file named <code class="literal">langs.json</code> to store all the required language strings as shown here. A JSON file format is a simple <a id="id639" class="indexterm"/>way of storing data like XML. The file will have the same literals repeated for each language:<div><pre class="programlisting">{
  “en”: {
    “welcome”: “Welcome”,
    “english”: “English”,
    “french”: “French”,
    “alert”: “It's me!”
  },
  “fr”: {
    “welcome”: “Bienvenu”,
    “english”: “Anglais”,
    “french”: “Français”,
    “alert”: “C'est moi!”
  }
}</pre></div></li><li class="listitem">In the <code class="literal">www</code> directory, edit the <code class="literal">index.html</code> file and add the following code line in the <code class="literal">head</code> section to load the JavaScript file to work with multiple languages:<div><pre class="programlisting">&lt;script type=”text/javascript” src=”js/l10n.js”&gt;&lt;/script&gt;</pre></div></li><li class="listitem">Load the <code class="literal">langs.json</code> file with the appropriate type as shown here:<div><pre class="programlisting">&lt;link rel=”localizations” href=”langs.json” type=“application/l10n+json”/&gt;</pre></div></li><li class="listitem">Define the <code class="literal">onload</code> function for the <code class="literal">body</code> tag to load the document initially with correct language values:<div><pre class="programlisting">&lt;body onload=”onLoad();”&gt;</pre></div></li><li class="listitem">Create some HTML elements to try working with multiple languages. For this example, we will create two buttons, an alert box, and a heading tag. When the language is changed, all the string values will be changed too:<div><pre class="programlisting">&lt;h1 data-l10n-id=”welcome”&gt;Welcome&lt;/h1&gt;
&lt;button data-l10n-id=”french” onclick=”changeToFrench()”&gt;French&lt;/button&gt;
&lt;button data-l10n-id=”english” onclick=”changeToEnglish()”&gt;English&lt;/button&gt;
&lt;button data-l10n-id=”alert” onclick=”showAlert()”&gt;Test Alert&lt;/button&gt;</pre></div></li><li class="listitem">Create a<a id="id640" class="indexterm"/> function to be used to initialize the language settings. The <code class="literal">localize</code> method is used to load the application with the provided language. Initially, we load the page with the English language using the <code class="literal">index</code> method:<div><pre class="programlisting">function onLoad() {
  html10n.index();
  html10n.localize(‘en');
}</pre></div></li><li class="listitem">Create two functions to load the English and French languages when users click on the button:<div><pre class="programlisting">function changeToFrench() {
  html10n.localize(‘fr');
}

function changeToEnglish() {
  html10n.localize(‘en');
}</pre></div></li><li class="listitem">Define the function to show an alert window with the translated string when the <strong>Test Alert</strong> button is clicked:<div><pre class="programlisting">function showAlert() {
  var message = html10n.get(‘alert');
  alert(message);
}</pre></div></li><li class="listitem">Apart from these, you can define your <code class="literal">deviceready</code> event function for other PhoneGap/Cordova-related activities. For this example, it's left empty:<div><pre class="programlisting">document.addEventListener(“deviceready”, onDeviceReady, false);

function onDeviceReady() {
  // Other Stuffs
}</pre></div></li><li class="listitem">Open the command-line tool, go to the <code class="literal">Globalization</code> folder, and build and run the app on a real device or an emulator:<div><pre class="programlisting">
<strong>$ cordova build</strong>
<strong>$ cordova run</strong>
</pre></div></li></ol></div><p>The complete source code<a id="id641" class="indexterm"/> of the example is provided here for your reference:</p><div><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;script type=”text/javascript” src=”js/l10n.js”&gt;&lt;/script&gt;
  &lt;link rel=”localizations” href=”langs.json” type=”application/l10n+json”/&gt;
&lt;/head&gt;
&lt;body onload=”onLoad();”&gt;
  &lt;h1 data-l10n-id=”welcome”&gt;Welcome&lt;/h1&gt;
  &lt;button data-l10n-id=”french” onclick=”changeToFrench()”&gt;French&lt;/button&gt;
  &lt;button data-l10n-id=”english” onclick=”changeToEnglish()”&gt;English&lt;/button&gt;
  &lt;button data-l10n-id=”alert” onclick=”showAlert()”&gt;Test Alert&lt;/button&gt;

  &lt;script type=”text/javascript”&gt;
    document.addEventListener(“deviceready”, onDeviceReady, false);

    function onDeviceReady() {
      // Other Stuffs
    }

    function onLoad() {
      html10n.index();
      html10n.localize(‘en');
    }

    function changeToFrench() {
      html10n.localize(‘fr');
    }

    function changeToEnglish() {
      html10n.localize(‘en');
    }

    function showAlert() {
      var message = html10n.get(‘alert');
      alert(message);
    }

  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><div><div><div><div><h2 class="title"><a id="ch08lvl2sec72"/>
<em>What just happened?</em>
</h2></div></div></div><p>You developed an app that is able to render different text messages based on the language required by the user. When the user clicks on the <strong>French</strong>/<strong>English</strong> button, all other texts in the application will <a id="id642" class="indexterm"/>change automatically.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec75"/>Adding multitouch gesture support</h1></div></div></div><p>For any hybrid mobile apps, touch gestures is an important feature that makes the app great in the hands of the users.</p><p>The following<a id="id643" class="indexterm"/> is the list of JavaScript libraries that can enable multitouch gesture handling in your apps. Each library has its own merits and limitations. Some have dependencies with other libraries and some do not. You have to be careful when choosing the libraries as it might introduce new dependencies to your application:</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Library name</p>
</th><th style="text-align: left" valign="bottom">
<p>Dependency</p>
</th><th style="text-align: left" valign="bottom">
<p>URL</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>ZeptoJS</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>
<a class="ulink" href="http://zeptojs.com/">http://zeptojs.com/</a>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>EventJS</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>
<a class="ulink" href="https://github.com/mudcube/Event.js">https://github.com/mudcube/Event.js</a>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>QuoJS</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>
<a class="ulink" href="http://quojs.tapquo.com/">http://quojs.tapquo.com/</a>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Hammer</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>
<a class="ulink" href="http://hammerjs.github.io/">http://hammerjs.github.io/</a>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>ThumbsJS</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>
<a class="ulink" href="http://mwbrooks.github.io/thumbs.js/">http://mwbrooks.github.io/thumbs.js/</a>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>jGestures</p>
</td><td style="text-align: left" valign="top">
<p>jQuery</p>
</td><td style="text-align: left" valign="top">
<p>
<a class="ulink" href="http://jgestures.codeplex.com/">http://jgestures.codeplex.com/</a>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>DoubleTab</p>
</td><td style="text-align: left" valign="top">
<p>jQuery</p>
</td><td style="text-align: left" valign="top">
<p>
<a class="ulink" href="https://github.com/technoweenie/jquery.doubletap">https://github.com/technoweenie/jquery.doubletap</a>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Touchable</p>
</td><td style="text-align: left" valign="top">
<p>jQuery</p>
</td><td style="text-align: left" valign="top">
<p>
<a class="ulink" href="https://github.com/dotmaster/Touchable-jQuery-Plugin">https://github.com/dotmaster/Touchable-jQuery-Plugin</a>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>TouchyJS</p>
</td><td style="text-align: left" valign="top">
<p>jQuery</p>
</td><td style="text-align: left" valign="top">
<p>
<a class="ulink" href="https://github.com/HotStudio/touchy">https://github.com/HotStudio/touchy</a>
</p>
</td></tr></tbody></table></div><p>Although there are a few more libraries, Hammer is widely trusted for gestures support in mobile applications. Hammer is an open source library that can recognize gestures<a id="id644" class="indexterm"/> made by touch, mouse, and pointerEvents. It doesn't have any dependencies and the total minified size is less than 4 KB.</p><p>We will illustrate an example using Hammer to implement touch events in the application.</p></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec76"/>Time for action – implementing gesture support</h1></div></div></div><p>Refer to the following steps to implement multitouch gestures in your app using the Hammer JavaScript library:</p><div><ol class="orderedlist arabic"><li class="listitem">Open the command-line tool and create a new PhoneGap project called <code class="literal">hammer</code>:<div><pre class="programlisting">
<strong>$ cordova create hammer</strong>
</pre></div></li><li class="listitem">Using the command-line tool, add the platform you want to use for this test (Android, Blackberry, iOS, or Windows Phone 8):<div><pre class="programlisting">
<strong>$ cordova platform add android</strong>
</pre></div></li><li class="listitem">Download the<a id="id645" class="indexterm"/> Hammer-related files<a id="id646" class="indexterm"/> from <a class="ulink" href="https://github.com/hammerjs/hammer.js">https://github.com/hammerjs/hammer.js</a> and save it in the <code class="literal">www/js</code> folder. You can find both <code class="literal">hammer.min.js</code> and <code class="literal">hammer.js</code> files in the download bundle from GitHub. You can just keep the <code class="literal">hammer.min.js</code> file and delete the rest.</li><li class="listitem">Include the <code class="literal">hammer.min.js</code> file in your <code class="literal">index.html</code> file to start using Hammer:<div><pre class="programlisting">&lt;script src=”js/hammer.min.js”&gt;&lt;/script&gt;</pre></div></li><li class="listitem">Add a <code class="literal">div</code> element named <code class="literal">touch</code> to the page body. This element will be attached to all the touch events we are going to create:<div><pre class="programlisting">&lt;div id=”touch”&gt;Try Me&lt;/div&gt;</pre></div></li><li class="listitem">Now, let's create the event listeners for the “press” gesture and attach it to the <code class="literal">div</code> element we just created:<div><pre class="programlisting">&lt;script type=”text/javascript”&gt;
  var touchId = document.getElementById(‘touch');

  var hammer = new Hammer(touchId);

  hammer.on(“press”, function(ev) {
    touchId.textContent = ev.type +” gesture detected.”;
  });

&lt;/script”&gt;</pre></div></li><li class="listitem">Open the command-line tool, go to the project folder, and build and run the app on a real device or an emulator:<div><pre class="programlisting">
<strong>$ cordova build</strong>
<strong>$ cordova run</strong>
</pre></div></li></ol></div><p>When you try to apply a “press” action on the element, you will see that Hammer has detected your action and changed the text content of the element.</p><div><div><h3 class="title"><a id="note39"/>Note</h3><p>Note that the Hammer library is very flexible for the developers. You can handle multiple gestures in a single event handler. In the following example, we have handled pan, swipe, drag, and touch gestures in a single function. However, overusing them can damage your application performance:</p><div><pre class="programlisting">&lt;script type=”text/javascript”&gt;
  var touchId = document.getElementById(myDiv);

  var hammer = new Hammer(touchId);

  //list of events to be handled
  hammer.on(“pan swipe drag touch press”, function(ev) {
    touchId.textContent = ev.type +” gesture detected.”;
  });
&lt;/script”&gt;</pre></div></div></div><p>The pinch and rotate recognizers are disabled by default because they might interfere with the application's behavior. However, if you want to handle these two gestures in your application, you can<a id="id647" class="indexterm"/> enable them by calling them as follows:</p><div><pre class="programlisting">hammertime.get(‘pinch').set({ enable: true });
hammertime.get(‘rotate').set({ enable: true });</pre></div><p>You can also enable vertical or all directions for the pan and swipe recognizers as shown here:</p><div><pre class="programlisting">hammertime.get(‘pan').set({ direction: Hammer.DIRECTION_ALL });
hammertime.get(‘swipe').set({ direction: Hammer.DIRECTION_VERTICAL });</pre></div><div><div><h3 class="title"><a id="note40"/>Note</h3><p>For more details on all gesture<a id="id648" class="indexterm"/> recognizers and customization options, refer to <a class="ulink" href="http://hammerjs.github.io/getting-started/">http://hammerjs.github.io/getting-started/</a>. Reading this documentation will help you to use Hammer with maximum efficiency.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec77"/>Handling click delays</h1></div></div></div><p>We have seen that a mobile application can support various touch gestures. With the introduction of new<a id="id649" class="indexterm"/> technologies, differences between web apps and native mobile apps are getting close to zero, but not actually zero. One such difference is how click events are handled in mobile apps.</p><p>When you click on a button, mobile browsers wait for 300 ms to actually trigger the click event for the button that you have clicked. The actual reason is that the mobile browser waits to see whether the user wants to perform a click or a double click. After the 300 ms delay, if there is no other tap, it's considered as a single click. However, if there are no event handlers for double clicks, the delay will be unnecessary. By overcoming these delays, you can make<a id="id650" class="indexterm"/> your app more responsible and less laggy.</p><p>We are going to see an approach to<a id="id651" class="indexterm"/> avoid this 300 ms delay using the library called <strong>FastClick</strong> that is available <a id="id652" class="indexterm"/>at <a class="ulink" href="https://github.com/ftlabs/fastclick">https://github.com/ftlabs/fastclick</a>. The steps are as follows:</p><div><ol class="orderedlist arabic"><li class="listitem">Include <code class="literal">fastclick.js</code> in your JavaScript pack or add it to your HTML page as shown here:<div><pre class="programlisting">&lt;script type='application/javascript' src=‘/path/to/fastclick.js'&gt;&lt;/script&gt;</pre></div></li><li class="listitem">Define the <code class="literal">deviceready</code> event listener as you regularly do for other PhoneGap/Cordova functionalities:<div><pre class="programlisting">function onBodyLoad(){

  document.addEventListener(“deviceready”, onDeviceReady, false);

}</pre></div></li><li class="listitem">Now, attach the FastClick functionality as shown here:<div><pre class="programlisting">function onDeviceReady()
{
  FastClick.attach(document.body);
}</pre></div></li></ol></div><p>In some cases, you might need FastClick to ignore a few elements where double-click is possible. In those cases, you can add the <code class="literal">needsclick</code> class to the element as shown here:</p><div><pre class="programlisting">&lt;a class=”needsclick”&gt;Ignored by FastClick&lt;/a&gt;</pre></div><div><div><h3 class="title"><a id="note41"/>Note</h3><p>For some more advanced discussions related to this topic, refer to FastClick's GitHub page. If you are<a id="id653" class="indexterm"/> looking at an alternative approach suggested by Google, take a look at <a class="ulink" href="https://developers.google.com/mobile/articles/fast_buttons">https://developers.google.com/mobile/articles/fast_buttons</a>.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch08lvl1sec78"/>Summary</h1></div></div></div><p>In this chapter, you learned how to create an app that supports the locale of the user using PhoneGap's Globalization API and to create a localized app that supports multiple user languages. More importantly, we saw how we can better handle multitouch gestures in the application.</p><p>In the next chapter, we will cover the topics that will help you in making the application ready for public release.</p></div></body></html>