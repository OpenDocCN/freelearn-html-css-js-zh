<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch04"/>Chapter 4. Visualforce Custom Components</h1></div></div></div><p>Salesforce has a large collection of standard Visualforce components such as <code class="literal">&lt;apex:detail&gt;</code>, <code class="literal">&lt;apex:pageBlock&gt;</code>, <code class="literal">&lt;apex:pageBlockTable&gt;</code>, and<code class="literal"> &lt;apex:relatedList&gt;</code>. They are ready to be used in Visualforce pages, and the Force.com platform allows us to build our own Visualforce components which can be used in Visualforce pages.</p><p>This chapter serves as an overview of Visualforce custom components and further explains how to create a custom component. This chapter covers the following topics:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Understanding Visualforce custom components</li><li class="listitem" style="list-style-type: disc">How to create and use a custom component in a Visualforce page</li><li class="listitem" style="list-style-type: disc">Custom attributes and custom controllers</li></ul></div><p>Let's build our own Visualforce custom components.</p><div><div><div><div><h1 class="title"><a id="ch04lvl1sec28"/>Understanding Visualforce custom components</h1></div></div></div><p>There are lots of standard <a id="id169" class="indexterm"/>Visualforce components (such as <code class="literal">&lt;apex:detail&gt;</code>, <code class="literal">&lt;apex:pageBlock&gt;</code>, <code class="literal">&lt;apex:pageBlockTable&gt;</code>, and<code class="literal"> &lt;apex:relatedList&gt;</code>) which<a id="id170" class="indexterm"/> can be reused in Visualforce pages. A <a id="id171" class="indexterm"/>standard Visualforce component is a pre-built,<a id="id172" class="indexterm"/> encapsulated code segment. These standard <a id="id173" class="indexterm"/>Visualforce components are built according<a id="id174" class="indexterm"/> to common usage.</p><p>The Force.com platform allows us to develop custom Visualforce components that can be reused within a particular application. Custom components can be developed using both Apex<a id="id175" class="indexterm"/> and<a id="id176" class="indexterm"/> Visualforce. For example, suppose we want to create a customer summary with recent orders and we need to use this functionality in different locations in our order processing app. We also need to specify the number of recent orders. According to the specified number, the number of recent orders displayed in the customer's summary will be changed. The use of Visualforce custom components becomes the best choice for implementing such a specific requirement.</p><p>A Visualforce <a id="id177" class="indexterm"/>custom component can have zero or more attributes to<a id="id178" class="indexterm"/> pass as parameters into the component. A custom component with attributes is like a parameterized Apex method. We can change the value of an attribute during the final usage level (in a Visualforce page).</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch04lvl1sec29"/>Creating and using a custom component</h1></div></div></div><p>We can create a <a id="id179" class="indexterm"/>Visualforce component to use in a Visualforce<a id="id180" class="indexterm"/> page. Navigate to the following path to create a new Visualforce component:</p><p>
<strong>Your Name</strong> | <strong>Setup</strong> | <strong>Develop</strong> | <strong>Components</strong> | <strong>New</strong>
</p><div><img src="img/9818_04_01.jpg" alt="Creating and using a custom component"/><div><p>Create new Visualforce components</p></div></div><p>We need to specify the following properties while creating a custom component:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Label</strong>: This custom component will be identified in the setup tools by using the label.</li><li class="listitem" style="list-style-type: disc"><strong>Name</strong>: This custom component will be identified in Visualforce markup by using <code class="literal">name</code>. This must be unique within the organization.</li><li class="listitem" style="list-style-type: disc"><strong>Description</strong>: This gives the description of the custom component.</li><li class="listitem" style="list-style-type: disc"><strong>Body</strong>: The <a id="id181" class="indexterm"/>Visualforce markup must be<a id="id182" class="indexterm"/> placed within the body section.<div><img src="img/9818_04_02.jpg" alt="Creating and using a custom component"/></div></li></ul></div><div><div><h3 class="title"><a id="note02"/>Note</h3><p>The name of the custom component should begin with a letter, and it should not end with an underscore. Further, spaces or two consecutive underscores should not be included in the name.</p><p>The maximum amount of data that a custom component can contain is 1 MB, or approximately 1,000,000 characters.</p><p>We can specify the version of Visualforce and the API used with the particular component by using the version setting.</p></div></div><p>The body of a custom component can be defined as follows:</p><div><pre class="programlisting">&lt;apex:component 
  &lt;!—Desire markup here--&gt;
&lt;/apex:component&gt;</pre></div><div><div><h3 class="title"><a id="tip22"/>Tip</h3><p>The component markup is same as other Visualforce pages. It can be a combination of Visualforce and HTML tags. We can also add customized CSS and JavaScript.</p></div></div><p>All the<a id="id183" class="indexterm"/> markup should be defined within the <code class="literal">&lt;apex:component&gt;</code> tag. Our custom <a id="id184" class="indexterm"/>component example is a customer's summary with recent orders. Suppose our custom component name is <code class="literal">customerSummary</code>, we can use this component in multiple Visualforce pages. The usage is as follows:</p><div><pre class="programlisting">&lt;apex:page&gt;
  &lt;c: customerSummary /&gt;
&lt;/apex:page&gt;</pre></div></div>
<div><div><div><div><h1 class="title"><a id="ch04lvl1sec30"/>Custom attributes and custom controllers</h1></div></div></div><p>When we are<a id="id185" class="indexterm"/> creating complex custom components, we <a id="id186" class="indexterm"/>need to use some other features to build custom <a id="id187" class="indexterm"/>components. Mainly, we have to use custom <a id="id188" class="indexterm"/>attributes and custom controllers for custom components. The attributes can be defined in <code class="literal">&lt;apex:component&gt;</code> for passing values from the Visualforce page (the page that used the component) to the custom component or to the component's controller.</p><p>We have implemented the example explained from the beginning of this chapter. The following is the component markup and it contains the attribute's and the component's definitions. We have two attributes to be passed, which are customer ID and the number of recent orders that we want to show in the page. These two parameters are used to pass the values to the component's controller:</p><div><pre class="programlisting">&lt;apex:component controller="CustomerSummaryComponenetController"&gt;
    &lt;!-- Attribute Definitions --&gt;
    &lt;apex:attribute name="customerId" Type="String" required="true" description="customer id" assignTo="{!CusID}"/&gt;
    &lt;apex:attribute name="noOfRecentOrders" Type="Integer" required="true" description="Number of recent orders" assignTo="{!RecentNo}"/&gt;
    &lt;!-- Attribute Definitions : End --&gt;
    &lt;!-- Component Definition --&gt;
    &lt;apex:componentBody &gt;
        &lt;apex:pageBlock &gt;
            &lt;apex:pageBlockSection title="Customer Details"&gt;
                &lt;apex:outputField value="{!CurrentCustomer.Name}"/&gt;
                &lt;apex:outputField value="{!CurrentCustomer.Address__c}"/&gt;
                &lt;apex:outputField value="{!CurrentCustomer.Email__c}"/&gt;
            &lt;/apex:pageBlockSection&gt; 
            
            &lt;apex:pageBlockSection title="Recent Order Details"&gt;
                &lt;apex:pageBlockTable value="{!RecentOrderList}" var="order"&gt;
                    &lt;apex:column value="{!order.Name}"/&gt;
                    &lt;apex:column value="{!order.Planned_Delivery_Date__c}"/&gt;
                    &lt;apex:column value="{!order.Status__c}"/&gt;
                &lt;/apex:pageBlockTable&gt;
            &lt;/apex:pageBlockSection&gt;    
        &lt;/apex:pageBlock&gt;
    &lt;/apex:componentBody&gt;
    &lt;!-- Component Definition : End --&gt;

&lt;/apex:component&gt;</pre></div><p>The following <a id="id189" class="indexterm"/>code snippet shows the custom controller that is <a id="id190" class="indexterm"/>associated with the <code class="literal">cutomerSummary</code> <a id="id191" class="indexterm"/>custom component. This controller is used to <a id="id192" class="indexterm"/>manipulate the attribute's values. In this example, we have queried the customer record and the recent order details of the particular customer. The query results of <code class="literal">CurrentCustomer</code> and <code class="literal">RecentOrderList</code> depend on the <code class="literal">CusID</code> and <code class="literal">RecentNo</code> values:</p><div><pre class="programlisting">public class CustomerSummaryComponenetController{
    public String CusID{get;set;}
    public Integer RecentNo{get;set;}
    public Customer__c CurrentCustomer{
        get{
            CurrentCustomer = new Customer__c();
            CurrentCustomer = [SELECT Id, Name, Address__c, Email__c, Telephone__c FROM Customer__c WHERE Id =: CusID];
            return CurrentCustomer;
        }
        set;
    }      
    public List&lt;Order__c&gt; RecentOrderList{
        get{
            RecentOrderList = new List&lt;Order__c&gt;();
            RecentOrderList = [SELECT Id, Name, Customer__c, Delivered__c, Planned_Delivery_Date__c, Status__c FROM Order__c WHERE Customer__c =: CusID ORDER BY CreatedDate DESC LIMIT :RecentNo];
            return RecentOrderList;
        }
        set;        
    }
}</pre></div><p>This is the way of <a id="id193" class="indexterm"/>using our custom component. Here, we have passed the<a id="id194" class="indexterm"/> customer <a id="id195" class="indexterm"/>ID and the number of recent orders<a id="id196" class="indexterm"/> values that we want to see:</p><div><pre class="programlisting">&lt;apex:page StandardController="Customer__c"&gt;
  &lt;c:CustomerSummary customerId="{!Customer__c.Id}" noOfRecentOrders="3"&gt;&lt;/c:CustomerSummary&gt;
&lt;/apex:page&gt;</pre></div><p>The following screenshot shows the result of the <code class="literal">customerSummary</code> custom component:</p><div><img src="img/9818_04_03.jpg" alt="Custom attributes and custom controllers"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch04lvl1sec31"/>Summary</h1></div></div></div><p>In this chapter, we saw an overview of Visualforce custom components. We now have the knowledge to create and use Visualforce custom components. With the usage of Visualforce custom components, we learned the mechanisms for reusing code in Visualforce. We have seen how to build more customizable custom components by using custom attributes and custom controllers.</p></div></body></html>