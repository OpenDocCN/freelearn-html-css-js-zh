<html><head></head><body>
  <div><h1 class="chapter-number" id="_idParaDest-20">
    <a id="_idTextAnchor019">
    </a>
    
     1
    
   </h1>
   <h1 id="_idParaDest-21">
    <a id="_idTextAnchor020">
    </a>
    
     Introducing Node.js 22
    
   </h1>
   <p>
    
     Created in 2009, Node.js is a cross-platform, open source JavaScript runtime that allows you to execute JavaScript outside of the browser.
    
    
     Node.js wraps Google Chrome’s JavaScript engine, V8, to enable JavaScript to be run outside the browser.
    
    
     Node.js brings JavaScript to the server, which enables us to interact with the operating system, network, and filesystem with JavaScript.
    
    
     Node.js was built following an event loop architecture, which enables it to effectively handle input/output and
    
    
     
      concurrent operations.
     
    
   </p>
   <p>
    
     Today, Node.js is a popular technology choice for building many types of applications, including HTTP web servers, microservices, real-time applications, and more.
    
    
     Part of Node.js’s success is that it enables full-stack development in a common
    
    
     
      language, JavaScript.
     
    
   </p>
   <p>
    
     The massive ecosystem of modules has supported Node.js’s success.
    
    
     There are over 3 million modules available on the
    
    <strong class="source-inline">
     
      npm
     
    </strong>
    
     registry, with many abstracting lower-level implementation details to higher-level and more easily consumable APIs.
    
    
     Building your applications atop
    
    <strong class="source-inline">
     
      npm
     
    </strong>
    
     modules can speed up the development process while promoting code sharing
    
    
     
      and reuse.
     
    
   </p>
   <p>
    
     Node.js is now over a decade old and has matured as a technology.
    
    
     Today, it is a common technology choice for building applications of all sizes.
    
    
     Many large enterprises use Node.js in production.
    
    
     Due to the widespread usage and dependence on Node.js, it was moved under the OpenJS Foundation (formerly the Node.js Foundation).
    
    
     The OpenJS Foundation offers a neutral environment for JavaScript projects, emphasizing a robust commitment to open governance.
    
    
     Open governance facilitates transparency and accountability, which, in turn, helps to ensure that no single person or company has too much control over
    
    
     
      the project.
     
    
   </p>
   <p>
    
     This chapter introduces Node.js – including instructions on how to install the runtime and access the
    
    
     
      necessary documentation.
     
    
   </p>
   <p>
    
     This chapter will cover the
    
    
     
      following recipes:
     
    
   </p>
   <ul>
    <li>
     
      Installing Node.js 22
     
     
      
       with
      
     
     
      <strong class="source-inline">
       
        nvm
       
      </strong>
     
    </li>
    <li>
     
      Accessing the Node.js
     
     
      
       API documentation
      
     
    </li>
    <li>
     
      Adopting new JavaScript syntax in
     
     
      
       Node.js 22
      
     
    </li>
    <li>
     
      Introducing the Node.js
     
     
      
       event loop
      
     
    </li>
   </ul>
   <h1 id="_idParaDest-22">
    <a id="_idTextAnchor021">
    </a>
    
     Technical requirements
    
   </h1>
   <p>
    
     This chapter will require access to a terminal, a browser of your choice, and
    
    
     
      the internet.
     
    
   </p>
   <h1 id="_idParaDest-23">
    <a id="_idTextAnchor022">
    </a>
    
     Installing Node.js 22 with nvm
    
   </h1>
   <p>
    
     Node.js follows a
    
    <a id="_idIndexMarker000">
    </a>
    
     release
    
    <a id="_idIndexMarker001">
    </a>
    
     schedule and
    
    <a id="_idIndexMarker002">
    </a>
    
     adopts a
    
    <strong class="bold">
     
      long-term support
     
    </strong>
    
     (
    
    <strong class="bold">
     
      LTS
     
    </strong>
    
     ) policy.
    
    
     The release
    
    <a id="_idIndexMarker003">
    </a>
    
     schedule is based on the
    
    <strong class="bold">
     
      Semantic Versioning
     
    </strong>
    
     (
    
    <a href="https://semver.org/">
     
      
       https://semver.org/
      
     
    </a>
    
     
      ) specification.
     
    
   </p>
   <p>
    
     According to the Node.js release policy, Node.js undergoes two major updates annually, scheduled for April and October.
    
    
     These major releases may introduce alterations to the API that could potentially break compatibility.
    
    
     However, the Node.js project strives to keep the number and severity of such disruptive changes to a minimum, aiming to lessen any inconvenience for
    
    
     
      end users.
     
    
   </p>
   <p>
    
     Even-numbered major releases of Node.js are promoted to LTS after 6 months.
    
    
     Even-numbered releases are always scheduled for release in April and promoted to LTS in October.
    
    
     LTS releases are supported for up to 30 months.
    
    
     It is recommended to use LTS versions of Node.js in production.
    
    
     The purpose of the LTS schedule is to provide stability to end users and also to provide a predictable timeline of releases so that users can manage their upgrades appropriately.
    
    
     All LTS versions of Node.js are given codenames, named after elements.
    
    
     Node.js 22 will have the LTS
    
    
     
      codename “Jod”.
     
    
   </p>
   <p>
    
     Odd-numbered major releases are released in October and are only supported for 6 months.
    
    
     Odd-numbered releases are mostly recommended to be used to try out new features and test the migration path but are not generally recommended for use in
    
    
     
      production applications.
     
    
   </p>
   <p>
    
     The Node.js Release Working Group has authority over the Node.js release schedule and processes.
    
    
     The Node.js release schedule and policy documentation can be found
    
    
     
      at
     
    
    <a href="https://github.com/nodejs/release">
     
      
       https://github.com/nodejs/release
      
     
    </a>
    
     
      .
     
    
   </p>
   <p>
    
     In this book, we will be using Node.js 22 throughout.
    
    
     Node.js 22 was released in April 2024.
    
    
     Node.js 22 was promoted to LTS in October 2024 and is planned to be supported until April 2027.
    
    
     This recipe will cover how to install Node.js 22 using
    
    <strong class="bold">
     
      node version manager
     
    </strong>
    
     (
    
    <strong class="bold">
     
      nvm
     
    </strong>
    
     ).
    
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     is a project
    
    <a id="_idIndexMarker004">
    </a>
    
     of the OpenJS Foundation and provides a convenient way to install and update
    
    
     
      Node.js versions.
     
    
   </p>
   <h2 id="_idParaDest-24">
    <a id="_idTextAnchor023">
    </a>
    
     Getting ready
    
   </h2>
   <p>
    
     You may also need to have the appropriate permissions on your device to install
    
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     .
    
    
     This recipe assumes you’re on a Unix-like platform.
    
    
     If you’re on Windows, it should be run under
    
    
     
      Windows WSL.
     
    
   </p>
   <h2 id="_idParaDest-25">
    <a id="_idTextAnchor024">
    </a>
    
     How to do it…
    
   </h2>
   <p>
    
     In this recipe, we’re going to be
    
    <a id="_idIndexMarker005">
    </a>
    
     installing
    
    <a id="_idIndexMarker006">
    </a>
    
     Node.js 22 using
    
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     .
    
    
     Follow
    
    
     
      these steps:
     
    
   </p>
   <ol>
    <li>
     
      First, we need to install
     
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      .
     
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      provides a script that can download and install
     
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      .
     
     
      Enter the following command in your terminal to execute the
     
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      
       installation script:
      
     
     <pre class="source-code">
<strong class="bold">$ curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh | bash</strong></pre>
    </li>
    <li>
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      will automatically attempt to add itself to your path.
     
     
      Close and reopen your terminal to ensure the changes have taken place.
     
     
      Then, enter the following command to list the
     
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      version we have installed; this will also confirm that
     
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      is available in
     
     
      
       our path:
      
     
     <pre class="source-code">
<strong class="bold">$ nvm --version</strong>
0.40.1</pre>
    </li>
    <li>
     
      To install Node.js 22, we can use the
     
     <strong class="source-inline">
      
       $ nvm install
      
     </strong>
     
      command.
     
     
      We can supply either the specific version we wish to install or the major version number.
     
     
      If we specify just the major version number,
     
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      will install the latest release of that major release line.
     
     
      Enter the following command to install the latest version of
     
     
      
       Node.js 22:
      
     
     <pre class="source-code">
<strong class="bold">$ nvm install 22</strong>
Downloading and installing node v22.9.0...
Downloading https://nodejs.org/dist/v22.9.0/node-v22.9.0-darwin-arm64.tar.xz...
######################################################################### 100.0%
Computing checksum with sha256sum
Checksums matched!
Now using node v22.9.0 (npm v10.8.3)</pre>
     <p class="list-inset">
      
       Note that this command will install the latest version of Node.js 22, so your specific version install is likely to differ from that shown in the
      
      
       
        preceding output.
       
      
     </p>
    </li>
    <li>
     
      The latest Node.js 22 version should now be installed and available in your path.
     
     
      You can confirm this
     
     <a id="_idIndexMarker007">
     </a>
     
      by
     
     <a id="_idIndexMarker008">
     </a>
     
      entering the
     
     
      
       following command:
      
     
     <pre class="source-code">
<strong class="bold">$ node --version</strong>
v22.9.0</pre>
    </li>
    <li>
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      will also install the version of
     
     <strong class="source-inline">
      
       npm
      
     </strong>
     
      that is bundled with the Node.js version you have installed.
     
     
      Enter the following command to confirm which version of
     
     <strong class="source-inline">
      
       npm
      
     </strong>
     
      
       is installed:
      
     
     <pre class="source-code">
<strong class="bold">$ npm --version</strong>
10.8.3</pre>
    </li>
    <li>
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      makes it easy to install and switch between multiple Node.js versions.
     
     
      We can enter the following command to install and switch to the latest Node.js
     
     
      
       20 version:
      
     
     <pre class="source-code">
<strong class="bold">$ nvm install 20</strong>
Downloading and installing node v20.17.0...
Downloading https://nodejs.org/dist/v20.17.0/node-v20.17.0-darwin-arm64.tar.xz...
############################################################################################################################################### 100.0%
Computing checksum with sha256sum
Checksums matched!
Now using node v20.17.0 (npm v10.8.2)</pre>
    </li>
    <li>
     
      Once we’ve got the versions installed, we can use the
     
     <strong class="source-inline">
      
       nvm use
      
     </strong>
     
      command to switch
     
     
      
       between them:
      
     
     <pre class="source-code">
<strong class="bold">$ nvm use 22</strong>
Now using node v22.9.0 (npm v10.8.3)</pre>
    </li>
   </ol>
   <p>
    
     With that, we’ve installed the
    
    <a id="_idIndexMarker009">
    </a>
    
     latest
    
    <a id="_idIndexMarker010">
    </a>
    
     version of Node.js 22
    
    
     
      using
     
    
    
     <strong class="source-inline">
      
       nvm
      
     </strong>
    
    
     
      .
     
    
   </p>
   <h2 id="_idParaDest-26">
    <a id="_idTextAnchor025">
    </a>
    
     How it works…
    
   </h2>
   <p>
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     is a version manager for Node.js on Unix-like platforms and supports
    
    <strong class="bold">
     
      Portable Operating System Interface
     
    </strong>
    
     (
    
    <strong class="bold">
     
      POSIX
     
    </strong>
    
     )-compliant shells.
    
    
     POSIX is a set of standards for operating
    
    <a id="_idIndexMarker011">
    </a>
    
     system compatibility, defined by the IEEE
    
    
     
      Computer Society.
     
    
   </p>
   <p>
    
     First, we downloaded and executed the
    
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     installation script.
    
    
     Under the hood, the
    
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     install script does
    
    
     
      the following:
     
    
   </p>
   <ol>
    <li>
     
      Clones the
     
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      GitHub repository (
     
     <a href="https://github.com/nvm-sh/nvm">
      
       https://github.com/nvm-sh/nvm
      
     </a>
     
      )
     
     
      
       to
      
     
     
      <strong class="source-inline">
       
        ~/.nvm/
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     
      Attempts to add some source lines to import and load
     
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      into the appropriate profile file, where the profile file is either
     
     <strong class="source-inline">
      
       ~/.bash_profile
      
     </strong>
     
      ,
     
     <strong class="source-inline">
      
       ~/.bashrc
      
     </strong>
     
      ,
     
     <strong class="source-inline">
      
       ~/.profile
      
     </strong>
     
      ,
     
     
      
       or
      
     
     
      <strong class="source-inline">
       
        ~/.zshrc
       
      </strong>
     
     
      
       .
      
     
    </li>
   </ol>
   <p>
    
     Should you use a profile file other than the ones mentioned previously, you may need to manually add the following lines to your profile file to load
    
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     .
    
    
     The following lines are specified in the
    
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     installation
    
    
     
      documentation (
     
    
    <a href="https://github.com/nvm-sh/nvm#install--update-script">
     
      
       https://github.com/nvm-sh/nvm#install--update-script
      
     
    </a>
    
     
      ):
     
    
   </p>
   <pre class="source-code">
export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] &amp;&amp; printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")"
[ -s "$NVM_DIR/nvm.sh" ] &amp;&amp; \. "$NVM_DIR/nvm.sh" # This loads nvm</pre>
   <p>
    
     Each time you install a Node.js version using
    
    <strong class="source-inline">
     
      $ nvm install
     
    </strong>
    
     ,
    
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     downloads the appropriate binary for your platform from the official Node.js download server.
    
    
     The official Node.js download server can be accessed directly at
    
    <a href="https://nodejs.org/dist/">
     
      https://nodejs.org/dist/
     
    </a>
    
     .
    
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     will store all Node.js versions it has installed in the
    
    <strong class="source-inline">
     
      ~/.
     
    </strong>
    
     <strong class="source-inline">
      
       nvm/versions/node/
      
     </strong>
    
    
     
      directory.
     
    
   </p>
   <p>
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     supports aliases that can be used to install the LTS versions of Node.js.
    
    
     For example, you can use the
    
    <strong class="source-inline">
     
      $ nvm install --lts
     
    </strong>
    
     command to install the latest
    
    
     
      LTS release.
     
    
   </p>
   <p>
    
     To uninstall a Node.js version, you can use the
    
    <strong class="source-inline">
     
      $ nvm uninstall
     
    </strong>
    
     command.
    
    
     To change the default Node.js version, use the
    
    <strong class="source-inline">
     
      $ nvm alias default &lt;version&gt;
     
    </strong>
    
     command.
    
    
     The default version is the version that will be available when you open
    
    
     
      your terminal.
     
    
   </p>
   <p>
    
     If you do not wish to or are unable to use
    
    <strong class="source-inline">
     
      nvm
     
    </strong>
    
     , you can install Node.js manually.
    
    
     Visit the Node.js
    
    <strong class="bold">
     
      Downloads
     
    </strong>
    
     page (see
    
    <a href="https://nodejs.org/en/download">
     
      https://nodejs.org/en/download
     
    </a>
    
     ) to download the appropriate binary for
    
    
     
      your platform.
     
    
   </p>
   <p>
    
     The Node.js project provides TAR files for installation on many platforms.
    
    
     To install via a TAR file, you need to download and extract the TAR file, and then add the binary location to
    
    
     
      your path.
     
    
   </p>
   <p>
    
     Alongside TAR files, the Node.js
    
    <a id="_idIndexMarker012">
    </a>
    
     project provides
    
    <a id="_idIndexMarker013">
    </a>
    
     an installer for both macOS (
    
    <strong class="source-inline">
     
      .pkg
     
    </strong>
    
     ) and Windows (
    
    <strong class="source-inline">
     
      .msi
     
    </strong>
    
     ).
    
    
     As a result of installing Node.js manually, you will need to manually install updated versions of Node.js when you
    
    
     
      require them.
     
    
   </p>
   <h2 id="_idParaDest-27">
    <a id="_idTextAnchor026">
    </a>
    
     There’s more…
    
   </h2>
   <p>
    
     As allowed by the
    
    <a id="_idIndexMarker014">
    </a>
    
     Semantic Versioning specification, when upgrading from Node.js major versions, you may experience breaking changes that impact or stop how your script or application (including any dependencies) was executing under the
    
    
     
      prior version.
     
    
   </p>
   <p>
    
     Here are some recommendations for when you’re
    
    
     
      debugging upgrades:
     
    
   </p>
   <ul>
    <li>
     
      Review the major release’s release notes.
     
     
      These release notes will highlight any breaking changes, new or deprecated features, and important updates.
     
     
      Understanding what has changed can help you identify issues.
     
     
      Note that if you’re upgrading from/to Node.js LTS versions (for example, from Node.js 20 to 22), you should start by at least reviewing each of the interim major release changelogs – both 21.0.0
     
     
      
       and 22.0.0
      
     
     
      
       .
      
     
    </li>
    <li>
     
      If you’re upgrading from a very old Node.js version, it may be wise to perform incremental upgrades through intermediate versions.
     
     
      This can make it easier to identify and address compatibility issues gradually.
     
     
      This is made easier when using a Node.js version manager such as
     
     <strong class="source-inline">
      
       nvm
      
     </strong>
     
      as you can run and test your code against
     
     
      
       different versions.
      
     
    </li>
    <li>
     
      Review your project’s dependencies and ensure they are compatible with the new Node.js version.
     
     
      Outdated or unmaintained packages may not work correctly with the latest
     
     
      
       Node.js release.
      
     
    </li>
    <li>
     
      Create comprehensive test suites for your applications.
     
     
      Run your test suite before and after upgrading Node.js to ensure that your code behaves
     
     
      
       as expected.
      
     
    </li>
    <li>
     
      Use Node.js debugging tools.
     
     
      Node.js provides various diagnostic tools that can help you identify and resolve issues during
     
     
      
       an upgrade.
      
     
    </li>
    <li>
     
      Leverage online communities, forums, and documentation.
     
     
      Others in the Node.js community may have encountered similar issues during upgrades and can provide valuable
     
     <a id="_idIndexMarker015">
     </a>
     
      insights and solutions.
     
     
      This could include raising a
     
     <a id="_idIndexMarker016">
     </a>
     
      GitHub issue on one of the official Node.js repositories (
     
     <a href="https://github.com/nodejs/node">
      
       https://github.com/nodejs/node
      
     </a>
     
      
       or
      
     
     <a href="https://github.com/nodejs/help">
      
       
        https://github.com/nodejs/help
       
      
     </a>
     
      
       ).
      
     
    </li>
   </ul>
   <p>
    
     Remember that debugging
    
    <a id="_idIndexMarker017">
    </a>
    
     Node.js
    
    <a id="_idIndexMarker018">
    </a>
    
     upgrades may require time and thorough testing.
    
    
     It’s essential to be prepared for potential challenges and have a plan in place to mitigate any disruptions to your
    
    
     
      application’s functionality.
     
    
   </p>
   <h1 id="_idParaDest-28">
    <a id="_idTextAnchor027">
    </a>
    
     Accessing the Node.js API documentation
    
   </h1>
   <p>
    
     The Node.js project
    
    <a id="_idIndexMarker019">
    </a>
    
     provides comprehensive API reference documentation.
    
    
     The Node.js API documentation is a critical resource for understanding which APIs are available in the version of Node.js that you’re using.
    
    
     The Node.js documentation also describes how to interact with APIs, including which arguments a given method accepts and the method’s
    
    
     
      return value.
     
    
   </p>
   <p>
    
     This recipe will show how to access and navigate the Node.js
    
    
     
      API documentation.
     
    
   </p>
   <h2 id="_idParaDest-29">
    <a id="_idTextAnchor028">
    </a>
    
     Getting ready
    
   </h2>
   <p>
    
     You will need access to a browser of your choice and an internet connection to access the Node.js
    
    
     
      API documentation.
     
    
   </p>
   <h2 id="_idParaDest-30">
    <a id="_idTextAnchor029">
    </a>
    
     How to do it…
    
   </h2>
   <p>
    
     This recipe is going to demonstrate how to navigate the Node.js API documentation.
    
    
     Follow
    
    
     
      these steps:
     
    
   </p>
   <ol>
    <li>
     
      First, navigate to
     
     <a href="https://nodejs.org/api/">
      
       https://nodejs.org/api/
      
     </a>
     
      in
     
     
      
       your browser.
      
     
     <p class="list-inset">
      
       You’ll see the Node.js API documentation for the most recent version
      
      
       
        of Node.js:
       
      
     </p>
    </li>
   </ol>
   <div><div><img alt="Figure 1.1 – Node.js API documentation home page" src="img/B19212_01_01.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 1.1 – Node.js API documentation home page
    
   </p>
   <ol>
    <li value="2">
     
      Hover over
     
     <a id="_idIndexMarker020">
     </a>
     
      the
     
     <strong class="bold">
      
       Other versions
      
     </strong>
     
      dropdown to view the other release lines of Node.js.
     
     
      This is how you can change which version of Node.js you’re viewing the
     
     
      
       documentation for:
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 1.2 – Node.js API documentation showing the Other versions dropdown" src="img/B19212_01_02.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 1.2 – Node.js API documentation showing the Other versions dropdown
    
   </p>
   <ol>
    <li value="3">
     
      Now, let’s suppose we
     
     <a id="_idIndexMarker021">
     </a>
     
      want to find the documentation for the
     
     <strong class="source-inline">
      
       fs.readFile()
      
     </strong>
     
      method.
     
     
      The
     
     <strong class="source-inline">
      
       fs.readFile()
      
     </strong>
     
      method is exposed via the
     
     <strong class="bold">
      
       File system
      
     </strong>
     
      core module.
     
     
      First, we need to locate and click on
     
     <strong class="bold">
      
       File system
      
     </strong>
     
      in the left-hand navigation pane.
     
     
      Clicking
     
     <strong class="bold">
      
       File system
      
     </strong>
     
      will take us to the table of contents for the
     
     <strong class="bold">
      
       File system
      
     </strong>
     
      core module
     
     
      
       API documentation:
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 1.3 – Node.js API documentation for the File system subsystem" src="img/B19212_01_03.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 1.3 – Node.js API documentation for the File system subsystem
    
   </p>
   <ol>
    <li value="4">
     
      Scroll down until you
     
     <a id="_idIndexMarker022">
     </a>
     
      find the
     
     <strong class="source-inline">
      
       fs.readFile()
      
     </strong>
     
      method listed in the table of contents.
     
     
      When looking for a specific API, it may be worthwhile using your browser’s search facility to locate the API definition.
     
     
      Click the
     
     <strong class="bold">
      
       fs.readFile()
      
     </strong>
     
      link in the table of contents.
     
     
      This will open the
     
     
      
       API definition:
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 1.4 – Node.js API documentation showing the fs.readFile() API definition" src="img/B19212_01_04.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 1.4 – Node.js API documentation showing the fs.readFile() API definition
    
   </p>
   <ol>
    <li value="5">
     
      Now, click
     
     <strong class="bold">
      
       Command-line options
      
     </strong>
     
      in the
     
     <a id="_idIndexMarker023">
     </a>
     
      left-hand navigation pane.
     
     
      This page details all the available command-line options that can be passed to the
     
     
      
       Node.js process:
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 1.5 – Node.js API documentation showing the available command-line options" src="img/B19212_01_05.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 1.5 – Node.js API documentation showing the available command-line options
    
   </p>
   <p>
    
     With that, we’ve learned
    
    <a id="_idIndexMarker024">
    </a>
    
     how to access and navigate the Node.js
    
    
     
      API documentation.
     
    
   </p>
   <h2 id="_idParaDest-31">
    <a id="_idTextAnchor030">
    </a>
    
     How it works…
    
   </h2>
   <p>
    
     The Node.js API documentation is a vital reference resource when you’re building Node.js applications.
    
    
     The documentation is specific to each version of Node.js.
    
    
     In this recipe, we accessed the documentation for the most recent version of Node.js, which is the default version of the documentation that is rendered at
    
    <a href="https://nodejs.org/api/">
     
      https://nodejs.org/api/
     
    </a>
    
     .
    
    
     The following URL can be used to access the documentation for a specific version of Node.js:
    
    <a href="https://nodejs.org/docs/v22.0.0/api/index.html">
     
      https://nodejs.org/docs/v22.0.0/api/index.html
     
    </a>
    
     (substitute
    
    <strong class="source-inline">
     
      v22.0.0
     
    </strong>
    
     with the specific version you wish to view the
    
    
     
      documentation for).
     
    
   </p>
   <p>
    
     The API documentation details the usage of the Node.js APIs, including
    
    
     
      the following:
     
    
   </p>
   <ul>
    <li>
     
      The accepted parameters and
     
     
      
       their types
      
     
    </li>
    <li>
     
      If applicable, the value and type that the
     
     
      
       API returns
      
     
    </li>
   </ul>
   <p>
    
     In some cases, the documentation will provide further information, including a usage example or sample code demonstrating the usage of
    
    
     
      the API.
     
    
   </p>
   <p>
    
     Note that there are some undocumented APIs.
    
    
     Some Node.js APIs are intentionally undocumented as they are considered internal-only and are not intended for use outside of the Node.js
    
    
     
      core runtime.
     
    
   </p>
   <p>
    
     The API documentation
    
    <a id="_idIndexMarker025">
    </a>
    
     also details the stability of APIs.
    
    
     The Node.js project defines and uses the following four
    
    
     
      stability indices:
     
    
   </p>
   <ul>
    <li>
     <strong class="bold">
      
       0 – Deprecated
      
     </strong>
     
      : Usage of these APIs is discouraged.
     
     
      Warnings may be emitted upon the usage of these APIs.
     
     
      Deprecated APIs will also be listed
     
     
      
       at
      
     
     <a href="https://nodejs.org/docs/latest-v22.x/api/deprecations.html">
      
       
        https://nodejs.org/docs/latest-v22.x/api/deprecations.html
       
      
     </a>
     
      
       .
      
     
    </li>
    <li>
     <strong class="bold">
      
       1 – Experimental
      
     </strong>
     
      : These APIs are not considered stable and may be subject to some non-backward-compatible changes.
     
     
      Experimental APIs are not subject to the Semantic Versioning rules.
     
     
      Usage of these APIs should be done with caution, especially in production environments.
     
     
      More recently, the “Experimental” status in the Node.js documentation has been broken down into multiple stages in an attempt to indicate the maturity of
     
     
      
       the features:
      
     
     <ul>
      <li>
       <strong class="bold">
        
         1.0 -
        
       </strong>
       
        <strong class="bold">
         
          Early Development
         
        </strong>
       
      </li>
      <li>
       <strong class="bold">
        
         1.1 -
        
       </strong>
       
        <strong class="bold">
         
          Active Development
         
        </strong>
       
      </li>
      <li>
       <strong class="bold">
        
         1.2 -
        
       </strong>
       
        <strong class="bold">
         
          Release Candidate
         
        </strong>
       
      </li>
     </ul>
    </li>
    <li>
     <strong class="bold">
      
       2 – Stable
      
     </strong>
     
      : With stable APIs, the Node.js project will try to
     
     
      
       ensure compatibility.
      
     
    </li>
    <li>
     <strong class="bold">
      
       3 – Legacy
      
     </strong>
     
      : Legacy features may be unmaintained or more modern alternatives may be available.
     
     
      However, they are unlikely to be removed and continue to abide by Semantic
     
     
      
       Versioning rules.
      
     
    </li>
   </ul>
   <p>
    
     The Node.js documentation is maintained by the Node.js project in the Node.js core repository.
    
    
     Any errors or suggested improvements can be raised
    
    
     
      at
     
    
    <a href="https://github.com/nodejs/node">
     
      
       https://github.com/nodejs/node
      
     
    </a>
    
     
      .
     
    
   </p>
   <h2 id="_idParaDest-32">
    <a id="_idTextAnchor031">
    </a>
    
     There’s more…
    
   </h2>
   <p>
    
     The Node.js project
    
    <a id="_idIndexMarker026">
    </a>
    
     maintains a
    
    <strong class="source-inline">
     
      .md
     
    </strong>
    
     file for each release line of Node.js, detailing the individual commits that land in each release.
    
    
     The
    
    <strong class="source-inline">
     
      CHANGELOG.md
     
    </strong>
    
     file for Node.js 22 can be found
    
    
     
      at
     
    
    <a href="https://github.com/nodejs/node/blob/main/doc/changelogs/CHANGELOG_V22.md">
     
      
       https://github.com/nodejs/node/blob/main/doc/changelogs/CHANGELOG_V22.md
      
     
    </a>
    
     
      .
     
    
   </p>
   <p>
    
     The following is a snippet from the Node.js 22
    
    
     <strong class="source-inline">
      
       CHANGELOG.md
      
     </strong>
    
    
     
      file:
     
    
   </p>
   <div><div><img alt="Figure 1.6 – Example Node.js 22.0.0 CHANGELOG.md entry" src="img/B19212_01_06.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 1.6 – Example Node.js 22.0.0 CHANGELOG.md entry
    
   </p>
   <p>
    
     The Node.js project highlights the notable changes in each release.
    
    
     The
    
    <strong class="source-inline">
     
      CHANGELOG.md
     
    </strong>
    
     file denotes which commits were determined to be
    
    <strong class="source-inline">
     
      SEMVER-MINOR
     
    </strong>
    
     according to the Semantic Versioning standard (
    
    <a href="https://semver.org/">
     
      https://semver.org/
     
    </a>
    
     ).
    
    
     Entries marked as
    
    <strong class="source-inline">
     
      SEMVER-MINOR
     
    </strong>
    
     indicate feature additions.
    
    
     The
    
    <strong class="source-inline">
     
      CHANGELOG.md
     
    </strong>
    
     file will also denote when a release is considered a security release (fixing a security issue).
    
    
     In the case of a security release, the
    
    <strong class="bold">
     
      Notable Changes
     
    </strong>
    
     section will start with the sentence
    
    <strong class="bold">
     
      This is a
     
    </strong>
    
     <strong class="bold">
      
       security release.
      
     </strong>
    
   </p>
   <p>
    
     For major releases, the Node.js project releases a release announcement on the Node.js website that details the new features and changes.
    
    
     The Node.js 22 release announcement is available
    
    
     
      at
     
    
    <a href="https://nodejs.org/en/blog/announcements/v22-release-announce">
     
      
       https://nodejs.org/en/blog/announcements/v22-release-announce
      
     
    </a>
    
     
      .
     
    
   </p>
   <p>
    
     Node.js
    
    <strong class="source-inline">
     
      CHANGELOG.md
     
    </strong>
    
     files
    
    <a id="_idIndexMarker027">
    </a>
    
     can be used as a reference when upgrading Node.js, to help you understand what updates and changes are included in the
    
    
     
      new version.
     
    
   </p>
   <h1 id="_idParaDest-33">
    <a id="_idTextAnchor032">
    </a>
    
     Adopting new JavaScript syntax in Node.js 22
    
   </h1>
   <p>
    
     The formal
    
    <a id="_idIndexMarker028">
    </a>
    
     specification for the JavaScript
    
    <a id="_idIndexMarker029">
    </a>
    
     language is ECMAScript.
    
    
     New JavaScript features make their way into Node.js via updates to the underlying V8 JavaScript engine that the Node.js runtime is built on top of.
    
    
     ECMAScript has annual updates that provide new JavaScript language features
    
    
     
      and syntax.
     
    
   </p>
   <p>
    
     New major versions of Node.js tend to include a significant upgrade to the V8 engine.
    
    
     Node.js version 22.0.0 was released with V8 version 12.4.
    
    
     However, the V8 version may be upgraded during the lifetime of
    
    
     
      Node.js 22.
     
    
   </p>
   <p>
    
     Updated versions of V8 bring underlying performance improvements and new JavaScript language features and syntax to the Node.js runtime.
    
    
     This recipe will showcase a couple of the newer JavaScript language features that have been introduced in
    
    
     
      Node.js 22.
     
    
   </p>
   <h2 id="_idParaDest-34">
    <a id="_idTextAnchor033">
    </a>
    
     Getting ready
    
   </h2>
   <p>
    
     For this recipe, you will need to have Node.js 22 installed.
    
    
     You will also need to have access to
    
    
     
      a terminal.
     
    
   </p>
   <h2 id="_idParaDest-35">
    <a id="_idTextAnchor034">
    </a>
    
     How to do it…
    
   </h2>
   <p>
    
     In this recipe, we will be using
    
    <a id="_idIndexMarker030">
    </a>
    
     the Node.js
    
    <strong class="bold">
     
      Read Eval Print Loop
     
    </strong>
    
     (
    
    <strong class="bold">
     
      REPL
     
    </strong>
    
     ) to test out the newer JavaScript features that are available in Node.js 22.
    
    
     Follow
    
    
     
      these steps:
     
    
   </p>
   <ol>
    <li>
     
      First, let’s open the Node.js REPL.
     
     
      Enter the following command in
     
     
      
       your terminal:
      
     
     <pre class="source-code">
<strong class="bold">$ node</strong></pre>
    </li>
    <li>
     
      This should open the REPL, which is an interface that we can use to execute code.
     
     
      Expect to see the
     
     
      
       following output:
      
     
    </li>
   </ol>
   <div><div><img alt="Figure 1.7 – Node.js REPL" src="img/B19212_01_07.jpg"/>
     
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    
     Figure 1.7 – Node.js REPL
    
   </p>
   <ol>
    <li value="3">
     
      Start by entering
     
     <a id="_idIndexMarker031">
     </a>
     
      the
     
     <a id="_idIndexMarker032">
     </a>
     
      following command.
     
     
      This command will return the version of V8 that is embedded in the Node.js version
     
     
      
       you’re using:
      
     
     <pre class="source-code">
&gt; <strong class="bold">process.versions.v8</strong>
'12.4.254.21-node.19'</pre>
    </li>
    <li>
     
      Two new JavaScript
     
     <strong class="source-inline">
      
       String
      
     </strong>
     
      methods were made available since
     
     
      
       Node.js 20:
      
     
     <ul>
      <li>
       <strong class="source-inline">
        
         String.prototype.isWellFormed
        
       </strong>
       
        : This method returns whether the supplied
       
       <strong class="source-inline">
        
         String
        
       </strong>
       
        is
       
       
        
         well-formed UTF-16
        
       
      </li>
      <li>
       <strong class="source-inline">
        
         String.prototype.toWellFormed
        
       </strong>
       
        : This method will replace unpaired surrogates
       
       <a id="_idIndexMarker033">
       </a>
       
        with the
       
       <strong class="bold">
        
         replacement character
        
       </strong>
       
        (
       
       <strong class="source-inline">
        
         U+FFFD
        
       </strong>
       
        ), thus making the UTF-16
       
       
        
         String well-formed.
        
       
      </li>
     </ul>
     <p class="list-inset">
      
       You can demonstrate this in
      
      
       
        the REPL:
       
      
     </p>
     <pre class="source-code">
&gt; "006E006F00640065".isWellFormed()
true</pre>
    </li>
    <li>
     
      Another recent feature addition is the
     
     <strong class="source-inline">
      
       Intl.NumberFormat
      
     </strong>
     
      built-in object, which provides language-based number formatting.
     
     
      Let’s test this out.
     
     
      In the REPL, declare
     
     
      
       a number:
      
     
     <pre class="source-code">
&gt; const number = 123456.789;
undefined</pre>
    </li>
    <li>
     
      Next, let’s
     
     <a id="_idIndexMarker034">
     </a>
     
      format
     
     <a id="_idIndexMarker035">
     </a>
     
      that number as if it were
     
     <a id="_idIndexMarker036">
     </a>
     
      the
     
     <strong class="bold">
      
       Great British
      
     </strong>
     
      <strong class="bold">
       
        Pound
       
      </strong>
     
     
      
       (
      
     
     
      <strong class="bold">
       
        GBP
       
      </strong>
     
     
      
       ):
      
     
     <pre class="source-code">
&gt; new Intl.NumberFormat('en-UK', { style: 'currency', currency: 'GBP' }).format(number);
'£123,456.79'</pre>
    </li>
    <li>
     
      In Node.js 22, new
     
     <strong class="source-inline">
      
       Set
      
     </strong>
     
      methods like
     
     <strong class="source-inline">
      
       union
      
     </strong>
     
      ,
     
     <strong class="source-inline">
      
       intersection
      
     </strong>
     
      , and
     
     <strong class="source-inline">
      
       difference
      
     </strong>
     
      were added as part of the V8 12.4 update.
     
     
      These enhancements make it easier to perform operations on numeric sets.
     
     
      Here’s an example involving prime and
     
     
      
       odd numbers:
      
     
     <pre class="source-code">
&gt; const oddNumbers = new Set([1, 3, 5, 7]), primeNumbers = new Set([2, 3, 5, 7]);
undefined
&gt; console.log('All Numbers:', [...(oddNumbers.union(primeNumbers))].toString());
All Numbers: 1,3,5,7,2
undefined
&gt; console.log('Common Numbers:', [...(oddNumbers.intersection(primeNumbers))].toString());
Common Numbers: 3,5,7
undefined
&gt; console.log('Exclusive Primes:', [...(primeNumbers.difference(oddNumbers))].toString());
Exclusive Primes: 2</pre>
    </li>
   </ol>
   <p>
    
     Using the REPL, we’ve explored a couple of the new JavaScript language features that are available in Node.js 22.
    
    
     The main goal of this learning is that new JavaScript language features become available
    
    <a id="_idIndexMarker037">
    </a>
    
     through upgrading the underlying
    
    <a id="_idIndexMarker038">
    </a>
    
     Google Chrome
    
    
     
      V8 engine.
     
    
   </p>
   <h2 id="_idParaDest-36">
    <a id="_idTextAnchor035">
    </a>
    
     How it works…
    
   </h2>
   <p>
    
     New JavaScript language features are introduced into Node.js via updates to the underlying Google Chrome V8 JavaScript engine.
    
    
     A JavaScript engine parses and executes JavaScript code.
    
    
     The embedding of the Google Chrome V8 engine in Node.js is what enabled the execution of JavaScript outside of the browser.
    
    
     Chrome’s V8 JavaScript engine is one of many available JavaScript engines, with Mozilla’s SpiderMonkey, which is used in the Mozilla Firefox browser, being another leading
    
    
     
      JavaScript engine.
     
    
   </p>
   <p>
    
     Every 6 weeks, a new version of Google Chrome’s V8 engine is released.
    
    
     Node.js 22 will continue to incorporate updates into V8, provided
    
    <a id="_idIndexMarker039">
    </a>
    
     they can be made
    
    <strong class="bold">
     
      application binary interface
     
    </strong>
    
     (
    
    <strong class="bold">
     
      ABI
     
    </strong>
    
     )-compatible.
    
    
     An ABI describes how programs can interact with functions and data structures via compiled programs.
    
    
     It can be
    
    <a id="_idIndexMarker040">
    </a>
    
     considered similar to a compiled version of an
    
    <strong class="bold">
     
      application programming
     
    </strong>
    
     <strong class="bold">
      
       interface
      
     </strong>
    
    
     
      (
     
    
    
     <strong class="bold">
      
       API
      
     </strong>
    
    
     
      ).
     
    
   </p>
   <p>
    
     Once there is a release of V8 that no longer allows ABI compatibility, the specific release line of Node.js will be fixed on that version of V8.
    
    
     However, specific V8 patches and fixes may continue to be applied directly to that Node.js release line.
    
    
     Node.js 20 is now fixed on V8 version 11.3, whereas Node.js 22, at the time of writing, is at V8 12.4.
    
    
     The V8 version in Node.js 22 will continue to be updated until ABI compatibility of newer versions of V8 can no longer
    
    
     
      be maintained.
     
    
   </p>
   <p>
    
     The V8 JavaScript engine compiles JavaScript internally
    
    <a id="_idIndexMarker041">
    </a>
    
     using
    
    <strong class="bold">
     
      just-in-time
     
    </strong>
    
     (
    
    <strong class="bold">
     
      JIT
     
    </strong>
    
     ) compilation.
    
    
     JIT compilation speeds up the execution of JavaScript.
    
    
     While V8 is executing JavaScript, it obtains data about the code that is being executed.
    
    
     From this data, the V8 engine can make speculative optimizations.
    
    
     Speculative optimizations anticipate the upcoming code based on the code that has recently been executed.
    
    
     This allows the V8 engine to optimize
    
    <a id="_idIndexMarker042">
    </a>
    
     for the
    
    
     
      upcoming code.
     
    
   </p>
   <p>
    
     The V8 blog provides announcements of new V8 releases and details the new features and updates to V8.
    
    
     The V8 blog can be accessed
    
    
     
      at
     
    
    <a href="https://v8.dev/blog">
     
      
       https://v8.dev/blog
      
     
    </a>
    
     
      .
     
    
   </p>
   <h1 id="_idParaDest-37">
    <a id="_idTextAnchor036">
    </a>
    
     Introducing the Node.js event loop
    
   </h1>
   <p>
    
     The Node.js event loop is a
    
    <a id="_idIndexMarker043">
    </a>
    
     fundamental concept in Node.js that enables it to perform asynchronous and non-blocking operations efficiently.
    
    
     It’s a mechanism that’s responsible for managing the execution of code in an event-driven environment.
    
    
     Understanding the Node.js event loop is crucial for building scalable and responsive applications, especially when dealing with input/output-bound tasks such as reading files, making network requests, or handling multiple client
    
    
     
      connections simultaneously.
     
    
   </p>
   <h2 id="_idParaDest-38">
    <a id="_idTextAnchor037">
    </a>
    
     Getting ready
    
   </h2>
   <p>
    
     You will need to have Node.js 22 installed.
    
    
     You will also need to have access to
    
    
     
      a terminal.
     
    
   </p>
   <h2 id="_idParaDest-39">
    <a id="_idTextAnchor038">
    </a>
    
     How to do it…
    
   </h2>
   <p>
    
     In this recipe, we will create two files.
    
    
     One will demonstrate us blocking the event loop, while the other will demonstrate not blocking the event loop.
    
    
     Follow
    
    
     
      these steps:
     
    
   </p>
   <ol>
    <li>
     
      Create a file
     
     
      
       named
      
     
     
      <strong class="source-inline">
       
        blocking.js
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     
      Add the
     
     
      
       following code:
      
     
     <pre class="source-code">
// Blocking function
function blockingOperation() {
  console.log('Start blocking operation');
  // Simulate a time-consuming synchronous operation (e.g., reading a large file)
  for (let i = 0; i &lt; 1000000000; i++) {
    // This loop will keep the CPU busy for a while, blocking other operations
  }
  console.log('End blocking operation');
}
console.log('Before blocking operation');
// Call the blocking function
blockingOperation();
console.log('After blocking operation');</pre>
    </li>
    <li>
     
      Run the script and
     
     <a id="_idIndexMarker044">
     </a>
     
      observe how it waits on the
     
     
      
       blocking operation:
      
     
     <pre class="source-code">
<strong class="bold">$ node blocking.js</strong>
Before blocking operation
Start blocking operation
End blocking operation
After blocking operation</pre>
     <p class="list-inset">
      
       This script demonstrates a blocking operation by using a synchronous loop that keeps the CPU busy.
      
      
       When you run the script, you’ll notice that it logs
      
      <strong class="source-inline">
       
        Start blocking operation
       
      </strong>
      
       , executes the blocking loop, and finally logs
      
      <strong class="source-inline">
       
        End blocking operation
       
      </strong>
      
       and
      
      <strong class="source-inline">
       
        After
       
      </strong>
      
       <strong class="source-inline">
        
         blocking operation
        
       </strong>
      
      
       
        .
       
      
     </p>
    </li>
    <li>
     
      Now, let’s implement a non-blocking script.
     
     
      Create a file
     
     
      
       named
      
     
     
      <strong class="source-inline">
       
        non-blocking.js
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     
      Add the
     
     
      
       following code:
      
     
     <pre class="source-code">
console.log('Before non-blocking operation');
// Non-blocking operation (setTimeout)
setTimeout(() =&gt; {
  console.log('Non-blocking operation completed');
}, 2000); // Simulate a non-blocking operation that takes 2 seconds
console.log('After non-blocking operation');</pre>
    </li>
    <li>
     
      Run the script and
     
     <a id="_idIndexMarker045">
     </a>
     
      observe how
     
     
      
       it executes:
      
     
     <pre class="source-code">
<strong class="bold">$ node non-blocking.js</strong>
Before non-blocking operation
After non-blocking operation
Non-blocking operation completed</pre>
     <p class="list-inset">
      
       This script demonstrates a non-blocking operation using the
      
      <strong class="source-inline">
       
        setTimeout
       
      </strong>
      
       function, which implements a delay of at least 2 seconds.
      
      
       When you run this script, it logs
      
      <strong class="source-inline">
       
        Before non-blocking operation
       
      </strong>
      
       , schedules the timeout, immediately logs
      
      <strong class="source-inline">
       
        After non-blocking operation
       
      </strong>
      
       , and then, after 2 seconds, logs
      
      <strong class="source-inline">
       
        Non-blocking operation completed
       
      </strong>
      
       .
      
      
       This example demonstrates that during the 2-second delay, Node.js remains responsive and can continue with other tasks, showing that this operation
      
      
       
        is non-blocking.
       
      
     </p>
    </li>
    <li>
     
      Let’s demonstrate the Node.js event loop with
     
     <strong class="source-inline">
      
       process.nextTick()
      
     </strong>
     
      .
     
     
      To do so, create a file
     
     
      
       named
      
     
     
      <strong class="source-inline">
       
        next-tick.js
       
      </strong>
     
     
      
       .
      
     
    </li>
    <li>
     
      Add the following code
     
     
      
       to
      
     
     
      <strong class="source-inline">
       
        next-tick.js
       
      </strong>
     
     
      
       :
      
     
     <pre class="source-code">
console.log('Start');
process.nextTick(() =&gt; {
  console.log('Callback scheduled with
    process.nextTick #1');
});
setTimeout(() =&gt; {
  console.log('setTimeout #1 callback');
}, 0);
process.nextTick(() =&gt; {
  console.log('Callback scheduled with
    process.nextTick #2');
});
console.log('End');</pre>
    </li>
    <li>
     
      Run the program and
     
     <a id="_idIndexMarker046">
     </a>
     
      observe the order of how
     
     
      
       they’re executed:
      
     
     <pre class="source-code">
<strong class="bold">$ node next-tick.js</strong>
Start
End
Callback scheduled with process.nextTick #1
Callback scheduled with process.nextTick #2
setTimeout #1 callback</pre>
    </li>
   </ol>
   <p>
    
     The
    
    <strong class="source-inline">
     
      Start
     
    </strong>
    
     and
    
    <strong class="source-inline">
     
      End
     
    </strong>
    
     log statements are executed immediately because they are part of the main code execution.
    
    
     The two callbacks that are scheduled with
    
    <strong class="source-inline">
     
      process.nextTick()
     
    </strong>
    
     are executed before any other scheduled callbacks, before the
    
    <strong class="source-inline">
     
      setTimeout
     
    </strong>
    
     callback.
    
    
     This is because
    
    <strong class="source-inline">
     
      process.nextTick()
     
    </strong>
    
     callbacks have the highest priority and run at the beginning of the next event loop cycle.
    
    
     After the
    
    <strong class="source-inline">
     
      process.nextTick()
     
    </strong>
    
     callbacks are executed, the
    
    <strong class="source-inline">
     
      setTimeout
     
    </strong>
    
     callback
    
    
     
      is executed.
     
    
   </p>
   <h2 id="_idParaDest-40">
    <a id="_idTextAnchor039">
    </a>
    
     How it works…
    
   </h2>
   <p>
    
     Node.js operates in a single-threaded environment, meaning it uses a single main thread of execution for your JavaScript code.
    
    
     However, Node.js can still handle many concurrent operations by leveraging
    
    <a id="_idIndexMarker047">
    </a>
    
     asynchronous,
    
    
     
      non-blocking I/O.
     
    
   </p>
   <p>
    
     Node.js is event-driven, which means it relies on events and callbacks to execute code in response to various actions or events.
    
    
     Events can be I/O operations (for example, reading files or making network requests), timers, or custom events triggered by
    
    
     
      your code.
     
    
   </p>
   <p>
    
     There are some key concepts to understand about Node.js’s handling
    
    
     
      of I/O:
     
    
   </p>
   <ul>
    <li>
     <strong class="bold">
      
       Non-blocking
      
     </strong>
     
      : Node.js
     
     <a id="_idIndexMarker048">
     </a>
     
      not waiting for each operation to complete before moving on is referred to as non-blocking.
     
     
      Node.js can handle multiple tasks concurrently, making it highly efficient for
     
     
      
       I/O-bound operations.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Event queue
      
     </strong>
     
      : When you
     
     <a id="_idIndexMarker049">
     </a>
     
      perform an asynchronous operation, such as reading a file, Node.js doesn’t block the entire program.
     
     
      Instead, it puts these operations in a queue known as the
     
     <strong class="bold">
      
       event queue
      
     </strong>
     
      and continues with
     
     
      
       other tasks.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Event loop
      
     </strong>
     
      : The
     
     <strong class="bold">
      
       event loop
      
     </strong>
     
      keeps running
     
     <a id="_idIndexMarker050">
     </a>
     
      and checking the event queue.
     
     
      If there’s an operation in the queue that has completed (for example, a file has finished being read), it will execute a callback function associated with
     
     
      
       that operation.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Callback functions
      
     </strong>
     
      : When an
     
     <a id="_idIndexMarker051">
     </a>
     
      asynchronous operation is initiated, you usually provide a callback function.
     
     
      This function gets called when the operation is finished.
     
     
      For example, if you’re reading a file, the callback function will handle what to do with the file’s contents once
     
     
      
       it’s available.
      
     
    </li>
   </ul>
   <p>
    <strong class="source-inline">
     
      libuv
     
    </strong>
    
     (
    
    <a href="https://libuv.org/">
     
      https://libuv.org/
     
    </a>
    
     ) serves as the
    
    <a id="_idIndexMarker052">
    </a>
    
     underlying library that powers the Node.js event loop by providing a platform-agnostic, efficient, and concurrent I/O framework.
    
    
     It enables Node.js to achieve its non-blocking, asynchronous nature while maintaining compatibility across various
    
    
     
      operating systems.
     
    
   </p>
   <h2 id="_idParaDest-41">
    <a id="_idTextAnchor040">
    </a>
    
     There’s more
    
   </h2>
   <p>
    
     The Node.js event loop
    
    <a id="_idIndexMarker053">
    </a>
    
     operates a flow of phases.
    
    
     Deeply understanding this flow is important when it comes to debugging, performance, and making the most of Node.js’
    
    
     
      non-blocking approach.
     
    
   </p>
   <p>
    
     When the Node.js process starts, the event loop is initialized and the input script is processed.
    
    
     The event loop will continue until nothing is pending in the event loop or
    
    <strong class="source-inline">
     
      process.exit()
     
    </strong>
    
     is
    
    
     
      explicitly called.
     
    
   </p>
   <p>
    
     The event loop
    
    <a id="_idIndexMarker054">
    </a>
    
     phases are
    
    
     
      as follows:
     
    
   </p>
   <ul>
    <li>
     <strong class="bold">
      
       Timers phase
      
     </strong>
     
      : This phase checks for any scheduled timers that need to be executed.
     
     
      These timers are typically created using functions such as
     
     <strong class="source-inline">
      
       setTimeout()
      
     </strong>
     
      or
     
     <strong class="source-inline">
      
       setInterval()
      
     </strong>
     
      .
     
     
      If a timer’s specified time has passed, its callback function is added to the I/O
     
     
      
       polling phase.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Pending callbacks phase
      
     </strong>
     
      : In this phase, the event loop checks for events that have completed (or errored) their I/O operations.
     
     
      This includes, for example, filesystem operations, network requests, and user events.
     
     
      If any of these operations have been completed, their callback functions are executed during
     
     
      
       this phase.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Idle and prepare phases
      
     </strong>
     
      : These phases are rarely used in typical application development and are typically reserved for special use cases.
     
     
      The idle phase runs callbacks that are scheduled to execute during the idle period, whereas the prepare phase is used to prepare for
     
     
      
       poll events.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Poll phase
      
     </strong>
     
      : The poll phase is where most of the action happens in the event loop.
     
     
      It performs the
     
     
      
       following tasks:
      
     
     <ul>
      <li>
       
        Checks for new I/O events (for example incoming data on a socket) and executes their callbacks if any
       
       
        
         are ready.
        
       
      </li>
      <li>
       
        If no I/O events are pending, it checks the callback queue for pending callbacks scheduled by timers or
       
       <strong class="source-inline">
        
         setImmediate()
        
       </strong>
       
        .
       
       
        If any are found, they
       
       
        
         are executed.
        
       
      </li>
      <li>
       
        If there are no pending I/O events or callbacks, the event loop may enter a blocking state waiting for new events to arrive.
       
       
        This is
       
       
        
         called “polling.”
        
       
      </li>
     </ul>
    </li>
    <li>
     <strong class="bold">
      
       Check phase
      
     </strong>
     
      : In this phase, callbacks registered with
     
     <strong class="source-inline">
      
       setImmediate()
      
     </strong>
     
      are executed.
     
     
      Any callbacks are executed after the current poll phase but before any
     
     
      
       I/O callbacks.
      
     
    </li>
    <li>
     <strong class="bold">
      
       Close callbacks phase
      
     </strong>
     
      : This phase is responsible for executing close event callbacks, such as those
     
     <a id="_idIndexMarker055">
     </a>
     
      registered with the
     
     <strong class="source-inline">
      
       socket.on('close', ...)
      
     </strong>
     
      
       event.
      
     
    </li>
   </ul>
   <p>
    
     After completing all these phases, the event loop checks if there are any pending timers, I/O operations, or other events.
    
    
     If there are, it goes back to the appropriate phase to handle them.
    
    
     Otherwise, if there are no further pending events, the Node.js
    
    
     
      process ends.
     
    
   </p>
   <p>
    <strong class="source-inline">
     
      process.nextTick()
     
    </strong>
    
     is not detailed in the phases.
    
    
     This is because
    
    <strong class="source-inline">
     
      process.nextTick()
     
    </strong>
    
     schedules the provided callback function to run on the next tick of the event loop.
    
    
     Importantly, this callback function is executed with higher priority than other asynchronous operations.
    
    
     The
    
    <strong class="source-inline">
     
      process.nextTick()
     
    </strong>
    
     callback is executed after the current phase of the event loop is complete but before the event loop moves on to the next phase.
    
    
     This
    
    <a id="_idIndexMarker056">
    </a>
    
     allows you to schedule tasks so that they run with higher priority, making it useful for ensuring that certain functions run immediately after the
    
    
     
      current operation.
     
    
   </p>
  </div>
 </body></html>