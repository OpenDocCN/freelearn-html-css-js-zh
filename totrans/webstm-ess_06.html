<html><head></head><body>
<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch06" class="calibre1"/>Chapter 6. Immersing Yourself in Mobile App Development</h1></div></div></div><p class="calibre7">In the previous chapter, we went through some of the essential web frameworks, and learned how WebStorm can help when working with them. We have seen how JavaScript can be used on both the client and the server.</p><p class="calibre7">In this chapter, we are going to learn how to use JavaScript, HTML, and CSS to develop mobile applications, and for setting up our environment to test mobile applications. For this, we are going to focus on the following, which are some of the most-used frameworks of the moment:</p><div><ul class="itemizedlist"><li class="listitem">Apache Cordova</li><li class="listitem">PhoneGap</li><li class="listitem">Ionic</li></ul></div><p class="calibre7">The main advantage of using the HTML, CSS, and JavaScript frameworks for mobile development is that we can use a single codebase and a single language for all the platforms that we want to target. This can help a lot in terms of the amount of code you have to write, the technologies that you have to learn, and the speed of development.</p><p class="calibre7">By the end of this chapter, you will be able to quickly start a mobile project, and test it across multiple devices.</p></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_1"><a id="ch06lvl1sec37" class="calibre1"/>Setting up your system for mobile development</h1></div></div></div><p class="calibre7">Before <a id="id169" class="calibre1"/>we dive into the mobile development world, we need to prepare our system so that we can test the applications we create. For that purpose, we are going to set up some emulators and the necessary tools.</p></div></div>

<div><div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch06lvl2sec38" class="calibre1"/>The iOS platform guide</h2></div></div></div><p class="calibre7">In this <a id="id170" class="calibre1"/>section, we are going to set up our environment to deploy apps for iOS devices such as iPhone and iPad. The Apple® tools, which are required to build the iOS applications, run only on the OS X operating system on Intel-based Macs.</p><div><div><div><div><h3 class="title2"><a id="ch06lvl3sec01" class="calibre1"/>Installing Xcode and the SDK</h3></div></div></div><p class="calibre7">The first <a id="id171" class="calibre1"/>tool that you need to install is Xcode. This <a id="id172" class="calibre1"/>tool runs only on OS X version 10.9 (Mavericks) or <a id="id173" class="calibre1"/>higher, and includes the iOS 8 SDK. If you plan to test your <a id="id174" class="calibre1"/>app on an actual device, it must have at least iOS 6.x installed, and you must also be a member of the Apple's iOS Developer Program. In this book, you are going to learn how to deploy the apps to the emulator, for which you don't need to register with the developer program.</p><p class="calibre7">You can install Xcode from the AppStore. Search for Xcode and select install:</p><div><img src="img/00081.jpeg" alt="Installing Xcode and the SDK" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Once the installation of Xcode is over, we need to install the <code class="email">ios-sim</code> tool. This tool is a command-line <a id="id175" class="calibre1"/>utility that launches an iOS application <a id="id176" class="calibre1"/>in the simulator.</p><p class="calibre7">To install <code class="email">ios-sim</code>, we <a id="id177" class="calibre1"/>need to open a terminal window, and run the following command:</p><div><pre class="programlisting">
<strong class="calibre8">npm install -g ios-sim</strong>
</pre></div><p class="calibre7">Once the installation <a id="id178" class="calibre1"/>of <code class="email">ios-sim</code> is done, we have all the tools needed to test our applications on the iOS platform.</p></div></div></div></div>

<div><div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch06lvl2sec39" class="calibre1"/>The Android platform guide</h2></div></div></div><p class="calibre7">Now that we <a id="id179" class="calibre1"/>have the iOS platform set up, we are going to show you how to set up the environment for the Android apps. The simplest way to get all the required tools is to install Android Studio, the official Android IDE. This is an IDE built on another popular JetBrains product called IntelliJ IDEA Community Edition. It is <a id="id180" class="calibre1"/>available for the Windows, Mac OS X, and Linux platforms.</p><p class="calibre7">To install Android <a id="id181" class="calibre1"/>Studio, download the latest version from <a class="calibre1" href="http://developer.android.com/sdk/index.html">http://developer.android.com/sdk/index.html</a>, and then follow the screen instructions.</p><p class="calibre7">By default, Android Studio installs the image emulator for Nexus 5. If you want to test your application on other devices, you need to install them in the Android Virtual Device Manager. You can find that in Android Studio under <strong class="calibre8">Tools</strong> | <strong class="calibre8">Android</strong> | <strong class="calibre8">AVD Manager</strong>:</p><div><img src="img/00082.jpeg" alt="The Android platform guide" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">All the frameworks covered in this chapter also support deployment to other platforms besides iOS and Android. So if you want to develop an application for those, you will have to install the necessary SDK or tools. We will not cover the steps for other platforms in this book, but you can find more information by searching for the SDK of each platform.</p><p class="calibre7">Some of the other <a id="id182" class="calibre1"/>supported platforms are as follows:</p><div><ul class="itemizedlist"><li class="listitem">Amazon <a id="id183" class="calibre1"/>Fire OS</li><li class="listitem">BlackBerry</li><li class="listitem">Firefox OS</li><li class="listitem">Ubuntu</li><li class="listitem">Windows Phone</li><li class="listitem">Tiezen</li></ul></div><p class="calibre7">Now that we have set up the environment for the Android and iOS platforms, we can start building the mobile apps.</p></div></div></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec38" class="calibre1"/>Cordova</h1></div></div></div><div><table border="0" cellspacing="0" cellpadding="0" class="blockquote1" summary="Block quote"><tr class="calibre16"><td valign="top" class="calibre17"> </td><td valign="top" class="calibre17"><p class="calibre18"><em class="calibre19">Apache Cordova is a platform for building native mobile applications using HTML, CSS and JavaScript</em></p></td><td valign="top" class="calibre17"> </td></tr><tr class="calibre16"><td valign="top" class="calibre17"> </td><td colspan="2" valign="top" class="calibre20">--<a class="ulink" href="https://cordova.apache.org/">https://cordova.apache.org/</a></td></tr></table></div><p class="calibre7">Cordova <a id="id184" class="calibre1"/>is a set of JavaScript APIs that allows access to the native functions of the device such as the accelerometer, camera, or geolocation.</p><p class="calibre7">The developer, while <a id="id185" class="calibre1"/>writing an app with Apache Cordova, uses web technologies that are packaged using the SDK platform as the native apps. At their core, the apps use HTML5 and CSS3 for the rendering part and JavaScript for the logic.</p><p class="calibre7">Before we start building applications with this framework, we need to install it. To do that, we need to run the following command  in a terminal window:</p><div><pre class="programlisting">
<strong class="calibre8">npm install -g cordova</strong>
</pre></div><p class="calibre7">The preceding command installs Apache Cordova globally, so it will be available for all future projects. Once the installation is complete, we will have to restart WebStorm so that it detects the newly installed framework.</p><p class="calibre7">Now select <strong class="calibre8">New Project</strong> from either the welcome screen or the <strong class="calibre8">File</strong> menu. Select <strong class="calibre8">PhoneGap/Cordova App</strong> as a template, insert the destination folder, and select the path to the Cordova CLI, as shown in the following screenshot:</p><div><img src="img/00083.jpeg" alt="Cordova" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">This creates and opens a new project based on the Cordova framework. The project comes preloaded with <a id="id186" class="calibre1"/>an example page that we can use.</p><p class="calibre7">Before testing our application in the emulators, we need to edit the run configurations. So select <strong class="calibre8">Edit Configurations...</strong>, as shown in the following screenshot:</p><div><img src="img/00084.jpeg" alt="Cordova" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Change the name to iOS, and select <strong class="calibre8">ios</strong> in the Platform dropdown. Click on <strong class="calibre8">OK</strong> to save the configuration. This <a id="id187" class="calibre1"/>will create a run environment configuration that can be used to test the application on the iOS platform.</p><p class="calibre7">If we check <strong class="calibre8">Specify target</strong> (seen in the following screenshot), we can choose a specific device like iPhone 6, iPhone 5s, or others:</p><div><img src="img/00085.jpeg" alt="Cordova" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Now we can run our <a id="id188" class="calibre1"/>application in the emulator by pressing <em class="calibre9">Shift</em> + <em class="calibre9">F10</em> or selecting the run icon next to the configuration:</p><div><img src="img/00086.jpeg" alt="Cordova" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">This will start the Cordova build system and run our application in the iOS emulator. We can also see the run <a id="id189" class="calibre1"/>log in the run section:</p><div><img src="img/00087.jpeg" alt="Cordova" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">We are going to create a similar configuration to test our application on the Android platform. Select the <strong class="calibre8">Edit Configuration</strong> menu again.</p><p class="calibre7">With the previous iOS configuration selected, click on the <strong class="calibre8">Copy Configuration</strong> icon to duplicate it. In the newly-created configuration, change the name to <code class="email">Android</code> and the <strong class="calibre8">Platform</strong> to <strong class="calibre8">android</strong>.</p><div><img src="img/00088.jpeg" alt="Cordova" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">We have now created a <a id="id190" class="calibre1"/>configuration to test our application on the Android emulator. To run the application, press <em class="calibre9">Shift</em> + <em class="calibre9">F10</em>, or press the run icon. This starts the application, using the Android emulator this time.</p><div><img src="img/00089.jpeg" alt="Cordova" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">We have now created a <a id="id191" class="calibre1"/>simple app that waits for the device-ready event, and renders a simple screen changing the state when the device is ready. We are now going to build a more complex application using PhoneGap, since the differences between the frameworks are minimal.</p></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec39" class="calibre1"/>PhoneGap</h1></div></div></div><div><table border="0" cellspacing="0" cellpadding="0" class="blockquote1" summary="Block quote"><tr class="calibre16"><td valign="top" class="calibre17"> </td><td valign="top" class="calibre17"><p class="calibre18"><em class="calibre19">Easily create apps using the web technologies you know and love: HTML, CSS, and JavaScript PhoneGap is a free and open source framework that allows you to create mobile apps using standardized web APIs for the platforms you care about.</em></p></td><td valign="top" class="calibre17"> </td></tr><tr class="calibre16"><td valign="top" class="calibre17"> </td><td colspan="2" valign="top" class="calibre20">--<a class="ulink" href="http://phonegap.com/">http://phonegap.com/</a></td></tr></table></div><p class="calibre7">PhoneGap is a <a id="id192" class="calibre1"/>distribution of Apache Cordova; so, the engine behind it is Cordova, but you have access to more tools such as the Developer App or remote builds.</p><p class="calibre7">Before we start, we <a id="id193" class="calibre1"/>need to install the framework globally, and restart WebStorm to pick it up. To do that, execute the following command:</p><div><pre class="programlisting">
<strong class="calibre8">npm install -g phonegap</strong>
</pre></div><p class="calibre7">To start a new project based on PhoneGap, select <strong class="calibre8">New Project</strong> from either the welcome screen or the <strong class="calibre8">File</strong> menu, and select <strong class="calibre8">PhoneGap/Cordova App</strong> as the template. Insert the destination folder, and select the path to the newly installed PhoneGap CLI:</p><div><img src="img/00090.jpeg" alt="PhoneGap" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">This creates and opens a new project based on the PhoneGap framework. This project comes with an example page that we are going to extend.</p><p class="calibre7">Before moving further, we <a id="id194" class="calibre1"/>need to change the <strong class="calibre8">minSdkVersion</strong> in the <strong class="calibre8">config.xml</strong> file to <strong class="calibre8">10</strong>. We do this, because, by default, Android Studio doesn't download the SDK for the old API versions, and we don't want to target the old version of Android.</p><p class="calibre7">To open the file, press <em class="calibre9">⌘</em> + <em class="calibre9">Shift</em> + <em class="calibre9">N</em>, start typing the file name (<code class="email">config.xml</code>), and then select it. Once you have the file open, you can press <em class="calibre9">⌘</em> + <em class="calibre9">F</em>, and a search dialog will appear at the top of the page where we can type the <code class="email">android-minSdkVersion</code> to find the fragment in the code.</p><div><img src="img/00091.jpeg" alt="PhoneGap" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">Since our app uses the location, we need to add <code class="email">cordova-plugin-geolocation</code> to the <code class="email">config.xml</code> file so that PhoneGap downloads and installs it.</p><div><pre class="programlisting">&lt;plugin name="cordova-plugin-geolocation" version="1" /&gt;</pre></div><p class="calibre7">Now, following the steps given in the previous section, we are going to create a run configuration for iOS and Android to test our application on both platforms.</p><p class="calibre7">In this section, we will create <a id="id195" class="calibre1"/>the map example from the first chapter, but this time as a mobile application.</p><p class="calibre7">Since our app uses jQuery, we need to download and copy it to the <code class="email">JS</code> folder, and then load it in the <code class="email">index.html</code> file. Load the following script between the <code class="email">cordova.js</code> and <code class="email">index.js</code> files:</p><div><pre class="programlisting">&lt;script type="text/javascript" src="img/jquery-1.11.3.min.js"&gt;&lt;/script&gt;</pre></div><p class="calibre7">After the app <code class="email">&lt;div&gt;</code>, create a new <code class="email">&lt;div&gt;</code> container for the map, as follows:</p><div><pre class="programlisting">&lt;div id="map"&gt;&lt;/div&gt;</pre></div><p class="calibre7">We also need to add the following styles to the <code class="email">index.css</code> file:</p><div><pre class="programlisting">html, body{
    width: 100%;
    height: 100%;
}

#map{
    display: none;
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
}</pre></div><p class="calibre7">Now load the Google Maps API. Since the API is an external resource that will be downloaded, we will load it only once the device is ready and connected to the Internet. So open the <code class="email">index.js</code> file, and add the following code inside the <code class="email">onDeviceReady</code> handler:</p><div><pre class="programlisting">onDeviceReady: function () {
    app.receivedEvent('deviceready');document.addEventListener("online", app.loadGoogleMapsAPI, false);
    document.addEventListener("resume", app.loadGoogleMapsAPI, false);
    app.loadGoogleMapsAPI();
},</pre></div><p class="calibre7">This will listen for when the <a id="id196" class="calibre1"/>device is online, and trigger the <code class="email">loadGoogleMapsAPI</code> function that we are going to define next:</p><div><pre class="programlisting">// Load the Maps API if it wasn't loaded before loadGoogleMapsAPI: function () {
    if (window.google !== undefined &amp;&amp; window.google.maps) {
        return;
    }
    // load maps api
    $.getScript('https://maps.googleapis.com/maps/api/js?sensor=true&amp;callback=app.onMapsApiLoaded');
},</pre></div><p class="calibre7">The preceding function checks whether the API is loaded or not; if not, it loads it using jQuery's <code class="email">getScript</code> method. Considering that the API was loaded asynchronously, we need to use the callback to pass as a query string parameter to the script.</p><p class="calibre7">Now we will create the <code class="email">onMapsApiLoaded</code> callback function, where we get the device location. We are also going to watch for any changes in the location and read the location:</p><div><pre class="programlisting">// Get the location after we have the maps api// Get the default location and also watch for any changes in the location
onMapsApiLoaded: function(){
    navigator.geolocation.getCurrentPosition(app.geolocationSuccess, app.geolocationError, app.geolocationOptions);navigator.geolocation.watchPosition(app.geolocationSuccess, app.geolocationError, app.geolocationOptions);
},</pre></div><p class="calibre7">For the location method, we have to create two callback functions and a configuration object. We will use the default location if there is an error while loading the location:</p><div><pre class="programlisting">// Load the map with the device positongeolocationSuccess: function(position){
    app.position = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
    app.updatePosition();

},
// If we don't have a position from the device, we are going to use // some default values
geolocationError: function(error){
    if(!app.pos){app.defaultPosition = new google.maps.LatLng(51.5, -0.1);
        app.updatePosition();
    }
},
// Settings object for the geolocationgeolocationOptions: {
    maximumAge: 3000,
    timeout: 5000,
    enableHighAccuracy: true
},</pre></div><p class="calibre7">Once we have the location <a id="id197" class="calibre1"/>from the device or the default one, we can create and update the map.</p><div><pre class="programlisting">// Show the map and update the positionupdatePosition: function(pos){
    $('.app').hide();
    $('#map').show();
    var mapOptions = {
        zoom: 10
    };
    var pos = app.position || app.defaultPosition;
    var map = new google.maps.Map(document.getElementById('map'), mapOptions);
    var infowindow = new google.maps.InfoWindow({
        map: map,
        position: pos,
        content: 'I am here!'
    });
    map.setCenter(pos);
},</pre></div><p class="calibre7">This will hide the initial screen, create the map, and update our position on it.</p><p class="calibre7">Now, if we follow the steps from the previous example for running the application in the iOS emulator, we will see the following screen:</p><div><img src="img/00092.jpeg" alt="PhoneGap" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">If we run the application in <a id="id198" class="calibre1"/>the Android emulator, we will get a similar screen:</p><div><img src="img/00093.jpeg" alt="PhoneGap" class="calibre10"/></div><p class="calibre11"> </p></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec40" class="calibre1"/>The Ionic framework</h1></div></div></div><div><table border="0" cellspacing="0" cellpadding="0" class="blockquote1" summary="Block quote"><tr class="calibre16"><td valign="top" class="calibre17"> </td><td valign="top" class="calibre17"><p class="calibre18"><em class="calibre19">Create incredible apps.</em></p><p class="calibre18"><em class="calibre19">Iconic is the beautiful, open source front-end SDK for developing hybrid mobile apps with web technologies.</em></p></td><td valign="top" class="calibre17"> </td></tr><tr class="calibre16"><td valign="top" class="calibre17"> </td><td colspan="2" valign="top" class="calibre20">--<a class="ulink" href="http://ionicframework.com/">http://ionicframework.com/</a>
</td></tr></table></div><p class="calibre7">Ionic is a <a id="id199" class="calibre1"/>framework that focuses on the look, feel, and UI interactions. It is not a replacement for PhoneGap or Cordova, but an addition to these. It can be viewed as the Bootstrap for mobile development, since it is a collection of CSS styles and Angular JavaScript components.</p><p class="calibre7">Before <a id="id200" class="calibre1"/>we start, we need to install the framework globally and restart WebStorm to pick it up. To do that, run the following command:</p><div><pre class="programlisting">
<strong class="calibre8">npm install -g ionic</strong>
</pre></div><p class="calibre7">Once we have installed the application, we need to restart WebStorm so that it can pick up the framework, and start <a id="id201" class="calibre1"/>a new project selecting the <strong class="calibre8">PhoneGap/Cordova App</strong> template and using the newly-installed Ionic CLI as the project compiler:</p><div><img src="img/00094.jpeg" alt="The Ionic framework" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">After the project is created, we need to create the run configuration for both iOS and Android in the same way that we did for the previous projects; so, create the configuration following the steps from the previous section.</p><p class="calibre7">Since Ionic comes with a sample project, we can readily test the created project on the emulator.</p><div><img src="img/00095.jpeg" alt="The Ionic framework" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">This framework will <a id="id202" class="calibre1"/>create a more complex application with a built-in navigation that will allow us to see more screens.</p><div><img src="img/00096.jpeg" alt="The Ionic framework" class="calibre10"/></div><p class="calibre11"> </p></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec41" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">In this chapter, you have learned how to use web technologies to create native mobile applications, and how WebStorm assists us in doing so: from creating projects quickly using templates to managing the run configurations.</p><p class="calibre7">In the next chapter, we are going to see how WebStorm can help us in analyzing and debugging our code.</p></div></body></html>