<html><head></head><body><div><div><div><div><h1 class="title"><a id="appB"/>Appendix B. InstallingShareKit 2.0</h1></div></div></div><p>It's astonishing, quite frankly, that there's no system-defined framework on iOS that enables easy sharing across many different services. iOS 5 does provide the Twitter framework, and iOS 6 expands on it by providing the Facebook framework, but there's no system-defined framework that you can use to easily share to a wider variety of services. Maybe iOS 7 will address that need but don't hold your breath.</p><p>Thankfully, there is an open source framework called ShareKit that helps to address this. It gives us an easy way to share to any number of services (assuming one has API keys for each), and it's not hard to call from PhoneGap. Unfortunately, installing it is also a royal pain.</p><p>We've listed the steps that <a id="id1083" class="indexterm"/>
<a id="id1084" class="indexterm"/>worked for us as follows. Some of these steps come from ShareKit's Wiki at <a class="ulink" href="https://github.com/ShareKit/ShareKit/wiki/Installing-sharekit">https://github.com/ShareKit/ShareKit/wiki/Installing-sharekit</a>, so it would be a good idea to refer to that document as well.</p><div><ol class="orderedlist arabic"><li class="listitem">You need to get the ShareKit files. ShareKit recommends using Git to do this, or you can use our copy – it is your option. Frankly, it will be easier to use the copy in the <code class="literal">Submodules</code> directory<a id="id1085" class="indexterm"/> in our code package. It won't be the latest version of ShareKit, but it has the required source code changes to work.</li><li class="listitem">Add ShareKit to the project using the following steps:<div><ol class="orderedlist lowerroman"><li class="listitem">Navigate to <code class="literal">Submodules/ShareKit</code> and drag <code class="literal">ShareKit.xcodeproj</code> to your project as shown in the following screenshot:</li></ol></div><div><img src="img/9403_B_01.jpg" alt="InstallingShareKit 2.0"/></div></li><li class="listitem">We need to make <a id="id1086" class="indexterm"/><a id="id1087" class="indexterm"/>various adjustments to permit ShareKit to compile:<div><ol class="orderedlist lowerroman"><li class="listitem">Go to your project's settings, click on <strong>Build Phases</strong>, and expand <strong>Target</strong> <strong>Dependencies</strong>. Add the <strong>Static Library (ShareKit)</strong> and <strong>Resource Bundle</strong> <strong>(ShareKit)</strong> dependencies as shown in the following screenshot:<div><img src="img/9403_B_02.jpg" alt="InstallingShareKit 2.0"/></div></li><li class="listitem">Expand <strong>Link Binary With Libraries</strong> and add <strong>libShareKit.a</strong> as shown in the following screenshot:<div><img src="img/9403_B_03.jpg" alt="InstallingShareKit 2.0"/></div></li><li class="listitem">Expand <a id="id1088" class="indexterm"/><a id="id1089" class="indexterm"/><strong>Copy Bundle Resources</strong> and copy Sharekit's resource bundle (located in the ShareKit subproject under the <code class="literal">Products</code> folder and named <code class="literal">ShareKit.bundle</code>) to the list as shown in the following screenshot:</li></ol></div><div><img src="img/9403_B_04.jpg" alt="InstallingShareKit 2.0"/></div></li><li class="listitem">Next we need to adjust the header search paths and linker flags:<div><ol class="orderedlist lowerroman"><li class="listitem">Switch to <strong>Build Settings</strong>.</li><li class="listitem">Search for <code class="literal">user header</code>.</li><li class="listitem">Double-click the row named <strong>User Header Search Paths</strong>.</li><li class="listitem">Add <strong>Submodules</strong> and check the checkbox next to the new entry. It should look like <strong>Submodules/**</strong> as seen in the following screenshot:<div><img src="img/9403_B_05.jpg" alt="InstallingShareKit 2.0"/></div></li><li class="listitem">Now<a id="id1090" class="indexterm"/><a id="id1091" class="indexterm"/> search for <code class="literal">other linker</code>.</li><li class="listitem">Double-click the row named <strong>Other Linker Flags</strong>.</li><li class="listitem">Add <code class="literal">-all_load </code>and, on a separate line, <code class="literal">-ObjC</code>, if not already present as shown in the following screenshot:</li></ol></div><div><img src="img/9403_B_06.jpg" alt="InstallingShareKit 2.0"/></div></li><li class="listitem">We need to add the various Apple Frameworks this plugin requires:<div><ol class="orderedlist lowerroman"><li class="listitem">Go back to the <strong>Summary</strong> tab.</li><li class="listitem">Scroll down to <strong>Linked Libraries and Frameworks</strong>.</li><li class="listitem">Add <code class="literal">SystemConfiguration.framework</code>, <code class="literal">Security.framework</code>, <code class="literal">MessageUI.framework</code>, <code class="literal">CFNetwork.framework</code> (required for Flickr sharing), <code class="literal">CoreLocation.framework </code>(Required for FourSquare sharing), <code class="literal">Twitter.Framework</code> and <code class="literal">CoreFoundation.framework</code>.</li><li class="listitem">Make <code class="literal">CoreFoundation.framework</code> <strong>Optional</strong> as shown in the following screenshot:</li></ol></div><div><img src="img/9403_B_07.jpg" alt="InstallingShareKit 2.0"/></div></li></ol></div><p>At this point you should <a id="id1092" class="indexterm"/>
<a id="id1093" class="indexterm"/>be able to build the project with no errors.</p><div><div><h3 class="title"><a id="tip06"/>Tip</h3><p>You may receive an error regarding a failure to find a protocol definition if you aren't using our copy of ShareKit. This occurs on the Flickr code; to get rid of the error, just remove<a id="id1094" class="indexterm"/> <code class="literal">OFFlickrAPIRequestDelegate</code>, on the line causing the error. Since we don't use Flicker in the examples, this won't cause a problem. (It might, however, should you decide to use Flickr in the future.)</p></div></div><p>We need to obtain API keys for the services we intend on using. In our project, we used Twitter, Facebook, and ReadItLater (now Pocket). You're free to use whatever services you would like but you must use your own API keys to do so. (Our code package does not provide you with API keys.) Visit <a class="ulink" href="https://github.com/ShareKit/ShareKit/wiki/3rd-party-api-links">https://github.com/ShareKit/ShareKit/wiki/3rd-party-api-links</a> for some good information about how to obtain these keys. Please refer the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">We have to configure ShareKit 2.0 with these keys so create a new file in XCode and set it to subclass <code class="literal">DefaultSHKConfigurator</code>. We used <code class="literal">MySHKConfiguration</code> for the name, but you can use whatever you like. Be sure to save this new file to your project and not the subproject.</li><li class="listitem">Look at ShareKit | Classes | ShareKit | Sharers | Configuration | DefaultSHKConfigurator.m for the methods you can override. Each of these is labeled with comments indicating the code specific to each social networking service.</li><li class="listitem">Copy the code <a id="id1095" class="indexterm"/><a id="id1096" class="indexterm"/>you need to override and paste it into your own <code class="literal">configurator</code> file.</li><li class="listitem">Alter each method to return the appropriate API key, secret, or other string. Here's an example:<div><pre class="programlisting">- (NSString*)appName {
  return @"Socializer";
}

- (NSString*)appURL {
  return @"http://www.example.com";
}

- (NSString*)facebookAppId {
  return @"122308337901327";
}

- (NSString*)facebookLocalAppId {
  return @"";
}

- (NSArray*)facebookListOfPermissions {    
    return [NSArray arrayWithObjects:@"publish_stream", @"offline_access", nil];
}

- (NSString*)readItLaterKey {
  return @"apikey";
}
// Twitter - http://dev.twitter.com/apps/newhttp://dev.twitter.com/apps/new
- (NSNumber*)forcePreIOS5TwitterAccess {
  return [NSNumber numberWithBool:true];
}

- (NSString*)twitterConsumerKey {
	return @"apikey";
}

- (NSString*)twitterSecret {
  return @"apikey";
}
// You need to set this if using OAuth, see note above (xAuth users can skip it)
- (NSString*)twitterCallbackUrl {
  return @"http://www.example.com/callback";
}
// To use xAuth, set to 1
- (NSNumber*)twitterUseXAuth {
  return [NSNumber numberWithInt:0];
}
- (NSString*)twitterUsername {
  return @"";
}</pre></div></li><li class="listitem">Navigate to your project's <code class="literal">/Classes/AppDelegate.m</code> file and add the following at the end of the <code class="literal">didFinishLaunchingWithOptions:</code> method, just prior to the return statement (assuming your file is named <code class="literal">MySHKConfigurator</code>):<div><pre class="programlisting">DefaultSHKConfigurator *configurator = [[MySHKConfigurator alloc] init]; 
[SHKConfiguration sharedInstanceWithConfigurator:configurator];</pre></div></li><li class="listitem">Also add the following code to the import section:<div><pre class="programlisting">#import "SHK.h"
#import "SHKConfiguration.h"
#import "MySHKConfiguration.h"
#import "SHKFacebook.h"</pre></div></li><li class="listitem">Next, we <a id="id1097" class="indexterm"/><a id="id1098" class="indexterm"/>need to enable offline sharing (optional):<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Add <code class="literal">[SHK flushOfflineQueue];</code> just below our newly added code in the last step.</li></ul></div></li><li class="listitem">If you're supporting Facebook, you need to support Single Sign On (SSO):<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Add the following code at the end of the <code class="literal">handleOpenURL:</code> method in <code class="literal">AppDelegate.m</code> (replacing the <code class="literal">return YES;</code> statement):<div><pre class="programlisting">    return [self handleOpenURL:url];  
}

- (BOOL)handleOpenURL:(NSURL*)url
{
  NSString* scheme = [url scheme];
  NSString* prefix = [NSString stringWithFormat:@"fb%@", SHKCONFIG(facebookAppId)];
  if ([scheme hasPrefix:prefix])
  return [SHKFacebook handleOpenURL:url];
  return YES;
}

- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation 
{
  return [self handleOpenURL:url];
}</pre></div></li><li class="listitem" style="list-style-type: disc">Add a custom URL scheme to your project's <code class="literal">info.plist</code> file:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Add <strong>URL Types</strong></li><li class="listitem" style="list-style-type: disc">Add <strong>Item 0</strong></li><li class="listitem" style="list-style-type: disc">Add <strong>URL Schemes</strong></li><li class="listitem" style="list-style-type: disc">Add <strong>Item 0</strong> with a value of "<code class="literal">fb</code>" and your app ID from Facebook</li></ul></div></li></ul></div><div><img src="img/9403_B_10.jpg" alt="InstallingShareKit 2.0"/></div></li></ol></div><p>To determine how <a id="id1099" class="indexterm"/>
<a id="id1100" class="indexterm"/>your <code class="literal">AppDelegate.m</code> file should look when complete, verify your file against ours in the downloadable code package.</p><p>We're almost done; all we need now is to indicate which social networks we don't support:</p><div><ol class="orderedlist arabic"><li class="listitem">COPY the <code class="literal">SHKSharers.plist</code> file from the <code class="literal">ShareKit</code> subproject into your project. Be sure to name it something different, like <code class="literal">MySHKSharers.plist</code>.</li><li class="listitem">Remove the rows corresponding to the networks you don't support. Here's an example of ours:<div><img src="img/9403_B_11.jpg" alt="InstallingShareKit 2.0"/></div></li><li class="listitem">Add the following code to the end of your <code class="literal">configurator</code> file:<div><pre class="programlisting">- (NSString*)sharersPlistName {
	return @"MySHKSharers.plist";
}</pre></div></li></ol></div><p>At this point, you should <a id="id1101" class="indexterm"/>
<a id="id1102" class="indexterm"/>have the ShareKit framework integrated into your project. You'll want to refer to <a class="link" href="ch02.html" title="Chapter 2. Let's Get Social!">Project 2</a>, <em>Let's Get Social!</em> to finish integrating it with the ShareKit PhoneGap plugin.</p><p>I wish I could give you more to watch out for regarding build errors. Unfortunately, every time I do this, I seem to come across new errors I hadn't seen the time before. (The Flickr error previously in this document is a good example!) It usually takes a cross-your-fingers-and-hope methodology to fix these kinds of errors (such as my removal of the protocol causing the error), but removing the error itself might not always work. If you have problems, it would be a good idea to ask the PhoneGap community or the ShareKit community if they have any suggestions.</p></div></body></html>