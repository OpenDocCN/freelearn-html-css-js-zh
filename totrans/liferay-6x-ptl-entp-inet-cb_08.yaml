- en: Chapter 8. Search and Content Presentation Tools
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Tagging and categorizing content
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Asset Publisher as a search-based tool for content presentation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Defining application display templates for Asset Publisher
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Search portlet – basic configuration
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Solr installation and configuration
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Liferay provides a powerful built-in tool that allows us to search for content.
    This is one of the most important functionalities in Liferay. Why? The answer
    is simple: searching is needed everywhere. It is not possible to find or locate
    an article, wiki, or document in the tangle of content without a good search engine.
    Liferay architecture provides a useful tool to index, search, and display such
    documents as faceted results. Faceted means grouped by a specific thematic category,
    grouped by a specific entity type, or other such criteria.'
  prefs: []
  type: TYPE_NORMAL
- en: In fact, there is a whole bunch of search functionalities in Liferay. It is
    possible to find entities using SQL queries as well as using a dedicated search
    engine called Apache Lucene ([http://lucene.apache.org](http://lucene.apache.org)).
    In many places (especially in the configuration or in the control panel), Liferay
    finds entities using SQL queries. On the other hand, Portal provides a dedicated
    portlet called Search Portlet, which allows us to search using the Lucene engine.
  prefs: []
  type: TYPE_NORMAL
- en: Tagging and categorizing content
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Categories and tags provide a powerful mechanism to mark, list, and search
    different assets and allow their subsequent selection with the help of dedicated
    portlets such as Category Navigation, Asset Publisher, or Tag Cloud. The mechanism
    is very simple: tags and categories are assigned to web contents, documents, or
    other types of assets. Then, it is possible to set portlets to present only those
    assets with a specific category and/or tags. It is possible to assign one or more
    categories and/or tags to an asset.'
  prefs: []
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Categories and tags can be assigned to any asset while adding or editing this
    asset. For instance, as was shown in the previous chapters ([Chapter 6](part0050.xhtml#aid-1FLS41
    "Chapter 6. Documents and Media in Liferay"), *Documents and Media in Liferay*
    and [Chapter 7](part0055.xhtml#aid-1KEEU1 "Chapter 7. Working with Content"),
    *Working with Content*), a new (and edited) web content or a new (and edited)
    document form provides a categorization section. This section allows us to choose
    the set of categories and define the list of tags that will be assigned to a document
    or web content after submitting the form. However, what is important to know is
    that the process of assigning is different for categories and tags. Tags can be
    defined directly in the content adding form, while categories must be created
    in site administration to make it available for assigning.
  prefs: []
  type: TYPE_NORMAL
- en: 'Categories are stored in vocabularies. In order to create a category, you have
    to first create a vocabulary using the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in as an administrator and go to **Admin** | **Site Administration** | **Content**
    | **Categories**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Add Vocabulary** button.![How to do it…](img/image00353.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a **Name** and **Description** for a new vocabulary.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enable the **Allow Multiple Categories** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Set **All Asset Types** in the **Choose Asset Type** drop-down list.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enable the **Required** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Determine **Permissions** for the vocabulary by setting all actions that may
    be performed by specific roles (you can find more permissions after clicking on
    the **More Options** link).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Save** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'When **Vocabulary** is ready, it is possible to fill it with **Categories**.
    To add a category, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in as an administrator and go to **Admin** | **Site Administration** | **Content**
    | **Categories**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Add Category** button.![How to do it…](img/image00354.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a **Name** and **Description** for the new category.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: From the **To Vocabulary** drop-down list, choose the vocabulary you want to
    create a category in.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Determine **Permissions** for the category by setting all actions that may be
    performed by specific roles (you can find more permissions after clicking on the
    **More Options** link).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Save** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'After creating a category, it is possible to assign it to the asset. Let''s
    assign the previously created category to an existing web content using the following
    steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in as an administrator and go to **Admin** | **Site Administration** | **Content**
    | **Web Content**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the name of one already existing web content.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to the **Categorization** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Select** button located near the name of the vocabulary you want
    to assign a category from.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Mark the category or categories you want to choose and close the window.![How
    to do it…](img/image00355.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Publish** button to save the changes of the web content.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Unlike categories, tags do not require to be created before entering the **Categorization**
    section of the add/edit asset form. You can create a tag and assign it in one
    task using the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in as an administrator and go to **Admin** | **Site Administration** | **Content**
    | **Web Content**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the name of one already existing web content.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to the **Categorization** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Type a tag in the **Tags** field.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **+Add** button or press the *Enter* button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: You can add more than one tag by typing the whole list of tags in the **Tags**
    field and separating them by commas.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![How to do it…](img/image00356.jpeg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Click on the **Publish** button to save the changes of the web content.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'It is also possible to define a list of tags in the **Site Administration**
    section to make it available for later use to users who create web contents, documents,
    and other types of assets. To define a tag, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in as an administrator and go to **Admin** | **Site Administration** | **Content**
    | **Tags**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Add Tag** button.![How to do it…](img/image00357.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a **Name** for the tag.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Save** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'To assign an already existing tag, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in as an administrator and go to **Admin** | **Site Administration** | **Content**
    | **Web Content**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the name of one already existing web content.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Navigate to the **Categorization** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Select** button located under the **Tags** field.![How to do
    it…](img/image00358.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Mark the tag or tags you want to choose.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: You can also choose an existing tag by typing its name (the autocomplete function
    will help find existing tags) and pressing the *Enter* button.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Click on the **Publish** button to save the changes of the web content.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Both categories and tags are managed using tools available in the **Site Administration**
    section and assigned to assets using assets add/edit forms (a new web content
    form, an edit web content form, a new document form, edit document form, and so
    on). When provided with categories and/or tags, each asset can be chosen by a
    specific portlet (such as Asset Publisher) and displayed on a page.
  prefs: []
  type: TYPE_NORMAL
- en: Categories
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Categories are stored in vocabularies, and they form a tree-like structure—each
    category can have subcategories. All the categories available within the site
    can be managed by going to **Admin** | **Site Administration** | **Content** |
    **Categories**. This section allows us to create, edit, and delete vocabularies
    and categories.
  prefs: []
  type: TYPE_NORMAL
- en: Each vocabulary is identified by its name, and it can be provided with a description.
    Vocabularies can be set to work with all or just one specific asset (choose the
    **Asset Type** option). For instance, it is possible to create a vocabulary where
    categories can be assigned to web content only. Such vocabulary will not be available
    in other assets adding and editing forms.
  prefs: []
  type: TYPE_NORMAL
- en: While creating vocabulary, we can decide whether, while assigning categories
    to an asset, users have to assign at least one of its categories (the **Required**
    option) or whether they may use more than one category from this particular vocabulary
    (the **Allow Multiple Categories** option).
  prefs: []
  type: TYPE_NORMAL
- en: Categories are identified by their names, and they can be provided with descriptions.
    It is also possible to set permissions for both vocabularies and categories.
  prefs: []
  type: TYPE_NORMAL
- en: Tags
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Tags, on the contrary, are not stored in vocabularies, but they build a flat
    structure. All the tags assigned to assets within the site can be accessed by
    going to **Admin** | **Site Administration** | **Content** | **Tags**. The **Tags**
    section allows us to add, edit, delete, or merge tags. Unlike categories, tags
    can be created while assigning them to the asset.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'For information about managing web content and files, refer to the following
    recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: The *Managing files in Liferay using Documents and Media portlet* recipe in
    [Chapter 6](part0050.xhtml#aid-1FLS41 "Chapter 6. Documents and Media in Liferay"),
    *Documents and Media in Liferay*
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The *Managing and displaying web content* recipe in [Chapter 7](part0055.xhtml#aid-1KEEU1
    "Chapter 7. Working with Content"), *Working with Content*
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Asset Publisher as a search-based tool for content presentation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Asset Publisher is a very complex and highly configurable portlet that allows
    us to present web content folders, web contents, document folders, documents,
    message board messages, bookmark folders, bookmark entries, blog entries, calendar
    events, and wiki pages on the page. Assets that are presented by a specific Asset
    Publisher may be chosen manually by authorized users or automatically based on
    the configured rules.
  prefs: []
  type: TYPE_NORMAL
- en: In this recipe, we will show you how to configure Asset Publisher to present
    web content using both manual and dynamic asset selection variants.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To step through this recipe, you will have to add a vocabulary containing News
    category and create a web content.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Let''s assume that each week, on the main page of our intranet, we have to
    publish up to five of the most important news items chosen by employees responsible
    for news publishing. Such news can be displayed by the Asset Publisher portlet
    that is configured to list manually chosen web content articles. To configure
    such an Asset Publisher portlet, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in as an administrator and go to the page on which you want to configure
    a new **Asset Publisher**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the add icon (this is a **+** sign on the left side).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Applications** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Find the **Asset Publisher** portlet using the search feature or by browsing
    the list of available portlets.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Add** link located next to the Asset Publisher (the link appears
    when you hover over the portlet name).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the options icon of the newly added portlet (this will be a gear icon
    in the top-right corner of the portlet).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the **Configuration** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the **Manual** option from the **Asset Selection** section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Select** button in the **Asset Entries** section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the **Web Content Article** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Choose** button next to the web content you want to choose.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: Repeat steps 9–11 as many times as needed to create the desired list of news.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![How to do it…](img/image00359.jpeg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Click on the **Save** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Close the pop-up window by clicking on the **x** button. The Asset Publisher
    portlet you have just configured will present only the list of chosen web contents.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It is also possible to set Asset Publisher to automatically choose news articles
    based on a specified category (in our example, we will use the **News** category).
  prefs: []
  type: TYPE_NORMAL
- en: 'In order to change the Asset Publisher configuration to present only web content
    articles with the **News** category, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on the options icon of the previously added portlet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the **Configuration** option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the **Dynamic** option from the **Asset Selection** section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the **Web Content Article** option from the **Asset Type** list.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Set the **Contain any of the following categories** rule in the **Filters**
    section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Select** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Mark the **News** category and close the window.![How to do it…](img/image00360.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Set **Order by fields** to **Publish Date** and **Descending**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Save** button. Close the pop-up window by clicking on the **x**
    button. The Asset Publisher portlet you have just configured will present only
    a list of web contents that contain the **News** category.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Assets that are displayed by the portlet can be chosen manually by the user
    (**Manual Asset Selection**) or automatically, based on the set of rules (**Dynamic
    Asset Selection**). As was shown in the first part of the recipe, **Manual Asset
    Selection** allows us to select any assets corresponding to the type set in the
    **Asset Type** field and available within the scope that the Asset Publisher is
    working in (defined in the **Scope** field).
  prefs: []
  type: TYPE_NORMAL
- en: The scope is a very important parameter, because it defines the place of origin
    of the asset that is displayed by Asset Publisher. Asset Publisher can present
    assets created within **Current Site**, **Global** scope, or any other site chosen
    from the **Other Site** list.
  prefs: []
  type: TYPE_NORMAL
- en: The second part of the recipe provides an example of **Dynamic Asset Selection**,
    where Asset Publisher chooses, from a defined **Scope**, all the assets that comply
    with the defined **Asset Type** and are assigned to categories or tags specified
    in the **Filter** section. It is possible to specify that Asset Publisher should
    list only these assets with an assigned (or without an assigned) category, a set
    of categories, a tag, or set of tags. Additionally, the **Filter** section allows
    us to specify whether the asset must be assigned to all the categories from the
    set (the **All** option) or whether it is enough if at least one category from
    the set is assigned (the **Any** option). For instance, if we would like the Asset
    Publisher portlet to present only the assets that have both News and Sport categories,
    we have to set the **Contains All Categories** rule and choose both News and Sport
    categories from the list. If we would like to list all the assets, except these
    with News category assigned, we have to use the **Does not Contain Any Categories**
    rule and choose the News category from the list.
  prefs: []
  type: TYPE_NORMAL
- en: 'The Asset Publisher portlet provides many configuration options that allow
    us to customize its appearance and available functions. The configuration options
    can be accessed by going to **Asset Publisher** | **Configuration** | **Setup**
    | **Display Settings**. Here is a description of the most important options:'
  prefs: []
  type: TYPE_NORMAL
- en: The **Display Template** option allows us to choose how the asset should be
    displayed (as a Title List, Full Content, Abstract, and so on).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Abstract Length** allows defining the number of characters of text that will
    be displayed as an abstract.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Asset Link Behaviour** defines whether, after clicking the title presented
    on the list, the full content should be displayed.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Number of Items to Display** option defines how many assets will be displayed
    by the Asset Publisher portlet.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Pagination Type** allows us to choose whether, and what type of, pagination
    should be displayed to organize a long lists of assets.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Set as the Default Asset Publisher for This Page** option allows us to
    set this particular Asset Publisher as the one that will be used to present content
    associated to this page. The page with Asset Publisher set as default will be
    available to choose as a display page while adding a new web content.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Enable Print** option enables the print version of the web content.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Enable Flags** option enables the flags functionality, which provides
    a contact form that notifies any irregularities.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Enable Related Assets** option enables the related assets functionality,
    which lists all the assets defined as related in the adding/editing asset form.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Enable Ratings** option enables the functionality that allows us to rate
    the content shown by Asset Publisher.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Enable Comments** option allows us to comment on the assets shown by Asset
    Publisher.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Enable Social Bookmarks** option displays the Google+, Facebook, and Twitter
    sharing buttons.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Choose metadata** option allows us to choose the metadata information
    shown for each asset displayed by the Asset Publisher portlet.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'For information about managing web content and files, refer to the following
    recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: The *Managing files in Liferay using Documents and Media portlet* recipe in
    [Chapter 6](part0050.xhtml#aid-1FLS41 "Chapter 6. Documents and Media in Liferay"),
    *Documents and Media in Liferay*
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The *Managing and displaying web contents* recipe in [Chapter 7](part0055.xhtml#aid-1KEEU1
    "Chapter 7. Working with Content"), *Working with Content*
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Defining application display templates for Asset Publisher
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Since Liferay Version 6.2 is the available option, it allows us to set a new
    display template for Asset Publisher. In real-world applications, it is quite
    a useful and powerful tool that helps define custom display templates for assets,
    such as journal article, blog entry, message board, and so on. For example, you
    may want to display only an asset's descriptions or add selected categories and
    tags.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s assume that we have a use case that describes Asset Publisher view requirements
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Display title
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Display description
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Display selected tags and categories
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Display asset links
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Display Read more link
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In order to define a new display template, log in as an administrator and follow
    these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in as an administrator. Go to **Admin** | **Configuration** and choose **Application
    Display Templates** from the left menu.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Add** button and choose **Asset Publisher Template**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Fill in the form by typing **Name** with the **Intranet template** value and
    choose the **Velocity (.vm)** language.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the script area, write the following code:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Click on the **Save** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a new page and put the Asset Publisher portlet (see the *Asset Publisher
    as a search-based tool for content presentation* recipe from this chapter).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to Asset Publisher configuration and choose the **Display Setting** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Display Template** field, choose the **Intranet** template and click
    on the **Save** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Close the configuration popup. In Asset Publisher view, you should see the new
    template.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In previous Liferay versions, it was not possible to add a new display template
    for Asset Publisher from Control Panel. The only way was to add a new Java Server
    Pages file in the hook plugin. In Liferay 6.2 it is possible to define views as
    a Velocity or Freemarker script under Control Panel. Liferay developers implement
    a powerful editor that helps in creating new templates. Editor specifies the possible
    fields, displays hints, and provides an excellent autocomplete option.
  prefs: []
  type: TYPE_NORMAL
- en: Let's try to understand our script. The first line checks whether there are
    any elements in the entries collection. The `$entries` object is a collection
    of Asset Entry elements, which are selected by a specific criteria from the portlet
    configuration.
  prefs: []
  type: TYPE_NORMAL
- en: The next line iterates over the entries collection and assigns elements to the
    `$curEntry` variable.
  prefs: []
  type: TYPE_NORMAL
- en: The next section displays the title and description. The next three sections
    display tags, categories, and related assets. The last one renders the **Read
    more** option.
  prefs: []
  type: TYPE_NORMAL
- en: The most difficult thing in this process is understanding how each helper and
    util works, which parameters are required, and which ones are not required. Unfortunately,
    there is no easy way to understand it. The only way is to search for help in Liferay
    sources or examples.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In order to learn more about templates, refer to the *Creating a new template*
    recipe in [Chapter 7](part0055.xhtml#aid-1KEEU1 "Chapter 7. Working with Content"),
    *Working with Content*
  prefs: []
  type: TYPE_NORMAL
- en: Search portlet – basic configuration
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Let''s assume that our intranet contains only articles and files that are distributed
    between many folders. Our goal is to configure the Search portlet in order to
    find only this content. However, our search should display the following facets:'
  prefs: []
  type: TYPE_NORMAL
- en: Asset type facet
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Asset tag and asset category facet
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: User facet
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Time facet
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Getting ready…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To start our journey with searching, our Liferay instance should have some content,
    such as journal articles, files and folders, users, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In order to properly configure the Search portlet using a basic configuration,
    follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in as an administrator.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create the search page with one column template.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to the **Search** page.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Applications** tab on the left site.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Find the **Search** portlet by scrolling or writing inside the text search field.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Add** button or drag and drop the portlet in the correct place
    on the layout.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to the **Configuration** mode of the portlet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Make sure the following options are selected:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Basic Display Settings**'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Display Asset Type facet**'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Display Asset Tags facet**'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Display Asset Categories facet**'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Display folder facet**'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**View in context** in the **Other Settings** section'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Leave the **Spell check** settings as the default configuration.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Save** button and close the popup.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Try typing your keyword in the search form and press *Enter*. Liferay should
    display the following results:![How to do it…](img/image00361.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Liferay provides a built-in search system based on Lucene. Every entity in Liferay
    (for instance, web content, document library file entry, blog, message board,
    and so on) has its own `Indexer` class. This class is responsible for parsing
    contents and putting them into the search index. When a user uses the search portlet
    and types a specific keyword, the search engine looks for results in the index.
  prefs: []
  type: TYPE_NORMAL
- en: The Lucene engine has its own query syntax to query its indexes. Accordingly,
    the Lucene index looks like a map with keys and values. If users ask about a specific
    keyword, a query is generated in the background. To browse the Lucene index, there
    is a tool called Luke ([https://code.google.com/p/luke](https://code.google.com/p/luke)).
  prefs: []
  type: TYPE_NORMAL
- en: There's more…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'When we analyze results that the Search Portlet displays, we notice that there
    are many unnecessary entries, such as users, message boards, and so on. Our assumption
    was to present web content and document library entities only. Furthermore, we
    want to disable unused facets such as folder facets. To achieve this result, it
    is required that you change the faceting configuration. Follow these steps to
    modify the faceted search:'
  prefs: []
  type: TYPE_NORMAL
- en: Go to the configuration mode of the search portlet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Check on the **Advanced** option in the **Display Settings** section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Modify the JSON search configuration. Change the value node using the following
    lines:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Remove any unnecessary facets:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Click on the **Save** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Close the popup, perform the same search you did earlier, and look out for the
    differences.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'For information about managing web content and files, refer to the following
    recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: The *Managing files in Liferay using Documents and Media portlet* recipe in
    [Chapter 6](part0050.xhtml#aid-1FLS41 "Chapter 6. Documents and Media in Liferay"),
    *Documents and Media in Liferay*
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The *Managing and displaying web contents* recipe in [Chapter 7](part0055.xhtml#aid-1KEEU1
    "Chapter 7. Working with Content"), *Working with Content*
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For information about tagging and categorizing, refer to the *Tagging and categorizing
    content* recipe in this chapter
  prefs: []
  type: TYPE_NORMAL
- en: Solr installation and configuration
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Apache Solr ([http://lucene.apache.org/solr](http://lucene.apache.org/solr))
    is a powerful search engine built on Apache Lucene. In fact, Apache Solr is a
    standalone enterprise search server with a REST API. The main advantage of this
    solution is that it can be easily installed as a cloud. Apache Solr has many other
    advantages, such as high traffic volume optimization, administration interfaces,
    easy monitoring, high scalability and fault tolerance, and more. Refer to the
    official site at [http://lucene.apache.org/solr/features.html](http://lucene.apache.org/solr/features.html)
    to read about these features.
  prefs: []
  type: TYPE_NORMAL
- en: Apache Solr supports both a schema mode as well as a schema-free one. The schema
    is a place where you build an index and define fields that consist of it. The
    schema-free mode allows users to rapidly construct an effective schema by simply
    indexing sample data, without having to manually edit the schema. The Liferay
    plugin called `solr4-web` provides schema and Solr configuration. Thus, we will
    use this configuration to run Solr in a defined schema mode.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this recipe, we will show you the simplest way to install and run the Solr
    server with Liferay.
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we need to install Apache Solr 4\. The newest Solr 4 version is 4.10.4\.
    Follow these steps to run Solr with the Liferay schema and configuration:'
  prefs: []
  type: TYPE_NORMAL
- en: Download the Apache Solr 4 version (4.10.4) bundled with Jetty from the official
    site at [http://archive.apache.org/dist/lucene/solr/](http://archive.apache.org/dist/lucene/solr/).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Unpack `solr-4.10.4.tgz` on your local machine:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Download `solrconfig.xml` and `schema.xml` from the official Liferay repository
    at [https://github.com/liferay/liferay-plugins/tree/6.2.x/webs/solr4-web/docroot/WEB-INF/conf](https://github.com/liferay/liferay-plugins/tree/6.2.x/webs/solr4-web/docroot/WEB-INF/conf).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Copy `solrconfig.xml` and `schema xml` to `solr-4.10.3/example/solr/collection1/conf`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Run Apache Solr:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Solr should print the following message:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`Waiting to see Solr listening on port 8983 [/]`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`Started Solr server on port 8983 (pid=2821). Happy searching!`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: In the Liferay instance, install the `solr4-web` plugin from the marketplace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Edit the `tomcat-7.0.42/webapps/solr4-web/WEB-INF/classes/META-INF/solr-spring.xml`
    file and change the `url` property in the `com.liferay.portal.search.solr.server.BasicAuthSolrServer`
    bean:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Restart the Liferay instance.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Log in as administrator to the Liferay Portal.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to **Admin** | **Control Panel** | **Server Administration** and click on
    the **Execute** button in the **Reindex all search indexes** section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the frontend, add the **Search** page with the **Search** portlet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Find your data by typing keywords in the **Search** portlet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Apache Solr is a powerful search engine with many configuration files. In order
    to run Apache Solr and Liferay, we need to override two files: `schema.xml` and
    `solrconfig.xml`.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The first file defines fields and field types that are available in Liferay.
    The `schema.xml` file has two sections: `types` and `fields`.'
  prefs: []
  type: TYPE_NORMAL
- en: '`The Types` section defines all the possible field types, for instance, Boolean,
    integer, float, double, and so on. The most important field is text, which is
    defined as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'Let''s try analyzing this definition:'
  prefs: []
  type: TYPE_NORMAL
- en: The first line of this definition contains the name of the field type called
    `text` with the `solr.TextField` implementing class. The `solr.` prefix is shorthand
    for `org.apache.solr.schema` in this case. The `PositionIncrementGap` attribute
    specifies the distance between multiple values, which prevents spurious phrase
    matches.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The next couple of lines are `index analyzer` and `query analyzer` definitions.
    The `index` type means that data is analyzed when it is added to the index. The
    `query` type specifies analyzers in the query time (searching).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Now, let''s try and look at the other terms used in the code:'
  prefs: []
  type: TYPE_NORMAL
- en: '`solr.WhitespaceTokenizerFactory`: This splits the text stream on whitespace.
    Here is an example:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Input: `This is an example`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Output: `"This", "is", "an", "example"`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`solr.LowerCaseFilterFactory`: This converts any uppercase letters in a token
    to the equivalent lowercase token. Here is an example:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Input: `"This", "is", "an", "example"`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Output: `"this", "is", "an", "example"`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`solr.RemoveDuplicatesTokenFilterFactory`: This removes duplicate tokens in
    the stream. Here is an example:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Input: `"one", "two", "two", "three"`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Output: `"one", "two", "three"`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`solr.StopFilterFactory`: This removes tokens that are on the given stopwords
    list.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`stopwords.txt` has words such as `hate`, `love`. Here is an example:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Input: `"I", "hate", "my", "job"`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Output: `"I", "my", "job"`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`solr.WordDelimiterFilterFactory`: This splits tokens with specific rules.
    Refer to the official Solr documentation at [https://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.WordDelimiterFilterFactory](https://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.WordDelimiterFilterFactory)
    to learn about the possible configuration.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The next part of `schema.xml` is the fields section. It contains all field
    definitions. In general, Apache Solr provides three types of fields:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`defining fields`: This is a typical, declarative field definition. Every definition
    has the following attributes:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
- en: '`copying fields`: This is the mechanism for making copies of fields with different
    analyzers or filters. It is not used in our `schema.xml` file.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`dynamic fields`: This allows us to define fields without any explicit definition.
    In our `schema.xml`, it is used for multilanguage fields:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
- en: 'Every field definition can contain the following attributes:'
  prefs: []
  type: TYPE_NORMAL
- en: '`name`: The name of the field'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`type`: A reference for the field types that are defined in a `<types>` section'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`default`: A default value that will be added automatically to any document
    that does not have a value'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Other attributes are optional. The full list of optional attributes is available
    in the official Apache Solr documentation at [https://cwiki.apache.org/confluence/display/solr/Defining+Fields](https://cwiki.apache.org/confluence/display/solr/Defining+Fields).
  prefs: []
  type: TYPE_NORMAL
- en: The next file called `solrconfig.xml` is the most important configuration file
    in the Solr search engine.
  prefs: []
  type: TYPE_NORMAL
- en: 'The more commonly used elements in `solrconfig.xml` are:'
  prefs: []
  type: TYPE_NORMAL
- en: Data directory location specifying a location for index data with the `<datadir>`
    parameter
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Query and cache settings configured in child elements of the `<query>` tag
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Request handler `<requestHandle>` sections that process requests coming to Solr
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Search component `<searchComponent>` sections define the logic that is used
    by `SearchHandler` to perform queries for users
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'All documentation is available on the official Apache Solr site: [https://cwiki.apache.org/confluence/display/solr/Configuring+solrconfig.xml](https://cwiki.apache.org/confluence/display/solr/Configuring+solrconfig.xml).'
  prefs: []
  type: TYPE_NORMAL
