<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;4.&#xA0;Using Package Managers and Build Automation Tools" id="UGI01-0c7cc7dc97984506a3b137496d3ab1d6"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04" class="calibre1"/>Chapter 4. Using Package Managers and Build Automation Tools</h1></div></div></div><p class="calibre7">In the previous chapter, we focused on building simple webpages with the help of the WebStorm templates and on using the existing codebases inside the editor.</p><p class="calibre7">In this chapter, you are going to learn how WebStorm can help us when working with some of the package managers and build tools available for the development workflow. You will also learn how to set up and use the following:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Node.js</li><li class="listitem">NPM</li><li class="listitem">Bower</li><li class="listitem">Grunt</li><li class="listitem">Gulp</li></ul></div><p class="calibre7">At the end of this chapter, you will be able to download, install, configure, and use package manager tools like NPM and Bower, and task runners like Grunt and Gulp.</p></div>

<div class="book" title="Chapter&#xA0;4.&#xA0;Using Package Managers and Build Automation Tools" id="UGI01-0c7cc7dc97984506a3b137496d3ab1d6">
<div class="book" title="Node.js"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch04lvl1sec26" class="calibre1"/>Node.js</h1></div></div></div><p class="calibre7">All the tools that <a id="id113" class="calibre1"/>are required in this chapter run on Node.js, so in the first part, we are going to focus on making sure that everything is set up correctly.</p><p class="calibre7">First, we need to check if Node.js is installed. Running the node <code class="email">node -v</code> in the terminal window should return the version of node that we have installed. If you don't get the version number, it means that we need to download and install Node.js. Follow the instructions given <a id="id114" class="calibre1"/>at <a class="calibre1" href="https://nodejs.org/#download">https://nodejs.org/#download</a>.</p><p class="calibre7">Once we are sure that the node is up and running, we need to check that WebStorm is set up to work with it. Go to the <span class="strong"><strong class="calibre8">Preferences</strong></span> | <span class="strong"><strong class="calibre8">Plugins</strong></span> dialog, and make sure that the <span class="strong"><strong class="calibre8">NodeJS</strong></span> plugin is activated:</p><div class="mediaobject"><img src="../images/00051.jpeg" alt="Node.js" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">When the plugin is activated, WebStorm will create a settings page for the node and add run/debug configurations.</p><p class="calibre7">The settings page, which <a id="id115" class="calibre1"/>can be accessed at <span class="strong"><strong class="calibre8">Preferences</strong></span> | <span class="strong"><strong class="calibre8">Languages &amp; Frameworks</strong></span> | <span class="strong"><strong class="calibre8">Node.js and NPM,</strong></span> allows us to set the node interpreter and the sources for the core modules, as seen in the following screenshot:</p><div class="mediaobject"><img src="../images/00052.jpeg" alt="Node.js" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">If you don't have the sources configured, you need to click on <span class="strong"><strong class="calibre8">Configure</strong></span> and download the sources in the next dialog. This enables code completion, reference, and debugging for the node core modules like <code class="email">fs</code>, <code class="email">path</code>, <code class="email">http,</code> and others.</p><p class="calibre7">Once we have the node <a id="id116" class="calibre1"/>installed on our system, we can move to the next section where we are going to learn how to use NPM inside WebStorm.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Using the Node Package Manager to install node packages" id="VF2I1-0c7cc7dc97984506a3b137496d3ab1d6"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec27" class="calibre1"/>Using the Node Package Manager to install node packages</h1></div></div></div><p class="calibre7">NPM is <a id="id117" class="calibre1"/>a package manager <a id="id118" class="calibre1"/>that comes with the node, and enables us to quickly install node packages, either globally or for the current project.</p><p class="calibre7">From Node.js version 0.6.3 onwards, NPM comes bundled and installed automatically with the node, so we don't have to install anything. We can find all the available packages at <a class="calibre1" href="https://www.npmjs.com/">https://www.npmjs.com/</a>; each package has a description page with all the necessary information.</p></div>

<div class="book" title="Using the Node Package Manager to install node packages" id="VF2I1-0c7cc7dc97984506a3b137496d3ab1d6">
<div class="book" title="Installing a package globally"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch04lvl2sec27" class="calibre1"/>Installing a package globally</h2></div></div></div><p class="calibre7">Global <a id="id119" class="calibre1"/>installation makes a package available at the system level so that it can be used in all projects. Usually, we install the tools that we need to use on multiple projects like transpilers, compressors, or test runners globally, and these are used from the command line.</p><p class="calibre7">To install the package globally, we have two options:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Run the installation from the command line with the global option:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install -g &lt;package&gt;</strong></span>
</pre></div></li><li class="listitem">
On the <span class="strong"><strong class="calibre8">Node.js and NPM</strong></span> settings page, select the install icon <span class="strong"><img src="../images/00053.jpeg" alt="Installing a package globally" class="calibre15"/></span> from the <span class="strong"><strong class="calibre8">Packages</strong></span> section. In the new screen, select the package you want to install, and type <code class="email">-g</code> in the option field:
</li></ul></div><div class="mediaobject"><img src="../images/00054.jpeg" alt="Installing a package globally" class="calibre10"/></div><p class="calibre11"> </p></div></div>

<div class="book" title="Using the Node Package Manager to install node packages" id="VF2I1-0c7cc7dc97984506a3b137496d3ab1d6">
<div class="book" title="Installing a package in the project"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch04lvl2sec28" class="calibre1"/>Installing a package in the project </h2></div></div></div><p class="calibre7">A package <a id="id120" class="calibre1"/>installed in the project is available only for the current project. When installing a package locally, we have to create a <code class="email">node_modules</code> folder manually, or initialize <code class="email">npm</code> in the current project to avoid unexpected results. That is because NPM searches up the folder tree for an initialized project, and installs the package there if it can find one.</p><p class="calibre7">To initialize the project with the NPM, we have to run <code class="email">npm init</code> in the terminal window. This will ask you some questions about your project like the name, version, description, author, and so on, and then create the <code class="email">package.json</code>.</p><p class="calibre7">To install the package in the project, we have two options:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Run the installation from the command line:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install &lt;package&gt;</strong></span>
</pre></div></li><li class="listitem">
On the Node.js and NPM settings page, select the install icon <span class="strong"><img src="../images/00053.jpeg" alt="Installing a package in the project" class="calibre15"/></span> from the packages section. In the new screen, select the package you want to install.
</li></ul></div><p class="calibre7">The only difference from the globally installed packages is that we don't use the <code class="email">-g</code> option anymore.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note09" class="calibre1"/>Note</h3><p class="calibre7">When we have an initialized project, we can also specify and save the installed packages as a dependency or as a development dependency in the <code class="email">package.json</code> file. To do that, we have to use the <code class="email">--save or --save-dev</code> option in either the terminal command or the option field in the settings dialog.</p></div></div></div>

<div class="book" title="Using the Node Package Manager to install node packages" id="VF2I1-0c7cc7dc97984506a3b137496d3ab1d6">
<div class="book" title="Installing project dependencies"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch04lvl2sec29" class="calibre1"/>Installing project dependencies</h2></div></div></div><p class="calibre7">If you <a id="id121" class="calibre1"/>have a project or have downloaded an existing one, you have to run <code class="email">npm install</code> from the command line to install the dependencies. This will install all the modules specified in the <code class="email">package.json</code> file.</p></div></div>
<div class="book" title="Using Bower" id="10DJ41-0c7cc7dc97984506a3b137496d3ab1d6"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec28" class="calibre1"/>Using Bower</h1></div></div></div><p class="calibre7">As mentioned <a id="id122" class="calibre1"/>earlier, NPM has a package manager for the node modules and tools. Similarly, we need a package manager for the web as well. This manager is known as Bower, a tool that allows us to install all the libraries, frameworks, and packages that we need for our web project.</p><p class="calibre7">The first thing that we need to do before using Bower is to install it. We are going to use NPM and install it as a global package so that it is available for all our projects. So, open the terminal and type the <a id="id123" class="calibre1"/>following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install -g bower</strong></span>
</pre></div><p class="calibre7">Now that we have Bower installed, we can use it to search and install the packages that we need. To search for packages, we can use the online tool available at <a class="calibre1" href="http://bower.io/search/">http://bower.io/search/</a>, and search from the terminal by using the <code class="email">bower search &lt;keyword&gt;</code> command.</p><p class="calibre7">Before we use Bower to install packages, we have to initialize the project so that we can save our dependencies.</p><p class="calibre7">Run <code class="email">bower init</code> in the terminal, and go through the questions to generate the <code class="email">bower.json</code> file.</p><p class="calibre7">Once we have initialized Bower to install the packages, we have two options:</p><div class="book"><ul class="itemizedlist"><li class="listitem">The first option is to run the installation command in the terminal, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">bower install &lt;packageName or source&gt; </strong></span>
</pre></div><div class="note" title="Note"><h3 class="title2"><a id="note10" class="calibre1"/>Note</h3><p class="calibre7">Please take note that Bower installs the package in the current folder; so before you run the command, be sure that you are in the right folder.</p></div><p class="calibre21">Bower can use <code class="email">install</code> for the following sources as package:</p><div class="book"><ul class="itemizedlist1"><li class="listitem">Registered package name <code class="email">bower install bootstrap</code></li><li class="listitem">GitHub shorthand <code class="email">bower install twbs/bootstrap</code></li><li class="listitem">Git endpoint <code class="email">bower install git://github.com/twbs/bootstrap.git</code></li><li class="listitem">URL <code class="email">bower install https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css</code></li></ul></div></li><li class="listitem">
The second option is to go to the Bower settings page accessible by <span class="strong"><strong class="calibre8">Preferences</strong></span> | <span class="strong"><strong class="calibre8">Languages &amp; Frameworks</strong></span> | <span class="strong"><strong class="calibre8">JavaScript</strong></span> | <span class="strong"><strong class="calibre8">Bower,</strong></span> and select the install icon <span class="strong"><img src="../images/00053.jpeg" alt="Using Bower" class="calibre15"/></span> from the <span class="strong"><strong class="calibre8">Dependencies</strong></span> section:
<div class="mediaobject"><img src="../images/00055.jpeg" alt="Using Bower" class="calibre10"/></div><p class="calibre14"> </p></li></ul></div><p class="calibre7">In the new screen that <a id="id124" class="calibre1"/>opens up, search and select the package that you want to install, as seen in the following screenshot:</p><div class="mediaobject"><img src="../images/00056.jpeg" alt="Using Bower" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">In both cases, the terminal or the install dialog, if you want to save your dependencies or the development dependency in the <code class="email">bower.json</code> file, you have to use the <code class="email">--save</code> or <code class="email">--saveDev</code> option in either the terminal command, or the option field from the dialog.</p><p class="calibre7">Now that you have learned <a id="id125" class="calibre1"/>how to work with package managers in WebStorm, you are going to learn how to install and use two of the popular task runners, Grunt and Gulp.</p></div>
<div class="book" title="Using Grunt"><div class="book" id="11C3M2-0c7cc7dc97984506a3b137496d3ab1d6"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec29" class="calibre1"/>Using Grunt</h1></div></div></div><p class="calibre7">Grunt is a JavaScript test <a id="id126" class="calibre1"/>runner that was built to automate the repetitive tasks that we have to run during development. It can be used for tasks like minification, compilation, linting, unit testing, or any other tasks that your project needs. The Grunt ecosystem has hundreds of plugins that you can choose from.</p><p class="calibre7">Before using Grunt, we need to install the CLI globally. This doesn't install Grunt, but it will run the version of Grunt that was installed next to the configuration file, <code class="email">Gruntfile.js</code>. In this way, we can have multiple versions of Grunt installed. To install the tool, we are going to use NPM once again, so, run the following command in the terminal window:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install -g grunt-cli</strong></span>
</pre></div><p class="calibre7">In the next few steps, we are going to add Grunt to the project that we used in the first chapter. So, go ahead and open the project created in the first chapter, or get it from the Git repository at <a class="calibre1" href="https://github.com/srosca/youAreHere">https://github.com/srosca/youAreHere</a>.</p><p class="calibre7">With the project open, the first thing we need to do is to initialize NPM so that we can download Grunt and the necessary plugins. In the terminal window, run <code class="email">npm init</code> and answer the questions (you can leave them to the default values for the moment). This will create the necessary <code class="email">package.json</code> file for saving our future dependencies.</p><p class="calibre7">Now we need to install <a id="id127" class="calibre1"/>Grunt for the current project; so, run the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install grunt --save-dev</strong></span>
</pre></div><p class="calibre7">Next we have to create the <code class="email">Gruntfile.js</code> configuration file in the root folder of the project, and fill it with the following code:</p><div class="informalexample"><pre class="programlisting">module.exports = function(grunt) {
    grunt.initConfig({
        jshint: {
            files: ['Gruntfile.js', 'js/*.js' ],
            options: {
                globals: {
                    jQuery: true
                }
            }
        }
    });

    grunt.loadNpmTasks('grunt-contrib-jshint');

    grunt.registerTask('default', ['jshint']);

};</pre></div><p class="calibre7">This creates a simple task that does a simple <code class="email">jshint</code> on our <code class="email">.js</code> code. Before we use this task, we also need to install the <code class="email">jshint</code> Grunt plugin. So run the following command in the terminal to install and save it as a development dependency:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install grunt-contrib-jshint --save-dev</strong></span>
</pre></div><p class="calibre7">Now we can either run the task in the terminal by running Grunt, or use the Grunt tool window. This window can be found in the tools menu or in the side bar:</p><div class="mediaobject"><img src="../images/00057.jpeg" alt="Using Grunt" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">If we double-click the task <a id="id128" class="calibre1"/>or select run from the context menu, the task will start and the output will be displayed in the run window:</p><div class="mediaobject"><img src="../images/00058.jpeg" alt="Using Grunt" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">As we can see in the preceding screenshot, we already have some errors in the output. So, before we fix them, let's see how we can create a task that watches our files for any changes, and runs the <code class="email">jshint</code> when they are changed. For that, we first need to install another Grunt plugin that does that. So in the terminal window, run the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install grunt-contrib-watch --save-dev</strong></span>
</pre></div><p class="calibre7">After the plugin is installed, open the <code class="email">Gruntfile.js</code> configuration file and load the <code class="email">npm</code> task after the <code class="email">jshint</code> one, by adding the following command:</p><div class="informalexample"><pre class="programlisting">grunt.loadNpmTasks('grunt-contrib-watch');</pre></div><p class="calibre7">We have to set the <code class="email">jshint</code> task force option to make it stop in case of an error, so add the following code to the option sections:</p><div class="informalexample"><pre class="programlisting">force: true,</pre></div><p class="calibre7">Now after the <code class="email">jshint</code> task in the <code class="email">initConfig</code> block, add a new task:</p><div class="informalexample"><pre class="programlisting">watch: {
    files: ['&lt;%= jshint.files %&gt;'],
    tasks: ['jshint']
}</pre></div><p class="calibre7">Add the newly created task <a id="id129" class="calibre1"/>to the default one so that <code class="email">jshint</code> is run before the watch and we can see the results before we change anything:</p><div class="informalexample"><pre class="programlisting">grunt.registerTask('default', ['jshint, watch']);</pre></div><p class="calibre7">As you can see, we are using the files defined for the <code class="email">jshint</code> task. Your final code should now look like this:</p><div class="informalexample"><pre class="programlisting">module.exports = function(grunt) {

    grunt.initConfig({
        jshint: {
            files: ['Gruntfile.js', 'js/*.js' ],
            options: {
                force: true,
                globals: {
                    jQuery: true
                }
            }
        },
        watch: {
            files: ['&lt;%= jshint.files %&gt;'],
            tasks: ['jshint']
        }
    });

    grunt.loadNpmTasks('grunt-contrib-jshint');
    grunt.loadNpmTasks('grunt-contrib-watch');


    grunt.registerTask('default', ['jshint', 'watch']);

};</pre></div><p class="calibre7">Now in the <span class="strong"><strong class="calibre8">Grunt</strong></span> window, if we click the refresh icon <span class="strong"><img src="../images/00059.jpeg" alt="Using Grunt" class="calibre15"/></span>, we will see that the folder tree has changed, reflecting <a id="id130" class="calibre1"/>the newly added task:</p><div class="mediaobject"><img src="../images/00060.jpeg" alt="Using Grunt" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">If we start the watch task, we will see that now, after running <code class="email">jshint,</code> it will wait for changes in the files. So now we can change the <code class="email">map.js</code> file to fix the errors by taking the content variable definition outside of the 'if' statement:</p><div class="informalexample"><pre class="programlisting">function handleNoGeolocation(errorFlag) {
    var content;
    if (errorFlag) {
        content = 'Error: The Geolocation service failed.';
    } else {
        content = 'Error: Your browser doesn't support geolocation.';
    }
    var options = {
        map: map,
        position: new google.maps.LatLng(60, 105),
        content: content
    };
    var infowindow = new google.maps.InfoWindow(options);
    map.setCenter(options.position);
}</pre></div><p class="calibre7">After we make the change, we will see that if we force a save by pressing <span class="strong"><em class="calibre9">⌘</em></span> + <span class="strong"><em class="calibre9">S</em></span> , Grunt will pick up on the change in file, and will rerun the <code class="email">jshint</code> task.</p><p class="calibre7">Please note that in WebStorm, the files are saved automatically when we change focus from the current window or by pressing <span class="strong"><em class="calibre9">⌘</em></span> + <span class="strong"><em class="calibre9">S</em></span>.</p><p class="calibre7">In this section, we have <a id="id131" class="calibre1"/>automated our task with Grunt and WebStorm. Next, we are going to recreate this flow with Gulp, and see how we can work with it inside WebStorm</p></div>
<div class="book" title="Using Gulp" id="12AK81-0c7cc7dc97984506a3b137496d3ab1d6"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec30" class="calibre1"/>Using Gulp</h1></div></div></div><p class="calibre7">Gulp is another task runner <a id="id132" class="calibre1"/>for development tasks. It's similar to Grunt in terms of what it does, but it does that in a different way. It uses streams to link tasks by pasting the output of one to the next one as input; hence, it uses fewer I/O requests. One main advantage of this is that Gulp is a lot faster than Grunt. It also favors the code-over-configuration flavor of specifying the tasks.</p><p class="calibre7">To see it in action, we are going to recreate the Grunt flow into Gulp. Before we do that, we need to install it. Open the terminal and install Gulp globally:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install --g gulp</strong></span>
</pre></div><p class="calibre7">This will install Gulp globally, so we can use it in all projects. We can still use a different Gulp version for projects by installing it locally. Run the following command in the terminal:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install --save-dev gulp</strong></span>
</pre></div><p class="calibre7">This will install Gulp locally in the project, and save it as a development dependency. In this way, we can have a different version of Gulp for the project that we are working for. Next, we need to install the plugins that we need in our project, So in the terminal, run the next command to install them as a development dependency:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install gulp-jshint --save-dev</strong></span>
<span class="strong"><strong class="calibre8">npm install jshint-stylish --save-dev</strong></span>
</pre></div><p class="calibre7">We need to create the <code class="email">Gulpfile.js</code> to define the tasks for Gulp; so, go ahead and create it in the root folder. Once you have the file open, create the following content:</p><div class="informalexample"><pre class="programlisting">var gulp = require('gulp');
var jshint = require('gulp-jshint');

gulp.task('jshint', function() {
    return gulp.src('js/*.js')
        .pipe(jshint())
        .pipe(jshint.reporter('jshint-stylish'))
        .pipe(jshint.reporter('success'));
});


gulp.task('watch', ['jshint'], function(event) {
    gulp.watch('js/*.js', ['jshint']);
});</pre></div><p class="calibre7">As you can see, Gulp <a id="id133" class="calibre1"/>uses the code approach when defining a task. With the file open, we can access the Gulp window by selecting <span class="strong"><strong class="calibre8">Show Gulp Tasks</strong></span> from the context menu:</p><div class="mediaobject"><img src="../images/00061.jpeg" alt="Using Gulp" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">This will open a window similar to Grunt that lists all the tasks available. From this window, we can start the watch tasks that will watch the files for changes and run <code class="email">jshint</code> when there is a change. In the next screenshot, you can see the Gulp window and the output of the job:</p><div class="mediaobject"><img src="../images/00062.jpeg" alt="Using Gulp" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">As you can see, there are some similarities between Gulp and Grunt in the final result, but also some differences in the way you build the tasks.</p><p class="calibre7">In this chapter, we have <a id="id134" class="calibre1"/>created some simple automated tasks but this can be taken much further. You can create a task for everything that you need to automate in your development process.</p></div>
<div class="book" title="Summary" id="1394Q1-0c7cc7dc97984506a3b137496d3ab1d6"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec31" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">In this chapter, you have learned some of the modern flows of web development package managers and task runners. Now you will be able to quickly add new packages to your project, save them as dependencies, and create tasks for all your repetitive jobs.</p><p class="calibre7">In the next chapter, we are going to see how WebStorm can help us build more complex applications with the help of frameworks like AngularJS, React, Express, and Meteor.</p></div></body></html>