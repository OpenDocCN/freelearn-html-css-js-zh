<html><head></head><body>
<div class="calibre1" id="_idContainer014">
<h1 class="chapternumber"><span class="kobospan" id="kobo.1.1">2</span></h1>
<h1 class="chaptertitle" id="_idParaDest-17"><span class="kobospan" id="kobo.2.1">Working with the Node.js Tools</span></h1>
<p class="normal1"><span class="kobospan" id="kobo.3.1">In this chapter, I explain the simple process of </span><a id="_idIndexMarker003" class="calibre3"/><span class="kobospan" id="kobo.4.1">getting started with </span><strong class="screentext"><span class="kobospan" id="kobo.5.1">Node.js</span></strong><span class="kobospan" id="kobo.6.1">, beginning with the simple steps that are required to prepare for development. </span><span class="kobospan" id="kobo.6.2">I explain how to execute JavaScript code using Node.js and then I introduce the real power in Node.js development: the </span><strong class="screentext"><span class="kobospan" id="kobo.7.1">Node Package Manager</span></strong><span class="kobospan" id="kobo.8.1"> (</span><strong class="screentext"><span class="kobospan" id="kobo.9.1">npm</span></strong><span class="kobospan" id="kobo.10.1">). </span><code class="inlinecode"><span class="kobospan" id="kobo.11.1">npm</span></code><span class="kobospan" id="kobo.12.1"> is the </span><a id="_idIndexMarker004" class="calibre3"/><span class="kobospan" id="kobo.13.1">tool that does most of the work during development, taking responsibility for everything from downloading and installing JavaScript packages, reporting on security vulnerabilities, and running development commands. </span><em class="italic"><span class="kobospan" id="kobo.14.1">Table 2.1</span></em><span class="kobospan" id="kobo.15.1"> summarizes the chapter.</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.16.1">Table 2.1: Chapter summary </span></p>
<table class="table-container" id="table001">
<tbody class="calibre8">
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.17.1">Problem</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.18.1">Solution</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.19.1">Listing</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.20.1">Execute a JavaScript file.</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.21.1">Use the </span><code class="inlinecode"><span class="kobospan2" id="kobo.22.1">node</span></code><span class="kobospan4" id="kobo.23.1"> command.</span></p>
</td>
<td class="table-cell">
<p class="normal"><em class="italic1"><span class="kobospan2" id="kobo.24.1">5</span></em></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.25.1">Initialize a project for use with JavaScript packages.</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.26.1">Use the </span><code class="inlinecode"><span class="kobospan2" id="kobo.27.1">npm init</span></code><span class="kobospan4" id="kobo.28.1"> command.</span></p>
</td>
<td class="table-cell">
<p class="normal"><em class="italic1"><span class="kobospan2" id="kobo.29.1">6</span></em></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.30.1">Add a JavaScript package to a project.</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.31.1">Use the </span><code class="inlinecode"><span class="kobospan2" id="kobo.32.1">npm install</span></code><span class="kobospan" id="kobo.33.1"> command. </span><span class="kobospan" id="kobo.33.2">Use the </span><code class="inlinecode"><span class="kobospan2" id="kobo.34.1">--save-dev</span></code><span class="kobospan4" id="kobo.35.1"> argument for development tool packages. </span></p>
</td>
<td class="table-cell">
<p class="normal"><em class="italic1"><span class="kobospan2" id="kobo.36.1">7, 8</span></em></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.37.1">List the packages in a project.</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.38.1">Use the </span><code class="inlinecode"><span class="kobospan2" id="kobo.39.1">npm list</span></code><span class="kobospan4" id="kobo.40.1"> command.</span></p>
</td>
<td class="table-cell">
<p class="normal"><em class="italic1"><span class="kobospan2" id="kobo.41.1">9, 10</span></em></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.42.1">List the reported security vulnerabilities in the packages used by a project.</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.43.1">Use the </span><code class="inlinecode"><span class="kobospan2" id="kobo.44.1">npm audit</span></code><span class="kobospan4" id="kobo.45.1"> command.</span></p>
</td>
<td class="table-cell">
<p class="normal"><em class="italic1"><span class="kobospan2" id="kobo.46.1">N/A</span></em></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.47.1">Execute the code in a package.</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.48.1">Add the </span><code class="inlinecode"><span class="kobospan2" id="kobo.49.1">node_modules/.bin</span></code><span class="kobospan" id="kobo.50.1"> folder to the path or use the </span><code class="inlinecode"><span class="kobospan2" id="kobo.51.1">npx</span></code><span class="kobospan4" id="kobo.52.1"> command.</span></p>
</td>
<td class="table-cell">
<p class="normal"><em class="italic1"><span class="kobospan2" id="kobo.53.1">11–17</span></em></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.54.1">Start the development tools used by a project.</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.55.1">Define commands in the scripts section of the </span><code class="inlinecode"><span class="kobospan2" id="kobo.56.1">package.json</span></code><span class="kobospan" id="kobo.57.1"> file and use the </span><code class="inlinecode"><span class="kobospan2" id="kobo.58.1">npm start</span></code><span class="kobospan" id="kobo.59.1"> or </span><code class="inlinecode"><span class="kobospan2" id="kobo.60.1">npm run</span></code><span class="kobospan4" id="kobo.61.1"> commands.</span></p>
</td>
<td class="table-cell">
<p class="normal"><em class="italic1"><span class="kobospan2" id="kobo.62.1">18–22</span></em></p>
</td>
</tr>
</tbody>
</table>
<h1 class="heading" id="_idParaDest-18"><span class="kobospan" id="kobo.63.1">Getting ready</span></h1>
<p class="normal1"><span class="kobospan" id="kobo.64.1">The key step to </span><a id="_idIndexMarker005" class="calibre3"/><span class="kobospan" id="kobo.65.1">prepare for Node.js development is, as you would expect, to install Node.js and its supporting tools. </span><span class="kobospan" id="kobo.65.2">The version of Node.js I have used in this book is 20.9.0, which is </span><a id="_idIndexMarker006" class="calibre3"/><span class="kobospan" id="kobo.66.1">the </span><strong class="screentext"><span class="kobospan" id="kobo.67.1">Long-Term Support</span></strong><span class="kobospan" id="kobo.68.1"> (</span><strong class="screentext"><span class="kobospan" id="kobo.69.1">LTS</span></strong><span class="kobospan" id="kobo.70.1">) version at the time of writing. </span><span class="kobospan" id="kobo.70.2">There may be later versions available by the time you read this, but you should stick to this release for the examples in this book.</span></p>
<p class="normal"><span class="kobospan" id="kobo.71.1">A complete set of installers for Node.js version 20.10.0 is available at </span><a href="https://nodejs.org/download/release/v20.10.0" class="calibre3"><span class="calibre3"><span class="kobospan" id="kobo.72.1">https://nodejs.org/download/release/v20.10.0</span></span></a><span class="kobospan" id="kobo.73.1">. </span><span class="kobospan" id="kobo.73.2">Download and run the installer for your platform and ensure the </span><strong class="screentext"><span class="kobospan" id="kobo.74.1">npm package manager</span></strong><span class="kobospan" id="kobo.75.1"> and the </span><strong class="screentext"><span class="kobospan" id="kobo.76.1">Add to PATH</span></strong><span class="kobospan" id="kobo.77.1"> options are checked, as shown in </span><em class="italic"><span class="kobospan" id="kobo.78.1">Figure 2.1</span></em><span class="kobospan" id="kobo.79.1">: </span></p>
<figure class="mediaobject"><span class="kobospan" id="kobo.80.1"><img alt="A screenshot of a computer setup  Description automatically generated" src="../Images/B21959_02_01.png" class="calibre7"/></span></figure>
<p class="packt_figref"><span class="kobospan" id="kobo.81.1">Figure 2.1: Installing Node.js</span></p>
<p class="normal"><span class="kobospan" id="kobo.82.1">When </span><a id="_idIndexMarker007" class="calibre3"/><span class="kobospan" id="kobo.83.1">the installation is complete, open a new command prompt and run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.84.1">Listing 2.1</span></em><span class="kobospan" id="kobo.85.1">:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.86.1">Listing 2.1: Running Node.js</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.87.1">node -v
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.88.1">If the installation has been successful, you will see the following version number displayed:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.89.1">v20.10.0
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.90.1">The installer should have set up the package manager, which plays a key role in Node.js development. </span><span class="kobospan" id="kobo.90.2">Run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.91.1">Listing 2.2</span></em><span class="kobospan" id="kobo.92.1"> to ensure the package</span><a id="_idIndexMarker008" class="calibre3"/><span class="kobospan" id="kobo.93.1"> manager is working:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.94.1">Listing 2.2: Running the package manager</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.95.1">npm -v
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.96.1">If the installation was successful, you will see the following version number:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.97.1">10.1.0
</span></code></pre>
<h2 class="heading1" id="_idParaDest-19"><span class="kobospan" id="kobo.98.1">Installing Git</span></h2>
<p class="normal1"><span class="kobospan" id="kobo.99.1">Some</span><a id="_idIndexMarker009" class="calibre3"/><span class="kobospan" id="kobo.100.1"> packages depend on </span><strong class="screentext"><span class="kobospan" id="kobo.101.1">Git</span></strong><span class="kobospan" id="kobo.102.1">, which is a popular version control system. </span><span class="kobospan" id="kobo.102.2">Download the installer for your platform from </span><a href="https://git-scm.com/downloads" class="calibre3"><span class="calibre3"><span class="kobospan" id="kobo.103.1">https://git-scm.com/downloads</span></span></a><span class="kobospan" id="kobo.104.1"> and follow the installation instructions. </span></p>
<p class="normal"><span class="kobospan" id="kobo.105.1">Once you have completed the installation, use a command prompt to run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.106.1">Listing 2.3</span></em><span class="kobospan" id="kobo.107.1"> to check that Git is working. </span><span class="kobospan" id="kobo.107.2">You may have to manually configure the executable paths:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.108.1">Listing 2.3: Checking Git</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.109.1">git --version
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.110.1">At the time of writing, the latest version of Git for Windows and Linux is 2.42.0.</span></p>
<h2 class="heading1" id="_idParaDest-20"><span class="kobospan" id="kobo.111.1">Selecting a code editor</span></h2>
<p class="normal1"><span class="kobospan" id="kobo.112.1">An editor is </span><a id="_idIndexMarker010" class="calibre3"/><span class="kobospan" id="kobo.113.1">required to write the code that will be executed by Node.js, and any editor that supports JavaScript and TypeScript can be used to follow the examples in this book. </span><span class="kobospan" id="kobo.113.2">If you don’t already have a preferred editor, then Visual Studio Code (</span><a href="https://code.visualstudio.com" class="calibre3"><span class="calibre3"><span class="kobospan" id="kobo.114.1">https://code.visualstudio.com</span></span></a><span class="kobospan" id="kobo.115.1">) has become the most popular editor because it is good (and free), and it is the editor that I used while writing this book.</span></p>
<p class="normal"><span class="kobospan" id="kobo.116.1">If you are using Visual Studio Code, run the command code to start the editor or use the program icon created during installation, and you will see the welcome screen shown in </span><em class="italic"><span class="kobospan" id="kobo.117.1">Figure 2.2</span></em><span class="kobospan" id="kobo.118.1">. </span><span class="kobospan" id="kobo.118.2">(You may need to add Visual Studio Code to your command prompt </span><a id="_idIndexMarker011" class="calibre3"/><span class="kobospan" id="kobo.119.1">path before using the command code.) </span></p>
<figure class="mediaobject"><span class="kobospan" id="kobo.120.1"><img alt="" src="../Images/B21959_02_02.png" class="calibre7"/></span></figure>
<p class="packt_figref"><span class="kobospan" id="kobo.121.1">Figure 2.2: The Visual Studio Code Welcome screen</span></p>
<h1 class="heading" id="_idParaDest-21"><span class="kobospan" id="kobo.122.1">Using Node.js</span></h1>
<p class="normal1"><span class="kobospan" id="kobo.123.1">The </span><a id="_idIndexMarker012" class="calibre3"/><span class="kobospan" id="kobo.124.1">entire purpose of Node.js is to execute JavaScript code. </span><span class="kobospan" id="kobo.124.2">Open a command prompt, navigate to a convenient location, and create a folder named </span><code class="inlinecode"><span class="kobospan" id="kobo.125.1">tools</span></code><span class="kobospan" id="kobo.126.1">. </span><span class="kobospan" id="kobo.126.2">Add a file named </span><code class="inlinecode"><span class="kobospan" id="kobo.127.1">hello.js</span></code><span class="kobospan" id="kobo.128.1"> to the </span><code class="inlinecode"><span class="kobospan" id="kobo.129.1">tools</span></code><span class="kobospan" id="kobo.130.1"> folder, with the content shown in </span><em class="italic"><span class="kobospan" id="kobo.131.1">Listing 2.4</span></em><span class="kobospan" id="kobo.132.1">:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.133.1">Listing 2.4: The Contents of the hello.js File in the tools Folder</span></p>
<pre class="programlisting"><code class="hljs-code"><span class="kobospan" id="kobo.134.1">console.log("Hello, World");
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.135.1">The Node.js API has some features that are also provided by modern JavaScript browsers, including the </span><code class="inlinecode"><span class="kobospan" id="kobo.136.1">console.log</span></code><span class="kobospan" id="kobo.137.1"> method, which writes a message to the console. </span><span class="kobospan" id="kobo.137.2">Run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.138.1">Listing 2.5</span></em><span class="kobospan" id="kobo.139.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.140.1">tools</span></code><span class="kobospan" id="kobo.141.1"> folder to execute the JavaScript code:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.142.1">Listing 2.5: Executing the JavaScript Code</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.143.1">node hello.js
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.144.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.145.1">node</span></code><span class="kobospan" id="kobo.146.1"> command</span><a id="_idIndexMarker013" class="calibre3"/><span class="kobospan" id="kobo.147.1"> starts the Node.js runtime and executes the specified JavaScript file, producing the following output:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.148.1">Hello, World
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.149.1">That’s all there is to know about executing JavaScript code. </span><span class="kobospan" id="kobo.149.2">The rest of the functionality that Node.js provides is delivered through an API, which is described in the rest of this book, starting with </span><em class="italic"><span class="kobospan" id="kobo.150.1">Chapter 4</span></em><span class="kobospan" id="kobo.151.1">.</span></p>
<h1 class="heading" id="_idParaDest-22"><span class="kobospan" id="kobo.152.1">Understanding the npm tool</span></h1>
<p class="normal1"><span class="kobospan" id="kobo.153.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.154.1">node</span></code><span class="kobospan" id="kobo.155.1"> command isn’t often used directly, and most development activities rely on the </span><code class="inlinecode"><span class="kobospan" id="kobo.156.1">npm</span></code><span class="kobospan" id="kobo.157.1"> tool, which</span><a id="_idIndexMarker014" class="calibre3"/><span class="kobospan" id="kobo.158.1"> is installed alongside Node.js. </span><span class="kobospan" id="kobo.158.2">The headline </span><code class="inlinecode"><span class="kobospan" id="kobo.159.1">npm</span></code><span class="kobospan" id="kobo.160.1"> feature is that it provides access to the </span><code class="inlinecode"><span class="kobospan" id="kobo.161.1">npm</span></code><span class="kobospan" id="kobo.162.1"> repository (</span><a href="http://npmjs.com" class="calibre3"><span class="calibre3"><span class="kobospan" id="kobo.163.1">npmjs.com</span></span></a><span class="kobospan" id="kobo.164.1">), which contains an incredible collection of open-source JavaScript packages that can be added to projects. </span><code class="inlinecode"><span class="kobospan" id="kobo.165.1">npm</span></code><span class="kobospan" id="kobo.166.1"> has grown from its original purpose to add related features and has become an integral part of working with Node.js, as I describe in the following sections. </span><span class="kobospan" id="kobo.166.2">For quick reference, </span><em class="italic"><span class="kobospan" id="kobo.167.1">Table 2.2</span></em><span class="kobospan" id="kobo.168.1"> lists the most useful commands supported by </span><code class="inlinecode"><span class="kobospan" id="kobo.169.1">npm</span></code><span class="kobospan" id="kobo.170.1">, which is the package manager command.</span></p>
<table class="table-container" id="table002">
<tbody class="calibre8">
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.171.1">Name</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.172.1">Description</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<pre class="programlisting2"><code class="hljs"><code class="inlinecode1"><span class="kobospan2" id="kobo.173.1">npm init</span></code>
</code></pre>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.174.1">This command creates a </span><code class="inlinecode"><span class="kobospan2" id="kobo.175.1">package.json</span></code><span class="kobospan4" id="kobo.176.1"> file, which is used to keep track of a project’s packages.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<pre class="programlisting2"><code class="hljs"><code class="inlinecode1"><span class="kobospan2" id="kobo.177.1">npm install</span></code>
</code></pre>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.178.1">This command adds a package to the project. </span><span class="kobospan" id="kobo.178.2">The </span><code class="inlinecode"><span class="kobospan2" id="kobo.179.1">--save-dev</span></code><span class="kobospan4" id="kobo.180.1"> argument is used to install packages that are used during development but are not part of the application.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<pre class="programlisting2"><code class="hljs"><code class="inlinecode1"><span class="kobospan2" id="kobo.181.1">npm list</span></code>
</code></pre>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.182.1">This command lists all of the packages that have been added to the project. </span><span class="kobospan" id="kobo.182.2">The </span><code class="inlinecode"><span class="kobospan2" id="kobo.183.1">--all</span></code><span class="kobospan4" id="kobo.184.1"> argument includes package dependencies in the output.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<pre class="programlisting2"><code class="hljs"><code class="inlinecode1"><span class="kobospan2" id="kobo.185.1">npm audit</span></code>
</code></pre>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.186.1">This command reports on security vulnerabilities that have been reported in the packages used in the project.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<pre class="programlisting2"><code class="hljs"><code class="inlinecode1"><span class="kobospan2" id="kobo.187.1">npm start</span></code>
</code></pre>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.188.1">This command executes the </span><code class="inlinecode"><span class="kobospan2" id="kobo.189.1">start</span></code><span class="kobospan" id="kobo.190.1"> script defined in the </span><code class="inlinecode"><span class="kobospan2" id="kobo.191.1">package.json</span></code><span class="kobospan4" id="kobo.192.1"> file.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<pre class="programlisting2"><code class="hljs"><code class="inlinecode1"><span class="kobospan2" id="kobo.193.1">npm stop</span></code>
</code></pre>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.194.1">This command executes the </span><code class="inlinecode"><span class="kobospan2" id="kobo.195.1">stop</span></code><span class="kobospan" id="kobo.196.1"> script defined in the </span><code class="inlinecode"><span class="kobospan2" id="kobo.197.1">package.json</span></code><span class="kobospan4" id="kobo.198.1"> file.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<pre class="programlisting2"><code class="hljs"><code class="inlinecode1"><span class="kobospan2" id="kobo.199.1">npm restart</span></code>
</code></pre>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.200.1">This command executes the </span><code class="inlinecode"><span class="kobospan2" id="kobo.201.1">restart</span></code><span class="kobospan" id="kobo.202.1"> script defined in the </span><code class="inlinecode"><span class="kobospan2" id="kobo.203.1">package.json</span></code><span class="kobospan4" id="kobo.204.1"> file.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<pre class="programlisting2"><code class="hljs"><code class="inlinecode1"><span class="kobospan2" id="kobo.205.1">npm test</span></code>
</code></pre>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.206.1">This command executes the </span><code class="inlinecode"><span class="kobospan2" id="kobo.207.1">test</span></code><span class="kobospan" id="kobo.208.1"> script defined in the </span><code class="inlinecode"><span class="kobospan2" id="kobo.209.1">package.json</span></code><span class="kobospan4" id="kobo.210.1"> file.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<pre class="programlisting2"><code class="hljs"><code class="inlinecode1"><span class="kobospan2" id="kobo.211.1">npm run</span></code>
</code></pre>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.212.1">This command executes custom commands defined in the </span><code class="inlinecode"><span class="kobospan2" id="kobo.213.1">package.json</span></code><span class="kobospan4" id="kobo.214.1"> file.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<pre class="programlisting2"><code class="hljs"><code class="inlinecode1"><span class="kobospan2" id="kobo.215.1">npx</span></code>
</code></pre>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.216.1">This command executes a package.</span></p>
</td>
</tr>
</tbody>
</table>
<p class="packt_figref"><span class="kobospan" id="kobo.217.1">Table 2.2: Useful </span><code class="inlinecode2"><span class="kobospan" id="kobo.218.1">npm</span></code><span class="kobospan" id="kobo.219.1"> commands</span></p>
<h2 class="heading1" id="_idParaDest-23"><span class="kobospan" id="kobo.220.1">Initializing a project</span></h2>
<p class="normal1"><code class="inlinecode"><span class="kobospan" id="kobo.221.1">npm</span></code><span class="kobospan" id="kobo.222.1"> relies</span><a id="_idIndexMarker015" class="calibre3"/><span class="kobospan" id="kobo.223.1"> on a configuration file named </span><code class="inlinecode"><span class="kobospan" id="kobo.224.1">package.json</span></code><span class="kobospan" id="kobo.225.1">, which describes the development project, keeps track of the packages on which it depends, and stores configuration settings related to packages. </span><span class="kobospan" id="kobo.225.2">Run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.226.1">Listing 2.6</span></em><span class="kobospan" id="kobo.227.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.228.1">tools</span></code><span class="kobospan" id="kobo.229.1"> folder to create the </span><code class="inlinecode"><span class="kobospan" id="kobo.230.1">package.json</span></code><span class="kobospan" id="kobo.231.1"> file for the example project:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.232.1">Listing 2.6: Initializing the project</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.233.1">npm init -y
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.234.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.235.1">init</span></code><span class="kobospan" id="kobo.236.1"> command prompts the user for the values to put in the </span><code class="inlinecode"><span class="kobospan" id="kobo.237.1">package.json</span></code><span class="kobospan" id="kobo.238.1"> file, but the </span><code class="inlinecode"><span class="kobospan" id="kobo.239.1">-y</span></code><span class="kobospan" id="kobo.240.1"> argument selects the default values, which are suitable for most projects, including the example for the chapter. </span><span class="kobospan" id="kobo.240.2">The </span><code class="inlinecode"><span class="kobospan" id="kobo.241.1">init</span></code><span class="kobospan" id="kobo.242.1"> command creates a </span><code class="inlinecode"><span class="kobospan" id="kobo.243.1">package.json</span></code><span class="kobospan" id="kobo.244.1"> file with the following contents:</span></p>
<pre class="programlisting"><code class="hljs-code"><span class="kobospan" id="kobo.245.1">{
  "name": "tools",
  "version": "1.0.0",
  "description": "",
  "main": "hello.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC"
}
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.246.1">Most of the initial contents of the </span><code class="inlinecode"><span class="kobospan" id="kobo.247.1">package.json</span></code><span class="kobospan" id="kobo.248.1"> file describe the project so that it can be published to a package registry, which is why there are settings for version numbers</span><a id="_idIndexMarker016" class="calibre3"/><span class="kobospan" id="kobo.249.1"> and licenses. </span><span class="kobospan" id="kobo.249.2">Additional settings will be added to the file in later sections, and you can see the complete list of supported settings at </span><a href="https://docs.npmjs.com/cli/v10/configuring-npm/package-json" class="calibre3"><span class="calibre3"><span class="kobospan" id="kobo.250.1">https://docs.npmjs.com/cli/v10/configuring-npm/package-json</span></span></a><span class="kobospan" id="kobo.251.1">.</span></p>
<h2 class="heading1" id="_idParaDest-24"><span class="kobospan" id="kobo.252.1">Managing packages</span></h2>
<p class="normal1"><span class="kobospan" id="kobo.253.1">The</span><a id="_idIndexMarker017" class="calibre3"/><span class="kobospan" id="kobo.254.1"> headline </span><code class="inlinecode"><span class="kobospan" id="kobo.255.1">npm</span></code><span class="kobospan" id="kobo.256.1"> feature is the management </span><a id="_idIndexMarker018" class="calibre3"/><span class="kobospan" id="kobo.257.1">of the packages used in a project. </span><span class="kobospan" id="kobo.257.2">This may not seem like a big deal, but one compelling aspect of Node.js development is the immense library of open-source packages, which are available in a public registry (</span><a href="http://npmjs.com" class="calibre3"><span class="calibre3"><span class="kobospan" id="kobo.258.1">npmjs.com</span></span></a><span class="kobospan" id="kobo.259.1">). </span><code class="inlinecode"><span class="kobospan" id="kobo.260.1">npm</span></code><span class="kobospan" id="kobo.261.1"> provides access to the registry, takes care of downloading and installing packages, and manages dependencies between packages to avoid conflicts.</span></p>
<p class="normal"><span class="kobospan" id="kobo.262.1">Packages are added to the project </span><a id="_idIndexMarker019" class="calibre3"/><span class="kobospan" id="kobo.263.1">with the </span><code class="inlinecode"><span class="kobospan" id="kobo.264.1">npm install</span></code><span class="kobospan" id="kobo.265.1"> command. </span><span class="kobospan" id="kobo.265.2">Run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.266.1">Listing 2.7</span></em><span class="kobospan" id="kobo.267.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.268.1">tools</span></code><span class="kobospan" id="kobo.269.1"> folder to add a package to the example project:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.270.1">Listing 2.7: Adding a package</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.271.1">npm install bootstrap@5.3.0
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.272.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.273.1">npm install</span></code><span class="kobospan" id="kobo.274.1"> command adds a package to the project and the argument specifies the name of the package (</span><code class="inlinecode"><span class="kobospan" id="kobo.275.1">bootstrap</span></code><span class="kobospan" id="kobo.276.1">, in this case), followed by the </span><code class="inlinecode"><span class="kobospan" id="kobo.277.1">@</span></code><span class="kobospan" id="kobo.278.1"> character, followed by a version number. </span><span class="kobospan" id="kobo.278.2">You can omit the </span><code class="inlinecode"><span class="kobospan" id="kobo.279.1">@</span></code><span class="kobospan" id="kobo.280.1"> character and the version number, in which case, the latest version will be installed, but it is good practice to be specific when installing a package.</span></p>
<p class="normal"><span class="kobospan" id="kobo.281.1">The </span><a id="_idIndexMarker020" class="calibre3"/><span class="kobospan" id="kobo.282.1">command in </span><em class="italic"><span class="kobospan" id="kobo.283.1">Listing 2.7</span></em><span class="kobospan" id="kobo.284.1"> adds the excellent Bootstrap CSS/JavaScript package to the project. </span><span class="kobospan" id="kobo.284.2">As part of this process, </span><code class="inlinecode"><span class="kobospan" id="kobo.285.1">npm</span></code><span class="kobospan" id="kobo.286.1"> looks at the packages that Bootstrap depends </span><a id="_idIndexMarker021" class="calibre3"/><span class="kobospan" id="kobo.287.1">on and installs them, too. </span><span class="kobospan" id="kobo.287.2">Once the command has completed, you will see a new section in the </span><code class="inlinecode"><span class="kobospan" id="kobo.288.1">package.json</span></code><span class="kobospan" id="kobo.289.1"> file:</span></p>
<pre class="programlisting"><code class="hljs-code"><span class="kobospan" id="kobo.290.1">{
  "name": "tools",
  "version": "1.0.0",
  "description": "",
  "main": "hello.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
</span><strong class="screentext"><span class="kobospan" id="kobo.291.1">  "dependencies": {</span></strong>
<strong class="screentext"><span class="kobospan" id="kobo.292.1">    "bootstrap": "^5.3.0"</span></strong>
<strong class="screentext"><span class="kobospan" id="kobo.293.1">  }</span></strong><span class="kobospan" id="kobo.294.1">
}
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.295.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.296.1">dependencies</span></code><span class="kobospan" id="kobo.297.1"> section is used to keep track of the packages used in the project. </span><span class="kobospan" id="kobo.297.2">The version number in the </span><code class="inlinecode"><span class="kobospan" id="kobo.298.1">packages.json</span></code><span class="kobospan" id="kobo.299.1"> file is prefixed with a caret (the </span><code class="inlinecode"><span class="kobospan" id="kobo.300.1">^</span></code><span class="kobospan" id="kobo.301.1"> character), which is part of the </span><code class="inlinecode"><span class="kobospan" id="kobo.302.1">npm</span></code><span class="kobospan" id="kobo.303.1"> system for specifying ranges of version numbers, as described in </span><em class="italic"><span class="kobospan" id="kobo.304.1">Table 2.3</span></em><span class="kobospan" id="kobo.305.1">:</span></p>
<table class="table-container" id="table003">
<tbody class="calibre8">
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.306.1">Name</span></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.307.1">Description</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><code class="inlinecode3"><span class="kobospan2" id="kobo.308.1">*</span></code></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan2" id="kobo.309.1">Using an asterisk accepts any version of the package to be installed.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><code class="inlinecode3"><span class="kobospan2" id="kobo.310.1">5.3.0</span></code></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.311.1">Expressing a version number directly will accept only the package with the exact matching version number, e.g., </span><code class="inlinecode"><span class="kobospan2" id="kobo.312.1">5.3.0</span></code><span class="kobospan4" id="kobo.313.1">.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><code class="inlinecode4"><span class="kobospan2" id="kobo.314.1">&gt;5.3.0</span></code> <code class="inlinecode5"><span class="kobospan2" id="kobo.315.1">&gt;=3.3.0</span></code></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.316.1">Prefixing a version number with </span><code class="inlinecode"><span class="kobospan2" id="kobo.317.1">&gt;</span></code><span class="kobospan" id="kobo.318.1"> or </span><code class="inlinecode"><span class="kobospan2" id="kobo.319.1">&gt;=</span></code><span class="kobospan4" id="kobo.320.1"> accepts any version of the package that is greater than or equal to a given version.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><code class="inlinecode4"><span class="kobospan2" id="kobo.321.1">&lt;5.3.0</span></code> <code class="inlinecode5"><span class="kobospan2" id="kobo.322.1">&lt;=5.3.0</span></code></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.323.1">Prefixing a version number with </span><code class="inlinecode"><span class="kobospan2" id="kobo.324.1">&lt;</span></code><span class="kobospan" id="kobo.325.1"> or </span><code class="inlinecode"><span class="kobospan2" id="kobo.326.1">&lt;=</span></code><span class="kobospan4" id="kobo.327.1"> accepts any version of the package that is less than or equal to a given version.</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><code class="inlinecode3"><span class="kobospan2" id="kobo.328.1">~5.3.0</span></code></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.329.1">Prefixing a version number with a tilde (the </span><code class="inlinecode"><span class="kobospan2" id="kobo.330.1">~</span></code><span class="kobospan" id="kobo.331.1"> character) accepts versions to be installed even if the patch level number (the last of the three version numbers) doesn’t match. </span><span class="kobospan" id="kobo.331.2">For example, specifying </span><code class="inlinecode"><span class="kobospan2" id="kobo.332.1">~5.3.0</span></code><span class="kobospan" id="kobo.333.1"> will accept version </span><code class="inlinecode"><span class="kobospan2" id="kobo.334.1">5.3.1</span></code><span class="kobospan" id="kobo.335.1"> or </span><code class="inlinecode"><span class="kobospan2" id="kobo.336.1">5.3.2</span></code><span class="kobospan" id="kobo.337.1"> (which would contain patches to version </span><code class="inlinecode"><span class="kobospan2" id="kobo.338.1">5.3.0</span></code><span class="kobospan" id="kobo.339.1">) but not version </span><code class="inlinecode"><span class="kobospan2" id="kobo.340.1">5.4.0</span></code><span class="kobospan4" id="kobo.341.1"> (which would be a new minor release).</span></p>
</td>
</tr>
<tr class="calibre9">
<td class="table-cell">
<p class="normal"><code class="inlinecode3"><span class="kobospan2" id="kobo.342.1">^5.3.0</span></code></p>
</td>
<td class="table-cell">
<p class="normal"><span class="kobospan3" id="kobo.343.1">Prefixing a version number with a caret (the </span><code class="inlinecode"><span class="kobospan2" id="kobo.344.1">^</span></code><span class="kobospan" id="kobo.345.1"> character) will accept versions even if the minor release number (the second of the three version numbers) or the patch number doesn’t match. </span><span class="kobospan" id="kobo.345.2">For example, specifying </span><code class="inlinecode"><span class="kobospan2" id="kobo.346.1">^5.3.0</span></code><span class="kobospan" id="kobo.347.1"> will allow versions </span><code class="inlinecode"><span class="kobospan2" id="kobo.348.1">5.4.0</span></code><span class="kobospan" id="kobo.349.1"> and </span><code class="inlinecode"><span class="kobospan2" id="kobo.350.1">5.5.0</span></code><span class="kobospan" id="kobo.351.1"> but not version </span><code class="inlinecode"><span class="kobospan2" id="kobo.352.1">6.0.0</span></code><span class="kobospan4" id="kobo.353.1">.</span></p>
</td>
</tr>
</tbody>
</table>
<p class="packt_figref"><span class="kobospan" id="kobo.354.1">Table 2.3: </span><code class="inlinecode2"><span class="kobospan" id="kobo.355.1">npm</span></code><span class="kobospan" id="kobo.356.1"> version numbers</span></p>
<div class="note">
<p class="normal"><strong class="screentext"><span class="kobospan" id="kobo.357.1">Using exact version numbers</span></strong></p>
<p class="normal"><span class="kobospan" id="kobo.358.1">When I specified </span><code class="inlinecode"><span class="kobospan" id="kobo.359.1">bootstrap@5.3.0</span></code><span class="kobospan" id="kobo.360.1"> in </span><em class="italic"><span class="kobospan" id="kobo.361.1">Listing 2.7</span></em><span class="kobospan" id="kobo.362.1">, </span><code class="inlinecode"><span class="kobospan" id="kobo.363.1">npm</span></code><span class="kobospan" id="kobo.364.1"> gave itself some wiggle room by interpreting the version as </span><code class="inlinecode"><span class="kobospan" id="kobo.365.1">^5.3.0</span></code><span class="kobospan" id="kobo.366.1">. </span><span class="kobospan" id="kobo.366.2">The process of resolving dependencies and conflicts between packages is a complex process, which is made easier by broadening the range of acceptable versions. </span><span class="kobospan" id="kobo.366.3">This approach relies on the idea that version </span><code class="inlinecode"><span class="kobospan" id="kobo.367.1">5.4.0</span></code><span class="kobospan" id="kobo.368.1">, say, will be compatible with version </span><code class="inlinecode"><span class="kobospan" id="kobo.369.1">5.3.0</span></code><span class="kobospan" id="kobo.370.1"> and won’t contain breaking changes.</span></p>
<p class="normal"><span class="kobospan" id="kobo.371.1">If you can’t rely on packages to maintain compatibility, then you can configure </span><code class="inlinecode"><span class="kobospan" id="kobo.372.1">npm</span></code><span class="kobospan" id="kobo.373.1"> to use exact version numbers by running this command:</span></p>
<pre class="programlisting2"><code class="hljs-code"><code class="inlinecode2"><span class="kobospan" id="kobo.374.1">npm config set save-exact false</span></code>
</code></pre>
<p class="normal"><code class="inlinecode"><span class="kobospan" id="kobo.375.1">npm</span></code><span class="kobospan" id="kobo.376.1"> will only use the versions that you specify, but the trade-off is that resolving dependencies and version conflicts between packages may be more difficult.</span></p>
</div>
<p class="normal"><span class="kobospan" id="kobo.377.1">Packages </span><a id="_idIndexMarker022" class="calibre3"/><span class="kobospan" id="kobo.378.1">are stored in the </span><code class="inlinecode"><span class="kobospan" id="kobo.379.1">node_modules</span></code><span class="kobospan" id="kobo.380.1"> folder, which is created automatically. </span><code class="inlinecode"><span class="kobospan" id="kobo.381.1">npm</span></code><span class="kobospan" id="kobo.382.1"> creates a</span><a id="_idIndexMarker023" class="calibre3"/><span class="kobospan" id="kobo.383.1"> folder for each package that it downloads, and there can be a large number of folders as packages and their dependencies are resolved.</span></p>
<p class="normal"><span class="kobospan" id="kobo.384.1">To ensure that dependencies are resolved consistently, </span><code class="inlinecode"><span class="kobospan" id="kobo.385.1">npm</span></code><span class="kobospan" id="kobo.386.1"> creates the </span><code class="inlinecode"><span class="kobospan" id="kobo.387.1">package-lock.json</span></code><span class="kobospan" id="kobo.388.1"> file, which contains a complete list of the packages that have been installed, along with specific version numbers.</span></p>
<h3 class="heading2" id="_idParaDest-25"><span class="kobospan" id="kobo.389.1">Installing development packages</span></h3>
<p class="normal1"><span class="kobospan" id="kobo.390.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.391.1">dependencies</span></code><span class="kobospan" id="kobo.392.1"> section of the </span><code class="inlinecode"><span class="kobospan" id="kobo.393.1">package.json</span></code><span class="kobospan" id="kobo.394.1"> file is for the packages that the application</span><a id="_idIndexMarker024" class="calibre3"/><span class="kobospan" id="kobo.395.1"> needs to run. </span><span class="kobospan" id="kobo.395.2">The </span><code class="inlinecode"><span class="kobospan" id="kobo.396.1">npm</span></code><span class="kobospan" id="kobo.397.1"> command</span><a id="_idIndexMarker025" class="calibre3"/><span class="kobospan" id="kobo.398.1"> can also be used to add packages that are only required during development, such as compilers and debuggers. </span><span class="kobospan" id="kobo.398.2">Run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.399.1">Listing 2.8</span></em><span class="kobospan" id="kobo.400.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.401.1">tools</span></code><span class="kobospan" id="kobo.402.1"> folder to add development packages to the project:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.403.1">Listing 2.8: Adding a development package to the example project</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.404.1">npm install --save-dev typescript@5.2.2 tsc-watch@6.0.4
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.405.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.406.1">--save-dev</span></code><span class="kobospan" id="kobo.407.1"> argument specifies a development package, and this command installs two packages that are required only during development. </span><span class="kobospan" id="kobo.407.2">The </span><code class="inlinecode"><span class="kobospan" id="kobo.408.1">typescript</span></code><span class="kobospan" id="kobo.409.1"> package includes the TypeScript compiler, which is used to compile TypeScript code into JavaScript that can be executed by Node.js. </span><span class="kobospan" id="kobo.409.2">The </span><code class="inlinecode"><span class="kobospan" id="kobo.410.1">tsc-watch</span></code><span class="kobospan" id="kobo.411.1"> package is a useful add-on that monitors TypeScript files for changes and automatically compiles and executes them.</span></p>
<p class="normal"><span class="kobospan" id="kobo.412.1">Examine the </span><code class="inlinecode"><span class="kobospan" id="kobo.413.1">package.json</span></code><span class="kobospan" id="kobo.414.1"> file and you will see a new configuration section:</span></p>
<pre class="programlisting"><code class="hljs-code"><span class="kobospan" id="kobo.415.1">{
  "name": "tools",
  "version": "1.0.0",
  "description": "",
  "main": "hello.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",
    "start": "tsc message.ts"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "bootstrap": "^5.3.0"
  },
</span><strong class="screentext"><span class="kobospan" id="kobo.416.1">  "devDependencies": {</span></strong>
<strong class="screentext"><span class="kobospan" id="kobo.417.1">    "tsc-watch": "</span></strong><strong class="screentext"><span class="kobospan" id="kobo.418.1">^6.0.4",</span></strong>
<strong class="screentext"><span class="kobospan" id="kobo.419.1">    "typescript": "^5.2.2"</span></strong>
<strong class="screentext"><span class="kobospan" id="kobo.420.1">  }</span></strong><span class="kobospan" id="kobo.421.1">
}
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.422.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.423.1">devDependencies</span></code><span class="kobospan" id="kobo.424.1"> section keeps track of the development packages, which don’t need</span><a id="_idIndexMarker026" class="calibre3"/><span class="kobospan" id="kobo.425.1"> to be included when the application is prepared for deployment. </span><span class="kobospan" id="kobo.425.2">The new section contains entries for the packages specified by the command in </span><em class="italic"><span class="kobospan" id="kobo.426.1">Listing 2.8</span></em><span class="kobospan" id="kobo.427.1">.</span></p>
<div class="note">
<p class="normal"><strong class="screentext"><span class="kobospan" id="kobo.428.1">Choosing packages and tools</span></strong></p>
<p class="normal"><span class="kobospan" id="kobo.429.1">JavaScript benefits from a broad and dynamic ecosystem of open-source packages that solve just about any problem you might encounter. </span><span class="kobospan" id="kobo.429.2">There is so much choice that it can be difficult to decide which packages to use, especially since there is a constant flow of online articles claiming that a particular new package is a hot way to build applications.</span></p>
<p class="normal"><span class="kobospan" id="kobo.430.1">The sad fact is most projects die from a lack of support. </span><span class="kobospan" id="kobo.430.2">Someone, somewhere, becomes frustrated with the way that a particular package works and decides to write their own replacement. </span><span class="kobospan" id="kobo.430.3">They realize that other people may benefit and altruistically decide to publish their code for anyone to use. </span><span class="kobospan" id="kobo.430.4">Most of the time, that’s the end of the story, either because not many other people encounter the same frustrations or because the new package solves the problem in a way that doesn’t suit other projects.</span></p>
<p class="normal"><span class="kobospan" id="kobo.431.1">In many ways, that’s the best outcome – at least for the original developer – because as soon as a package starts to get users, the developer will start to get demands for fixes, features, and general support. </span><span class="kobospan" id="kobo.431.2">The idea of open-source packages is that everyone pitches in, but that often doesn’t happen. </span><span class="kobospan" id="kobo.431.3">The burdens on the package developer can be substantial, user demands can be endless and aggressive, and the amount of – unpaid – work can get out of hand. </span><span class="kobospan" id="kobo.431.4">Many packages that start to become popular are abandoned at this point because the original developer can’t cope with the maintenance and no one pitches in to help.</span></p>
</div>
<div class="note">
<p class="normal"><span class="kobospan" id="kobo.432.1"> A small number of packages make it past this point. </span><span class="kobospan" id="kobo.432.2">The original developer successfully enlists help in fixing problems and writing new features and puts the package onto a project-like footing. </span><span class="kobospan" id="kobo.432.3">The original developer may move on to other projects, but the package becomes important enough that someone else is willing to take on the task and the project continues. </span><span class="kobospan" id="kobo.432.4">At this point, the package matures, can be widely used, and almost always becomes the unfashionable approach that attracts the ire of all those online articles.</span></p>
<p class="normal"><span class="kobospan" id="kobo.433.1">My advice is to choose packages that suit the type of project you are working on. </span><span class="kobospan" id="kobo.433.2">For mainstream commercial development, I recommend using packages that have made it past these hurdles and become well-established and well-maintained. </span><span class="kobospan" id="kobo.433.3">These are the packages that have high weekly download numbers (which you can see on </span><code class="inlinecode"><span class="kobospan" id="kobo.434.1">npm.js</span></code><span class="kobospan" id="kobo.435.1">), which are updated regularly, and have an engaged team that responds to issues and queries. </span><span class="kobospan" id="kobo.435.2">These are the packages that will continue to be supported throughout the life of </span><em class="italic"><span class="kobospan" id="kobo.436.1">your</span></em><span class="kobospan" id="kobo.437.1"> project, allowing you to deliver your features on a solid platform. </span><span class="kobospan" id="kobo.437.2">It is this type of package that I have used throughout this book.</span></p>
<p class="normal"><span class="kobospan" id="kobo.438.1">For hobby and experimental projects, I recommend using the less well-established packages. </span><span class="kobospan" id="kobo.438.2">These won’t be as well-supported and you will encounter more problems and do more work to get everything working, but you will learn more, and you may have more fun.</span></p>
<p class="normal"><span class="kobospan" id="kobo.439.1">Regardless of how you choose packages, remember that you are benefiting from the altruism of others. </span><span class="kobospan" id="kobo.439.2">If you can, then contribute to the packages you use. </span><span class="kobospan" id="kobo.439.3">Just about every package has a list of bugs waiting to be fixed, which is a good way to get involved. </span><span class="kobospan" id="kobo.439.4">If you don’t feel confident contributing code, then consider making a financial contribution. </span><span class="kobospan" id="kobo.439.5">Many projects accept donations, and even the largest and most widely used packages are managed by foundations that welcome individual and corporate supporters.</span></p>
</div>
<h3 class="heading2" id="_idParaDest-26"><span class="kobospan" id="kobo.440.1">Listing packages</span></h3>
<p class="normal1"><span class="kobospan" id="kobo.441.1">You may </span><a id="_idIndexMarker027" class="calibre3"/><span class="kobospan" id="kobo.442.1">only rely on a small number of packages in a </span><a id="_idIndexMarker028" class="calibre3"/><span class="kobospan" id="kobo.443.1">project but each of those packages has dependencies and it is easy to end up with hundreds of small packages in a project, each of which contributes a small amount of functionality. </span><span class="kobospan" id="kobo.443.2">To see the set of packages that have been added to the project, run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.444.1">Listing 2.9</span></em><span class="kobospan" id="kobo.445.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.446.1">tools</span></code><span class="kobospan" id="kobo.447.1"> folder:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.448.1">Listing 2.9: Listing the installed packages</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.449.1">npm list
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.450.1">The </span><a id="_idIndexMarker029" class="calibre3"/><span class="kobospan" id="kobo.451.1">output corresponds to the </span><code class="inlinecode"><span class="kobospan" id="kobo.452.1">npm install</span></code><span class="kobospan" id="kobo.453.1"> commands used in earlier sections of this chapter, although you may see slightly different version numbers:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.454.1">+-- bootstrap@5.3.0
+-- tsc-watch@6.0.4
`-- typescript@5.2.2
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.455.1">Behind</span><a id="_idIndexMarker030" class="calibre3"/><span class="kobospan" id="kobo.456.1"> the scenes, </span><code class="inlinecode"><span class="kobospan" id="kobo.457.1">npm</span></code><span class="kobospan" id="kobo.458.1"> has inspected these packages to discover their dependencies and installed those packages as well, which can be seen by running the command shown in </span><em class="italic"><span class="kobospan" id="kobo.459.1">Listing 2.10</span></em><span class="kobospan" id="kobo.460.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.461.1">tools</span></code><span class="kobospan" id="kobo.462.1"> folder:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.463.1">Listing 2.10: Listing packages and dependencies</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.464.1">npm list --all
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.465.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.466.1">--all</span></code><span class="kobospan" id="kobo.467.1"> argument tells </span><code class="inlinecode"><span class="kobospan" id="kobo.468.1">npm</span></code><span class="kobospan" id="kobo.469.1"> to list dependencies as well and produces output similar to the following, although you may see different details:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.470.1">+-- bootstrap@5.3.0
+-- tsc-watch@6.0.4
| +-- cross-spawn@7.0.3
| | +-- path-key@3.1.1
| | +-- shebang-command@2.0.0
| | | `-- shebang-regex@3.0.0
| | `-- which@2.0.2
| |   `-- isexe@2.0.0
| +-- node-cleanup@2.1.2
| +-- ps-tree@1.2.0
| | `-- event-stream@3.3.4
| |   +-- duplexer@0.1.2
| |   +-- from@0.1.7
| |   +-- map-stream@0.1.0
| |   +-- pause-stream@0.0.11
| |   | `-- through@2.3.8 deduped
| |   +-- split@0.3.3
| |   | `-- through@2.3.8 deduped
| |   +-- stream-combiner@0.0.4
| |   | `-- duplexer@0.1.2 deduped
| |   `-- through@2.3.8
| +-- string-argv@0.3.2
| `-- typescript@5.2.2 deduped
`-- typescript@5.2.2
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.471.1">You may see </span><a id="_idIndexMarker031" class="calibre3"/><span class="kobospan" id="kobo.472.1">small differences when you run this command. </span><span class="kobospan" id="kobo.472.2">Most </span><a id="_idIndexMarker032" class="calibre3"/><span class="kobospan" id="kobo.473.1">projects rely on a deep tree of packages, and </span><code class="inlinecode"><span class="kobospan" id="kobo.474.1">npm</span></code><span class="kobospan" id="kobo.475.1"> takes care of resolving the dependencies for each of them and automatically downloading all the packages that are required.</span></p>
<h3 class="heading2" id="_idParaDest-27"><span class="kobospan" id="kobo.476.1">Checking for package security vulnerabilities</span></h3>
<p class="normal1"><span class="kobospan" id="kobo.477.1">The</span><a id="_idIndexMarker033" class="calibre3"/><span class="kobospan" id="kobo.478.1"> large number of JavaScript packages in a project makes it difficult to know exactly which packages you are using and whether those packages may have reported security vulnerabilities.</span></p>
<p class="normal"><span class="kobospan" id="kobo.479.1">To address</span><a id="_idIndexMarker034" class="calibre3"/><span class="kobospan" id="kobo.480.1"> this issue, package repositories maintain a list of known problems. </span><span class="kobospan" id="kobo.480.2">As </span><code class="inlinecode"><span class="kobospan" id="kobo.481.1">npm</span></code><span class="kobospan" id="kobo.482.1"> resolves package dependencies, it checks all of the packages that it is installing against the vulnerabilities list and emits a warning if it finds any problems. </span><span class="kobospan" id="kobo.482.2">As an example, here is a command that installs a package whose dependencies contain a vulnerability:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.483.1">npm install --save-dev nodemon@2.0.20
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.484.1">This command may not have the same effect by the time this book is published because of the dynamic nature of JavaScript package dependencies, but when I ran this command, I received the following response:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.485.1">added 32 packages, and audited 54 packages in 3s
5 packages are looking for funding
  run `npm fund` for details
</span><strong class="screentext"><span class="kobospan" id="kobo.486.1">3 moderate severity vulnerabilities</span></strong>
</code></pre>
<p class="normal"><code class="inlinecode"><span class="kobospan" id="kobo.487.1">npm</span></code><span class="kobospan" id="kobo.488.1"> has identified three security issues in the packages that have been installed. </span><span class="kobospan" id="kobo.488.2">For more details, I ran this command:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.489.1">npm audit
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.490.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.491.1">npm audit</span></code><span class="kobospan" id="kobo.492.1"> command</span><a id="_idIndexMarker035" class="calibre3"/><span class="kobospan" id="kobo.493.1"> reports on potential problems. </span><span class="kobospan" id="kobo.493.2">In this case, there is an issue with </span><a id="_idIndexMarker036" class="calibre3"/><span class="kobospan" id="kobo.494.1">versions 7.0.0 to 7.5.1 with a package named </span><code class="inlinecode"><span class="kobospan" id="kobo.495.1">semver</span></code><span class="kobospan" id="kobo.496.1">:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.497.1"># npm audit report
semver  7.0.0 - 7.5.1
Severity: moderate
semver vulnerable to Regular Expression Denial of Service - https://github.com/advisories/GHSA-c2qf-rxjj-qqgw
fix available via `npm audit fix --force`
Will install nodemon@3.0.1, which is a breaking change
node_modules/simple-update-notifier/node_modules/semver
  simple-update-notifier  1.0.7 - 1.1.0
  Depends on vulnerable versions of semver
  node_modules/simple-update-notifier
    nodemon  2.0.19 - 2.0.22
    Depends on vulnerable versions of simple-update-notifier
    node_modules/nodemon
3 moderate severity vulnerabilities
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.498.1">The output provides a URL where details can be found and the suggestion that installing a later version of the top-level package – the one added by the </span><code class="inlinecode"><span class="kobospan" id="kobo.499.1">npm install</span></code><span class="kobospan" id="kobo.500.1"> command – would fix the problem, albeit by introducing a breaking change that may stop existing code from working.</span></p>
<p class="normal"><span class="kobospan" id="kobo.501.1">There is an </span><code class="inlinecode"><span class="kobospan" id="kobo.502.1">npm audit fix</span></code><span class="kobospan" id="kobo.503.1"> command that attempts to move to fixed versions of packages but that can cause problems with deeply nested dependencies and should be used with caution.</span></p>
<p class="normal"><span class="kobospan" id="kobo.504.1">For the packages used in this book, you should use the versions I have specified, even if there are warnings about security vulnerabilities, to ensure the examples work as expected. </span><span class="kobospan" id="kobo.504.2">For real projects, you should assess each reported vulnerability and figure out whether moving to a patched package is possible without breaking code. </span><span class="kobospan" id="kobo.504.3">It won’t always be possible to move away from all vulnerable </span><a id="_idIndexMarker037" class="calibre3"/><span class="kobospan" id="kobo.505.1">packages without making corresponding changes in the project, and only you can decide what is sensible for your projects.</span></p>
<p class="normal"><span class="kobospan" id="kobo.506.1">To be clear, I am </span><a id="_idIndexMarker038" class="calibre3"/><span class="kobospan" id="kobo.507.1">not advising you to ignore security warnings. </span><span class="kobospan" id="kobo.507.2">I am saying that not all warnings are for problems that are likely to occur in all projects and there will be times when you might decide to stick with a vulnerable package because the risk to your project is low and the amount of work required to upgrade a package is substantial. </span><span class="kobospan" id="kobo.507.3">You might also form the view that problems with developer packages are less of a risk because those packages are not included when the project is deployed.</span></p>
<h2 class="heading1" id="_idParaDest-28"><span class="kobospan" id="kobo.508.1">Executing packages</span></h2>
<p class="normal1"><span class="kobospan" id="kobo.509.1">Some </span><a id="_idIndexMarker039" class="calibre3"/><span class="kobospan" id="kobo.510.1">packages include shell scripts that can be used to </span><a id="_idIndexMarker040" class="calibre3"/><span class="kobospan" id="kobo.511.1">execute the package features, and these are installed in the </span><code class="inlinecode"><span class="kobospan" id="kobo.512.1">node_modules/.bin</span></code><span class="kobospan" id="kobo.513.1"> folder. </span><span class="kobospan" id="kobo.513.2">The package added in </span><em class="italic"><span class="kobospan" id="kobo.514.1">Listing 2.10</span></em><span class="kobospan" id="kobo.515.1">, for example, includes a </span><code class="inlinecode"><span class="kobospan" id="kobo.516.1">tsc</span></code><span class="kobospan" id="kobo.517.1"> script, which starts the TypeScript compiler. </span><span class="kobospan" id="kobo.517.2">Add a file named </span><code class="inlinecode"><span class="kobospan" id="kobo.518.1">message.ts</span></code><span class="kobospan" id="kobo.519.1"> to the </span><code class="inlinecode"><span class="kobospan" id="kobo.520.1">tools</span></code><span class="kobospan" id="kobo.521.1"> folder, with the content shown in </span><em class="italic"><span class="kobospan" id="kobo.522.1">Listing 2.11</span></em><span class="kobospan" id="kobo.523.1">. </span><span class="kobospan" id="kobo.523.2">(The </span><code class="inlinecode"><span class="kobospan" id="kobo.524.1">ts</span></code><span class="kobospan" id="kobo.525.1"> file extension denotes a TypeScript file.)</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.526.1">Listing 2.11: The contents of the message.ts file in the tools folder</span></p>
<pre class="programlisting"><code class="hljs-code"><span class="kobospan" id="kobo.527.1">function writeMessage(msg: string) {
    console.log(`Message: ${msg}`);
}
writeMessage("This is the message");
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.528.1">TypeScript code has to be compiled into pure JavaScript before it can be executed by Node.js. </span><span class="kobospan" id="kobo.528.2">I describe this process in more detail in </span><em class="italic"><span class="kobospan" id="kobo.529.1">Chapter 3</span></em><span class="kobospan" id="kobo.530.1">, but for this chapter, it is enough to know that I need to use the </span><code class="inlinecode"><span class="kobospan" id="kobo.531.1">tsc</span></code><span class="kobospan" id="kobo.532.1"> command provided by the package added to the project in </span><em class="italic"><span class="kobospan" id="kobo.533.1">Listing 2.8</span></em><span class="kobospan" id="kobo.534.1">.</span></p>
<p class="normal"><span class="kobospan" id="kobo.535.1">The first step</span><a id="_idIndexMarker041" class="calibre3"/><span class="kobospan" id="kobo.536.1"> is to add the folder that contains the scripts to the path used to search for commands. </span><span class="kobospan" id="kobo.536.2">Execute the command shown in </span><em class="italic"><span class="kobospan" id="kobo.537.1">Listing 2.12</span></em><span class="kobospan" id="kobo.538.1"> if you are using PowerShell, which is what I use for development on Windows machines:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.539.1">Listing 2.12: Setting the path in powershell</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.540.1">$env:path += ';.\node_modules\.bin'
</span></code></pre>
<p class="normal"><em class="italic"><span class="kobospan" id="kobo.541.1">Listing 2.13</span></em><span class="kobospan" id="kobo.542.1"> shows</span><a id="_idIndexMarker042" class="calibre3"/><span class="kobospan" id="kobo.543.1"> the equivalent command for the Bourne shell, which is commonly encountered on Linux machines:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.544.1">Listing 2.13: Setting the path in the bourne shell</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.545.1">PATH=$PATH:./node_modules/.bin/
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.546.1">Packages that provide shell scripts generally support a range of command shells. </span><span class="kobospan" id="kobo.546.2">For its compiler, the </span><code class="inlinecode"><span class="kobospan" id="kobo.547.1">typescript</span></code><span class="kobospan" id="kobo.548.1"> package adds three files to the </span><code class="inlinecode"><span class="kobospan" id="kobo.549.1">node_modules/.bin</span></code><span class="kobospan" id="kobo.550.1"> folder: </span><code class="inlinecode"><span class="kobospan" id="kobo.551.1">tsc</span></code><span class="kobospan" id="kobo.552.1"> (which supports the Bourne shell), </span><code class="inlinecode"><span class="kobospan" id="kobo.553.1">tsc.ps1</span></code><span class="kobospan" id="kobo.554.1"> (which supports PowerShell), and </span><code class="inlinecode"><span class="kobospan" id="kobo.555.1">tsc.cmd</span></code><span class="kobospan" id="kobo.556.1"> (which supports the older Windows Command Prompt).</span></p>
<p class="normal"><span class="kobospan" id="kobo.557.1">These are not the only script files added to the </span><code class="inlinecode"><span class="kobospan" id="kobo.558.1">.bin</span></code><span class="kobospan" id="kobo.559.1"> folder. </span><span class="kobospan" id="kobo.559.2">The </span><code class="inlinecode"><span class="kobospan" id="kobo.560.1">typescript</span></code><span class="kobospan" id="kobo.561.1"> package also adds scripts for the </span><code class="inlinecode"><span class="kobospan" id="kobo.562.1">tsserver</span></code><span class="kobospan" id="kobo.563.1"> command, which is used to integrate TypeScript into development tools, such as editors, but which is not required for this book. </span><span class="kobospan" id="kobo.563.2">Entries are added by other packages as </span><code class="inlinecode"><span class="kobospan" id="kobo.564.1">npm</span></code><span class="kobospan" id="kobo.565.1"> installs packages and resolves dependencies.</span></p>
<p class="normal"><span class="kobospan" id="kobo.566.1">Run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.567.1">Listing 2.14</span></em><span class="kobospan" id="kobo.568.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.569.1">tools</span></code><span class="kobospan" id="kobo.570.1"> folder to run the compiler:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.571.1">Listing 2.14: Running a package command</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.572.1">tsc message.ts
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.573.1">The command won’t produce any messages but it does create a file named </span><code class="inlinecode"><span class="kobospan" id="kobo.574.1">message.js</span></code><span class="kobospan" id="kobo.575.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.576.1">tools</span></code><span class="kobospan" id="kobo.577.1"> folder, with the following content:</span></p>
<pre class="programlisting"><code class="hljs-code"><span class="kobospan" id="kobo.578.1">...
</span><span class="kobospan" id="kobo.578.2">function writeMessage(msg) {
    console.log("Message: ".concat(msg));
}
writeMessage("This is the message");
...
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.579.1">Run the </span><a id="_idIndexMarker043" class="calibre3"/><span class="kobospan" id="kobo.580.1">command shown in </span><em class="italic"><span class="kobospan" id="kobo.581.1">Listing 2.15</span></em><span class="kobospan" id="kobo.582.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.583.1">tools</span></code><span class="kobospan" id="kobo.584.1"> folder to execute the compiled JavaScript code using Node.js:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.585.1">Listing 2.15: Executing JavaScript code</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.586.1">node message.js
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.587.1">The Node.js runtime</span><a id="_idIndexMarker044" class="calibre3"/><span class="kobospan" id="kobo.588.1"> executes the code in the file created by the TypeScript compiler, producing the following output:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.589.1">Message: This is the message
</span></code></pre>
<h3 class="heading2" id="_idParaDest-29"><span class="kobospan" id="kobo.590.1">Using the npx command</span></h3>
<p class="normal1"><span class="kobospan" id="kobo.591.1">Not all </span><a id="_idIndexMarker045" class="calibre3"/><span class="kobospan" id="kobo.592.1">packages install scripts, and another way to execute package features is to use the </span><code class="inlinecode"><span class="kobospan" id="kobo.593.1">npx</span></code><span class="kobospan" id="kobo.594.1"> command. </span><span class="kobospan" id="kobo.594.2">Each package added to the </span><code class="inlinecode"><span class="kobospan" id="kobo.595.1">node_modules</span></code><span class="kobospan" id="kobo.596.1"> folder has its own </span><code class="inlinecode"><span class="kobospan" id="kobo.597.1">package.json</span></code><span class="kobospan" id="kobo.598.1"> file. </span><span class="kobospan" id="kobo.598.2">In addition to keeping track of the package’s dependencies, the </span><code class="inlinecode"><span class="kobospan" id="kobo.599.1">package.json</span></code><span class="kobospan" id="kobo.600.1"> file defines a </span><code class="inlinecode"><span class="kobospan" id="kobo.601.1">bin</span></code><span class="kobospan" id="kobo.602.1"> section that defines the commands that </span><code class="inlinecode"><span class="kobospan" id="kobo.603.1">npx</span></code><span class="kobospan" id="kobo.604.1"> can execute. </span><span class="kobospan" id="kobo.604.2">For the package added in </span><em class="italic"><span class="kobospan" id="kobo.605.1">Listing 2.8</span></em><span class="kobospan" id="kobo.606.1">, the </span><code class="inlinecode"><span class="kobospan" id="kobo.607.1">package.json</span></code><span class="kobospan" id="kobo.608.1"> file can be found in the </span><code class="inlinecode"><span class="kobospan" id="kobo.609.1">node_modules/typescript</span></code><span class="kobospan" id="kobo.610.1"> folder and it contains this </span><code class="inlinecode"><span class="kobospan" id="kobo.611.1">bin</span></code><span class="kobospan" id="kobo.612.1"> section:</span></p>
<pre class="programlisting"><code class="hljs-code"><span class="kobospan" id="kobo.613.1">...
</span><span class="kobospan" id="kobo.613.2">"bin": {
    "tsc": "./bin/tsc",
    "tsserver": "./bin/tsserver"
},
...
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.614.1">The entries in the </span><code class="inlinecode"><span class="kobospan" id="kobo.615.1">bin</span></code><span class="kobospan" id="kobo.616.1"> section define a command and a JavaScript file that will be executed by that command. </span><span class="kobospan" id="kobo.616.2">The </span><code class="inlinecode"><span class="kobospan" id="kobo.617.1">typescript</span></code><span class="kobospan" id="kobo.618.1"> package defines </span><code class="inlinecode"><span class="kobospan" id="kobo.619.1">bin</span></code><span class="kobospan" id="kobo.620.1"> entries for </span><code class="inlinecode"><span class="kobospan" id="kobo.621.1">tsc</span></code><span class="kobospan" id="kobo.622.1"> and </span><code class="inlinecode"><span class="kobospan" id="kobo.623.1">tsserver</span></code><span class="kobospan" id="kobo.624.1"> commands, which correspond to the shell scripts used in the previous section. </span><span class="kobospan" id="kobo.624.2">Run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.625.1">Listing 2.16</span></em><span class="kobospan" id="kobo.626.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.627.1">tools</span></code><span class="kobospan" id="kobo.628.1"> folder to execute the TypeScript compiler using </span><code class="inlinecode"><span class="kobospan" id="kobo.629.1">npx</span></code><span class="kobospan" id="kobo.630.1">:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.631.1">Listing 2.16: Executing the TypeScript compiler</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.632.1">npx tsc message.ts
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.633.1">This command</span><a id="_idIndexMarker046" class="calibre3"/><span class="kobospan" id="kobo.634.1"> has the same effect as the one in </span><em class="italic"><span class="kobospan" id="kobo.635.1">Listing 2.14</span></em><span class="kobospan" id="kobo.636.1">. </span><span class="kobospan" id="kobo.636.2">When multiple packages define commands with the same name, the </span><code class="inlinecode"><span class="kobospan" id="kobo.637.1">--package</span></code><span class="kobospan" id="kobo.638.1"> argument can be used, as shown in </span><em class="italic"><span class="kobospan" id="kobo.639.1">Listing 2.17</span></em><span class="kobospan" id="kobo.640.1">:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.641.1">Listing 2.17: Specifying a package</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.642.1">npx --package=typescript tsc message.ts
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.643.1">If the package that contains the command isn’t installed, then the </span><code class="inlinecode"><span class="kobospan" id="kobo.644.1">npx</span></code><span class="kobospan" id="kobo.645.1"> command will download the package into a cache folder and then execute the command.</span></p>
<h2 class="heading1" id="_idParaDest-30"><span class="kobospan" id="kobo.646.1">Using script commands</span></h2>
<p class="normal1"><code class="inlinecode"><span class="kobospan" id="kobo.647.1">npm</span></code><span class="kobospan" id="kobo.648.1"> supports</span><a id="_idIndexMarker047" class="calibre3"/><span class="kobospan" id="kobo.649.1"> a set of commands that are customized by adding entries to the </span><code class="inlinecode"><span class="kobospan" id="kobo.650.1">scripts</span></code><span class="kobospan" id="kobo.651.1"> section of the </span><code class="inlinecode"><span class="kobospan" id="kobo.652.1">package.json</span></code><span class="kobospan" id="kobo.653.1"> file. </span><span class="kobospan" id="kobo.653.2">This </span><a id="_idIndexMarker048" class="calibre3"/><span class="kobospan" id="kobo.654.1">can feel a little odd at first, but it is a powerful way to use the features provided by JavaScript packages concisely and consistently. </span><code class="inlinecode"><span class="kobospan" id="kobo.655.1">npm</span></code><span class="kobospan" id="kobo.656.1"> supports the following basic commands:</span></p>
<ul class="calibre4">
<li class="bulletlist"><code class="inlinecode"><span class="kobospan" id="kobo.657.1">start</span></code></li>
<li class="bulletlist1"><code class="inlinecode"><span class="kobospan" id="kobo.658.1">stop</span></code></li>
<li class="bulletlist1"><code class="inlinecode"><span class="kobospan" id="kobo.659.1">restart</span></code></li>
<li class="bulletlist1"><code class="inlinecode"><span class="kobospan" id="kobo.660.1">test</span></code></li>
</ul>
<p class="normal"><span class="kobospan" id="kobo.661.1">Projects won’t always need every command, and there are no firm rules for how these commands can be used, but the convention is to use the </span><code class="inlinecode"><span class="kobospan" id="kobo.662.1">start</span></code><span class="kobospan" id="kobo.663.1"> command to start the development tools and use the </span><code class="inlinecode"><span class="kobospan" id="kobo.664.1">test</span></code><span class="kobospan" id="kobo.665.1"> command to run unit tests, which I describe in </span><em class="italic"><span class="kobospan" id="kobo.666.1">Chapter 8</span></em><span class="kobospan" id="kobo.667.1">.</span></p>
<p class="normal"><em class="italic"><span class="kobospan" id="kobo.668.1">Listing 2.18</span></em><span class="kobospan" id="kobo.669.1"> adds an entry to the </span><code class="inlinecode"><span class="kobospan" id="kobo.670.1">scripts</span></code><span class="kobospan" id="kobo.671.1"> section:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.672.1">Listing 2.18: Configuring a command in the package.Json file in the tools folder</span></p>
<pre class="programlisting"><code class="hljs-code"><span class="kobospan" id="kobo.673.1">{
  "name": "tools",
  "version": "1.0.0",
  "description": "",
  "main": "hello.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",
    </span><strong class="screentext"><span class="kobospan" id="kobo.674.1">"start"</span></strong><strong class="screentext"><span class="kobospan" id="kobo.675.1">: "tsc-watch message.ts --onSuccess \"node message.js\""</span></strong><span class="kobospan" id="kobo.676.1">  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "bootstrap": "^5.3.0"
  },
  "devDependencies": {
    "tsc-watch": "^6.0.4",
    "typescript": "^5.2.2"
  }
}
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.677.1">Each </span><a id="_idIndexMarker049" class="calibre3"/><span class="kobospan" id="kobo.678.1">entry in the </span><code class="inlinecode"><span class="kobospan" id="kobo.679.1">scripts</span></code><span class="kobospan" id="kobo.680.1"> section consists of a </span><a id="_idIndexMarker050" class="calibre3"/><span class="kobospan" id="kobo.681.1">command name and an associated action. </span><span class="kobospan" id="kobo.681.2">The action associated with the </span><code class="inlinecode"><span class="kobospan" id="kobo.682.1">start</span></code><span class="kobospan" id="kobo.683.1"> command in </span><em class="italic"><span class="kobospan" id="kobo.684.1">Listing 2.18</span></em><span class="kobospan" id="kobo.685.1"> runs the </span><code class="inlinecode"><span class="kobospan" id="kobo.686.1">tsc-watch</span></code><span class="kobospan" id="kobo.687.1"> command, which is a wrapper around the TypeScript compiler that watches TypeScript files for changes and can be configured to execute a command when compilation is successful. </span><span class="kobospan" id="kobo.687.2">(The </span><code class="inlinecode"><span class="kobospan" id="kobo.688.1">test</span></code><span class="kobospan" id="kobo.689.1"> command was added automatically when the </span><code class="inlinecode"><span class="kobospan" id="kobo.690.1">package.json</span></code><span class="kobospan" id="kobo.691.1"> file was created and just prints out an error message.)</span></p>
<p class="normal"><span class="kobospan" id="kobo.692.1">I could run the </span><code class="inlinecode"><span class="kobospan" id="kobo.693.1">tsc-watch</span></code><span class="kobospan" id="kobo.694.1"> command directly from the command line, either using the shell scripts the package added to the </span><code class="inlinecode"><span class="kobospan" id="kobo.695.1">node_modules/.bin</span></code><span class="kobospan" id="kobo.696.1"> folder or with the </span><code class="inlinecode"><span class="kobospan" id="kobo.697.1">npx</span></code><span class="kobospan" id="kobo.698.1"> command, but as commands get more complex, it becomes more difficult to remember the syntax and enter them correctly. </span><span class="kobospan" id="kobo.698.2">The new entry in the </span><code class="inlinecode"><span class="kobospan" id="kobo.699.1">package.json</span></code><span class="kobospan" id="kobo.700.1"> file lets me define the command once and then always invoke it consistently. </span><span class="kobospan" id="kobo.700.2">Run the command shown in </span><em class="italic"><span class="kobospan" id="kobo.701.1">Listing 2.19</span></em><span class="kobospan" id="kobo.702.1"> in the </span><code class="inlinecode"><span class="kobospan" id="kobo.703.1">tools</span></code><span class="kobospan" id="kobo.704.1"> folder:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.705.1">Listing 2.19: Running a script command</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.706.1">npm start
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.707.1">The </span><code class="inlinecode"><span class="kobospan" id="kobo.708.1">npm start</span></code><span class="kobospan" id="kobo.709.1"> command tells </span><code class="inlinecode"><span class="kobospan" id="kobo.710.1">npm</span></code><span class="kobospan" id="kobo.711.1"> to perform the </span><code class="inlinecode"><span class="kobospan" id="kobo.712.1">start</span></code><span class="kobospan" id="kobo.713.1"> action defined in the </span><code class="inlinecode"><span class="kobospan" id="kobo.714.1">package.json</span></code><span class="kobospan" id="kobo.715.1"> file, producing the following output:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.716.1">09:19:15 - Starting compilation in watch mode...
</span><span class="kobospan" id="kobo.716.2">09:19:16 - Found 0 errors. </span><span class="kobospan" id="kobo.716.3">Watching for file changes.
</span><span class="kobospan" id="kobo.716.4">Message: This is the message
</span></code></pre>
<p class="normal"><em class="italic"><span class="kobospan" id="kobo.717.1">Listing 2.20</span></em><span class="kobospan" id="kobo.718.1"> makes a small change to the TypeScript file:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.719.1">Listing 2.20: Making a change in the message.ts file in the tools folder</span></p>
<pre class="programlisting"><code class="hljs-code"><span class="kobospan" id="kobo.720.1">function writeMessage(msg: string) {
    console.log(`Message: ${msg}`);
}
</span><strong class="screentext"><span class="kobospan" id="kobo.721.1">writeMessage("This is the new message");</span></strong>
</code></pre>
<p class="normal"><span class="kobospan" id="kobo.722.1">When </span><a id="_idIndexMarker051" class="calibre3"/><span class="kobospan" id="kobo.723.1">you save the altered file, the change is</span><a id="_idIndexMarker052" class="calibre3"/><span class="kobospan" id="kobo.724.1"> detected, the TypeScript file is compiled, and Node.js is used to execute the JavaScript, producing the following output:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.725.1">...
</span><span class="kobospan" id="kobo.725.2">Message: This is the new message
...
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.726.1">Most web application project development depends on tools that run continuously, monitoring files for changes, and this is a pattern that I will follow throughout this book. </span><span class="kobospan" id="kobo.726.2">Use </span><em class="italic"><span class="kobospan" id="kobo.727.1">Control+C</span></em><span class="kobospan" id="kobo.728.1"> to stop the command once you have seen the output.</span></p>
<h3 class="heading2" id="_idParaDest-31"><span class="kobospan" id="kobo.729.1">Defining custom commands</span></h3>
<p class="normal1"><span class="kobospan" id="kobo.730.1">In</span><a id="_idIndexMarker053" class="calibre3"/><span class="kobospan" id="kobo.731.1"> addition to the built-in commands, </span><code class="inlinecode"><span class="kobospan" id="kobo.732.1">npm</span></code><span class="kobospan" id="kobo.733.1"> supports </span><a id="_idIndexMarker054" class="calibre3"/><span class="kobospan" id="kobo.734.1">custom commands as well, as shown in </span><em class="italic"><span class="kobospan" id="kobo.735.1">Listing 2.21</span></em><span class="kobospan" id="kobo.736.1">:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.737.1">Listing 2.21: Defining a custom script command in the package.json file in the tools folder</span></p>
<pre class="programlisting"><code class="hljs-code"><span class="kobospan" id="kobo.738.1">...
</span><span class="kobospan" id="kobo.738.2">"scripts": {
  "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",
  "start": "tsc-watch message.ts --onSuccess \"node message.js\"",
  </span><strong class="screentext"><span class="kobospan" id="kobo.739.1">"go": "tsc message.ts &amp;&amp; node message.js"</span></strong><span class="kobospan" id="kobo.740.1">
},
...
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.741.1">The name of the new command is </span><code class="inlinecode"><span class="kobospan" id="kobo.742.1">go</span></code><span class="kobospan" id="kobo.743.1"> and it compiles the </span><code class="inlinecode"><span class="kobospan" id="kobo.744.1">message.ts</span></code><span class="kobospan" id="kobo.745.1"> TypeScript file and then uses Node.js to execute the compiled JavaScript.</span></p>
<div class="packt_tip">
<p class="normal"><strong class="screentext"><span class="kobospan" id="kobo.746.1">Tip</span></strong></p>
<p class="normal"><span class="kobospan" id="kobo.747.1">Commands separated by </span><code class="inlinecode"><span class="kobospan" id="kobo.748.1">&amp;&amp;</span></code><span class="kobospan" id="kobo.749.1"> are executed sequentially. </span><span class="kobospan" id="kobo.749.2">Commands separated by a single </span><code class="inlinecode"><span class="kobospan" id="kobo.750.1">&amp;</span></code><span class="kobospan" id="kobo.751.1"> are executed in parallel.</span></p>
</div>
<p class="normal"><span class="kobospan" id="kobo.752.1">Custom commands are executed with </span><code class="inlinecode"><span class="kobospan" id="kobo.753.1">npm run</span></code><span class="kobospan" id="kobo.754.1">, as shown in </span><em class="italic"><span class="kobospan" id="kobo.755.1">Listing 2.22</span></em><span class="kobospan" id="kobo.756.1">:</span></p>
<p class="packt_figref"><span class="kobospan" id="kobo.757.1">Listing 2.22: Executing a custom script command</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.758.1">npm run go
</span></code></pre>
<p class="normal"><span class="kobospan" id="kobo.759.1">The name</span><a id="_idIndexMarker055" class="calibre3"/><span class="kobospan" id="kobo.760.1"> of the custom command follows </span><code class="inlinecode"><span class="kobospan" id="kobo.761.1">npm run</span></code><span class="kobospan" id="kobo.762.1">, so that </span><code class="inlinecode"><span class="kobospan" id="kobo.763.1">npm run go</span></code><span class="kobospan" id="kobo.764.1"> executes the custom </span><code class="inlinecode"><span class="kobospan" id="kobo.765.1">go</span></code><span class="kobospan" id="kobo.766.1"> command, producing the following output:</span></p>
<pre class="programlisting1"><code class="hljs-con"><span class="kobospan" id="kobo.767.1">Message: This is the new message
</span></code></pre>
<h1 class="heading" id="_idParaDest-32"><span class="kobospan" id="kobo.768.1">Summary</span></h1>
<p class="normal1"><span class="kobospan" id="kobo.769.1">In this chapter, I explained the simple setup process to prepare for this book and introduced the core Node.js tools:</span></p>
<ul class="calibre4">
<li class="bulletlist"><span class="kobospan" id="kobo.770.1">Node.js development requires the Node.js installer, the Git version control system, and a JavaScript/TypeScript code editor, such as Visual Studio Code.</span></li>
<li class="bulletlist1"><span class="kobospan" id="kobo.771.1">JavaScript files are executed with the </span><code class="inlinecode"><span class="kobospan" id="kobo.772.1">node</span></code><span class="kobospan" id="kobo.773.1"> command.</span></li>
<li class="bulletlist1"><span class="kobospan" id="kobo.774.1">Much of the functionality provided by Node.js is presented through the API it provides, which is the topic of this book.</span></li>
<li class="bulletlist1"><span class="kobospan" id="kobo.775.1">The </span><strong class="screentext"><span class="kobospan" id="kobo.776.1">node package manager</span></strong><span class="kobospan" id="kobo.777.1"> (</span><strong class="screentext"><span class="kobospan" id="kobo.778.1">npm</span></strong><span class="kobospan" id="kobo.779.1">) is used to download JavaScript packages, execute commands, run development tools, and start unit tests.</span></li>
</ul>
<p class="normal"><span class="kobospan" id="kobo.780.1">In the next chapter, I will provide a primer that describes the essential JavaScript and TypeScript features that are required to follow the examples in this book.</span></p>
</div>
</body></html>