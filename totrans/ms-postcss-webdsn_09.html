<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch09"/>Chapter 9. Working with Shortcuts, Fallbacks, and Packs</h1></div></div></div><p>If you spend any time working with CSS, then it is likely you will come across instances where you wished there was a quicker way to add a particular block of code to your page, apply vendor prefixes, or perhaps set a predefined border to an element on the page.</p><p>We can easily achieve this by using one or more of the many shortcuts, fallbacks, or pack plugins available for use with PostCSS. In this chapter, we'll explore some common scenarios where plugins are required, before learning how to create them in the next chapter. We will cover a number of topics throughout this chapter, which will include the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Exploring some of the PostCSS shortcuts and packs available for use</li><li class="listitem" style="list-style-type: disc">Using plugins to lint and optimize your CSS code</li><li class="listitem" style="list-style-type: disc">Supplementing the existing shortcuts available in PostCSS</li><li class="listitem" style="list-style-type: disc">Applying fallbacks to PostCSS code to maintain support for older browsers</li></ul></div><p>Let's get cracking!</p><div><div><div><div><h1 class="title"><a id="ch09lvl1sec74"/>Using shortcut plugins in PostCSS</h1></div></div></div><p>Building a web-based<a id="id500" class="indexterm"/> application or site can be a lengthy process—there are so many elements to consider, and it takes time to create content that is engaging and informative.</p><p>Naturally, a smart<a id="id501" class="indexterm"/> designer or developer will always look for a shortcut to save time—after all, why take an hour to do something, if a shortcut will take half the time? The great thing about PostCSS is that it has a good selection of shortcut plugins that we can use; these include plugins such as the examples:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">postcss-focus</code>: This plugin is available at <a class="ulink" href="https://github.com/postcss/postcss-focus">https://github.com/postcss/postcss-focus</a>, this simple plugin adds a <code class="literal">:focus</code> pseudo-selector to<a id="id502" class="indexterm"/> any <code class="literal">:hover</code> attribute encountered<a id="id503" class="indexterm"/> in a style rule.</li><li class="listitem" style="list-style-type: disc"><code class="literal">postcss-border</code>: If specified in a shorthand version, this plugin will add a <code class="literal">border-width</code> attribute to an<a id="id504" class="indexterm"/> existing <a id="id505" class="indexterm"/><code class="literal">border:</code> attribute. The plugin source is available from <a class="ulink" href="https://github.com/andrepolischuk/postcss-border">https://github.com/andrepolischuk/postcss-border</a>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">postcss-short-data</code>: This plugin is available at <a class="ulink" href="https://github.com/jonathantneal/postcss-short-data">https://github.com/jonathantneal/postcss-short-data</a>, this interesting plugin allows us to <a id="id506" class="indexterm"/>write shorthand data<a id="id507" class="indexterm"/> attribute selectors, akin to pseudo-selectors, which are compiled into data- attributes.</li></ul></div><p>We've already<a id="id508" class="indexterm"/> incorporated or talked about a number of the shortcut plugins that are available within PostCSS—these include <code class="literal">postcss-responsive-type</code> which we used to build a responsive page earlier in the book, <code class="literal">easings</code>, and of course, <code class="literal">postcss-transform-shortcut</code> from <a class="link" href="ch07.html" title="Chapter 7. Animating Elements">Chapter 7</a>, <em>Animating Content</em>.</p><p>There are a lot more<a id="id509" class="indexterm"/> plugins available for use. Throughout the course of this chapter, we're going to explore some of the shortcut plugins available, plus some of the packs that we can use to supplement functionality within our preprocessor. A good place to start is the selection of plugin packs available for use within PostCSS—let's take a moment to explore these in more detail.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch09lvl1sec75"/>Exploring plugin packs for PostCSS</h1></div></div></div><p>Cast your mind <a id="id510" class="indexterm"/>back, if you will, to some advice I gave earlier about plugins—remember how I said that in an ideal world, a plugin should serve a single purpose?</p><p>Well, one might be<a id="id511" class="indexterm"/> forgiven for thinking that we're ignoring this advice when we talk about plugin packs. In reality, we're not; all of the plugin packs available for PostCSS provide a single interface for multiple single plugins. At present, the list of plugin packs include these examples:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Oldie</strong>: Available<a id="id512" class="indexterm"/> from <a class="ulink" href="https://github.com/jonathantneal/oldie">https://github.com/jonathantneal/oldie</a>, this plugin<a id="id513" class="indexterm"/> is an<a id="id514" class="indexterm"/> interface for nine separate plugins; it handles support for older versions of IE.</li><li class="listitem" style="list-style-type: disc"><strong>Short</strong>: Hosted at <a class="ulink" href="https://github.com/jonathantneal/postcss-short">https://github.com/jonathantneal/postcss-short</a>, this<a id="id515" class="indexterm"/> plugin lets <a id="id516" class="indexterm"/>us write styles using our own shorthand <a id="id517" class="indexterm"/>properties.</li><li class="listitem" style="list-style-type: disc"><strong>AtCSS</strong> : This plugin is available at <a class="ulink" href="https://github.com/morishitter/atcss">https://github.com/morishitter/atcss</a>, this interesting plugin provides a new take<a id="id518" class="indexterm"/> on SASS' <code class="literal">@extend</code> by allowing us to create rules<a id="id519" class="indexterm"/> that inherit from base rules.</li><li class="listitem" style="list-style-type: disc"><strong>precss</strong>: This plugin, from <a class="ulink" href="https://github.com/jonathantneal/precss">https://github.com/jonathantneal/precss</a>, allows us to use <a id="id520" class="indexterm"/>SASS-like markup in our style sheets. We will <a id="id521" class="indexterm"/>explore this in more<a id="id522" class="indexterm"/> detail in <a class="link" href="ch11.html" title="Chapter 11. Manipulating Custom Syntaxes">Chapter 11</a>, <em>Manipulating Custom Syntaxes</em>.</li><li class="listitem" style="list-style-type: disc"><strong>Stylelint</strong>: This plugin<a id="id523" class="indexterm"/> pack should form part of any PostCSS <a id="id524" class="indexterm"/>developer's toolkit: it allows us to lint our<a id="id525" class="indexterm"/> style sheets automatically. The pack is available from <a class="ulink" href="https://github.com/stylelint/stylelint">https://github.com/stylelint/stylelint</a>.</li><li class="listitem" style="list-style-type: disc"><strong>Cssnano</strong>: In a similar <a id="id526" class="indexterm"/>vein, <code class="literal">cssnano</code> should be part of any<a id="id527" class="indexterm"/> developer's toolkit: this pack is perfect for compressing and optimizing code within our style sheets. You can get the plugin from <a class="ulink" href="https://github.com/ben-eb/cssnano">https://github.com/ben-eb/cssnano</a>.</li><li class="listitem" style="list-style-type: disc"><strong>Rucksack</strong>: Last, but by no means least, Rucksack (as described by the developer), is a "…little bag<a id="id528" class="indexterm"/> of CSS superpowers". This<a id="id529" class="indexterm"/> pack adds support for functionality such as <code class="literal">font src</code> generation, providing fallback support for RGBA values, or the <code class="literal">clearfix</code> hack.</li></ul></div><p>These packs<a id="id530" class="indexterm"/> provide a real mix of functionality—it is naturally<a id="id531" class="indexterm"/> up to us to decide which plugins we want to use. At this point, though, one might be tempted to ask "why use a pack—surely this adds unnecessarily redundant functionality that we're trying to avoid adding?"</p><p>It's a good question, the simple answer is that it will depend on your requirements. If all we're interested in is adding vendor prefixes, then checking and compressing our code, then we would most likely use <code class="literal">autoprefixer</code>, <code class="literal">cssnano</code>, and <code class="literal">stylelint</code>. But if we wanted to add property aliases, then <code class="literal">autoprefixer</code> can be dropped in favor of using Rucksack with <code class="literal">cssnano</code> and <code class="literal">stylelint</code>. The key here, though, is to carefully assess what you need, and work out the best combination of plugins to use from the selection available for PostCSS.</p><p>Okay, time for a<a id="id532" class="indexterm"/> change: let's move on! We will be exploring some <a id="id533" class="indexterm"/>of these plugin packs over the next few pages: let's make a start with a simple plugin, in the form of <code class="literal">postcss-short</code>.</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec88"/>Writing styles in shorthand</h2></div></div></div><p>This plugin, available from <a class="ulink" href="https://github.com/jonathantneal/postcss-short">https://github.com/jonathantneal/postcss-short</a>, is a wrapper for several <a id="id534" class="indexterm"/>plugins available for the PostCSS ecosystem; these include Shorthand Border, Shorthand Color, and Shorthand Size. Installing the plugin is a breeze—it uses the <a id="id535" class="indexterm"/>same format as most other PostCSS plugins, and can be installed using this command within our project root area, in a Node.js command prompt session:</p><div><pre class="programlisting"><strong>npm install postcss-short --save-dev</strong>
</pre></div><p>The great thing about this plugin (and other plugin packs) is that it removes the need to call lots of separate plugins. We must bear in mind though that to make this worthwhile, we need to be calling most of the plugins in some form or other. If we're only calling one or two from <code class="literal">postcss-short</code>, then we may prefer to call them individually, and not use the <code class="literal">postcss-short</code> plugin.</p><p>Leaving aside any concerns about using the plugin, let's take a look at some examples of it in action. The best way to experience it is to use the online editor at <a class="ulink" href="http://jonathantneal.github.io/postcss-short/">http://jonathantneal.github.io/postcss-short/</a>. We can use this to experiment before adding the final result to our style sheet prior to compilation:</p><div><img src="img/BO5194_09_01.jpg" alt="Writing styles in shorthand"/></div><p>In this example (taken from the plugin site), we've used all of the plugins, with the exception of Shorthand Text and Shorthand Data. In our code, we've used the relevant shorthand as specified for the plugin—PostCSS will compile this into valid CSS styles, as outlined within each plugin.</p><p>Which plugins we use will of course depend on our requirements—there is every possibility that you will find yourselves using particular plugins more than others. Staying with<a id="id536" class="indexterm"/> the theme of shorthand, though, there is one plugin pack that is likely to feature often in your toolkit—Rucksack. No, I don't suggest this is an opportunity to go on holiday (no pun intended), but more an occasion to use what will be a very useful set of plugins within PostCSS.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch09lvl1sec76"/>Adding shortcuts with Rucksack</h1></div></div></div><p>Mention the word Rucksack, and<a id="id537" class="indexterm"/> one might be forgiven for thinking we were about to go on a journey or holiday—whilst the desire might be there, there are more practical matters to attend to first!</p><p>This said, working with PostCSS can easily be seen as going on a journey; this is particularly true when working with plugins. One of the plugins (or to be more accurate, packs) that you will very likely come across when working with PostCSS is Rucksack (see the play on words there?). This <a id="id538" class="indexterm"/>useful pack, available from <a class="ulink" href="http://simplaio.github.io/rucksack/">http://simplaio.github.io/rucksack/</a>, contains a number of plugins that have been linked together to<a id="id539" class="indexterm"/> provide additional functionality that we can use when compiling style sheets using Rucksack, such as these examples:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Alias</strong>: This is available at <a class="ulink" href="https://github.com/seaneking/postcss-alias">https://github.com/seaneking/postcss-alias</a>, this plugin<a id="id540" class="indexterm"/> allows us to create shorthand CSS properties.</li><li class="listitem" style="list-style-type: disc"><strong>Clearfix</strong>: As a developer, I am sure<a id="id541" class="indexterm"/> you will be familiar with the clearfix hack: this plugin by Sean King provides the PostCSS equivalent, and is available at <a class="ulink" href="https://github.com/seaneking/postcss-clearfix">https://github.com/seaneking/postcss-clearfix</a>.</li><li class="listitem" style="list-style-type: disc"><strong>Font src expansion</strong>: How <a id="id542" class="indexterm"/>many times have you used custom font declarations in your code? They're a pain to write—another plugin by Sean King (at <a class="ulink" href="https://github.com/seaneking/postcss-fontpath">https://github.com/seaneking/postcss-fontpath</a>), makes it a cinch to add to your code.</li></ul></div><p>The irony here, though, is that we've already used Rucksack without realizing it—remember the <code class="literal">postcss-responsive-type</code> plugin we used back in <a class="link" href="ch04.html" title="Chapter 4. Building Media Queries">Chapter 4</a>, <em>Building Media Queries</em>? Or the <code class="literal">autoprefixer</code> plugin we've used in just about every chapter throughout the book? Both of these plugins are available via Rucksack—Rucksack is really an abstract layer that ties in access from multiple plugins into one consistent interface for us to use.</p><p>Okay, enough chitchat: let's get stuck into a demo and see some action! For our next demo, we're going to construct a simple slider using some standard HTML markup and CSS3 styles; no <a id="id543" class="indexterm"/>JavaScript will be used at all. We'll start with a quick run-through of our slider, before we convert the style sheet to use Rucksack.</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec89"/>Introducing our demo</h2></div></div></div><p>For this next demo, we're<a id="id544" class="indexterm"/> going to break tradition and not install the plugin we're about to use first, before creating our demo. Instead, we'll set up our demo first—we can then ascertain where Rucksack can be used once we've set our baseline solution.</p><p>Our demo centers on a simple image slider, which uses pure CSS3 styling to control the animation. This is a screenshot of what we're going to create:</p><div><img src="img/BO5194_09_02.jpg" alt="Introducing our demo"/></div><p>To see the demo in action, go ahead and extract the <code class="literal">T45 – converting to use Rucksack</code> folder<a id="id545" class="indexterm"/> from a copy of the code download that accompanies this book—save it to our project area. Go ahead and preview the results by running <code class="literal">slider.html</code> in a browser, then click on the numbers in the bottom left to move between different images.</p><div><div><h3 class="title"><a id="note44"/>Note</h3><p>You will need to rename the style <code class="literal">post-completed.css</code> file <code class="literal">style.css</code> for it to operate correctly.</p></div></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec90"/>Installing Rucksack as a plugin</h2></div></div></div><p>With our demo in <a id="id546" class="indexterm"/>place, it's time to install Rucksack, and ascertain where we can use it in our demo! Rucksack, like most other PostCSS plugins, can be installed using the same method—we can use NPM:</p><div><ol class="orderedlist arabic"><li class="listitem">Fire up a Node.js command prompt, then change the working folder to our project area.</li><li class="listitem">In the prompt, enter <code class="literal">npm install rucksack-css --save-dev</code>, then press <em>Enter</em>.</li><li class="listitem">NPM will go away and install the plugin—if all is well, we should see something akin to this:<div><img src="img/BO5194_09_03.jpg" alt="Installing Rucksack as a plugin"/></div></li></ol></div><p>A note of caution—there are several plugins available for Rucksack: make sure you install the right one! There is a Gulp plugin, but this does not appear to work within PostCSS, even though <a id="id547" class="indexterm"/>we are using Gulp as our task runner.</p><p>This aside, let's move on. Before we go through the process of converting our slider to use Rucksack, let's take a quick look at using it in action with a simple easing demo.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec91"/>Easing into using Rucksack</h2></div></div></div><p>Any developer who <a id="id548" class="indexterm"/>spends time animating content on a website will no doubt have created rules to control how content eases in or out of the page. Striking the right balance between easing content in and out of the page and the site becoming too overladen with effects takes time to get right!</p><p>Leaving aside the awful <a id="id549" class="indexterm"/>pun in that last comment, this is where Rucksack can help—one of the simpler plugins that forms part of this package is <code class="literal">postcss-easings</code>. This plugin, available from <a class="ulink" href="https://github.com/postcss/postcss-easings">https://github.com/postcss/postcss-easings</a> and one that we touched on in <a class="link" href="ch07.html" title="Chapter 7. Animating Elements">Chapter 7</a>, <em>Animating Content</em>, has but one role in life: convert any recognized easing name into a cubic-bezier equivalent value.</p><div><div><h3 class="title"><a id="tip22"/>Tip</h3><p>For an example of a Bezier curve, take a look at <a class="ulink" href="http://cubic-bezier.com/#.17,.67,.83,.67">http://cubic-bezier.com/#.17,.67,.83,.67</a>.</p></div></div><p>Is there any benefit in doing this, I hear you ask? Well, two that come to mind are consistency and a central point of source. Let me explain what I mean.</p><p>A central point of source borrows a principle from CSS preprocessors such as SASS or less, where a single value is defined at the top of the file; any instance found elsewhere in the file will be <a id="id550" class="indexterm"/>automatically replaced by its value (in this instance, a <code class="literal">cubic-bezier</code> easing). This then helps with consistency: we can specify names for any custom easings in the configuration, which will replace any instance found during compilation.</p><p>The benefit of this means that we only need to update one central point (that is, point of source), and can avoid mixing different types of easing values in our code—they will be converted to cubic-bezier values at compilation.</p><p>Okay, let's move<a id="id551" class="indexterm"/> on: time for a demo! Before we get stuck in, let's quickly cover what we're going to construct. Our demo is a simple affair with four squares that we will animate using nothing more than plain HTML and CSS (yes, no JavaScript). We will use a handful of effects, such as <code class="literal">easeOutBack</code>, which looks something like this:</p><div><img src="img/BO5194_09_04.jpg" alt="Easing into using Rucksack"/></div><div><div><h3 class="title"><a id="tip23"/>Tip</h3><p>You can learn more about the details for this particular easing at <a class="ulink" href="http://easings.net/#easeOutBack">http://easings.net/#easeOutBack</a>—it translates to <code class="literal">cubic-bezier(0.175, 0.885, 0.32, 1.275)</code> when used in code.</p></div></div><p>Let's get on and construct that demo…</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec92"/>Animating content using the plugin</h2></div></div></div><p>If you're expecting<a id="id552" class="indexterm"/> dramatic effects, then I am sorry to disappoint—this exercise has been kept deliberately simple, to show you how easy it is to use Rucksack. We mentioned earlier that the overall result will be four simple squares that we can animate at will—they will look something like this:</p><div><img src="img/BO5194_09_05.jpg" alt="Animating content using the plugin"/></div><p>The use of this plugin does raise one important question—we will cover this once we've built our demo:</p><div><ol class="orderedlist arabic"><li class="listitem">From the<a id="id553" class="indexterm"/> code download that accompanies this book, go ahead and extract a copy of the <code class="literal">T44 - postcss-easings</code> folder, and save it to the root of our project area.</li><li class="listitem">Next, copy the <code class="literal">gulpfile.js</code> and <code class="literal">package.json</code> files from this <code class="literal">T44 - postcss-easings</code> folder to the root of our project area—go ahead and replace any that are already present in this location, or save them somewhere for safekeeping.</li><li class="listitem">Copy the <code class="literal">style – pre-comile.css</code> file from the <code class="literal">css – completed versions</code> folder to the <code class="literal">src</code> folder within our project area; this sets it ready for compilation. Rename it <code class="literal">style.css</code>.</li><li class="listitem">Go ahead and fire up a Node.js command prompt session, then change the working folder to our project area.</li><li class="listitem">In the prompt, enter <code class="literal">Gulp</code> then press <em>Enter</em>—our file will be compiled, like this:<div><img src="img/BO5194_09_06.jpg" alt="Animating content using the plugin"/></div></li><li class="listitem">Assuming <a id="id554" class="indexterm"/>no issues appeared during compilation, copy the contents of the <code class="literal">dest</code> folder to the <code class="literal">css</code> folder within the <code class="literal">T44 - postcss-easings</code> folder.</li><li class="listitem">Try previewing the results of our handiwork in a browser—if we hover over each square, the animation will kick in; they should appear similar to the figure shown at the start of this exercise.</li></ol></div><p>Our demo was never meant to be anything more complicated—the aim was to show off how easy it is to get a consistent effect, provided the configuration object is correctly set up! It does, however, raise an important question concerning our choice of plugins, so let's explore that in more detail.</p><div><div><div><div><h3 class="title"><a id="ch09lvl3sec03"/>Dissecting our demo in more detail</h3></div></div></div><p>This is one<a id="id555" class="indexterm"/> example of where simplicity pays in spades; the <code class="literal">postcss-easings</code> plugin requires no configuration for standard use, and will only need configuring if the easing we use are not already part of its core library. The ones we picked for this demo are already defined in the plugin—if we open a copy of the compiled style sheet, we should see something akin to this:</p><div><img src="img/BO5194_09_07.jpg" alt="Dissecting our demo in more detail"/></div><p>The key to configuring this plugin lies in two lines of code, on or around lines 11 and 16:</p><div><pre class="programlisting">var rucksack = require('rucksack-css');
  .pipe(postcss([ rucksack() ]))</pre></div><p>Much of what is<a id="id556" class="indexterm"/> present in the Gulp task file that we used in this demo is code that we've already seen before; it frequently pays to think ahead, so that we can build a gulp file that can be reused for future projects. Once configured, then any style recognized by the plugin will be compiled into valid CSS.</p><p>If we had decided to use a custom easing style, then we can easily update the configuration object accordingly:</p><div><img src="img/BO5194_09_08.jpg" alt="Dissecting our demo in more detail"/></div><p>In case you're wondering about the name given—this effect replicates the motion when punching the air after you've achieved a good result, particularly if it has been a troublesome issue to solve!</p><p>Before we move on to our next exercise, we should answer the question that I alluded to earlier: which plugin should we use? But hold on, we're using the <code class="literal">postcss-easings</code> plugin, right?</p><p>No, I've not completely lost the plot: the <code class="literal">postcss-easings</code> plugin is available separately, and is referenced within the Rucksack pack of plugins. The key here, though, is that if we only need to use <code class="literal">postcss-easings</code>, then there is no sense in calling in Rucksack's plugins, which will only add an unnecessary burden to our workflow. Instead, we can change line 11 in our gulp task file to the following:</p><div><pre class="programlisting">var <strong>easings</strong> = require('<strong>postcss-easings</strong>');</pre></div><p>And we can change line 16 to the following:</p><div><pre class="programlisting">.pipe(postcss([ <strong>easings</strong>() ]))</pre></div><p>As long as the plugin is still installed from earlier, then the code will be compiled as before, but without the extra overhead of the other plugins that form Rucksack.</p></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec93"/>Converting our slider to use Rucksack</h2></div></div></div><p>If we're working with<a id="id557" class="indexterm"/> Rucksack, we've seen that the key to successful use is less about configuring it for use in our Gulp file, and more about deciding which plugins to use. To see what we mean by this, take a look at the original stylesheet from <em>Introducing our demo</em> carefully; it should reveal that we can use a number of plugins to improve on existing functionality:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Responsive typography</strong>: Our demo is already partially responsive, but the label text isn't resizing if <a id="id558" class="indexterm"/>we change the size of our slider. We can fix this by altering our code to trigger Rucksack to make our fonts responsive.</li><li class="listitem" style="list-style-type: disc"><strong>Shorthand positioning</strong>: This is a <a id="id559" class="indexterm"/>great plugin for <a id="id560" class="indexterm"/>adding position attributes; why bother adding top, left, right, and bottom attributes when we do all four in a single line of code? Add this one-liner, and we can get PostCSS to do the heavy lifting for us.</li><li class="listitem" style="list-style-type: disc"><strong>Property aliases</strong>: Continuing<a id="id561" class="indexterm"/> with the shorthand theme, we can use this plugin to set up shorthand versions of any attribute we care to use; it means we only need to type in one or two letters, which PostCSS will transpile to the full version of that attribute.</li><li class="listitem" style="list-style-type: disc"><strong>Font src expansion</strong>: If we look at our source style sheet carefully, we should see a small issue on or<a id="id562" class="indexterm"/> around line 6. The code calls for Open Sans as a font, but this is not a standard font! Thankfully, we can easily fix it by telling the browser where to download it from—Rucksack provides a convenient shorthand form for adding this detail to our code.</li><li class="listitem" style="list-style-type: disc"><strong>Hex RGBA shortcuts</strong>: We've used a mix of RGBA and HEX codes in our style sheet to represent <a id="id563" class="indexterm"/>colors, yet some older browsers don't support the former style. This is becoming less of an issue, but as it is added automatically by Rucksack, then there is no harm in adding the latter values!</li><li class="listitem" style="list-style-type: disc"><strong>Easings</strong>: Our slider <a id="id564" class="indexterm"/>demo used a single instance of an easing, in the form of ease-in-out-back. In the previous demo, we used <code class="literal">postcss-easings</code> (that is the basis for this part of Rucksack) to convert the names to <code class="literal">cubic-bezier</code> values; we should look to continue this theme when updating the slider.</li><li class="listitem" style="list-style-type: disc"><strong>Automatic prefixing</strong>: This isn't enabled by default, so it's up to us to decide if we want to use it. It<a id="id565" class="indexterm"/> references the same <code class="literal">autoprefixer</code> plugin we've already used in earlier demos; if we're going to make good use of Rucksack, then it makes sense to enable it and remove any existing reference that is already in our code. We're going to use most of the plugins referenced in Rucksack, so we will enable it for use. If, however, we only need one or two, or we don't need support for older browsers, then it can remain switched off.</li><li class="listitem" style="list-style-type: disc"><strong>Legacy fallbacks</strong>: Support for older browsers is provided by the laggard plugin in Rucksack. This <a id="id566" class="indexterm"/>provides a mix of fallback mechanisms, such as adding fallback support for rem values, HEX fallbacks for RGBA values, or the 3D transform hack for will-change. We'll be adding rem fallback support, so we will enable this plugin for use.</li></ul></div><p>Now that we've covered the elements we want to use, it's time for us to make the changes. Without further ado, let's make a start:</p><div><ol class="orderedlist arabic"><li class="listitem">From the code download that accompanies this book, go ahead and extract a copy of the <code class="literal">T45 - converting to use Rucksack</code> folder, and save it to our project area.</li><li class="listitem">From within the <code class="literal">T45 - converting to use Rucksack</code> folder, copy the <code class="literal">gulpfile.js</code> and <code class="literal">package.json</code> files to the root of our project area.</li><li class="listitem">Next, copy the contents of the <code class="literal">css-completed</code> version folder from within the <code class="literal">T45 - converting to use Rucksack</code> folder to the <code class="literal">src</code> folder at the root of our project area. Rename pre-compile <code class="literal">version.css</code> <code class="literal">style.css</code>, then open up this file in a text editor—we need to make some changes to the styles within the file.</li><li class="listitem">Our first change<a id="id567" class="indexterm"/> is to make the text in our demo responsive—do a search for <code class="literal">font-size</code>, and change any instance to <code class="literal">font-size:</code> <code class="literal">responsive</code>. This should cover each of the five number labels, and the <code class="literal">div.slide-content &gt; figcaption</code> rule.</li><li class="listitem">Next up, is adding our shorthand version for the position attribute—in this instance, there is only one we can change, which is on line 42. Comment out the <code class="literal">bottom</code>, <code class="literal">left</code>, <code class="literal">right</code>, and <code class="literal">top</code> attributes specified on lines 33-36, then replace the <code class="literal">position:</code> attribute with this:<div><pre class="programlisting">position: 427px 0 0 0;</pre></div><div><div><h3 class="title"><a id="note45"/>Note</h3><p>Note, the other instances of position can't be changed as we've not specified individual placement values in these rules.</p></div></div></li><li class="listitem">Our next conversion is to add some aliases—this is just a shortcut to typing in more text! For our demo, go ahead and add this at the top of our style sheet:<div><pre class="programlisting">@alias {
  pb: padding-bottom;
  bs: box-shadow;
  bgc: background-color;
}</pre></div></li></ol></div><p>Next, do a search and replace for each of these three styles—replace the full name with the shortcut names given in the <code class="literal">@alias</code> block.</p><div><ol class="orderedlist arabic"><li class="listitem">Remember the small issue I pointed out earlier, about the missing support for the Open Sans font? Well, we can easily fix that—at the top of our style sheet file, go ahead and add this block; this tells the browser where to find the Open Sans font:<div><pre class="programlisting">@font-face {
  font-family: 'open_sansregular';
  font-path: '../fonts/OpenSans-Regular-webfont';
  font-weight: normal;
  font-style: normal;
}</pre></div></li><li class="listitem">We touched briefly on Rucksack's ability to convert easing names to cubic-bezier values. The demo uses an easing name—this has already been set to one that is supported within Rucksack, so we don't need to alter our code. The same applies to the RGBA fall-back support—Rucksack will automatically convert any RGBA values it sees to HEX equivalents within our code.</li><li class="listitem">The remaining two<a id="id568" class="indexterm"/> changes are for legacy support and automatic prefixing—to enable these, we have to modify our gulp file as shown in the screenshot:<div><img src="img/BO5194_09_09.jpg" alt="Converting our slider to use Rucksack"/></div></li><li class="listitem">Save the file, then switch to a Node.js command prompt—at the prompt, make sure the working folder is set to our project area.</li><li class="listitem">At the prompt, enter <code class="literal">gulp</code>, then press <em>Enter</em>—PostCSS will go away and compile the code; if all is well, we should see our compiled files in the <code class="literal">dest</code> folder:<div><img src="img/BO5194_09_10.jpg" alt="Converting our slider to use Rucksack"/></div></li></ol></div><p>At this stage, we have a compiled set of files. To confirm if the demo works, go ahead and copy them to the <code class="literal">css</code> folder within the <code class="literal">T45 - converting to use Rucksack</code> folder; try previewing the results of our work by running <code class="literal">slider.html</code>. If all is well, we should see the same slider effect:</p><div><img src="img/BO5194_09_11.jpg" alt="Converting our slider to use Rucksack"/></div><p>All should be good, we have<a id="id569" class="indexterm"/> a working demo and our code has compiled successfully. At this point we can move on to our next task, right…?</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec94"/>Dissecting our code</h2></div></div></div><p>Well, it's worth taking a<a id="id570" class="indexterm"/> look at our compiled code first: Rucksack has made some additional changes to our code that we may not have expected to see.</p><p>For example, Rucksack has provided pixel-based fallback support for the rem units listed throughout our code, along with the HEX fallback support we discussed earlier:</p><div><pre class="programlisting">body {
  font-family: "open_sansregular";
  line-height: 25.888px;
  line-height: 1.618rem;
  background-color: #ecf0f1;
  background-color: rgba(236, 240, 241, 1.0);
  color: #44466a;
  color: rgba(68, 68, 618, 1.0);
}</pre></div><p>Next, take a look at line 96—remember the <code class="literal">font-size: responsive</code> attribute that we added? This is the compiled result:</p><div><pre class="programlisting">font-size: calc(12px + 9 * ( (100vw - 420px) / 860));</pre></div><p>Throughout the bottom two-thirds, there are a number of media queries that have been added; these were added as part of making our font styles responsive. Further down, at around line 226, we have this block:</p><div><pre class="programlisting">-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
 -webkit-transition: opacity 0.35s;
 transition: opacity 0.35s;</pre></div><p>At first glance, you might wonder where this came from, as we didn't specify an <code class="literal">ms-filter</code> attribute in our code. Well, this is thanks to Rucksack—it has added opacity support for IE automatically.</p><p>The key to this little exploration, though, is that choosing plugins should be an iterative process that will<a id="id571" class="indexterm"/> only really finish when the site is no longer needed. For example, we could easily add another step to our workflow that reduces <code class="literal">calc()</code> operations to static values (where allowed—the plugin for this is <code class="literal">postcss-calc</code>). We should always consider using <code class="literal">postcss-remove-prefixes</code> periodically to keep our code up to date; there will come a time when we either don't need to add prefixes, or existing prefixes become redundant.</p><p>Leaving aside the changes to our style sheet, there is one more to consider—you will note that the Autoprefixer plugin has been commented out in our code:</p><div><img src="img/BO5194_09_12.jpg" alt="Dissecting our code"/></div><p>This is with good reason—Rucksack has built-in support for <code class="literal">autoprefixer</code>, so there is no need to call it twice; ironically, it simply calls the same plugin that is commented out of our code! It's up to us whether we want to call it from within Rucksack, or separately; this will largely depend on what else is being called from with Rucksack, and whether adding <code class="literal">autopre</code>
<code class="literal">fixer</code> will help provide a stronger case for using Rucksack.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch09lvl1sec77"/>Linting and optimizing your code</h1></div></div></div><p>Bandwidth usage has always been critical to the success of a website; remember the good old days of 56K modems? We've come a long way since then, but this is still no excuse for producing sites that swallow bandwidth like it's going out of fashion!</p><p>A part of this<a id="id572" class="indexterm"/> comes in the form of linting and minifying our style sheets before deploying<a id="id573" class="indexterm"/> into production use—it goes without saying that this should form part of any developer's workflow process by default. We can do this manually, but this manual job is prone to missing opportunities, which can lead to inconsistencies in our code.</p><p>Instead, we can use the power of PostCSS to perform the heavy lifting for us; the <code class="literal">stylelint</code> and <code class="literal">cssnano</code> plugin packs make for a powerful optimization facility! If we take a careful look at most gulp task files that we've created throughout the course of this book, both processes are taking place; in this example, <code class="literal">stylelint</code> is used at line 22, and <code class="literal">cssnano</code> at line 38:</p><div><img src="img/BO5194_09_13.jpg" alt="Linting and optimizing your code"/></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec95"/>Exploring the use of cssnano</h2></div></div></div><p>For anyone<a id="id574" class="indexterm"/> starting out with PostCSS for the first time, then simply specifying <code class="literal">cssnano()</code> as one of the processors for PostCSS should be sufficient:</p><div><img src="img/BO5194_09_14.jpg" alt="Exploring the use of cssnano"/></div><p>If we take a look at the <code class="literal">T45 – converting to use Rucksack</code> demo, our original style sheet file weighs in at 4KB when compiled, but which drops to 3KB after compression. Granted, it's only a small file, but a 25% drop in size is still not an insignificant drop!</p><div><div><h3 class="title"><a id="tip24"/>Tip</h3><p>At this point, it is worth noting that even though we are using Gulp, the plugin in use is the PostCSS version, and not <code class="literal">gulp-cssnano</code>.</p></div></div><p>The <code class="literal">cssnano</code> plugin is not a single plugin, but a wrapper for a number of plugins, which include examples <a id="id575" class="indexterm"/>such as these:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">postcss-reduce-idents</code>: This reduces <a id="id576" class="indexterm"/>any custom identifier names (such as those used in <code class="literal">@keyframes</code>) to two letter equivalent codes; this helps with minifying code.</li><li class="listitem" style="list-style-type: disc"><code class="literal">postcss-zindex</code>: This <a id="id577" class="indexterm"/>plugin reduces any <code class="literal">z-index</code> declarations that are unnecessarily higher than they should be.</li><li class="listitem" style="list-style-type: disc"><code class="literal">postcss-convert-values</code>: If our CSS uses any number of different units, then we can reduce the CSS size by <a id="id578" class="indexterm"/>expressing the value a different way. For example, <code class="literal">400ms</code> can be expressed as <code class="literal">.4s</code> (a reduction by two characters). Some might argue this is a little extreme, but every little helps!</li><li class="listitem" style="list-style-type: disc"><code class="literal">postcss-colormin</code>: In a<a id="id579" class="indexterm"/> similar vein, we can reduce the length of color names using this plugin: if <code class="literal">rgba(255, 0, 0, 1)</code> is used in our code, then we can replace this with <code class="literal">red</code>. Although the name is indeed shorter, this is at the expense of losing consistency with naming our colors, which may not be so desirable.</li></ul></div><p>Moving on, there are <a id="id580" class="indexterm"/>some key points we should be aware of, when using <code class="literal">cssnano</code>:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You will notice the presence of the gulp-rename plugin in use within our Gulp file—<code class="literal">cssnano</code> does not have a capability to rename a compressed file to something we would expect to see within our code. We can use <code class="literal">gulp-rename</code> to create a version that developers would expect to see in code; it does leave a copy of the original file in place, if needed.</li><li class="listitem" style="list-style-type: disc">Most options within <code class="literal">cssnano</code> are enabled by default; we can switch off individual ones in the configuration object, as shown in this example:<div><pre class="programlisting">var nano = require('gulp-cssnano');

gulp.task('default', function () {
    return gulp.src('./main.css')
        .pipe(nano({<strong>discardComments: {removeAll: true}</strong>}))
        .pipe(gulp.dest('./out'));
});</pre></div><div><div><h3 class="title"><a id="tip25"/>Tip</h3><p>For a full list of the transform options, take a look at <a class="ulink" href="http://cssnano.co/options/">http://cssnano.co/options/</a>. Click on the link to view individual configuration options for that plugin.</p></div></div></li></ul></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">This plugin automatically includes autoprefixer. Technically, there is no need to include it <a id="id581" class="indexterm"/>separately as we have done in previous exercises, so ideally it should be removed. We will focus on this more as part of optimizing our processor in <a class="link" href="ch10.html" title="Chapter 10. Building a Custom Processor">Chapter 10</a>, <em>Building a Custom Processor</em>.</li><li class="listitem" style="list-style-type: disc">There are some<a id="id582" class="indexterm"/> transforms that are available within <code class="literal">cssnano</code>, but which are <em>not</em> switched on by default; these are not considered safe and should only be included if you are 100% sure it has not affected your code. The details of unsafe transforms are available on the <code class="literal">options</code> page at <a class="ulink" href="http://cssnano.co/options/">http://cssnano.co/options/</a>.</li></ul></div><p>Okay, let's move on: the second half of our double act is the <code class="literal">stylelint</code> plugin pack; unlike <code class="literal">cssnano</code>, <code class="literal">stylelint</code> takes the opposite approach and allows you to enable any rule as needed, from a list of over 100 available rules. Let's dive in and take a look in more detail.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec96"/>Configuring Stylelint as our linter</h2></div></div></div><p>How does one describe Stylelint, if you've never met it before? Well, to quote its website, "stylelint is a <a id="id583" class="indexterm"/>mighty, modern CSS linter".</p><p>Whether we agree with<a id="id584" class="indexterm"/> such a bold statement, it is certainly worth getting to know Stylelint as a linter. Available from <a class="ulink" href="http://stylelint.io/">http://stylelint.io/</a>, the key to this plugin lies not in the plugin itself, but in the rules that define what we want to check in our code. At present, we can use any one of 100+ rules, or a mix of several; these can be specified in a <code class="literal">.styleintrc</code> file, within our <code class="literal">package.json</code> file, or as a <code class="literal">stylelint.config.js</code> file that exports a JavaScript object.</p><p>We've already used <code class="literal">stylelint</code> in earlier projects; for convenience, our Gulp task for linting styles has a number of rules specified within the object:</p><div><img src="img/BO5194_09_15.jpg" alt="Configuring Stylelint as our linter"/></div><p>I've chosen a number of rules to illustrate how we can use Stylelint; it is, of course, up to each of you as developers to choose which rules you want to test as part of linting your code. Stylelint<a id="id585" class="indexterm"/> does not contain a core set of rules that are enabled by <a id="id586" class="indexterm"/>default—any checking it does will be dependent on what is specified in the rule configuration.</p><div><div><h3 class="title"><a id="tip46"/>Tip</h3><p>A useful source to bookmark is <a class="ulink" href="http://stylelint.io/">http://stylelint.io/</a>—this contains a full set of rules that can be added to our Stylelint configuration prior to compiling code.</p></div></div><p>For example, if we were building a responsive site that made heavy use of the Golden Rule, we may want to limit any percentage values to no more than three or four places. For this, we would specify the <code class="literal">number-max-precision</code> rule—this takes an integer value; specifying <code class="literal">3</code> would flag warnings for these two attributes:</p><div><pre class="programlisting">.foo { top: 3.2456px; }
.foo { top: 3.245634px; }</pre></div><p>This is not the case for this one:</p><div><pre class="programlisting">@media (min-width: 3.234em) {...}</pre></div><p>I would strongly recommend reading through the list of rules to get a flavor of what is available; it will take time to familiarize yourselves with the contents, but the reward will be code that is optimized and checked prior to it being used in a production environment. There is one small point though—even if we optimize our code ad infinitum, there is always a possibility that we still have to include some support for older browsers.</p><p>In an ideal world, we would convince our clients of the merits of limiting such support (or not even covering it). If clients insist on it, however, against our better judgment, then PostCSS can easily <a id="id587" class="indexterm"/>help with providing that support. Let's explore what is available—much of this will center around IE (as this is the biggest culprit), but will equally apply to other browsers.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch09lvl1sec78"/>Providing fallback support</h1></div></div></div><p>A key concern when designing web content is browser support—which browsers do we support? If the only browsers we had to support were the likes of Firefox or Chrome, then our job would be easy. Trouble is, we also have IE, Safari, Edge…not to mention mobile devices! Life would be boring otherwise…</p><p>But I digress, back to<a id="id588" class="indexterm"/> reality: for those legacy browsers that refuse to conform (yes, I'm looking at you in particular, IE), we have to consider providing some form of support or graceful degradation. Thankfully, there are a number of plugins we can use within the PostCSS ecosystem—we've already used one in the form of Autoprefixer; there are others available, so let's dive in and take a look at a selection of these plugins in more detail. Before we do so, though, there is a useful tip that I want to explore, which can help with checking for, and providing, legacy support in our browsers.</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec97"/>Detecting support for features</h2></div></div></div><p>A key part of the<a id="id589" class="indexterm"/> development process is to ensure that our code works on those browsers we have to support. If we're lucky enough that this range of browsers is limited to newer offerings, then this is less of an issue.</p><p>For some developers, there will be a need to have to support older browsers; this is particularly true if the environment contains other browser-based applications that require use of these older browsers, and cannot be replaced.</p><p>To help get around this, we could use libraries <a id="id590" class="indexterm"/>such as Modernizr (<a class="ulink" href="http://www.modernizr.com">http://www.modernizr.com</a>), but a more efficient means is to use the CSS <code class="literal">@supports</code> directive. In short, this operates in a similar fashion to media queries; we can specify a backup property that is supported by all browsers, and cancel it out if we're using a browser that can support an enhanced property:</p><div><pre class="programlisting">section {
  float: left;
}

@supports (display: -webkit-flex) or (display: flex) {
  section {
    display: -webkit-flex;
    display: flex;
    float: none;
  }
}</pre></div><p>In the main, this is more likely to be useful for those who have to provide support for older versions of IE (given that other browsers have offered better support for some time). Ideally, we <a id="id591" class="indexterm"/>would look to persuade clients of the merits of not supporting older versions of IE (at least 8, and possibly 9). If we have to support them, this method coupled with the use of autoprefixer could prove very useful.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec98"/>Providing support for oldie</h2></div></div></div><p>When it comes to <a id="id592" class="indexterm"/>providing support for legacy browsers, the biggest culprit is arguably Microsoft's IE. Whilst it has to be said that support in newer versions is improving, its popularity means that there are still enough old versions to warrant the need to provide support!</p><p>To their credit, Microsoft have <a id="id593" class="indexterm"/>announced that they no longer support IE8 to 10—this is a step in the right direction to help encourage users to upgrade, although it will be some time before these versions completely disappear from use.</p><p>So, if you still have to support old versions of IE, what can we do? A good solution to try out is the oldie pack of plugins; its name makes a reference to what some term oldIE, or those versions of IE that should have been consigned to history a long time ago!</p><p>This plugin, available <a id="id594" class="indexterm"/>from <a class="ulink" href="https://github.com/jonathantneal/oldie">https://github.com/jonathantneal/oldie</a>, is a wrapper for a host of plugins available within PostCSS; examples include the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">post-calc</code>: This reduces<a id="id595" class="indexterm"/> any instance of <code class="literal">calc()</code> to single values where possible; instances of <code class="literal">calc()</code> that use a mix of units may not be replaced</li><li class="listitem" style="list-style-type: disc"><code class="literal">postcss-unroot</code>: If our CSS <a id="id596" class="indexterm"/>uses :root selectors, then old versions of IE will fail; this plugin replaces them with HTML to allow our code to compile</li><li class="listitem" style="list-style-type: disc"><code class="literal">postcss-unnot</code>: In a similar<a id="id597" class="indexterm"/> vein, if we've specified rules that include elements where <code class="literal">:not</code> pseudo-elements have been used, then these selectors will be removed</li><li class="listitem" style="list-style-type: disc"><code class="literal">postcss-unopacity</code>: This <a id="id598" class="indexterm"/>converts any instance of the opacity property to use <code class="literal">filter: alpha(opacity=XX)</code>, where <code class="literal">XX</code> is the equivalent value for the original opacity property</li></ul></div><p>The pack includes other plugins—to get a feel for what plugins are included, it's worth taking a look at the <code class="literal">index.js</code> file for the plugin pack; it will look something like this:</p><div><img src="img/BO5194_09_16.jpg" alt="Providing support for oldie"/></div><p>The beauty, though, is that we are not forced to use the oldie plugin in its entirety. If, by some quirk of fate, we've managed to create something that in the main avoids those CSS attributes that are likely to make oldIE choke, then we can opt to simply reference those plugins that we need to use instead.</p><p>This will, of <a id="id599" class="indexterm"/>course, depend on how much we've used—a more likely scenario is that we will end up needing to use all of the plugins, so it makes better sense to use oldie instead! Of course, we could always encourage our clients to drop oldIE—this might not be as simple as it sounds…</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec99"/>Removing style hacks from code</h2></div></div></div><p>If we're lucky <a id="id600" class="indexterm"/>enough to have understanding clients—and chance would be a fine thing—then there is likely to be a task that we need to perform: remove any style hacks from our code that relate to browsers we no longer support. The removal of these hacks may be trivial if we only have a small style sheet; the reality is that it will likely be a long, manual process for larger sheets, which carries a risk of us missing hacks.</p><p>Instead, we can avail ourselves of a plugin, in the form of stylehacks; this works very well with the <code class="literal">stylelint</code> plugin we've<a id="id601" class="indexterm"/> already used in demos throughout this book. Available from <a class="ulink" href="https://github.com/ben-eb/stylehacks">https://github.com/ben-eb/stylehacks</a>, the plugin uses hacks listed on <a class="ulink" href="http://browserhacks.com">http://browserhacks.com</a>, and is a cinch to install—let's take a look at it in <a id="id602" class="indexterm"/>action:</p><div><ol class="orderedlist arabic"><li class="listitem">We'll start by extracting a copy of the <code class="literal">T47 - using stylehacks</code> folder from the code download that accompanies this book; save it to the root of our project folder.</li><li class="listitem">Copy the <code class="literal">gulpfile.js</code> and <code class="literal">package.json</code> files to the root of the project folder.</li><li class="listitem">In a text editor, go<a id="id603" class="indexterm"/> ahead and add this code, saving it as <code class="literal">style.css</code> in the <code class="literal">src</code> folder in our project area (<em>not</em> within the <code class="literal">T47 - using stylehacks</code> folder!):<div><pre class="programlisting">h1 {
  _color: white;
  color: rgba(255, 255, 255, 0.5);
}</pre></div></li><li class="listitem">Next, fire up a Node.js command prompt session, then change the working folder to our project area.</li><li class="listitem">We now need to install the plugin—in the prompt, enter this command, then press <em>Enter</em>:<div><pre class="programlisting"><strong>npm install stylehacks --save-dev</strong>
</pre></div></li><li class="listitem">When the plugin has installed, go ahead and enter <code class="literal">gulp</code> in the prompt, then press <em>Enter</em>.</li><li class="listitem">PostCSS will compile our code—if all is well, we should see this in the <code class="literal">dest</code> folder at the root of our project area:<div><img src="img/BO5194_09_17.jpg" alt="Removing style hacks from code"/></div></li></ol></div><p>Assuming we have a successful compilation, try opening the <code class="literal">style.css</code> file in a text editor—we will, of course, have the requisite source map directive at the foot of the code, but otherwise notice how it has removed the color hack:</p><div><img src="img/BO5194_09_18.jpg" alt="Removing style hacks from code"/></div><p>The key to this <a id="id604" class="indexterm"/>process lies within this task in our Gulp file:</p><div><pre class="programlisting">gulp.task('styles', function () {
  return gulp.src('src/*.css')
    .pipe(postcss([ stylehacks({browsers: 'last 1 version, &gt; 10%'}) ]))
    .pipe(gulp.dest('dest/'));
});</pre></div><p>In our Gulp file, we've added the browsers attribute—this tells stylehacks to remove any hacks that are <em>not</em> required for modern browsers or those that have more than <code class="literal">10%</code> global usage. This setting is based on<a id="id605" class="indexterm"/> the Browserslist query list available from <a class="ulink" href="https://github.com/ai/browserslist">https://github.com/ai/browserslist</a>—it's worth noting that this can be used for plugins such as Autoprefixer as well.</p><div><div><h3 class="title"><a id="note47"/>Note</h3><p>If we start to include more plugins that make use of the Browserslist queries, then consider using a variable in place of the query; updating this from a central location will automatically update all plugins that use it accordingly. For more details, please refer to the Browserslist site on GitHub.</p></div></div><p>Although this is a simple plugin to use, there is one nagging question that kept coming back whilst researching for this book: how useful is this plugin in reality? For some, you may think I need my head examined, but there is a reason behind this—let me explain.</p><p>If you've spent any time developing with jQuery, then you should be aware that it has dropped support for <code class="literal">IE6</code>-<code class="literal">8</code> from jQuery 2.x, and will only develop support for it within the 1.x branch. Much of the baggage within jQuery within the 1.x branch is based on catering for browser hacks; the biggest culprit for these hacks is IE!</p><p>At the time of writing, Microsoft have publicly stated that support for IE10 and below is being dropped (at least for Windows 8)—they will only support IE11 on the Windows 8.1 platform, plus their new browser, MS Edge.</p><p>Given that many <a id="id606" class="indexterm"/>of the hacks found in CSS are for IE (and that this also applies to jQuery), one can't but wonder if the stylehacks plugin will still remain useful within the not too distant future! We should also be asking ourselves if using hacks is a good design decision. Are we designing a problem for ourselves at a later date, or should we be reconsidering our original design, and perhaps revisiting whether we need to support older browsers with a dedicated style sheet, rather than introducing hacks in amongst code designed for more recent browsers?</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch09lvl1sec79"/>Summary</h1></div></div></div><p>A key part of PostCSS is exploring the ever-increasing array of plugins available for the PostCSS ecosystem; in some respects, it can be likened to a journey of discovery. This is no different for single plugins, or those available within packs—we've already seen that many of these packs are made up of the same plugins that are available individually! Let's take a moment to review what we've learnt.</p><p>We kicked off our journey with a look at working with plugins that can help save time with writing—these can either be those that allow us to write in shorthand, or those that add missing styles, based on styles we specify in code. These also included some plugins that help provide fallback support for older browsers.</p><p>We then moved onto working with the <code class="literal">postcss-short</code> plugin, as an example of how we can reduce development time, before moving on to explore the Rucksack suite of plugins that can help add some of the missing elements we may need to use in CSS. To explore how Rucksack works, we started with a simple easing demo, before working our way through a more complex demo of a slider and converting it to use Rucksack, and exploring some of the ways in which this plugin pack can help in our development.</p><p>Next up in our journey came a look at what should be a crucial part of any development workflow for a developer—checking our code for consistency, and optimizing it. We covered the use of the <code class="literal">cssnano</code> and <code class="literal">stylelint</code> plugins, and how they can be tailored to our needs.</p><p>We then rounded out the chapter by revisiting support for older browsers—we supplemented our earlier visit with a more in-depth look at what is available within PostCSS; we explored the fact that many fallbacks are primarily caused by IE, and discussed how we can either help support older versions of this browser, or whether we should consider consigning support for some older browsers to history.</p><p>Phew, this was a real whirlwind tour through the plugin packs available for PostCSS! Our journey does not stop here, as we now need to pull all of the last few chapters together and produce a complete custom processor—this will be the subject of the next chapter.</p></div></body></html>