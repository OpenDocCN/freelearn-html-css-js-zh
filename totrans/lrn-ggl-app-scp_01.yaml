- en: Chapter 1. Introducing Google Apps Scripts
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1章. 介绍Google Apps Script
- en: I know there may not be a single person in the world who has access to the Internet
    who has not used at least one of Google's products or services in their lifetime.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 我知道在世界上可能没有一个人在一生中从未使用过谷歌的任何产品或服务。
- en: Google is known for its famous search engine, the video serving portal YouTube,
    and now by its numerous web applications, namely Gmail, Calendar, Drive, Docs,
    Sheets, and Forms. It also provides cloud computing and other software services.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 谷歌以其著名的搜索引擎、视频服务门户YouTube，以及其众多的网络应用而闻名，包括Gmail、日历、Drive、文档、表格和表单。它还提供云计算和其他软件服务。
- en: The word "Google" has even become a verb, referring to conducting a web search.
    Nowadays, you hear people saying "I Googled something" rather than "I searched
    the web for something". In this chapter, you will learn about Google Applications,
    Application Scripts, and how to create a custom formula/function.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: “谷歌”这个词甚至已经成为一个动词，指的是进行网络搜索。如今，你听到人们说“我Googled某事”而不是“我在网上搜索某事”。在本章中，你将了解Google应用、应用脚本以及如何创建自定义公式/函数。
- en: Google Applications
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google应用
- en: Google Applications are a collection of applications, namely Gmail, Calendar,
    Drive, Docs, Sheets, and Forms. From now on, we will use the term "Google Apps"
    or just "Apps".
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: Google应用是一系列应用的集合，包括Gmail、日历、Drive、文档、表格和表单。从现在起，我们将使用“Google应用”或简称“Apps”这个术语。
- en: 'Before we start, I''ll quickly answer a few questions you may have:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始之前，我会快速回答你可能会有的几个问题：
- en: Where do all these Apps run? On your computer?
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有这些应用在哪里运行？在你的电脑上？
- en: No, all these Apps run on Google's Cloud-based servers.
  id: totrans-8
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 不，所有这些应用都运行在谷歌的基于云的服务器上。
- en: How can you get access to these applications?
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你如何获取这些应用的访问权限？
- en: You can interact with these Apps through web browsers. No special hardware or
    software installations are required except for a modern web browser installed
    on your desktop, laptop, tablet, or smartphone.
  id: totrans-10
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你可以通过网络浏览器与这些应用交互。除了在你的桌面、笔记本电脑、平板电脑或智能手机上安装的现代网络浏览器外，不需要特殊的硬件或软件安装。
- en: '![Google Applications](img/B05010_01_01.jpg)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![Google应用](img/B05010_01_01.jpg)'
- en: Google Apps Script
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google Apps Script
- en: You can customize or automate Google Apps using the JavaScript scripting language
    with Google-defined classes, known as **Google Apps Script** (**GAS**). Google
    implements GAS based on JavaScript 1.6 with some portions of 1.7 and 1.8\. The
    GAS services and APIs provide easy access so users can automate tasks across Google
    products and third-party services.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用JavaScript脚本语言以及谷歌定义的类（称为**Google Apps Script**（**GAS**））来自定义或自动化Google应用。谷歌基于JavaScript
    1.6以及1.7和1.8的部分实现GAS。GAS服务和API提供了方便的访问，用户可以自动化跨谷歌产品和第三方服务的任务。
- en: You can write code in Google Docs, Sheets, and Forms using GAS and can automate
    tasks similar to what Visual Basic for Applications does in Microsoft Office.
    However, GAS runs on Google's server and the results are rendered in your browser.
    The integrated script editor allows you to edit and debug your scripts within
    your browser, and you do need not install anything. You can activate your debugged
    and tested script functions to run either based on your interactions or based
    on a trigger in response to an event or timed intervals (in minutes, hours, days,
    weeks, future dates, and so on). These events include `onOpen`, `onEdit`, `onInstall`,
    and many more. GAS is also used to create add-ons for Docs, Sheets, and Forms.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用GAS在Google Docs、Sheets和Forms中编写代码，并自动化类似于Visual Basic for Applications在Microsoft
    Office中执行的任务。然而，GAS在谷歌的服务器上运行，结果在浏览器中呈现。集成的脚本编辑器允许你在浏览器内编辑和调试你的脚本，你不需要安装任何东西。你可以激活调试和测试过的脚本功能，使其基于你的交互或基于对事件或时间间隔（分钟、小时、天、周、未来日期等）的触发器运行。这些事件包括`onOpen`、`onEdit`、`onInstall`等。GAS还用于创建Docs、Sheets和Forms的附加组件。
- en: GAS can help you with every aspect of automating a task—you can even use it
    to order a pizza at predetermined date/time!
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: GAS可以帮助你自动化任务的各个方面——你甚至可以用它来在预定的时间/日期订购披萨！
- en: Visual Basic for Applications
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Visual Basic for Applications
- en: Microsoft implements **Visual** **Basic for Applications** (**VBA**) to help
    automate Office applications such as Excel and Word. For each respective application,
    VBA is known as Excel VBA or Word VBA and so on. Using Excel VBA, you can create
    macros for Excel known as "Excel macros". GAS is for Google Applications, and
    operates in the same way as VBA does for Microsoft Office applications. Although
    both VBA and GAS do not require a separate compilation process, they are very
    different scripting languages and use different programming APIs, methods, and
    properties.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 微软实现了**应用程序的Visual Basic**（**VBA**）来帮助自动化如Excel和Word等Office应用程序。对于每个相应的应用程序，VBA被称为Excel
    VBA或Word VBA等等。使用Excel VBA，您可以创建Excel的宏，称为“Excel宏”。GAS是针对谷歌应用的，其操作方式与VBA对微软Office应用程序的方式相同。尽管VBA和GAS都不需要单独的编译过程，但它们是两种非常不同的脚本语言，并使用不同的编程API、方法和属性。
- en: I hope many of you are familiar with using VBA for Office applications; if not,
    then never mind—that's not an obstacle to learning GAS.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望你们中的许多人熟悉使用VBA进行Office应用程序；如果不熟悉，那也没关系——这并不是学习GAS的障碍。
- en: The advantages of GAS over VBA
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: GAS相对于VBA的优势
- en: '**Version-independence**: Sheets/Docs along with scripts are automatically
    saved in the cloud, attached to your Google account, and accessible from any computer
    with a browser. There is no need to worry whether the other computer has the same
    version of Sheets/Docs installed or not, whereas we can never be sure that one
    version of the Excel/Word macros will work on another version.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**版本无关性**：Sheets/Docs以及脚本会自动保存在云端，附加到您的谷歌账户，并且可以从任何带有浏览器的计算机访问。您无需担心其他计算机是否安装了相同的Sheets/Docs版本，而我们也无法保证Excel/Word宏的一个版本能在另一个版本上工作。'
- en: '**Platform-independence**: When you create VBA macros in Excel/Word on the
    Windows platform, they may not work on the Mac platform and vice versa. With Google
    Sheets/Docs, it doesn''t matter what platform you''re working on—it''ll work.'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平台无关性**：当您在Windows平台上创建Excel/Word的VBA宏时，它们可能在Mac平台上不起作用，反之亦然。使用Google Sheets/Docs，您的工作平台无关紧要——它都会工作。'
- en: The limitations of GAS
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: GAS的限制
- en: GAS runs on Google's server, so it cannot run continuously for more than six
    minutes (this may vary in the future). All of your functions should finish running
    and should return results within this time limit. Don't panic, as you'll learn
    how to use triggers effectively to overcome these limitations later.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: GAS在谷歌的服务器上运行，因此它不能连续运行超过六分钟（这可能在将来有所变化）。您所有的函数都应该在规定时间内完成运行并返回结果。不要慌张，因为您将在后面学习如何有效地使用触发器来克服这些限制。
- en: In the following sections, we will take a look at the most popular Google Apps
    and how we can use GAS to customize and/or automate tasks.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下章节中，我们将探讨最受欢迎的谷歌应用以及如何使用GAS来自定义和/或自动化任务。
- en: Google Drive
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google Drive
- en: 'Google Drive is a file storage application, which from now on we will just
    refer to as "Drive", where you can store and synchronize your files on Google''s
    server. Let''s look at some of the advantages of using Drive:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: Google Drive是一个文件存储应用程序，从现在起我们将简单地称之为“Drive”，您可以在谷歌的服务器上存储和同步您的文件。让我们看看使用Drive的一些优点：
- en: You can edit and share Google Docs, Sheets, and Forms with your friends or collaborators
    in real time.
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您可以实时编辑和分享Google Docs、Sheets和Forms与您的朋友或协作者。
- en: You can even stop editing a document on one of your desktops and continue with
    your smartphone or tablet, and vice versa, no matter where you are and what device
    you are using. This is possible because your files are stored on Google's Cloud
    server.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您甚至可以在您的台式机上停止编辑一个文档，并继续使用智能手机或平板电脑，反之亦然，无论您身在何处，使用什么设备。这是因为您的文件存储在谷歌的云服务器上。
- en: Files created with Google Apps are stored in Drive with Google's native formats
    and extensions. For example, Google Docs (documents) files are `.gdoc`, Google
    Sheets (spreadsheets) are `.gsheet`, and so on.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用谷歌应用创建的文件存储在Drive中，使用谷歌的本地格式和扩展名。例如，Google Docs（文档）文件是`.gdoc`，Google Sheets（电子表格）是`.gsheet`，等等。
- en: In addition to Google's native files, you can also store or upload any other
    type of file from your desktop to Google Drive.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 除了谷歌的本地文件外，您还可以从您的桌面存储或上传任何其他类型的文件到Google Drive。
- en: Note
  id: totrans-31
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: If you would like to synchronize files on your computer or devices with Drive,
    then you can install special software called **Google Drive Client Application**.
    While this application is running on your computer or device, it synchronizes
    files stored locally with the same files in Drive.
  id: totrans-32
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你想要将计算机或设备上的文件与驱动器同步，那么你可以安装名为**Google Drive客户端应用程序**的专用软件。当此应用程序在您的计算机或设备上运行时，它会同步本地存储的文件与驱动器中相同的文件。
- en: You may be wondering, what is the purpose of synchronizing files? Sometimes
    you may need to, or someone may ask you to, parse a CSV file stored on a desktop
    using GAS to process the data and organize it into a Sheet. In this case, GAS
    won't execute on the desktop, but it can on the Google server. This way you can
    access your Drive files and parse data within your synchronized CSV file. You
    don't have to upload the CSV file manually every time to Drive.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能想知道同步文件的目的？有时你可能需要，或者有人可能要求你使用GAS解析存储在桌面上的CSV文件以处理数据并将其组织到表格中。在这种情况下，GAS不会在桌面执行，但可以在Google服务器上执行。这样，你可以访问你的驱动器文件并在同步的CSV文件内解析数据。你不必每次都手动将CSV文件上传到驱动器。
- en: 'The following screenshot shows the `Drive` folder view:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了`驱动器`文件夹视图：
- en: '![Google Drive](img/B05010_01_02.jpg)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![Google Drive](img/B05010_01_02.jpg)'
- en: Gmail
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Gmail
- en: 'Gmail is the most popular web-based e-mail service and is provided by Google.
    With it, occasionally composing and sending e-mail messages manually to one or
    a few people is not a problem. But what if you want to send an e-mail at a predefined
    time when you are not awake or to multiple recipients? Consider the following
    scenarios:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: Gmail是最受欢迎的基于网络的电子邮件服务，由Google提供。使用它，偶尔手动给一个人或几个人发送电子邮件消息不是问题。但如果你想在你不醒的时候或在多个收件人那里发送电子邮件怎么办？考虑以下场景：
- en: You want to send a surprise birthday greeting to your friend at a fixed time;
    neither earlier nor later
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你想在固定时间给你的朋友发送一个惊喜的生日问候，既不早也不晚
- en: You need to send customized e-mails to hundreds of people at a time
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你需要一次向数百人发送定制电子邮件
- en: You need to send e-mails periodically
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你需要定期发送电子邮件
- en: 'For all these scenarios, GAS has the answers:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 对于所有这些场景，GAS都有解决方案：
- en: Using GAS, you can build a mail merger application to send e-mails with customized
    greetings or messages to *n* number of people.
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用GAS，你可以构建一个邮件合并应用程序，向*n*个数量的人发送带有定制问候语或消息的电子邮件。
- en: You can extract information buried in e-mails from your inbox and store and
    organize them in Google Sheets or Docs.
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以从你的收件箱中提取电子邮件中的隐藏信息，并将它们存储和组织在Google表格或文档中。
- en: You can even convert the data or contents of a Google Sheet or Docs to a PDF
    or any other file format and send it as an e-mail attachment, or just save the
    created file in Drive and include only the file's URL as a hyperlink in e-mail
    messages.
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你甚至可以将Google表格或文档的数据或内容转换为PDF或其他文件格式，并将其作为电子邮件附件发送，或者只需将创建的文件保存在驱动器中，并在电子邮件消息中仅包含文件的URL作为超链接。
- en: In addition, GAS also allows you to mark selected messages as important, or
    starred. You can also add, delete, and update your Gmail Contacts using the `Contacts`
    service.
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 此外，GAS还允许你将选定的消息标记为重要或星标。你还可以使用`联系人`服务添加、删除和更新你的Gmail联系人。
- en: 'The following screenshot shows how Gmail classifies or groups messages with
    labels:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了Gmail如何使用标签对消息进行分类或分组：
- en: '![Gmail](img/B05010_01_03.jpg)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![Gmail](img/B05010_01_03.jpg)'
- en: Google Calendar
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google日历
- en: Google's online Calendar service is integrated with Gmail. GAS provides access
    to Calendar service by using the `CalendarApp` class. Using GAS code, you can
    access and modify your Calendar and those you have subscribed to. Using GAS, you
    can create Calendar events and invite your friends programmatically. Alternatively,
    you can grab event details and populate them in Sheets.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: Google的在线日历服务与Gmail集成。GAS通过使用`CalendarApp`类来提供对日历服务的访问。使用GAS代码，你可以访问和修改你的日历以及你订阅的日历。使用GAS，你可以以编程方式创建日历事件并邀请你的朋友。或者，你可以获取事件详情并将它们填充到表格中。
- en: Google Docs
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google文档
- en: Google Docs is a word processing program, and runs on web-based software within
    the Google Drive service. Docs allows you to create and edit documents online
    while collaborating with other users in real time. Using GAS, you can create documents,
    format the contents, translate them to other language, save them in Drive, or
    e-mail them to your friends.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: Google文档是一个文字处理程序，在Google Drive服务中的基于网络的软件上运行。文档允许你在网上创建和编辑文档，同时与其他用户实时协作。使用GAS，你可以创建文档、格式化内容、将它们翻译成其他语言、在驱动器中保存它们，或者将它们通过电子邮件发送给你的朋友。
- en: Google Sheets
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google表格
- en: Google Sheets is a spreadsheet program much like Microsoft Excel. You can create
    Sheets, share them with others, and edit them in real time. Google provides built-in
    formulae/functions in Sheets. You can also create your own simple to complex formulae.
    In other words, you can create custom formulae. Using the `SpreadsheetApp` class
    in your GAS code, you can interact with other applications.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: Google Sheets 是一个类似于 Microsoft Excel 的电子表格程序。您可以创建 Sheets，与他人共享，并实时编辑它们。Google
    在 Sheets 中提供了内置的公式/函数。您也可以创建自己的简单到复杂的公式。换句话说，您可以创建自定义公式。在您的 GAS 代码中使用 `SpreadsheetApp`
    类，您可以与其他应用程序交互。
- en: Google Apps services
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google Apps 服务
- en: Google provides Apps services to enable GAS to interact with the Apps. Almost
    all of the Apps provide one or more services. You can use these service classes
    in your GAS code to customize or automate Apps. Services are grouped as **basic**
    and **advanced**. You can use basic services directly, but for advanced services
    you need to enable them before using them. You will see how to enable them later
    on.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: Google 提供了 Apps 服务，以使 GAS 能够与 Apps 交互。几乎所有的 Apps 都提供一项或多项服务。您可以在您的 GAS 代码中使用这些服务类来自定义或自动化
    Apps。服务被分为**基本**和**高级**两类。您可以直接使用基本服务，但使用高级服务之前需要先启用它们。稍后您将看到如何启用它们。
- en: Creating Google Sheets in Drive and sharing them with your friends and the public
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 Drive 中创建 Google Sheets 并与您的朋友和公众共享
- en: 'Here are the steps to create a Google Sheet:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 创建 Google Sheet 的步骤如下：
- en: Run your favorite browser and type [https://drive.google.com/](https://drive.google.com/)
    in the address bar.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行您喜欢的浏览器，并在地址栏中输入 [https://drive.google.com/](https://drive.google.com/)。
- en: Tip
  id: totrans-59
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: In order to use Google Drive, you should have a Google account. If you don't
    have an account, then create one.
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 为了使用 Google Drive，您应该有一个 Google 账户。如果您没有账户，那么请创建一个。
- en: Now the Google Drive page will open. In the left pane, click on the **NEW**
    button and on **Google Sheets**:![Creating Google Sheets in Drive and sharing
    them with your friends and the public](img/B05010_01_04.jpg)
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，Google Drive 页面将打开。在左侧面板中，点击**新建**按钮，然后点击**Google Sheets**：![在 Drive 中创建
    Google Sheets 并与您的朋友和公众共享](img/B05010_01_04.jpg)
- en: After creating a new Sheet, right-click on it (Windows) or context click (Mac)
    and select the **Share...** option:![Creating Google Sheets in Drive and sharing
    them with your friends and the public](img/B05010_01_05.jpg)
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在创建新的 Sheet 后，右键单击它（Windows）或使用上下文菜单（Mac）并选择**共享...**选项：![在 Drive 中创建 Google
    Sheets 并与您的朋友和公众共享](img/B05010_01_05.jpg)
- en: A new pop-up window will open as shown in the following screenshot. After that,
    enter the e-mail address, or addresses, with which you would like to share the
    document. Finally, click on the **Done** button:![Creating Google Sheets in Drive
    and sharing them with your friends and the public](img/B05010_01_06.jpg)
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将会打开一个新弹窗，如下面的截图所示。之后，输入您想要共享文档的电子邮件地址，或地址。最后，点击**完成**按钮：![在 Drive 中创建 Google
    Sheets 并与您的朋友和公众共享](img/B05010_01_06.jpg)
- en: Google will send a share notification to your friend(s). When your friend(s)
    click on the access link provided, they will get access to your document.
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Google 将向您的朋友发送共享通知。当您的朋友点击提供的访问链接时，他们将能够访问您的文档。
- en: Congratulations! You have created a new Sheet and successfully shared it with
    your friend(s).
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！您已成功创建了一个新的 Sheet 并与您的朋友共享。
- en: Script projects
  id: totrans-66
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 脚本项目
- en: Scripts are organized as projects. Projects can be of two types, standalone
    and bounded to a `gtype` (Google Drive native file type, such as Sheets, Docs,
    and Forms) file. Standalone scripts are created in a separate script file, you
    can see these files listed among other files in Drive. Bounded scripts are embedded
    within individual `gtype` files and created using the respective applications.
    As you can see, the standalone script files, among other files in Drive, you can
    open directly from Drive, but bounded script can be opened within respective applications
    only. However, bounded script will have more privileges over parent file than
    standalone scripts. For example, you can get access to the active document within
    bounded scripts, but not within standalone scripts.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本被组织成项目。项目可以是两种类型之一，独立或绑定到 `gtype`（Google Drive 原生文件类型，例如 Sheets、Docs 和 Forms）文件。独立脚本是在单独的脚本文件中创建的，您可以在
    Drive 中的其他文件列表中看到这些文件。绑定脚本嵌入在单个 `gtype` 文件中，并使用相应的应用程序创建。如您所见，在 Drive 中的其他文件中，您可以直接从
    Drive 打开独立脚本文件，但绑定脚本只能在相应的应用程序中打开。然而，绑定脚本比独立脚本对父文件有更多的权限。例如，您可以在绑定脚本中访问活动文档，但在独立脚本中则不行。
- en: Creating standalone script projects
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建独立脚本项目
- en: 'To create a standalone script file follow these steps:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建一个独立的脚本文件，请按照以下步骤操作：
- en: Follow the steps as described in the *Creating Google Sheets in Drive and sharing
    them with your friends and the public* section.
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照前面“在Drive中创建Google Sheets并与朋友及公众分享”部分中描述的步骤进行操作。
- en: Navigate to **NEW** | **More** | **Google Apps Script** rather than the spreadsheet,
    as shown in the following screenshot:![Creating standalone script projects](img/B05010_01_14.jpg)
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**新建** | **更多** | **Google Apps Script**，而不是电子表格，如图所示：![创建独立脚本项目](img/B05010_01_14.jpg)
- en: A new untitled project will open in a new browser tab or window. The new project
    includes one code file, `Code.gs`, with a blank function, `myFunction`, as shown
    in the following screenshot:![Creating standalone script projects](img/B05010_01_09.jpg)
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个新无标题项目将在新的浏览器标签页或窗口中打开。新项目包含一个代码文件`Code.gs`，其中包含一个空白函数`myFunction`，如图所示：![创建独立脚本项目](img/B05010_01_09.jpg)
- en: To save or rename the new project, press *Ctrl* + *S* on your keyboard or click
    on the **Save** icon (floppy disk) in the editor. If you are saving the project
    for the first time then a prompt will appear to enter a new project name. Enter
    the project name (whatever you like) and click on the **OK** button. The new script
    file will be saved in the current folder:![Creating standalone script projects](img/B05010_01_10.jpg)
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要保存或重命名新项目，请按键盘上的*Ctrl* + *S*或点击编辑器中的**保存**图标（软盘）。如果您是第一次保存项目，则会出现提示输入新项目名称。输入项目名称（您喜欢的任何名称）并点击**确定**按钮。新的脚本文件将保存在当前文件夹中：![创建独立脚本项目](img/B05010_01_10.jpg)
- en: Creating new projects in Sheets
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Sheets中创建新项目
- en: 'Create a new Sheet or open the existing one. You will see a number of menu
    items at the top of the window. Now, follow these steps:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的工作表或打开现有的工作表。您将在窗口顶部看到一些菜单项。现在，按照以下步骤操作：
- en: Click on **Tools** and select **Script editor...**, as shown in the following
    screenshot:![Creating new projects in Sheets](img/B05010_01_07.jpg)
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**工具**并选择**脚本编辑器...**，如图所示：![在Sheets中创建新项目](img/B05010_01_07.jpg)
- en: A new browser tab or window with a new project selection dialog will appear,
    as shown in the following screenshot:![Creating new projects in Sheets](img/B05010_01_08.jpg)
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将出现一个新的带有新项目选择对话框的浏览器标签页或窗口，如图所示：![在Sheets中创建新项目](img/B05010_01_08.jpg)
- en: Click on **Blank Project** or close the dialog (you do not need to always select
    **Blank Project**, just this time). A new untitled project will open in a new
    browser tab/window.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**空白项目**或关闭对话框（您不必每次都选择**空白项目**，只是这次）。一个新无标题项目将在新的浏览器标签页或窗口中打开。
- en: Save the project as described in the preceding section.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照前面章节所述保存项目。
- en: Tip
  id: totrans-80
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: Although you can create as many bounded projects as you like, one project per
    file is enough. Creating just one project per file may help you to avoid problems
    with duplicate function and variable names.
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 虽然您可以创建尽可能多的有界项目，但每个文件一个项目就足够了。每个文件只创建一个项目可能有助于您避免重复的函数和变量名的问题。
- en: Congratulations! You have created a new script project. By following the preceding
    steps you can create script projects in Docs and Forms too.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！您已创建了一个新的脚本项目。通过遵循前面的步骤，您也可以在Docs和Forms中创建脚本项目。
- en: Creating a custom formula in Sheets
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Sheets中创建自定义公式
- en: 'Open the spreadsheet you created earlier and make the following changes:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 打开您之前创建的电子表格并做出以下更改：
- en: In columns *A* and *B*, type a few first and last names.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在列*A*和*B*中输入一些名字的首尾。
- en: In cell *C2*, type (including the equals sign) `=CONCATENATE(A2," ", B2)`.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在单元格*C2*中输入（包括等号）`=CONCATENATE(A2," ", B2)`。
- en: Now you can see the first name and last name in cells *A2* and *B2* respectively,
    concatenated with a space in between.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您可以在单元格*A2*和*B2*中分别看到名字的首尾，它们之间用空格连接。
- en: '`CONCATENATE` is Google Sheet''s built-in formula. You can also create your
    own, called custom formula:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '`CONCATENATE`是Google Sheets的内置公式。您也可以创建自己的，称为自定义公式：'
- en: 'Open the script editor and copy-paste this code:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开脚本编辑器并复制粘贴以下代码：
- en: '[PRE0]'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Here is the screenshot for the same:'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 下面是同样的截图：
- en: '![Creating a custom formula in Sheets](img/B05010_01_11.jpg)'
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![在Sheets中创建自定义公式](img/B05010_01_11.jpg)'
- en: Press *Ctrl* + *S* on your keyboard or click on the **Save** icon in the editor
    to save the script.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在键盘上按*Ctrl* + *S*或点击编辑器中的**保存**图标来保存脚本。
- en: Now return to the spreadsheet, and in cell *C2*, type `=myFunction(A2,B2)`.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在返回到电子表格，并在单元格*C2*中输入`=myFunction(A2,B2)`。
- en: This works in exactly the same way as the built-in formula. You can extend your
    formula to other cells below *C2*. This is a simple formula, but you can create
    complex formulae as per your requirements.
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这与内置公式的工作方式完全相同。您可以将您的公式扩展到C2以下的其它单元格。这是一个简单的公式，但您可以根据需求创建复杂的公式。
- en: Your custom formula should return a single value or a two-dimensional array.
    The following screenshot shows how a custom function will work:![Creating a custom
    formula in Sheets](img/B05010_01_12.jpg)
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您自定义的公式应返回单个值或二维数组。以下截图显示了自定义函数的工作方式：![在表格中创建自定义公式](img/B05010_01_12.jpg)
- en: Congratulations! You have created a custom formula.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！您已创建了一个自定义公式。
- en: Note
  id: totrans-98
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'To add code completion and/or tooltips for your custom function, add the following
    comments at the preceding lines of code in the function:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 要为您的自定义函数添加代码补全和/或工具提示，请在函数前面的代码行中添加以下注释：
- en: '[PRE1]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Google Forms
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google表单
- en: Google Forms is a Google App that you can use to collect information from your
    users. User responses or answers are collected and stored as responses in the
    Form itself and then can be populated in the connected Sheet. You can also change
    the response's target Sheet when required. You can create Google Forms dynamically
    using GAS.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: Google表单是一个Google应用程序，您可以使用它来收集用户信息。用户响应或答案将被收集并存储在表单本身中，然后可以填充到连接的表格中。您还可以在需要时更改响应的目标表格。您可以使用GAS动态创建Google表单。
- en: Creating Forms within Google Sheet
  id: totrans-103
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Google表格中创建表单
- en: 'In the spreadsheet you created earlier, click on the **Tools** menu and select
    the **Create a form** option. A new Form will be created and is bound to a new
    Sheet automatically. The new Sheet''s name will be similar to `Form Responses
    1`. In the new Form, create form fields with headings exactly same as in the Sheet''s
    column headers:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在您之前创建的表格中，点击**工具**菜单并选择**创建表单**选项。将自动创建一个新的表单，并将其绑定到一个新的表格。新表格的名称将与`Form Responses
    1`类似。在新表单中，创建与表格列标题完全相同的表单字段：
- en: '![Creating Forms within Google Sheet](img/B05010_01_13.jpg)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![在Google表格中创建表单](img/B05010_01_13.jpg)'
- en: On completion, try submitting the data using a live Form.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 完成后，尝试使用实时表单提交数据。
- en: Some research
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 一些研究
- en: If you are given a document's ID or key, something like `11CEeHWygGKqxGS7jmQzLpeO7Fs3cjetT4HTrWXHTDSU`,
    can you open the document, provided it has been shared with the public?
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您被提供了一个文档的ID或密钥，例如 `11CEeHWygGKqxGS7jmQzLpeO7Fs3cjetT4HTrWXHTDSU`，您能否打开该文档，前提是它已被公开分享？
- en: Tip
  id: totrans-109
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: Every Google Doc, Sheet, folder, and project has an ID or key, which you can
    get from the corresponding item's URL.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 每个Google文档、表格、文件夹和项目都有一个ID或密钥，您可以从相应项目的URL中获取。
- en: Summary
  id: totrans-111
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, you learned about Google Apps and got an introduction to GAS,
    as well as how to create a project and custom formulas. There are many more Google
    Apps available but we just covered the most popular ones. It will not be hard
    to adopt the same scripting concepts and principles for other Apps. In the next
    chapter, you will learn to create basic elements such as custom menus, dialogs,
    and sidebars.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您了解了Google应用程序，并获得了对GAS的介绍，以及如何创建项目和自定义公式。还有许多其他Google应用程序可用，但我们只介绍了最受欢迎的。将相同的脚本概念和原则应用于其他应用程序不会很难。在下一章中，您将学习如何创建基本元素，例如自定义菜单、对话框和侧边栏。
