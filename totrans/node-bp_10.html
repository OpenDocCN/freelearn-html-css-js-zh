<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;10.&#xA0;Writing Flexible and Modular CSS"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10" class="calibre1"/>Chapter 10. Writing Flexible and Modular CSS</h1></div></div></div><p class="calibre7">In the previous chapter, we learned about the most popular testing instruments under Node.js. We saw the importance of writing tests and learned about TDD and BDD. This chapter will be about<a id="id500" class="calibre1"/> <span class="strong"><strong class="calibre8">CSS</strong></span> (<span class="strong"><strong class="calibre8">Cascading Style Sheets</strong></span>) and the usage of preprocessors. The Web is built on the basis of three languages—HTML, CSS, and JavaScript. As part of modern technology, Node.js provides really helpful instruments to write CSS; in this chapter, we will have a look at these instruments and how they can improve our style sheets. This chapter will cover the following topics:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Popular techniques to write modular CSS</li><li class="listitem">The Less preprocessor</li><li class="listitem">The Stylus preprocessor</li><li class="listitem">The Sass preprocessor</li><li class="listitem">The AbsurdJS preprocessor</li></ul></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;Writing Flexible and Modular CSS">
<div class="book" title="Writing modular CSS"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch10lvl1sec68" class="calibre1"/>Writing modular CSS</h1></div></div></div><p class="calibre7">CSS has changed a <a id="id501" class="calibre1"/>lot in the last few years. Developers used CSS2<a id="id502" class="calibre1"/> as a declarative language to decorate the page. Today's CSS3<a id="id503" class="calibre1"/> gives us many more capabilities. Nowadays, CSS is used widely to implement design ideas animating elements on the page or even applying logic such as hiding and showing content blocks. A lot of CSS code requires better architecture, file structuring, and proper CSS selectors. Let's explore a few concepts that could help with this.</p></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;Writing Flexible and Modular CSS">
<div class="book" title="Writing modular CSS">
<div class="book" title="BEM (block, element, modifier)"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch10lvl2sec72" class="calibre1"/>BEM (block, element, modifier)</h2></div></div></div><p class="calibre7">BEM (<a class="calibre1" href="http://bem.info/method/definitions">http://bem.info/method/definitions</a>) is a<a id="id504" class="calibre1"/> naming <a id="id505" class="calibre1"/>convention introduced by Yandex back in 2007. It became a popular <a id="id506" class="calibre1"/>concept to develop frontend applications. In fact, it is not only applicable for CSS but also for any other language because it has very few rules that work well.</p><p class="calibre7">Let's say we have the following HTML markup:</p><div class="informalexample"><pre class="programlisting">&lt;header class="site-header"&gt;
    &lt;div class="logo"&gt;&lt;/div&gt;
    &lt;div class="navigation"&gt;&lt;/div&gt;
&lt;/header&gt;</pre></div><p class="calibre7">The instant CSS which we can come up with is as follows:</p><div class="informalexample"><pre class="programlisting">.site-header { ... }
.logo { ... }
.navigation { ... }</pre></div><p class="calibre7">However, it will probably not work really well because we may have another logo in the sidebar of the page. Of course, we could use descendant selectors such as <code class="email">.site-header { ... }</code> and <code class="email">.logo { ... }</code>, but these come with a new problem. It is not really a good practice to connect selectors in a tree because we can't extract a part of it and use it somewhere else. BEM solves this problem by defining rules which we can follow. A block in the context of BEM is an independent entity. It can be a simple one or a compound one (containing other blocks). In the previous example, the <code class="email">&lt;header&gt;</code> tag precedes the CSS block. The elements are placed inside the block and they are context-dependent, that is, they mean something only if they are placed inside the block which they belong to. The <code class="email">.logo</code> and <code class="email">.navigation</code> selectors in the block are the elements. There is one more type of selector called<a id="id507" class="calibre1"/> <span class="strong"><strong class="calibre8">modifiers</strong></span>. To better understand them, we will use an example. Let's say that Christmas will arrive soon and we need to make a holiday version of the logo. At the same time, we need to keep the old styles because after a few months we need to revert it to its previous version. This is what modifiers are made for. We apply them on already existing elements to set a new look or style. The same can be said for a button, which has a normal, pressed, or disabled state. To separate the different types of selectors, BEM introduces the following syntax:</p><div class="informalexample"><pre class="programlisting">.site-header { ... } /* block */
.site-header__logo { ... } /* element */
.site-header__logo--xmas { ... } /* modifier */
.site-header__navigation { ... } /* element */</pre></div><p class="calibre7">The name of the elements is added with double underscores and modifiers with double dashes.</p></div></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;Writing Flexible and Modular CSS">
<div class="book" title="Writing modular CSS">
<div class="book" title="Using the Object Oriented CSS approach"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch10lvl2sec73" class="calibre1"/>Using the Object Oriented CSS approach</h2></div></div></div><p class="calibre7">
<span class="strong"><strong class="calibre8">Object Oriented CSS</strong></span> (<span class="strong"><strong class="calibre8">OOCSS</strong></span>) (<a class="calibre1" href="https://github.com/stubbornella/oocss/wiki">https://github.com/stubbornella/oocss/wiki</a>) is <a id="id508" class="calibre1"/>another concept which helps us write <a id="id509" class="calibre1"/>better CSS. It was originally introduced by Nicole Sullivan and defines the following two principles.</p><div class="book" title="Separate structure and skin"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch10lvl3sec04" class="calibre1"/>Separate structure and skin</h3></div></div></div><p class="calibre7">Consider the <a id="id510" class="calibre1"/>following CSS:</p><div class="informalexample"><pre class="programlisting">.header {
    background: #BADA55;
    color: #000;
    width: 960px;
    margin: 0 auto;
}
.footer {
    background: #BADA55;
    text-align: center;
    color: #000;
    padding-top: 20px;
}</pre></div><p class="calibre7">There are styles that describe the look and skin of the elements. The duplication is a good reason to extract them in a separate definition. Continue the preceding code as follows:</p><div class="informalexample"><pre class="programlisting">.colors-skin {
    background: #BADA55;
    color: #000;
}
.header {
    width: 960px;
    margin: 0 auto;
}
.footer {
    text-align: center;
    padding-top: 20px;
}</pre></div><p class="calibre7">It's nice that we can use the same <code class="email">.colors-skin</code> class against other elements or even better, we can change the<a id="id511" class="calibre1"/> whole theme of the page with just one little modification in that particular class.</p></div><div class="book" title="Separate container and content"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch10lvl3sec05" class="calibre1"/>Separate container and content</h3></div></div></div><p class="calibre7">The idea is that every element<a id="id512" class="calibre1"/> should have its styles applied no matter what context it is put in. Let's use the following code as an example:</p><div class="informalexample"><pre class="programlisting">.header .login-form {
  margin-top: 20px;
  background: #FF0033;
}</pre></div><p class="calibre7">At some point, we may need to put the same form in the footer of the site. The <code class="email">20px</code> value and the <code class="email">#FF0033</code> color, which we applied, will be lost because the form does not live in the header anymore. So, avoiding such selectors will help us to prevent such situations. Of course, we can't follow this principle for every element, but it is a really good practice overall.</p></div></div></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;Writing Flexible and Modular CSS">
<div class="book" title="Writing modular CSS">
<div class="book" title="Scalable and modular architecture for CSS"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch10lvl2sec74" class="calibre1"/>Scalable and modular architecture for CSS</h2></div></div></div><p class="calibre7">Jonathan Snook <a id="id513" class="calibre1"/>introduced another<a id="id514" class="calibre1"/> interesting approach called <span class="strong"><strong class="calibre8">Scalable and modular architecture for CSS</strong></span> (<span class="strong"><strong class="calibre8">SMACSS</strong></span>) (<a class="calibre1" href="http://smacss.com/">http://smacss.com/</a>). His idea was to<a id="id515" class="calibre1"/> categorize the styles of the application into different categories as follows:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre8">Basic selectors</strong></span>: Basic <a id="id516" class="calibre1"/>selectors such as those for float clearing or the base font sizes</li><li class="listitem"><span class="strong"><strong class="calibre8">Layout</strong></span>: The <a id="id517" class="calibre1"/>CSS styles defining the grid of the page</li><li class="listitem"><span class="strong"><strong class="calibre8">Modules</strong></span>: These are <a id="id518" class="calibre1"/>similar to the BEM block, that is, a group of elements that form a meaningful block</li><li class="listitem"><span class="strong"><strong class="calibre8">State</strong></span>: CSS styles <a id="id519" class="calibre1"/>that define the state of the elements, for example, pressed, expanded, visible, hidden, and so on</li><li class="listitem"><span class="strong"><strong class="calibre8">Theme</strong></span>: Theme <a id="id520" class="calibre1"/>rules are similar to the state rules in which they describe how modules or layouts might look</li></ul></div><p class="calibre7">Constructing the style sheet in this manner organizes the selectors very well. We can create different directories or files for the different categories, and in the end we will have everything properly set up.</p></div></div></div>

<div class="book" title="Chapter&#xA0;10.&#xA0;Writing Flexible and Modular CSS">
<div class="book" title="Writing modular CSS">
<div class="book" title="Atomic design"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_5"><a id="ch10lvl2sec75" class="calibre1"/>Atomic design</h2></div></div></div><p class="calibre7">Atomic design (<a class="calibre1" href="http://bradfrostweb.com/blog/post/atomic-web-design">http://bradfrostweb.com/blog/post/atomic-web-design</a>), a concept presented<a id="id521" class="calibre1"/> by <a id="id522" class="calibre1"/>Brad Frost, is a simple but really powerful approach. We know<a id="id523" class="calibre1"/> that the basic unit of matter is an atom. Applying this to CSS, we can define the atom as a simple HTML tag:</p><div class="informalexample"><pre class="programlisting">&lt;label&gt;Search the site&lt;/label&gt;</pre></div><p class="calibre7">The atom contains some basic styling such as color, font size, or line height. Later, we can combine the atoms into molecules. The following example shows how a <code class="email">form</code> tag is made of few atoms:</p><div class="informalexample"><pre class="programlisting">&lt;form&gt;
    &lt;label&gt;Search the site&lt;/label&gt;
    &lt;input type="text" placeholder="enter keyword" /&gt;
    &lt;input type="submit" value="search" /&gt;
&lt;/form&gt;</pre></div><p class="calibre7">Properly styling and combining little blocks brings flexibility. If we follow this concept, we can reuse the same atoms again and again or put any molecule in a different context. Brad Frost didn't stop here. He continued by saying that the molecules can be merged into organisms and the organisms into templates. For example, the login form and the main-menu molecules define an organism header.</p><p class="calibre7">All the concepts mentioned in this section are not ideal for every project. However, all of them have something valuable to use. We should try not to follow them strictly but get the rules which fit best in our current application.</p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Exploring CSS preprocessors"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec69" class="calibre1"/>Exploring CSS preprocessors</h1></div></div></div><p class="calibre7">
<span class="strong"><strong class="calibre8">Preprocessors</strong></span> <a id="id524" class="calibre1"/>are tools that accept code and compile it. In our context, such instruments output<a id="id525" class="calibre1"/> CSS. There are few big benefits of using preprocessors.</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre8">Concatenation</strong></span>: Writing <a id="id526" class="calibre1"/>everything in one single <code class="email">.css</code> file is not an option anymore. We all need to split our styles logically and this normally happens by creating a bunch of different files. CSS has a <a id="id527" class="calibre1"/>mechanism to import one file from another—the <code class="email">@import</code> directive. However, by using it, we are forcing the browser to create another HTTP request to the server, which can decrease the performance of our application. CSS preprocessors normally deliver only one file by replacing the functionality of <code class="email">@import</code> and simply concatenating all the used files.</li><li class="listitem"><span class="strong"><strong class="calibre8">Extending</strong></span>: We don't like to <a id="id528" class="calibre1"/>write things over and over again and with pure CSS coding, this happens all the time. The good news is that preprocessors provide a feature that solves this problem. It's called a mixin. We can think of it as a function which is executed and all the styles defined in it are applied to the selector which calls it. We will see how this works in practice further in this chapter.</li><li class="listitem"><span class="strong"><strong class="calibre8">Configuration</strong></span>: Normally, we <a id="id529" class="calibre1"/>need to repeat colors, widths, and font sizes all over the CSS file. By using the CSS preprocessor, we can put these values in variables and define them in only one place. Switching to a new color scheme or typography can happen really fast.</li></ul></div><p class="calibre7">The syntax used in most preprocessors is similar to the normal CSS. This allows developers to start using them almost immediately. Let's check out the available CSS preprocessors.</p></div>

<div class="book" title="Exploring CSS preprocessors">
<div class="book" title="Using Less"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl2sec76" class="calibre1"/>Using Less</h2></div></div></div><p class="calibre7">Less<a id="id530" class="calibre1"/> is a CSS<a id="id531" class="calibre1"/> preprocessor <a id="id532" class="calibre1"/>based on Node.js. It is distributed as a Node.js module and can be installed using the following command line:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install -g less</strong></span>
</pre></div><p class="calibre7">After the successful installation, we should be able to call the <code class="email">lessc</code> command in the terminal. Create a new <code class="email">styles.less</code> file somewhere and put the following code inside it:</p><div class="informalexample"><pre class="programlisting">body {
  width: 100%;
  height: 100%;
}</pre></div><p class="calibre7">If we run <code class="email">lessc ./styles.less</code>, we will see the same CSS shown as a result. The approach, which is taken by <a id="id533" class="calibre1"/>Less, is to use a syntax close to the one used in the normal CSS. So, in practice, every existing CSS code could be compiled by Less, which comes in handy, because <a id="id534" class="calibre1"/>we can start using it without doing any preparation.</p><div class="book" title="Defining variables"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch10lvl3sec06" class="calibre1"/>Defining variables</h3></div></div></div><p class="calibre7">The variables in<a id="id535" class="calibre1"/> Less are <a id="id536" class="calibre1"/>defined as we write the CSS properties. We just have to put the <code class="email">@</code> sign in front of the property's name, as shown in the following code snippet:</p><div class="informalexample"><pre class="programlisting">@textColor: #990;
body {
  width: 100%;
  height: 100%;
  color: @textColor;
}</pre></div></div><div class="book" title="Using mixins"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch10lvl3sec07" class="calibre1"/>Using mixins</h3></div></div></div><p class="calibre7">
<span class="strong"><strong class="calibre8">Mixins</strong></span><a id="id537" class="calibre1"/> are very<a id="id538" class="calibre1"/> useful when we want to transfer specific styles from one place to another or even several places. Let's say, for example, that we have constant borders that need to be set for different elements on our page. We will then use the following code snippet:</p><div class="informalexample"><pre class="programlisting">.my-border() {
  border-top: solid 1px #000;
  border-left: dotted 1px #999;
}
.login-box {
  .my-border();
}
.sidebar {
  .my-border();
}</pre></div><p class="calibre7">We can skip the brackets of <code class="email">.my-border</code> but then we will have the same class in the resulted file. The code, as it is now, is compiled as follows:</p><div class="informalexample"><pre class="programlisting">.login-box {
  border-top: solid 1px #000;
  border-left: dotted 1px #999;
}
.sidebar {
  border-top: solid 1px #000;
  border-left: dotted 1px #999;
}</pre></div><p class="calibre7">The mixins can accept parameters, which makes them one of the most important features in Less.</p><div class="informalexample"><pre class="programlisting">.my-border(@size: 2px) {
  border-top: solid @size #000;
  border-left: dotted @size #999;
}
.login-box {
  .my-border(4px);
}
.sidebar {
  .my-border();
}</pre></div><p class="calibre7">In the example, <a id="id539" class="calibre1"/>the size of the <a id="id540" class="calibre1"/>border is passed as a parameter. It also has a default value of two pixels. The result after the compilation is as follows:</p><div class="informalexample"><pre class="programlisting">.login-box {
  border-top: solid 4px #000000;
  border-left: dotted 4px #999999;
}
.sidebar {
  border-top: solid 2px #000000;
  border-left: dotted 2px #999999;
}</pre></div></div><div class="book" title="Structuring the styles into nested definitions"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch10lvl3sec08" class="calibre1"/>Structuring the styles into nested definitions</h3></div></div></div><p class="calibre7">Very often, when we <a id="id541" class="calibre1"/>use descendent selectors, we end up with a really <a id="id542" class="calibre1"/>long style definition. This is annoying because we <a id="id543" class="calibre1"/>have to type more and it is difficult to read. CSS preprocessors solve that problem by allowing us to write nested styles. The next code shows how we may nest selectors:</p><div class="informalexample"><pre class="programlisting">.content {
  margin-top: 10px;
  p {
    font-size: 24px;
    line-height: 30px;
    a {
      text-decoration: none;
    }
    small {
      color: #999;
      font-size: 20px;
    }
  }
}
.footer {
  p {
    font-size: 20px;
  }
}</pre></div><p class="calibre7">This is much easier to <a id="id544" class="calibre1"/>understand and follow. We don't have to<a id="id545" class="calibre1"/> worry about collisions either. For example, the<a id="id546" class="calibre1"/> paragraph in the <code class="email">.content</code> element will have a 24-pixel font size and will not be mixed with the styles of the footer. That's because at the end, we have properly generated selectors:</p><div class="informalexample"><pre class="programlisting">.content {
  margin-top: 10px;
}
.content p {
  font-size: 24px;
  line-height: 30px;
}
.content p a {
  text-decoration: none;
}
.content p small {
  color: #999;
  font-size: 20px;
}
.footer p {
  font-size: 20px;
}</pre></div><p class="calibre7">Less has a dozen other features such as math calculation, function definitions, conditional mixins, and <a id="id547" class="calibre1"/>even loops. We can write a whole new book on this topic. A <a id="id548" class="calibre1"/>full list of all the functionalities can <a id="id549" class="calibre1"/>be seen at <a class="calibre1" href="http://lesscss.org/">http://lesscss.org/</a>, which is the official site of Less and contains its <a id="id550" class="calibre1"/>documentation.</p></div></div></div>

<div class="book" title="Exploring CSS preprocessors">
<div class="book" title="Using Sass"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch10lvl2sec77" class="calibre1"/>Using Sass</h2></div></div></div><p class="calibre7">There is another popular <a id="id551" class="calibre1"/>CSS preprocessor called <a id="id552" class="calibre1"/>
<span class="strong"><strong class="calibre8">Sass</strong></span>. It's actually not based on Node.js but on Ruby. So, we need to install Ruby first. You can also find detail information about how to install Ruby on the official download page: <a class="calibre1" href="https://www.ruby-lang.org/en/downloads">https://www.ruby-lang.org/en/downloads</a>. Once we have it properly set up, we need to run the following command to get Sass:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">gem install sass</strong></span>
</pre></div><p class="calibre7">After the execution, we <a id="id553" class="calibre1"/>have a command-line instrument installed, that is, <code class="email">sass</code>, and we can run it against a <code class="email">.sass</code> or <code class="email">.scss</code> file. The syntax used in the <code class="email">.sass</code> files looks like the one used in Stylus (we will learn about this in the <span class="strong"><em class="calibre9">Using Stylus</em></span> section), and the syntax used in the <code class="email">.scss</code> file is similar to the Less variant. At first, Less and Sass look pretty similar. Sass uses the <code class="email">$</code> sign in front of the variables, while Less uses the <code class="email">@</code> sign. Sass has the same features as Less—conditional statements, nesting, mixins, extending. The following code is a short example:</p><div class="informalexample"><pre class="programlisting">$brandColor: #993f99;

@mixin paragraph-border($size, $side: '-top') {
  @if $size &gt; 2px {
    border#{$side}: dotted $size #999;
  } @else {
    border#{$side}: solid $size #999;
  }
}

body {
  font-size: 20px;
  p {
    color: $brandColor;
    @include paragraph-border(3px, '-left')
  }
}</pre></div><p class="calibre7">The preceding code produces the following CSS code:</p><div class="informalexample"><pre class="programlisting">body {
  font-size: 20px;
}
body p {
  color: #993f99;
  border-top: dotted 3px #999;
}</pre></div><p class="calibre7">There are two<a id="id554" class="calibre1"/> keywords: <code class="email">@mixin</code> and <code class="email">@include</code>. The first one defines the <a id="id555" class="calibre1"/>mixin and<a id="id556" class="calibre1"/> the second one is <a id="id557" class="calibre1"/>needed during its usage.</p></div></div>

<div class="book" title="Exploring CSS preprocessors">
<div class="book" title="Using Stylus"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch10lvl2sec78" class="calibre1"/>Using Stylus</h2></div></div></div><p class="calibre7">
<span class="strong"><strong class="calibre8">Stylus</strong></span> <a id="id558" class="calibre1"/>is another <a id="id559" class="calibre1"/>popular CSS preprocessor written in Node.js. Similar to Less, Stylus also accepts the usual CSS syntax. However, it introduces another type of writing—without braces, colons, and semicolons. The following code is a short example:</p><div class="informalexample"><pre class="programlisting">body {
  font: 12px Helvetica, Arial, sans-serif;
}
a.button {
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  border-radius: 5px;
}</pre></div><p class="calibre7">In Stylus, the CSS<a id="id560" class="calibre1"/> code produced may look like the following code snippet:</p><div class="informalexample"><pre class="programlisting">body
  font 12px Helvetica, Arial, sans-serif

a.button
  -webkit-border-radius 5px
  -moz-border-radius 5px
  border-radius 5px</pre></div><p class="calibre7">The language uses the indentation to recognize the definitions. Stylus is distributed as a Node.js module and can be installed using the <code class="email">npm install -g stylus</code> command line. Once the process is completed, we can compile with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">stylus ./styles.styl</strong></span>
</pre></div><p class="calibre7">This is the command line where <code class="email">styles.styl</code> contains the necessary CSS. As a result, we will get the <code class="email">styles.css</code> file in the same directory.</p><p class="calibre7">Stylus is a little bit more advanced than Less. It still supports the same features but has more logical operators. Let's see an example that demonstrates most of its features:</p><div class="informalexample"><pre class="programlisting">brandColor = #FF993D
borderSettings = { size: 3px, side: '-top' }

paragraph-border(size, side = '')
  if size &gt; 2px
    border{side}: dotted size #999
  else
    border{side}: solid size #999

body
  font-size: 20px
  p
    color: brandColor
    paragraph-border(borderSettings.size, borderSettings.side)</pre></div><p class="calibre7">The first line <a id="id561" class="calibre1"/>defines<a id="id562" class="calibre1"/> a variable called <code class="email">brandColor</code>. Later, this variable is used to set the color of the paragraph. Stylus supports hash objects as a value of the variables. It's really nice because we can define a set of options. In the preceding example, <code class="email">borderSettings</code> holds the size and the position of the paragraph's border. The <code class="email">paragraph-border</code> mixin accepts two arguments. The second one is not mandatory and has a default value. There is an <code class="email">if</code>-<code class="email">else</code> statement that defines the type of the applied border. Similar to Less, we have the ability to nest selectors. The paragraph's styles are nested inside the <code class="email">body</code> selector. After the compilation, the resulted CSS is as follows:</p><div class="informalexample"><pre class="programlisting">body {
  font-size: 20px;
}
body p {
  color: #ff993d;
  border-top: dotted 3px #999;
}</pre></div></div></div>

<div class="book" title="Exploring CSS preprocessors">
<div class="book" title="Working with AbsurdJS"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch10lvl2sec79" class="calibre1"/>Working with AbsurdJS</h2></div></div></div><p class="calibre7">
<span class="strong"><strong class="calibre8">AbsurdJS</strong></span> <a id="id563" class="calibre1"/>is another<a id="id564" class="calibre1"/> CSS preprocessor available in Node.js that takes a slightly different direction. Instead of inventing a new syntax, it uses the already existing language—JavaScript. So, features such as variables, mixins, or logical operators came naturally without any additional effort.</p><p class="calibre7">Similar to the other preprocessors, AbsurdJS is distributed via the package manager of Node.js. The following command line installs the library on your machine:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm install -g absurd</strong></span>
</pre></div><p class="calibre7">The CSS<a id="id565" class="calibre1"/> styles are written in the <code class="email">.js</code> files. In fact, the library accepts the <code class="email">.css</code>, <code class="email">.json</code>, and <code class="email">.yaml</code> files and successfully processes them, but in this book we will stick to the JavaScript format because it is the most interesting one. Every file which is passed to AbsurdJS starts with the following code:</p><div class="informalexample"><pre class="programlisting">module.exports = function(api) {
  // ...
}</pre></div><p class="calibre7">The function that is exported accepts the API of the module. All the operations work through the API object. Because everything is in JavaScript, the CSS styles are represented in the JSON format. The following is an example code:</p><div class="informalexample"><pre class="programlisting">module.exports = function(api) {
  api.add({
    body: {
      fontSize: '20px',
      margin: '0 12px'
    }
  })
}</pre></div><p class="calibre7">The code is compiled to the following CSS:</p><div class="informalexample"><pre class="programlisting">body {
  font-size: 20px;
  margin: 0 12px;
}</pre></div><p class="calibre7">AbsurdJS could work as a command-line tool. To process a <code class="email">styles.js</code> file containing the preceding code snippet, we should execute the following code:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">absurd -s ./styles.js -o ./styles.css</strong></span>
</pre></div><p class="calibre7">The <code class="email">-s</code> flag comes from the source and <code class="email">-o</code> from the output. The module can be used in code as well as to integrate AbsurdJS into every Node.js application. All we have to do is add the library in our <code class="email">package.json</code> file and require it as shown in the following code:</p><div class="informalexample"><pre class="programlisting">var absurd = require('absurd')();
absurd.add({
  body: {
    fontSize: '20px',
    marginTop: '10px'
  }
}).compile(function(err, css) {
  // ...
});</pre></div><p class="calibre7">Actually, the same thing is valid for the Less preprocessor. It could be used in a Node.js script too.</p><p class="calibre7">While<a id="id566" class="calibre1"/> discussing <a id="id567" class="calibre1"/>Sass and Stylus, we used an example: a few lines of code that put a border on the page's <code class="email">paragraph</code> tag. The following code elaborates how this can be achieved using AbsurdJS:</p><div class="informalexample"><pre class="programlisting">module.exports = function(api) {
  var brandColor = '#993f99';
  var paragraphBorder = function(size, side) {
    var side = side ? side : '-top';
    var result = {};
    result['border' + side] = (size &gt; 2 ? 'dotted ' : 'solid ') + size + 'px #999';
    return result;
  }
  api.add({
    body: {
      fontSize: '20px',
      p: [
        { color: brandColor },
        paragraphBorder(3, '-left')
      ]
    }
  });
}</pre></div><p class="calibre7">It's all<a id="id568" class="calibre1"/> about <a id="id569" class="calibre1"/>constructing JavaScript objects and passing them to the <code class="email">add</code> method. There is still nesting, defining variables, and using a mixin (<code class="email">paragraphBorder</code>).</p></div></div>
<div class="book" title="Styling a simple login form"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec70" class="calibre1"/>Styling a simple login form</h1></div></div></div><p class="calibre7">We will now write the CSS styles for a <a id="id570" class="calibre1"/>simple login form. The HTML markup is pretty simple. It has two labels, two input fields, and two buttons, as shown in the following code:</p><div class="informalexample"><pre class="programlisting">&lt;form method="post" id="login"&gt;
    &lt;label&gt;Your username&lt;/label&gt;
    &lt;input type="text" name="u" /&gt;
    &lt;label&gt;Your password&lt;/label&gt;
    &lt;input type="password" name="p" /&gt;
    &lt;input type="submit" value="login" /&gt;
    &lt;input type="button" value="forgot" /&gt;
&lt;/form&gt;</pre></div><p class="calibre7">The result that we want to achieve at the end looks like the following screenshot:</p><div class="mediaobject"><img src="../images/00062.jpeg" alt="Styling a simple login form" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">As a preprocessor, we are going to use AbsurdJS and write our styles in the JavaScript format. Let's create an empty <code class="email">style.js</code> file and enter the following code:</p><div class="informalexample"><pre class="programlisting">module.exports = function(api) {
  var textColor = '#9E9E9E';
  var textColorLight = api.lighten('#9E9E9E', 50);
  var textColorDark = api.darken('#9E9E9E', 50);
  var brandColor = '#8DB7CD';
  var brandColorLight = api.lighten('#8DB7CD', 50);
  var brandColorDark = api.darken('#8DB7CD', 30);
  var warning = '#F00';
}</pre></div><p class="calibre7">We defined the settings <a id="id571" class="calibre1"/>of the page. They are only colors in our case, but it could be anything else, for example, font size, margin, or the space between the lines. The <code class="email">api.lighten</code> and <code class="email">api.darken</code> functions are used to produce variants of colors. They change the passed values by making them lighter or darker depending on the percentages.</p><p class="calibre7">We have our configurations set up and we can continue with the following basic CSS:</p><div class="informalexample"><pre class="programlisting">api.add({
  body: {
    width: '100%', height: '100%',
    margin: 0, padding: 0,
    color: textColor,
    fontFamily: 'Arial'
  }
});</pre></div><p class="calibre7">These styles are applied to the <code class="email">body</code> tag of our page. If we open the page now, we will see the following result:</p><div class="mediaobject"><img src="../images/00063.jpeg" alt="Styling a simple login form" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">This is because we have still not worked on the form. Let's continue and define the basic rules for it, using the following code:</p><div class="informalexample"><pre class="programlisting">api.add({
  body: {
    width: '100%', height: '100%',
    margin: 0, padding: 0,
    color: textColor,
    fontFamily: 'Arial',
    '#login': [
      { 
        width: '400px', 
        margin: '0 auto',
        padding: '30px 0 0 30px',
        label: { 
          display: 'block',
          margin: '0 0 10px 0',
          color: textColorDark
        }
      }
    ]
  }
});</pre></div><p class="calibre7">The <code class="email">#login</code> selector<a id="id572" class="calibre1"/> matches the form. We position it in the middle of the page and set padding from the top and bottom sides. We are also making the <code class="email">label</code> tag a block element. Now the example looks much better, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00064.jpeg" alt="Styling a simple login form" class="calibre10"/></div><p class="calibre11"> </p><p class="calibre7">If we check the HTML markup, which we started from, we will see that the rest of the elements are the <code class="email">input</code> tags, that is, two fields and two buttons. Let's create a function (mixin), which will generate CSS for these elements:</p><div class="informalexample"><pre class="programlisting">var input = function(selector, addons) {
  var result = {};
  result[selector] = {
    '-wm-border-radius': '4px',
    '-wm-box-sizing': 'border-box',
    marginBottom: '20px',
    border: 'solid 3px ' + brandColor,
    width: '100%',
    padding: '8px',
    '&amp;:focus': {
      outline: 0,
      background: textColorLight
    }
  }
  if(addons) {
    for(var prop in addons) {
      result[selector][prop] = addons[prop];
    }
  }
  return result;
}</pre></div><p class="calibre7">The <code class="email">input</code> method <a id="id573" class="calibre1"/>accepts a selector and an object. Because we will use the function to style fields and at the same buttons, we need a mechanism to add custom rules. The <code class="email">addons</code> object (if defined) holds those styles which need to be set in addition. There are two properties that may look strange: <code class="email">-wm-border-radius</code> and <code class="email">-wm-box-sizing</code>. The <code class="email">-wm-</code> property, at the beginning, adds browser prefixes to the end CSS. For example, <code class="email">-wm-box-sizing: border-box</code> produces the following output:</p><div class="informalexample"><pre class="programlisting">box-sizing: border-box;
-webkit-box-sizing: border-box;
-moz-box-sizing: border-box;</pre></div><p class="calibre7">The <code class="email">&amp;:focus</code> property is<a id="id574" class="calibre1"/> also a special property. The ampersand represents the selector in which the style is written. At the end of the function, we added the custom CSS. Now, let's see the use case:</p><div class="informalexample"><pre class="programlisting">'#login': [
  { 
    width: '400px', 
    margin: '0 auto',
    padding: '30px 0 0 30px',
    label: { 
      display: 'block',
      margin: '0 0 10px 0',
      color: textColorDark
    }
  },
  input('input[type="text"]'),
  input('input[type="password"]', {
    marginBottom: '40px'
  }),
  input('input[type="submit"]', {
    gradient: brandColorLight + '/' + brandColor,
    width: '80px'
  }),
  input('input[type="button"]', {
    gradient: brandColorLight + '/' + brandColor,
    width: '80px',
    transparent: 0.6,
    '&amp;:hover': {
      transparent: 1
    }
  })
]</pre></div><p class="calibre7">For the input fields, we call the input method with only a selector. However, for the buttons, we need more styles and they are passed as a JavaScript object. AbsurdJS has built-in mixins that allow us to generate cross-browser CSS, for example, the <code class="email">gradient</code> and <code class="email">transparent</code> properties. The result of the execution of the <code class="email">gradient</code> property is:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">/* gradient: brandColorLight + '/' + brandColor  */</strong></span>
<span class="strong"><strong class="calibre8">background: -webkit-linear-gradient(0deg, #d4ffff 0%, #8DB7CD 100%);</strong></span>
<span class="strong"><strong class="calibre8">background: -moz-linear-gradient(0deg, #d4ffff 0%, #8DB7CD 100%);</strong></span>
<span class="strong"><strong class="calibre8">background: -ms-linear-gradient(0deg, #d4ffff 0%, #8DB7CD 100%);</strong></span>
<span class="strong"><strong class="calibre8">background: -o-linear-gradient(0deg, #d4ffff 0%, #8DB7CD 100%);</strong></span>
<span class="strong"><strong class="calibre8">background: linear-gradient(0deg, #d4ffff 0%, #8DB7CD 100%);</strong></span>
<span class="strong"><strong class="calibre8">-ms-filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#FF8DB7CD',endColorstr='#FFD4FFFF',GradientType=0);</strong></span>
</pre></div><p class="calibre7">Also, the result of the execution of the <code class="email">transparent</code> property is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre8">/* transparent: 0.6  */</strong></span>
<span class="strong"><strong class="calibre8">filter: alpha(opacity=60);</strong></span>
<span class="strong"><strong class="calibre8">-ms-filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=60);</strong></span>
<span class="strong"><strong class="calibre8">opacity: 0.6;</strong></span>
<span class="strong"><strong class="calibre8">-moz-opacity: 0.6;</strong></span>
<span class="strong"><strong class="calibre8">-khtml-opacity: 0.6;</strong></span>
</pre></div><p class="calibre7">Using a mixin is much easier <a id="id575" class="calibre1"/>than writing all these things by ourselves. Once we add the <code class="email">input</code> invocations, we are done. AbsurdJS produces the desired result.</p></div>
<div class="book" title="Summary"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec71" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">CSS is and will always be an important part of the Web. Making it simple, well-structured, and with a flexible markup leads to a good architecture. In this chapter, we learned about the most popular concept to write modular CSS. Along with that, we checked the latest trends in CSS preprocessing, the available tools, and their features.</p><p class="calibre7">Node.js is fast and is very often used as a REST API. In the next chapter, we will see how to write a REST API and what the best practices in this direction are.</p></div></body></html>