<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Essentials of Automation</h1></div></div></div><p>In <a class="link" href="ch01.html" title="Chapter 1. Automation Life Cycle and Automation Goals">Chapter 1</a>, <em>Automation Life Cycle and Automation Goals</em>, we learned about the test automation life cycle and automation goals. The basic features of the test automation are record and replay. These features allow the user to play scripts many times and compare expected values with actual values. This approach is simple and requires little or no knowledge of coding and can be applied to any supported application that has a graphical user interface. One should be familiar with basic QTP features, such as recording, replay, OR <a id="id92" class="indexterm"/>(Object Repository) creation, checkpoints, synchronization, actions, reporting, error handling, parameterization, and configuration. One should also know how to use environment variables to make the script complete and reusable. This chapter deals with recording or creating the test scripts, script creation life cycle, QTP features, and various ways of using these features to make complete reusable scripts. The intent of this chapter is not to gain in-depth knowledge but to get familiarized with these features for script creation and its enhancement.</p><div><div><div><div><h1 class="title"><a id="ch02lvl1sec10"/>About QTP</h1></div></div></div><p>HP <strong>QuickTest Professional</strong> (<strong>QTP</strong> or QuickTest) or <strong>Unified Functional Tester</strong> (<strong>UFT</strong>)<a id="id93" class="indexterm"/> is the test automation tool for functional and regression test case automation. HP QuickTest Professional supports keyword view and<a id="id94" class="indexterm"/> scripting interfaces to automate the test. It uses VBScript as a scripting language to specify test scripts and working with the objects and controls in the application under test.</p><p>QTP is a tool that provides support for automated software testing and framework creation. The basic components that support QTP in recording and replay mechanism are test object model, test object, and object repository. The knowledge and understanding of these components is helpful in creating scripts.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec11"/>The QuickTest object model</h1></div></div></div><p>The test object model is a collection of objects and classes, which represents the objects in AUT. Each<a id="id95" class="indexterm"/> class has a set of properties for its identification; QTP uses a subset of the properties to identify the object uniquely at runtime.</p><p>Test script is a combination of standard VBScript statements and statements that use QuickTest test objects, methods, and properties. The<a id="id96" class="indexterm"/> QuickTest object model contains one section for each add-in environment available with the QTP installation, as well as a special section for utility and supplemental objects.</p></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec12"/>Test objects</h1></div></div></div><p>QTP uses a<a id="id97" class="indexterm"/> test object to represent an object in AUT. Each test object has one or more methods and properties that are used to perform operations and retrieve values for that object. Each test object has a number of identification properties that describe the object.</p><p>Object identification properties can be used in the object repository description, programmatic descriptions, checkpoints, output values, test steps, and passed as argument values for <code class="literal">GetTOProperty</code> and <code class="literal">GetROProperty</code> methods. <a id="id98" class="indexterm"/>A runtime <a id="id99" class="indexterm"/>object is the actual object in AUT on which methods are performed during the run session.</p></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec13"/>Object repositories</h1></div></div></div><p>Set up the resources <a id="id100" class="indexterm"/>before the test is created. One of the most important resources for any test is object repository, which stores the test objects (and other object types) used in your test. QuickTest can store the test objects it learns in two types of object repository files: shared and local.</p><p>A <strong>shared object repository</strong> <a id="id101" class="indexterm"/>contains test objects that can be used across multiple actions.</p><p>A <strong>local object repository</strong>
<a id="id102" class="indexterm"/> stores test objects that can only be used in one specific action and not in any other action.</p></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Record and replay</h1></div></div></div><p>Recording is a process of capturing human actions performed on AUT and simultaneously creating a script, which can be replayed on AUT many times.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec20"/>What happens when we record</h2></div></div></div><p>When a user records the scripts<a id="id103" class="indexterm"/>, QTP perform various tasks as shown in following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">QTP uses a test object model. It identifies the test object and operation performed on an object that belongs to AUT.</li><li class="listitem">Then it stores the test object in a local object repository on which the user performed the action.</li><li class="listitem">Object identification properties of the test object are captured, which allows identification of the object uniquely at time of replay.</li><li class="listitem">It provides a logical name to a test object, which makes objects' names readable.</li><li class="listitem">Create a test step; a test step contains test objects including parent(s), operation, and data, if applicable. The following code is an example of the test step:</li></ol></div><div><pre class="programlisting">Dialog("Login").WinEdit("Agent Name:").Set "ashish"</pre></div><p>In the previous test step, <code class="literal">Dialog</code> is the class name, <code class="literal">Login</code> is its logical name, and it is a parent of the <code class="literal">WinEdit</code> object. <code class="literal">WinEdit</code> is the class and <code class="literal">Set</code> is the operation, which sets the value as <code class="literal">ashish</code> to the object whose logical name is <code class="literal">Agent Name</code>:</p><p>The steps for recording are as follows:</p><div><ol class="orderedlist arabic"><li class="listitem">Click on the <strong>Record</strong> button on the toolbar as shown in the following screenshot:<div><img src="img/1027EN_02_01.jpg" alt="What happens when we record"/></div></li><li class="listitem">Perform the action on the AUT.</li><li class="listitem">Repeat step 2 to record other test steps.</li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec21"/>What happens when we replay</h2></div></div></div><p>When QTP replays <a id="id104" class="indexterm"/>the scripts, it performs various tasks as shown in the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">QTP finds the test object.</li><li class="listitem">It identifies the test object uniquely; in some cases it may be using one of the following items: ordinal identifiers, smart identification, and relational identifiers.</li><li class="listitem">Perform the intended operation on the runtime object.</li></ol></div><p>The steps for <a id="id105" class="indexterm"/>recording are as follows:</p><p>Click on the <strong>Run</strong> button in the toolbar as shown in the following screenshot:</p><div><img src="img/1027EN_02_01.jpg" alt="What happens when we replay"/></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Script development</h1></div></div></div><p>The steps for script <a id="id106" class="indexterm"/>development are as follows:</p><div><ol class="orderedlist arabic"><li class="listitem">Analyze Application Under Test.</li><li class="listitem">Create OR (add a test object manually).</li><li class="listitem">Add test steps.</li><li class="listitem">Enhance scripts by adding checkpoints, synchronization points, and so on.</li><li class="listitem">Create a structure by inserting functions, actions, loops, and control statements.</li><li class="listitem">Run and debug the test.</li><li class="listitem">Analyze results and report defects.</li><li class="listitem">Drag-and-drop object from OR to expert view.</li></ol></div><p>We will discuss the preceding steps 4, 5, and 6 in later chapters.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec22"/>Analyzing an application</h2></div></div></div><p>Determine the<a id="id107" class="indexterm"/> development environment to load the relevant QuickTest add-ins and provide support for the objects in AUT. Analyze the flow and plan tests and actions accordingly. Decide the organization of the test, and ensure that the test and AUT are set to match the need of the automation.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec23"/>Creating OR (adding test objects to OR)</h2></div></div></div><p>When an object is <a id="id108" class="indexterm"/>added to an object repository, QuickTest performs the following actions:</p><div><ol class="orderedlist arabic"><li class="listitem">It identifies<a id="id109" class="indexterm"/> the test object class, which represents the learned object and creates the appropriate test object.</li><li class="listitem">It reads the current value of the object's properties in AUT as well as stores the list of identification properties. It selects the identification properties that can identify the test object uniquely.</li><li class="listitem">It chooses a unique name for the test object, generally using the value of one of its prominent properties: for example, <code class="literal">name</code>, if the object has one.</li></ol></div><p>Following are<a id="id110" class="indexterm"/> the ways to add<a id="id111" class="indexterm"/> the test object to OR:</p><div><ol class="orderedlist arabic"><li class="listitem">Record a test step.</li><li class="listitem">Add object to local.</li><li class="listitem">Create an object description.</li><li class="listitem">Create a test object by using define new test objects.</li><li class="listitem">OR Manager Navigate and Learn or Add object option.</li><li class="listitem">Adding test objects to the local object repository from <strong>Active Screen</strong>.</li></ol></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec15"/>Recording a test step</h3></div></div></div><p>Test objects are<a id="id112" class="indexterm"/> created automatically and added to the local OR when a user records a step. Add object to local.</p></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec16"/>Adding a test object to OR</h3></div></div></div><p>Add a test object to the local <a id="id113" class="indexterm"/>OR through the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Navigate to <strong>Resources</strong> | <strong>Object Repository</strong> | <strong>Add object to local</strong>.</li><li class="listitem">Click on the button <strong>Add Object to local</strong>.</li><li class="listitem">Click on the hand pointer to the object we want to add from AUT.</li><li class="listitem">Click on <strong>OK</strong>. The object is added to the OR as shown in the following screenshot:<div><img src="img/1027EN_02_02.jpg" alt="Adding a test object to OR"/></div></li></ol></div></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec17"/>Creating an object description</h3></div></div></div><p>The test object <a id="id114" class="indexterm"/>can be created without recording, by providing an object description. Refer to the following screenshot. The test object class name is <code class="literal">WinComboBox</code> and it has two description properties, which are stored with a logical name <code class="literal">Fly From</code>:</p><div><img src="img/1027EN_02_03.jpg" alt="Creating an object description"/></div><p>When we record the test step to select an option from the <strong>Fly From</strong> combobox, the following script is generated:</p><div><pre class="programlisting">Window("FlghtReservation").WinComboBox("Fly From:").Select "London"</pre></div><p>We can use the <a id="id115" class="indexterm"/>object description in the test steps directly, as shown in the following code:</p><div><pre class="programlisting">Window("regexpwndtitle:=FlghtReservation").WinComboBox("attached text:=Fly From:").Select "London"</pre></div><p>Both statements are the same when we replay the script, one uses an object from the OR and the other one uses the description directly. When we use programmatic description, the logical name is replaced by the pair(s) of the identification properties and its values.</p></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec18"/>Creating a test object using Define New Test Object</h3></div></div></div><p>To define a new object, we<a id="id116" class="indexterm"/> should know its class and its identification properties. Perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Navigate to <strong>Resources</strong> | <strong>Object Repository</strong> | <strong>Define New Test Object</strong>.</li><li class="listitem">Filter <strong>Environment</strong> from the <strong>Define New Test Object</strong> window.</li><li class="listitem">Select the class from the <strong>Class</strong> drop-down box.</li><li class="listitem">Enter a logical name.</li><li class="listitem">Provide the value for the <strong>Identification</strong> property (1 to n).</li><li class="listitem">If required, add some identification properties.</li><li class="listitem">Click on the <strong>Add</strong> button to add a test object to the OR:<div><img src="img/1027EN_02_04.jpg" alt="Creating a test object using Define New Test Object"/></div></li></ol></div><p>Select the<a id="id117" class="indexterm"/> environment displayed based on the loaded add-ins, select <strong>Class</strong>, and provide a logical name.</p></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec19"/>OR Manager Navigate and Learn and Add Object options</h3></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">How can I learn GUI Objects in one go?</li><li class="listitem" style="list-style-type: disc">Use Navigate and Learn in the OR Manager.</li></ul></div><div><div><div><div><h4 class="title"><a id="ch02lvl4sec01"/>The Navigate and Learn toolbar</h4></div></div></div><p>This toolbar allows<a id="id118" class="indexterm"/> you to add multiple test objects to a shared object repository while you navigate through your application. Following are the steps to learn to navigate the object in the object repository manager:</p><div><ol class="orderedlist arabic"><li class="listitem">Navigate to <strong>Resources</strong> | <strong>Object Repository Manager</strong> | <strong>Object</strong> | <strong>Navigate and Learn</strong> or press <em>F6</em>.<div><img src="img/1027EN_02_05.jpg" alt="The Navigate and Learn toolbar"/></div></li><li class="listitem">Select a window to learn. The selected window and its descendant objects are added<a id="id119" class="indexterm"/> to the active shared object repository according to a predefined object filter.</li></ol></div></div><div><div><div><div><h4 class="title"><a id="ch02lvl4sec02"/>Adding a test object using the OR Manager Add Object option</h4></div></div></div><div><ol class="orderedlist arabic"><li class="listitem">Navigate<a id="id120" class="indexterm"/> to <strong>Resources</strong> | <strong>Object Repository Manager</strong> | <strong>Objects</strong> | <strong>Add Object</strong>. Click on the hand pointer and select the window.</li><li class="listitem">The object filter is used for the <a id="id121" class="indexterm"/><strong>Navigate and Learn</strong> option as well as the <strong>Add Objects</strong> option.<div><img src="img/1027EN_02_06.jpg" alt="Adding a test object using the OR Manager Add Object option"/></div></li></ol></div><p>See the description of each filter in the following table:</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>UI Elements </p>
</th><th style="text-align: left" valign="bottom">
<p>Description </p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<strong>Selected object only (no descendants</strong>
<strong>)</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>This option<a id="id122" class="indexterm"/> allows you to select objects without descendants and add the selected ones by previously using selected and its properties.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Default object types</strong>
<a id="id123" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>This option enables adding selected objects and their descendants to the object repository. The objects selected are specified by the default filter option.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>All object types</strong>
<a id="id124" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>This option allows adding the objects and their descendants with properties and values selected <a id="id125" class="indexterm"/>previously in the object repository using the <strong>Selected object types</strong> option.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Selected object types</strong>
<a id="id126" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>This option allows selecting and filtering the objects and their descendants. The selection remains valid until a user does not change the selection criteria.</p>
</td></tr></tbody></table></div><p>Based on the filter option, the other is added to the OR.</p></div></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec20"/>Adding test objects to the local object repository from Active Screen</h3></div></div></div><p>Select the required object from <strong>Active Screen</strong> and add it to the object repository. In order to add test objects to the object repository using <a id="id127" class="indexterm"/>
<strong>Active Screen</strong>, <strong>Active Screen</strong> should have the object. Perform the following steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Go to the <strong>Active Screen</strong> pane.</li><li class="listitem">Select an object and right-click on it.</li><li class="listitem">Click on <strong>View</strong> / <strong>Add Object</strong>.</li><li class="listitem">Click on the <strong>Add to Repository</strong> button.<div><img src="img/1027EN_02_07.jpg" alt="Adding test objects to the local object repository from Active Screen"/></div></li></ol></div><p>We have selected <a id="id128" class="indexterm"/>the object button <strong>Cancel</strong> as shown in the preceding screenshot. The test object is added to the local object repository and can be used only by the current action. We cannot add a test object in a shared OR (in OR Manager) using <strong>Active Screen</strong>.</p></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec24"/>Adding a test step</h2></div></div></div><p>There are many<a id="id129" class="indexterm"/> ways in which we can add the steps in the scripts, as shown in the following steps:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Recording</strong>: Recording creates<a id="id130" class="indexterm"/> the test step when a user performs the action on an object in AUT.</li></ul></div><p>
<strong>Manually adding a step</strong>: To add steps<a id="id131" class="indexterm"/> manually, we need to add the OR first. Write the class name, for example <code class="literal">Dialog</code>; the editor displays the list of dialogs. In case multiple dialogs are stored in OR, we can select the desired one. In case of a single dialog QTP, complete print the name of it in editor. When a user types <code class="literal">WinEdit</code>, the editor displays two objects that belong to the <code class="literal">WinEdit</code> class. Refer to the following screenshot:</p><div><img src="img/1027EN_02_08.jpg" alt="Adding a test step"/></div><div><img src="img/1027EN_02_09.jpg" alt="Adding a test step"/></div><p>Press <em>.</em> on the <a id="id132" class="indexterm"/>keyboard after <code class="literal">WinButton("OK")</code>, the drop-down menu appears with the list of the methods available for the object. Select the appropriate method and complete the statement.</p><p>Perform the following steps for the keyword view:</p><div><ol class="orderedlist arabic"><li class="listitem">Create the OR.</li><li class="listitem">Switch to the keyword driven view.</li><li class="listitem">Right-click on the <strong>Item</strong> column.</li><li class="listitem">Select the object from the drop-down menu in the item of the grid.</li><li class="listitem">Select the method from the <strong>Operation</strong> column.</li><li class="listitem">Set the value, if required, in the <strong>Value</strong> column.<div><div><h3 class="title"><a id="note04"/>Note</h3><p>The comment will be added by QTP itself.</p></div></div></li></ol></div><p>If the test object is not added to the Object Repository before inserting the step,click on the object from the repository in the drop-down menu in the item column. Click on the hand pointer to <a id="id133" class="indexterm"/>add a test object from the repository in the selected test object window.</p><div><img src="img/1027EN_02_10.jpg" alt="Adding a test step"/></div><p>
<strong>Step Generator</strong> from Keyword view:</p><div><ol class="orderedlist arabic"><li class="listitem">Create the OR (add object to OR).</li><li class="listitem">Switch to the keyword driven view and right-click on it.</li><li class="listitem">Click on <strong>Step Generator</strong>.</li><li class="listitem">Select <strong>Test Object</strong> from <strong>Category</strong>.</li><li class="listitem">Select the test object from the dropdown or click on the icon (select the test object) to open the selected object window.</li><li class="listitem">Select the test object.</li><li class="listitem">Provide arguments and click on <strong>OK</strong>.</li></ol></div><p>Adding steps to <strong>Active screen</strong>:</p><div><ol class="orderedlist arabic"><li class="listitem">Open the <a id="id134" class="indexterm"/><strong>Active Screen</strong> pane (if the <strong>Active Screen</strong> pan is not visible, go to <strong>View</strong> | <strong>Active</strong>).</li><li class="listitem">Navigate to the object we want to add.</li><li class="listitem">Click on the <strong>Step Generator</strong> option.</li><li class="listitem">Select <strong>Test Object</strong> from <strong>Category</strong>.</li><li class="listitem">Select the test object from the dropdown or click on the icon (select the test object) to open the selected object window.</li><li class="listitem">Select the test object.</li><li class="listitem">Provide<a id="id135" class="indexterm"/> the arguments.</li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec25"/>Enhancing scripts</h2></div></div></div><p>We have learned various ways of adding test objects and creating test steps, now we will learn about enhancing<a id="id136" class="indexterm"/> the scripts using checkpoints, actions,<a id="id137" class="indexterm"/> synchronization point, reporter object, Err handling, and environment variable to make it more reusable and effective.</p><div><div><div><div><h3 class="title"><a id="ch02lvl3sec21"/>Checkpoints</h3></div></div></div><p>A checkpoint is a verification that compares the actual value for specified properties or the current state of other characteristics of an object with the expected value or characteristics. This <a id="id138" class="indexterm"/>allows notifying the <strong>Run Result</strong> window or scripts them as to whether applications are working as expected or not. When a checkpoint is added to the test, QuickTest inserts a checkpoint step in the keyword view and adds a <code class="literal">CheckPoint</code> statement<a id="id139" class="indexterm"/> in the expert view. When a test is executed, QuickTest compares the expected results and actual results using checkpoints. If there is a mismatch, the checkpoint fails. The results of the checkpoint can be viewed in the <strong>Run Results Viewer</strong>. See the various types of checkpoints in the following list:</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Type</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th><th style="text-align: left" valign="bottom">
<p>How to insert</p>
</th><th style="text-align: left" valign="bottom">
<p>Example of use</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>Standard checkpoint<a id="id140" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Verifies the value of an object's properties</p>
</td><td style="text-align: left" valign="top">
<p>Click on<a id="id141" class="indexterm"/> <strong>Record</strong> in toolbar.</p>
<p>Navigate to <strong>Insert</strong> | <strong>Checkpoint</strong> | <strong>Standard Checkpoint</strong>.</p>
</td><td style="text-align: left" valign="top">
<p>Verify the property of the object</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Image checkpoint<a id="id142" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Verifies the properties of images</p>
</td><td style="text-align: left" valign="top">
<p>This<a id="id143" class="indexterm"/> checkpoint type is inserted by selecting the <strong>Standard Checkpoint</strong> option and then selecting to check a web image object.</p>
</td><td style="text-align: left" valign="top">
<p>Verify the <code class="literal">alt</code> property of the image</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Table checkpoint<a id="id144" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Verifies the information in the web table</p>
</td><td style="text-align: left" valign="top">
<p>This<a id="id145" class="indexterm"/> checkpoint type is inserted by selecting the <strong>Standard Checkpoint</strong> option and then selecting to check any table object.</p>
</td><td style="text-align: left" valign="top">
<p>Verify if the value of the cell in the web table is correct</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Page checkpoint<a id="id146" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Verifies the characteristics of a web page</p>
</td><td style="text-align: left" valign="top">
<p>This checkpoint type is inserted by selecting the Standard Checkpoint option and then <a id="id147" class="indexterm"/>selecting to check a web page object.</p>
</td><td style="text-align: left" valign="top">
<p>Verify the number of links</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Text checkpoint<a id="id148" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Verifies the displayed text or text within predefined and post-defined values</p>
</td><td style="text-align: left" valign="top">
<p>Click on <strong>Record</strong> in the toolbar.</p>
<p>Navigate to <strong>Insert</strong> | <strong>Checkpoint</strong> | <strong>Text Checkpoint</strong>.</p>
</td><td style="text-align: left" valign="top">
<p>Verify if the expected text string is displayed</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Text Area checkpoint<a id="id149" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Verify if<a id="id150" class="indexterm"/> string is displayed within a defined area</p>
</td><td style="text-align: left" valign="top">
<p>Click on <strong>Record</strong> in the toolbar.</p>
<p>Navigate <a id="id151" class="indexterm"/>to <strong>Insert</strong> | <strong>Checkpoint</strong> | <strong>Text Area Checkpoint</strong>.</p>
</td><td style="text-align: left" valign="top">
<p>Verify if the string defined in area matches with the expected string </p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Bitmap checkpoint<a id="id152" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Verifies the bitmap or part of the bitmap<a id="id153" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Click on <strong>Record</strong> in toolbar.</p>
<p>Navigate to <strong>Insert</strong> | <strong>Checkpoint</strong> | <strong>Bitmap Checkpoint</strong>.</p>
</td><td style="text-align: left" valign="top">
<p>Check if bitmap matches the expected bitmap</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Database checkpoint<a id="id154" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Check if the<a id="id155" class="indexterm"/> value retrieved by query matches the expected value</p>
</td><td style="text-align: left" valign="top">
<p>Navigate to <strong>Insert</strong> | <strong>Checkpoint</strong> | <strong>Database Checkpoint</strong>.</p>
</td><td style="text-align: left" valign="top">
<p>Check if the value retrieved by query matches the expected value</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Accessibility checkpoint<a id="id156" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Identifies<a id="id157" class="indexterm"/> areas of a website to check for Section 508 compliancy</p>
</td><td style="text-align: left" valign="top">
<p>Click on <strong>Record</strong> in toolbar.</p>
<p>Navigate to <strong>Insert</strong> | <strong>Checkpoint</strong> | <strong>Accessibility Checkpoint</strong>.</p>
</td><td style="text-align: left" valign="top">
<p>Check if the images on a web page include <code class="literal">ALT</code> properties, required by the W3C Web</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>XML checkpoint<a id="id158" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Verifies data in XML documents<a id="id159" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>Navigate to <strong>Insert</strong> | <strong>Checkpoint</strong> | <strong>XML Checkpoint</strong>.</p>
</td><td style="text-align: left" valign="top">
<p>Check the value of an XML node and attributes</p>
</td></tr></tbody></table></div><p>We will learn more about checkpoints in the next chapter.</p></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec22"/>Synchronization</h3></div></div></div><p>When a test runs, it may not always match up to the speed of AUT and it is required to wait for the following. This is known as <a id="id160" class="indexterm"/>test synchronization.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Wait until a progress bar reaches 100 percent</li><li class="listitem" style="list-style-type: disc">Status message is displayed</li><li class="listitem" style="list-style-type: disc">Wait until button is enabled</li><li class="listitem" style="list-style-type: disc">Wait until a window or a pop up is displayed</li></ul></div><p>In these scenarios, tests are either not able to perform the next step or synchronization times out, causing the test to fail. These issues can be resolved by various synchronization techniques provided by the QTP.</p><p>There are several options to synchronize a test with AUT:</p><div><ol class="orderedlist arabic"><li class="listitem">Inserting the <code class="literal">Wait</code> statement allows a test to wait for a predefined time.</li><li class="listitem">Insert a synchronization point or insert the <code class="literal">WaitProperty</code> method, allowing a test to pause until an object property achieves the specified value.</li><li class="listitem">The <code class="literal">Exist</code> statement allows waiting until an object exists or times out.</li><li class="listitem">QTP allows setting the default time-out for a web page to load.</li><li class="listitem">Increase the default synchronization time-out by navigating to <strong>File</strong> | <strong>Test</strong> | <strong>Run</strong> |<strong>object synchronization timeout</strong>.</li><li class="listitem">Use the <code class="literal">Sync</code> method for a web page to wait until the page is loaded. See the following code:<div><pre class="programlisting">Browser("Mercury Tours").Page("Mercury Tours").Sync</pre></div><div><div><h3 class="title"><a id="tip02"/>Tip</h3><p>The synchronization point does not work when QTP is not able to identify the object; use <code class="literal">exist</code> or <code class="literal">wait</code> instead.</p></div></div></li></ol></div><div><div><div><div><h4 class="title"><a id="ch02lvl4sec03"/>Exist statements</h4></div></div></div><p>The <code class="literal">Exist</code> statement allows a test to wait for a window to open or an object to appear. <code class="literal">Exist</code> statements return a Boolean value indicating whether or not an object currently exists.</p><div><pre class="programlisting">Done = Window("Flight Reservation").Dialog("Flights Table").Exist 
Exitsinwaittime =Window("Flight Reservation").Dialog("Flights Table").Exist (10)</pre></div><p>The first statement instructs QuickTest to wait until the default synchronization time. The second statement waits for a maximum of 10 seconds for the <code class="literal">Flights Table</code> dialog box to open.</p><div><div><h3 class="title"><a id="tip03"/>Tip</h3><p>
<strong>Downloading the example code</strong>
</p><p>You can download the example code files for all Packt books you have purchased from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div></div></div></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec23"/>Reporter objects</h3></div></div></div><p>This object is used to send information to the run results. It has various methods and properties used at runtime to decide and <a id="id161" class="indexterm"/>change the control of flow of scripts. The following table <a id="id162" class="indexterm"/>demonstrates methods and properties of the reporter object.</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Associated methods of the <code class="literal">Reporter</code> object</p>
</th><th style="text-align: left" valign="bottom">
<p>Associated properties of the <code class="literal">Reporter</code> object</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">ReportEvent</code> method<a id="id163" class="indexterm"/>
</p>
<p>
<code class="literal">ReportNote</code> method<a id="id164" class="indexterm"/>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">Filter</code> property</p>
<p>
<code class="literal">ReportPath</code> property</p>
<p>
<code class="literal">RunStatus</code> property</p>
</td></tr></tbody></table></div><p>Let's see how to use these methods and properties:</p><p>It takes four arguments (<code class="literal">EventStatus</code>, <code class="literal">StepName</code>, <code class="literal">Details(Description)</code>, and <code class="literal">[, pathtosavefile]</code>) as shown in the following code:</p><div><pre class="programlisting">Reporter.ReportEvent EventStatus, StepName, Details(Description) [,pathtosavethefile] </pre></div><p>
<code class="literal">EventStatus</code> is shown as a number or a constant. These constants are shown with the description of the message sent to the <strong>Run Result</strong> window as shown in the following table.</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>0 or micPass:</p>
</th><th style="text-align: left" valign="bottom">
<p>1 or micFail:</p>
</th><th style="text-align: left" valign="bottom">
<p>2 or micDone:</p>
</th><th style="text-align: left" valign="bottom">
<p>3 or micWarning:</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>Sends the passed message to the <strong>Run Results</strong> window</p>
</td><td style="text-align: left" valign="top">
<p>Sends the failed message to the <strong>Run Results</strong> window</p>
</td><td style="text-align: left" valign="top">
<p>Sends the message of doneness to the <strong>Run Result</strong> window</p>
</td><td style="text-align: left" valign="top">
<p>Sends a warning message to the <strong>Run Results</strong> window</p>
</td></tr></tbody></table></div><p>The arguments list and its descriptions are mentioned in the following table:</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Arguments</p>
</th><th style="text-align: left" valign="bottom">
<p>Type</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">ReportStepName</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">String</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Name of the step that the user wants to display in the <strong>Run Results</strong> window</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">Details</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">String</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Sends the custom message or step description to run results</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">ImageFilePath</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">String</code>
</p>
</td><td style="text-align: left" valign="top">
<p>This argument is optional. The format to store the images are <code class="literal">.bmp</code>, <code class="literal">.jpeg</code>, <code class="literal">.png</code>, and <code class="literal">.gif</code> format</p>
</td></tr></tbody></table></div><p>The following is the example of how to use the reporter object:</p><div><pre class="programlisting">chk = Window("Flight Reservation").WinButton("FLIGHT").Check (CheckPoint("FLIGHT_2"))
if(chk = True) then
Reporter.ReportEvent micPass, "Verify Flight CheckPoint","Button is enabled"
else
'msgbox "Fail"
Reporter.ReportEvent micFail, "Verify Flight CheckPoint ","Button is disabled"
end if</pre></div><div><div><div><div><h4 class="title"><a id="ch02lvl4sec04"/>The Reporter.RunStatus object</h4></div></div></div><p>The <code class="literal">Reporter.RunStatus</code> object retrieves the current run status of the test. The following example <a id="id165" class="indexterm"/>demonstrates how to retrieve the value if it fails, and then exit from the test:</p><div><pre class="programlisting">If Reporter.RunStatus = micFail Then ExitTest</pre></div><p>This method also<a id="id166" class="indexterm"/> allows setting <code class="literal">RunStatus</code> as shown in the following code:</p><div><pre class="programlisting">Reporter.RunStatus = micPass</pre></div><p>Enable or disable the mode setting:</p><div><pre class="programlisting">CurrentMode = Reporter.Filter To set the mode:  Reporter.Filter = NewMode </pre></div><p>The mode can be one of the following values with description as shown in the following table:</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Mode</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">0</code> or <code class="literal">rfEnableAll</code> Default.</p>
</td><td style="text-align: left" valign="top">
<p>Displays all events in run results</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">1</code> or <code class="literal">rfEnableErrorsAndWarnings</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Displays the warning or fail status in run results</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">2</code> or <code class="literal">rfEnableErrorsOnly</code> </p>
</td><td style="text-align: left" valign="top">
<p>Displays the fail status in the run results</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">3</code> or <code class="literal">rfDisableAll</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Displays no events in run results</p>
</td></tr></tbody></table></div></div></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec24"/>Actions</h3></div></div></div><p>An action is a set <a id="id167" class="indexterm"/>of statements to perform a task(s); divide the test into actions to decompose the functionality into smaller and manageable scripts.</p><div><div><div><div><h4 class="title"><a id="ch02lvl4sec05"/>Purpose of actions</h4></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Provide<a id="id168" class="indexterm"/> decomposition of scripts into manageable pieces</li><li class="listitem" style="list-style-type: disc">Increase reusability</li></ul></div></div><div><div><div><div><h4 class="title"><a id="ch02lvl4sec06"/>Types of actions</h4></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Non reusable actions</strong>: They can <a id="id169" class="indexterm"/>be called in the same test only once and cannot be used in other tests.</li><li class="listitem" style="list-style-type: disc"><strong>Reusable actions</strong>: Reusable<a id="id170" class="indexterm"/> actions can be used in the same test multiple times as well as in other tests.</li><li class="listitem" style="list-style-type: disc"><strong>External actions</strong>: An external action<a id="id171" class="indexterm"/> is defined in another test and is used as read-only in calling a test and can be modified by a stored test.</li></ul></div></div></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec25"/>Error handling</h3></div></div></div><p>Error handling is an important aspect that allows coming up cleanly from erroneous conditions. QTP <a id="id172" class="indexterm"/>provides various options in case of an error.</p><p>Go to <strong>File</strong> | <strong>Settings</strong> | <strong>Run</strong> | <strong>Select</strong> when an error occurs during a run session; the options are:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Pop-up message box</strong>: A pop-up message box displays the options selected by the user.</li><li class="listitem" style="list-style-type: disc"><strong>Proceed to the next test Iteration</strong>: Skip the current iteration and move to the next one.</li><li class="listitem" style="list-style-type: disc"><strong>Stop Run</strong>: Stop the test execution.</li><li class="listitem" style="list-style-type: disc"><strong>Proceed to the next step</strong>: Skip the current step and proceed to the next one.</li></ul></div><p>By specifying this action the test will come out of the error condition and proceed as a selected option. QTP also provides the recovery mechanism. Using VBScript we can handle various error situations using VBScript's <code class="literal">ERR</code> object. We will see how to use it in the later chapters of this book.</p></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec26"/>Parameterization</h3></div></div></div><p>A parameter is a variable that holds a value(s). Parameterization allows substituting of values when a test is<a id="id173" class="indexterm"/> executed. QTP uses <code class="literal">datatable</code> to parameterize the test. Either a global or local sheet can be used for parameterization:</p><div><pre class="programlisting">Dialog("Login").WinEdit("Agent Name:").Set DataTable("Name", dtGlobalSheet) 'Name is column name in datatable and retrieving the data from global sheet</pre></div><div><img src="img/1027EN_02_12.jpg" alt="Parameterization"/></div><p>The data defined in <code class="literal">DataTable</code> or any external data source allows parameterizing of the test when a test is<a id="id174" class="indexterm"/> run for a number of rows in data sources. Parameterization helps to make the test iterative.</p></div><div><div><div><div><h3 class="title"><a id="ch02lvl3sec27"/>Environment Variables</h3></div></div></div><p>QTP allows configuring of the test using <a id="id175" class="indexterm"/>environment variables. QTP provides built-in variables and allows the user to define variables as well. In-built environment variables can be viewed by navigating to <strong>Test</strong> | <strong>Setting</strong> | <strong>Environment</strong> | <strong>Select Built-in</strong> from the drop down.</p><p>The following example creates a new user-defined variable named <code class="literal">MyVariable</code> with a value of <code class="literal">15</code>, and then retrieves the variable value and stores it in the <code class="literal">MyValue</code> variable:</p><div><pre class="programlisting">Environment.Value("MyVariable")=10 
testvalue = Environment.Value("MyVariable") </pre></div><p>We can create the <code class="literal">Environment</code> variable using XML as shown in the following code and add it by navigating to <strong>Test</strong> | <strong>Setting</strong> | <strong>Environment</strong> | <strong>Select the user define option</strong>. Set the export file from the load variable and XML from an external file. Use the <strong>Browse</strong> option to add it. The environment variable file must be an XML file; use the following syntax:</p><div><pre class="programlisting">&lt;Environment&gt;
    &lt;Variable&gt;
        &lt;Name&gt;TestEnv&lt;/Name&gt; 
&lt;!--  other environments are QA, Test and Dev -- &gt;
        &lt;Value&gt;Staging&lt;/Value&gt;
    &lt;/Variable&gt;
&lt;/Environment&gt;</pre></div><p>QTP allows loading the specified environment variable file using the command <code class="literal">Environment.LoadFromFile(Path)</code>.</p><p>The following example loads the <code class="literal">Environment.xml</code> file<a id="id176" class="indexterm"/>:</p><div><pre class="programlisting">Environment.LoadFromFile("C:\Environment.xml") 
'Check if an External Environment file is loaded and if not, load it. 
fileName = Environment.ExternalFileName 
If (fileName = "") Then 
Environment.LoadFromFile("C:\Environment.xml") 
End If 
'display value of one of the Environment variables from the External file 
msgbox Environment("TestEnv") </pre></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Summary</h1></div></div></div><p>The key theme of this chapter was to learn how to create scripts and concepts that are reliable and reusable. The smaller code examples demonstrate the usage of these concepts. This chapter covered the steps required to create scripts and enhance the scripts using checkpoints, parameterization, environment variables splitting the actions, and adding the reporter object to notify the results in the <strong>Run Result</strong> window. In the next chapter, the key discussion will be around building the key features using code that can be utilized to develop the components that can be used in frameworks.</p></div></body></html>