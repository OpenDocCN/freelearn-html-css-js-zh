<html><head></head><body>
		<div id="_idContainer069">
			<h1 id="_idParaDest-41" class="chapter-number"><a id="_idTextAnchor040"/>3</h1>
			<h1 id="_idParaDest-42"><a id="_idTextAnchor041"/>Working with Light Sources in Three.js</h1>
			<p>In <a href="B18726_01.xhtml#_idTextAnchor014"><span class="No-Break"><em class="italic">Chapter 1</em></span></a>, <em class="italic">Creating Your First 3D Scene with Three.js</em>, you learned about the basics of Three.js, and in <a href="B18726_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>, <em class="italic">The Basic Components that Make up a Three.js Application</em>, we looked a bit deeper at the most important parts of the scene: the geometries, meshes, and cameras. You might have noticed that we skipped exploring the details of lights in that chapter, even though they make up an important part of every Three.js scene. Without lights, we won’t see anything rendered (unless we use basic or wireframe materials). Since Three.js contains several different light sources, each of which has a specific use, we’ll use this chapter to explain the various details of lights and prepare you for the upcoming chapters on material usage. By the end of this chapter, you’ll know the differences between the available lights and be able to choose and configure the correct light for <span class="No-Break">your scene.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">WebGL itself doesn’t have inherent support for lighting. Without Three.js, you would have to write specific WebGL shader programs to simulate these kinds of lights, which is quite difficult. A good introduction to simulating lighting in WebGL<a id="_idIndexMarker176"/> from scratch can be found <span class="No-Break">at </span><a href="https://developer.mozilla.org/en-US/docs/Web/WebGL/Lighting_in_WebGL"><span class="No-Break">https://developer.mozilla.org/en-US/docs/Web/WebGL/Lighting_in_WebGL</span></a><span class="No-Break">.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Different kinds of lighting <span class="No-Break">in Three.js</span></li>
				<li>Working with <span class="No-Break">basic lights</span></li>
				<li>Working with <span class="No-Break">special lights</span></li>
			</ul>
			<p>As with all the chapters, we have a lot of examples that you can use to experiment with the behavior of lights. The examples shown in this chapter can be found in the <strong class="source-inline">chapter-03</strong> folder of the <span class="No-Break">supplied sources.</span></p>
			<h1 id="_idParaDest-43"><a id="_idTextAnchor042"/>What lighting types are provided in Three.js?</h1>
			<p>Several different lights are available in Three.js that all have specific behavior and usages. In this chapter, we’ll discuss the following set <span class="No-Break">of lights:</span></p>
			<ul>
				<li><strong class="source-inline">THREE.AmbientLight</strong>: This is a <a id="_idIndexMarker177"/>basic light, the color of which is added to the current color of the objects in <span class="No-Break">the scene.</span></li>
				<li><strong class="source-inline">THREE.PointLight</strong>: This is <a id="_idIndexMarker178"/>a single point in space from which light spreads in all directions. This light can be used to <span class="No-Break">create shadows.</span></li>
				<li><strong class="source-inline">THREE.SpotLight</strong>: This<a id="_idIndexMarker179"/> light source has a cone-like effect like that of a desk lamp, a spotlight in the ceiling, or a torch. This light can <span class="No-Break">cast shadows.</span></li>
				<li><strong class="source-inline">THREE.DirectionalLight</strong>: This is <a id="_idIndexMarker180"/>also called infinite light. The light rays from this light can be seen as parallel, similar to the light from the Sun. This light can also be used to <span class="No-Break">create shadows.</span></li>
				<li><strong class="source-inline">THREE.HemisphereLight</strong>: This <a id="_idIndexMarker181"/>is a special light and can be used to create more natural-looking outdoor lighting by simulating a reflective surface and a faintly illuminating sky. This light also doesn’t provide any <span class="No-Break">shadow-related functionality.</span></li>
				<li><strong class="source-inline">THREE.RectAreaLight</strong>: With <a id="_idIndexMarker182"/>this light source, instead of a single point in space, you can specify an area from which light emanates. <strong class="source-inline">THREE.RectAreaLight</strong> doesn’t cast <span class="No-Break">any shadows.</span></li>
				<li><strong class="source-inline">THREE.LightProbe</strong>: This is a special <a id="_idIndexMarker183"/>kind of light source where, based on the environment map used, a dynamic ambient light source is created to light <span class="No-Break">the scene.</span></li>
				<li><strong class="source-inline">THREE.LensFlare</strong>: This is<a id="_idIndexMarker184"/> not a light source, but with <strong class="source-inline">THREE.LensFlare</strong>, you can add a lens flare effect to the lights in <span class="No-Break">your scene.</span></li>
			</ul>
			<p>This chapter is divided into two main parts. First, we’ll look at the basic lights: <strong class="source-inline">THREE.AmbientLight</strong>, <strong class="source-inline">THREE.PointLight</strong>, <strong class="source-inline">THREE.SpotLight</strong>, and <strong class="source-inline">THREE.DirectionalLight</strong>. All these lights extend the base <strong class="source-inline">THREE.Light</strong> object, which provides shared functionality. The lights mentioned here are simple lights that require little setup and can be used to recreate most of the required lighting scenarios. In the second part, we will look at a couple of special-purpose lights and effects: <strong class="source-inline">THREE.HemisphereLight</strong>, <strong class="source-inline">THREE.RectAreaLight</strong>, <strong class="source-inline">THREE.LightProbe</strong>, and <strong class="source-inline">THREE.LensFlare</strong>. You’ll probably only need these lights in very <span class="No-Break">specific cases.</span></p>
			<h1 id="_idParaDest-44"><a id="_idTextAnchor043"/>Working with basic lights</h1>
			<p>We’ll start with the most basic of the <span class="No-Break">lights: </span><span class="No-Break"><strong class="source-inline">THREE.AmbientLight</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-45"><a id="_idTextAnchor044"/>THREE.AmbientLight</h2>
			<p>When you create a <strong class="source-inline">THREE.AmbientLight</strong>, the color is applied globally. There isn’t a specific direction <a id="_idIndexMarker185"/>this light comes from, and <strong class="source-inline">THREE.AmbientLight</strong> doesn’t <a id="_idIndexMarker186"/>contribute to any shadows. You would normally not use <strong class="source-inline">THREE.AmbientLight</strong> as the single source of light in a scene since it applies its color to all the objects in the scene in the same way, regardless of the shape of the mesh. You use it together with other lighting sources, such as <strong class="source-inline">THREE.SpotLight</strong> or <strong class="source-inline">THREE.DirectionalLight</strong>, to soften the shadows or add some additional color to the scene. The easiest way to understand this is by looking at the <strong class="source-inline">ambient-light.html</strong> example in the <strong class="source-inline">chapter-03</strong> folder. In this example, you get a simple user interface that can be used to modify the <strong class="source-inline">THREE.AmbientLight</strong> object that is available in <span class="No-Break">this scene.</span></p>
			<p>In the following screenshots, you can see that we used a simple waterfall model, and made the <strong class="source-inline">color</strong> and <strong class="source-inline">intensity</strong> properties of the used <strong class="source-inline">THREE.AmbientLight</strong> object configurable. In this first screenshot, you can see what happens when we set the color of the light <span class="No-Break">to red:</span></p>
			<div>
				<div id="_idContainer047" class="IMG---Figure">
					<img src="image/Figure_3.1_B18726.jpg" alt="Figure 3.1 – Ambient light set to red"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.1 – Ambient light set to red</p>
			<p>As you can see, each <a id="_idIndexMarker187"/>element in our scene now has a red color added to its<a id="_idIndexMarker188"/> original color. And if we change the color to blue, we’ll get something <span class="No-Break">like this:</span></p>
			<div>
				<div id="_idContainer048" class="IMG---Figure">
					<img src="image/Figure_3.2_B18726.jpg" alt="Figure 3.2 – Ambient light set to blue"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.2 – Ambient light set to blue</p>
			<p>As this screenshot<a id="_idIndexMarker189"/> shows, the blue color is applied to all the objects <a id="_idIndexMarker190"/>and casts a glow over the complete scene. What you should remember when working with this light is that you should be very conservative with the color you specify. If the color you specify is too bright, you’ll quickly get a completely oversaturated image. Besides the color, we can also set the <strong class="source-inline">intensity</strong> property of the light. This property determines how much <strong class="source-inline">THREE.AmbientLight</strong> affects the colors in the scene. If we turn it down, only a little of the color is applied to the objects in the scene. If we turn it up, our scene becomes <span class="No-Break">really bright:</span></p>
			<div>
				<div id="_idContainer049" class="IMG---Figure">
					<img src="image/Figure_3.3_B18726.jpg" alt="Figure 3.3 – Ambient light set to red with high intensity"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.3 – Ambient light set to red with high intensity</p>
			<p>Now that we’ve seen what it does, let’s look at how you can create and use a <strong class="source-inline">THREE.AmbientLight</strong>. The <a id="_idIndexMarker191"/>following lines of code show you how to create <a id="_idIndexMarker192"/><span class="No-Break">a </span><span class="No-Break"><strong class="source-inline">THREE.AmbientLight</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
const color = new THREE.Color(0xffffff);
const light = new THREE.AmbientLight(color);
scene.add(light);</pre>
			<p>Creating a <strong class="source-inline">THREE.AmbientLight</strong> is very simple and only takes a couple of steps. <strong class="source-inline">THREE.AmbientLight</strong> doesn’t have a position and is applied globally, so we only need to specify the color and add this light to the scene. Optionally, we can also provide an additional value in this constructor for the intensity of this light. Since we didn’t specify it here, it uses a default intensity <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">.</span></p>
			<p>Note that in the previous code fragment, we passed in an explicit <strong class="source-inline">THREE.Color</strong> object to the constructor of <strong class="source-inline">THREE.AmbientLight</strong>. We could have also passed in the color as a string – for example, <strong class="source-inline">"rgb(255, 0, 0)"</strong> or <strong class="source-inline">"hsl(0, 100%, 50%)"</strong> – or as a number, as we did in the previous chapters: <strong class="source-inline">0xff0000</strong>. More information on this can be found in the <em class="italic">Using the THREE.Color </em><span class="No-Break"><em class="italic">object</em></span><span class="No-Break"> section.</span></p>
			<p>Before we discuss <strong class="source-inline">THREE.PointLight</strong>, <strong class="source-inline">THREE.SpotLight</strong>, and <strong class="source-inline">THREE.DirectionalLight</strong>, first, let’s highlight their main difference – that is, how they emit light. The following diagram shows how these three light sources <span class="No-Break">emit light:</span></p>
			<div>
				<div id="_idContainer050" class="IMG---Figure">
					<img src="image/Figure_3.4_B18726.jpg" alt="Figure 3.4 – How different light sources emit light"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.4 – How different light sources emit light</p>
			<p>You can see the following from <span class="No-Break">this diagram:</span></p>
			<ul>
				<li><strong class="source-inline">THREE.PointLight</strong> emits light from a specific point in <span class="No-Break">all directions</span></li>
				<li><strong class="source-inline">THREE.SpotLight</strong> emits light from a specific point in a <span class="No-Break">cone-like shape</span></li>
				<li><strong class="source-inline">THREE.DirectionalLight</strong> doesn’t emit light from a single point but emits light rays from a 2D plane, where the<a id="_idIndexMarker193"/> rays are parallel to <span class="No-Break">each </span><span class="No-Break"><a id="_idIndexMarker194"/></span><span class="No-Break">other</span></li>
			</ul>
			<p>We’ll look at these light sources in more detail in the next few sections. Let’s start <span class="No-Break">with </span><span class="No-Break"><strong class="source-inline">THREE.SpotLight</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-46"><a id="_idTextAnchor045"/>THREE.SpotLight</h2>
			<p><strong class="source-inline">THREE.SpotLight</strong> is one of<a id="_idIndexMarker195"/> the lights you’ll use often (especially if you want to use shadows). <strong class="source-inline">THREE.SpotLight</strong> is a light source that has a cone-like effect. You can<a id="_idIndexMarker196"/> compare this with a flashlight or a lantern. This light source has a direction and an angle at which it produces light. The following screenshot shows what a <strong class="source-inline">THREE.SpotLight</strong> looks <span class="No-Break">like (</span><span class="No-Break"><strong class="source-inline">spotlight.html</strong></span><span class="No-Break">):</span></p>
			<div>
				<div id="_idContainer051" class="IMG---Figure">
					<img src="image/Figure_3.5_B18726.jpg" alt="Figure 3.5 – Spotlight lighting a scene"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.5 – Spotlight lighting a scene</p>
			<p>The following table lists all the <a id="_idIndexMarker197"/>properties that you can use to finetune <strong class="source-inline">THREE.SpotLight</strong>. First, we’ll <a id="_idIndexMarker198"/>look at the properties specific to the <span class="No-Break">light’s behavior:</span></p>
			<table id="table001-2" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Name</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">Angle</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Determines how wide the beam emerging from the light is. The width is measured in radians and defaults <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">Math.PI/3</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">castShadow</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>If set to <strong class="source-inline">true</strong>, the light to which the property is applied will create shadows. See the following table on how to configure <span class="No-Break">the shadows.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">Color</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the color of <span class="No-Break">the light.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">decay</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the amount the light intensity diminishes the farther you move away from the light source. A <strong class="source-inline">decay</strong> of <strong class="source-inline">2</strong> leads to more realistic light, and the default value is <strong class="source-inline">1</strong>. This property is only effective when the <strong class="source-inline">physicallyCorrectLights</strong> property is set <span class="No-Break">on </span><span class="No-Break"><strong class="source-inline">WebGLRenderer</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">distance</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>When this property is set to a non-<strong class="source-inline">0</strong> value, the light intensity will decrease linearly from the set intensity at the light’s position to <strong class="source-inline">0</strong> at the <span class="No-Break">specified distance.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">intensity</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the intensity with which the light shines. The property’s default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">penumbra</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the percentage at the edge of the spotlight’s coin, which is smoothed (blurred) to <strong class="source-inline">0</strong>. It takes a value between <strong class="source-inline">0</strong> and <strong class="source-inline">1</strong>, where the default <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">0</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">power</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Denotes the light’s <strong class="source-inline">power</strong> when rendered in the physically correct mode (enable this by setting the <strong class="source-inline">physicallyCorrectLights</strong> property set on <strong class="source-inline">WebGLRenderer</strong>). This property is measured in lumens and the default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">4*Math.PI</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">position</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the position of a light <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">THREE.Scene</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">target</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>With <strong class="source-inline">THREE.SpotLight</strong>, the direction the light is pointed in is important. With the <strong class="source-inline">target</strong> property, you can point <strong class="source-inline">THREE.SpotLight</strong> to look at a specific object or position in the scene. Note that this property requires a <strong class="source-inline">THREE.Object3D</strong> object (such as a <strong class="source-inline">THREE.Mesh</strong>). This is in contrast to the cameras we saw in <a href="B18726_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>, which use <strong class="source-inline">THREE.Vector3</strong> in their <span class="No-Break"><strong class="source-inline">lookAt</strong></span><span class="No-Break"> function.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">visible</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>If this property is set to <strong class="source-inline">true</strong> (the default), the light is turned on, while if it is set to <strong class="source-inline">false</strong>, the light is <span class="No-Break">turned off.</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.6 – Properties of the THREE.SpotLight object</p>
			<p>When you enable the<a id="_idIndexMarker199"/> shadow for <strong class="source-inline">THREE.SpotLight</strong>, you can control how that shadow is rendered. You can control this through the shadow property of a <strong class="source-inline">THREE.SpotLight</strong>, which can <a id="_idIndexMarker200"/>comprise <span class="No-Break">the following:</span></p>
			<table id="table002" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Name</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">shadow.bias</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Moves the cast shadow away or toward the object casting the shadow. You can use this to solve some strange effects when you work with very thin objects. If you see strange shadow effects on your models, small values (for example, <strong class="source-inline">0.01</strong>) for this property can often resolve the issue. The default value for this property <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">0</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">shadow.camera.far</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Determines from what distance from the light shadows should be created. The default value is <strong class="source-inline">5000</strong>. Note that you can also set all the other properties provided for <strong class="source-inline">THREE.PerspectiveCamera</strong>, which we showed in <a href="B18726_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic">Chapter 2</em></span></a><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">shadow.camera.fov</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Determines how large the field of view used to create shadows is (see the <em class="italic">Using different cameras for different scenes</em> section in <a href="B18726_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>). The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">50</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">shadow.camera.near</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Determines from what distance from the light shadows should be created. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">50</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">shadow.mapSize.width</strong></span><span class="No-Break"> and</span></p>
							<p><span class="No-Break"><strong class="source-inline">shadow.mapSize.height</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Determine how many pixels are used to create a shadow. Increase these when a shadow has jagged edges or doesn’t look smooth. This can’t be changed after the scene has been rendered. The default value for both <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">512</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">shadow.radius</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>When this value is set higher than 1, the edge of the shadows will be blurred. This won’t have any effect if the <strong class="source-inline">shadowMap.type</strong> property of <strong class="source-inline">THREE.WebGlRenderer</strong> is set <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">THREE.BasicShadowMap</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.7 – Shadow properties of the THREE.SpotLight object</p>
			<p>Creating <strong class="source-inline">THREE.SpotLight</strong> is very <a id="_idIndexMarker201"/>easy. Just specify the color, set the properties<a id="_idIndexMarker202"/> you want, and add it to the scene, <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
const spotLight = new THREE.SpotLight("#ffffff")
spotLight.penumbra = 0.4;
spotLight.position.set(10, 14, 5);
spotLight.castShadow = true;
spotLight.intensity = 1;
spotLight.shadow.camera.near = 10;
spotLight.shadow.camera.far = 25;
spotLight.shadow.mapSize.width = 2048;
spotLight.shadow.mapSize.height = 2048;
spotLight.shadow.bias = -0.01;
scene.add(spotLight.target);</pre>
			<p>Here, we create an instance of <strong class="source-inline">THREE.SpotLight</strong> and set the various properties to configure the light. We also explicitly set the <strong class="source-inline">castShadow</strong> property to <strong class="source-inline">true</strong> because we want shadows. We also need to point <strong class="source-inline">THREE.SpotLight</strong> somewhere, which we do with the <strong class="source-inline">target</strong> property. Before we can use this property, we first need to add the default <strong class="source-inline">target</strong> of the light to the scene, <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
scene.add(spotLight.target);</pre>
			<p>By default, the target will be set to <strong class="source-inline">(0, 0, 0)</strong>. In the example for this section, you can change the location of the <strong class="source-inline">target</strong> property and see that the light follows the position of <span class="No-Break">this object:</span></p>
			<div>
				<div id="_idContainer052" class="IMG---Figure">
					<img src="image/Figure_3.8_B18726.jpg" alt="Figure 3.8 – Spotlight pointing to a target"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.8 – Spotlight pointing to a target</p>
			<p>Note that you can also set the target of the light to an object in the scene. In that case, the direction of the light will be pointed to that object. If the object that the light is pointed at moves around, the light will keep pointing at <span class="No-Break">that object.</span></p>
			<p>In the table at the <a id="_idIndexMarker203"/>beginning of<a id="_idIndexMarker204"/> this section, we showed a couple of properties that can be used to control how the light emanates from <strong class="source-inline">THREE.SpotLight</strong>. The <strong class="source-inline">distance</strong> and <strong class="source-inline">angle</strong> properties define the shape of the cone of light. The <strong class="source-inline">angle</strong> property defines the width of the cone, and with the <strong class="source-inline">distance</strong> property, we set the length of the cone. The following diagram explains how these two values define the area that will receive light <span class="No-Break">from </span><span class="No-Break"><strong class="source-inline">THREE.SpotLight</strong></span><span class="No-Break">:</span></p>
			<div>
				<div id="_idContainer053" class="IMG---Figure">
					<img src="image/Figure_3.9_B18726.jpg" alt="Figure 3.9 – Spotlight angle and distance"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.9 – Spotlight angle and distance</p>
			<p>Usually, you won’t need<a id="_idIndexMarker205"/> to set these values since they come with reasonable defaults, but you can use these properties, for instance, to create a <strong class="source-inline">THREE.SpotLight</strong> instance <a id="_idIndexMarker206"/>that has a very narrow beam or quickly decreases in light intensity. The last property you can use to change the way <strong class="source-inline">THREE.SpotLight</strong> produces light is the <strong class="source-inline">penumbra</strong> property. With this property, you set from what position the intensity of the light decreases at the edge of the light cone. In the following screenshot, you can see the result of the <strong class="source-inline">penumbra</strong> property in action. We have a very bright light (high intensity) that rapidly decreases in intensity as it reaches the edge of <span class="No-Break">the cone:</span></p>
			<div>
				<div id="_idContainer054" class="IMG---Figure">
					<img src="image/Figure_3.10_B18726.jpg" alt="Figure 3.10 – Spotlight with a hard penumbra"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.10 – Spotlight with a hard penumbra</p>
			<p>Sometimes, it can be<a id="_idIndexMarker207"/> difficult to determine the correct settings for your lights, just by looking at the rendered scene. You might want to finetune the area that is lit for performance reasons or try and move the light around to a very specific location. This can be achieved by <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">THREE.SpotLightHelper</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
const spotLightHelper = new THREE.SpotLightHelper
  (spotLight);
scene.add(spotLightHelper)
// in the render loop
spotLightHelper.update();</pre>
			<p>With the preceding code, you get <a id="_idIndexMarker208"/>an outline that shows the details of the spotlight, and can help in debugging and correctly positioning and configuring <span class="No-Break">your light:</span></p>
			<div>
				<div id="_idContainer055" class="IMG---Figure">
					<img src="image/Figure_3.11_B18726.jpg" alt="Figure 3.11– Spotlight with the helper enabled"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.11– Spotlight with the helper enabled</p>
			<p>Before moving on to <a id="_idIndexMarker209"/>the next light source, we’ll quickly look at the shadow-related properties available for a <strong class="source-inline">THREE.SpotLight</strong> object. You’ve already learned that we can get shadows by setting the <strong class="source-inline">castShadow</strong> property of a <strong class="source-inline">THREE.SpotLight</strong> instance to <strong class="source-inline">true</strong>. You also know that a <strong class="source-inline">THREE.Mesh</strong> object has two <a id="_idIndexMarker210"/>shadow-related properties. You set the <strong class="source-inline">castShadow</strong> property for objects that should cast shadows, and you use the <strong class="source-inline">receiveShadow</strong> property for objects that should show a shadow. Three.js also allows you very fine-grained control over how the shadow is rendered. This is done by a couple of the properties we explained in the table at the beginning of this section. With <strong class="source-inline">shadow.camera.near</strong>, <strong class="source-inline">shadow.camera.far</strong>, and <strong class="source-inline">shadow.camera.fov</strong>, you can control how and where this light casts a shadow. For a <strong class="source-inline">THREE.SpotLight</strong> instance, you can’t set <strong class="source-inline">shadow.camera.fov</strong> directly. This property is based on the <strong class="source-inline">angle</strong> property of <strong class="source-inline">THREE.SpotLight</strong>. This works in the same way as the perspective camera’s field of view, which we explained in <a href="B18726_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>. The easiest way to see this in action is by adding a <strong class="source-inline">THREE.CameraHelper</strong>; you can do this by checking the menu’s <strong class="source-inline">shadow-helper</strong> checkbox and playing around with the camera settings. As you can see in the following screenshot, selecting this checkbox shows the area that is used to determine the shadows for <span class="No-Break">this light:</span></p>
			<div>
				<div id="_idContainer056" class="IMG---Figure">
					<img src="image/Figure_3.12_B18726.jpg" alt="Figure 3.12 – Spotlight with the shadow helper enabled"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.12 – Spotlight with the shadow helper enabled</p>
			<p>When debugging issues<a id="_idIndexMarker211"/> with shadows, adding <strong class="source-inline">THREE.CameraHelper</strong> is useful. To<a id="_idIndexMarker212"/> do this, just add the <span class="No-Break">following lines:</span></p>
			<pre class="source-code">
const shadowCameraHelper = new THREE.CameraHelper
  (spotLight.shadow.camera);
scene.add(shadowCameraHelper);
// in the render loop
shadowCameraHelper.update();</pre>
			<p>I’ll end this section with a couple of pointers, just in case you run into issues <span class="No-Break">with shadows.</span></p>
			<p>If the shadow looks blocky, you can increase the <strong class="source-inline">shadow.mapSize.width</strong> and <strong class="source-inline">shadow.mapSize.Height</strong> properties and make sure the area that is used to calculate the shadow tightly wraps your object. You can use the <strong class="source-inline">shadow.camera.near</strong>, <strong class="source-inline">shadow.camera.far</strong>, and <strong class="source-inline">shadow.camera.fov</strong> properties to configure <span class="No-Break">this area.</span></p>
			<p>Remember that you not only have to tell the light to cast shadows but also have to tell each geometry whether it will receive and/or cast shadows by setting the <strong class="source-inline">castShadow</strong> and <span class="No-Break"><strong class="source-inline">receiveShadow</strong></span><span class="No-Break"> properties.</span></p>
			<p class="callout-heading">Shadow bias</p>
			<p class="callout">If you use thin objects in your scene, you might see strange artifacts when you render shadows. You can use the <strong class="source-inline">shadow.bias</strong> property to slightly offset the shadows, which will often fix <span class="No-Break">these issues.</span></p>
			<p>If you want to have softer shadows, you can set a different <strong class="source-inline">shadowMapType</strong> value on <strong class="source-inline">THREE.WebGLRenderer</strong>. By default, this property is set to <strong class="source-inline">THREE.PCFShadowMap</strong>; if you set this<a id="_idIndexMarker213"/> property to <strong class="source-inline">PCFSoftShadowMap</strong>, you’ll get <span class="No-Break">softer</span><span class="No-Break"><a id="_idIndexMarker214"/></span><span class="No-Break"> shadows.</span></p>
			<p>Now, let’s look at the next light source in the <span class="No-Break">list: </span><span class="No-Break"><strong class="source-inline">THREE.PointLight</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-47"><a id="_idTextAnchor046"/>THREE.PointLight</h2>
			<p><strong class="source-inline">THREE.PointLight</strong> is a light<a id="_idIndexMarker215"/> source that shines light in all directions emanating from<a id="_idIndexMarker216"/> a single point. A good example of a point light is a signal flare fired into the night sky or a campfire. Just as with all the lights, we have a specific example you can use to play around with <strong class="source-inline">THREE.PointLight</strong>. If you look at <strong class="source-inline">point-light.html</strong> in the <strong class="source-inline">chapter-03</strong> folder, you can find an example where a <strong class="source-inline">THREE.PointLight</strong> is being used in the same scene we’re also using for the <span class="No-Break">other lights:</span></p>
			<div>
				<div id="_idContainer057" class="IMG---Figure">
					<img src="image/Figure_3.13_B18726.jpg" alt="Figure 3.13 – PointLight with the helper enabled"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.13 – PointLight with the helper enabled</p>
			<p>As you can see<a id="_idIndexMarker217"/> from the previous screenshot, this light emits to all sides. Just like the<a id="_idIndexMarker218"/> spotlight we saw earlier, this light also has a helper, which you can use in the same way. You can see this as the wireframe in the center of <span class="No-Break">the scene:</span></p>
			<pre class="source-code">
const pointLightHelper = new THREE.PointLightHelper
  (pointLight);
scene.add(pointLightHelper)
// in the render loop
pointLightHelper.update();</pre>
			<p><strong class="source-inline">THREE.PointLight</strong> shares <a id="_idIndexMarker219"/>several properties with <strong class="source-inline">THREE.SpotLight</strong>, which you <a id="_idIndexMarker220"/>can use to configure how this <span class="No-Break">light behaves:</span></p>
			<table id="table003" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Name</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">color</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>The color of the light that this light <span class="No-Break">source emits.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">distance</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the distance for which the light shines. The default value is <strong class="source-inline">0</strong>, which means that the light’s intensity doesn’t decrease based <span class="No-Break">on distance.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">intensity</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the intensity the light shines with. This defaults <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">position</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the position of the light <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">THREE.Scene</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">visible</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Determines whether the light is turned off or on. If this property is set to <strong class="source-inline">true</strong> (the default), this light is turned on, and if set it to <strong class="source-inline">false</strong>, the light is <span class="No-Break">turned off.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">decay</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the amount the light intensity diminishes the farther you move away from the light source. A <strong class="source-inline">decay</strong> of <strong class="source-inline">2</strong> leads to more realistic light, and the default value is <strong class="source-inline">1</strong>. This property is effective only when the <strong class="source-inline">physicallyCorrectLights</strong> property is set <span class="No-Break">on </span><span class="No-Break"><strong class="source-inline">WebGLRenderer</strong></span><span class="No-Break">.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">power</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Refers to the light’s power when being rendered in the physically correct mode (enable this by setting the <strong class="source-inline">physicallyCorrectLights</strong> property set on <strong class="source-inline">WebGLRenderer</strong>). This property is measured in lumens and the default value is <strong class="source-inline">4*Math.PI</strong>. <strong class="source-inline">Power</strong> is also directly related to the <strong class="source-inline">intensity</strong> property (<em class="italic">power = intensity * </em><span class="No-Break"><em class="italic">4π</em></span><span class="No-Break">).</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.14 – Properties of the THREE.PointLight object</p>
			<p>Besides these properties, the <strong class="source-inline">THREE.PointLight</strong> object’s shadow can be configured in the same way as the shadow for <strong class="source-inline">THREE.SpotLight</strong>. In the next couple of examples and screenshots, we’ll show how these properties work for <strong class="source-inline">THREE.PointLight</strong>. First, let’s look at how <a id="_idIndexMarker221"/>you can create <span class="No-Break">a </span><span class="No-Break"><strong class="source-inline">THREE.PointLight</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
const pointLight = new THREE.PointLight();
scene.add(pointLight);</pre>
			<p>There’s nothing <a id="_idIndexMarker222"/>special here – we just define the light and add it to the scene; you can, of course, set any of the properties we just showed as well. The two main properties of the <strong class="source-inline">THREE.SpotLight</strong> object are <strong class="source-inline">distance</strong> and <strong class="source-inline">intensity</strong>. With <strong class="source-inline">distance</strong>, you can specify how far the light is emitted before it decays to <strong class="source-inline">0</strong>. For example, in the following screenshot, we set the <strong class="source-inline">distance</strong> property to a low value, and increased the <strong class="source-inline">intensity</strong> property a bit to simulate a campfire between <span class="No-Break">the trees:</span></p>
			<div>
				<div id="_idContainer058" class="IMG---Figure">
					<img src="image/Figure_3.15_B18726.jpg" alt="Figure 3.15 – PointLight with low distance and higher intensity"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.15 – PointLight with low distance and higher intensity</p>
			<p>You can’t set<a id="_idIndexMarker223"/> the <strong class="source-inline">power</strong> and decay properties in this example; these properties are <a id="_idIndexMarker224"/>really useful if you want to simulate real-world scenarios. A good example of this can be found on the Three.js <span class="No-Break">website: </span><a href="https://threejs.org/examples/#webgl_lights_physical"><span class="No-Break">https://threejs.org/examples/#webgl_lights_physical</span></a><span class="No-Break">.</span></p>
			<p><strong class="source-inline">THREE.PointLight</strong> also uses a camera to determine where to draw the shadows, so you can use <strong class="source-inline">THREE.CameraHelper</strong> to show what part is covered by that camera. In addition, <strong class="source-inline">THREE.PointLight</strong> provides a helper, <strong class="source-inline">THREE.PointLightHelper</strong>, to show where <strong class="source-inline">THREE.PointLight</strong> shines its light. With both enabled, you get the following very useful <span class="No-Break">debug information:</span></p>
			<div>
				<div id="_idContainer059" class="IMG---Figure">
					<img src="image/Figure_3.16_B18726.jpg" alt="Figure 3.16 – PointLight with helpers enabled"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.16 – PointLight with helpers enabled</p>
			<p>If you look <a id="_idIndexMarker225"/>closely at the previous screenshot (<span class="No-Break"><em class="italic">Figure 3</em></span><em class="italic">.16</em>), you might notice <a id="_idIndexMarker226"/>that shadows are created outside the area the shadow camera is showing. This is because the shadow helper only shows the shadows being cast down from the position of the point light. You can visualize a <strong class="source-inline">THREE.PointLight</strong> as a cube, where each side emits light and can cast shadows. In this case, <strong class="source-inline">THREE.ShadowCameraHelper</strong> only shows the shadows being <span class="No-Break">cast down.</span></p>
			<p>The last of the basic lights that we’ll be discussing <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">THREE.DirectionalLight</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-48"><a id="_idTextAnchor047"/>THREE.DirectionalLight</h2>
			<p>This type of light source can be <a id="_idIndexMarker227"/>considered as a light that is very far away. All the<a id="_idIndexMarker228"/> light rays it sends out are parallel to each other. A good example of this is the Sun. The Sun is so far away that the light rays we receive on Earth are (almost) parallel to each other. The main difference between <strong class="source-inline">THREE.DirectionalLight</strong> and <strong class="source-inline">THREE.SpotLight</strong> (which we saw previously) is that this light won’t diminish the farther it gets from the source as it does with <strong class="source-inline">THREE.SpotLight</strong> (you can fine-tune this with the <strong class="source-inline">distance</strong> and <strong class="source-inline">exponent</strong> parameters). The complete area that is lit by <strong class="source-inline">THREE.DirectionalLight</strong> receives the same intensity of light. To see <a id="_idIndexMarker229"/>this in action, look at the following <span class="No-Break"><strong class="source-inline">directional-light.html</strong></span><span class="No-Break"> example:</span></p>
			<div>
				<div id="_idContainer060" class="IMG---Figure">
					<img src="image/Figure_3.17_B18726.jpg" alt="Figure 3.17 – Directional light simulating a sunset"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.17 – Directional light simulating a sunset</p>
			<p>As you can see, it is very easy to simulate, for instance, a sunset, using a <strong class="source-inline">THREE.DirectionalLight</strong>. Just as with <strong class="source-inline">THREE.SpotLight</strong>, there are a couple of properties you can set on this light. For example, you can set the <strong class="source-inline">intensity</strong> property of the light and the way it casts shadows. <strong class="source-inline">THREE.DirectionalLight</strong> has a lot of properties that are the same as those of <strong class="source-inline">THREE.SpotLight</strong>: <strong class="source-inline">position</strong>, <strong class="source-inline">target</strong>, <strong class="source-inline">intensity</strong>, <strong class="source-inline">castShadow</strong>, <strong class="source-inline">shadow.camera.near</strong>, <strong class="source-inline">shadow.camera.far</strong>, <strong class="source-inline">shadow.mapSize.width</strong>, <strong class="source-inline">shadow.mapSize.width</strong>, and <strong class="source-inline">shadowBias</strong>. For more information on those properties, you can look at the preceding section <span class="No-Break">on </span><span class="No-Break"><strong class="source-inline">THREE.SpotLight</strong></span><span class="No-Break">.</span></p>
			<p>If you look back at<a id="_idIndexMarker230"/> the <strong class="source-inline">THREE.SpotLight</strong> examples, you will see that we had to define the cone of light where shadows were applied. Since all the rays are parallel to each other for <strong class="source-inline">THREE.DirectionalLight</strong>, we don’t have a cone where shadows need to be applied; instead, we <a id="_idIndexMarker231"/>have a cuboid area (represented internally with a <strong class="source-inline">THREE.OrthographicCamera</strong>), as you can see in the following screenshot, where we enabled the <span class="No-Break">shadow helper:</span></p>
			<div>
				<div id="_idContainer061" class="IMG---Figure">
					<img src="image/Figure_3.18_B18726.jpg" alt="Figure 3.18 – Directional light showing a cuboid shadow area"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.18 – Directional light showing a cuboid shadow area</p>
			<p>Everything that falls within this<a id="_idIndexMarker232"/> cube can cast and receive shadows from the light. Just as for <strong class="source-inline">THREE.SpotLight</strong>, the tighter you define this area around the objects, the<a id="_idIndexMarker233"/> better your shadows will look. Define this cube using the <span class="No-Break">following properties:</span></p>
			<pre class="source-code">
directionalLight.castShadow = true;
directionalLight.shadow.camera.near = 2;
directionalLight.shadow.camera.far = 80;
directionalLight.shadow.camera.left = -30;
directionalLight.shadow.camera.right = 30;
directionalLight.shadow.camera.top = 30;
directionalLight.shadow.camera.bottom = -30;</pre>
			<p>You can <a id="_idIndexMarker234"/>compare this with the<a id="_idIndexMarker235"/> way we configured the orthographic camera in the <em class="italic">Using different cameras for different scenes</em> section in <a href="B18726_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic">Chapter 2</em></span></a><span class="No-Break">.</span></p>
			<p>As we’ve already seen in this section, light sources use colors. For now, we’ve just configured the colors using a hex string, but the <strong class="source-inline">THREE.Color</strong> object provides a lot of different options for creating the initial color object. In this next section, we’ll explore the functionality provided by the <span class="No-Break"><strong class="source-inline">THREE.Color</strong></span><span class="No-Break"> object.</span></p>
			<h2 id="_idParaDest-49"><a id="_idTextAnchor048"/>Using the THREE.Color object</h2>
			<p>In Three.js, when you need to <a id="_idIndexMarker236"/>provide a color (for example, for materials, lights, and so on), you can pass in a <strong class="source-inline">THREE.Color</strong> object; otherwise, Three.js will create one<a id="_idIndexMarker237"/> from a passed-in string value, as we saw for <strong class="source-inline">THREE.AmbientLight</strong>. Three.js is very flexible when parsing the input for the <strong class="source-inline">THREE.Color</strong> constructor. You can create a <strong class="source-inline">THREE.Color</strong> object in the <span class="No-Break">following ways:</span></p>
			<ul>
				<li><strong class="bold">Hex string</strong>: <strong class="source-inline">new THREE.Color("#ababab")</strong> will create a color based on the passed-in CSS <span class="No-Break">color string.</span></li>
				<li><strong class="bold">Hex value</strong>: <strong class="source-inline">new THREE.Color(0xababab)</strong> will create the color based on the passed-in hex value. If you know the hex value, this is usually the <span class="No-Break">best approach.</span></li>
				<li><strong class="bold">RGB string</strong>: <strong class="source-inline">new THREE.Color("rgb(255, 0, 0)")</strong> or <strong class="source-inline">new THREE.Color("rgb(100%, </strong><span class="No-Break"><strong class="source-inline">0%, 0%)"</strong></span><span class="No-Break">.</span></li>
				<li><strong class="bold">Color name</strong>: You can use named colors as well – for example, <strong class="source-inline">new THREE.Color( '</strong><span class="No-Break"><strong class="source-inline">skyblue' )</strong></span><span class="No-Break">.</span></li>
				<li><strong class="bold">HSL string</strong>: If you like working in the HSL domain instead of the RGB domain, you can pass in the HSL values with <strong class="source-inline">new THREE.Color("hsl(0, </strong><span class="No-Break"><strong class="source-inline">100%, 50%)")</strong></span><span class="No-Break">.</span></li>
				<li><strong class="bold">Separate RGB values</strong>: You can specify the individual RGB components on a scale from 0 to 1: <strong class="source-inline">new THREE.Color( 1, 0, </strong><span class="No-Break"><strong class="source-inline">0 )</strong></span><span class="No-Break">.</span></li>
			</ul>
			<p>If you want to change the <a id="_idIndexMarker238"/>color after construction, you’ll have to create a new <strong class="source-inline">THREE.Color</strong> object or modify the internal properties of the <strong class="source-inline">THREE.Color</strong> object. The <strong class="source-inline">THREE.Color</strong> object comes with a large set of properties and functions. The first<a id="_idIndexMarker239"/> group of functions allows you to set the color of a <span class="No-Break"><strong class="source-inline">THREE.Color</strong></span><span class="No-Break"> object:</span></p>
			<ul>
				<li><strong class="source-inline">set(value)</strong>: Sets the value of a color to the supplied hex value. This hex value may be a string, a number, or an existing <span class="No-Break"><strong class="source-inline">THREE.Color</strong></span><span class="No-Break"> instance.</span></li>
				<li><strong class="source-inline">setHex(value)</strong>: Sets the value of a color to the supplied numeric <span class="No-Break">hex value.</span></li>
				<li><strong class="source-inline">setRGB(r,g,b)</strong>: Sets the value of a color based on the supplied RGB values. The values range from <strong class="source-inline">0</strong> <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">setHSL(h,s,l)</strong>: Sets the value of this color on the supplied HSL values. The values range from 0 to 1. A good explanation of how HSL works for configuring colors can be found <span class="No-Break">at </span><a href="http://en.wikibooks.org/wiki/Color_Models:_RGB,_HSV,_HSL"><span class="No-Break">http://en.wikibooks.org/wiki/Color_Models:_RGB,_HSV,_HSL</span></a><span class="No-Break">.</span></li>
				<li><strong class="source-inline">setStyle(style)</strong>: Sets the value of a color based on the CSS way of specifying colors. For instance, you could use <strong class="source-inline">rgb(255,0,0)</strong>, <strong class="source-inline">#ff0000</strong>, <strong class="source-inline">#f00</strong>, or <span class="No-Break">even </span><span class="No-Break"><strong class="source-inline">red</strong></span><span class="No-Break">.</span></li>
			</ul>
			<p>If you’ve already <a id="_idIndexMarker240"/>got an existing <strong class="source-inline">THREE.Color</strong> instance and want to use that <a id="_idIndexMarker241"/>color, you can use the <span class="No-Break">following functions:</span></p>
			<ul>
				<li><strong class="source-inline">copy(color)</strong>: Copies the color values from the <strong class="source-inline">THREE.Color</strong> instance provided to <span class="No-Break">this color.</span></li>
				<li><strong class="source-inline">copySRGBToLinear(color)</strong>: Sets the color of this object based on the <strong class="source-inline">THREE.Color</strong> instance supplied. The color is first converted from the sRGB color space into the linear color space. The sRGB color space uses an exponential scale instead of a linear one. More information on the sRGB color space can be found <span class="No-Break">here: </span><a href="https://www.w3.org/Graphics/Color/sRGB.html"><span class="No-Break">https://www.w3.org/Graphics/Color/sRGB.html</span></a><span class="No-Break">.</span></li>
				<li><strong class="source-inline">copyLinearToSRGB(color)</strong>: Sets the color of this object based on the <strong class="source-inline">THREE.Color</strong> instance supplied. The color is first converted from the linear color space into the sRGB <span class="No-Break">color space.</span></li>
				<li><strong class="source-inline">convertSGRBToLinear()</strong>: Converts the current color from the sRGB color space into the linear <span class="No-Break">color space.</span></li>
				<li><strong class="source-inline">convertLinearToSGRB()</strong>: Converts the current color from the linear color space into the sRGB <span class="No-Break">color space.</span></li>
			</ul>
			<p>If you want information on the currently configured color, the <strong class="source-inline">THREE.Color</strong> object also provides some helper functions <span class="No-Break">for that:</span></p>
			<ul>
				<li><strong class="source-inline">getHex()</strong>: Returns the value from this color object as a <span class="No-Break">number: </span><span class="No-Break"><strong class="source-inline">435241</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">getHexString()</strong>: Returns the value from this color object as a hex <span class="No-Break">string: </span><span class="No-Break"><strong class="source-inline">0c0c0c</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">getStyle()</strong>: Returns the value from this color object as a CSS-based <span class="No-Break">value: </span><span class="No-Break"><strong class="source-inline">rgb(112,0,0)</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">getHSL(target)</strong>: Returns the value from this color object as an HSL value (<strong class="source-inline">{ h: 0, s: 0, l: 0 }</strong>). If you provide the optional <strong class="source-inline">target</strong> object, Three.js will set the <strong class="source-inline">h</strong>, <strong class="source-inline">s</strong>, and <strong class="source-inline">l</strong> properties on <span class="No-Break">that object.</span></li>
			</ul>
			<p>Three.js also<a id="_idIndexMarker242"/> provides functions to change the current color by modifying the <a id="_idIndexMarker243"/>individual color components. This is <span class="No-Break">shown here:</span></p>
			<ul>
				<li><strong class="source-inline">offsetHSL(h, s, l)</strong>: Adds the <strong class="source-inline">h</strong>, <strong class="source-inline">s</strong>, and <strong class="source-inline">l</strong> values provided to the <strong class="source-inline">h</strong>, <strong class="source-inline">s</strong>, and <strong class="source-inline">l</strong> values of the <span class="No-Break">current color.</span></li>
				<li><strong class="source-inline">add(color)</strong>: Adds the <strong class="source-inline">r</strong>, <strong class="source-inline">g</strong>, and <strong class="source-inline">b</strong> values of the color supplied to the <span class="No-Break">current color.</span></li>
				<li><strong class="source-inline">addColors(color1, color2)</strong>: Adds <strong class="source-inline">color1</strong> and <strong class="source-inline">color2</strong> and sets the value of the current color to <span class="No-Break">the result.</span></li>
				<li><strong class="source-inline">addScalar(s)</strong>: Adds a value to the RGB components of the current color. Bear in mind that the internal values use a range from <strong class="source-inline">0</strong> <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">multiply(color)</strong>: Multiplies the current RGB values with the RGB values <span class="No-Break">from </span><span class="No-Break"><strong class="source-inline">THREE.Color</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">multiplyScalar(s)</strong>: Multiplies the current RGB values with the value supplied. Remember that the internal values range between <strong class="source-inline">0</strong> <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">1</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">lerp(color, alpha)</strong>: Finds the color that is between the color of this object and the <strong class="source-inline">color</strong> property supplied. The <strong class="source-inline">alpha</strong> property defines how far between the current color and the supplied color you want the result <span class="No-Break">to be.</span></li>
			</ul>
			<p>Finally, there are a couple of basic helper <span class="No-Break">methods available:</span></p>
			<ul>
				<li><strong class="source-inline">equals(color)</strong>: Returns <strong class="source-inline">true</strong> if the RGB values of the <strong class="source-inline">THREE.Color</strong> instance supplied match the values of the <span class="No-Break">current color</span></li>
				<li><strong class="source-inline">fromArray(array)</strong>: Has the same functionality as <strong class="source-inline">setRGB</strong>, but now, the RGB values can be provided as an array <span class="No-Break">of numbers</span></li>
				<li><strong class="source-inline">toArray</strong>: Returns an array with three elements: <strong class="source-inline">[r, </strong><span class="No-Break"><strong class="source-inline">g, b]</strong></span></li>
				<li><strong class="source-inline">clone</strong>: Creates an exact copy of <span class="No-Break">a color</span></li>
			</ul>
			<p>In the preceding lists, you can see that there are many ways in which you can change the current color. A lot of these functions are used internally by Three.js, but they also provide a good way to<a id="_idIndexMarker244"/> easily change the color of lights and materials, without <a id="_idIndexMarker245"/>having to create and assign new <span class="No-Break"><strong class="source-inline">THREE.Color</strong></span><span class="No-Break"> objects.</span></p>
			<p>So far, we’ve looked at the basic lights provided by Three.js and how shadows work. In most cases, you’ll use a combination of these lights for your scene. Three.js also provides a couple of special lights for very specific use cases. We’ll look at those in the <span class="No-Break">next section.</span></p>
			<h1 id="_idParaDest-50"><a id="_idTextAnchor049"/>Working with special lights</h1>
			<p>In this section on special<a id="_idIndexMarker246"/> lights, we’ll discuss three additional lights provided by Three.js. First, we’ll discuss <strong class="source-inline">THREE.HemisphereLight</strong>, which helps in creating more natural lighting for outdoor scenes. Then, we’ll look at <strong class="source-inline">THREE.RectAreaLight</strong>, which emits lights from a large area instead of a single point. Next, we’ll look at how we can use a <strong class="source-inline">LightProbe</strong> to apply light based on a cubemap, and finally, we’ll show you how you can add a lens flare effect to <span class="No-Break">your scene.</span></p>
			<p>The first special light we’re going to look at <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">THREE.HemisphereLight</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-51"><a id="_idTextAnchor050"/>THREE.HemisphereLight</h2>
			<p>With <strong class="source-inline">THREE.HemisphereLight</strong>, we<a id="_idIndexMarker247"/> can create more natural-looking<a id="_idIndexMarker248"/> outdoor lighting. Without this light, we could simulate the outdoors by creating <strong class="source-inline">THREE.DirectionalLight</strong>, which emulates the sun, and maybe add another <strong class="source-inline">THREE.AmbientLight</strong> to provide some general color to the scene. However, doing so won’t look natural. When you’re outdoors, not all the light comes directly from above: much is diffused by the atmosphere and reflected by the ground and other objects. <strong class="source-inline">THREE.HemisphereLight</strong> in Three.js was created for this scenario. This is an easy way to get more natural-looking outdoor lighting. To see an example, look at <strong class="source-inline">hemisphere-light.html</strong> in the <span class="No-Break">following figure:</span></p>
			<div>
				<div id="_idContainer062" class="IMG---Figure">
					<img src="image/Figure_3.19_B18726.jpg" alt="Figure 3.19 – Hemisphere light"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.19 – Hemisphere light</p>
			<p>If you look closely at this screenshot, you will see that the ground color of the hemisphere is shown more at the bottom of the sphere, and the sky color (set through the <strong class="source-inline">color</strong> property) is visible at the top of the scene. In this example, you can set these colors and their intensity. Creating <a id="_idIndexMarker249"/>a hemisphere light is just as <a id="_idIndexMarker250"/>easy as creating any of the <span class="No-Break">other lights:</span></p>
			<pre class="source-code">
const hemiLight = new THREE.HemisphereLight(0x0000ff,
  0x00ff00, 0.6); hemiLight.position.set(0, 500, 0);
scene.add(hemiLight);</pre>
			<p>You just specify the color that is received from the sky, the color received from the ground, and the intensity of these lights. If you want to change these values later on, you can access them through the <span class="No-Break">following properties:</span></p>
			<table id="table004" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Property</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">groundColor</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the color that is emitted from <span class="No-Break">the ground</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">color</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Implies the color that is emitted from <span class="No-Break">the sky</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">intensity</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Implies the intensity with which the <span class="No-Break">light shines</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.20 – Properties of the THREE.HemisphereLight object</p>
			<p>Since a <strong class="source-inline">HemisphereLight</strong> acts like a <strong class="source-inline">THREE.AmbientLight</strong> object and just adds color to all the<a id="_idIndexMarker251"/> objects in the scene, it isn’t capable of casting shadows. The<a id="_idIndexMarker252"/> lights we’ve seen so far are more traditional. The next property allows you to simulate light from rectangular light sources – for instance, a window or a <span class="No-Break">computer screen.</span></p>
			<h2 id="_idParaDest-52"><a id="_idTextAnchor051"/>THREE.RectAreaLight</h2>
			<p>With <strong class="source-inline">THREE.RectAreaLight</strong>, we can<a id="_idIndexMarker253"/> define a rectangular area that emits <a id="_idIndexMarker254"/>light. Before we look at the details, let’s first look at the result we’re aiming for (<strong class="source-inline">rectarea-light.html</strong> opens this example); the following screenshot shows a couple of <span class="No-Break"><strong class="source-inline">THREE.RectAreaLight</strong></span><span class="No-Break"> objects:</span></p>
			<div>
				<div id="_idContainer063" class="IMG---Figure">
					<img src="image/Figure_3.21_B18726.jpg" alt="Figure 3.21 – RectArea lights emitting across their complete surface"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.21 – RectArea lights emitting across their complete surface</p>
			<p>What you see in <a id="_idIndexMarker255"/>this screenshot is that we’ve defined three <strong class="source-inline">THREE.RectAreaLight</strong> objects, each with its own color. You can see how these lights affect the <a id="_idIndexMarker256"/>whole area, and when you move them around or change their position, you can see how the different objects in the scene <span class="No-Break">are affected.</span></p>
			<p>We haven’t explored the different materials and how light affects them. We’ll do this in the next chapter, <a href="B18726_04.xhtml#_idTextAnchor056"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, <em class="italic">Working with Three.js Materials</em>. A <strong class="source-inline">THREE.RectAreaLight</strong> only works with <strong class="source-inline">THREE.MeshStandardMaterial</strong> or <strong class="source-inline">THREE.MeshPhysicalMaterial</strong>. More on these materials will be presented in <a href="B18726_04.xhtml#_idTextAnchor056"><span class="No-Break"><em class="italic">Chapter 4</em></span></a><span class="No-Break">.</span></p>
			<p>To work with a <strong class="source-inline">THREE.RectAreaLight</strong>, we need to take a couple of small additional steps. First, we need to load and initialize <strong class="source-inline">RectAreaLightUniformsLib</strong>; the following is a set of additional low-level WebGL scripts needed by <span class="No-Break">this light:</span></p>
			<pre class="source-code">
import { RectAreaLightUniformsLib } from "three/examples
  /jsm/lights/RectAreaLightUniformsLib.js";
...
RectAreaLightUniformsLib.init();</pre>
			<p>Next, we can create the <strong class="source-inline">THREE.AreaLight</strong> object just like any <span class="No-Break">other light:</span></p>
			<pre class="source-code">
const rectLight1 = new THREE.RectAreaLight
  (0xff0000, 5, 2, 5);
rectLight1.position.set(-3, 0, 5);
scene.add(rectLight1);</pre>
			<p>If you look at the constructor of this object, you will see that it takes four properties. The first one is the color of the light, the second one is the intensity, and the last two define how large the area of this light is. Note that if you want to visualize these lights, as we did in the example, you have to create a rectangle yourself at the same position, rotation, and size as <span class="No-Break">your </span><span class="No-Break"><strong class="source-inline">THREE.RectAreaLight</strong></span><span class="No-Break">.</span></p>
			<p>This light can be used to create some nice effects, but it’ll probably take some experimenting to get the effect you want. Once again, in this example, you’ve got a menu on the right-hand side that you can use to play around with the <span class="No-Break">various settings.</span></p>
			<p>In recent <a id="_idIndexMarker257"/>versions of Three.js, a new light was added called <strong class="source-inline">THREE.LightProbe</strong>. This light is similar to <strong class="source-inline">THREE.AmbientLight</strong> but takes the <a id="_idIndexMarker258"/>cubemap of <strong class="source-inline">WebGLRenderer</strong> into account. This is the last light source that we’ll discuss in <span class="No-Break">this chapter.</span></p>
			<h2 id="_idParaDest-53"><a id="_idTextAnchor052"/>THREE.LightProbe</h2>
			<p>In the previous chapter, we<a id="_idIndexMarker259"/> talked a little bit about what a cubemap is. With a<a id="_idIndexMarker260"/> cubemap, you can show your models inside an environment. In the previous chapter, we used a cubemap to create a background that rotates with the view of <span class="No-Break">the camera:</span></p>
			<div>
				<div id="_idContainer064" class="IMG---Figure">
					<img src="image/Figure_3.22_B18726.jpg" alt="Figure 3.22 – Cubemap example from Chapter 2"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.22 – Cubemap example from <a href="B18726_02.xhtml#_idTextAnchor028">Chapter 2</a></p>
			<p>As we’ll see in the next chapter, we can use the information from a cubemap to show reflections on our materials. Normally, though, these environment maps don’t contribute any light to your scene. With a <strong class="source-inline">THREE.LightProbe</strong>, however, we can extract lighting level <a id="_idIndexMarker261"/>information from the cubemap and use it to illuminate<a id="_idIndexMarker262"/> our models. So, what you’ll get looks a bit like a <strong class="source-inline">THREE.AmbientLight</strong>, but it affects the objects based on their location in the scene and the information from <span class="No-Break">the cubemap.</span></p>
			<p>The easiest way to explain this is by looking at an example. Open up <strong class="source-inline">light-probe.html</strong> in your browser; you’ll see the <span class="No-Break">following scene:</span></p>
			<div>
				<div id="_idContainer065" class="IMG---Figure">
					<img src="image/Figure_3.23_B18726.jpg" alt="Figure 3.23 – LightProbe with a model in a cave"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.23 – LightProbe with a model in a cave</p>
			<p>In the preceding example, we’ve<a id="_idIndexMarker263"/> got a model inside a cave-like environment. What you<a id="_idIndexMarker264"/> can see, if you rotate the camera around, is that based on the light of the environment, our model is slightly differently lit. In the previous screenshot, we’re looking at the back of the object, which is further down in the cave, so the model is darker on that side. If we completely rotate the camera and set the entrance of the cave to our back, we’ll see that the model is much brighter and receives <span class="No-Break">more light:</span></p>
			<div>
				<div id="_idContainer066" class="IMG---Figure">
					<img src="image/Figure_3.24_B18726.jpg" alt="Figure 3.24 – LightProbe with a model in a cave receiving more light"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.24 – LightProbe with a model in a cave receiving more light</p>
			<p>This is a really neat trick<a id="_idIndexMarker265"/> to make your objects look more life-like and less flat, and <a id="_idIndexMarker266"/>with a <strong class="source-inline">THREE.LightProbe</strong>, your model will receive light non-uniformly, which looks <span class="No-Break">much better.</span></p>
			<p>Setting up a <strong class="source-inline">THREE.LightProbe</strong> is a bit more work but only needs to be done once when you create your scene. So long as you don’t change the environment, you don’t need to recalculate the values of the <span class="No-Break"><strong class="source-inline">THREE.LightProbe</strong></span><span class="No-Break"> object:</span></p>
			<pre class="source-code">
Import { LightProbeGenerator } from "three/examples/
  jsm/lights//LightProbeGenerator";
...
const loadCubeMap = (renderer, scene) =&gt; {
  const base = "drachenfels";
  const ext = "png";
  const urls = [
    "/assets/panorama/" + base + "/posx." + ext,
    "/assets/panorama/" + base + "/negx." + ext,
    "/assets/panorama/" + base + "/posy." + ext,
    "/assets/panorama/" + base + "/negy." + ext,
    "/assets/panorama/" + base + "/posz." + ext,
    "/assets/panorama/" + base + "/negz." + ext,
  ];
  new THREE.CubeTextureLoader().load(urls, function
    (cubeTexture) {
    cubeTexture.encoding = THREE.sRGBEncoding;
    scene.background = cubeTexture;
    const lp = LightProbeGenerator.fromCubeTexture
      (cubeTexture);
    lp.intensity = 15;
    scene.add(lp);
  });
};</pre>
			<p>In the preceding <a id="_idIndexMarker267"/>code fragment, we do two main things. First, we use <strong class="source-inline">THREE.CubeTextureLoader</strong> to load in a cubemap. As we’ll see in the next chapter, a<a id="_idIndexMarker268"/> cubemap consists of six images representing the six sides of a cube, which together will make up our environment. Once that has been loaded, we set this to the background of our scene (note that this isn’t needed for <strong class="source-inline">THREE.LightProbe</strong> <span class="No-Break">to work).</span></p>
			<p>Now that we’ve got this cubemap, we can generate a <strong class="source-inline">THREE.LightProbe</strong> from it. This is done by passing in <strong class="source-inline">cubeTexture</strong> to a <strong class="source-inline">LightProbeGenerator</strong>. The result is a <strong class="source-inline">THREE.LightProbe</strong>, which we add to our scene, just like any other light. Just like with a <strong class="source-inline">THREE.AmbientLight</strong>, you can control how much this light contributes to the lighting of your meshes by setting the <span class="No-Break"><strong class="source-inline">intensity</strong></span><span class="No-Break"> property.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">There is also another kind of <strong class="source-inline">LightProbe</strong> provided by Three.js: <strong class="source-inline">THREE.HemisphereLightProbe</strong>. This one works pretty much the same as a normal <strong class="source-inline">THREE.HemisphereLight</strong>, but uses a <span class="No-Break"><strong class="source-inline">LightProbe</strong></span><span class="No-Break"> internally.</span></p>
			<p>The final object in<a id="_idIndexMarker269"/> this chapter isn’t a light source but plays a trick on the camera<a id="_idIndexMarker270"/> often seen in <span class="No-Break">movies: </span><span class="No-Break"><strong class="source-inline">THREE.LensFlare</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-54"><a id="_idTextAnchor053"/>THREE.LensFlare</h2>
			<p>You are probably already <a id="_idIndexMarker271"/>familiar with lens flares. For instance, they appear when you take a <a id="_idIndexMarker272"/>direct photograph of the Sun or another bright light source. In most cases, you want to avoid this, but for games and 3D-generated images, it provides a nice effect that makes scenes look a bit more realistic. Three.js also has support for lens flares and makes it very easy to add them to your scene. In this last section, we’re going to add a lens flare to a scene and create the output shown in the following screenshot; you can see this for yourself by <span class="No-Break">opening </span><span class="No-Break"><strong class="source-inline">lens-flare.html</strong></span><span class="No-Break">:</span></p>
			<div>
				<div id="_idContainer067" class="IMG---Figure">
					<img src="image/Figure_3.25_B18726.jpg" alt="Figure 3.25 – A lens flare appears when you look into the light"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.25 – A lens flare appears when you look into the light</p>
			<p>We can create a lens <a id="_idIndexMarker273"/>flare by instantiating the <strong class="source-inline">LensFlare</strong> object and by<a id="_idIndexMarker274"/> adding <span class="No-Break"><strong class="source-inline">LensFlareElement</strong></span><span class="No-Break"> objects:</span></p>
			<pre class="source-code">
import {
  Lensflare,
  LensflareElement,
} from "three/examples/jsm/objects/Lensflare";
const textureLoader = new THREE.TextureLoader()
const textureFlare0 = textureLoader.load
  ('/assets/textures/lens-flares/lensflare0.png')
const textureFlare1 = textureLoader.load
  ('/assets/textures/lens-flares/lensflare3.png')
const lensFlare = new LensFlare();
lensFlare.addElement(new LensflareElement
  (textureFlare0, 512, 0));
lensFlare.addElement(new LensflareElement
  (textureFlare1, 60, 0.6));
lensFlare.addElement(new LensflareElement
  (textureFlare1, 70, 0.7));
lensFlare.addElement(new LensflareElement
  (textureFlare1, 120, 0.9));
lensFlare.addElement(new LensflareElement
  (textureFlare1, 70, 1.0));
pointLight.add(lensFlare);</pre>
			<p>The <strong class="source-inline">LensFlare</strong> element is<a id="_idIndexMarker275"/> just a container for our <strong class="source-inline">LensFlareElement</strong> objects, and <strong class="source-inline">LensFlareElement</strong> is the artifact you see when you look at the light source. Then, we add <strong class="source-inline">LensFlare</strong> to the light source, and we’re done. If you look at the <a id="_idIndexMarker276"/>code, you will see that we pass in several properties for each <strong class="source-inline">LensFlareElement</strong>. These properties determine what <strong class="source-inline">LensFlareElement</strong> looks like and where it is rendered on screen. To use this element, we can apply the following <span class="No-Break">constructor arguments:</span></p>
			<table id="table005" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Property</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">texture</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>A texture is an image that determines the shape of <span class="No-Break">the flare.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">size</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>We can specify how large the flare should be. <strong class="source-inline">size</strong> denotes the size in pixels. If you specify <strong class="source-inline">-1</strong>, the size of the texture itself <span class="No-Break">is used.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">distance</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Indicates the distance from the light source (<strong class="source-inline">0</strong>) to the camera (<strong class="source-inline">1</strong>). Use this to position the lens flare in the <span class="No-Break">right position.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="source-inline">color</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p>Denotes the color of <span class="No-Break">the flare.</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.26 – Properties of the THREE.LensFlareElement object</p>
			<p>First, let’s look a <a id="_idIndexMarker277"/>bit closer at <a id="_idIndexMarker278"/>the <span class="No-Break">first </span><span class="No-Break"><strong class="source-inline">LensFlareElement</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
const textureLoader = new THREE.TextureLoader();
const textureFlare0 = textureLoader.load(
  "/assets/textures/lens-flares/lensflare0.png"
);
lensFlare.addElement(new LensflareElement
  (textureFlare0, 512, 0));</pre>
			<p>The first argument, <strong class="source-inline">texture</strong>, is an image that shows the shape and some basic coloring of the flare. We load this with a <strong class="source-inline">THREE.TextureLoader</strong>, where we simply add the location <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">texture</strong></span><span class="No-Break">:</span></p>
			<div>
				<div id="_idContainer068" class="IMG---Figure">
					<img src="image/Figure_3.27_B18726.jpg" alt="Figure 3.27 – Lens flare used in the example"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.27 – Lens flare used in the example</p>
			<p>The second argument is <a id="_idIndexMarker279"/>the size of this flare. Since this is the flare we see at the<a id="_idIndexMarker280"/> light source itself, we’re going to make it quite big: <strong class="source-inline">512</strong> pixels in this case. Next, we need to set the <strong class="source-inline">distance</strong> property of this flare. What you set here is the relative distance between the source of the light and the center of the camera. If we set a distance of <strong class="source-inline">0</strong>, the texture will be shown at the position of the light, and if we set it to <strong class="source-inline">1</strong>, it will be shown at the position of the camera. In this case, we put it directly at the <span class="No-Break">light source.</span></p>
			<p>Now, if you look back at the <a id="_idIndexMarker281"/>position of the other <strong class="source-inline">LightFlareElement</strong> objects, you will see that we positioned them at intervals from <strong class="source-inline">0</strong> to <strong class="source-inline">1</strong>, which results in the effect <a id="_idIndexMarker282"/>you see when you open up the <span class="No-Break"><strong class="source-inline">lens-flare.html</strong></span><span class="No-Break"> example:</span></p>
			<pre class="source-code">
const textureFlare1 = textureLoader.load(
  "/assets/textures/lens-flares/lensflare3.png"
);
lensFlare.addElement(new LensflareElement
  (textureFlare1, 60, 0.6));
lensFlare.addElement(new LensflareElement
  (textureFlare1, 70, 0.7));
lensFlare.addElement(new LensflareElement
  (textureFlare1, 120, 0.9));
lensFlare.addElement(new LensflareElement
  (textureFlare1, 70, 1.0));</pre>
			<p>With that, we’ve discussed the various lighting options provided <span class="No-Break">by Three.js.</span></p>
			<h1 id="_idParaDest-55"><a id="_idTextAnchor054"/>Summary</h1>
			<p>In this chapter, we covered a lot of information about the different kinds of lights that are available in Three.js. You learned that configuring lights, colors, and shadows is not an exact science. To get the correct result, you should experiment with the different settings and use a <strong class="source-inline">lil.GUI</strong> control to fine-tune your configuration. The different lights behave in different ways and, as we’ll see in <a href="B18726_04.xhtml#_idTextAnchor056"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, materials respond differently to lights <span class="No-Break">as well.</span></p>
			<p>A <strong class="source-inline">THREE.AmbientLight</strong> color is added to every color in the scene and is often used to smooth hard colors and shadows. <strong class="source-inline">THREE.PointLight</strong> emits light in all directions and can cast shadows. <strong class="source-inline">THREE.SpotLight</strong> is a light that resembles a flashlight. It has a conical shape, can be configured to fade over distance, and can cast shadows. We also looked at <strong class="source-inline">THREE.DirectionalLight</strong>. This light can be compared to a faraway light, such as the Sun, whose light rays travel parallel to each other, the intensity of which doesn’t decrease the farther away it gets from the configured target, and which can also <span class="No-Break">cast shadows.</span></p>
			<p>Besides the standard lights, we also looked at a couple of more specialized lights. For a more natural outdoor effect, you can use <strong class="source-inline">THREE.HemisphereLight</strong>, which takes into account ground and sky reflections. <strong class="source-inline">THREE.RectAreaLight</strong> doesn’t shine from a single point but emits light from a large area. We also showed a more advanced sort of ambient lighting by using a <strong class="source-inline">THREE.LightProbe</strong>, which used information from an environment map to determine how an object is lit. Finally, we showed you how to add a photographic lens flare with the <span class="No-Break"><strong class="source-inline">THREE.LenseFlare</strong></span><span class="No-Break"> object.</span></p>
			<p>In the chapters so far, we have already introduced a couple of different materials, and in this chapter, you saw that not all materials respond in the same manner to the available lights. In <a href="B18726_04.xhtml#_idTextAnchor056"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, we’ll provide an overview of the materials that are available <span class="No-Break">in Three.js.</span></p>
		</div>
	

		<div id="_idContainer070" class="Content">
			<h1 id="_idParaDest-56"><a id="_idTextAnchor055"/>Part 2: Working with the Three.js Core Components</h1>
			<p>In this second part, we’ll dive into the different materials provided by Three.js and the different geometries you can use to create your own scenes. Besides the geometries, we’ll also look at how Three.js supports points and sprites, which you can use, for instance, for rain and <span class="No-Break">smoke effects.</span></p>
			<p>In this part, there are the <span class="No-Break">following chapters:</span></p>
			<ul>
				<li><a href="B18726_04.xhtml#_idTextAnchor056"><em class="italic">Chapter 4</em></a>, <em class="italic">Working with Three.js Materials</em></li>
				<li><a href="B18726_05.xhtml#_idTextAnchor081"><em class="italic">Chapter 5</em></a>, <em class="italic">Learning to Work with Geometries</em></li>
				<li><a href="B18726_06.xhtml#_idTextAnchor101"><em class="italic">Chapter 6</em></a>, <em class="italic">Exploring Advanced Geometries</em></li>
				<li><a href="B18726_07.xhtml#_idTextAnchor122"><em class="italic">Chapter 7</em></a>, <em class="italic">Points and Sprites</em></li>
			</ul>
		</div>
		<div>
			<div id="_idContainer071">
			</div>
		</div>
	</body></html>