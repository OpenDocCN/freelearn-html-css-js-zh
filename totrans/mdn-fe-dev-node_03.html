<html><head></head><body>
<div id="_idContainer036">
<h1 class="chapter-number" id="_idParaDest-34" lang="en-GB"><a id="_idTextAnchor033"/><span class="koboSpan" id="kobo.1.1">3</span></h1>
<h1 id="_idParaDest-35" lang="en-GB"><a id="_idTextAnchor034"/><span class="koboSpan" id="kobo.2.1">Choosing a Package Manager</span></h1>
<p lang="en-GB"><span class="koboSpan" id="kobo.3.1">So far, we have learned a bit about Node.js and its internal modules. </span><span class="koboSpan" id="kobo.3.2">We also started to write our own modules, but we have either avoided or worked around using </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.4.1">third-party packages.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.5.1">One of the big advantages of Node.js is that using other people’s code is actually quite easy. </span><span class="koboSpan" id="kobo.5.2">The path to doing so leads us directly to package managers. </span><span class="koboSpan" id="kobo.5.3">A package manager helps us to handle the life cycle of packages containing modules that can be used </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.6.1">in Node.js.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.7.1">In this chapter, we’ll learn how Node.js’s de facto standard package</span><a id="_idIndexMarker087"/><span class="koboSpan" id="kobo.8.1"> manager </span><strong class="bold" lang=""><span class="koboSpan" id="kobo.9.1">npm</span></strong><span class="koboSpan" id="kobo.10.1"> works. </span><span class="koboSpan" id="kobo.10.2">We will then go on to learn about other </span><a id="_idIndexMarker088"/><span class="koboSpan" id="kobo.11.1">package managers, such as </span><strong class="bold" lang=""><span class="koboSpan" id="kobo.12.1">Yarn</span></strong><span class="koboSpan" id="kobo.13.1"> and </span><strong class="bold" lang=""><span class="koboSpan" id="kobo.14.1">pnpm</span></strong><span class="koboSpan" id="kobo.15.1">. </span><span class="koboSpan" id="kobo.15.2">They </span><a id="_idIndexMarker089"/><span class="koboSpan" id="kobo.16.1">all promise some advantages in terms of usability, performance, or reliability. </span><span class="koboSpan" id="kobo.16.2">We will take a deeper look at them to understand these advantages and who might benefit from using each of the different package managers. </span><span class="koboSpan" id="kobo.16.3">Finally, we’ll also look </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.17.1">at alternatives.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.18.1">This chapter will help you to use third-party libraries in your code. </span><span class="koboSpan" id="kobo.18.2">Third-party dependencies will make you more productive and focused, and a package manager will be useful for installing and updating third-party dependencies. </span><span class="koboSpan" id="kobo.18.3">By the end of the chapter, you’ll know the most important package managers and which one you want to pick in the context of </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.19.1">your project.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.20.1">We will cover the following key topics in </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.21.1">this chapter:</span></span></p>
<ul>
<li lang="en-GB"><span class="No-Break" lang=""><span class="koboSpan" id="kobo.22.1">Using npm</span></span></li>
<li lang="en-GB"><span class="No-Break" lang=""><span class="koboSpan" id="kobo.23.1">Using Yarn</span></span></li>
<li lang="en-GB"><span class="No-Break" lang=""><span class="koboSpan" id="kobo.24.1">Using pnpm</span></span></li>
<li lang="en-GB"><span class="No-Break" lang=""><span class="koboSpan" id="kobo.25.1">More alternatives</span></span></li>
</ul>
<h1 id="_idParaDest-36" lang="en-GB"><a id="_idTextAnchor035"/><span class="koboSpan" id="kobo.26.1">Technical Requirements</span></h1>
<p lang="en-GB"><span class="koboSpan" id="kobo.27.1">Some code examples for this chapter are available at  </span><a href="https://github.com/PacktPublishing/Modern-Frontend-Development-with-Node.js/tree/main/Chapter03"><span class="No-Break" lang=""><span class="koboSpan" id="kobo.28.1">https://github.com/PacktPublishing/Modern-Frontend-Development-with-Node.js/tree/main/Chapter03</span></span></a><span class="No-Break" lang=""><span class="koboSpan" id="kobo.29.1">.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.30.1">The CiA videos for this chapter can be accessed </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.31.1">at </span></span><a href="http://bit.ly/3TmZr22"><span class="No-Break" lang=""><span class="koboSpan" id="kobo.32.1">http://bit.ly/3TmZr22</span></span></a><span class="No-Break" lang=""><span class="koboSpan" id="kobo.33.1">.</span></span></p>
<h1 id="_idParaDest-37" lang="en-GB"><a id="_idTextAnchor036"/><span class="koboSpan" id="kobo.34.1">Using npm</span></h1>
<p lang="en-GB"><span class="koboSpan" id="kobo.35.1">When</span><a id="_idIndexMarker090"/><span class="koboSpan" id="kobo.36.1"> you install Node.js from the official sources, you get a bit more than just Node.js. </span><span class="koboSpan" id="kobo.36.2">For convenience, Node.js will also add a few more programs and settings to your system. </span><span class="koboSpan" id="kobo.36.3">One of the most important additions is a tool called npm. </span><span class="koboSpan" id="kobo.36.4">Originally, npm was intended to stand for </span><em class="italic" lang=""><span class="koboSpan" id="kobo.37.1">Node.js Package Manager</span></em><span class="koboSpan" id="kobo.38.1">, but today, it is essentially its own </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.39.1">standalone name.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.40.1">The goal of npm is to allow developers to manage third-party dependencies. </span><span class="koboSpan" id="kobo.40.2">This includes installing and updating packages, as well as handling their versioning and transitive dependencies. </span><span class="koboSpan" id="kobo.40.3">A transitive dependency is established when dependencies that are installed also include dependencies, which therefore need to be </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.41.1">installed, too.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.42.1">For </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.43.1">npm</span></strong><span class="koboSpan" id="kobo.44.1"> to know what dependencies exist and what their dependencies are, the npm registry was created. </span><span class="koboSpan" id="kobo.44.2">It is a web service that hosts all packages on a </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.45.1">file server.</span></span></p>
<p class="callout-heading" lang="en-GB"><span class="koboSpan" id="kobo.46.1">Changing the used npm registry</span></p>
<p class="callout" lang="en-GB"><span class="koboSpan" id="kobo.47.1">Today, many npm registries exist – but</span><a id="_idIndexMarker091"/><span class="koboSpan" id="kobo.48.1"> only the official one located at </span><a href="https://registry.npmjs.org/"><span class="koboSpan" id="kobo.49.1">https://registry.npmjs.org/</span></a><span class="koboSpan" id="kobo.50.1"> is used by default. </span><span class="koboSpan" id="kobo.50.2">To change the registry consistently, a special file, </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.51.1">.npmrc</span></strong><span class="koboSpan" id="kobo.52.1">, needs to be created. </span><span class="koboSpan" id="kobo.52.2">If the file is created in the home directory, then the change applies to all usages. </span><span class="koboSpan" id="kobo.52.3">Otherwise, this file could also be created next to a </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.53.1">package.json</span></strong><span class="koboSpan" id="kobo.54.1"> – only being applied to the designated project. </span><span class="koboSpan" id="kobo.54.2">Finally, to only temporarily use another registry, the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.55.1">--registry</span></strong><span class="koboSpan" id="kobo.56.1"> command-line flag can be used. </span><span class="koboSpan" id="kobo.56.2">The format of the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.57.1">.npmrc</span></strong><span class="koboSpan" id="kobo.58.1"> file is outlined </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.59.1">at </span></span><a href="https://docs.npmjs.com/cli/v8/configuring-npm/npmrc"><span class="No-Break" lang=""><span class="koboSpan" id="kobo.60.1">https://docs.npmjs.com/cli/v8/configuring-npm/npmrc</span></span></a><span class="No-Break" lang=""><span class="koboSpan" id="kobo.61.1">.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.62.1">To use packages from the npm registry, we’ll need to use the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.63.1">npm</span></strong><span class="koboSpan" id="kobo.64.1"> command-line utility. </span><span class="koboSpan" id="kobo.64.2">In fact, the first thing we should do when we copy or clone the source code of a Node.js project is to run </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.65.1">npm install</span></strong><span class="koboSpan" id="kobo.66.1"> in the directory of the </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.67.1">project’s </span></span><span class="No-Break" lang=""><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.68.1">package.json</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.69.1">:</span></span></p>
<pre class="console" lang="en-GB"><span class="koboSpan" id="kobo.70.1">
$ npm install</span></pre>
<p lang="en-GB"><span class="koboSpan" id="kobo.71.1">This will install all packages that are mentioned as runtime and development dependencies in the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.72.1">package.json</span></strong><span class="koboSpan" id="kobo.73.1">. </span><span class="koboSpan" id="kobo.73.2">The packages are downloaded from the configured npm registry and then stored in the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.74.1">node_modules</span></strong><span class="koboSpan" id="kobo.75.1"> directory. </span><span class="koboSpan" id="kobo.75.2">It is good practice to avoid adding the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.76.1">node_modules</span></strong><span class="koboSpan" id="kobo.77.1"> directory to your source control. </span><span class="koboSpan" id="kobo.77.2">For instance, for Git, you should add </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.78.1">node_modules</span></strong><span class="koboSpan" id="kobo.79.1"> to your repository’s </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.80.1">.gitignore</span></strong><span class="koboSpan" id="kobo.81.1"> file. </span><span class="koboSpan" id="kobo.81.2">There are several reasons for this – for example, the installation might be platform-specific or the installation may be </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.82.1">reproducible anyway.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.83.1">The </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.84.1">npm</span></strong><span class="koboSpan" id="kobo.85.1"> command-line utility </span><a id="_idIndexMarker092"/><span class="koboSpan" id="kobo.86.1">comes with a set of integrated commands – such as the previously shown </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.87.1">install</span></strong><span class="koboSpan" id="kobo.88.1"> command. </span><span class="koboSpan" id="kobo.88.2">To see what commands are available to you, the utility can be used with the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.89.1">--</span></strong><span class="No-Break" lang=""><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.90.1">help</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.91.1"> flag:</span></span></p>
<pre class="console" lang="en-GB"><span class="koboSpan" id="kobo.92.1">
$ npm --help

Usage: npm &lt;command&gt;

where &lt;command&gt; is one of:

    access, adduser, audit, bin, bugs, c, cache, ci, cit,

    clean-install, [...], v, version, view, whoami

npm &lt;command&gt; -h  quick help on &lt;command&gt;</span></pre>
<p lang="en-GB"><span class="koboSpan" id="kobo.93.1">The </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.94.1">--help</span></strong><span class="koboSpan" id="kobo.95.1"> flag also works in combination with a specific command. </span><span class="koboSpan" id="kobo.95.2">If you want to know which options exist for the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.96.1">install</span></strong><span class="koboSpan" id="kobo.97.1"> command, you can just type </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.98.1">the following:</span></span></p>
<pre class="console" lang="en-GB"><span class="koboSpan" id="kobo.99.1">
$ npm install --help

npm install (with no args, in package dir)

[...]

npm install &lt;github username&gt;/&lt;github project&gt;

aliases: i, isntall, add

common options: [--save-prod|--save-dev|--save-optional] [--save-exact] [--no-save]</span></pre>
<p lang="en-GB"><span class="koboSpan" id="kobo.100.1">The principle of getting context-specific help is vital to many command-line utilities. </span><span class="koboSpan" id="kobo.100.2">All of the package managers that we’ll look at in this chapter feature this approach. </span><span class="koboSpan" id="kobo.100.3">In the end, for us as users, this has some advantages. </span><span class="koboSpan" id="kobo.100.4">Instead of needing to look up the online documentation, other books, or tutorials to see the syntax for a command every time, we can just get all the required information directly in the command line which is tailored to the specific version that </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.101.1">we use.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.102.1">A </span><a id="_idIndexMarker093"/><span class="koboSpan" id="kobo.103.1">command that is highly useful is </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.104.1">init</span></strong><span class="koboSpan" id="kobo.105.1">. </span><span class="koboSpan" id="kobo.105.2">While </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.106.1">install</span></strong><span class="koboSpan" id="kobo.107.1"> is great to use for existing projects, </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.108.1">init</span></strong><span class="koboSpan" id="kobo.109.1"> can be used to create a new project. </span><span class="koboSpan" id="kobo.109.2">When you run </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.110.1">npm init</span></strong><span class="koboSpan" id="kobo.111.1">, you’ll be guided through all the options in a kind of survey. </span><span class="koboSpan" id="kobo.111.2">The result is shown </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.112.1">as follows:</span></span></p>
<pre class="console" lang="en-GB"><span class="koboSpan" id="kobo.113.1">
$ npm init

package name: (my-project)

version: (1.0.0)

description: This is my new project

git repository:

author: Florian Rappl

license: (ISC) MIT

About to write to /home/node/my-project/package.json:

{

  "name": "my-project",

  "version": "1.0.0",

  "description": "This is my new project",

  "keywords": [],

  "scripts": {

    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"

  },

  "main": "index.js",

  "author": "Florian Rappl",

  "license": "MIT"

}

Is this OK? </span><span class="koboSpan" id="kobo.113.2">(yes) yes</span></pre>
<p lang="en-GB"><span class="koboSpan" id="kobo.114.1">An </span><a id="_idIndexMarker094"/><span class="koboSpan" id="kobo.115.1">alternative would be to specify the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.116.1">-y</span></strong><span class="koboSpan" id="kobo.117.1"> flag. </span><span class="koboSpan" id="kobo.117.2">This way, all the defaults will be taken – a much quicker alternative if you just want to initialize a </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.118.1">new project.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.119.1">The initializer function of npm can even be extended. </span><span class="koboSpan" id="kobo.119.2">If you provide another name after </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.120.1">npm init</span></strong><span class="koboSpan" id="kobo.121.1">, then npm will try to look for a package using the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.122.1">create-</span></strong><span class="koboSpan" id="kobo.123.1"> prefix. </span><span class="koboSpan" id="kobo.123.2">For instance, when you run </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.124.1">npm init react-app</span></strong><span class="koboSpan" id="kobo.125.1">, npm will look for a package called </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.126.1">create-react-app</span></strong><span class="koboSpan" id="kobo.127.1"> and run it. </span><span class="koboSpan" id="kobo.127.2">Running a package refers to looking for a </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.128.1">bin</span></strong><span class="koboSpan" id="kobo.129.1"> field in the package’s </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.130.1">package.json</span></strong><span class="koboSpan" id="kobo.131.1"> file and using the given reference to start a </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.132.1">new process.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.133.1">If you want to add dependencies to your project instead, you can use </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.134.1">npm install</span></strong><span class="koboSpan" id="kobo.135.1">, too. </span><span class="koboSpan" id="kobo.135.2">For instance, adding React as a dependency is </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.136.1">npm </span></strong><span class="No-Break" lang=""><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.137.1">install react</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.138.1">.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.139.1">The dependency life cycle also requires us to know when dependencies are outdated. </span><span class="koboSpan" id="kobo.139.2">For this purpose, npm offers the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.140.1">npm </span></strong><span class="No-Break" lang=""><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.141.1">outdated</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.142.1"> command:</span></span></p>
<pre class="console" lang="en-GB"><span class="koboSpan" id="kobo.143.1">
$ npm outdated

Package                  Current   Wanted   Latest  Location

@types/node              16.11.9  17.0.40  17.0.40  pilet-foo

react                     17.0.2   17.0.2   18.1.0  pilet-foo

typescript                 4.5.2    4.7.3    4.7.3  pilet-foo</span></pre>
<p lang="en-GB"><span class="koboSpan" id="kobo.144.1">The command only shows packages that have a more recent release than the currently installed version. </span><span class="koboSpan" id="kobo.144.2">In some cases, that is fine – that is, when the current version matches the wanted version. </span><span class="koboSpan" id="kobo.144.3">In other cases, running </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.145.1">npm update</span></strong><span class="koboSpan" id="kobo.146.1"> will actually update the </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.147.1">installed version.</span></span></p>
<p class="callout-heading" lang="en-GB"><span class="koboSpan" id="kobo.148.1">Using different versions of npm</span></p>
<p class="callout" lang="en-GB"><span class="koboSpan" id="kobo.149.1">npm is already packaged together with Node.js. </span><span class="koboSpan" id="kobo.149.2">Therefore, each release of Node.js also selects a version of npm. </span><span class="koboSpan" id="kobo.149.3">For instance, Node.js 14 was bundled with npm 6. </span><span class="koboSpan" id="kobo.149.4">In Node.js 15, npm 7 was included. </span><span class="koboSpan" id="kobo.149.5">With Node.js 16 onward, you’ll get npm 8. </span><span class="koboSpan" id="kobo.149.6">One way to stay flexible is to use </span><strong class="bold" lang=""><span class="koboSpan" id="kobo.150.1">nvm</span></strong><span class="koboSpan" id="kobo.151.1"> instead. </span><span class="koboSpan" id="kobo.151.2">nvm is a</span><a id="_idIndexMarker095"/><span class="koboSpan" id="kobo.152.1"> small tool that allows you to select the version of Node.js to use. </span><span class="koboSpan" id="kobo.152.2">It can also be used to change the default version and quickly update and install new versions of Node.js and npm. </span><span class="koboSpan" id="kobo.152.3">More information is available </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.153.1">at </span></span><a href="https://github.com/nvm-sh/nvm"><span class="No-Break" lang=""><span class="koboSpan" id="kobo.154.1">https://github.com/nvm-sh/nvm</span></span></a><span class="No-Break" lang=""><span class="koboSpan" id="kobo.155.1">.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.156.1">npm also </span><a id="_idIndexMarker096"/><span class="koboSpan" id="kobo.157.1">provides a lot of useful, convenient features – for example, to improve security. </span><span class="koboSpan" id="kobo.157.2">The </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.158.1">npm audit</span></strong><span class="koboSpan" id="kobo.159.1"> command checks the currently installed packages against an online database containing security vulnerabilities. </span><span class="koboSpan" id="kobo.159.2">Quite often, a fix in vulnerable packages is just one call of </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.160.1">npm audit --fix</span></strong><span class="koboSpan" id="kobo.161.1"> flag away. </span><span class="koboSpan" id="kobo.161.2">Furthermore, using a command such as </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.162.1">npm view</span></strong><span class="koboSpan" id="kobo.163.1"> – for example, in </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.164.1">npm view react</span></strong><span class="koboSpan" id="kobo.165.1"> – we can directly interact with the npm registry containing most of the publicly </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.166.1">available packages.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.167.1">While the npm registry is a great source for packages, the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.168.1">npm</span></strong><span class="koboSpan" id="kobo.169.1"> command-line utility is not the only way to use it. </span><span class="koboSpan" id="kobo.169.2">In fact, the API of the web service is public and could be used by anyone – or any program for </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.170.1">that matter.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.171.1">One of the first companies to use a public API of the npm registry was Facebook. </span><span class="koboSpan" id="kobo.171.2">They suffered from slow installation times in their large projects and wanted to improve on this by providing a better algorithm to actually resolve the dependencies of a project – especially transitive dependencies. </span><span class="koboSpan" id="kobo.171.3">The result was a new package manager </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.172.1">named </span></span><span class="No-Break" lang=""><strong class="bold" lang=""><span class="koboSpan" id="kobo.173.1">Yarn</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.174.1">.</span></span></p>
<h1 id="_idParaDest-38" lang="en-GB"><a id="_idTextAnchor037"/><span class="koboSpan" id="kobo.175.1">Using Yarn</span></h1>
<p lang="en-GB"><span class="koboSpan" id="kobo.176.1">The </span><a id="_idIndexMarker097"/><span class="koboSpan" id="kobo.177.1">issue with the original npm package resolution algorithm was that it was created in a resilient but naïve way. </span><span class="koboSpan" id="kobo.177.2">This does not mean that the algorithm was simple. </span><span class="koboSpan" id="kobo.177.3">Rather, here, we refer to the fact that no exotic tricks or experience optimizations have been considered. </span><span class="koboSpan" id="kobo.177.4">Instead of trying to optimize (that is, lower) the number of packages available on the local disk, it was designed to put the packages into the same hierarchy as they were declared in. </span><span class="koboSpan" id="kobo.177.5">This results in a filesystem view as shown in </span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.178.1">Figure 3</span></em></span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.179.1">.1</span></em></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.180.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer018">
<span class="koboSpan" id="kobo.181.1"><img alt="Figure 3.1 – Example filesystem snapshot after installing packages using npm " src="image/Figure_3.1_B18989.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.182.1">Figure 3.1 – Example filesystem snapshot after installing packages using npm</span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.183.1">The </span><a id="_idIndexMarker098"/><span class="koboSpan" id="kobo.184.1">naïve way of handling package installations is certainly a great way to ensure that everything is installed correctly, but not ideal in terms of performance. </span><span class="koboSpan" id="kobo.184.2">Looking at </span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.185.1">Figure 3</span></em></span><em class="italic" lang=""><span class="koboSpan" id="kobo.186.1">.1</span></em><span class="koboSpan" id="kobo.187.1">, there may be some </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.188.1">optimizations possible.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.189.1">Let’s add some example package names and versions to </span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.190.1">Figure 3</span></em></span><em class="italic" lang=""><span class="koboSpan" id="kobo.191.1">.1</span></em><span class="koboSpan" id="kobo.192.1"> to see the opportunities for optimization. </span><span class="koboSpan" id="kobo.192.2">In </span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.193.1">Figure 3</span></em></span><em class="italic" lang=""><span class="koboSpan" id="kobo.194.1">.2</span></em><span class="koboSpan" id="kobo.195.1">, the same snapshot is shown – just with example </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.196.1">package names:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer019">
<span class="koboSpan" id="kobo.197.1"><img alt="Figure 3.2 – Filesystem snapshot with example package names after npm installation " src="image/Figure_3.2_B18989.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.198.1">Figure 3.2 – Filesystem snapshot with example package names after npm installation</span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.199.1">Instead </span><a id="_idIndexMarker099"/><span class="koboSpan" id="kobo.200.1">of duplicating the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.201.1">bar</span></strong><span class="koboSpan" id="kobo.202.1"> dependency, it could be just used once. </span><span class="koboSpan" id="kobo.202.2">The </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.203.1">foo</span></strong><span class="koboSpan" id="kobo.204.1"> dependency, on the other hand, has to be duplicated due to conflicting versions. </span><span class="koboSpan" id="kobo.204.2">Other transitive dependencies, such as </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.205.1">abc</span></strong><span class="koboSpan" id="kobo.206.1"> or </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.207.1">def</span></strong><span class="koboSpan" id="kobo.208.1">, can be brought to the </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.209.1">top level.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.210.1">The resulting image is shown in </span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.211.1">Figure 3</span></em></span><em class="italic" lang=""><span class="koboSpan" id="kobo.212.1">.3</span></em><span class="koboSpan" id="kobo.213.1">. </span><span class="koboSpan" id="kobo.213.2">This flattens the structure where possible. </span><span class="koboSpan" id="kobo.213.3">This optimization was key to the first version of Yarn. </span><span class="koboSpan" id="kobo.213.4">Actually, it was so successful that npm improved its algorithm, too. </span><span class="koboSpan" id="kobo.213.5">Today, npm resolves the packages in a similar way to the sketch shown in </span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.214.1">Figure 3</span></em></span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.215.1">.3</span></em></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.216.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer020">
<span class="koboSpan" id="kobo.217.1"><img alt="Figure 3.3 – Filesystem snapshot with example package names after installation using Yarn " src="image/Figure_3.3_B18989.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.218.1">Figure 3.3 – Filesystem snapshot with example package names after installation using Yarn</span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.219.1">For </span><a id="_idIndexMarker100"/><span class="koboSpan" id="kobo.220.1">the team at Yarn, the optimizations gained were not enough. </span><span class="koboSpan" id="kobo.220.2">They started to look for different ways to improve even further. </span><span class="koboSpan" id="kobo.220.3">However, the more they looked, the more they were convinced that something completely new was needed to make any </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.221.1">further enhancements.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.222.1">The result was introduced with </span><strong class="bold" lang=""><span class="koboSpan" id="kobo.223.1">Yarn 2</span></strong><span class="koboSpan" id="kobo.224.1">: </span><strong class="bold" lang=""><span class="koboSpan" id="kobo.225.1">Plug’n’Play</span></strong><span class="koboSpan" id="kobo.226.1"> (</span><strong class="bold" lang=""><span class="koboSpan" id="kobo.227.1">PnP</span></strong><span class="koboSpan" id="kobo.228.1">). </span><span class="koboSpan" id="kobo.228.2">With PnP, there is no </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.229.1">node_modules</span></strong><span class="koboSpan" id="kobo.230.1"> directory. </span><span class="koboSpan" id="kobo.230.2">Instead, a special file called </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.231.1">.pnp.cjs</span></strong><span class="koboSpan" id="kobo.232.1"> is created to give information on how the dependencies can be resolved. </span><span class="koboSpan" id="kobo.232.2">With the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.233.1">.pnp.cjs</span></strong><span class="koboSpan" id="kobo.234.1"> file, every package can be resolved – just as with </span><span class="No-Break" lang=""><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.235.1">node_modules</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.236.1"> beforehand.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.237.1">The specific location of the packages depends on the project’s settings. </span><span class="koboSpan" id="kobo.237.2">With Yarn 2, a new concept called </span><em class="italic" lang=""><span class="koboSpan" id="kobo.238.1">zero-installs</span></em><span class="koboSpan" id="kobo.239.1"> has been introduced. </span><span class="koboSpan" id="kobo.239.2">This way, each dependency will be available within the project – just in a </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.240.1">.yarn/cache</span></strong><span class="koboSpan" id="kobo.241.1"> subfolder. </span><span class="koboSpan" id="kobo.241.2">To actually achieve zero-installs, the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.242.1">.yarn</span></strong><span class="koboSpan" id="kobo.243.1"> folder should be checked into source control. </span><span class="koboSpan" id="kobo.243.2">Now, when the project is cloned, no installation needs to be performed. </span><span class="koboSpan" id="kobo.243.3">The dependencies are already part of </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.244.1">the repository.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.245.1">While </span><a id="_idIndexMarker101"/><span class="koboSpan" id="kobo.246.1">most commands are very similar, Yarn takes a different approach to adding new dependencies. </span><span class="koboSpan" id="kobo.246.2">Here, dependencies are added using </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.247.1">yarn add</span></strong><span class="koboSpan" id="kobo.248.1"> – for example, </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.249.1">yarn add react</span></strong><span class="koboSpan" id="kobo.250.1">. </span><span class="koboSpan" id="kobo.250.2">The installation of packages using the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.251.1">yarn</span></strong><span class="koboSpan" id="kobo.252.1"> command-line utility is quite similar to the previous usage with </span><span class="No-Break" lang=""><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.253.1">npm</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.254.1">, though:</span></span></p>
<pre class="console" lang="en-GB"><span class="koboSpan" id="kobo.255.1">
$ yarn install

</span><span class="koboSpan" id="kobo.256.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.257.1"> YN0000: ┌ Resolution step

</span><span class="koboSpan" id="kobo.258.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.259.1"> YN0000: └ Completed in 0s 634ms

</span><span class="koboSpan" id="kobo.260.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.261.1"> YN0000: ┌ Fetch step

</span><span class="koboSpan" id="kobo.262.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.263.1"> YN0013: │ js-tokens@npm:4.0.0 can't be found in the cache and will be fetched from the remote registry

</span><span class="koboSpan" id="kobo.264.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.265.1"> YN0013: │ loose-envify@npm:1.4.0 can't be found in the cache and will be fetched from the remote registry

</span><span class="koboSpan" id="kobo.266.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.267.1"> YN0013: │ react-dom@npm:18.1.0 can't be found in the cache and will be fetched from the remote registry

</span><span class="koboSpan" id="kobo.268.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.269.1"> YN0013: │ react@npm:18.1.0 can't be found in the cache and will be fetched from the remote registry

</span><span class="koboSpan" id="kobo.270.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.271.1"> YN0013: │ scheduler@npm:0.22.0 can't be found in the cache and will be fetched from the remote registry

</span><span class="koboSpan" id="kobo.272.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.273.1"> YN0000: └ Completed

</span><span class="koboSpan" id="kobo.274.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.275.1"> YN0000: ┌ Link step

</span><span class="koboSpan" id="kobo.276.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.277.1"> YN0000: └ Completed

</span><span class="koboSpan" id="kobo.278.1"><img alt="" src="image/01.png"/></span><span class="koboSpan" id="kobo.279.1"> YN0000: Done in 0s 731ms</span></pre>
<p lang="en-GB"><span class="koboSpan" id="kobo.280.1">In </span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.281.1">Figure 3</span></em></span><em class="italic" lang=""><span class="koboSpan" id="kobo.282.1">.4</span></em><span class="koboSpan" id="kobo.283.1">, the new PnP mechanism is shown using the previous example. </span><span class="koboSpan" id="kobo.283.2">By using fully qualified names consisting of the package name and version, unique identifiers are created, allowing multiple versions of the same package to be located in a </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.284.1">flat structure.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.285.1">The </span><a id="_idIndexMarker102"/><span class="koboSpan" id="kobo.286.1">downside of the PnP mechanism is the custom resolution method, which requires some patching in Node.js. </span><span class="koboSpan" id="kobo.286.2">The standard resolution mechanism of Node.js uses </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.287.1">node_modules</span></strong><span class="koboSpan" id="kobo.288.1"> to actually find modules within packages. </span><span class="koboSpan" id="kobo.288.2">The custom resolution method teaches Node.js to use a different directory with a different structure to </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.289.1">find modules:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer033">
<span class="koboSpan" id="kobo.290.1"><img alt="Figure 3.4 – Filesystem snapshot with example package names after installation using Yarn PnP " src="image/Figure_3.4_B18989.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.291.1">Figure 3.4 – Filesystem snapshot with example package names after installation using Yarn PnP</span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.292.1">While using a custom resolution method is not a problem for many packages, some may depend on the classic structure involving </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.293.1">node_modules</span></strong><span class="koboSpan" id="kobo.294.1"> with packages just resolving to directories and files. </span><span class="koboSpan" id="kobo.294.2">In PnP, however, the structure is flat, with each package being a </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.295.1">zip archive.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.296.1">As of today, many plugins and patches are available for packages to be compatible with PnP. </span><span class="koboSpan" id="kobo.296.2">Many – especially less popular – packages are still not usable with PnP. </span><span class="koboSpan" id="kobo.296.3">Luckily, Yarn 3 fixed many of these issues, providing a compatibility mode that works for most of these problematic packages. </span><span class="koboSpan" id="kobo.296.4">At the end of the day, it’s, unfortunately, mostly a matter of trial and </span><a id="_idIndexMarker103"/><span class="koboSpan" id="kobo.297.1">error. </span><span class="koboSpan" id="kobo.297.2">Luckily, Yarn PnP is not the only solution that exists for speeding up npm </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.298.1">even more.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.299.1">Even before Yarn 2 with PnP was released, other developers started thinking of alternative strategies to speed up installation times and preserve network bandwidth and storage capacity. </span><span class="koboSpan" id="kobo.299.2">The best-known attempt is a utility </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.300.1">called pnpm.</span></span></p>
<h1 id="_idParaDest-39" lang="en-GB"><a id="_idTextAnchor038"/><span class="koboSpan" id="kobo.301.1">Using pnpm</span></h1>
<p lang="en-GB"><span class="koboSpan" id="kobo.302.1">The </span><a id="_idIndexMarker104"/><span class="koboSpan" id="kobo.303.1">approach of pnpm feels a bit like the original package resolution of npm. </span><span class="koboSpan" id="kobo.303.2">Here, each package is essentially isolated and puts its own dependencies into a local </span><span class="No-Break" lang=""><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.304.1">node_modules</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.305.1"> subfolder.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.306.1">There is, however, one crucial difference: instead of having a hard copy of each dependency, the different dependencies are made available through symbolic links. </span><span class="koboSpan" id="kobo.306.2">The advantage of this approach is that every dependency only needs to be resolved once </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.307.1">per system.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.308.1">The other advantage is that for most packages everything is as it should be. </span><span class="koboSpan" id="kobo.308.2">There is nothing hiding behind an archive or via some custom mapping defined by a module that would run in the beginning. </span><span class="koboSpan" id="kobo.308.3">The whole package resolution just works. </span><span class="koboSpan" id="kobo.308.4">The exception to this rule is packages that use their path to find other packages or work against a root directory. </span><span class="koboSpan" id="kobo.308.5">Since the physical location of the packages is global, and therefore different from the project’s location, these approaches do not work </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.309.1">with pnpm.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.310.1">Installing packages with the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.311.1">pnpm</span></strong><span class="koboSpan" id="kobo.312.1"> command-line utility works very similarly </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.313.1">to </span></span><span class="No-Break" lang=""><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.314.1">npm</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.315.1">:</span></span></p>
<pre class="console" lang="en-GB"><span class="koboSpan" id="kobo.316.1">
$ pnpm install

Packages: +5

+++++

Packages are hard linked from the content-addressable store to the virtual store.

</span><span class="koboSpan" id="kobo.316.2">  Content-addressable store is at: /home/rapplf/.local/share/pnpm/store/v3

  Virtual store is at:             node_modules/.pnpm

dependencies:

+ react 18.1.0

+ react-dom 18.1.0

Progress: resolved 5, reused 2, downloaded 3, added 5, done</span></pre>
<p lang="en-GB"><span class="koboSpan" id="kobo.317.1">Overall, most</span><a id="_idIndexMarker105"/><span class="koboSpan" id="kobo.318.1"> commands of the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.319.1">pnpm</span></strong><span class="koboSpan" id="kobo.320.1"> command-line utility have either the same or a very similar name to their </span><span class="No-Break" lang=""><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.321.1">npm</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.322.1"> counterpart.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.323.1">On installation, </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.324.1">pnpm</span></strong><span class="koboSpan" id="kobo.325.1"> adds the unavailable packages to a local store. </span><span class="koboSpan" id="kobo.325.2">A local store is just a special directory from </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.326.1">pnpm</span></strong><span class="koboSpan" id="kobo.327.1"> that is not bound to your project, but rather your user account. </span><span class="koboSpan" id="kobo.327.2">It is pnpm’s package storage that is actually the source of its miraculous performance. </span><span class="koboSpan" id="kobo.327.3">Afterward, </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.328.1">pnpm</span></strong><span class="koboSpan" id="kobo.329.1"> creates all the symbolic links to wire everything together. </span><span class="koboSpan" id="kobo.329.2">The result looks similar to </span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.330.1">Figure 3</span></em></span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.331.1">.5</span></em></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.332.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer034">
<span class="koboSpan" id="kobo.333.1"><img alt="Figure 3.5 – Filesystem snapshot with example package names after installation using pnpm " src="image/Figure_3.5_B18989.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.334.1">Figure 3.5 – Filesystem snapshot with example package names after installation using pnpm</span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.335.1">Only direct dependencies are listed in the </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.336.1">node_modules</span></strong><span class="koboSpan" id="kobo.337.1"> folder. </span><span class="koboSpan" id="kobo.337.2">The content of each subfolder is not available in the original </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.338.1">node_modules</span></strong><span class="koboSpan" id="kobo.339.1"> – rather, in the global </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.340.1">.pnpm</span></strong><span class="koboSpan" id="kobo.341.1"> cache. </span><span class="koboSpan" id="kobo.341.2">The same is then applied to </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.342.1">all sub-dependencies.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.343.1">The result is a</span><a id="_idIndexMarker106"/><span class="koboSpan" id="kobo.344.1"> massive performance boost. </span><span class="koboSpan" id="kobo.344.2">Already, on a clean install, </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.345.1">pnpm</span></strong><span class="koboSpan" id="kobo.346.1"> is faster than the competition. </span><span class="koboSpan" id="kobo.346.2">However, in other scenarios, the relative gap may be even larger. </span><span class="koboSpan" id="kobo.346.3">In </span><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.347.1">Figure 3</span></em></span><em class="italic" lang=""><span class="koboSpan" id="kobo.348.1">.6</span></em><span class="koboSpan" id="kobo.349.1">, the performance of </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.350.1">pnpm</span></strong><span class="koboSpan" id="kobo.351.1"> is compared against other package managers. </span><span class="koboSpan" id="kobo.351.2">Lower bars refer to </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.352.1">better performance:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer035">
<span class="koboSpan" id="kobo.353.1"><img alt="Figure 3.6 – Performance benchmark comparing pnpm against npm, Yarn, and Yarn with PnP (source: https://pnpm.io/benchmarks)" src="image/Figure_3.6_B18989.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.354.1">Figure 3.6 – Performance benchmark comparing pnpm against npm, Yarn, and Yarn with PnP (source: https://pnpm.io/benchmarks)</span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.355.1">Only in the </span><a id="_idIndexMarker107"/><span class="koboSpan" id="kobo.356.1">case of an up-to-date installation can npm be considered the fastest option. </span><span class="koboSpan" id="kobo.356.2">In other cases, pnpm and sometimes Yarn PnP can be considered faster. </span><span class="koboSpan" id="kobo.356.3">With this in mind, the key question is whether there are other alternatives to consider. </span><span class="koboSpan" id="kobo.356.4">Let’s see what else we can do to simplify </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.357.1">dependency management.</span></span></p>
<h1 id="_idParaDest-40" lang="en-GB"><a id="_idTextAnchor039"/><span class="koboSpan" id="kobo.358.1">More alternatives</span></h1>
<p lang="en-GB"><span class="koboSpan" id="kobo.359.1">There is no strict requirement when using a package manager. </span><span class="koboSpan" id="kobo.359.2">Theoretically, it does not matter where the code comes from. </span><span class="koboSpan" id="kobo.359.3">You could, for instance, download the packages directly, extract them, and refer to them via their </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.360.1">local path.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.361.1">Alternatively, a system</span><a id="_idIndexMarker108"/><span class="koboSpan" id="kobo.362.1"> such as </span><strong class="bold" lang=""><span class="koboSpan" id="kobo.363.1">Deno</span></strong><span class="koboSpan" id="kobo.364.1"> could be interesting. </span><span class="koboSpan" id="kobo.364.2">On the surface, Deno is quite similar to Node.js. </span><span class="koboSpan" id="kobo.364.3">However, there are a few crucial differences under the hood. </span><span class="koboSpan" id="kobo.364.4">The most striking one is that there is no package manager for Deno. </span><span class="koboSpan" id="kobo.364.5">Instead, packages are just URLs that are resolved once needed. </span><span class="koboSpan" id="kobo.364.6">This way, the package installation is just a download – which happens to run </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.365.1">when needed.</span></span></p>
<p class="callout-heading" lang="en-GB"><span class="koboSpan" id="kobo.366.1">Deno in a nutshell</span></p>
<p class="callout" lang="en-GB"><span class="koboSpan" id="kobo.367.1">Deno was created by Ryan Dahl – the creator of Node.js. </span><span class="koboSpan" id="kobo.367.2">As such, Deno shares many features with Node.js but deviates in some aspects. </span><span class="koboSpan" id="kobo.367.3">Deno aims to be a lot more compatible with JavaScript running in the browser than Node.js. </span><span class="koboSpan" id="kobo.367.4">Deno also tries to be secure by default. </span><span class="koboSpan" id="kobo.367.5">When running a script with Deno, the provided security context has to be defined by the user. </span><span class="koboSpan" id="kobo.367.6">Otherwise, access to the network or the filesystem may be impossible for the code running. </span><span class="koboSpan" id="kobo.367.7">You can get more</span><a id="_idIndexMarker109"/><span class="koboSpan" id="kobo.368.1"> information </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.369.1">at </span></span><a href="https://deno.land/"><span class="No-Break" lang=""><span class="koboSpan" id="kobo.370.1">https://deno.land/</span></span></a><span class="No-Break" lang=""><span class="koboSpan" id="kobo.371.1">.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.372.1">Another option is to use a tool that actually leverages one of the existing package managers underneath but in a more efficient or user-friendly fashion. </span><span class="koboSpan" id="kobo.372.2">One example in this category </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.373.1">is </span></span><span class="No-Break" lang=""><strong class="bold" lang=""><span class="koboSpan" id="kobo.374.1">Turborepo</span></strong></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.375.1">.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.376.1">Turborepo works</span><a id="_idIndexMarker110"/><span class="koboSpan" id="kobo.377.1"> with any of the popular package managers and claims to provide improved performance for many tasks, including package installation and updates. </span><span class="koboSpan" id="kobo.377.2">The most efficient way, however, to utilize Turborepo is to use it for a so-called monorepo, which will be discussed in greater length in </span><a href="B18989_09.xhtml#_idTextAnchor088"><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.378.1">Chapter 9</span></em></span></a><span class="koboSpan" id="kobo.379.1">, </span><em class="italic" lang=""><span class="koboSpan" id="kobo.380.1">Structuring Code </span></em><span class="No-Break" lang=""><em class="italic" lang=""><span class="koboSpan" id="kobo.381.1">in Monorepos</span></em></span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.382.1">.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.383.1">Besides the question of how the packages can be installed, updated, and published, the other part of package management is the package registry. </span><span class="koboSpan" id="kobo.383.2">In this space, you can choose from many commercial offerings to open source projects</span><a id="_idIndexMarker111"/><span class="koboSpan" id="kobo.384.1"> such as </span><strong class="bold" lang=""><span class="koboSpan" id="kobo.385.1">Verdaccio</span></strong><span class="koboSpan" id="kobo.386.1">. </span><span class="koboSpan" id="kobo.386.2">Having your own package registry can be great for larger projects, where missing dependencies or downtimes of the public npm registry may </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.387.1">be problematic.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.388.1">In general, there are not many alternatives to the established package managers npm, Yarn, and pnpm. </span><span class="koboSpan" id="kobo.388.2">While optimizing the use of package managers or using cached registries instead might be appealing, they are certainly not worth the effort for most projects. </span><span class="koboSpan" id="kobo.388.3">Right now, npm and Yarn seem to be most appealing in the broadest range of scenarios, whereas pnpm could be considered the desired choice for really </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.389.1">big repositories.</span></span></p>
<h1 id="_idParaDest-41" lang="en-GB"><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.390.1">Summary</span></h1>
<p lang="en-GB"><span class="koboSpan" id="kobo.391.1">In this chapter, you learned how to use a package manager to handle everything related to packages. </span><span class="koboSpan" id="kobo.391.2">You’ve leveraged the default </span><strong class="source-inline" lang=""><span class="koboSpan" id="kobo.392.1">npm</span></strong><span class="koboSpan" id="kobo.393.1"> command-line utility. </span><span class="koboSpan" id="kobo.393.2">You got in touch with the most important alternatives, Yarn and pnpm. </span><span class="koboSpan" id="kobo.393.3">You should know what Yarn brings to the table – after all, PnP and zero-installs are neat features. </span><span class="koboSpan" id="kobo.393.4">Furthermore, you checked out some alternatives and learned about custom registries and repository task runners such </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.394.1">as Turborepo.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.395.1">At this point, you have everything to clone and run existing Node.js projects. </span><span class="koboSpan" id="kobo.395.2">You can install new dependencies, check for outdated dependencies, and update them. </span><span class="koboSpan" id="kobo.395.3">This gives you the power to integrate all of the over-a-million packages that have been published over the years in the </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.396.1">npm registry.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.397.1">In the next chapter, we will discuss how different flavors of JavaScript, such as more modern specifications or languages that use JavaScript as a compilation target, can be used </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.398.1">in Node.js.</span></span></p>
</div>


<div class="Content" id="_idContainer037">
<h1 id="_idParaDest-42" lang="en-GB"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.1.1">Part 2: Tooling</span></h1>
<p lang="en-GB"><span class="koboSpan" id="kobo.2.1">In this part, you’ll strengthen your knowledge of the Node.js ecosystem by getting in touch with a variety of tools and utilities. </span><span class="koboSpan" id="kobo.2.2">You’ll learn how you can use different flavors of JavaScript in Node.js. </span><span class="koboSpan" id="kobo.2.3">Examples here include TypeScript and Flow. </span><span class="koboSpan" id="kobo.2.4">You’ll also see which code verification and style checkers exist and how to </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.3.1">use them.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.4.1">The main focus of this part is to enable you to set up and maintain a new web development project from scratch. </span><span class="koboSpan" id="kobo.4.2">This also includes knowledge about quality assurance. </span><span class="koboSpan" id="kobo.4.3">As part of these topics, utilities such as Jest or Playwright </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.5.1">are discussed.</span></span></p>
<p lang="en-GB"><span class="koboSpan" id="kobo.6.1">This part of the book comprises the </span><span class="No-Break" lang=""><span class="koboSpan" id="kobo.7.1">following chapters:</span></span></p>
<ul>
<li lang="en-GB"><a href="B18989_04.xhtml#_idTextAnchor042"><em class="italic" lang=""><span class="koboSpan" id="kobo.8.1">Chapter 4</span></em></a><span class="koboSpan" id="kobo.9.1">, </span><em class="italic" lang=""><span class="koboSpan" id="kobo.10.1">Using Different Flavors of JavaScript</span></em></li>
<li lang="en-GB"><a href="B18989_05.xhtml#_idTextAnchor049"><em class="italic" lang=""><span class="koboSpan" id="kobo.11.1">Chapter 5</span></em></a><span class="koboSpan" id="kobo.12.1">, </span><em class="italic" lang=""><span class="koboSpan" id="kobo.13.1">Enhancing Code Quality with Linters and Formatters</span></em></li>
<li lang="en-GB"><a href="B18989_06.xhtml#_idTextAnchor057"><em class="italic" lang=""><span class="koboSpan" id="kobo.14.1">Chapter 6</span></em></a><span class="koboSpan" id="kobo.15.1">, </span><em class="italic" lang=""><span class="koboSpan" id="kobo.16.1">Building Web Apps with Bundlers</span></em></li>
<li lang="en-GB"><a href="B18989_07.xhtml#_idTextAnchor067"><em class="italic" lang=""><span class="koboSpan" id="kobo.17.1">Chapter 7</span></em></a><span class="koboSpan" id="kobo.18.1">, </span><em class="italic" lang=""><span class="koboSpan" id="kobo.19.1">Improving Reliability with Testing Tools</span></em></li>
</ul>
</div>
<div>
<div id="_idContainer038">
</div>
</div>
</body></html>