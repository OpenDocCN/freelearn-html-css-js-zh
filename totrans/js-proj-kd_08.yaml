- en: Chapter 8. Building Rat-man!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we will be building a game called **Rat-man**, which is actually
    a modified version of the famous game **Pac-Man**. We will use canvas, JavaScript,
    CSS, and HTML to build our game.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s start with introducing our game''s characters:'
  prefs: []
  type: TYPE_NORMAL
- en: Our game will have one rat. The player will act as the rat.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: There will be four cats who will try to catch the rat and a lot of cheese for
    the rat to eat.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The main goal of the game is to eat all the cheese without being caught by the
    monster cats.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sounds fun, right? Let's get right to it...
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'To make our code clean, we will keep our JavaScript, CSS, and images files
    in separate folders. We will have three primary folders named as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '`css`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`img`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`scripts`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Game user interface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To start building our game, we need to prepare our canvas. Our HTML file should
    look similar to the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Our game user interface will be in the `<body></body>` tags. We will add JavaScript
    to our canvas soon.
  prefs: []
  type: TYPE_NORMAL
- en: 'In the `css` folder, create a CSS file named `styles.css`, which will contain
    the following code for our HTML `body`, `canvas`, and a play `button`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Create another CSS file named `reset.css` in the same folder and add the following
    code to the CSS file. This file will design the user interface for the initial
    screen of the game:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Save both the files and include them in your HTML file with the following code
    in the `<head></head>` tags:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'If you open an HTML file of a browser now, you will see the following image:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Game user interface](img/B04720_08_01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: We are going to draw our game interface in the preceding rectangle.
  prefs: []
  type: TYPE_NORMAL
- en: Adding functionalities to the game
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To add the user interface and the game''s functionalities, we will be needing
    JavaScript. We will need the following JavaScript files in the `scripts` folder:'
  prefs: []
  type: TYPE_NORMAL
- en: '`app.main.js`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`app.display_functions.js`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`app.init.js`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`app.key_handler.js`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`app.movement_functions.js`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`app.constants.js`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The app.main.js file
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Our `app.main.js` file should contain the following function that will deal
    with the `app.key_handler.js` file and your computer's keyboard. It will also
    call the `app.init.js` file for the initialization of our variables.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Here we used `app.main.js`; You need not name your JavaScript file like this.
    But it is a good practice to maintain the naming convention.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following code is the content of the `app.main.js` file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: The app.display_functions.js file
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In our `app.display_functions.js` file, we will write a function, where we will
    include the `APP.Show_world` function, which is used in the `app.init.js` file.
  prefs: []
  type: TYPE_NORMAL
- en: 'The function should contain the following code (refer to the comments to understand
    what each step does):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'The `APP.map.Draw` function will hold the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'For the cats'' movement, we will use the `APP.monsters.Move` function with
    the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'Our rat will move when the `APP.player.Move()` function is called with the
    following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, we will make our rat visible on our canvas while moving the rat on the
    blocks by calling the function with the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'To show our cats on the canvas, we need to use the following code in our `APP.Show_Monster()`
    function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'To show the portal, we need to write another function called `APP.portals.Show
    ()`, including the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'The user will need to see a message after the game is over or make the screen
    blur. To do this, we need to declare another function called `APP.Game_Over()`
    with the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: The app.init.js file
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Our `app.init.js` file will contain a function. In the function, we will declare
    the following variables:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'Write a function that will contain few more variables, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, we will initialize our game''s map:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: Images for Rat-man!
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To build the game, we will need a few images. We will keep all our images in
    the `img` folder. In the `img` folder, we will create four folders, as shown in
    the following:'
  prefs: []
  type: TYPE_NORMAL
- en: monsters
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: player
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: portal
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: walls
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We will keep two images, named `dot.png` and `blank.png`, in the `img` folder.
  prefs: []
  type: TYPE_NORMAL
- en: The monsters folder
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In the `monsters` folder, create four folders with our cats' names.
  prefs: []
  type: TYPE_NORMAL
- en: 'Say that our cats'' names are as follows (you can name them whatever you want):'
  prefs: []
  type: TYPE_NORMAL
- en: blinky
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: inky
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: pinky
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: clyde
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Each cat folder will have four folders for the directed images of the cats.
    The folder names are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '`up`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`down`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`left`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`right`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Each direction folder should contain an image of our cat. The image name should
    be `0.png`.
  prefs: []
  type: TYPE_NORMAL
- en: You need to keep your image 50 x 50 px.
  prefs: []
  type: TYPE_NORMAL
- en: The player folder
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The `player` folder should contain four folders for the direction of our rat.
    The folders should be named as shown in the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '`up`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`down`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`left`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`right`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Each folder should contain the rat's directed image. There need to be two images,
    `0.png` and `1.png`. One image is the open mouthed rat and another is of the closed
    mouthed rat. The images need to be 50 x 50 px.
  prefs: []
  type: TYPE_NORMAL
- en: The portal folder
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The `portal` folder should contain two images of the portal through which our
    rat will travel from one end to another. The images names should be `0.png` and
    `1.png`.
  prefs: []
  type: TYPE_NORMAL
- en: The walls folder
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The `walls` folder should have five images to draw the walls in the canvas.
  prefs: []
  type: TYPE_NORMAL
- en: The images should be named `0.png`, `1.png`, `2.png`, `3.png`, and `4.png`.
    The images will be the corners and straight lines of the wall.
  prefs: []
  type: TYPE_NORMAL
- en: 'The hierarchical representation of the images used in building our game is
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![The walls folder](img/B04720_08_05.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Adding images to our cats
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We will write four functions to add perfect images for our cats. The function
    should look similar to the following function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: We will change the index number of the `APP.monsters[0].Init = function ();`
    function to `APP.monsters[1].Init = function ();` for the second cat. And `APP.monsters[2].Init
    = function ()` & `APP.monsters[3].Init = function ()` for the third and fourth
    cats.
  prefs: []
  type: TYPE_NORMAL
- en: We also need to change the image location and index numbers for the cats.
  prefs: []
  type: TYPE_NORMAL
- en: 'For the initialization of the walls and cheese with the images, we need to
    write a function, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: Draw the canvas
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We will draw our canvas by adding the following function to our `app.init.js`
    file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: The app.key_handler.js file
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Now, in the `app.key_handler.js` file, we will write our code to give the player
    the ability to move our rat using the keyboard. The code should look similar to
    the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: The app.movement_functions.js file
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We need to take a look where our wall ends or starts while pressing the keys.
    We need to stop moving the rat when we reach the edges. Therefore, we have to
    set some conditions for that. The first one is to check the direction. The function
    can be written as shown in the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: 'While checking the directions, we also need to move in the right direction.
    The function to select the direction can be written as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, we have to check for the walls. We can do this by adding a few conditions
    to the function as shown in the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: 'The movement of the arrow keys should be well defined. We should create the
    following functions for the arrow keys:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: The app.constants.js file
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To keep our game''s canvas clean and in good shape, we need to initialize a
    few variables with a few fixed variables (for example, height of map, height of
    cell, width of map, width of cell, and so on). We can do this by writing the following
    code in our `app.constants.js` file. Check the comments with the code to get a
    clear idea how the code will work:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: Playing the game
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If you correctly integrated the code and your HTML file now looks similar to
    the following, you can now run the HTML file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: 'After running the HTML file on your browser, you will be able to see the following
    screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Playing the game](img/B04720_08_02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Congratulations! You have successfully built Rat-man!
  prefs: []
  type: TYPE_NORMAL
- en: To play the game, click anywhere on the canvas and use the arrow keys for your
    rat's movement.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you lose all your lives, you will see the following screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Playing the game](img/B04720_08_03.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'If you win, you will see the following screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Playing the game](img/B04720_08_04.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We have built the Rat-man! I hope that you are now playing the game that you
    have built. If you cannot play the game after coding for hours, don't worry. Keep
    calm and try again. The whole source code and required images are included in
    the book. You can download and run it. However, before doing this, I would suggest
    you to try at least twice. Let's move on to [Chapter 9](ch09.html "Chapter 9. Tidying
    up Your Code Using OOP"), *Tidying up Your Code Using OOP*, for a better idea
    about making files or folders and accessing them.
  prefs: []
  type: TYPE_NORMAL
