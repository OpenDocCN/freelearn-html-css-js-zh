<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Using and Customizing Calendar</h1></div></div></div><p>Calendars have long been a feature of web pages that require some clever JavaScript. HTML5 is working toward making it all much simpler, but browser support still isn't consistent. This is where Kendo UI is a perfect solution, being a framework that combines HTML5 and JavaScript to create cross-browser consistency using the latest standards. Like always, the Kendo UI solution couldn't be simpler to implement.</p><div><div><div><div><h1 class="title"><a id="ch03lvl1sec25"/>Calendar widget – basics</h1></div></div></div><p>The Kendo UI Calendar widget <a id="id218" class="indexterm"/>transforms <a id="id219" class="indexterm"/>a simple HTML element, such as a <code class="literal">div</code>, into a specialized HTML table that displays a <a id="id220" class="indexterm"/>calendar. It also wires up JavaScript functionality to this table to support all of the Calendar widget events and methods. To see the simplest possible implementation of this widget, create a new action method in the Kendo controller so that we have a URL for "calendar":</p><div><pre class="programlisting">public ActionResult Calendar()
{
    return View();
}</pre></div><p>Then add a view for this action method and set up an empty <code class="literal">div</code> to hold a Kendo calendar widget:</p><div><pre class="programlisting">@{
    ViewBag.Title = "Calendar";
}

&lt;h2&gt;Calendar&lt;/h2&gt;
&lt;div id="calendar"&gt;
&lt;/div&gt;
&lt;script type="text/javascript"&gt;
    $("#calendar").kendoCalendar();
&lt;/script&gt;</pre></div><p>The output is amazing considering how little code we have written:</p><div><img src="img/4346OT_03_01.jpg" alt="Calendar widget – basics"/></div><p>Click around on the calendar and observe how much functionality it already has. The <a id="id221" class="indexterm"/>arrows at the top of the calendar navigate forward or backward by one month. The text at the top of the calendar, shown as <strong>October 2012</strong> in the preceding screenshot, navigates up to a broader level of dates which makes it easy to select a different year or decade. The date at the bottom of the calendar is a hyperlink that navigates directly to the current date. As we add functionality later in this chapter, we can make the calendar do even more.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec26"/>Configuring the Calendar widget</h1></div></div></div><p>Since the <a id="id222" class="indexterm"/>Calendar widget only has a few properties, let's start by examining them and then move on to examples in using them. The calendar widget has two different types of <a id="id223" class="indexterm"/>properties:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Data/template properties</strong>: These<a id="id224" class="indexterm"/> properties configure the data behind the calendar widget</li><li class="listitem" style="list-style-type: disc"><strong>Display/formatting properties</strong>: These <a id="id225" class="indexterm"/>properties configure how the calendar is rendered on the page and how that data is formatted</li></ul></div><p>Here are these properties listed in code format. Add this code to the page and run it:</p><div><pre class="programlisting">$("#calendar").kendoCalendar({
    culture: 'en-US', // specifies the culture
    depth: 'month',   // specifies navigation depth
                      //(century/decade/month/year)
    max: new Date(2012,11,31), // latest date calendar can show
    min: new Date(1980, 0, 1), // oldest date calendar can show
    start: 'year',    // specifies the start view (century/decade/month/year)
    value: new Date(2012,9,25), // initially selected date
    format: 'yyyy/MM/dd'  // format string used when the value() of this
                          //calendar is requested
});</pre></div><p>The calendar, when <a id="id226" class="indexterm"/>configured as above, renders initially by showing a selection of months available within the currently selected year (<code class="literal">start: 'year'</code>). Since we have configured it to allow a navigation depth into each month (<code class="literal">depth: 'month'</code>) we can click on a month and then see that month and all of its available days:</p><div><img src="img/4346OT_03_02.jpg" alt="Configuring the Calendar widget"/></div><div><div><h3 class="title"><a id="note02"/>Note</h3><p>Even though the current view is "year", today's date is still visible within the footer of the calendar.</p></div></div><p>Speaking of the footer, let's take a look at the data/template properties that the calendar makes available. The<a id="id227" class="indexterm"/> three main properties here are <code class="literal">data</code>, <code class="literal">month</code>, and <code class="literal">footer</code> and they are the primary way to customize the calendar widget. To demonstrate a simple example of customizing specific dates in a calendar, add this code to a page and run it:</p><div><pre class="programlisting">&lt;h2&gt;Calendar&lt;/h2&gt;
&lt;div id="calendar"&gt;
&lt;/div&gt;
&lt;style type="text/css"&gt;
    .specialDay {
        color: white;
        background-color: orange;
        border:1px solid black;
    }
&lt;/style&gt;
&lt;script type="text/x-kendo-template" id="redDays"&gt;
    # if ($.inArray(+data.date, data.dates) != -1) { #
        &lt;div class="specialDay"&gt;#= data.value #&lt;/div&gt;
    # } else { #
        #= data.value #
    # } #
&lt;/script&gt;
&lt;script type="text/javascript"&gt;
    var datesArray = [+new Date(2012, 5, 15), +new Date(2012, 5, 21)];

    $("#calendar").kendoCalendar({
        culture: 'en-US', // specifies the culture
        depth: 'month',    // specifies navigation depth
        max: new Date(2012, 5,31), // latest date calendar can show
        min: new Date(2012, 5, 1), // oldest date calendar can show
        start: 'month',    // specifies the start view
        value: new Date(2012,5,11), // initially selected date
        format: 'yyyy/MM/dd',  // format string used to format the date values
        dates: datesArray,
        month: {
            content: $("#redDays").html(),
            empty: "X"
        },
        footer: "Today is #= kendo.toString(data, 'd') #"
});
&lt;/script&gt;</pre></div><p>Let's step through this code together. First, we have a special style instruction for how special days are to be displayed. In this case, white text on an orange background with a solid black border. <a id="id228" class="indexterm"/>We also specify a Kendo UI template block with JavaScript to determine whether the date being rendered is one of our special days. If it is one of the special days, then we want the custom style applied to it; otherwise just render it as usual.</p><div><pre class="programlisting">&lt;style type="text/css"&gt;
    .specialDay {
        color: white;
        background-color: orange;
        border:1px solid black;
    }
&lt;/style&gt;
&lt;script type="text/x-kendo-template" id="redDays"&gt;
    # if ($.inArray(+data.date, data.dates) != -1) { #
        &lt;div class="specialDay"&gt;#= data.value #&lt;/div&gt;
    # } else { #
        #= data.value #
    # } #
&lt;/script&gt;</pre></div><p>Next, we define the actual configuration of the calendar widget. This is where the relationship between the <code class="literal">month</code> property and the <code class="literal">dates</code> property becomes apparent: the <code class="literal">dates</code> property supplies the data that the <code class="literal">month</code> property uses to render the days on the calendar. In the template that we have defined, we check to see if the current date being rendered is included in the <code class="literal">dates</code> array and then use <code class="literal">data.value</code> to render the number of the date currently executing. Notice also that we have prepended the dates in the <code class="literal">dateArray</code> with a plus sign <code class="literal">+</code> to force them into a numeric date that we can easily compare with <code class="literal">$.inArray()</code>. This is not a requirement in every case, but works for this example.</p><div><pre class="programlisting">&lt;script type="text/javascript"&gt;
    var datesArray = [+new Date(2012, 5, 15), +new Date(2012, 5, 21)];

    $("#calendar").kendoCalendar({
        culture: 'en-US', // specifies the culture
        depth: 'month',    // specifies navigation depth
        max: new Date(2012, 5,31), // latest date calendar can show
        min: new Date(2012, 5, 1), // oldest date calendar can show
        start: 'month',    // specifies the start view
        value: new Date(2012,5,11), // initially selected date
        format: 'yyyy/MM/dd',  // format string used to format the date values
        dates: datesArray,
        month: {
            content: $("#redDays").html(),
            empty: "X"
        },
        footer: "Today is #= kendo.toString(data, 'd') #"
});
&lt;/script&gt;</pre></div><p>The other things to note are the new property called <code class="literal">footer</code> that is used to render a template for the footer <a id="id229" class="indexterm"/>of the calendar, which has access to today's date through the <code class="literal">data</code> property passed to it. Also, note that the <code class="literal">month</code> object has another property called <code class="literal">empty</code> that is used to render dates that fall outside of the <code class="literal">min</code> or <code class="literal">max</code> property value ranges.</p><p>With the calendar set up in this way, it looks like this in the browser:</p><div><img src="img/4346OT_03_03.jpg" alt="Configuring the Calendar widget"/></div><div><div><h3 class="title"><a id="note03"/>Note</h3><p>Note the special display of the dates supplied through the <code class="literal">dateArray</code>, the dates out of range, and the new text used in the footer.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec27"/>Calendar Widget using MVC</h1></div></div></div><p>The <a id="id230" class="indexterm"/>Calendar widget can also be configured through the ASP.NET MVC extension methods. To imitate the calendar we just created, you can replace the contents of your view with this code:</p><div><pre class="programlisting">&lt;h2&gt;Calendar&lt;/h2&gt;
&lt;style type="text/css"&gt;
    .specialDay {
        color: white;
        background-color: orange;
        border:1px solid black;
    }
&lt;/style&gt;
&lt;script type="text/x-kendo-template" id="redDays"&gt;
    # if ($.inArray(+data.date, data.dates) != -1) { #
&lt;div class="specialDay"&gt;#= data.value #&lt;/div&gt;
    # } else { #
        #= data.value #
    # } #
&lt;/script&gt;
&lt;script type="text/javascript"&gt;
    var datesArray = [+new Date(2012, 5, 15), +new Date(2012, 5, 21)];
&lt;/script&gt;
@(Html.Kendo().Calendar()
    .Name("mvcCalendar")
    .Depth(CalendarView.Month)
    .Max(new DateTime(2012, 6, 30))
    .Min(new DateTime(2012, 6, 1))
    .Start(CalendarView.Month)
    .Value(new DateTime(2012, 6, 11))
    .Format("yyyy/MM/dd")
    .MonthTemplate("# if ($.inArray(+data.date, datesArray) != -1) { #" +
                    "&lt;div class='specialDay'&gt;#= data.value #&lt;/div&gt;" +
                    "# } else { #" +
                    "#= data.value #" +
                    "# } #")
    .Footer("Today is #= kendo.toString(data, 'd') #")
    )</pre></div><p>This is the output when using this new code:</p><div><img src="img/4346OT_03_04.jpg" alt="Calendar Widget using MVC"/></div><p>Pretty similar, isn't it? Note that the MVC extension hid the dates below <code class="literal">max</code> and <code class="literal">min</code> and didn't give us an empty<a id="id231" class="indexterm"/> property on the <code class="literal">month</code>. There are a few other unique things to note as well. First, notice that we are still using an array of dates through JavaScript inside the view. This is because the <code class="literal">month</code> template is running in JavaScript, not through MVC extensions, and needs access to this data on the client. Because of this, and because of the fact that the MVC extensions do not provide a <code class="literal">dates</code> property, we have to change the template from using <code class="literal">data.dates</code> to the actual name of the JavaScript array—<code class="literal">datesArray</code>. In this example, I typed out the template code directly into the MVC extension method, but there is also a method called <code class="literal">MonthTemplateId()</code> where you can pass the HTML <code class="literal">id</code> of the template already on the page.</p><p>Also, remember to always call the <code class="literal">.Name()</code> method on every Kendo MVC extension object; it is required for the code to work. This is how the MVC extension methods assign a unique <code class="literal">name</code> and <code class="literal">id</code> attribute to the rendered HTML output, and how all of the JavaScript methods and events are properly wired up in the web browser. If you do not include the <code class="literal">.Name()</code> method, you will also see a runtime error when you try to run the page.</p></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec28"/>Methods available on the Calendar widget</h1></div></div></div><p>The Calendar widget<a id="id232" class="indexterm"/> exposes several methods that can be used to <a id="id233" class="indexterm"/>interact with it on the page. These methods can be used to configure the widget by changing its properties or firing specific functionality in real time. Here is a code form of the available methods specific to the Kendo UI Calendar widget:</p><div><pre class="programlisting">var calendar = $("calendarId").data("kendoCalendar");

// Set a new max date
calendar.max(new Date(2013,11,31));
// Retrieve the current max date
var lastDay = calendar.max();

// Set a new min date
calendar.min(new Date(2011, 11, 31);
// Retrieve the current min date
var oldestDay = calendar.min();

// Navigate to a specific date using a specific view
calendar.navigate(new Date(2012,2,5), "month");

// Navigate down to a lower view (i.e. goes from "year" to "month")
calendar.navigateDown(new Date(2012,6,7)); // date is optional

// Navigate to the future
calendar.navigateToFuture();

// Navigate to the past
calendar.navigateToPast();

// Navigate up to a higher view (i.e. goes from "year" to "decade")
calendar.navigateUp("year");

// Set a new value (selected date) for the calendar
calendar.value(new Date(2012,4,7));

// Get the current value (selected date) of the calendar
var selectedDate = calendar.value();</pre></div><p>Let's take an example of some of these and see it in action on our page. Modify the code we just created for the MVC view like this:</p><div><pre class="programlisting">&lt;h2&gt;Calendar&lt;/h2&gt;
&lt;style type="text/css"&gt;
    .specialDay {
        color: white;
        background-color: orange;
        border:1px solid black;
    }
&lt;/style&gt;
&lt;script type="text/x-kendo-template" id="redDays"&gt;
    # if ($.inArray(+data.date, data.dates) != -1) { #
&lt;div class="specialDay"&gt;#= data.value #&lt;/div&gt;
    # } else { #
        #= data.value #
    # } #
&lt;/script&gt;
&lt;script type="text/javascript"&gt;
    var datesArray = [+new Date(2012, 5, 15), +new Date(2012, 5, 21)];
&lt;/script&gt;
@(Html.Kendo().Calendar()
    .Name("mvcCalendar")
    .Depth(CalendarView.Month).Start(CalendarView.Month)
    .Value(new DateTime(2012, 6, 11))
    .Format("yyyy/MM/dd")
    .MonthTemplate("# if ($.inArray(+data.date, datesArray) != -1) { #" +
                    "&lt;div class='specialDay'&gt;#= data.value #&lt;/div&gt;" +
                    "# } else { #" +
                    "#= data.value #" +
                    "# } #")
    .Footer("Today is #= kendo.toString(data, 'd') #")
    )
&lt;br /&gt;
&lt;button type="button" id="navigateUp"&gt;Navigate Up&lt;/button&gt;&lt;br /&gt;
&lt;button type="button" id="navigateDown"&gt;Navigate Down&lt;/button&gt;&lt;br /&gt;
&lt;button type="button" id="showValue"&gt;Pop-Up Value&lt;/button&gt;
&lt;script type="text/javascript"&gt;
    $("#navigateUp").click(function () {
        var calendar = $("#mvcCalendar").data("kendoCalendar");
        calendar.navigateUp();
    });
    $("#navigateDown").click(function () {
        var calendar = $("#mvcCalendar").data("kendoCalendar");
        calendar.navigateDown(calendar.value());
    });
    $("#showValue").click(function () {
        var calendar = $("#mvcCalendar").data("kendoCalendar");
        alert(calendar.value());
    });
&lt;/script&gt;</pre></div><p>In order to use the calendar widget as a JavaScript object, we have to call the <code class="literal">.data()</code> function on the page element<a id="id234" class="indexterm"/> that contains the calendar that we created. Click the buttons on the page and see what<a id="id235" class="indexterm"/> they do. It should give you some idea of what the calendar widget can offer, and how you could plug your own interactive code into a calendar to improve the user experience.</p><div><img src="img/4346OT_03_05.jpg" alt="Methods available on the Calendar widget"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec29"/>Events fired by the Calendar widget</h1></div></div></div><p>The Kendo UI calendar widget<a id="id236" class="indexterm"/> has two events—<code class="literal">change</code> and <code class="literal">navigate</code>. These <a id="id237" class="indexterm"/>events fire when the action after which they are named occurs. The <code class="literal">Change</code> fires when the selected date is changed, <code class="literal">navigate</code> fires when the calendar is navigated—such as when the month is changed or the view is moved up from "month" to "year".</p><p>What if you wanted the calendar to only appear when a user selected a certain input box on a page, and then place its value into that input element? You could try something like this. Modify the final <code class="literal">script</code> block of the page that we are working on to look like this example:</p><div><pre class="programlisting">&lt;script type="text/javascript"&gt;
    $(function () {
        $("#mvcCalendar").hide();
    });
    $(document).ready(function () {
        $("#mvcCalendar").data("kendoCalendar").bind("change", function (e) {
            var date = $("#mvcCalendar").data("kendoCalendar").value();
            $("#showTheCalendar").val(kendo.toString(date, 'd'));
        });
    });
    $("#showTheCalendar").focusin(function () {
        $("#mvcCalendar").slideDown();
    });
    $("#nameInput").focusin(function () {
        $("#mvcCalendar").slideUp();
    });
    $("#ageInput").focusin(function () {
        $("#mvcCalendar").slideUp();
    });
    $("#navigateUp").click(function () {
        var calendar = $("#mvcCalendar").data("kendoCalendar");
        calendar.navigateUp();
    });
    $("#navigateDown").click(function () {
        var calendar = $("#mvcCalendar").data("kendoCalendar");
        calendar.navigateDown(calendar.value());
    });
    $("#showValue").click(function () {
        var calendar = $("#mvcCalendar").data("kendoCalendar");
        alert(calendar.value());
    });
&lt;/script&gt;</pre></div><p>Here we have some events, wired up by simple jQuery and jQuery UI, that show or hide the calendar and take<a id="id238" class="indexterm"/> its value when selected. The <code class="literal">change</code> event of the calendar is used to determine when to place the new date value into the input element of the page. This is how the page appears when first rendered.</p><div><img src="img/4346OT_03_06.jpg" alt="Events fired by the Calendar widget"/></div><p>The calendar is hidden until the user clicks into the first textbox. As soon as that happens, the events we wired up cause the calendar to appear so that the use can select the appropriate date for the page.</p><div><img src="img/4346OT_03_07.jpg" alt="Events fired by the Calendar widget"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec30"/>Summary</h1></div></div></div><p>The Kendo UI calendar widget is easy to configure, and offers a rich element on your page that can make working with dates a much simpler task. It can be configured from either JavaScript or MVC extensions and makes use of Kendo templates for highly customizable formatting and display. I have only shown basic examples of what can be done with the templates and events; you can take these and run with them to create some very useful interactive content.</p><p>In the next chapter we will learn about one of the most powerful features of the Kendo UI framework of all, the Model-View-ViewModel (MVVM) framework. This framework lets you bind data and functionality to your page through simple HTML attributes and enable real-time changes to your data, or to a server, with immediate feedback for the user. The MVVM framework is a great tool that you will want to use in all of your pages.</p></div></body></html>