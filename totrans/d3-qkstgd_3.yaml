- en: Building an Interactive Scatter Plot
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let's pretend we've started jogging and we want to visualize the data regarding
    our progress as a runner, with a scatter plot. We're going to have an array of
    objects, each with a date and distance properties. For each object in the array,
    we're going to create a circle in our SVG. If the `distance` property of an object
    is relatively high, its associated circle will be higher up on the graph. If the
    `date` property of an object is relatively high (a later date), its associated
    circle will be farther right.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
- en: 'By the end of this lesson, you should be able to do the following:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: Add a link to the D3 library
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Add an`<svg>`tag and size it with D3
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create some fake data for our app
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Add SVG circles and style them
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a linear scale
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Attach data to visual elements
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use data attached to a visual element to affect its appearance
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a time scale
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Parse and format times
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Set dynamic domains
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dynamically generate SVG elements
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create axes
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Display data in a table
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The complete code for this section can be found here: [https://github.com/PacktPublishing/D3.js-Quick-Start-Guide/tree/master/Chapter03](https://github.com/PacktPublishing/D3.js-Quick-Start-Guide/tree/master/Chapter03).'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: Adding a link to the D3 library
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The first thing we want to do is create a basic `index.html` file:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Now add a link to D3 at the bottom of your `<body>` tag in `index.html`. We''ll
    put it at the bottom so that the script loads after all your other HTML elements
    have loaded into the browser:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Now create `app.js` in the same folder as your `index.html`. In it, we will
    store all of our JS code. For now, just put this code in it to see whether it
    works:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Link to it in `index.html` at the bottom of the `<body>` tag. Make sure it
    comes after the D3 script tag so that D3 loads before your `app.js` script:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Open `index.html` in Chrome just as we did in [Chapter 2](f40fadd5-f40b-43dc-a82d-206aac322123.xhtml),
    *Using SVG to Create Images Using Code*, (**File** | **Open File**), and check
    your Dev Tools (**View** | **Developer** | **Developer tools**) to see whether
    your JavaScript files are linked correctly:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/45970fd8-68f3-4156-bf2f-70e8a9b48b1c.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
- en: Adding an<svg>tag and sizing it with D3
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In `<indexentry content=" tag:sizing, with D3">` the `index.html`, at the top
    of `<body>`, before `<indexentry content=" tag:adding">` your script tags, add
    an `<svg>` tag:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'If we examine the **Elements** tab of our dev tools, we''ll `<indexentry content="
    tag:adding">` see the `svg` element has `<indexentry content=" tag:sizing, with
    D3">` been placed. In Chrome, it has a default width/height of 300 px/150 px:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/87f192b1-16cf-4835-a11d-30160d13d466.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
- en: 'In `app.js`, remove your previous `console.log` statements and create variables
    to hold the width and height of the `<svg>` tag:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Next, we can use `d3.select()` to select a single element, in this case the
    `<svg>` element:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The return value of `d3.select(''svg'')` is a D3 version of the svg element
    (as in jQuery), so we can chain commands onto this. Let''s add some styling to
    adjust the height/width of the element:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Now, when we check the dev tools, we''ll see the `<svg>` element has been resized:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/96cba3c4-fabf-4d03-9708-d0d978fd01e9.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
- en: Creating some fake data for our app
  id: totrans-41
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In `app.js`, let''s create an array of `run` objects, I am storing the date
    as a string on purpose also, it''s important that this is an array of objects,
    to work with D3). Here''s what your `app.js` code should look like so far:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Adding SVG circles and styling them
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In `index.html`, add three circles to your `<svg>` element (each one will represent
    a run):'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Create `app.css` in the same folder as `index.html`, with some styling for
    the circles and our `svg` element:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Link to it in the head of `index.html`:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Our page should now look as follows:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/256cdb29-f354-48d4-a6c7-f5025e279b3b.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
- en: Creating a linear scale
  id: totrans-53
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We currently have three circles in our SVG and three objects in our `runs` array.
    One of the best things D3 does is provide the ability to link SVG elements with
    data so that as the data changes so do the SVG elements. In this chapter, we're
    going to link each circle to an object in the `runs` array. If the `distance`
    property of an object is relatively high, its associated circle will be higher
    up on the graph. If the `date` property of an object is relatively high (a later
    date), its associated circle is farther right.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: First, let's position the circles vertically, based on the `distance` property
    of the objects in our `runs` array. One of the most important things that D3 does
    is provide the ability to convert (or `map`) data values to visual points and
    vice versa. It does so using a `scale`. There are lots of different kinds of scales
    that handle lots of different data types, but for now we're just going to use
    a `linear scale`, which will map numeric data values to numeric visual points,
    and vice versa.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: 'At the bottom of `app.js`, add the following:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Whenever we create a scale, we need to tell it the minimum and maximum possible
    values that can exist in our data (this is called the `domain`). To do so for
    our `yScale`, add the following to the bottom of `app.js`:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'We also need to tell the scale what visual values correspond to those min/max
    values in the data (this is called the `range`). To do so, add the following to
    the bottom of `app.js`:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Your last three lines of code in `app.js` should now look as follows:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'In the previous snippet, the first (starting) value for the range is `HEIGHT`
    (600) and the second (ending) value is 0\. The minimum for the data values is
    0 and the max is 10\. By doing this, we''re saying that a data point (distance
    run) of 0 should map to a visual height value of `HEIGHT` (600):'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b60104e3-ce39-4a3d-b84d-0b15931fe714.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
- en: This is because the lower the distance run (data value), the more we want to
    move the visual point down the *y* axis. Remember that the *y* axis starts with
    0 at the top and increases in value as we move down vertically on the screen.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: 'We also say that a data point (distance run) of 10 should map to a visual height
    of 0:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ec87518e-3736-41cc-80a4-f3dba371424d.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
- en: Again, this is because, as the distance run increases, we want to get back a
    visual value that is lower and lower so that our circles are closer to the top
    of the screen.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: 'If you ever need to remind yourself what the domain/range is, you can do so
    by logging `yScale.domain()` or `yScale.range()`. Temporarily add the following
    at the bottom `app.js`:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Our Chrome console should look as follows:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/09e09dd5-9765-4dcf-b00a-9aafb3681bcd.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
- en: 'When declaring the range/domain of a linear scale, we only need to specify
    start/end values for each. Values in between the start/end will be calculated
    by D3\. For instance, to find out what visual value corresponds to the distance
    value of 5, use `yScale()`. Remove the previous two `console.log()` statements
    and add the following to the bottom of `app.js`:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Here''s what our dev console should look like in Chrome:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ea310230-6299-4cbf-a70e-e7ff2fbd796d.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
- en: It makes sense that this logs `300` because the data value of `5` is half way
    between the minimum data value of `0` and the maximum data value of `10`. The
    range starts at `HEIGHT` (600) and goes to `0`, so halfway between those values
    is 300.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: 'So, whenever you want to convert a data point to a visual point, call `yScale()`.
    We can go the other way and convert a visual point to a data value by calling
    `yScale.invert()`. To find out what data point corresponds to a visual value of
    450, remove the previous `console.log()` statement and add the following to the
    bottom of `app.js`:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Here''s what Chrome''s console looks like:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/8c887bf3-a317-481c-8e56-acc4bfa6639f.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
- en: It makes sense that this logs `2.5` because the visual value of 450 is 25% of
    the way from the starting visual value of 600 (`HEIGHT`)to the ending visual value
    of `0`. You can now delete that last `console.log()` line.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: Attaching data to visual elements
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Now let''s attach each of the JavaScript objects in our `runs` array to a circle
    in our SVG. Once we do this, each circle can access the data of its associated
    `run` object to determine its position. Add the following to the bottom of `app.js`:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: If there were more objects in our `runs` array than there are circles, the extra
    objects are ignored. If there are more circles than objects, then JavaScript objects
    are attached to circles in the order in which they appear in the DOM until there
    are no more objects to attach.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
- en: Use data attached to a visual element to affect its appearance
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We can change attributes for a selection of DOM elements by passing static
    values, and all selected elements will have that attribute set to that one specific
    value. Add the following temporarily to the end of `app.js`:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The following should be seen on your screen:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/699f8f2c-89e5-4ffe-96a8-f81e7ade4939.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
- en: 'But now that each circle has one of our `runs` JavaScript data objects attached
    to it, we can set attributes on each circle using that data. We do that by passing
    the `.attr()` method a callback function instead of a static value for its second
    parameter. Remove `d3.selectAll(''circle'').attr(''cy'', 300);` and adjust the
    last line of `app.js` from `d3.selectAll(''circle'').data(runs);` to the following:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'If we refresh the browser, this is what we should see:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/a7dca9d4-aa18-47d5-93c1-8809a5fdfb95.png)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
- en: Let's examine what we just wrote. The callback function passed as the second
    parameter to `.attr()` runs on each of the visual elements selected (each of the
    `circle` elements in this case). During each execution of the callback, the return
    value of that callback function is then assigned to whatever aspect of the current
    element is being set (in this case the `cy` attribute).
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
- en: 'The callback function takes two params:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
- en: The individual `datum` object from the `runs` array that was attached to that
    particular visual element when we called `.data(runs)`
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `index` of that `datum` in the`runs` array
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In summary, what this does is loop through each `circle` in the SVG. For each
    `circle`, it looks at the `run` object attached to that `circle` and finds its
    `distance` property. It then feeds that data value into `yScale()`, which then
    converts it into its corresponding visual point. That visual point is then assigned
    to that circle's `cy` attribute. Since each data object has a different `distance`
    value, each `circle` is placed differently, vertically.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
- en: Creating a time scale
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Let''s position the circles horizontally, based on the date that their associated
    run happened. First, create a time scale. This is like a linear scale, but instead
    of mapping numeric values to visual points, it maps dates to visual points. Add
    the following to the bottom of `app.js`:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Here''s what our console should look like:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/6141d754-75a9-47bb-9594-8db2b41dd0f9.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
- en: You can now remove the two `console.log()` statements.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: Parsing and formatting times
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Note that the `date` properties of the objects in our `runs` array are strings
    and not date objects. This is a problem because `xScale`, as with all time scales,
    expects its data values to be date objects. Fortunately, D3 provides us an easy
    way to convert strings to dates and vice versa. We''ll use a specially formatted
    string, based on the documentation ([https://github.com/d3/d3-time-format#locale_format](https://github.com/d3/d3-time-format#locale_format)),
    to tell D3 how to parse the `date` string properties of the objects in our `runs`
    array into actual JavaScript date objects. Add the following at the end of `app.js`:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Here''s our Chrome console:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d423b3e5-d578-4b72-89c7-181d4ca448a6.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
- en: 'Let''s use this when calculating `cx` attributes for our circles. Remove the
    last two `console.log()` statements, and add the following to the bottom of `app.js`:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Here''s what Chrome should look like:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/669b1c8e-9a20-4c67-b62c-037eb47a57f8.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
- en: In summary, this selects all of the `circle` elements. It then sets the `cx`
    attribute of each `circle` to the result of a callback function. That callback
    function runs for each `circle` and takes the `run` data object associated with
    that `circle` and finds its `date` property (remember it's a string, for example,
    `'October 3, 2017 at 6:00PM'`). It passes that string value to `parseTime()` which
    then turns the string into an actual JavaScript date object. That date object
    is then passed to `xScale()`, which converts the date into a visual value. That
    visual value is then used for the `cx` attribute of whichever `circle` the callback
    function has just run on. Since each `date` property of the objects in the `runs`
    array is different, the `circles` have different horizontal locations.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: Setting dynamic domains
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: At the moment, we're setting arbitrary min/max values for the domains of both
    distance and date. D3 can find the min/max of a dataset, so that our graph displays
    just the data ranges we need. All we need to do is pass the min/max methods a
    callback that gets called for each item of data in the `runs` array. D3 uses the
    callback to determine which properties of the datum object to compare for min/max.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: 'Go to this part of the code:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Change it to this:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Chrome should look as follows:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/478f937b-f01f-4ef9-ad53-8b66bd233768.png)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
- en: 'Let''s examine what we just wrote. The following code finds the minimum distance:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: D3 loops through the `runs` array (the first parameter) and calls the callback
    function (the second parameter) on each element of the array. The return value
    of that function is compared the return values of the callback function as it
    runs on the other elements. The lowest value is assigned to `yMin`. The same thing
    happens for `d3.max()` but with the highest value.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
- en: 'We can combine both the min/max functions into one `extent` function that returns
    an array that has the exact same structure as`[yMin, yMax]`. Let''s look at the
    code we just wrote:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Change the previous code to this:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'It''s much shorter, right? Let''s do the same for the xScale''s domain. Go
    to this part of the code:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Change it to this:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Notice we moved `parseTime` and `formatTime` up so they could be used within
    the `.extent()`. Here''s what Chrome should look like:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/bab5bea3-f40d-4990-85dc-98cc8620c3eb.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
- en: Dynamically generating SVG elements
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Currently, we have just enough `<circle>` elements to fit our data. What if
    we don''t want to count how many elements are in the array? D3 can create elements
    as needed. First, remove all `<circle>` elements from `index.html`. Your `<body>`
    tag should now look as follows:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'In `app.js`, go to this part of the code:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE33]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Modify the code to create the circles:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'It should look exactly the same as before, but now circles are being created
    for each object in the `runs` array:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/db7816e0-542e-4435-9e8e-d6231c750d0b.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
- en: 'Here''s a more in-depth explanation of what we just wrote. Take a look at the
    first line of the new code:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE35]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: This might seem unnecessary. Why not just do `d3.selectAll('circle')`? Well,
    at the moment, there are no `circle` elements. We're going to be appending `circle`
    elements dynamically, so `d3.select('svg')` tells D3 where to append them. We
    still need `.selectAll('circle')` though, so that when we call `.data(runs)` on
    the next line, D3 knows what elements to bind the various objects in the `runs`
    array to. But there aren't any `circle` elements to bind data to. That's OK.`.enter()`
    finds the `run` objects that haven't been bound to any `circle` elements yet (in
    this case all of them). We then use `.append('circle')` to append a circle for
    each unbound `run` object that `.enter()` found.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: Creating axes
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'D3 can automatically generate axes for you. Add the following to the bottom
    of`app.js`:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE36]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'This creates a bottom axis generator that can be used to insert an axis into
    any element you choose. Add the following code to the bottom of `app.js` to append
    a `<g>` element inside our SVG element and then insert a bottom axis inside it:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE37]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'Here''s what Chrome should look like:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f285b8a3-8fec-45d2-aeb3-05745e70867f.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
- en: Display of Chrome
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
- en: 'We want the axis to be at the bottom of the SVG, though. Modify the code we
    just wrote so it looks like this (note: we removed a`;` after`.call(bottomAxis)`
    and added`.attr(''transform'', ''translate(0,''+HEIGHT+'')'');`):'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE38]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Currently, our SVG clips the axis:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/5669c90a-9f8c-412c-9e94-004749f69f0b.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
- en: 'Let''s alter our `svg` CSS so it doesn''t clip any elements that extend beyond
    its bounds:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE39]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Now it looks good:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/dbf37e37-8453-47d8-96d2-e3320942021b.png)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
- en: 'The left axis is pretty similar. Add the following to the bottom of `app.js`:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE40]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'Note: we don''t need to set a `transform` attribute, since it starts out in
    the correct place initially:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b2446c71-3c12-42e3-adeb-9e6e89b8edda.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
- en: 'It''s a little tough to see, so let''s add the following at the bottom of `app.css`:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE41]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'Now our axes are complete:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/79d82b84-83f6-42ee-a839-a10577191e0e.png)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
- en: Displaying data in a table
  id: totrans-175
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Just for debugging purposes, let''s create a table that will show all of our
    data. Make your `<body>` tag in `index.html` look as follows:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE42]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'D3 can also be used to manipulate the DOM, just like jQuery. Let''s populate
    the`<tbody>`in that style. Add the following to the bottom of `app.js`:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE43]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'Add some styling for the table at the bottom of `app.css`:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE44]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Adjust the CSS for `svg` to add a bottom margin. This will create some space
    between the graph and the table:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE45]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'Now the browser should look like this:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f6ad7a6c-7b35-417a-a97b-a3b7008c7863.png)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
- en: Summary
  id: totrans-186
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: At this point, you have a static scatter plot and a table that displays its
    data. In [Chapter 4](e503bfe5-4b90-47eb-bae0-d588a9b545d5.xhtml), *Making a Basic
    Scatter Plot Interactive*, we will be learning how to make it interactive.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，你有一个静态的散点图和一个显示其数据的表格。在[第4章](e503bfe5-4b90-47eb-bae0-d588a9b545d5.xhtml)，《制作基本散点图交互式》中，我们将学习如何使其交互式。
