<html><head></head><body>
<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch01" class="calibre1"/>Chapter 1. Getting Started with Meteor</h1></div></div></div><p class="calibre7">Meteor<a id="id0" class="calibre1"/> is a framework that is essentially fast for the purpose of development even if you program at a slow pace. The aim of this book is to increase your development speed and improve quality. There are two key ingredients required to improve development: compilers and patterns. Compilers add functionality to your coding language, while patterns increase the speed at which you solve common programming issues.</p><p class="calibre7">This book will mostly cover patterns, but we'll use this chapter to quick start compilers and understand how they relate to Meteor—a vast but simple topic. The compilers that we will look at are as follows:</p><div><ul class="itemizedlist"><li class="listitem">CoffeeScript</li><li class="listitem">Jade</li><li class="listitem">Stylus</li></ul></div><p class="calibre7">We will review some basic knowledge you should have about Meteor. This will cover the following:</p><div><ul class="itemizedlist"><li class="listitem">Templates, helpers, and events</li><li class="listitem">The event loop and the merge box</li><li class="listitem">The must-have packages</li><li class="listitem">Folder structure</li></ul></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_1"><a id="ch01lvl1sec08" class="calibre1"/>CoffeeScript for Meteor</h1></div></div></div><p class="calibre7">CoffeeScript<a id="id1" class="calibre1"/> is a compiler for <a id="id2" class="calibre1"/>JavaScript that adds "syntactic sugar" inspired by Ruby, Python, and Haskell; it effectively makes the writing of JavaScript easier and more readable. CoffeeScript simplifies the syntax of functions, objects, arrays, logical statements, binding, managing scope, and much more. All CoffeeScript files are saved with a <code class="email">.coffee</code> extension. We will cover functions, objects, logical statements, and bindings as these are some of the most commonly used features.</p></div></div>

<div><div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch01lvl2sec07" class="calibre1"/>Objects and arrays</h2></div></div></div><p class="calibre7">CoffeeScript gets rid of curly <a id="id3" class="calibre1"/>braces (<code class="email">{}</code>), semicolons (<code class="email">;</code>), and commas (<code class="email">,</code>). This<a id="id4" class="calibre1"/> alone saves you from repeating unnecessary strokes on the keyboard. Instead, CoffeeScript emphasizes on the proper use of <a id="id5" class="calibre1"/>
<strong class="calibre2">tabbing</strong>. Tabbing will not only make your code more readable, but it will be a key factor in making the code work as well. In fact, you are probably already tabbing the right way! Let's look at some examples:</p><div><pre class="programlisting">
<strong class="calibre2">#COFFEESCRIPT</strong>
toolbox =
  hammer:true
  flashlight:false</pre></div><div><h3 class="title2"><a id="tip02" class="calibre1"/>Tip</h3><p class="calibre7">
<strong class="calibre2">Downloading the example code</strong>
</p><p class="calibre7">You can download the example code files from your account at <a class="calibre1" href="http://www.packtpub.com">http://www.packtpub.com</a> for all the Packt Publishing books you have purchased. If you purchased this book elsewhere, you can visit <a class="calibre1" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div><p class="calibre7">Here, we are creating an object named <code class="email">toolbox</code> that contains two keys: <code class="email">hammer</code> and <code class="email">flashlight</code>. The equivalent in JavaScript will be this:</p><div><pre class="programlisting">
<strong class="calibre2">//JAVASCRIPT - OUTPUT</strong>
var toolbox = {
  hammer:true,
  flashlight:false
};</pre></div><p class="calibre7">Much easier! As you can see, we have to <strong class="calibre2">tab</strong>
<a id="id6" class="calibre1"/> to indicate that both the <code class="email">hammer</code> and <code class="email">flashlight</code> properties are a part of <code class="email">toolbox</code>. The <code class="email">var</code> word is not allowed in CoffeeScript because CoffeeScript automatically applies it for you. Let's have a look at how we would make an array:</p><div><pre class="programlisting">
<strong class="calibre2">#COFFEESCRIPT</strong>
drill_bits = [
  "1/16 in"
  "5/64 in"
  "3/32 in"
  "7/64 in"
]

<strong class="calibre2">//JAVASCRIPT – OUTPUT</strong>
var drill_bits;
drill_bits = ["1/16 in","5/64 in","3/32 in","7/64 in"];</pre></div><p class="calibre7">Here, we can see <a id="id7" class="calibre1"/>that we don't need to have any commas, but we do need <a id="id8" class="calibre1"/>to have brackets to determine that this is an array.</p></div></div></div>

<div><div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch01lvl2sec08" class="calibre1"/>Logical statements and operators</h2></div></div></div><p class="calibre7">CoffeeScript removes a lot of <a id="id9" class="calibre1"/>parenthesis (<code class="email">()</code>) in logical statements and<a id="id10" class="calibre1"/> functions as well. This makes the logic of the code much easier to understand at first glance. Let's look at an example:</p><div><pre class="programlisting">
<strong class="calibre2">#COFFEESCRIPT</strong>
rating = "excellent" if five_star_rating

<strong class="calibre2">//JAVASCRIPT – OUTPUT</strong>
var rating;

if(five_star_rating){
  rating = "excellent";
}</pre></div><p class="calibre7">In this example, we can clearly see that CoffeeScript is easier to read and write. CoffeeScript effectively replaces the entire <strong class="calibre2">implied parenthesis</strong>
<a id="id11" class="calibre1"/> in any logical statement.</p><p class="calibre7">Operators such as <code class="email">&amp;&amp;</code>, <code class="email">||</code>, and <code class="email">!==</code> are replaced by words to make the code more readable. Here is a list of the <a id="id12" class="calibre1"/>operators that you will be using the <a id="id13" class="calibre1"/>most:</p><div><table border="1" class="calibre12"><colgroup class="calibre13"><col class="calibre14"/><col class="calibre14"/></colgroup><thead class="calibre15"><tr class="calibre16"><th valign="bottom" class="calibre17">
<p class="calibre18">CoffeeScript</p>
</th><th valign="bottom" class="calibre17">
<p class="calibre18">JavaScript</p>
</th></tr></thead><tbody class="calibre19"><tr class="calibre16"><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">is</code>
</p>
</td><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">===</code>
</p>
</td></tr><tr class="calibre16"><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">isnt</code>
</p>
</td><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">!==</code>
</p>
</td></tr><tr class="calibre16"><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">not</code>
</p>
</td><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">!</code>
</p>
</td></tr><tr class="calibre16"><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">and</code>
</p>
</td><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">&amp;&amp;</code>
</p>
</td></tr><tr class="calibre16"><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">or</code>
</p>
</td><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">||</code>
</p>
</td></tr><tr class="calibre16"><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">true, yes, on</code>
</p>
</td><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">true</code>
</p>
</td></tr><tr class="calibre16"><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">false, no, off</code>
</p>
</td><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">false</code>
</p>
</td></tr><tr class="calibre16"><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">@, this</code>
</p>
</td><td valign="top" class="calibre20">
<p class="calibre18">
<code class="literal">this</code>
</p>
</td></tr></tbody></table></div><p class="calibre7">Let's look at a slightly more complex logical statement and see how it is compiled:</p><div><pre class="programlisting">
<strong class="calibre2">#COFFEESCRIPT</strong>
# Suppose that "this" is an object that represents a person and their physical properties

if @eye_color is "green"
  retina_scan = "passed"
else
  retina_scan = "failed"

<strong class="calibre2">//JAVASCRIPT - OUTPUT</strong>
if(this.eye_color === "green"){
  retina_scan = "passed";
} else {
  retina_scan = "failed";
}</pre></div><p class="calibre7">Notice how the context of <code class="email">this</code> is passed to the <code class="email">@</code> symbol without the need for a period, making <code class="email">@eye_color</code> equal to <code class="email">this.eye_color</code>.</p></div></div></div>

<div><div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch01lvl2sec09" class="calibre1"/>Functions</h2></div></div></div><p class="calibre7">A JavaScript function is a block of code designed to perform a particular task. JavaScript has a couple of ways of creating functions<a id="id14" class="calibre1"/> that are simplified in CoffeeScript. They look like this:</p><div><pre class="programlisting">
<strong class="calibre2">//JAVASCRIPT</strong>
//Save an anonymous function onto a variable
var hello_world = function(){
  console.log("Hello World!");
}

//Declare a function
function hello_world(){
  console.log("Hello World!");
}</pre></div><p class="calibre7">CoffeeScript uses <code class="email">-&gt;</code> instead of the <code class="email">function()</code> keyword. The following example outputs a <code class="email">hello_world</code> function:</p><div><pre class="programlisting">
<strong class="calibre2">#COFFEESCRIPT</strong>
#Create a function
hello_world = -&gt;
  console.log "Hello World!"

<strong class="calibre2">//JAVASCRIPT - OUTPUT</strong>
var hello_world;
hello_world = function(){
  return console.log("Hello World!");
}</pre></div><p class="calibre7">Once again, we will use a tab to specify the contents of the function so that there is no need for curly braces (<code class="email">{}</code>). This means that you have to make sure that you have the entire logic of the function tabbed under its namespace.</p><p class="calibre7">What about our parameters? We can use <code class="email">(p1,p2) -&gt;</code> where <code class="email">p1</code> and <code class="email">p2</code> are parameters. Let's make our <code class="email">hello_world</code> function output our name:</p><div><pre class="programlisting">
<strong class="calibre2">#COFFEESCRIPT</strong>
hello_world = (name) -&gt;
  console.log "Hello #{name}"

<strong class="calibre2">//JAVSCRIPT – OUTPUT</strong>
var hello_world;
hello_world = function(name) {
  return console.log("Hello " + name);
}</pre></div><p class="calibre7">In this example, we can see how parameters are placed inside parentheses. We are also doing <a id="id15" class="calibre1"/>
<strong class="calibre2">string interpolation</strong>. CoffeeScript allows the programmer to easily add logic to a string by escaping the string with <code class="email">#{}</code>. Also notice that, unlike JavaScript, you <a id="id16" class="calibre1"/>do not have to return anything at the end of the function, CoffeeScript automatically returns the output of the last command.</p></div></div></div>

<div><div><div><div><div><div><h2 class="title1" id="calibre_pb_5"><a id="ch01lvl2sec10" class="calibre1"/>Binding</h2></div></div></div><p class="calibre7">In Meteor, we will often find<a id="id17" class="calibre1"/> ourselves using the properties of <code class="email">this</code> within nested functions and callbacks. <strong class="calibre2">Function binding</strong>
<a id="id18" class="calibre1"/> is very useful for these types of cases and helps to avoid saving data in additional variables. Function binding sets the value of the <code class="email">this</code> object inside the function to the value of <code class="email">this</code> outside the function. Let's look at an example:</p><div><pre class="programlisting">
<strong class="calibre2">#COFFEESCRIPT</strong>
# Let's make the context of this equal to our toolbox object
# this =
#   hammer:true
#   flashlight:false

# Run a method with a callback
Meteor.call "use_hammer", -&gt;
  console.log this</pre></div><p class="calibre7">In this case, the <code class="email">this</code> object will return a top-level object such as the browser window. This is not useful at all. Let's bind <code class="email">this</code> now:</p><div><pre class="programlisting">
<strong class="calibre2">#COFFEESCRIPT</strong>
# Let's make the context of this equal to our toolbox object
# this =
#   hammer:true
#   flashlight:false

# Run a method with a callback
Meteor.call "use_hammer", =&gt;
  console.log this</pre></div><p class="calibre7">The key difference is the use of <code class="email">=&gt;</code> instead of the expected <code class="email">-&gt;</code> to define the function. Using <code class="email">=&gt;</code> will make the callback's <code class="email">this</code> object equal to the context of the executing function. The resulting compiled script is as follows:</p><div><pre class="programlisting">
<strong class="calibre2">//JAVASCRIPT</strong>
Meteor.call("use_hammer", (function(_this) {
  return function() {
    return Console.log(_this);
  };
})(this));</pre></div><p class="calibre7">CoffeeScript will <a id="id19" class="calibre1"/>improve your coding quality and speed. Still, <em class="calibre11">CoffeeScript is not flawless</em>. When you start combining functions with nested arrays, things can get complex and difficult to read, especially when the functions are constructed with multiple parameters. Let's look at a common query that does not look as readable as you would expect it to be:</p><div><pre class="programlisting">
<strong class="calibre2">#COFFEESCRIPT</strong>
People.update
  sibling:
    $in:["bob","bill"]
,
  limit:1
  -&gt;
    console.log "success!"</pre></div><p class="calibre7">This collection query is passing three parameters: the <code class="email">filter</code> object, the <code class="email">options</code> object, and the callback function. To differentiate between the first two objects, we had to place a comma at the same level as the function and then, indent the second parameter. This is unwieldy, but we can use variables in order to make the query more readable:</p><div><pre class="programlisting">
<strong class="calibre2">#COFFEESCRIPT</strong>
filter =
  sibling:
    $in:["bob","bill"]
options =
  limit:1
People.update filter, options, -&gt;
  console.log "success!"</pre></div><p class="calibre7">Go to <a class="calibre1" href="http://coffeescript.org">coffeescript.org</a> and play around with the language by clicking on the "try coffeescript" link.</p></div></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch01lvl1sec09" class="calibre1"/>Jade for Meteor</h1></div></div></div><p class="calibre7">Jade <a id="id20" class="calibre1"/>works much like <a id="id21" class="calibre1"/>CoffeeScript but it is used for HTML instead. I recommend that you install the <code class="email">mquandalle:jade</code> package. All the Jade files are saved with a <code class="email">.jade</code> extension. This section will cover the most used aspects of Jade in Meteor such as HTML tags, components, and helpers.</p></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch01lvl2sec11" class="calibre1"/>HTML tags</h2></div></div></div><p class="calibre7">Much like CoffeeScript, Jade is a language <a id="id22" class="calibre1"/>that depends heavily on tabbing. When you want to add children to an HTML tag, you simply use tab. Tag IDs and classes can be added using the CSS selector notation (<code class="email">'input#name.first'</code>). This means classes are expressed with a dot (<code class="email">.</code>) and IDs are expressed with a pound (<code class="email">#</code>). Let's look at an example:</p><div><pre class="programlisting">
<strong class="calibre2">//- JADE</strong>
div#container
  ul.list
    li(data-bind="clickable") Click me!

<strong class="calibre2">&lt;!-- HTML – OUTPUT --&gt;</strong>
&lt;div id="container"&gt;
  &lt;ul class="list"&gt;
    &lt;li data-bind="clickable"&gt;Click me!&lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;</pre></div><p class="calibre7">As you can see, <strong class="calibre2">special</strong> attributes<a id="id23" class="calibre1"/> such as <code class="email">data-bind</code> are added with parenthesis. Symbols such as <code class="email">&lt;</code>, <code class="email">&gt;</code>, and <strong class="calibre2">closures</strong>
<a id="id24" class="calibre1"/> are not required anymore. In this example, we have a <code class="email">div</code> tag with an <code class="email">id</code> attribute of <code class="email">"container"</code>, a <code class="email">ul</code> tag with a <code class="email">class</code> attribute of list, and a <code class="email">li</code> tag with a special attribute of <code class="email">data-bind</code>.</p><p class="calibre7">You will find yourself using special attributes often for the <code class="email">input</code> tags to add <code class="email">value</code>, <code class="email">placeholder</code>, and other attributes.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch01lvl2sec12" class="calibre1"/>Templates and components</h2></div></div></div><p class="calibre7">Meteor templates<a id="id25" class="calibre1"/> are Jade<a id="id26" class="calibre1"/> components. In Meteor, we define a template with the template tag and apply the special <code class="email">name</code> attribute to create a reusable HTML block. In Jade, when we create a template, we create a component as well. This looks as follows:</p><div><pre class="programlisting">
<strong class="calibre2">//- JADE</strong>
template(name="landing")
  h3 Hello World!

<strong class="calibre2">&lt;!-- HTML – OUTPUT --&gt;</strong>
&lt;template name="landing"&gt;
  &lt;h3&gt;Hello World!&lt;/h3&gt;
&lt;/template&gt;</pre></div><p class="calibre7">Now we can use this template as a Jade component anywhere in our views. To call a Jade component, you simply prepend a plus sign to the name of the template. Let's look at an example where we want to place a <code class="email">landing</code> page inside a <code class="email">main_layout</code> page:</p><div><pre class="programlisting">
<strong class="calibre2">//- JADE</strong>
template(name="landing")
  h3 Hello World!

template(name="main_layout")
  +landing

<strong class="calibre2">&lt;!-- HTML – OUTPUT --&gt;</strong>
&lt;template name="landing"&gt;
  &lt;h3&gt;Hello World!&lt;/h3&gt;
&lt;/template&gt;

&lt;template name="main_layout"&gt;
  {{&gt; landing}}
&lt;/template&gt;</pre></div><p class="calibre7">That's it! Notice <a id="id27" class="calibre1"/>that we have prepended the plus (<code class="email">+</code>) sign to the name of the template to <a id="id28" class="calibre1"/>call it. This is equivalent to using <code class="email">{{&gt; landing}}</code> in SpaceBars (Meteor's version of Handlebars). Components can have parameters as well, which can be later used in the templates' instance. Let's make our example output someone's name:</p><div><pre class="programlisting">
<strong class="calibre2">//- JADE</strong>
template(name="landing")
  h3 Hello {{name}}

template(name="main_layout")
  +landing(name="Mr Someone")

<strong class="calibre2"># COFFEESCRIPT</strong>
Template.landing.helpers
  "name": -&gt;
    Template.instance().data.name

<strong class="calibre2">&lt;!-- HTML – OUTPUT --&gt;</strong>
&lt;template name="landing"&gt;
  &lt;h3&gt;Hello {{name}}&lt;/h3&gt;
&lt;/template&gt;

&lt;template name="main_layout"&gt;
  {{&gt; landing name="Mr Someone"}}
&lt;/template&gt;</pre></div><p class="calibre7">Adding<a id="id29" class="calibre1"/> attributes to your templates can make your templates flexible as shown in the <a id="id30" class="calibre1"/>preceding example. Still, it is unlikely that you will have to use this as templates "soak up" data from their parent context.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch01lvl2sec13" class="calibre1"/>Helpers</h2></div></div></div><p class="calibre7">Helpers in <a id="id31" class="calibre1"/>Meteor are functions that return data before rendering to the view. We use helpers for iteration, logical statements, and variables. The two basic helpers are <code class="email">each</code> and <code class="email">if</code>, but adding the <code class="email">raix:handlebar-helpers</code> package will add a dictionary of other useful helpers to keep your code from repeating. Let's have a look at how we can use our helpers:</p><div><pre class="programlisting">
<strong class="calibre2">//- JADE</strong>
template(name="list_of_things")
  each things
    if selected
      p.selected {{name}}
    else
      p {{name}}

<strong class="calibre2">&lt;!-- HTML – OUTPUT --&gt;</strong>
&lt;template name="list_of_things"&gt;
  {{#each things}}
    {{#if selected}}
      &lt;p class="selected"&gt;{{name}}&lt;/p&gt;
    {{else}}
      &lt;p&gt;{{name}}&lt;/p&gt;
    {{/if}}
  {{/each}}
&lt;/template&gt;</pre></div><p class="calibre7">In this example, the <code class="email">each</code> helper is iterating through the return value of another helper named <code class="email">things</code> and if the <code class="email">selected</code> helper resolves to <code class="email">true</code>, then we will render <code class="email">p.selected</code> with the <code class="email">name</code> variable.</p><p class="calibre7">It's important to <a id="id32" class="calibre1"/>understand that everything that is not an HTML tag is a helper, and that if you want to use a helper within a tag, you need to use <code class="email">{{}}</code> or <code class="email">#{}</code> to express this.</p><p class="calibre7">Go to <a class="calibre1" href="http://jade-lang.com">jade-lang.com</a> and <code class="email">handlebars.js</code> to know more specific information. With this information, you should be able to do just about anything.</p></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch01lvl1sec10" class="calibre1"/>Stylus for Meteor</h1></div></div></div><p class="calibre7">Stylus <a id="id33" class="calibre1"/>works <a id="id34" class="calibre1"/>much like CoffeeScript and Jade but it is for CSS. I recommend that you install <code class="email">mquandalle:stylus</code>. This package is preinstalled with useful tools such as <code class="email">Jeet</code> and <code class="email">Rupture</code>. All Stylus files are saved with a <code class="email">.styl</code> extension. There are only three things that we need to learn about Stylus: CSS tags, variables, and functions.</p></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch01lvl2sec14" class="calibre1"/>CSS tags</h2></div></div></div><p class="calibre7">Stylus is a language that does away <a id="id35" class="calibre1"/>with the need for semicolons (<code class="email">;</code>) and curly braces (<code class="email">{}</code>) in exchange for making good use of tabbing. Let's look at an example:</p><div><pre class="programlisting">
<strong class="calibre2">// STYLUS</strong>
// Let's make a vertical positioning class
.vertical-align-middle
  //PART 1
  position:absolute
  width:100%
  height:100%
  display:table
  overflow-x:hidden

  .special
    background:black</pre></div><p class="calibre7">We can see in <code class="email">PART 1</code> how properties are defined for a class by tabbing those properties in <code class="email">.special</code> is used to select an HTML tag with the <code class="email">special</code> class that is a child of the <code class="email">vertical-align-middle</code> class. Let's look at how <code class="email">PART 1</code> compiles:</p><div><pre class="programlisting">
<strong class="calibre2">/* CSS – OUTPUT PART 1 */</strong>
.vertical-align-middle {
  position:absolute;
  width:100%;
  height:100%;
  display:table;
  overflow-x:hidden;
}
.vertical-align-middle .special {
  background:black;
}</pre></div><p class="calibre7">Now let's add a more complex selector:</p><div><pre class="programlisting">
<strong class="calibre2">// STYLUS</strong>
// Let's make a vertical positioning class
.vertical-align-middle
  //PART 1
  ...

  //PART 2
  &gt; *
    display:table-cell
    vertical-align:middle</pre></div><p class="calibre7">
<code class="email">PART 2</code> has a combination of <a id="id36" class="calibre1"/>special CSS2 selectors: specific parent (<code class="email">&gt;</code>) and all elements (<code class="email">*</code>). In this particular order, the CSS2 selectors are picking the "any first sibling" element only and applying the rules. Let's look at how <code class="email">PART 2</code> compiles:</p><div><pre class="programlisting">
<strong class="calibre2">/* CSS – OUTPUT PART 2 */</strong>
.vertical-align-middle &gt; * {
  display:table-cell;
  vertical-align:middle;
}</pre></div><p class="calibre7">Let's add a new class to the current class that aligns the object to the top:</p><div><pre class="programlisting">
<strong class="calibre2">// STYLUS</strong>
// Let's make a vertical positioning class
.vertical-align-middle
  //PART 1
  ...
  //PART 2
  ...
  //PART 3
  &amp;.whole-page
    top:0</pre></div><p class="calibre7">
<code class="email">PART 3</code> uses an ampersand (<code class="email">&amp;</code>) to<a id="id37" class="calibre1"/> describe an element that is not a child but instead is concatenated with the extra class. Let's look at how <code class="email">PART 3</code> compiles:</p><div><pre class="programlisting">
<strong class="calibre2">/* CSS – OUTPUT PART 3 */</strong>
.vertical-align-middle.whole-page {
  top:0;
}</pre></div></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch01lvl2sec15" class="calibre1"/>Variables</h2></div></div></div><p class="calibre7">Unlike CSS, Stylus supports <a id="id38" class="calibre1"/>variables. This keeps a lot of things manageable when we want to make major changes to the look of our site. Suppose we have two colors that we want to use throughout our site, but we know that these colors are going to change. Let's define them as variables so that we can easily modify them later:</p><div><pre class="programlisting">
<strong class="calibre2">// STYLUS</strong>
primary-color = #ffffff
$secondary-color = #333333

.text-default
  color:primary-color
  background:$secondary-color

.text-inverted
  color:$secondary-color
  background:primary-color</pre></div><p class="calibre7">Easy right? In this example, both <code class="email">primary-color</code> and <code class="email">$secondary-color</code> are variables. Stylus optionally supports the use of the money sign (<code class="email">$</code>) to indicate a variable. This can make it easier to<a id="id39" class="calibre1"/> spot variables.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch01lvl2sec16" class="calibre1"/>Functions/mixins</h2></div></div></div><p class="calibre7">Unlike CSS, Stylus supports functions too. LESS, Stylus, and<a id="id40" class="calibre1"/> <strong class="calibre2">Sassy CSS</strong> (<strong class="calibre2">SCSS</strong>) refer to functions as<a id="id41" class="calibre1"/> <strong class="calibre2">mixins</strong>. Functions will make your CSS concoctions much easier to share across a project. We will cover the two types of mixins in Stylus: mixins and transparent mixins.</p><p class="calibre7">Mixins are<a id="id42" class="calibre1"/> functions<a id="id43" class="calibre1"/> that take a defined set of parameters. Let's take a look at how we can write a mixin:</p><div><pre class="programlisting">
<strong class="calibre2">// STYLUS</strong>
animation(duration,delay,timing)
  -webkit-animation-duration:duration
  animation-duration:duration
  -webkit-animation-delay:delay
  animation-delay:delay
  -webkit-animation-timing-function:timing
  animation-timing-function:timing

button
  animation(500ms,0,ease-out)

<strong class="calibre2">/* CSS – OUTPUT */</strong>
button {
  -webkit-animation-duration:500ms;
  animation-duration:500ms;
  -webkit-animation-delay:0;
  animation-delay:0;
  -webkit-animation-timing-function:ease-out;
  animation-timing-function:ease-out;
}</pre></div><p class="calibre7">In this example, we first define the <code class="email">animation</code> mixin, and then we apply the mixin to the <code class="email">button</code> HTML tag. However, there is a much easier and effective way of doing this via a transparent mixin.</p><p class="calibre7">A <a id="id44" class="calibre1"/>transparent mixin, basically, takes all the parameters and saves them in an <code class="email">arguments</code> variable without you having to define anything. Let's have a look:</p><div><pre class="programlisting">
<strong class="calibre2">// STYLUS</strong>
animation()
  -webkit-animation:arguments
  animation:arguments

button
  animation(pulse 3s ease infinite)

<strong class="calibre2">/* CSS – OUTPUT */</strong>
button {
  -webkit-animation:pulse 3s ease infinite;
  animation:pulse 3s ease infinite;
}</pre></div><p class="calibre7">Notice how we did not have to define every single parameter in the mixin, and the <code class="email">arguments</code> variable simply passed all the arguments that it could find. This is especially useful for keeping the code flexible.</p><p class="calibre7">Stylus <a id="id45" class="calibre1"/>essentially upgrades <a id="id46" class="calibre1"/>CSS in such a way that it makes the code much easier to manage and therefore, ends up saving us a lot of development time.</p><p class="calibre7">Go to <a class="calibre1" href="http://stylus-lang.com">stylus-lang.com</a> and <a class="calibre1" href="http://learnboost.github.io/stylus">learnboost.github.io/stylus</a> to learn more about Stylus.</p></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch01lvl1sec11" class="calibre1"/>Templates, helpers, and events</h1></div></div></div><p class="calibre7">Now that we are on the same page<a id="id47" class="calibre1"/> for the languages that we are going to use throughout the book, let's <a id="id48" class="calibre1"/>do a quick review of some of the elements that we will use during our <a id="id49" class="calibre1"/>development process.</p><p class="calibre7">Templates, helpers, and events are used to build the frontend of your application. Using them effectively is the key to how we design our backend as well (which we will address in <a class="calibre1" title="Chapter 2. Publish and Subscribe Patterns" href="part0021_split_000.html#page">Chapter 2</a>, <em class="calibre11">Publish and Subscribe Patterns</em>).</p></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch01lvl2sec17" class="calibre1"/>Templates</h2></div></div></div><p class="calibre7">Meteor templates <a id="id50" class="calibre1"/>are the special blocks of HTML code that generate Meteor template objects (<code class="email">Template.&lt;yourtemplate&gt;</code>). It is through Meteor template objects that we  wire the HTML code to logic. People who have worked with an MVC framework will refer to these templates as views. This is a key concept to understand.</p><p class="calibre7">Open up your terminal and create a new project:</p><div><pre class="programlisting">
<strong class="calibre2">meteor create basic_meteor</strong>
</pre></div><p class="calibre7">Now let's add our languages:</p><div><pre class="programlisting">
<strong class="calibre2">meteor add coffeescript</strong>
<strong class="calibre2">meteor add mquandalle:jade</strong>
<strong class="calibre2">meteor add mquandalle:stylus</strong>
</pre></div><p class="calibre7">Remove the three visible files from <code class="email">/basic_meteor</code> (do not remove any of the files starting with a dot), and create <code class="email">/client/layout.jade</code>. This is something that exists in one way or another in every Meteor project. Let's program:</p><div><pre class="programlisting">
<strong class="calibre2">//- layout.jade</strong>
head
  title Meteor Basics
  meta(name="viewport" content="user-scalable=no, initial- scale=1.0, maximum-scale=1.0")
  meta(name="apple-mobile-web-app-capable" content="yes")
body
  +basic_template</pre></div><pre>basic_template</code>. Let's program this in a new file, <code class="email">/client/basic_template.jade</code>:</pre><div><pre class="programlisting">
<strong class="calibre2">//- basic_template.jade</strong>
template(name="basic_template")
  h1 Hello World!</pre></div><p class="calibre7">Behind the scenes, Meteor is compiling our Jade templates and putting them all in one big file. You will never have to worry about loading <code class="email">basic_template.jade</code> before <code class="email">layout.jade</code> when it comes to templating.</p><p class="calibre7">Throughout the book, we will use <code class="email">meteorhacks:flow-router</code> and <code class="email">meteorhacks:flow-layout</code> to easily navigate to different templates.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch01lvl2sec18" class="calibre1"/>Creating helpers</h2></div></div></div><p class="calibre7">We have already<a id="id51" class="calibre1"/> discussed what helpers are in Jade, but how do we create helpers in Meteor? Let's go back to our <code class="email">basic_meteor</code> project and create <code class="email">/client/basic_template.coffee</code>. It is important to understand that Meteor helpers are used to control the variables in our template. People who have worked with an MVC framework can view this file as a controller. Let's write our first helper:</p><div><pre class="programlisting">
<strong class="calibre2">#basic_template.coffee</strong>
Template.basic_template.helpers
  "name": -&gt;
    "Mr Someone"</pre></div><p class="calibre7">Notice that the helper is defined within the <code class="email">helpers</code> function of the Meteor template object: <code class="email">Template.&lt;your_template&gt;.helpers(&lt;your_helpers&gt;)</code>. Helpers are mostly functions that will return anything you want them to including Meteor collection cursors. Let's bring all this together now:</p><div><pre class="programlisting">
<strong class="calibre2">//- basic_template.jade</strong>
template(name="basic_template")
  h1 Hello {{name}}</pre></div><p class="calibre7">This will output <code class="email">Hello Mr Someone</code> inside the <code class="email">h1</code> HTML tag. Let's add a slightly more complex helper:</p><div><pre class="programlisting">
<strong class="calibre2">#basic_template.coffee</strong>
Template.basic_template.helpers
  "person": -&gt;
    name:"Someone"
    prefix: "Mr"
    children: [
      {
        name:"Billy"
      }
      {
        name:"Nancy"
      }
    ]

<strong class="calibre2">//- basic_template.jade</strong>
template(name="basic_template")
  with person
    h1 Hello {{prefix}} {{name}}

    ul
      each children
        li {{name}}</pre></div><p class="calibre7">In this example, we are using <code class="email">with</code> to set up the <strong class="calibre2">data context</strong>
<a id="id52" class="calibre1"/> of the HTML tags that belong to it; this data context is equivalent to <code class="email">person</code>. Data context refers to the<a id="id53" class="calibre1"/> value of <code class="email">this</code> inside a helper. So if you set up an object as the data context, <code class="email">this</code> will be equivalent to that object. Also, we iterate through <code class="email">children</code> with an <code class="email">each</code> statement so that we can list out their names.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch01lvl2sec19" class="calibre1"/>Events</h2></div></div></div><p class="calibre7">Meteor taps into common <a id="id54" class="calibre1"/>JavaScript HTML events such as click, change, and focus. An event is anything that happens to an HTML element that you are listening to. Suppose we want to be able to change the name of a person to one of the children by clicking on them. We do this through the templates' event map. Let's take a look at an example of how we can do this without using reactivity or collections:</p><div><pre class="programlisting">
<strong class="calibre2">#basic_template.coffee</strong>
Template.basic_template.events
  "click li": -&gt;
    $("h1").text "Hello #{@name}"</pre></div><p class="calibre7">Easy! So to catch template events, we need to use the <code class="email">Template.&lt;your_template&gt;.events(&lt;your_event_map&gt;)</code> function. In this particular example, we are using jQuery to replace text.</p><p class="calibre7">The <code class="email">event map</code> is an object where the properties specify a set of events to be handled. These events may be specified in any of the following ways:</p><div><pre class="programlisting"># Runs any time you click anywhere
"click": -&gt;

# Runs any time you click a li element
"click li": -&gt;

#Runs any time you click a li element OR mouseover a li element
"click li, mouseover li": -&gt;</pre></div><p class="calibre7">The key <code class="email">string</code> of the event is composed of two parts: the first is always a type of event (click, hover, change, and so on) while the second is always a CSS selector.</p></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch01lvl1sec12" class="calibre1"/>The event loop and the merge box</h1></div></div></div><p class="calibre7">Before diving into <a id="id55" class="calibre1"/>Meteor, it is critical to<a id="id56" class="calibre1"/> understand what the event loop and the merge box are and how they can adversely affect your code. Both are relatively complex in the way that they were programmed, so we will focus on understanding the general concept.</p></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch01lvl2sec20" class="calibre1"/>The event loop</h2></div></div></div><p class="calibre7">The event loop is<a id="id57" class="calibre1"/> like a queue; it runs a series of functions one by one. Because functions are processed sequentially, each function effectively blocks others from being processed until the function is done.</p><p class="calibre7">In other words, the event loop functions much like a single-line conveyor belt where things are being inspected. For every inspection made, the line is stopped and nothing moves.</p><p class="calibre7">Meteor uses Fibers – a NodeJS library – to get around this issue. Many of the functions that you will run will be on a separate fiber. What does this mean? This means that the functions will run on a separate conveyor belt for processing. Still, not all functions are built this way, you need to make sure your server-side functions do not block the server.</p><p class="calibre7">So which functions could potentially cause the server to get blocked? <code class="email">Meteor.methods()</code>, <code class="email">Meteor.publish()</code>, and <code class="email">any</code> function that does not run inside a fiber on the server. Let's see how we can unblock each one and when we should do this.</p><p class="calibre7">Functions defined under the <code class="email">Meteor.methods()</code> that you know are going to take a long time to process, should always run on a Fiber or defer time consuming code to a Fiber. We can quickly solve this by calling the <code class="email">@unblock()</code> function from within the method. Let's look at an example:</p><div><pre class="programlisting">
<strong class="calibre2"># METEOR METHODS</strong>
Meteor.methods
  #BLOCKING
  time_consuming: -&gt;
    Meteor.setTimeout -&gt;
        console.log "done"
      ,60000

  #NON-BLOCKING
  time_consuming_unblock: -&gt;
    @unblock()
    Meteor.setTimeout -&gt;
        console.log "done"
      ,60000</pre></div><p class="calibre7">In this example, when you run <code class="email">Meteor.call("time_consuming")</code>, the server will be blocked. When the server is blocked, other visitors won't be able to reach your site! Instead if you run <code class="email">Meteor.call("time_consuming_unblock")</code>, the server will continue to function properly but consume more resources to do so.</p><p class="calibre7">
<code class="email">Meteor.publish()</code> can be easily unblocked after installing the <code class="email">meteorhacks:unblock</code> package as well. This one will be particularly useful when we start to make very complex publishers that might consume a lot of resources. Let's look at an example:</p><div><pre class="programlisting">
<strong class="calibre2"># METEOR PUBLISH</strong>
#BLOCKING
Meteor.publish "external_API_query", -&gt;
  HTTP.get "http://connect.square.com/payments"

#NON-BLOCKING
Meteor.publish "external_API_query_unblocked", -&gt;
  @unblock()
  HTTP.get "http://connect.square.com/payments"</pre></div><p class="calibre7">In this example, we are waiting for an HTTP call to respond. This will certainly block the server if we subscribe to <code class="email">external_API_query</code>, so we use <code class="email">external_API_query_unblocked</code> instead.</p><p class="calibre7">All other functions<a id="id58" class="calibre1"/> that run on the server and you know are going to block the server, should run on a fiber. Meteor has a special function to help us make this easy. It is called <code class="email">Meteor.wrapAsync()</code>. Let's see how this works:</p><div><pre class="programlisting">
<strong class="calibre2"># METEOR UNBLOCKED FUNCTION</strong>
unblock_me = Meteor.wrapAsync -&gt;
  Meteor.setTimeout -&gt;
      console.log "done"
    ,60000</pre></div><div><h3 class="title2"><a id="tip03" class="calibre1"/>Tip</h3><p class="calibre7">It is very important to keep the event loop in mind, especially when we're connecting our web application to external services that are going to cause massive delays to our server.</p></div></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch01lvl2sec21" class="calibre1"/>The merge box</h2></div></div></div><p class="calibre7">The merge box <a id="id59" class="calibre1"/>is the algorithm that identifies all the changes that are happening to the database. It basically handles publishers, subscribers, and reactivity. The merge box also handles the initial load of data using DDP messages.</p><p class="calibre7">It is important to understand that we can communicate directly with the merge box via all the commands that are available to us under the <code class="email">Meteor.publish()</code> function. The more optimal we can make our <code class="email">Meteor.publish</code> functions, the faster the site will load.</p></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch01lvl1sec13" class="calibre1"/>The beginning of our online shop</h1></div></div></div><p class="calibre7">Throughout the book we will be <a id="id60" class="calibre1"/>developing an e-commerce website to help us understand the core concepts of advanced Meteor web development. Let's begin by creating a new project:</p><div><pre class="programlisting">
<strong class="calibre2">meteor create online_shop</strong>
</pre></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch01lvl2sec22" class="calibre1"/>The must-have packages</h2></div></div></div><p class="calibre7">
<a class="calibre1" href="http://Atmospherejs.com">Atmospherejs.com</a> has<a id="id61" class="calibre1"/> always been <a id="id62" class="calibre1"/>the "go to" website to find packages. Here you will find thousands of packages produced by the community for free. There are a handful of packages that we absolutely need to install to make our website function properly.</p><p class="calibre7">First, we install the languages:</p><div><pre class="programlisting">
<strong class="calibre2">meteor add coffeescript</strong>
<strong class="calibre2">meteor add mquandalle:jade</strong>
<strong class="calibre2">meteor add mquandalle:stylus</strong>
<strong class="calibre2">meteor add less</strong>
</pre></div><p class="calibre7">Next, the router and functions that will help us with SEO and routing:</p><div><pre class="programlisting">
<strong class="calibre2">meteor add kadira:flow-router</strong>
<strong class="calibre2">meteor add kadira:blaze-layout</strong>
<strong class="calibre2">meteor add meteorhacks:fast-render</strong>
<strong class="calibre2">meteor add nimble:restivus</strong>
<strong class="calibre2">meteor add yasinuslu:blaze-meta</strong>
<strong class="calibre2">meteor add dfischer:prerenderio</strong>
<strong class="calibre2">meteor add wizonesolutions:canonical</strong>
</pre></div><div><h3 class="title2"><a id="note02" class="calibre1"/>Note</h3><p class="calibre7">
<strong class="calibre2">WARNING</strong>: Do not run Meteor yet! Canonical could mess up your project unless you have it set up correctly.</p></div><p class="calibre7">We will need a couple of packages as well to help us manage publishers:</p><div><pre class="programlisting">
<strong class="calibre2">meteor add lepozepo:publish-with-relations</strong>
<strong class="calibre2">meteor add tmeasday:publish-counts</strong>
<strong class="calibre2">meteor add meteorhacks:aggregate</strong>
<strong class="calibre2">meteor add http</strong>
<strong class="calibre2">meteor add meteorhacks:unblock</strong>
</pre></div><p class="calibre7">These next packages <a id="id63" class="calibre1"/>will extend Meteor's functions:</p><div><pre class="programlisting">
<strong class="calibre2">meteor add xorax:multiple-callbacks</strong>
<strong class="calibre2">meteor add aldeed:collection2</strong>
<strong class="calibre2">meteor add aldeed:autoform</strong>
<strong class="calibre2">meteor add fastclick</strong>
<strong class="calibre2">meteor add reactive-var</strong>
<strong class="calibre2">meteor add alanning:roles</strong>
<strong class="calibre2">meteor add accounts-password</strong>
</pre></div><div><pre class="programlisting">
<strong class="calibre2">meteor add u2622:persistent-session</strong>
<strong class="calibre2">meteor add ongoworks:security</strong>
</pre></div><p class="calibre7">We will need these packages to properly manage time:</p><div><pre class="programlisting">
<strong class="calibre2">meteor add momentjs:moment</strong>
<strong class="calibre2">meteor add mrt:moment-timezone</strong>
</pre></div><p class="calibre7">For the last set, we'll be using a couple of additional packages that will make the design process much faster:</p><div><pre class="programlisting">
<strong class="calibre2">meteor add kyleking:customizable-bootstrap-stylus</strong>
<strong class="calibre2">meteor add raix:handlebar-helpers</strong>
<strong class="calibre2">meteor add fortawesome:fontawesome</strong>
<strong class="calibre2">meteor add percolate:momentum</strong>
</pre></div><p class="calibre7">We need to remove some packages for security too:</p><div><pre class="programlisting">
<strong class="calibre2">meteor remove autopublish</strong>
<strong class="calibre2">meteor remove insecure</strong>
</pre></div><p class="calibre7">All of these packages<a id="id64" class="calibre1"/> will be explained in more detail throughout the book, but all of these are must-haves. The first package that we need to explain is the <code class="email">wizonesolutions:canonical</code> package. This package makes sure that all incoming traffic is routed to your <code class="email">ROOT_URL</code>, so it is particularly useful when you want all the traffic to go to your SSL site. The first thing that we need to do before running Meteor is set up canonical to run only in the production environment.</p><p class="calibre7">Create <code class="email">/server/canonical.coffee</code>, and add this code:</p><div><pre class="programlisting">
<strong class="calibre2">#/server/canonical.coffee</strong>
if process.env.NODE_ENV is "development" or process.env.ROOT_URL.indexOf("meteor.com") &gt; -1
  Meteor.startup -&gt;
    process.env.PACKAGE_CANONICAL_DISABLE = true</pre></div><pre>PACKAGE_CANONICAL_DISABLE</code> environment variable to make sure that canonical is inactive while you are developing.</pre><p class="calibre7">What are environment variables? These variables are defined within the scope of the deployment, and they make sure that the project knows information before the build finishes on the server. Information such as what database to use, which domains to use, and other setup information can usually be found in these variables. We will cover this information in the final chapter.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch01lvl2sec23" class="calibre1"/>File structure</h2></div></div></div><p class="calibre7">A proper file structure<a id="id65" class="calibre1"/> is tremendously important in Meteor. We have found that the best way to work is with functional top-level modules. This means that every folder is a micro-service, and therefore can act on its own. This allows for a lot of modularity in the project, and it's very easy for others to understand what it is that you are trying to accomplish. In this section, we will cover this file structure and Meteor's special folders.</p><p class="calibre7">Let's look at a sample web application folder structure:</p><div><pre class="programlisting">/online_shop
/online_shop/cart
/online_shop/cart/cart_route.coffee  #RUNS ON CLIENT AND SERVER
/online_shop/cart/client
/online_shop/cart/client/cart_view.jade  #RUNS ON CLIENT ONLY
/online_shop/cart/client/cart_controller.coffee
/online_shop/cart/client/cart.styl
/online_shop/cart/server
/online_shop/cart/server/cart_publisher.coffee  #RUNS ON SERVER ONLY
/online_shop/cart/server/cart_methods.coffee</pre></div><p class="calibre7">In this folder structure, <code class="email">cart</code> is the micro-service, and it is composed of a route, view, controller, and publisher. The files placed under a <code class="email">/client</code> directory will be published to the client and will <a id="id66" class="calibre1"/>only run on the client. The files placed under a <code class="email">/server</code> directory will only run and be accessible on the server. If a file is placed in none of these directories, then the file will run on both the client and server. The expected structure goes like this:</p><div><pre class="programlisting">/project_folder
/project_folder/_globals
  ./client/&lt;global support function files&gt;
  ./server/&lt;global support function files&gt;
  ./lib/collections/&lt;collection&gt;/&lt;file&gt;
  ./lib/collections/&lt;collection&gt;/server/&lt;permissions file&gt;

/project_folder/router
  ./client/layouts/&lt;layout file&gt;
  ./lib/&lt;configuration file&gt;
  ./lib/&lt;middleware file&gt;

/project_folder/&lt;module&gt;
  ./&lt;route file&gt;
  ./client/&lt;template file&gt;
  ./client/&lt;logic file&gt;
  ./client/&lt;styles file&gt;
  ./server/&lt;publishers file&gt;
  ./server/&lt;methods file&gt;</pre></div><p class="calibre7">It's important to note that the <code class="email">/lib</code> directory will always run before any other code does. Let's place our canonical file under the <code class="email">/_globals/canonical/server</code> directory.</p><p class="calibre7">Let's create our first module: the router. Create the <code class="email">/router/client/layout.jade</code> directory, and we will only have one layout throughout the project. Now let's code our layout:</p><div><pre class="programlisting">
<strong class="calibre2">//- LAYOUT.JADE</strong>
head
  title Online Shop
  meta(charset="utf-8")

  //- Allow saving to homescreen
  meta(name="apple-mobile-web-app-capable" content="yes")

  //- Do not try to detect phone numbers
  meta(name="format-detection" content="telephone=no")

  //- Make it mobile friendly
  meta(name="viewport" content="user-scalable=no, initial- scale=1.0, maximum-scale=1.0")

body

template(name="layout")
  +Template.dynamic(template=nav)
  +Template.dynamic(template=content)</pre></div><p class="calibre7">Here, we have introduced the <code class="email">Template.dynamic</code> component. This component may be used to render<a id="id67" class="calibre1"/> other templates dynamically by changing the value of a variable to the name of the template we want to render. We decided to use two variables—<code class="email">nav</code> and <code class="email">content</code>— that are controlled by the router. So, basically, the <code class="email">content</code> variable will be changing to different strings that are equal to the names of our templates.</p><p class="calibre7">We will create our <code class="email">landing</code> module in the next chapter to learn not only how to use the router but also how to properly subscribe to data.</p></div></div>
<div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch01lvl1sec14" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">We have addressed a lot of things in this chapter. We can now program faster because we have tools such as CoffeeScript, Jade, and Stylus to help us. Also, we have learned how to use templates, helpers, and events to work with our Meteor frontend. Understanding the event loop and the merge box has made us a bit more precautious when it comes to running complex, time-consuming operations. Finally, we began to build a project, and we adopted a folder structure that is going to make development quicker.</p><p class="calibre7">In the next chapter, we will cover two of the most important parts that make a Meteor application viable: Meteor publishers and Meteor subscribers. With these patterns, you will be able to produce sites that load quickly and that do not put too much strain on the server.</p></div></body></html>