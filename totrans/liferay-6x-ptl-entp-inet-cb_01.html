<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Installation and Basic Configuration </h1></div></div></div><p>In this chapter, we will cover the following topics:</p><div><ul class="itemizedlist"><li class="listitem">Quick running Liferay on a Tomcat bundle</li><li class="listitem">The Liferay setup wizard and first login</li><li class="listitem">Setting up the developer's environment</li><li class="listitem">Creating a custom portlet</li></ul></div><div><div><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Introduction</h1></div></div></div><p>Liferay is the market's leading provider of open source portal solutions. It provides a solid platform to <a id="id0" class="indexterm"/>serve our site to all clients. It is difficult to say what Liferay is. On the one hand, Liferay is a great content-management system, but on the other hand, it provides many tools for collaboration and communication between users. It can also be a social platform with many functionalities, such as wall, message board, chat, and many others. Furthermore, it is a portlet container that is JSR-168 and JSR-286 compliant. <strong>Java Specification Requests</strong> (<strong>JSRs</strong>) describes final specifications for the Java platform. A portlet is a <a id="id1" class="indexterm"/>small web application that produces fragments of HTML code that are aggregated into a portal. JSR-168 and JSR-286 specifications standardize how portlets interact with portlet containers. These specifications also describe a standard application programming interface for Java portlet development. In other words, Liferay is only responsible for aggregating the set of portlets that are to appear on any particular page. This approach gives users a great tool to organize and customize portlets in order to build whole portals, social platforms, or intranets. Within Liferay, a portal is composed of a number of portlets, which are self-contained interactive elements that are written to a particular standard. A number of publications describe Liferay's advantages. In this book, we will try to delve deeper into Liferay's architecture and its functionalities.</p><p>The primary purpose of this chapter is to give you an insight about Liferay's installation and management with basic configuration. We realize that there are many ways to download, compile, install, and run Liferay Portal. Our main purpose is to provide some clear and basic information about the starting package on which we will rely and work. This chapter explains the main processes that are performed on every compiling action or on every startup action.</p><p>Liferay Portal<a id="id2" class="indexterm"/> is distributed in two different editions:</p><div><ul class="itemizedlist"><li class="listitem"><strong>Liferay Portal Community Edition (CE)</strong>: This is a free and open source version <a id="id3" class="indexterm"/>of Liferay</li><li class="listitem"><strong>Liferay Portal Enterprise Edition (EE)</strong>: This is a commercial offering that has <a id="id4" class="indexterm"/>Liferay engineers, support, and<a id="id5" class="indexterm"/> services</li></ul></div><p>This book is based on the Liferay Portal Community Edition (CE) version with the newest release, which is 6.2.</p><p>To start the journey with Liferay, there are a few starting points that contain a lot of useful information, which<a id="id6" class="indexterm"/> are as follows:</p><div><table border="1"><colgroup><col/><col/></colgroup><thead><tr><th valign="bottom">
<p>URL</p>
</th><th valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td valign="top">
<p>
<a class="ulink" href="http://www.liferay.com/">http://www.liferay.com/</a>
</p>
</td><td valign="top">
<p>Official Liferay site</p>
</td></tr><tr><td valign="top">
<p>
<a class="ulink" href="http://www.liferay.com/downloads/liferay-portal/available-releases">http://www.liferay.com/downloads/liferay-portal/available-releases</a>
</p>
</td><td valign="top">
<p>Place with available releases</p>
</td></tr><tr><td valign="top">
<p>
<a class="ulink" href="http://www.liferay.com/documentation/liferay-portal/6.2/user-guide">http://www.liferay.com/documentation/liferay-portal/6.2/user-guide</a> and <a class="ulink" href="https://dev.liferay.com/">https://dev.liferay.com/</a>
</p>
</td><td valign="top">
<p>User guides and documentation</p>
</td></tr><tr><td valign="top">
<p>
<a class="ulink" href="http://svn.liferay.com/repos/public/portal">http://svn.liferay.com/repos/public/portal</a>
</p>
</td><td valign="top">
<p>Old-fashion repository of Liferay code.</p>
<div><ul class="itemizedlist"><li class="listitem"><strong>Login</strong>: Enter guest in this field</li><li class="listitem"><strong>Password</strong>: This field is to be left empty</li></ul></div>
</td></tr><tr><td valign="top">
<p>
<a class="ulink" href="https://github.com/liferay/liferay-portal/tree/6.2.x">https://github.com/liferay/liferay-portal/tree/6.2.x</a>
</p>
</td><td valign="top">
<p>[Recommended] GitHub repository</p>
</td></tr></tbody></table></div><div><h3 class="title"><a id="tip02"/>Tip</h3><p>Liferay introduced 7.0 version, which will be released on September 2015. Do not check out Liferay sources from the trunk. There are many changes between 6.2 and the trunk version. In the 7.0 version, Liferay will provide OSGi integration and many new features. These new features help users and developers achieve a whole bunch of out-of-the-box functionalities (for instance, Elasticsearch as a search server based on the Lucene framework).</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Quick running Liferay on a Tomcat bundle</h1></div></div></div><p>The simplest way to run Liferay is to download a specific bundle from the Liferay official site. A Liferay bundle is just a compressed archive that contains all that is needed to host the<a id="id7" class="indexterm"/> Liferay Portal. A bundle consists of a Java-based <a id="id8" class="indexterm"/>application server and the deployed Liferay Portal core application. Liferay provides these bundle runtimes with different application servers (that is, Tomcat, JBoss, Geronimo, and so on) so that you can use any one based on your choice. This method is recommended for people who just want to run Liferay Portal, look at its functionalities, and configure their site using the GUI. In this recipe, you will learn the art of setting up Liferay on Tomcat and the MySQL database engine.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Getting ready</h2></div></div></div><p>First, make sure that JRE or JDK is properly installed. Type the following command line:</p><div><pre class="programlisting">
<strong>$ java -version</strong>
</pre></div><p>The result should be similar to this:</p><div><pre class="programlisting">
<strong>$ java -version</strong>
<strong>java version "1.7.0_45"</strong>
<strong>Java(TM) SE Runtime Environment (build 1.7.0_45-b18)</strong>
<strong>Java HotSpot(TM) 64-Bit Server VM (build 24.45-b08, mixed mode).</strong>
</pre></div><p>Also, check out the Java SDK version. Liferay recommends Java 7 or later.</p><p>Moreover, determine whether the MySQL server installation is done:</p><div><pre class="programlisting">
<strong>$ mysql --version</strong>
</pre></div><p>As a result, the actual installed version should be displayed. Here is an example:</p><div><pre class="programlisting">
<strong>mysql  Ver 14.14 Distrib 5.5.34, for debian-linux-gnu (x86_64)</strong>
</pre></div><p>Also, check out the MySQL version. We recommend 5.5 version or later.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec13"/>How to do it...</h2></div></div></div><p>In order to run Liferay on a Tomcat bundle, follow these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Create a database with the name <code class="literal">lportal</code>:<div><pre class="programlisting">CREATE DATABASE lportal CHARACTER SET utf8 COLLATE utf8_general_ci;
grant all privileges on lportal.* to '{USERNAME}'@'%' identified by 'PASSWORD';</pre></div><p>Make sure that the MySQL user has permissions to create tables.</p></li><li class="listitem">Download the correct Liferay version on the Tomcat bundle from <a class="ulink" href="http://www.liferay.com/downloads/liferay-portal/available-releases">http://www.liferay.com/downloads/liferay-portal/available-releases</a>.</li><li class="listitem">Unzip<a id="id9" class="indexterm"/> the downloaded archive.</li><li class="listitem">Go to<a id="id10" class="indexterm"/> the extracted folder <code class="literal">liferay-portal-6.2-ce-ga2</code>. This path will be called <code class="literal">${liferay.home}</code> folder.</li><li class="listitem">Go to the <code class="literal">${liferay.home}</code> folder and create a file called <code class="literal">portal-ext.properties</code>.</li><li class="listitem">Edit <code class="literal">portal-ext.properties</code> and set the database properties:<div><pre class="programlisting">jdbc.default.driverClassName=com.mysql.jdbc.Driver
jdbc.default.url=jdbc:mysql://localhost/lportal?useUnicode=true&amp;characterEncoding=UTF-8&amp;useFastDateParsing=false
jdbc.default.username={USERNAME}
jdbc.default.password={PASSWORD}</pre></div></li><li class="listitem">Find the Tomcat folder and go to the <code class="literal">tomcat-7.0.42/bin/</code> location.</li><li class="listitem">Run the <code class="literal">./startup.sh</code> script (<code class="literal">startup.bat</code> for Windows OS) and look into the <code class="literal">tomcat-7.0.42/logs/catalina.out</code> log.</li><li class="listitem">In a browser, type <code class="literal">http://localhost:8080</code> location. By default, Tomcat listens on port 8080. It should render the Liferay setup wizard by default. This wizard will ask for basic information, such as, portal name, default language, and administrator user details.</li></ol><div></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec14"/>How it works...</h2></div></div></div><p>Running the Liferay Portal from a prepared bundle is quite an easy task to accomplish. However, it is worth knowing what exactly happens when Tomcat is being started. Take a brief look at the <code class="literal">catalina.out</code> log and try to examine it line by line.</p><div><div><div><div><h3 class="title"><a id="ch01lvl3sec01"/>Loading the configuration descriptor</h3></div></div></div><p>The first <a id="id11" class="indexterm"/>thing is to deploy <code class="literal">ROOT.xml</code>. In our <code class="literal">catalina.out</code> file, there is a line present, which is shown as follows:</p><div><pre class="programlisting">INFO: Deploying configuration descriptor /home/piotr/liferay-portal-6.2-ce-ga2/tomcat-7.0.42/conf/Catalina/localhost/ROOT.xml</pre></div><p>It means that the configuration file turns on the <code class="literal">crossContext</code> attribute in Tomcat 7. This <a id="id12" class="indexterm"/>setting is required because Liferay is a portlet container. Hence, it is an application that should have access to other applications called portlets. The Apache Tomcat documentation says:</p><div><blockquote class="blockquote"><p><em>"Set to true if you want calls within this application to ServletContext.getContext() to successfully return a request dispatcher for other web applications running on this virtual host."</em></p></blockquote></div></div><div><div><div><div><h3 class="title"><a id="ch01lvl3sec02"/>Loading system properties and portal properties</h3></div></div></div><p>The <a id="id13" class="indexterm"/>next few lines of the logfile show portal properties<a id="id14" class="indexterm"/> and system properties that are loaded from specific locations:</p><div><pre class="programlisting">Loading jar:file:/home/piotr/liferay-portal-6.2-ce-ga2/tomcat-7.0.42/webapps/ROOT/WEB-INF/lib/portal-impl.jar!/system.properties
Loading jar:file:/home/piotr/liferay-portal-6.2-ce-ga2/tomcat-7.0.42/webapps/ROOT/WEB-INF/lib/portal-impl.jar!/system.properties
Loading jar:file:/home/piotr/liferay-portal-6.2-ce-ga2/tomcat-7.0.42/webapps/ROOT/WEB-INF/lib/portal-impl.jar!/portal.properties
Loading file:/home/piotr/liferay-portal-6.2-ce-ga2/portal-ext.properties</pre></div><p>The main configuration file for Liferay Portal is <code class="literal">portal.properties</code>, which contains a detailed explanation about the properties that it defines. There are at least three possible ways to override <code class="literal">portal.properties</code>. There is a functionality to put <code class="literal">portal-ext.properties</code> in the <code class="literal">ext</code> plugin, in the <code class="literal">${liferay.home}</code> directory, or in <code class="literal">portal-setup-wizard.properties</code>. But which file is the most important? The answer is placed in <code class="literal">portal.properties</code> file. The default read order is <code class="literal">portal.properties</code>, <code class="literal">portal-bundle.properties</code>, <code class="literal">portal-ext.properties</code>, and then <code class="literal">portal-setup-wizard.properties</code>:</p><div><pre class="programlisting">    include-and-override=portal-bundle.properties
    include-and-override=${liferay.home}/portal-bundle.properties
    include-and-override=portal-ext.properties
    include-and-override=${liferay.home}/portal-ext.properties
    include-and-override=portal-setup-wizard.properties
    include-and-override=${liferay.home}/portal-setup-wizard.properties</pre></div></div><div><div><div><div><h3 class="title"><a id="ch01lvl3sec03"/>Detecting the database and database dialect</h3></div></div></div><p>The <a id="id15" class="indexterm"/>next<a id="id16" class="indexterm"/> step is to recognize the database's dialect:</p><div><pre class="programlisting">12:35:47,469 INFO  [localhost-startStop-1][DialectDetector:71] Determine dialect for MySQL 5
12:35:47,504 INFO  [localhost-startStop-1][DialectDetector:136] Found dialect org.hibernate.dialect.MySQLDialect</pre></div><p>Liferay <a id="id17" class="indexterm"/>supports many database engines, such as DB2, Derby, Hypersonic, Ingres, MySQL, Oracle, P6Spy, PostgreSQL, and Sybase. The default <a id="id18" class="indexterm"/>database is Hypersonic, which stores all data in the <code class="literal">${liferay.home}/data/hsql/lportal</code> directory. This is a good option for developers who want to run JUnit tests, which modify data by testing the persistence layer or business process.</p><p>On every restart, Liferay tries to get the build number (Liferay version) from the <code class="literal">Release_</code> table. If this table doesn't exist, it calls <code class="literal">ReleaseLocalService.createTablesAndPopulate()</code>.</p><p>If it is not possible to get the build number, Liferay logs the following information:</p><div><pre class="programlisting">WARN  [localhost-startStop-1][ReleaseLocalServiceImpl:171] Table 'lportal.Release_' doesn't exist</pre></div><p>The <code class="literal">createTablesAndPopulate</code> method runs following scripts:</p><div><ul class="itemizedlist"><li class="listitem"><code class="literal">liferay-portal/sql/portal-tables.sql</code>: This creates the required tables</li><li class="listitem"><code class="literal">liferay-portal/sql/portal-data-common.sql</code>: This adds the default data</li><li class="listitem"><code class="literal">liferay-portal/sql/portal-data-counter.sql</code>: This inits the unique key generator</li><li class="listitem"><code class="literal">liferay-portal/sql/portal-data-release.sql</code>: This sets the release date</li><li class="listitem"><code class="literal">liferay-portal/sql/indexes.sql</code>: This adds database indexes</li><li class="listitem"><code class="literal">liferay-portal/sql/sequences.sql</code>: By default, this file is empty.</li></ul></div><p>Apart from creating tables and populating data, Liferay triggers the <code class="literal">VerifyProcess</code> mechanism. This process will run on every startup to verify and fix any integrity problems found in the database. This is the perfect place for developers to add custom code to check the integrity of specific cases.</p></div><div><div><div><div><h3 class="title"><a id="ch01lvl3sec04"/>Starting the autodeploy scanner and deploying plugins</h3></div></div></div><p>The last step is <a id="id19" class="indexterm"/>initializing the autodeploy and the hot<a id="id20" class="indexterm"/>deploy listeners. In general, these mechanisms install all the plugins into the Tomcat container and register them as portlets, hooks, themes, and so on. In particular, there are at least three deploying approaches: sandbox deploy, autodeploy, and hotdeploy.</p><div><h3 class="title"><a id="note02"/>Note</h3><p>By default, Liferay uses the autodeploy and hotdeploy listeners. In fact, sandbox can currently deploy only themes and portlets.</p></div><p>The auto<a id="id21" class="indexterm"/>deploy mechanism is responsible for listening <a id="id22" class="indexterm"/>on a specific directory to install on-the-fly new plugins and copying them into the Tomcat hotdeploy process. A definition of that directory is placed in <code class="literal">portal.properties</code>, and by default, it is in the <code class="literal">deploy</code> folder:</p><div><pre class="programlisting">auto.deploy.deploy.dir=${liferay.home}/deploy</pre></div><p>Every type of plugin has its own autodeploy mechanism. This mechanism runs all the necessary steps to install it correctly in the Liferay container. In simple terms, the autodeploy mechanism generates the <code class="literal">web.xml</code> file and adds the required libraries to specific plugins. Definitions of these classes are placed in the <code class="literal">portal.properties</code> file with an <code class="literal">auto.deploy.*</code> prefix. Each class extends <code class="literal">BaseAutoDeployListener</code>.</p><p>The second process, hotdeploy, is responsible for registering plugins in Liferay. There are many steps, such as creating database tables, setting preferences, registering Spring application contexts, and so on. Of course, each step depends on the type of plugin. In <code class="literal">portal.properties</code>, there are definitions for each type of class:</p><div><pre class="programlisting">hot.deploy.listeners=
com.liferay.portal.deploy.hot.PluginPackageHotDeployListener,
com.liferay.portal.deploy.hot.SpringHotDeployListener,
com.liferay.portal.deploy.hot.ServletContextListenerHotDeployListener,
com.liferay.portal.deploy.hot.ExtHotDeployListener,
com.liferay.portal.deploy.hot.HookHotDeployListener,
com.liferay.portal.deploy.hot.JSONWebServiceHotDeployListener,
com.liferay.portal.deploy.hot.LayoutTemplateHotDeployListener,
com.liferay.portal.deploy.hot.PortletHotDeployListener,
com.liferay.portal.deploy.hot.SocialHotDeployListener,
com.liferay.portal.deploy.hot.ThemeHotDeployListener,
com.liferay.portal.deploy.hot.ThemeLoaderHotDeployListener,
com.liferay.portal.deploy.hot.MessagingHotDeployListener</pre></div><div><h3 class="title"><a id="tip03"/>Tip</h3><p>In the deployment process, the Liferay deployer modifies the <code class="literal">web.xml</code> file, adds specific dependencies, and packs it again. Ensure that you do not copy the <code class="literal">WAR</code> file directly to the Tomcat <code class="literal">webapps</code> folder. If you do so, the plugin will not work.</p></div></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec15"/>There's more...</h2></div></div></div><p>Often, enterprises have an established Java EE infrastructure upon which they would like to install Liferay. You must consider also the enterprise's security policies. These policies sometimes prevent the download and installation of the Tomcat bundle into a location of your choice. In this situation, a bundle will not suffice, and you have to manually install Liferay <a id="id23" class="indexterm"/>from its WAR archive into an already existing Apache Tomcat application server.</p><p>There are six steps to achieve this goal. They are as follows:</p><div><ol class="orderedlist arabic"><li class="listitem">Copy specific JAR files and dependencies to the Tomcat global <code class="literal">lib</code> folder, <code class="literal">$TOMCAT_HOME/lib/ext</code>.</li><li class="listitem">Enable <code class="literal">crossContext</code> by adding the <code class="literal">ROOT.xml</code> file to the <code class="literal">$TOMCAT_HOME/conf/Catalina/localhost</code> folder.</li><li class="listitem">Set custom <code class="literal">$JAVA_OPTS</code> parameters in the <code class="literal">$TOMCAT_HOME/bin/setenv.sh</code> file:<div><pre class="programlisting">JAVA_OPTS="$JAVA_OPTS -Dfile.encoding=UTF8 -Dorg.apache.catalina.loader.WebappClassLoader.ENABLE_CLEAR_REFERENCES=false -Duser.timezone=GMT -Xmx1024m -XX:MaxPermSize=256m"</pre></div></li><li class="listitem">Update the <code class="literal">common.loader</code> property located in <code class="literal">$TOMCAT_HOME/conf/catalina.properties</code> with the following lines of code:<div><pre class="programlisting">common.loader=${catalina.base}/lib,${catalina.base}/lib/*.jar,${catalina.home}/lib,${catalina.home}/lib/*.jar,${catalina.home}/lib/ext,${catalina.home}/lib/ext/*.jar</pre></div></li><li class="listitem">Specify the URI encoding as UTF-8 in <code class="literal">$TOMCAT_HOME/conf/server.xml</code> as follows:<div><pre class="programlisting">&lt;Connector port="8080" protocol="HTTP/1.1"
  connectionTimeout="20000"
  redirectPort="8443" <strong>URIEncoding="UTF-8</strong>" /&gt;</pre></div></li><li class="listitem">Deploy Liferay Portal using Tomcat manager or manually put the WAR archive into<a id="id24" class="indexterm"/> the <code class="literal">$TOMCAT_HOME/webapps</code> folder. The WAR file is available at <a class="ulink" href="http://www.liferay.com/downloads/liferay-portal/available-releases#additional-versions">http://www.liferay.com/downloads/liferay-portal/available-releases#additional-versions</a>.</li></ol><div></div><div><h3 class="title"><a id="note03"/>Note</h3><p>More detailed instructions of how to install Liferay on the Tomcat server are available on the<a id="id25" class="indexterm"/> official Liferay documentation at <a class="ulink" href="https://www.liferay.com/documentation/liferay-portal/6.2/user-guide/-/ai/installing-liferay-on-tomcat-3">https://www.liferay.com/documentation/liferay-portal/6.2/user-guide/-/ai/installing-liferay-on-tomcat-3</a>.</p></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec16"/>See also</h2></div></div></div><p>For information about running Liferay on the clustered environment, refer to the <em>Clustering Liferay Portal</em> recipe in <a class="link" title="Chapter 11. Quick Tricks and Advanced Knowledge" href="part0080.xhtml#aid-2C9D01">Chapter 11</a>, <em>Quick Tricks and Advanced Knowledge</em>, and the <em>Scalable infrastructure</em> recipe in <a class="link" title="Chapter 12. Basic Performance Tuning" href="part0088.xhtml#aid-2JTHG1">Chapter 12</a>, <em>Basic Performance Tuning</em>. For information<a id="id26" class="indexterm"/> about setting the developer's environment, refer to the next recipe.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec11"/>The Liferay setup wizard and first login</h1></div></div></div><p>After successfully running Liferay on the Apache Tomcat server, the system asks users to fill some <a id="id27" class="indexterm"/>necessary information to complete the setup wizard. This is <a id="id28" class="indexterm"/>only a single screen with basic fields, such as administrator name or portal name.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec17"/>How to do it…</h2></div></div></div><p>After running Liferay for the first time, the Liferay platform displays the basic configuration form, which looks like this:</p><div><img src="img/image00298.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p><p>To finish installation, it is necessary to fill in the preceding form as follows:</p><div><ol class="orderedlist arabic"><li class="listitem">Provide <a id="id29" class="indexterm"/>details about <strong>Portal</strong>:<div><ul class="itemizedlist"><li class="listitem"><strong>Portal Name</strong>: This is the name of the website, for instance, Enterprise<a id="id30" class="indexterm"/> Intranets</li><li class="listitem"><strong>Default Language</strong>: This helps in choosing the default language of the portal</li><li class="listitem"><strong>Add Sample Date</strong>: This decides to populate the portal with default data</li></ul></div></li><li class="listitem">Provide details about <strong>Administrator User</strong>:<div><ul class="itemizedlist"><li class="listitem"><strong>First Name</strong> and <strong>Last Name</strong></li><li class="listitem"><strong>E-mail</strong> address</li></ul></div></li><li class="listitem">Choose the database engine (optional). In the previous recipe, we set properties with a MySql connection.</li><li class="listitem">Confirm the form.</li><li class="listitem">Click on the <strong>Go to My Portal</strong> button.</li><li class="listitem">Click on the <strong>I agree</strong> button on the <strong>Terms of Use</strong> screen.</li><li class="listitem">Fill in the <strong>Password Reminder</strong> form and confirm the form.<p>After confirming the <strong>Password Reminder</strong> form, you will be able to see and use the main Liferay navigation tools.</p></li></ol><div></div><p>Follow these steps to navigate to <strong>Control Panel</strong>:</p><div><ol class="orderedlist arabic"><li class="listitem">Click on the <strong>Admin</strong> button located on the dockbar menu.</li><li class="listitem">Click on the <strong>Control Panel</strong> link.</li></ol><div></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec18"/>How it works…</h2></div></div></div><p>After running Liferay for the first time, Liferay needs basic information about the portal, database, and administrator. The database connection was set in <code class="literal">portal-ext.properties</code>, and it was described in the previous recipe.</p><p>All data which was provided on the portal wizard was stored in the <code class="literal">${liferay.home}/portal-setup-wizard.properties</code> file. The most important settings are described in the following table:</p><div><table border="1"><colgroup><col/><col/></colgroup><thead><tr><th valign="bottom">
<p>Property name</p>
</th><th valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td valign="top">
<p>
<code class="literal">admin.email.from.name</code>
</p>
</td><td valign="top">
<p>This describes the name of the administrator.</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">admin.email.from.address</code>
</p>
</td><td valign="top">
<p>This is the e-mail address of the administrator.</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">liferay.home</code>
</p>
</td><td valign="top">
<p>This is the path to the <code class="literal">${liferay.home}</code> directory. This property is very important and must be set.</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">setup.wizard.enabled</code>
</p>
</td><td valign="top">
<p>This flag disables the setup wizard.</p>
</td></tr></tbody></table></div><p>After logging in, the user is able to see navigation tools available for authorized users only. Here are the navigation tools:</p><div><ul class="itemizedlist"><li class="listitem">The <a id="id31" class="indexterm"/>dockbar menu is located under the top screen edge. The <a id="id32" class="indexterm"/>dockbar consist of three buttons:<div><ul class="itemizedlist"><li class="listitem">The <strong>Admin</strong> button that allows us to navigate to the <strong>Site Administration</strong> and <strong>Control Panel</strong> sections</li><li class="listitem">The <strong>My Sites</strong> button that lists links to sites that the user is a member of</li><li class="listitem">The button with <em>user name</em> and <em>surname</em> that allows us to navigate to user's profile (<strong>My Profile</strong>), user's dashboard (<strong>My Dashboard</strong>), user's account (<strong>My Account</strong>), and also allows the user to log out</li></ul></div></li><li class="listitem">The fast edition menu is located near the left edge of the screen. The menu consists of the following icons:<div><ul class="itemizedlist"><li class="listitem">The <strong>Add</strong> icon that allows us to add a new page, a new application to the page, or new content</li><li class="listitem">The <strong>Edit</strong> icon that allows us to edit the settings of the currently viewed page</li><li class="listitem">The <strong>Preview</strong> icon that allows us to view the currently viewed page in different resolutions and devices</li><li class="listitem">The <strong>Edit Controls</strong> icon that allows us to hide or show controls of portlets</li></ul></div></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec19"/>There's more…</h2></div></div></div><p>In internal projects such as intranets, user accounts most often are created and managed in external systems, for instance, LDAP. Therefore, it is unnecessary (and sometimes even unacceptable) to allow users to manage their authentication data (for instance, to set a password-reminder query) or ask them to agree to terms of use directly within Liferay. In Liferay, there are many properties that can help customize the first login action, a few of which are as follows:</p><div><table border="1"><colgroup><col/><col/></colgroup><thead><tr><th valign="bottom">
<p>Property name</p>
</th><th valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td valign="top">
<p>
<code class="literal">terms.of.use.required=false</code>
</p>
</td><td valign="top">
<p>This turns off the terms of use</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">terms.of.use.journal.article.group.id</code> and <code class="literal">terms.of.use.journal.article.id</code>
</p>
</td><td valign="top">
<p>This specifies the group ID and article ID that will be displayed as the terms of use</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">users.reminder.queries.enabled=false</code>
</p>
</td><td valign="top">
<p>This disables the reminder query functionality</p>
</td></tr></tbody></table></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec20"/>See also</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">For<a id="id33" class="indexterm"/> information on adding new users and defining<a id="id34" class="indexterm"/> roles and permissions, refer to the <em>Adding a new user</em> recipe in <a class="link" title="Chapter 3. Working with a Liferay User / User Group / Organization" href="part0030.xhtml#aid-SJGS1">Chapter 3</a>, <em>Working with Liferay User / User Group / Organization</em></li><li class="listitem"><em>Creating and configuring roles</em> and <em>Assigning user roles</em> recipes in <a class="link" title="Chapter 5. Roles and Permissions" href="part0045.xhtml#aid-1AT9A1">Chapter 5</a>, <em>Roles and Permissions</em></li><li class="listitem">For information on the default login page, refer to the <em>Overriding the default login page with the administrator defined page</em> recipe in <a class="link" title="Chapter 2. Authentication and Registration Process" href="part0020.xhtml#aid-J2B81">Chapter 2</a>, <em>Authentication and Registration Process</em></li></ul></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Setting up the developer's environment</h1></div></div></div><p>Many developers want to customize Liferay Portal to fit it to a client's requirements. Also, in this book, there will be a number of examples of code, so the setting environment is an important step to start with. Liferay mentions that there are two types of development and two ways to get sources:</p><div><ul class="itemizedlist"><li class="listitem"><strong>GitHub</strong>: For <a id="id35" class="indexterm"/>contributors</li><li class="listitem"><strong>sourceforge.net</strong>: For <a id="id36" class="indexterm"/>non-contributors</li></ul></div><p>For the<a id="id37" class="indexterm"/> purpose of this book, it is enough to use the non-contributors version only.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec21"/>Getting ready</h2></div></div></div><p>The minimal requirements to use Liferay Portal are <strong>Java Development Kit</strong> (<strong>JDK</strong>), Apache Ant with 1.7 version<a id="id38" class="indexterm"/> or later, and Eclipse IDE Indigo or later. Make sure that the installation is successful by typing the following lines of code:</p><div><pre class="programlisting">
<strong>$ ant -version</strong>
<strong>Apache Ant(TM) version 1.8.2 compiled on May 18 2012</strong>

<strong>$ java -version</strong>
<strong>java version "1.7.0_45"</strong>
<strong>Java(TM) SE Runtime Environment (build 1.7.0_45-b18)</strong>
<strong>Java HotSpot(TM) 64-Bit Server VM (build 24.45-b08, mixed mode)</strong>
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec22"/>How to do it...</h2></div></div></div><p>This recipe is divided into three sections. The first section contains a description of preparatory<a id="id39" class="indexterm"/> activities such as downloading Liferay sources or unpacking them. The second one provides a description about the required configuration. The last section focuses on compiling all Liferay sources and deploying them into Apache Tomcat server.</p><div><div><div><div><h3 class="title"><a id="ch01lvl3sec05"/>Import sources to the Eclipse IDE</h3></div></div></div><p>The<a id="id40" class="indexterm"/> first step is importing<a id="id41" class="indexterm"/> Liferay sources as a project in our IDE. These steps are based on Eclipse IDE. To achieve this, follow these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">In <code class="literal">${liferay.home}</code>, create a <code class="literal">workspace</code> folder.</li><li class="listitem">Go to <a class="ulink" href="http://sourceforge.net/projects/lportal/files/Liferay%20Portal/">http://sourceforge.net/projects/lportal/files/Liferay%20Portal/</a> and choose the folder with the newest 6.x version. Next, find the file with the prefix <code class="literal">liferay-portal-src-*</code> and download it.</li><li class="listitem">Unpack this file into the <code class="literal">workspace</code> folder.</li><li class="listitem">Import this project to Eclipse IDE by going to <strong>File</strong> | <strong>Import</strong> | <strong>General</strong> | <strong>Existing</strong> <strong>Projects into Workspace</strong> and click on the <strong>Next</strong> button. On the next screen, select <strong>Select root directory</strong> and point to the folder with Liferay sources, which is <code class="literal">${liferay.home}/workspace/liferay-portal-src-${VERSION}</code>. To complete this task, click on the <strong>Finish</strong> button.</li><li class="listitem">After this step, it is necessary to create a folder called <code class="literal">/portal-web/test/functional</code> in the project. This actions resolves a warning in the Eclipse IDE with the following message: <strong>Build path entry is missing: Liferay-portal-src.6.2-ce-ga2/portal-web/test/functional</strong>.</li></ol><div></div></div><div><div><div><div><h3 class="title"><a id="ch01lvl3sec06"/>Override app.server.properties</h3></div></div></div><p>To be <a id="id42" class="indexterm"/>compatible with the existing Tomcat, which is placed in the <code class="literal">${liferay.home}/tomcat-7.0.42</code> folder, change the <code class="literal">app.server.parent.dir</code> properties. To achieve this, follow these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Create <code class="literal">app.server.${username}.properties</code> in the main folder of the project, which is <code class="literal">${liferay.home}/workspace/liferay-portal-src-${VERSION}</code>.</li><li class="listitem">Override <code class="literal">Server directory</code> properties and set a new value:<div><pre class="programlisting">app.server.parent.dir=${project.dir}/../../</pre></div><p>It could also be an absolute path to Tomcat's parent folder.</p><p>The <code class="literal">${liferay.home}</code> folder should have the following hierarchy:</p><div><pre class="programlisting">  .
  |-data
  |---document_library
  |---hsql
  |---lucene
  |-deploy
  |-license
  |-logs
  |-tomcat-7.0.42
  |---bin
  |---conf
  |---lib
  |---logs
  |---temp
  |---webapps
  |-workspace
  |---liferay-portal-src-6.2-ce-ga2</pre></div></li></ol><div></div></div><div><div><div><div><h3 class="title"><a id="ch01lvl3sec07"/>Compile and deploy</h3></div></div></div><p>Go to <code class="literal">{$liferay.home}/workspace/liferay-portal-src-${VERSION}</code> and compile <a id="id43" class="indexterm"/>all Liferay sources using the <code class="literal">ant all</code> target <a id="id44" class="indexterm"/>in a command line.</p><div><h3 class="title"><a id="note04"/>Note</h3><p>In this book, we will use a console approach to compile, deploy, and so on. Liferay provides Eclipse with Liferay IDE. For proper understanding, we will use command line as the main tool.</p></div></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec23"/>How it works</h2></div></div></div><p>It could be a source of criticism that Liferay is managed by Apache Ant instead of Maven, Gradle, or other build-automation tools. As a matter of fact, the Apache Ant tool is sufficient to manage and compile the Liferay core. If someone wants to use Maven, they are free to use it in custom portlets. Liferay offers many archetypes to help create Maven projects for multiple plugins.</p><p>Let's take a closer look at the project in Eclipse IDE. There are many folders that contain huge bunches <a id="id45" class="indexterm"/>of packages. Let's examine the most important folders with regard to Liferay architecture:</p><div><table border="1"><colgroup><col/><col/></colgroup><thead><tr><th valign="bottom">
<p>Folder name</p>
</th><th valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td valign="top">
<p>
<code class="literal">Definitions</code>
</p>
</td><td valign="top">
<p>This contains the <code class="literal">dtd</code> and <code class="literal">xsd</code> definitions, for instance, the <code class="literal">portlet.xml</code> definition or the <code class="literal">service.xml</code> definition.</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">portal-impl</code>
</p>
</td><td valign="top">
<p>This is the central core of the portal. It implements all the interfaces that are exposed in global <code class="literal">lib</code>. Also, it contains model definitions. Never put <code class="literal">portal-impl</code> anywhere other than where it came from.</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">portal-service</code>
</p>
</td><td valign="top">
<p>This provides the interfaces' definitions, which can be used in custom implementation, for instance hooks, portlets, themes, and so on.</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">util-bridges</code>
</p>
</td><td valign="top">
<p>This contains bridges and utilities, which can be helpful to implement custom portlets, such as AlloyPortlet, BSFPortlet, MVCPortlet, and so on.</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">portal-web</code>
</p>
</td><td valign="top">
<p>This contains the web application root, which has all the configuration files and view tier.</p>
</td></tr></tbody></table></div><p>Let's get back<a id="id46" class="indexterm"/> to the compile command, <code class="literal">ant all</code>. What exactly happened here? Portal has its own runtime structure. It provides ready-to-use bundles with Tomcat, JBoss, or other application servers. It gives a tool that<a id="id47" class="indexterm"/> can build a runtime bundle. In the main <code class="literal">build.xml</code> Ant file, there is a definition of Ant target <a class="ulink" href="https://ant.apache.org/manual/targets.html">https://ant.apache.org/manual/targets.html</a>:</p><div><pre class="programlisting">&lt;target name="all"&gt;
  &lt;antcall target="clean" /&gt;
  &lt;antcall target="start" /&gt;
  &lt;antcall target="deploy" /&gt;
&lt;/target&gt;</pre></div><p>The building process consists of three parts: clean, start, and deploy.</p><div><div><div><div><h3 class="title"><a id="ch01lvl3sec08"/>Clean process</h3></div></div></div><p>The <code class="literal">ant clean</code> command performs the following steps:</p><div><ul class="itemizedlist"><li class="listitem">It cleans Java classes under the following folders: <code class="literal">classes</code>, <code class="literal">portal-service</code>, <code class="literal">util-bridges</code>, <code class="literal">util-java</code>, <code class="literal">util-slf4j</code>, <code class="literal">util-taglib</code>, <code class="literal">portal-impl</code>, <code class="literal">portal-pacl</code>, <code class="literal">osgi/bootrstap</code>, <code class="literal">portal-web</code> and <code class="literal">sql</code></li><li class="listitem">It deletes files with mask <code class="literal">*.ear</code>, <code class="literal">*.jar</code>, <code class="literal">*.war</code>, and <code class="literal">*.zip</code></li><li class="listitem">It cleans the <code class="literal">work</code>, <code class="literal">temp</code>, and <code class="literal">logs</code> Tomcat folders and removes the <code class="literal">*-hook.xml</code> and <code class="literal">*-portlet.xml</code> files from the <code class="literal">/conf/Catalina/localhost</code> directory</li></ul></div><p>There are<a id="id48" class="indexterm"/> some more steps that clean or delete many configuration files depending on the application server. To understand the processes used in this book, it is not important to know every step and deep cleaning process.</p></div><div><div><div><div><h3 class="title"><a id="ch01lvl3sec09"/>Start process</h3></div></div></div><p>The <code class="literal">ant start</code> target invokes the following tasks:</p><div><ul class="itemizedlist"><li class="listitem">It runs the compile target that compiles sources under the <code class="literal">portal-service</code>, <code class="literal">util-bridges</code>, <code class="literal">util-java</code>, <code class="literal">util-slf4j</code>, <code class="literal">util-taglib</code>, <code class="literal">portal-impl</code>, <code class="literal">portal-pacl</code>, and <code class="literal">osgi/bootstrap</code> folders</li><li class="listitem">It builds a <a id="id49" class="indexterm"/>database and rebuilds the hypersonic database</li><li class="listitem">It builds themes under the <code class="literal">portal-impl</code> folder</li><li class="listitem">It calls the <code class="literal">jar</code> target that generates JAR's and WAR of the Liferay core</li></ul></div></div><div><div><div><div><h3 class="title"><a id="ch01lvl3sec10"/>Deploy process</h3></div></div></div><p>This target is<a id="id50" class="indexterm"/> strictly dependent on the application server. In general, this build deploys applications into a specific servlet container or application server. Furthermore, this build creates the required folders or files under <code class="literal">${liferay.home}</code>. The folders that this build creates are as follows:</p><div><ul class="itemizedlist"><li class="listitem">The <code class="literal">deploy</code> folder for the hotdeploy process</li><li class="listitem">The <code class="literal">data</code> folder, which contains binary data, such as document library, Jackrabbit, HSQLDB, or Lucene</li><li class="listitem">The <code class="literal">ROOT.xml</code> context configuration file in <code class="literal">${app.server.dir}/conf/Catalina/localhost/</code> and many other tasks depending on the application server</li></ul></div></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec24"/>There's more...</h2></div></div></div><p>As mentioned <a id="id51" class="indexterm"/>earlier, it is possible to create a full bundle without manually downloading Tomcat or other application server. There are only two steps in order to achieve this goal:</p><div><ul class="itemizedlist"><li class="listitem">Invoke the <code class="literal">ant -buildfile build-dist.xml unzip-tomcat</code> task</li><li class="listitem">Invoke the <code class="literal">ant all</code> command</li></ul></div><p>It is possible to deploy Liferay on a different application server. There is a whole range of commands that do this:</p><div><pre class="programlisting">
<strong>ant -buildfile build-dist.xml build-dist-geronimo</strong>
<strong>ant -buildfile build-dist.xml build-dist-glassfish</strong>
<strong>ant -buildfile build-dist.xml build-dist-jboss</strong>
<strong>ant -buildfile build-dist.xml build-dist-jboss-eap</strong>
<strong>ant -buildfile build-dist.xml build-dist-jetty</strong>
<strong>ant -buildfile build-dist.xml build-dist-jonas</strong>
<strong>ant -buildfile build-dist.xml build-dist-resin</strong>
<strong>ant -buildfile build-dist.xml build-dist-tcat</strong>
<strong>ant -buildfile build-dist.xml build-dist-tomcat</strong>
</pre></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Creating a custom portlet</h1></div></div></div><p>This recipe is <a id="id52" class="indexterm"/>very specific, because it shows how to generate a new portlet, install it on Liferay, and import it to the Eclipse IDE. Many recipes from this book assume that the user knows how to generate a new plugin, such as portlet, hook, or web. We will show you how to generate a new portlet using Apache Maven archetypes. The whole book assumes that you use Apache Maven to compile and deploy new portlets.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec25"/>Getting ready</h2></div></div></div><p>In order to correctly generate a new portlet, you need to have the following software stack:</p><div><ul class="itemizedlist"><li class="listitem">Java SDK 1.7 or later</li><li class="listitem">Apache Maven, we use 3.0.5 version</li><li class="listitem">Eclipse IDE (Kepler or later)</li></ul></div><p>We also assume that you properly set the developer's environment, which was described in the previous recipe.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec26"/>How to do it…</h2></div></div></div><p>There are three phases to achieve our goal: generating a new portlet, compiling it, and deploying and importing it to the Eclipse IDE.</p><div><div><div><div><h3 class="title"><a id="ch01lvl3sec11"/>Generating a new portlet</h3></div></div></div><p>The first thing we<a id="id53" class="indexterm"/> need to do is to create a Maven project. In order to generate it, follow these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Go to the <code class="literal">${liferay.home}/workspace</code> folder.</li><li class="listitem">Execute <code class="literal">mvn archetype:generate -Dfilter=liferay-portlet-archetype</code>.</li><li class="listitem">Choose a number for <code class="literal">com.liferay.maven.archetypes:liferay-portlet-archetype</code>. In our list, it is number <code class="literal">1</code>:<div><pre class="programlisting">Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): : 1</pre></div></li><li class="listitem">Choose the correct Liferay version. In our example, it will be 6.2.2, with the number <code class="literal">24</code>.</li><li class="listitem">Provide all the<a id="id54" class="indexterm"/> required Maven project information as follows:<div><pre class="programlisting">Define value for property 'groupId': : com.packtpub.portlet
Define value for property 'artifactId': : first-portlet
Define value for property 'version':  1.0-SNAPSHOT: : 
Define value for property 'package':  com.packtpub.portlet: : 
Confirm properties configuration:
groupId: com.packtpub.portlet
artifactId: first-portlet
version: 1.0-SNAPSHOT
package: com.packtpub.portlet
Y: : y</pre></div></li><li class="listitem">In our <code class="literal">workspace</code> folder, a portlet called <code class="literal">first-portlet</code> should be generated.</li></ol><div></div></div><div><div><div><div><h3 class="title"><a id="ch01lvl3sec12"/>Compiling the portlet and deploying it</h3></div></div></div><p>With Apache Maven, it is easy to compile and deploy a portlet. Before invoking the Maven <a id="id55" class="indexterm"/>command, users have to set specific properties in<a id="id56" class="indexterm"/> the <code class="literal">pom.xml</code> file.</p><div><ol class="orderedlist arabic"><li class="listitem">Go to the <code class="literal">${liferay.home}/workspace/first-portlet</code> folder and edit the <code class="literal">pom.xml</code> file.</li><li class="listitem">Under the <code class="literal">&lt;build&gt;</code> section, add the following properties definition:<div><pre class="programlisting">&lt;properties&gt;
  &lt;liferay.version&gt;6.2.2&lt;/liferay.version&gt;
  &lt;liferay.maven.plugin.version&gt;6.2.2&lt;/liferay.maven.plugin.version&gt;
  &lt;liferay.auto.deploy.dir&gt;${liferay.home}/deploy&lt;/liferay.auto.deploy.dir&gt;
  &lt;liferay.app.server.deploy.dir&gt;${liferay.home}/tomcat-7.0.42/webapps&lt;/liferay.app.server.deploy.dir&gt;
  &lt;liferay.app.server.lib.global.dir&gt;${liferay.home}/tomcat-7.0.42/lib/ext&lt;/liferay.app.server.lib.global.dir&gt;
  &lt;liferay.app.server.portal.dir&gt;${liferay.home}/tomcat-7.0.42/webapps/ROOT&lt;/liferay.app.server.portal.dir&gt;
&lt;/properties&gt;</pre></div><div><h3 class="title"><a id="tip04"/>Tip</h3><p>Replace <code class="literal">${liferay.home}</code> with the real path to your folders.</p></div></li><li class="listitem">Save the <code class="literal">pom.xml</code> file.</li><li class="listitem">Build a new project by executing the following command:<div><pre class="programlisting">
<strong>mvn clean install</strong>
</pre></div></li><li class="listitem">Make <a id="id57" class="indexterm"/>sure that your Apache Tomcat is running with <a id="id58" class="indexterm"/>Liferay.</li><li class="listitem">Invoke the <code class="literal">mvn liferay:deploy</code> command and follow the <code class="literal">catalina.out</code> logfile. You should see a similar message:<div><pre class="programlisting">
<strong>[PortletHotDeployListener:343] Registering portlets for first-portlet</strong>
<strong>[PortletHotDeployListener:490] 1 portlet for first-portlet is available for use</strong>
</pre></div></li></ol><div></div></div><div><div><div><div><h3 class="title"><a id="ch01lvl3sec13"/>Importing the portlet to the Eclipse IDE</h3></div></div></div><p>After <a id="id59" class="indexterm"/>successfully generating sources by the Maven<a id="id60" class="indexterm"/> archetype plugin, the sources of our portlet can be imported to our Eclipse IDE. To import them, follow these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Make sure that you are in the <code class="literal">${liferay.home}/workspace/first-portlet</code> folder.</li><li class="listitem">Run the <code class="literal">mvn eclipse:clean eclipse:eclipse</code> command.</li><li class="listitem">Open your IDE and import <code class="literal">first-portlet</code> as a project by going to <strong>File</strong> | <strong>Import</strong> | <strong>General</strong> | <strong>Existing</strong> <strong>Projects into Workspace</strong>.</li></ol><div></div></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec27"/>How it works…</h2></div></div></div><p>A portlet project created from <code class="literal">com.liferay.maven.archetypes:liferay-portlet-archetype</code> has ready-to-use portlet implementation. In fact, it is very basic, but the entire folder's structure and configuration files are correctly created. Each portlet has four configuration files: <code class="literal">portlet.xml</code>, <code class="literal">liferay-portlet.xml</code>, <code class="literal">liferay-display.xml</code>, and <code class="literal">liferay-plugin-package.properties</code>. All of these files are placed in the <code class="literal">first-portlet/src/main/webapp/WEB-INF</code> folder.</p><p>The <code class="literal">portlet.xml</code> file is a portlet descriptor. It contains a portlet definition, such as name, portlet class, and so on.</p><p>The <code class="literal">liferay-portlet.xml</code> file is a kind of extension of <code class="literal">portlet.xml</code>. It is only understood by Liferay Portal. It gives additional information such as portlet's icon, path to the <code class="literal">css</code> and <code class="literal">js</code> files, and so on.</p><p>The <code class="literal">liferay-display.xml</code> file tells us in which section our portlet will be available. We will describe it later in the book.</p><p>The <code class="literal">liferay-plugin-package.properties</code> file is a metric of our portlet. This is a good place to specify version, tags, page URL, author, and license.</p><p>Detailed information on portlets is available in the JSR-168 and JSR-286 specification. There are many <a id="id61" class="indexterm"/>examples on how to use portlets, how to establish communication between portlets, or what is a portlet request lifecycle.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec28"/>See also</h2></div></div></div><p>For more information on portlets, refer to the following recipes:</p><div><ul class="itemizedlist"><li class="listitem">The <em>Creating a role-dependent portlet</em> recipe in <a class="link" title="Chapter 5. Roles and Permissions" href="part0045.xhtml#aid-1AT9A1">Chapter 5</a>, <em>Roles and Permissions</em></li><li class="listitem">The <em>Checking permissions in a custom portlet</em> recipe in <a class="link" title="Chapter 5. Roles and Permissions" href="part0045.xhtml#aid-1AT9A1">Chapter 5</a>, <em>Roles and Permissions</em></li><li class="listitem">The <em>language properties hook</em> recipe in <a class="link" title="Chapter 11. Quick Tricks and Advanced Knowledge" href="part0080.xhtml#aid-2C9D01">Chapter 11</a>, <em>Quick Tricks and Advanced Knowledge</em></li><li class="listitem">The <em>Using Liferay Service Bus for communication between portlets</em> recipe in <a class="link" title="Chapter 11. Quick Tricks and Advanced Knowledge" href="part0080.xhtml#aid-2C9D01">Chapter 11</a>, <em>Quick Tricks and Advanced Knowledge</em></li></ul></div></div></div></body></html>