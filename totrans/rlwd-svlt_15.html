<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer044">
<h1 class="chapter-number" id="_idParaDest-209"><a id="_idTextAnchor211"/>15</h1>
<h1 id="_idParaDest-210"><a id="_idTextAnchor212"/>Accessibility with Transitions</h1>
<p>In the past two chapters, we learned how to use transitions in Svelte. Transitions, when used correctly, can enhance the user experience, guiding a user’s attention, providing feedback, and adding a layer of polish to the interface. However, for users with vestibular disorders, these animations can be uncomfortable or even debilitating. Therefore, it is essential to strike a balance between creating engaging animations and ensuring that they do not negatively impact users with <span class="No-Break">specific needs.</span></p>
<p>In this chapter, we will dive into the techniques available to make web transition more accessible for users with a vestibular disorder, exploring CSS and JavaScript approaches to respect a user’s preferences <span class="No-Break">regarding motion.</span></p>
<p>By the end of this chapter, you will have a better understanding of web accessibility and how to create more inclusive web applications that cater to all users, regardless of their specific needs <span class="No-Break">or preferences.</span></p>
<p>In this chapter, we will cover <span class="No-Break">the following:</span></p>
<ul>
<li>What is <span class="No-Break">web accessibility?</span></li>
<li>Understanding user preference <span class="No-Break">with </span><span class="No-Break"><strong class="source-inline">prefers-reduced-motion</strong></span></li>
<li>Reducing motion for a <span class="No-Break">Svelte transition</span></li>
<li>Having an alternative transition for <span class="No-Break">inaccessible users</span></li>
</ul>
<p>Let’s start by exploring what web <span class="No-Break">accessibility is.</span></p>
<h1 id="_idParaDest-211"><a id="_idTextAnchor213"/>Technical requirements</h1>
<p>All the code in this chapter can be found at the following <span class="No-Break">link: </span><a href="https://github.com/PacktPublishing/Real-World-Svelte/tree/main/Chapter15/01-accessible-transition"><span class="No-Break">https://github.com/PacktPublishing/Real-World-Svelte/tree/main/Chapter15/01-accessible-transition</span></a></p>
<h1 id="_idParaDest-212"><a id="_idTextAnchor214"/>What is web accessibility?</h1>
<p>Accessibility is<a id="_idIndexMarker588"/> the <a id="_idIndexMarker589"/>design of products, devices, services, or environments to be usable by as many people as possible, regardless of any physical, sensory, or cognitive disabilities they <span class="No-Break">may have.</span></p>
<p>It is vital to ensure that websites are accessible to all users. There are many disabilities that can potentially affect a user’s experience on a website. Ensuring a website’s accessibility allows everyone, regardless of their abilities, to have equal access to the same services and information that are available <span class="No-Break">to everyone.</span></p>
<p>One of the many disabilities that can hinder a website’s user experience is a vestibular disorder. In this chapter, we will specifically focus on enhancing accessibility for individuals with <span class="No-Break">vestibular disorders.</span></p>
<p>Vestibular disorders are conditions that affect the inner ear and brain, and they can cause difficulties with balance, spatial orientation, and movement perception. Imagine that your body’s natural sense of balance isn’t working right. It’s like being dizzy or feeling tipsy. The ground under your feet doesn’t feel stable, and the things you see around you seem to move on their own, even if you’re <span class="No-Break">standing still.</span></p>
<p>For individuals with vestibular disorders, certain visual stimuli, such as moving or flashing content on a web page, can trigger symptoms such as dizziness, nausea, <span class="No-Break">or migraines.</span></p>
<p>We learned how to add transitions in <a href="B18887_13.xhtml#_idTextAnchor187"><span class="No-Break"><em class="italic">Chapter 13</em></span></a> and <a href="B18887_14.xhtml#_idTextAnchor202"><span class="No-Break"><em class="italic">Chapter 14</em></span></a> to make our application more engaging for users. However, for users with vestibular disorders, these transitions can inadvertently provide a negative experience. Most operating systems provide accessibility settings, enabling users with vestibular disorders to reduce or remove animation. These accessibility preferences can be used by web applications to create an inclusive <span class="No-Break">user experience.</span></p>
<p>So, let’s explore how a web application accesses a user’s <span class="No-Break">accessibility preference.</span></p>
<h1 id="_idParaDest-213"><a id="_idTextAnchor215"/>Understanding user preference with prefers-reduced-motion</h1>
<p>Most operating systems<a id="_idIndexMarker590"/> offer accessibility settings that allow users to disable animation effects. For instance, in Windows 11, you can navigate to <strong class="bold">Settings</strong> | <strong class="bold">Accessibility</strong> | <strong class="bold">Visual Effects</strong> | <strong class="bold">Animation Effects</strong> and uncheck the <strong class="bold">Animation Effects</strong> option to turn <span class="No-Break">off</span><span class="No-Break"><a id="_idIndexMarker591"/></span><span class="No-Break"> animations.</span></p>
<p class="IMG---Figure">igure 15.1: The Animation effects option in Window 11</p>
<p>In web applications, you can use the <strong class="source-inline">prefers-reduced-motion</strong> CSS media query to determine whether a user has activated a setting on their device to reduce or eliminate <span class="No-Break">non-essential motion.</span></p>
<p>Here is an example of how to use the <strong class="source-inline">prefers-reduced-motion</strong> CSS <span class="No-Break">media query:</span></p>
<pre class="source-code">
@media (prefers-reduced-motion: reduce) {
  div {
    /* Removes animation */
    animation: none;
  }
}</pre> <p>In the <a id="_idIndexMarker592"/>preceding code snippet, if a user has indicated a preference for reduced motion, we set the CSS <strong class="source-inline">animation</strong> property to <strong class="source-inline">none</strong> to remove animation from the <strong class="source-inline">&lt;</strong><span class="No-Break"><strong class="source-inline">div&gt;</strong></span><span class="No-Break"> element.</span></p>
<p>Alternatively, besides using CSS, you can also use JavaScript to determine a user’s preference for reduced motion. The <strong class="source-inline">window.matchMedia</strong> method lets you check whether the web page matches a given media <span class="No-Break">query string.</span></p>
<p>In the following code snippet, we use <strong class="source-inline">window.matchMedia</strong> to test whether the <strong class="source-inline">prefers-reduced-motion</strong> CSS media query <span class="No-Break">is matched:</span></p>
<pre class="source-code">
const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
const matches = mediaQuery.matches;</pre> <p>If the user prefers reduced motion, then the value of <strong class="source-inline">matches</strong> in the preceding code snippet will be <strong class="source-inline">true</strong>; otherwise, the value of <strong class="source-inline">matches</strong> will <span class="No-Break">be </span><span class="No-Break"><strong class="source-inline">false</strong></span><span class="No-Break">.</span></p>
<p>A user might change their accessibility preferences while browsing a web page. To get notified whenever the user alters their preference for reduced motion, we can listen to the <strong class="source-inline">change</strong> event of the media query. <span class="No-Break">Here’s how:</span></p>
<pre class="source-code">
const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
mediaQuery.addEventListener('change', () =&gt; {
  let matches = mediaQuery.matches;
});</pre> <p>In the preceding code snippet, whenever a user changes their preference for reduced motion, the listener function passed into the <strong class="source-inline">change</strong> event handler will be invoked. It will evaluate the updated user preferences <span class="No-Break">through </span><span class="No-Break"><strong class="source-inline">mediaQuery.matches</strong></span><span class="No-Break">.</span></p>
<p>Now that we’ve learned how to determine user preferences for reduced motion through <strong class="source-inline">prefers-reduced-motion</strong>, let us take a look at how we can use it to reduce Svelte’s transition for users with <span class="No-Break">vestibular disorders.</span></p>
<h1 id="_idParaDest-214"><a id="_idTextAnchor216"/>Reducing motion for Svelte transition</h1>
<p>After<a id="_idIndexMarker593"/> learning how to obtain a user’s preference for reduced motion, let’s now respect that preference by reducing unnecessary motions in our transitions, which could potentially trigger <span class="No-Break">vestibular discomfort.</span></p>
<p>In the following code block, there is an example of our Svelte component, which has a <strong class="source-inline">fly</strong> transition applied to the <span class="No-Break">list items:</span></p>
<pre class="source-code">
&lt;script&gt;
  import { fly } from 'svelte/transition';
  export let list = [];
&lt;/script&gt;
&lt;ul&gt;
  {#each list as item}
    &lt;li transition:fly={{ x: 40 }}&gt;{item}&lt;/li&gt;
  {/each}
&lt;/ul&gt;</pre> <p>In the preceding code, whenever a new item is added to the list, a new <strong class="source-inline">&lt;li&gt;</strong> element will fly in from the right and be inserted into the list. This flying motion could be a trigger for users with <span class="No-Break">vestibular disorders.</span></p>
<p>However, the flying transition is not essential because the application will still function correctly without it. Therefore, if a user has indicated a preference for reduced motion in the system settings, we should respect that preference by reducing or removing the <span class="No-Break">flying transition.</span></p>
<p>One way to achieve this is by setting the duration of the <strong class="source-inline">fly</strong> transition to <strong class="source-inline">0</strong>. This way, the transition will take no time to play and complete and, in effect, will not be played <span class="No-Break">at all.</span></p>
<p>Here’s the<a id="_idIndexMarker594"/> modified version of the previous Svelte component, which does not play the <strong class="source-inline">fly</strong> transition if the user prefers <span class="No-Break">reduced motion:</span></p>
<pre class="source-code">
&lt;script&gt;
  import { fly } from 'svelte/transition';
  export let list = [];
  <strong class="bold">const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');</strong>
  <strong class="bold">let prefersReducedMotion = mediaQuery.matches;</strong>
  <strong class="bold">mediaQuery.addEventListener('change', () =&gt; {</strong>
    <strong class="bold">prefersReducedMotion = mediaQuery.matches;</strong>
  <strong class="bold">});</strong>
&lt;/script&gt;
&lt;ul&gt;
  {#each list as item}
    &lt;li transition:fly={{
      x: 40,
      <strong class="bold">duration: prefersReducedMotion ? 0 : 400,</strong>
    }}&gt;{item}&lt;/li&gt;
  {/each}
&lt;/ul&gt;</pre> <p>In the preceding code snippet, we determine whether a user prefers reduced motion by checking whether the CSS media query, <strong class="source-inline">prefers-reduced-motion: reduce</strong>, is matched, and we store this information in a variable named <strong class="source-inline">prefersReducedMotion</strong>. If <strong class="source-inline">prefersReducedMotion</strong> is <strong class="source-inline">true</strong> (meaning the user prefers reduced motion), then we set the duration of the <strong class="source-inline">fly</strong> transition to <strong class="source-inline">0</strong>. The user will not see any flying motion when a new item is added to <span class="No-Break">the list.</span></p>
<p>On the other <a id="_idIndexMarker595"/>hand, if the user does not have a vestibular disorder and has not expressed a preference for reduced motion effects, then <strong class="source-inline">prefersReducedMotion</strong> will be <strong class="source-inline">false</strong>. In this case, the duration for the <strong class="source-inline">fly</strong> transition will be set to <strong class="source-inline">400 ms</strong>, and a flying transition will be displayed for every new item added to <span class="No-Break">the list.</span></p>
<p>However, not all transitions act as triggers for vestibular motion disturbances. For instance, the <strong class="source-inline">fade</strong> transition, being a subtler animation, isn’t as disruptive to users with vestibular disorders. Instead of entirely eliminating transitions by setting their duration to <strong class="source-inline">0</strong>, we can opt to replace more intense transitions with milder ones. We’ll delve into this approach in the <span class="No-Break">following section.</span></p>
<h1 id="_idParaDest-215"><a id="_idTextAnchor217"/>Having alternative transitions for inaccessible users</h1>
<p>Users with <a id="_idIndexMarker596"/>vestibular disorders may feel discomfort when exposed to motion-based animations, such as scaling or panning large objects. However, they are generally less affected by subtler animations, such <span class="No-Break">as fading.</span></p>
<p>Switching all transitions to fading for users with vestibular disorders is not a one-size-fits-all solution. It is always better to seek feedback from the <span class="No-Break">users themselves.</span></p>
<p>We will continue using the same example from the previous section and explore how we can switch from the <strong class="source-inline">fly</strong> transition to a <strong class="source-inline">fade</strong> transition when a user prefers <span class="No-Break">reduced motion.</span></p>
<p>One thing to note is that, in Svelte, you are not allowed to apply more than one transition to <span class="No-Break">an element.</span></p>
<p>For example, the following code is invalid and will result in a <span class="No-Break">build error:</span></p>
<pre class="source-code">
&lt;div transition:fade transition:fly /&gt;</pre> <p>This means we can’t apply two transitions to an element and then decide which one to use. We must find a way to switch between different transitions while applying only one transition to <span class="No-Break">an element.</span></p>
<p>As we learned in <a href="B18887_14.xhtml#_idTextAnchor202"><span class="No-Break"><em class="italic">Chapter 14</em></span></a> about creating custom transitions, a transition in Svelte is a function that follows a transition contract. The return value from the function determines how the transition will <span class="No-Break">play out.</span></p>
<p>So, one <a id="_idIndexMarker597"/>approach to having a transition that switches between two transitions, based on a condition, is to create a custom transition that returns different transition configurations, based on <span class="No-Break">the condition.</span></p>
<p>Our custom transition would look something like the following code, returning different transition configurations based on whether a user prefers <span class="No-Break">reduced motion:</span></p>
<pre class="source-code">
&lt;script&gt;
  <strong class="bold">function accessibleFly(node, params) {</strong>
<strong class="bold">    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');</strong>
<strong class="bold">    const matches = mediaQuery.matches;</strong>
<strong class="bold">    if (matches) {</strong>
<strong class="bold">      // user prefers reduced motion</strong>
<strong class="bold">      // return a fade transition</strong>
<strong class="bold">    } else {</strong>
<strong class="bold">      // return a fly transition</strong>
<strong class="bold">    }</strong>
<strong class="bold">  }</strong>
&lt;/script&gt;
&lt;ul&gt;
  {#each list as item}
    &lt;li <strong class="bold">transition:accessibleFly</strong>={{ x: 40 }}&gt;{item}&lt;/li&gt;
  {/each}
&lt;/ul&gt;</pre> <p>In the preceding code snippet, we defined an <strong class="source-inline">accessibleFly</strong> transition, which is a more accessible <strong class="source-inline">fly</strong> transition that will switch to a <strong class="source-inline">fade</strong> transition if a user prefers <span class="No-Break">reduced motion.</span></p>
<p>Now, we need to determine what to return in each of the conditional cases within our custom <span class="No-Break"><strong class="source-inline">accessibleFly</strong></span><span class="No-Break"> transition.</span></p>
<p>It’s <a id="_idIndexMarker598"/>important to recall that a transition in Svelte is a JavaScript function. Therefore, we can call both the <strong class="source-inline">fly</strong> and <strong class="source-inline">fade</strong> transitions as functions, and the return value will be the transition configuration for each respective transition. By doing this, we can return these values from our <strong class="source-inline">accessibleFly</strong> transition, effectively allowing our transition to be either a <strong class="source-inline">fly</strong> or <strong class="source-inline">fade</strong> transition, based on a <span class="No-Break">user’s preference.</span></p>
<p>Here’s the updated <span class="No-Break"><strong class="source-inline">accessibleFly</strong></span><span class="No-Break"> transition:</span></p>
<pre class="source-code">
&lt;script&gt;
  function accessibleFly(node, params) {
    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    const matches = mediaQuery.matches;
    if (matches) {
      // user prefers reduced motion
      <strong class="bold">return fade(node, params);</strong>
    } else {
      <strong class="bold">return fly(node, params);</strong>
    }
  }
&lt;/script&gt;</pre> <p>In the preceding code snippet, we return the value either from the <strong class="source-inline">fade</strong> or <strong class="source-inline">fly</strong> transition, depending on a user’s preference. We pass the <strong class="source-inline">node</strong> and <strong class="source-inline">params</strong> values that are given to our <strong class="source-inline">accessibleFly</strong> transition into both the <strong class="source-inline">fade</strong> and <strong class="source-inline">fly</strong> transitions. The <strong class="source-inline">node</strong> and <strong class="source-inline">params</strong> values specify which element the transition is applied to and provide user parameters, such as <strong class="source-inline">duration</strong> and <strong class="source-inline">delay</strong>. These are useful for the <strong class="source-inline">fade</strong> and <strong class="source-inline">fly</strong> transitions to determine how the transitions should <span class="No-Break">be executed.</span></p>
<p>With the<a id="_idIndexMarker599"/> preceding code changes, we now have an accessible <strong class="source-inline">fly</strong> transition named <strong class="source-inline">accessibleFly</strong>, which, by default, will cause an element to fly as part of the transition. However, the <strong class="source-inline">accessibleFly</strong> transition will cause the element to fade if a user has indicated a preference for <span class="No-Break">reduced motion.</span></p>
<p>And there you have it–a transition that is engaging and appealing to most users, while still being considerate of those who prefer <span class="No-Break">reduced motion.</span></p>
<p>You can find the code for the <strong class="source-inline">accessibleFly</strong> transition <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Real-World-Svelte/tree/main/Chapter15/01-accessible-transition"><span class="No-Break">https://github.com/PacktPublishing/Real-World-Svelte/tree/main/Chapter15/01-accessible-transition</span></a><span class="No-Break">.</span></p>
<h1 id="_idParaDest-216"><a id="_idTextAnchor218"/>Summary</h1>
<p>In this chapter, we explored the importance of accessibility in web design and how to implement transitions that consider the preferences of users with vestibular disorders. By understanding the impact of motion-based animations on users with vestibular disorders, we can create more inclusive and user-friendly <span class="No-Break">web applications.</span></p>
<p>We learned about the <strong class="source-inline">prefers-reduced-motion</strong> media query, which allows us to detect whether a user has indicated a preference for reduced motion in their system settings. Using this media query, we can adjust our transitions to be less motion-heavy or remove them altogether for users who prefer <span class="No-Break">reduced motion.</span></p>
<p>We also discussed how to create custom transitions in Svelte for accessibility. We looked at an example of a custom transition, named <strong class="source-inline">accessibleFly</strong>, that switches between a <strong class="source-inline">fly</strong> and a <strong class="source-inline">fade</strong> transition, based on a user’s preferences for reduced motion. This custom transition is considerate of users with vestibular disorders while still providing engaging and interesting transitions for <span class="No-Break">other users.</span></p>
<p>In summary, accessibility is crucial in web design, and transitions are no exception. By considering the preferences and needs of all users, including those with vestibular disorders, we can create more inclusive and user-friendly <span class="No-Break">web applications.</span></p>
</div>
</div></body></html>