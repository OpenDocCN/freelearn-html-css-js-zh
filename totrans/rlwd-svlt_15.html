<html><head></head><body>
<div><div><h1 class="chapter-number" id="_idParaDest-209"><a id="_idTextAnchor211"/>15</h1>
<h1 id="_idParaDest-210"><a id="_idTextAnchor212"/>Accessibility with Transitions</h1>
<p>In the past two chapters, we learned how to use transitions in Svelte. Transitions, when used correctly, can enhance the user experience, guiding a user’s attention, providing feedback, and adding a layer of polish to the interface. However, for users with vestibular disorders, these animations can be uncomfortable or even debilitating. Therefore, it is essential to strike a balance between creating engaging animations and ensuring that they do not negatively impact users with specific needs.</p>
<p>In this chapter, we will dive into the techniques available to make web transition more accessible for users with a vestibular disorder, exploring CSS and JavaScript approaches to respect a user’s preferences regarding motion.</p>
<p>By the end of this chapter, you will have a better understanding of web accessibility and how to create more inclusive web applications that cater to all users, regardless of their specific needs or preferences.</p>
<p>In this chapter, we will cover the following:</p>
<ul>
<li>What is web accessibility?</li>
<li>Understanding user preference with <code>prefers-reduced-motion</code></li>
<li>Reducing motion for a Svelte transition</li>
<li>Having an alternative transition for inaccessible users</li>
</ul>
<p>Let’s start by exploring what web accessibility is.</p>
<h1 id="_idParaDest-211"><a id="_idTextAnchor213"/>Technical requirements</h1>
<p>All the code in this chapter can be found at the following link: <a href="https://github.com/PacktPublishing/Real-World-Svelte/tree/main/Chapter15/01-accessible-transition">https://github.com/PacktPublishing/Real-World-Svelte/tree/main/Chapter15/01-accessible-transition</a></p>
<h1 id="_idParaDest-212"><a id="_idTextAnchor214"/>What is web accessibility?</h1>
<p>Accessibility is<a id="_idIndexMarker588"/> the <a id="_idIndexMarker589"/>design of products, devices, services, or environments to be usable by as many people as possible, regardless of any physical, sensory, or cognitive disabilities they may have.</p>
<p>It is vital to ensure that websites are accessible to all users. There are many disabilities that can potentially affect a user’s experience on a website. Ensuring a website’s accessibility allows everyone, regardless of their abilities, to have equal access to the same services and information that are available to everyone.</p>
<p>One of the many disabilities that can hinder a website’s user experience is a vestibular disorder. In this chapter, we will specifically focus on enhancing accessibility for individuals with vestibular disorders.</p>
<p>Vestibular disorders are conditions that affect the inner ear and brain, and they can cause difficulties with balance, spatial orientation, and movement perception. Imagine that your body’s natural sense of balance isn’t working right. It’s like being dizzy or feeling tipsy. The ground under your feet doesn’t feel stable, and the things you see around you seem to move on their own, even if you’re standing still.</p>
<p>For individuals with vestibular disorders, certain visual stimuli, such as moving or flashing content on a web page, can trigger symptoms such as dizziness, nausea, or migraines.</p>
<p>We learned how to add transitions in <a href="B18887_13.xhtml#_idTextAnchor187"><em class="italic">Chapter 13</em></a> and <a href="B18887_14.xhtml#_idTextAnchor202"><em class="italic">Chapter 14</em></a> to make our application more engaging for users. However, for users with vestibular disorders, these transitions can inadvertently provide a negative experience. Most operating systems provide accessibility settings, enabling users with vestibular disorders to reduce or remove animation. These accessibility preferences can be used by web applications to create an inclusive user experience.</p>
<p>So, let’s explore how a web application accesses a user’s accessibility preference.</p>
<h1 id="_idParaDest-213"><a id="_idTextAnchor215"/>Understanding user preference with prefers-reduced-motion</h1>
<p>Most operating systems<a id="_idIndexMarker590"/> offer accessibility settings that allow users to disable animation effects. For instance, in Windows 11, you can navigate to <strong class="bold">Settings</strong> | <strong class="bold">Accessibility</strong> | <strong class="bold">Visual Effects</strong> | <strong class="bold">Animation Effects</strong> and uncheck the <strong class="bold">Animation Effects</strong> option to turn off<a id="_idIndexMarker591"/> animations.</p>
<p class="IMG---Figure">igure 15.1: The Animation effects option in Window 11</p>
<p>In web applications, you can use the <code>prefers-reduced-motion</code> CSS media query to determine whether a user has activated a setting on their device to reduce or eliminate non-essential motion.</p>
<p>Here is an example of how to use the <code>prefers-reduced-motion</code> CSS media query:</p>
<pre class="source-code">
@media (prefers-reduced-motion: reduce) {
  div {
    /* Removes animation */
    animation: none;
  }
}</pre> <p>In the <a id="_idIndexMarker592"/>preceding code snippet, if a user has indicated a preference for reduced motion, we set the CSS <code>animation</code> property to <code>none</code> to remove animation from the <code>&lt;</code><code>div&gt;</code> element.</p>
<p>Alternatively, besides using CSS, you can also use JavaScript to determine a user’s preference for reduced motion. The <code>window.matchMedia</code> method lets you check whether the web page matches a given media query string.</p>
<p>In the following code snippet, we use <code>window.matchMedia</code> to test whether the <code>prefers-reduced-motion</code> CSS media query is matched:</p>
<pre class="source-code">
const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
const matches = mediaQuery.matches;</pre> <p>If the user prefers reduced motion, then the value of <code>matches</code> in the preceding code snippet will be <code>true</code>; otherwise, the value of <code>matches</code> will be <code>false</code>.</p>
<p>A user might change their accessibility preferences while browsing a web page. To get notified whenever the user alters their preference for reduced motion, we can listen to the <code>change</code> event of the media query. Here’s how:</p>
<pre class="source-code">
const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
mediaQuery.addEventListener('change', () =&gt; {
  let matches = mediaQuery.matches;
});</pre> <p>In the preceding code snippet, whenever a user changes their preference for reduced motion, the listener function passed into the <code>change</code> event handler will be invoked. It will evaluate the updated user preferences through <code>mediaQuery.matches</code>.</p>
<p>Now that we’ve learned how to determine user preferences for reduced motion through <code>prefers-reduced-motion</code>, let us take a look at how we can use it to reduce Svelte’s transition for users with vestibular disorders.</p>
<h1 id="_idParaDest-214"><a id="_idTextAnchor216"/>Reducing motion for Svelte transition</h1>
<p>After<a id="_idIndexMarker593"/> learning how to obtain a user’s preference for reduced motion, let’s now respect that preference by reducing unnecessary motions in our transitions, which could potentially trigger vestibular discomfort.</p>
<p>In the following code block, there is an example of our Svelte component, which has a <code>fly</code> transition applied to the list items:</p>
<pre class="source-code">
&lt;script&gt;
  import { fly } from 'svelte/transition';
  export let list = [];
&lt;/script&gt;
&lt;ul&gt;
  {#each list as item}
    &lt;li transition:fly={{ x: 40 }}&gt;{item}&lt;/li&gt;
  {/each}
&lt;/ul&gt;</pre> <p>In the preceding code, whenever a new item is added to the list, a new <code>&lt;li&gt;</code> element will fly in from the right and be inserted into the list. This flying motion could be a trigger for users with vestibular disorders.</p>
<p>However, the flying transition is not essential because the application will still function correctly without it. Therefore, if a user has indicated a preference for reduced motion in the system settings, we should respect that preference by reducing or removing the flying transition.</p>
<p>One way to achieve this is by setting the duration of the <code>fly</code> transition to <code>0</code>. This way, the transition will take no time to play and complete and, in effect, will not be played at all.</p>
<p>Here’s the<a id="_idIndexMarker594"/> modified version of the previous Svelte component, which does not play the <code>fly</code> transition if the user prefers reduced motion:</p>
<pre class="source-code">
&lt;script&gt;
  import { fly } from 'svelte/transition';
  export let list = [];
  <strong class="bold">const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');</strong>
  <strong class="bold">let prefersReducedMotion = mediaQuery.matches;</strong>
  <strong class="bold">mediaQuery.addEventListener('change', () =&gt; {</strong>
    <strong class="bold">prefersReducedMotion = mediaQuery.matches;</strong>
  <strong class="bold">});</strong>
&lt;/script&gt;
&lt;ul&gt;
  {#each list as item}
    &lt;li transition:fly={{
      x: 40,
      <strong class="bold">duration: prefersReducedMotion ? 0 : 400,</strong>
    }}&gt;{item}&lt;/li&gt;
  {/each}
&lt;/ul&gt;</pre> <p>In the preceding code snippet, we determine whether a user prefers reduced motion by checking whether the CSS media query, <code>prefers-reduced-motion: reduce</code>, is matched, and we store this information in a variable named <code>prefersReducedMotion</code>. If <code>prefersReducedMotion</code> is <code>true</code> (meaning the user prefers reduced motion), then we set the duration of the <code>fly</code> transition to <code>0</code>. The user will not see any flying motion when a new item is added to the list.</p>
<p>On the other <a id="_idIndexMarker595"/>hand, if the user does not have a vestibular disorder and has not expressed a preference for reduced motion effects, then <code>prefersReducedMotion</code> will be <code>false</code>. In this case, the duration for the <code>fly</code> transition will be set to <code>400 ms</code>, and a flying transition will be displayed for every new item added to the list.</p>
<p>However, not all transitions act as triggers for vestibular motion disturbances. For instance, the <code>fade</code> transition, being a subtler animation, isn’t as disruptive to users with vestibular disorders. Instead of entirely eliminating transitions by setting their duration to <code>0</code>, we can opt to replace more intense transitions with milder ones. We’ll delve into this approach in the following section.</p>
<h1 id="_idParaDest-215"><a id="_idTextAnchor217"/>Having alternative transitions for inaccessible users</h1>
<p>Users with <a id="_idIndexMarker596"/>vestibular disorders may feel discomfort when exposed to motion-based animations, such as scaling or panning large objects. However, they are generally less affected by subtler animations, such as fading.</p>
<p>Switching all transitions to fading for users with vestibular disorders is not a one-size-fits-all solution. It is always better to seek feedback from the users themselves.</p>
<p>We will continue using the same example from the previous section and explore how we can switch from the <code>fly</code> transition to a <code>fade</code> transition when a user prefers reduced motion.</p>
<p>One thing to note is that, in Svelte, you are not allowed to apply more than one transition to an element.</p>
<p>For example, the following code is invalid and will result in a build error:</p>
<pre class="source-code">
&lt;div transition:fade transition:fly /&gt;</pre> <p>This means we can’t apply two transitions to an element and then decide which one to use. We must find a way to switch between different transitions while applying only one transition to an element.</p>
<p>As we learned in <a href="B18887_14.xhtml#_idTextAnchor202"><em class="italic">Chapter 14</em></a> about creating custom transitions, a transition in Svelte is a function that follows a transition contract. The return value from the function determines how the transition will play out.</p>
<p>So, one <a id="_idIndexMarker597"/>approach to having a transition that switches between two transitions, based on a condition, is to create a custom transition that returns different transition configurations, based on the condition.</p>
<p>Our custom transition would look something like the following code, returning different transition configurations based on whether a user prefers reduced motion:</p>
<pre class="source-code">
&lt;script&gt;
  <strong class="bold">function accessibleFly(node, params) {</strong>
<strong class="bold">    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');</strong>
<strong class="bold">    const matches = mediaQuery.matches;</strong>
<strong class="bold">    if (matches) {</strong>
<strong class="bold">      // user prefers reduced motion</strong>
<strong class="bold">      // return a fade transition</strong>
<strong class="bold">    } else {</strong>
<strong class="bold">      // return a fly transition</strong>
<strong class="bold">    }</strong>
<strong class="bold">  }</strong>
&lt;/script&gt;
&lt;ul&gt;
  {#each list as item}
    &lt;li <strong class="bold">transition:accessibleFly</strong>={{ x: 40 }}&gt;{item}&lt;/li&gt;
  {/each}
&lt;/ul&gt;</pre> <p>In the preceding code snippet, we defined an <code>accessibleFly</code> transition, which is a more accessible <code>fly</code> transition that will switch to a <code>fade</code> transition if a user prefers reduced motion.</p>
<p>Now, we need to determine what to return in each of the conditional cases within our custom <code>accessibleFly</code> transition.</p>
<p>It’s <a id="_idIndexMarker598"/>important to recall that a transition in Svelte is a JavaScript function. Therefore, we can call both the <code>fly</code> and <code>fade</code> transitions as functions, and the return value will be the transition configuration for each respective transition. By doing this, we can return these values from our <code>accessibleFly</code> transition, effectively allowing our transition to be either a <code>fly</code> or <code>fade</code> transition, based on a user’s preference.</p>
<p>Here’s the updated <code>accessibleFly</code> transition:</p>
<pre class="source-code">
&lt;script&gt;
  function accessibleFly(node, params) {
    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    const matches = mediaQuery.matches;
    if (matches) {
      // user prefers reduced motion
      <strong class="bold">return fade(node, params);</strong>
    } else {
      <strong class="bold">return fly(node, params);</strong>
    }
  }
&lt;/script&gt;</pre> <p>In the preceding code snippet, we return the value either from the <code>fade</code> or <code>fly</code> transition, depending on a user’s preference. We pass the <code>node</code> and <code>params</code> values that are given to our <code>accessibleFly</code> transition into both the <code>fade</code> and <code>fly</code> transitions. The <code>node</code> and <code>params</code> values specify which element the transition is applied to and provide user parameters, such as <code>duration</code> and <code>delay</code>. These are useful for the <code>fade</code> and <code>fly</code> transitions to determine how the transitions should be executed.</p>
<p>With the<a id="_idIndexMarker599"/> preceding code changes, we now have an accessible <code>fly</code> transition named <code>accessibleFly</code>, which, by default, will cause an element to fly as part of the transition. However, the <code>accessibleFly</code> transition will cause the element to fade if a user has indicated a preference for reduced motion.</p>
<p>And there you have it–a transition that is engaging and appealing to most users, while still being considerate of those who prefer reduced motion.</p>
<p>You can find the code for the <code>accessibleFly</code> transition at <a href="https://github.com/PacktPublishing/Real-World-Svelte/tree/main/Chapter15/01-accessible-transition">https://github.com/PacktPublishing/Real-World-Svelte/tree/main/Chapter15/01-accessible-transition</a>.</p>
<h1 id="_idParaDest-216"><a id="_idTextAnchor218"/>Summary</h1>
<p>In this chapter, we explored the importance of accessibility in web design and how to implement transitions that consider the preferences of users with vestibular disorders. By understanding the impact of motion-based animations on users with vestibular disorders, we can create more inclusive and user-friendly web applications.</p>
<p>We learned about the <code>prefers-reduced-motion</code> media query, which allows us to detect whether a user has indicated a preference for reduced motion in their system settings. Using this media query, we can adjust our transitions to be less motion-heavy or remove them altogether for users who prefer reduced motion.</p>
<p>We also discussed how to create custom transitions in Svelte for accessibility. We looked at an example of a custom transition, named <code>accessibleFly</code>, that switches between a <code>fly</code> and a <code>fade</code> transition, based on a user’s preferences for reduced motion. This custom transition is considerate of users with vestibular disorders while still providing engaging and interesting transitions for other users.</p>
<p>In summary, accessibility is crucial in web design, and transitions are no exception. By considering the preferences and needs of all users, including those with vestibular disorders, we can create more inclusive and user-friendly web applications.</p>
</div>
</div></body></html>