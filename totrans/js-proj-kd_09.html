<html><head></head><body><div class="chapter" title="Chapter&#xA0;9.&#xA0;Tidying up Your Code Using OOP"><div class="titlepage"><div><div><h1 class="title"><a id="ch09"/>Chapter 9. Tidying up Your Code Using OOP</h1></div></div></div><p>In this<a class="indexterm" id="id260"/> chapter, we are going to learn about <span class="strong"><strong>object-oriented programming</strong></span> (<span class="strong"><strong>OOP</strong></span>) and<a class="indexterm" id="id261"/> discuss the code of the famous game, <span class="strong"><strong>Hangman</strong></span>.</p><p>"OOP is a programming paradigm that uses abstraction to create models based on the real world. OOP uses several techniques from previously established paradigms, including modularity, polymorphism, and encapsulation." or "OOP languages typically are identified through their use of classes to create multiple objects that have the same properties and methods."</p><p>You probably have assumed that JavaScript is an object-oriented programming language. Yes, you are absolutely correct. Let's see why it is an OOP language. If a computer programming language has the following few features, we call it object oriented:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Inheritance</li><li class="listitem" style="list-style-type: disc">Polymorphism</li><li class="listitem" style="list-style-type: disc">Encapsulation</li><li class="listitem" style="list-style-type: disc">Abstraction</li></ul></div><p>Before going any<a class="indexterm" id="id262"/> further, let's discuss <span class="strong"><strong>objects</strong></span>. We create objects in JavaScript in the following manner:</p><div class="informalexample"><pre class="programlisting">var person = new Object();
person.name = "Harry Potter";
person.age = 22;
person.job = "Magician";</pre></div><p>We created an object for a person. We added few properties of person.</p><p>If we want to access any of the property of the object, we need to call the property.</p><p>Consider that you want to have a popup of the <code class="literal">name</code> property of the preceding <code class="literal">person</code> object. You can do this with the following method:</p><div class="informalexample"><pre class="programlisting">person.callName = function(){
  alert(this.name);
};</pre></div><p>We can write the preceding code as shown in the following:</p><div class="informalexample"><pre class="programlisting">var person = {
  name: "Harry Potter",
  age: 22,
  job: "Magician",
  callName: function(){
  alert(this.name);
  }
};</pre></div><div class="section" title="Inheritance in JavaScript"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec57"/>Inheritance in JavaScript</h1></div></div></div><p>To inherit means derive something (such as, characteristics, quality, and so on) from one's parents<a class="indexterm" id="id263"/> or ancestors. In programming languages, when a class or object is based on another class or object in order to maintain the same behavior of the parent class or object is known as <span class="strong"><strong>inheritance</strong></span>.</p><p>We can also say that this is a concept of gaining properties or behaviors of something else.</p><p>Suppose, X inherits something from Y; it is like X is a type of Y.</p><p>JavaScript occupies the inheritance capability. Let's take a look at an example. A bird inherits from an animal as a bird is a type of animal. Therefore, a bird can do the same thing that an animal does.</p><p>This kind of relationship in JavaScript is a little complex and needs a syntax. We need to use a special object called <code class="literal">prototype</code>, which assigns the properties to a type. We need to remember that only function has prototypes. Our <code class="literal">Animal</code> function should look similar to the following:</p><div class="informalexample"><pre class="programlisting">function Animal(){
//We can code here. 
}; </pre></div><p>To add a few properties of the function, we need to add a prototype as shown in the following:</p><div class="informalexample"><pre class="programlisting">Animal.prototype.eat = function(){
  alert("Animal can eat.");
};</pre></div><p>Let's create prototypes for our <code class="literal">Bird</code> function. Our function and prototypes should look similar to the following:</p><div class="informalexample"><pre class="programlisting">function Bird(){
};
Bird.prototype = new Animal();
Bird.prototype.fly = function(){
  alert("Birds can fly.");
};
Bird.prototype.sing = function(){
  alert("Bird can sing.");
};</pre></div><p>The result <a class="indexterm" id="id264"/>of the prototypes and function is that any <code class="literal">Bird</code> that you create will have the properties of <code class="literal">Animal</code> and <code class="literal">Bird</code>. However, if you create <code class="literal">Animal</code>, this will only have the properties of <code class="literal">Animal</code>. The properties of <code class="literal">Animal</code> are inherited by <code class="literal">Bird</code>.</p><p>Therefore, we can say that JavaScript has inheritance property.</p></div></div>
<div class="section" title="Encapsulation in JavaScript"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec58"/>Encapsulation in JavaScript</h1></div></div></div><p>In OOP, <span class="strong"><strong>encapsulation</strong></span> is one of the most important concepts that allows an <a class="indexterm" id="id265"/>object to group the members of public and private classes under a single name. We use encapsulation to protect our classes against accidental or willful folly. Encapsulation means to enclose something in or as if something is in a capsule.</p><p>Now, we will see whether JavaScript supports encapsulation. If it does, we can say that JavaScript is an OOP language. Let's take a look at the following example:</p><div class="informalexample"><pre class="programlisting">var person = {
  "name" : "Harry Potter",
  "age" : 22,
};
alert(person.name);
person.name = "John";
alert(person.name);</pre></div><p>If we run this on the console. The first alert box will print the following image:</p><div class="mediaobject"><img alt="Encapsulation in JavaScript" src="graphics/B04720_09_01.jpg"/></div><p>We <a class="indexterm" id="id266"/>changed the variable <code class="literal">name</code> to <code class="literal">John</code>. Therefore, the second alert box will be similar to the following image:</p><div class="mediaobject"><img alt="Encapsulation in JavaScript" src="graphics/B04720_09_02.jpg"/></div><p>What would happen if we accidently assigned a number to the <code class="literal">name</code> variable?</p><p>Assigning a<a class="indexterm" id="id267"/> number to the <code class="literal">name</code> variable is perfectly acceptable. As far as JavaScript is concerned, a variable can accept any type of data as its value. However, we don't want a number in the place of a name. What do we do? We can use JavaScript's encapsulation property, as follows:</p><div class="informalexample"><pre class="programlisting">var person = function () {
  var Name = "Harry Potter";
  var reg = new RegExp(/\d+/);
  return { 
    "setName" : function (newValue) {
      if( reg.test(newValue) ) {
        alert("Invalid Name");
      }
      else {
        Name = newValue;
      }
    },
    "getName" : function () {
      return Name; 
    }
  }; 
}(); 

alert(person.getName());   // Harry potter
person.setName( "John" );
alert(person.getName());  // John
person.setName( 42 ); // Invalid Name; the name is not changed.
person.Name = 42;     // Doesn't affect the private Name variable.
alert(person.getName());  // John is printed again.</pre></div><p>Now, if we run the above code on console, the first <a class="indexterm" id="id268"/>output will show a popup with <span class="strong"><strong>Harry Potter</strong></span> as we only called the <code class="literal">getName()</code> function. The <code class="literal">getName()</code> function has an initial value, which is <code class="literal">Harry Potter</code>:</p><div class="mediaobject"><img alt="Encapsulation in JavaScript" src="graphics/B04720_09_03.jpg"/></div><p>The second output will be as follows as we changed the <code class="literal">Name</code> property of <code class="literal">person</code> to <code class="literal">John</code> and again called the <code class="literal">getName()</code> function:</p><div class="mediaobject"><img alt="Encapsulation in JavaScript" src="graphics/B04720_09_04.jpg"/></div><p>The third <a class="indexterm" id="id269"/>output will be as shown in the following as we tried to push a number to a string variable. A name cannot be an integer, therefore, <span class="strong"><strong>Invalid Name</strong></span> popped up as we had a condition under the <code class="literal">if</code> statement:</p><div class="mediaobject"><img alt="Encapsulation in JavaScript" src="graphics/B04720_09_05.jpg"/></div><p>The fourth output will be as shown in the following as the number was not added to the person's <code class="literal">Name</code> property. Therefore, we will get the last data that we pushed to the <code class="literal">Name</code> property:</p><div class="mediaobject"><img alt="Encapsulation in JavaScript" src="graphics/B04720_09_06.jpg"/></div><p>We can now<a class="indexterm" id="id270"/> confirm that JavaScript supports encapsulation.</p><p>JavaScript also<a class="indexterm" id="id271"/> supports <span class="strong"><strong>polymorphism</strong></span> and <span class="strong"><strong>abstraction</strong></span>. If you<a class="indexterm" id="id272"/> would like to read about them, you can refer to the following<a class="indexterm" id="id273"/> link:</p><p>
<a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Introduction_to_Object-Oriented_JavaScript">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Introduction_to_Object-Oriented_JavaScript</a>
</p><p>Let's do something fun. You may have heard of the game called Hangman. We'll discuss the OOP in that game. First, let's introduce you to the game.</p><p>The player <a class="indexterm" id="id274"/>needs to guess a word. If he can guess the word correctly, he is safe; otherwise, he will be hanged. Take a look at the following image to get the clear idea about the game, as follows:</p><div class="mediaobject"><img alt="Encapsulation in JavaScript" src="graphics/B04720_09_07.jpg"/></div></div>
<div class="section" title="Dissecting Hangman"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec59"/>Dissecting Hangman</h1></div></div></div><p>There are two<a class="indexterm" id="id275"/> folders and an HTML file for the Hangman game. The two folders are named as <code class="literal">css</code> and <code class="literal">js</code>. The <code class="literal">index.html</code> HTML file should contain the following code:</p><div class="informalexample"><pre class="programlisting">&lt;html lang="en" ng-app="hangman"&gt; 
  &lt;head&gt;
    &lt;title&gt;Hangman&lt;/title&gt;
    &lt;link rel="stylesheet" href="css/styles.css"&gt;
    &lt;script src="js/angular.min.js"&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body ng-controller="StartHangman"&gt;
    &lt;p&gt;Hangman&lt;/p&gt;
    &lt;svg width="400" height="400"&gt;
      &lt;rect ng-show="failedGuess.length &gt;= 1" x="0" y="0" width="40" height="400"&gt;&lt;/rect&gt;
      &lt;rect ng-show="failedGuess.length &gt;= 2" x="40" y="20" width="200" height="40"&gt;&lt;/rect&gt;
      &lt;rect ng-show="failedGuess.length &gt;= 3" x="173" y="50" width="4" height="100"&gt;&lt;/rect&gt;
      &lt;circle ng-show="failedGuess.length &gt;= 3" cx="175" cy="120" r="40"&gt;&lt;/circle&gt;
      &lt;line ng-show="failedGuess.length &gt;= 4" x1="175" y1="150" x2="175" y2="185" style="stroke:rgb(0,0,0)" stroke-width="10"&gt;&lt;/line&gt;
      &lt;line ng-show="failedGuess.length &gt;= 4" x1="175" y1="180" x2="100" y2="240" style="stroke:rgb(0,0,0)" stroke-width="10"&gt;&lt;/line&gt;
      &lt;line ng-show="failedGuess.length &gt;= 5" x1="175" y1="180" x2="250" y2="240" style="stroke:rgb(0,0,0)" stroke-width="10"&gt;&lt;/line&gt;
      &lt;line ng-show="failedGuess.length &gt;= 6" x1="175" y1="180" x2="175" y2="265" style="stroke:rgb(0,0,0)" stroke-width="10"&gt;&lt;/line&gt;
      &lt;line ng-show="failedGuess.length &gt;= 7" x1="175" y1="260" x2="120" y2="340" style="stroke:rgb(0,0,0)" stroke-width="10"&gt;&lt;/line&gt;
      &lt;line ng-show="failedGuess.length &gt;= 8" x1="175" y1="260" x2="230" y2="340" style="stroke:rgb(0,0,0)" stroke-width="10"&gt;&lt;/line&gt;
    &lt;/svg&gt;

    &lt;div ng-show="stage == 'initial'"&gt;
      &lt;h2&gt;Please enter your secret words:&lt;/h2&gt;
      &lt;input type="text" ng-model="secretWords" autofocus ng-keyup="$event.keyCode == 13 ? startGame() : null"&gt;
      &lt;button ng-click="startGame()"&gt;Enter&lt;/button&gt;
    &lt;/div&gt;

    &lt;div ng-show="stage == 'play'"&gt;
      &lt;h1&gt;{{ answer }}&lt;/h1&gt;
      &lt;h2&gt;Failed guess ({{ failedGuess.length }}) = {{ failedGuess}}&lt;/h2&gt;

      &lt;input type="text" ng-model="charGuess" id="char-guess" ng-keyup="$event.keyCode == 13 ? guess(charGuess) : null" placeholder="Guess a letter"&gt;
      &lt;button ng-click="guess(charGuess)"&gt;Enter&lt;/button&gt;
    &lt;/div&gt;

    &lt;div ng-show="stage == 'won'"&gt;
      &lt;h1&gt;You Win! :)&lt;/h1&gt;
      &lt;h2&gt;That's right, the secret words is {{ secretWords }}&lt;/h2&gt;
      &lt;p&gt;Press F5 to replay&lt;/p&gt;
    &lt;/div&gt;

    &lt;div ng-show="stage == 'lost'"&gt;
      &lt;h1&gt;You Lose! :(&lt;/h1&gt;
      &lt;h2&gt;The secret word is {{ secretWords }}&lt;/h2&gt;
      &lt;p&gt;Press F5 to replay&lt;/p&gt;
    &lt;/div&gt;

    &lt;script src="js/hangman.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></div><p>The <code class="literal">css</code> folder<a class="indexterm" id="id276"/> should have a <code class="literal">styles.css</code> file. The <code class="literal">styles.css</code> file should contain the following code:</p><div class="informalexample"><pre class="programlisting">body {
  font-family: monospace;
  text-align: center;
  font-size: 16px;
  line-height: 1.40;
}

input[type="text"] {
  padding: 5px;
  font-family: monospace;
  height: 30px;
  font-size: 1.8em;
  background-color: #fff;
  border: 2px solid #000;
  vertical-align: bottom;
}

svg {
  margin: 0 0 30px;
}

button {
  cursor: pointer;
  margin: 0;
  height: 44px;
  background-color: #fff;
  border: 2px solid #000;
}</pre></div><p>There should be two JavaScript files in the <code class="literal">js</code> folder, <code class="literal">angular.min.js</code> and <code class="literal">hangman.js</code>.</p><p>The <code class="literal">angular.min.js</code> file is <a class="indexterm" id="id277"/>a framework. You can download it from <a class="ulink" href="https://angularjs.org/">https://angularjs.org/</a> or it is available with the code bundle of the book.</p><p>The <code class="literal">hangman.js</code> file <a class="indexterm" id="id278"/>should have the following code:</p><div class="informalexample"><pre class="programlisting">var hangman = angular.module('hangman', []).controller('StartHangman', StartHangman);
  function StartHangman($scope, $document) {
    $scope.stage = "initial";
    $scope.secretWords = "";
    $scope.answer = "";
    $scope.failedGuess = [];
    var hasWon = function() {
      var foundDash = $scope.answer.search(/-/);
      return (foundDash == -1);
    }
    var hasLost = function() {
      return ($scope.failedGuess.length &gt;= 8);
    }
    $scope.startGame = function() {
      $scope.secretWords = $scope.secretWords.toLowerCase();
      for(i in $scope.secretWords) {
        $scope.answer += $scope.secretWords[i] == ' ' ? ' ' : '-';
      }
      $scope.stage = "play"
    }
    $scope.guess = function(ch) {
      ch = ch.toLowerCase();
      $scope.charGuess = "";
      if(ch.length != 1) {
        if(ch.length &gt; 1) {
          alert("Please only enter one character at a time");
        }
      return ;
    }
    /* If ch is already in the failed guess list */
    for(i in $scope.failedGuess) {
      if(ch == $scope.failedGuess[i]) return ;
    }
    /* Check if it's part of the answer */
    var found = false;
    $scope.answer = $scope.answer.split(""); /* convert to array of char */
    for(i in $scope.secretWords) {
      if($scope.secretWords[i] === ch) {
        found = true;
        $scope.answer[i] = ch;
      }
    }
    $scope.answer = $scope.answer.join(""); /* convert back to string */
    if(!found) {
      $scope.failedGuess.push(ch);
    }
    if(hasWon()) {
      $scope.stage = "won";
    }
    if(hasLost()) {
      $scope.stage = "lost";
    }
  }
}</pre></div><p>Let's discuss<a class="indexterm" id="id279"/> the code.</p><p>We used <code class="literal">var hangman = angular.module('hangman', []).controller('StartHangman', StartHangman);</code> to import our <code class="literal">angular.min.js</code> file and start controlling the rest of our game's code.</p><p>We wrote a <code class="literal">StartHangman($scope, $document) {}</code> function, where we will write our code. We passed two variables, <code class="literal">$scope</code> and <code class="literal">$document</code>, from our <code class="literal">angular.min.js</code> file.</p><p>We initialized few variables, as follows:</p><div class="informalexample"><pre class="programlisting">$scope.stage = "initial";
$scope.secretWords = "";
$scope.answer = "";
$scope.failedGuess = [];</pre></div><p>We wrote two functions for winning and losing the game, as follows:</p><div class="informalexample"><pre class="programlisting">var hasWon = function() {
  var foundDash = $scope.answer.search(/-/);
  return (foundDash == -1);
}
var hasLost = function() {
  return ($scope.failedGuess.length &gt;= 8);
}</pre></div><p>We have fixed our number of guesses here. Then, we wrote a function to start our game. We made an object and used the inheritance property of JavaScript, as shown in the following:</p><div class="informalexample"><pre class="programlisting">$scope.startGame = function() {
  $scope.secretWords = $scope.secretWords.toLowerCase();
  for(i in $scope.secretWords) {
    $scope.answer += $scope.secretWords[i] == ' ' ? ' ' : '-';
  }
  $scope.stage = "play"
}</pre></div><p>We took<a class="indexterm" id="id280"/> an input from the player in order to store as our secret word.</p><p>The prompt page of the game will look similar to the following image:</p><div class="mediaobject"><img alt="Dissecting Hangman" src="graphics/B04720_09_08.jpg"/></div><p>Then, our most important function, <code class="literal">$scope.guess = function(ch){}</code>, was introduced. We passed a character to the function and checked whether it matches any letters entered by the player with the secret word.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec60"/>Summary</h1></div></div></div><p>In this chapter, you learned the characteristics of an OOP language. We also saw the uses of the OOP characteristics in the famous game, Hangman! I hope you enjoyed creating and playing Hangman. We will see the possibilities of JavaScript in the next and final chapter of this book.</p></div></body></html>