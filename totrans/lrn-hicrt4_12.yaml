- en: Chapter 12. Highcharts and jQuery Mobile
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 12 章：Highcharts 和 jQuery Mobile
- en: 'Highcharts does not only work in desktop browsers; it also supports mobile
    platforms. In this chapter, we will explore how to deploy Highcharts to mobile
    platforms with a web mobile framework, jQuery Mobile, that is built on top of
    jQuery. A very brief introduction to jQuery Mobile is given. We will look into
    a couple of areas that are crucial to understanding the basics of the mobile framework.
    Then, we will integrate Highcharts and jQuery Mobile by building a mobile application
    using an Olympic 2012 medals table. We will demonstrate how to apply mobile events
    such as swipe, rotation, and pinch to navigate through the charts. In this chapter,
    we will cover the following topics:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Highcharts 不仅在桌面浏览器中工作；它还支持移动平台。在本章中，我们将探讨如何使用基于 jQuery 的 Web 移动框架 jQuery Mobile
    将 Highcharts 部署到移动平台。以下是 jQuery Mobile 的简要介绍。我们将探讨几个对理解移动框架基础至关重要的领域。然后，我们将通过构建一个使用
    2012 年奥运会奖牌表的移动应用程序来集成 Highcharts 和 jQuery Mobile。我们将演示如何应用移动事件，如滑动、旋转和捏合来导航图表。在本章中，我们将涵盖以下主题：
- en: Introducing jQuery Mobile
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍 jQuery Mobile
- en: Understanding mobile page structure
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解移动页面结构
- en: Understanding page initialization
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解页面初始化
- en: Linking between mobile pages
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 移动页面之间的链接
- en: Integrating Highcharts and jQuery Mobile
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 集成 Highcharts 和 jQuery Mobile
- en: Drilling down for data from one chart to another
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从一个图表深入到另一个图表的数据
- en: 'Changing chart displays with touch actions: swipe, rotate, and pinch'
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过触摸动作更改图表显示：滑动、旋转和捏合
- en: A short introduction to jQuery Mobile
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: jQuery Mobile 简介简述
- en: This chapter is not a full tutorial for jQuery Mobile (jQM) by any means, but
    it is a quick-start guide for using it with Highcharts. JQuery Mobile is a web
    development framework for mobile devices built on top of jQuery. It is designed
    to be compatible across all mobile platforms, and the UI look and feel emulate
    native mobile applications. The benefit of this is low cost development in a single-source
    code, without the need for testing across all mobile platforms and browsers.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章绝对不是 jQuery Mobile（jQM）的完整教程，但它是一个使用 Highcharts 的快速入门指南。JQuery Mobile 是一个基于
    jQuery 的移动设备网络开发框架。它旨在与所有移动平台兼容，并且 UI 的外观和感觉模仿了原生移动应用程序。这种优势在于单源代码的低成本开发，无需在所有移动平台和浏览器上进行测试。
- en: Before we drill down into how Highcharts can be integrated with jQM, a few important
    concepts need to be understood.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们深入探讨 Highcharts 如何与 jQM 集成之前，需要理解一些重要概念。
- en: Understanding mobile page structure
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解移动页面结构
- en: The most important concept in jQM is to understand the structure of a mobile
    page, which is not the same as a normal HTML page. A mobile page is constructed
    inside an HTML `<div>` box with a jQM-specific attribute, `data-role='page'`,
    marked as a boundary. In fact, the `data-*` syntax is **Customer Data Attributes**
    defined in HTML5 standard. This allows web developers to store custom data specific
    to the page or application, which can easily access the data attribute values.
    For more information on APIs for HTML visit [http://dev.w3.org/html5/spec/single-page.html#custom-data-attribute](http://dev.w3.org/html5/spec/single-page.html#custom-data-attribute).
    Within a mobile page, normal HTML tags, such as input, hyperlinks, select, and
    so on, are used.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在 jQM 中最重要的概念是理解移动页面的结构，这与正常的 HTML 页面不同。移动页面是在一个带有 jQM 特定属性 `data-role='page'`
    的 HTML `<div>` 框架内构建的，该属性作为边界。实际上，`data-*` 语法是 HTML5 标准中定义的**客户数据属性**。这允许网络开发者存储特定于页面或应用的定制数据，可以轻松访问数据属性值。有关
    HTML API 的更多信息，请访问 [http://dev.w3.org/html5/spec/single-page.html#custom-data-attribute](http://dev.w3.org/html5/spec/single-page.html#custom-data-attribute)。在移动页面中，使用正常的
    HTML 标签，如输入、超链接、选择等。
- en: 'An HTML document can contain multiple mobile pages and links through an anchor
    and the `id` attribute. An anchor is the same as a normal HTML anchor (for example,
    `#chart`). The framework resolves the anchor reference and retrieves a mobile
    page with the matching `id` attribute, which has the following syntax:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 一个 HTML 文档可以通过锚点和 `id` 属性包含多个移动页面和链接。锚点与正常的 HTML 锚点相同（例如，`#chart`）。框架解析锚点引用并检索具有匹配
    `id` 属性的移动页面，其语法如下：
- en: '[PRE0]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The following is an example of a single mobile page in an HTML document:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一个 HTML 文档中单个移动页面的示例：
- en: '[PRE1]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Depending on the purpose of the mobile application, all the pages can be built
    into a single HTML document or they can exist in separate documents. One important
    aspect is that, if multiple mobile pages are defined within a document, the first
    page in the `<body>` tag is always loaded on the screen. In jQM, a page is generally
    composed of the head and content, optionally a footer and navigation bar. Each
    component also has a `<div>` box with `data-role` to indicate the type of component
    within a mobile page. The following code shows how multiple mobile pages in a
    document are loaded:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: As we can see, there are two `<div>` boxes with the `data-role='page'` attribute.
    The first `<div>` box is the same as the previous example with an additional `Options`
    link button that redirects to the second mobile page, `id='config'`. The `data-icon="gear"`
    attribute decorates the button with a gear icon provided by the framework.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: 'For the full list of icons visit [http://demos.jquerymobile.com/1.4.3/icons](http://demos.jquerymobile.com/1.4.3/icons).
    When the button is pressed, it will open the second page as a modal dialog box
    due to the `data-rel=''dialog''` attribute. The following screenshot shows the
    view of the first mobile page as it appears on an iPhone:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
- en: '![Understanding mobile page structure](img/7451OS_12_01.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
- en: Understanding page initialization
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will look at why we don't use the traditional DOM-ready
    method to run initialization code for mobile pages. Suppose a page's content requires
    some sort of initialization, then using the traditional DOM-ready method `$.ready`
    can have a negative effect. This is because the `$.ready` method runs as soon
    as all the DOMs inside the document are loaded. In other words, we have no control
    over when to run the jQM page initialization code if it is inside the DOM ready
    handler.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: 'However, jQM provides a specific event, `pageinit`, that caters for this scenario.
    All we need to do is to assign an `id` value inside the `<div data-role=''page''>`
    markup, then define the `pageinit` event handler for that `id` value. Whenever
    a page is going to be initialized for display, this event is triggered. Note that
    the `$.ready` method is still going to be called, but we just don''t use it in
    jQM. To demonstrate this concept, let us use the previous multipage example with
    an additional `$.ready` call:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'There are two mobile pages defined in this example: `main_page` and `config`.
    Each mobile page is tied to its `pageinit` event handler. With the `$.ready` method,
    we can observe the call sequence with other `pageinit` events. When we first load
    the document to the browser, we see the following screenshot:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: '![Understanding page initialization](img/7451OS_12_02.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
- en: 'Remember that jQM always displays the first page in the HTML body. That means
    the `pageinit` event for `main_page` is fired as soon as the DOM for `main_page`
    is fully loaded and initialized for the display. It is also important to understand
    that, at the point of execution, the DOM for the subsequent `config` page is not
    loaded yet. When we touch the **OK** button, the execution resumes and the DOM
    for the `config` page is then loaded. Hence all the DOMs in the document are loaded
    and the `$.ready` method is then called; it shows the second alert message as
    shown in the following screenshot:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: '![Understanding page initialization](img/7451OS_12_03.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
- en: 'When we touch the **OK** button, the alert box disappears and the control returns
    back to the browser. Now, if we touch the **Options** button in the top right-hand
    corner, the `config` dialog page is initialized and displayed on the screen. Hence
    the `pageinit` handler for the `config` page is called:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: '![Understanding page initialization](img/7451OS_12_04.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
- en: Linking between mobile pages
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The second important concept in jQM is how the mobile pages are linked together.
    Understanding this concept can help us to design a web mobile application with
    a fluid user experience. In jQM, there are two ways to load an external mobile
    page: HTTP and Ajax. Depending on how we set the `data-` attribute, it interprets
    the `href` value and decides which way to load a mobile page. By default, apart
    from the first document load that is a normal HTTP transfer, the mobile page is
    loaded through Ajax.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: 'The following block diagram explains how multiple mobile page blocks are managed
    within a document:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: '![Linking between mobile pages](img/7451OS_12_05.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
- en: When a mobile page invokes another mobile page, the jQM framework basically
    parses the `href` value. Since this is an anchor reference, it indicates that
    this is an internal mobile page block. The framework locates the page block from
    the current DOM by matching the `id` value. It then initializes and renders the
    page, which also triggers the `pageinit` event for page B as shown in the previous
    block diagram.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: 'Suppose we have two separate HTML documents in which a button on one page is
    referring to the other document. The following block diagram describes the scenario:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: '![Linking between mobile pages](img/7451OS_12_06.jpg)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
- en: In this case, we add an attribute, `data-ajax="false"` (for the sake of a simpler
    approach to managing the JavaScript code), to tell jQM that this button requires
    a document load instead of a background Ajax load. This is important because otherwise
    the `pageinit` handler code (or any JavaScript file) inside the `<script>` tag
    will not be loaded for the new mobile page, `B.html`.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: JavaScript code can be embedded inside a `<script>` tag within a mobile page
    block and executed. The downside of this approach is that it requires more code
    management, as each page block has its own `pageinit` handler code.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: There is an alternative way to load Ajax in multiple documents, but we will
    leave it here. This is more than sufficient to implement a simple mobile web application.
    Readers can learn more from the jQuery Mobile documentation.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 有一种加载多个文档中 Ajax 的替代方法，但我们将在这里省略。这已经足够实现一个简单的移动网络应用。读者可以从 jQuery Mobile 文档中了解更多信息。
- en: Highcharts in touch-screen environments
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 高级图表在触摸屏环境中的使用
- en: The good thing about Highcharts is that it works perfectly well on both desktop
    browsers and web mobile environments without requiring any change of code. The
    only part that needs some consideration is events handling, because mobile devices
    are all touch-screen based and that means the mouse cursor is invisible.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: Highcharts 的好处是它可以在桌面浏览器和移动网络环境中完美运行，无需更改任何代码。唯一需要考虑的部分是事件处理，因为移动设备都是基于触摸屏的，这意味着鼠标光标是不可见的。
- en: In Highcharts, all the mouse hover events can still be triggered in touch devices,
    even though the mouse cursor is not shown. For instance, suppose we define a series
    with the `mouseOut`, `mouseOver`, and `click` events handling. If we touch the
    series, both the `mouseOver` and `click` events are triggered. However, if we
    touch another series causing the previous selected series to be unselected, a
    `mouseOut` event for the first series is fired. Needless to say, the sequence
    of events would be different with a real pointing device. In general, we should
    refrain from using any mouse hover events in touch-screen based devices.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Highcharts 中，所有鼠标悬停事件仍然可以在触摸设备上触发，尽管鼠标光标没有显示。例如，如果我们定义了一个具有 `mouseOut`、`mouseOver`
    和 `click` 事件处理的系列。如果我们触摸该系列，`mouseOver` 和 `click` 事件都会被触发。然而，如果我们触摸另一个系列导致之前选中的系列被取消选中，第一个系列的
    `mouseOut` 事件就会被触发。不用说，事件的顺序会与真实的光标设备不同。一般来说，我们应该避免在基于触摸屏的设备中使用任何鼠标悬停事件。
- en: In the next section, we will learn how to integrate jQM with Highcharts, including
    how to apply touch events to charts, how to use the chart `click` events to launch
    another chart and mobile page, and so on.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将学习如何将 jQM 与 Highcharts 集成，包括如何将触摸事件应用于图表，如何使用图表 `click` 事件启动另一个图表和移动页面等。
- en: Integrating Highcharts and jQuery Mobile using an Olympic medals table application
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用奥运奖牌表应用整合 Highcharts 和 jQuery Mobile
- en: 'In this section, we will build a mobile application for browsing the results
    of the Olympic 2012 medals table. This application is only tested on iPhone and
    iPad. The startup screen provides four menus for looking up the results, as shown
    in the following screenshot:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将构建一个用于浏览 2012 年奥运奖牌表结果的移动应用。此应用仅在 iPhone 和 iPad 上进行了测试。启动屏幕提供了四个菜单来查找结果，如下面的截图所示：
- en: '![Integrating Highcharts and jQuery Mobile using an Olympic medals table application](img/7451OS_12_07.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![使用奥运奖牌表应用整合 Highcharts 和 jQuery Mobile](img/7451OS_12_07.jpg)'
- en: 'The initial page is made up of a list of four hyperlinks referring to other
    pages, as shown in the following code:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 初始页面由指向其他页面的四个超链接列表组成，如下面的代码所示：
- en: '[PRE4]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: So, when the **Top 10 countries by gold** button is clicked, the `gold.html`
    file is HTTP-loaded (not Ajax) because we define `data-ajax="false"`. Since it
    is an HTTP load, the whole page, `gold.html`, is loaded onto the browser as well
    as everything within the `<script>` tags that are being executed.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，当点击**金牌前10名国家**按钮时，`gold.html` 文件是通过 HTTP 加载的（不是 Ajax），因为我们定义了 `data-ajax="false"`。由于这是一个
    HTTP 加载，整个页面 `gold.html` 以及 `<script>` 标签中正在执行的所有内容都将加载到浏览器中。
- en: Loading up the gold medals page
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 加载金牌页面
- en: 'The following is the content of the `gold.html` file:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 以下为 `gold.html` 文件的内容：
- en: '[PRE5]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Since this whole HTML document is HTTP-loaded onto the browser, the `common.js`
    and `gold.js` files are also loaded (See [http://joekuan.org/Learning_Highcharts/Chapter_12/](http://joekuan.org/Learning_Highcharts/Chapter_12/)).
    The file `common.js` contains common routine code shared in the demo, such as
    device detection, orientation detection, chart creation, and so on. The `gold.js`
    file contains the `pageinit` handler code for all the mobile pages in the `gold.html`
    file. As the mobile page block, `gold_chart`, is the first defined block in the
    document, it is automatically loaded and rendered to the display; thus, the `pageinit`
    event for the `gold_chart` page block is triggered.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: Detecting device properties
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'For detecting mobile devices, the techniques range from string matching of
    the `navigator.userAgent` option, `jQuery.support`, `jQuery.browser` (deprecated),
    CSS media queries, to a third-party plugin such as Modernizer (see [http://modernizr.com/](http://modernizr.com/)
    for details). However, there is no standard way of doing this. Perhaps it is due
    to the diverse requirements for compatibility checks. It is beyond the scope of
    this book to debate the merits of each technique. For this demo, all we are interested
    in is the difference in screen size; that is, if there is more space in the display
    (such as with tablet devices), then we display the full country name in the charts
    instead of the country code, which is used for smaller devices (touch phones).
    We assume the following technique is sufficient to differentiate between phone
    and tablet devices:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The `$(window).width` property returns the width of the device in pixels, regardless
    of the device orientation. As for getting the current device orientation, we have
    the following method:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Plotting a Highcharts chart on a mobile device
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The following is the `pageinit` handler code for the `gold_chart` mobile page:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The touch events such as `swipeleft`, `swiperight`, and `orientationchange`
    will be discussed later on. The event handler, `pointEvt`, drills down further
    to another chart when the user taps on a country bar in the gold medal chart.
    We will also explore this interaction later on. Let''s first focus on the last
    part of the code, which creates the chart. The `createChart` method is a general
    routine to create a Highcharts graph that has the common options shared by all
    the chart mobile pages. For example, the `renderTo` option is always set to `chart_container`,
    which is inside the `data-role=''content''` attribute. The following code shows
    the `createChart` implementation:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Note that there is no series defined in the `options` parameter and the `options.load`
    property is set up to call the `plotGoldChart` function once the chart is created
    and loaded into the browser. The following code snippet is part of the `plotGoldChart`
    function:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The `plotGoldChart` method is a general routine to plot a series into an existing
    chart. The `options` parameter is a configuration object with new settings to
    be applied to the chart. First, the function invokes an Ajax call, `gold_10.json`,
    to get the top 10 countries with the most gold medals. Here is what the result
    looks like in JSON format:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Upon the results being returned, the handler function examines the `options`
    parameter for series type, device orientation, and other fields (stacking and
    data labels from the `config` dialog, which we will discuss later). Then, it creates
    the chart based on the settings. If the `type` property is `column`, then we create
    three column series called `Gold`, `Silver`, and `Bronze` with the point `click`
    event configured. If the `type` value is `pie`, then it creates a single pie series
    of gold medals with a gradual change of colors and data labels.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: 'So, when the `gold_chart` page is first loaded, a column chart is created and
    displayed. The following screenshot shows the initial column chart in portrait
    mode:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: '![Plotting a Highcharts chart on a mobile device](img/7451OS_12_08.jpg)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
- en: 'If we touch the legend items to display the number of silver and bronze medals,
    the chart looks like the following screenshot:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: '![Plotting a Highcharts chart on a mobile device](img/7451OS_12_09.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
- en: Switching graph options with the jQuery Mobile dialog box
  id: totrans-77
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The **Options** button in the top right-hand corner is only enabled if the
    current display chart is a column chart. It launches an option dialog box for
    switching stack columns and data labels. The following code is for the mobile
    page for the dialog box:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The `<select>` markups in jQM are rendered as slider switches with the `data-role=''slider''`
    attribute and the hyperlinks are rendered as dialog buttons with the `data-role=''button''`
    attribute. The following screenshot shows the dialog page:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: '![Switching graph options with the jQuery Mobile dialog box](img/7451OS_12_10.jpg)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
- en: 'Likewise, we program the `pageinit` handler for the dialog page to initialize
    the **Update** button action:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Actually, the action code for the button is very simple. Since we define the
    **Update** button with the `data-rel=''back''` attribute, as soon as we tap the
    button, the dialog box is closed and we go back to the previous page. The option
    values from the `<select>` inputs are passed to the `plotGoldChart` routine to
    redraw the current chart. The following is a screenshot with only **Show Values**
    switched on:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
- en: '![Switching graph options with the jQuery Mobile dialog box](img/7451OS_12_11.jpg)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
- en: 'The following screenshot shows a column chart with both stacking and data labeling
    switched on:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
- en: '![Switching graph options with the jQuery Mobile dialog box](img/7451OS_12_12.jpg)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
- en: Changing the graph presentation with a swipeleft motion event
  id: totrans-88
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Here, we enhance the experience by adding a `swipeleft` event to a chart. What
    we try to achieve is to apply a swipe motion from the right-hand side to the left-hand
    side on an existing column chart. This action switches the column chart to a pie
    chart with the same dataset, and vice versa with the swiperight motion:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The guard condition inside the handler is to stop redrawing the chart with
    the same presentation. The following is the view after the `swipeleft` action:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
- en: '![Changing the graph presentation with a swipeleft motion event](img/7451OS_12_13.jpg)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
- en: Switching the graph orientation with the orientationchange event
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Assume that we are viewing the column chart on a touch-phone device in the
    portrait position. If we rotate the device, the chart will resize itself but the
    scale along the *y* axis is squashed. As a result, there is less clarity when
    comparing how well each country did. To overcome that, we use another jQuery Mobile
    event, `orientationchange`, that triggers when the mobile device is rotated. Here
    is the implementation for the handler:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'We recreate the chart with the `inverted` option set to `true` to swap both
    *x* and *y* axes, as well as positioning the legend in the lower-right corner
    instead. A method for the chart `load` event is also set up in the configuration.
    In the end, an inverted chart is produced, as shown in the following screenshot:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: '![Switching the graph orientation with the orientationchange event](img/7451OS_12_14.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
- en: 'The following is a screenshot from a tablet device showing the gold and silver
    medals'' chart:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
- en: '![Switching the graph orientation with the orientationchange event](img/7451OS_12_15.jpg)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
- en: The `plotGoldChart` method detects a larger display and renders the chart (using
    the `setCategories` method) with full country names instead of the country code
    from the JSON result.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
- en: Drilling down for data with the point click event
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'So far we have only fiddled with the top countries ordered by gold medals.
    Let''s see how we can use a Highcharts event to navigate around other charts in
    jQuery Mobile. Back with the `pageinit` handler code for `chart_page`, we declared
    the `pointEvt` variable, which is a `click` event handler shared by all the series
    in gold medal charts. The following code is for the event:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'This event is triggered by touching a bar in a column chart or a slice in a
    pie chart. As a result, it loads a new document page (`sport.html`) with a bar
    chart. The URL for the document page is built inside the handler with the selected
    country code and the medal color as parameters. The HTML content of the page is
    listed in the next section. The `this` keyword refers to the data point (that
    is, the country bar) being clicked. The bar chart displays the list of sports
    in which the selected country won medals, along with the medal color. The following
    screenshot shows a chart for a list of sports in which Great Britain and Northern
    Ireland won gold medals:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
- en: '![Drilling down for data with the point click event](img/7451OS_12_16.jpg)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
- en: Inside the new page, it uses similar code to the gold medal countries chart
    to produce the graph shown in the preceding screenshot. The only difference is
    that it is embedded with the point `click` callbacks. We will see that in the
    next section.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: Building a dynamic content dialog with the point click event
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Now we know which sports have achieved gold medals in the Olympics, but we
    want to further find out who the medalists are. Let''s touch the **Athletics**
    bar in the chart. A dialog box appears and presents a list of athletes in thumbnails
    along with their names, photos, and their event information, as shown in the following
    screenshot:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: '![Building a dynamic content dialog with the point click event](img/7451OS_12_17.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
- en: 'Notice that the dialog box shown in the preceding screenshot is not a static
    HTML page. This is constructed via a point `click` event and builds the dialog
    box content dynamically from the result. The problem is that, in order to launch
    a dialog page in jQM, we need to have a button somewhere on the page to start
    from. The trick is to create a jQM hidden button and a program to invoke the click
    action from inside the event handler. The following code is the HTML (`sport.html`)
    for both the hidden button and dialog page:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The following is the implementation of the `click` handler for the sports chart:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'First, we assemble the title for the dialog page ready to launch. Then, we
    trigger an action click to the hidden button with the call as follows:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: This in turn generates a click event to launch the dialog page. Then, we issue
    an Ajax query for the list of medalists with the current selected country, medal
    color, and sport as the filters. The server page, `olympic.php`, contains the
    Olympic result of each nation. It sorts the result according to the URL parameters
    and formats the ordered list in JSON format. We then convert each item from the
    JSON result and insert them into the `<ul>` list, `atheletes_list`.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: Applying the gesturechange (pinch actions) event to a pie chart
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: So far, we have only explored actions involving a single touch point. Our next
    goal is to learn how to apply more advanced action events with multi-touch. One
    of the most common actions is the pinch-in/out for zooming out/in respectively.
    The Safari browser for iOS supports this motion with the `gesturestart`, `gesturechange`,
    and `gestureend` events. Whenever there are two or more fingers touching the screen,
    the `gesturestart` event is fired. Then, the `gesturechange` event is triggered
    when the fingers are moved on the screen. When the fingers leave the screen, the
    `gestureend` event is generated. In returning control to the event handler, if
    the action is recognized, a certain property in the event object is updated. For
    instance, the `scale` property in the event object is set to larger than 1.0 for
    pinch-out and less than 1.0 for pinch-in. For the `GestureEvent` class reference,
    please see [https://developer.apple.com/library/mac/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html](https://developer.apple.com/library/mac/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html).
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
- en: 'In this section, we will apply the pinch motions to a pie chart. For the pinch-out
    action, we turn the pie chart into a doughnut chart with extra information on
    the outer ring—and vice versa for pinch-in, turning the doughnut chart back to
    a pie chart. First of all, let''s launch a new chart, **Top 10 countries by medals**,
    the second item from the front menu. The following screenshot is the output of
    the chart:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: '![Applying the gesturechange (pinch actions) event to a pie chart](img/7451OS_12_18.jpg)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
- en: 'When we perform a pinch-out action, the chart is redrawn as shown in the following
    screenshot:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
- en: '![Applying the gesturechange (pinch actions) event to a pie chart](img/7451OS_12_19.jpg)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
- en: 'The outer ring shows the ratio of each color medal for each country. Moreover,
    the original pie chart data labels move inwards to make space for the outer ring.
    Let''s see how the `gesturechange` event is implemented. The following is the
    code inside the `pageinit` handler:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: We bind the gesture event to the chart container. This event handler is called
    whenever there is a multi-touch gesture made on the screen, such as a pinch or
    rotate motion. In order to make sure this is a pinch action, we need to look into
    the original event generated by the browser that is wrapped by the jQuery layer.
    We will examine whether the `scale` property has been set and decide whether it
    is pinch-in or pinch-out, then we will recreate the pie or doughnut chart if necessary.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The goal of this chapter was to deploy Highcharts graphs on mobile touch devices.
    To do that, we used a mobile web development framework, jQuery Mobile. We worked
    through a very brief introduction and the concepts of the framework. We then examined
    how to integrate Highcharts with jQuery Mobile.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
- en: Then, we demonstrated a mobile application to show the results of the Olympic
    2012 medals table. A menu of charts was built using the jQuery Mobile dialog page,
    and then we showed how to use the single-touch, multi-touch, and orientation events
    to navigate between charts. We also showed how to use the Highcharts click event
    to build a dialog page dynamically.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们演示了一个移动应用程序，以展示 2012 年奥运会的奖牌榜结果。我们使用 jQuery Mobile 对话页面构建了一个图表菜单，然后展示了如何使用单点触控、多点触控和方向事件在图表之间导航。我们还展示了如何使用
    Highcharts 的点击事件动态构建对话页面。
- en: In the next chapter, we will learn how to apply Highcharts with ExtJs, a very
    powerful and popular **Rich Internet Application** (**RIA**) framework for building
    a desktop-style application.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何将 Highcharts 与 ExtJs 结合使用，这是一个非常强大且流行的 **富互联网应用** (**RIA**) 框架，用于构建桌面风格的应用程序。
