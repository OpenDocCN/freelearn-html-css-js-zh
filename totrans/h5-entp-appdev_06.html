<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch06"/>Chapter 6. The App: Trailers via HTML5 Video</h1></div></div></div><a id="id354" class="indexterm"/><p>One of the most interesting features that HTML5 introduces is the ability to reproduce multimedia without additional plugins. Although this appears to be the right solution for any enterprise application that involves media management, there are still many factors to consider. This chapter covers the HTML5 <code class="literal">video</code> and <code class="literal">audio</code> tags, their use to play media, and some caveats related to the current state of this technology.</p><p>As an example we are going to build a video player for trailers and an audio player for podcasts.</p><p>This chapter includes:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">HTML5 video introduction</li><li class="listitem" style="list-style-type: disc">Implementing a video player</li><li class="listitem" style="list-style-type: disc">HTML5 audio introduction</li><li class="listitem" style="list-style-type: disc">Implementing an audio player</li><li class="listitem" style="list-style-type: disc">How I learned to stop worrying and love Flash</li></ul></div><div><div><div><div><h1 class="title"><a id="ch06lvl1sec54"/>Introducing HTML5 video</h1></div></div></div><a id="id355" class="indexterm"/><p>For many years, browsers have relied on video reproduction to external plugins like Real Player, Quicktime, and Flash. Having 99 percent penetration of the market, Flash became a de facto standard for media playback; however, in the last few years, mobile devices have replaced this solution with native apps and HTML5 solutions.</p><p>HTML5 video surged to become a standard and elegant way to embed videos. While everything points to HTML5's video solution, the lack of agreement on which video formats should be supported has obstructed its use.</p><p>Ideally, there should be at least one format supported across all browsers, but every company has its own view on the matter. While Microsoft and Apple support MP4 H.264 (because they are patent holders of this format), Google and Mozilla back Ogg Theora and VP8 WebM as royalty-free solutions. The following table shows the browser support for each video format:<a id="id356" class="indexterm"/>
</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Browser</p>
</th><th style="text-align: left" valign="bottom">
<p>Operative System</p>
</th><th style="text-align: left" valign="bottom">
<p>Ogg Theora</p>
</th><th style="text-align: left" valign="bottom">
<p>MP4 H.264</p>
</th><th style="text-align: left" valign="bottom">
<p>VP8 WebM</p>
</th></tr></thead><tbody><tr><td rowspan="2" style="text-align: left" valign="top">
<p>
<strong>Internet Explorer</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>Windows</p>
</td><td style="text-align: left" valign="top">
<p>Manual install</p>
</td><td rowspan="2" style="text-align: left" valign="top">
<p>9.0</p>
</td><td style="text-align: left" valign="top">
<p>Manual install</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Windows Phone</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td></tr><tr><td rowspan="3" style="text-align: left" valign="top">
<p>
<strong>Mozilla Firefox</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>Windows</p>
</td><td rowspan="3" style="text-align: left" valign="top">
<p>3.5</p>
</td><td style="text-align: left" valign="top">
<p>Manual install</p>
</td><td rowspan="3" style="text-align: left" valign="top">
<p>4.0</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Unix</p>
</td><td rowspan="2" style="text-align: left" valign="top">
<p>No</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Other</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Google Chrome</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>All supported</p>
</td><td style="text-align: left" valign="top">
<p>3.0</p>
</td><td style="text-align: left" valign="top">
<p>3.0 (removal planned)</p>
</td><td style="text-align: left" valign="top">
<p>6.0</p>
</td></tr><tr><td rowspan="3" style="text-align: left" valign="top">
<p>
<strong>Safari</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>iOS</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td rowspan="2" style="text-align: left" valign="top">
<p>3.1</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>MacOS </p>
</td><td rowspan="2" style="text-align: left" valign="top">
<p>Manual install</p>
</td><td rowspan="2" style="text-align: left" valign="top">
<p>Manual install</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Windows</p>
</td><td style="text-align: left" valign="top">
<p>Manual install</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Opera</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>All supported</p>
</td><td style="text-align: left" valign="top">
<p>10.50</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>10.60</p>
</td></tr></tbody></table></div><div><div><h3 class="title"><a id="note17"/>Note</h3><p>A new compression standard known as <strong>High Efficiency Video Coding</strong> (<strong>HEVC</strong>) or H.265 could be in commercial products by 2013. It is almost twice as effective as the current H.264 standard.<a id="id357" class="indexterm"/>
</p></div></div><p>Fortunately, the <code class="literal">video</code> tag supports the use of multiple sources allowing web browsers to select the video format supported, but this means each video needs to be encoded at least twice. For your enterprise, this translates to extra costs of encoding and storage.</p><div><div><h3 class="title"><a id="tip35"/>Tip</h3><p>Some implementations rely on the video file extension too. For example, you cannot play a video on iOS devices with the <code class="literal">.f4v</code> extension even if it is using MP4 H.264 format.</p></div></div><p>Most web browsers support progressive download instead of streaming. While Flash has its own proprietary protocol to stream (although an incomplete version of the specification has been released for public use) known as <strong>Real Time Messaging Protocol</strong>
<a id="id358" class="indexterm"/> <strong>RTMP</strong>, only Safari, Safari iOS, and some Android browsers support a new streaming protocol: <strong>HTTP Live Streaming</strong>
<a id="id359" class="indexterm"/> (<strong>HLS</strong>) implemented by Apple Inc.</p><p>With progressive download, it is fairly easy to copy the video file from the browser cache, a facility that will make media pirates thankful. Furthermore, with a content delivery network that supports adaptive bitrate streaming, you can serve different video qualities depending on user bitrate if you are using streaming, but this is not possible using a progressive download.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec55"/>Implementing a video player</h1></div></div></div><a id="id360" class="indexterm"/><p>MovieNow users would love to have a way to visualize trailers of their favorite movies. For that, we are going to create a player with basic functionality: play, pause, seek, volume control, and full screen.</p><p>We are going to use as an example a trailer of Sintel, an animated movie created with a free 3D animation tool known as Blender. This video trailer is hosted on the <a class="ulink" href="http://www.w3.org/">http://www.w3.org/</a> site in three major video formats: MP4 (mp4), WebM (webm), and Ogg Theora (ogv).</p><p>First, let's create a file called <code class="literal">trailer.html</code> and use our main page structure.</p><p>Inside the <code class="literal">article</code> tag, we use the <code class="literal">video</code> tag, which allows us to specify an initial image using the <code class="literal">poster</code> attribute to specify image path, and to show default controls using the <code class="literal">controls</code> attribute.</p><div><pre class="programlisting">&lt;video poster="img/trailer-poster.png" controls&gt;</pre></div><p>You can specify the <code class="literal">src</code> property directly for the <code class="literal">video</code> tag, but to support multiple video format files we are going to declare our files using the <code class="literal">source</code> tag inside <code class="literal">video</code>. The <code class="literal">source</code> tag's <code class="literal">src</code> attribute allows us to define the video path and the <code class="literal">type</code> attribute (to specify the format).</p><div><pre class="programlisting">&lt;source type="video/mp4" src="img/path"&gt;&lt;/source&gt;</pre></div><p>In this case we are going to use:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://media.w3.org/2010/05/sintel/trailer.mp4">http://media.w3.org/2010/05/sintel/trailer.mp4</a> for Chrome (while it is still supported), Internet Explorer, Safari, and Safari iOS</li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://media.w3.org/2010/05/sintel/trailer.webm">http://media.w3.org/2010/05/sintel/trailer.webm</a> for Firefox, Chrome, and Opera</li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://media.w3.org/2010/05/sintel/trailer.ogv">http://media.w3.org/2010/05/sintel/trailer.ogv</a> for Firefox, Chrome, Opera, and others</li></ul></div><a id="id361" class="indexterm"/><p>In this case, it is possible to use only two formats, but we will use three for our example. Finally we have:</p><div><pre class="programlisting">&lt;video poster="img/trailer-poster.png" controls&gt;
  &lt;source type="video/mp4" src="img/trailer.mp4"&gt;&lt;/source&gt;
  &lt;source type="video/webm" src="img/trailer.webm"&gt;&lt;/source&gt;
  &lt;source type="video/ogg" src="img/trailer.ogv"&gt;&lt;/source&gt;
  &lt;p&gt;Video not supported.&lt;/p&gt;
&lt;/video&gt;</pre></div><p>Notice that if no video is supported it shows <code class="literal">&lt;p&gt;Video not supported.&lt;/p&gt;</code>. This can be whatever HTML content you want.</p><div><div><h3 class="title"><a id="tip36"/>Tip</h3><p>If your content delivery network supports HLS, you can use a video encoded as H.264 broken in segments and use a <code class="literal">.m3u8</code> playlist as an index file. For this, you can use a tool like Apple Stream Segmenter.</p></div></div><p>As every browser has its implementation, our player looks different in Firefox, Chrome, Safari, and so on. Our player renders differently on different platforms.</p><p>In Firefox our player renders as shown in the following screenshot:</p><div><img src="img/5689_06_01.jpg" alt="Implementing a video player"/></div><p>In chrome our player renders as shown in the following screenshot:</p><div><img src="img/5689_06_02.jpg" alt="Implementing a video player"/><div><p>Chrome<a id="id362" class="indexterm"/>
</p></div></div><p>In an iPhone our player will appear as follows:</p><div><img src="img/5689_06_06.jpg" alt="Implementing a video player"/></div><a id="id363" class="indexterm"/><p>When it is necessary, reflect the enterprise visual style in the player or add custom functionality. It is possible to hide the default controllers and build your own.</p><div><div><div><div><h2 class="title"><a id="ch06lvl2sec65"/>Custom controls</h2></div></div></div><a id="id364" class="indexterm"/><a id="id365" class="indexterm"/><p>For MovieNow we will be creating play/pause, seek, volume, and full screen controls. Our design can be seen in the following image:</p><div><img src="img/5689_06_10.jpg" alt="Custom controls"/></div><a id="id366" class="indexterm"/><p>To simplify the task of creating a progress and seek bar as well as a volume bar, we use jQuery UI. jQuery UI is a JavaScript library that implements the most common user interface elements and interactions like sliders, accordions, tabs, and so on. In our case, we created a custom download with the UI Darkness theme (<a class="ulink" href="http://jqueryui.com/download)">http://jqueryui.com/download)</a>.</p><p>After saving our jQuery UI JavaScript file in the <code class="literal">js</code> folder and stylesheets in the <code class="literal">css</code> folder, we import them as always with JavaScript before the end of our <code class="literal">body</code> tag:</p><div><pre class="programlisting">&lt;script src="img/jquery-ui-1.8.23.custom.min.js"&gt;&lt;/script&gt;</pre></div><p>And <code class="literal">css</code> in our <code class="literal">head</code> tag:</p><div><pre class="programlisting">&lt;link rel="stylesheet" href=" css/ui-darkness/jquery-ui-1.8.23.custom.css" type="text/css" /&gt;</pre></div><p>To support jQuery UI interactions in touch devices, we import the Touch Punch JavaScript library (<a class="ulink" href="http://touchpunch.furf.com/">http://touchpunch.furf.com/</a>):</p><div><pre class="programlisting">&lt;script src="img/jquery.ui.touch-punch.min.js"&gt;&lt;/script&gt;</pre></div><p>Now that we have all the libraries we need in place, we can remove the <code class="literal">controls</code> attribute from the <code class="literal">video</code> tag to hide the default controls.</p><div><pre class="programlisting">&lt;video poster="img/trailer-poster.png" class="media"&gt;</pre></div><a id="id367" class="indexterm"/><p>With this in place, let us define an HTML structure for our controls:</p><div><pre class="programlisting">&lt;div class="media-container"&gt;
  &lt;div&gt;
    &lt;div class="media-area"&gt;
      &lt;video poster="img/trailer-poster.png" class="media"&gt;
        &lt;source type="video/mp4" src="img/trailer.mp4"&gt;&lt;/source&gt;
        &lt;source type="video/webm" src="img/trailer.webm"&gt;&lt;/source&gt;
        &lt;source type="video/ogg" src="img/trailer.ogv"&gt;&lt;/source&gt;
        &lt;p&gt;Video not supported.&lt;/p&gt;
      &lt;/video&gt;
    &lt;/div&gt;
    &lt;div class="controls"&gt;
      &lt;div class="play-button"&gt;&lt;/div&gt;
      &lt;div class="seek"&gt;&lt;/div&gt;
      &lt;div class="fullscreen-button"&gt;&lt;/div&gt;
      &lt;div class="volume-container"&gt;
        &lt;div class="volume-slider-container"&gt;
          &lt;div class="volume-slider"&gt;&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="volume-button"&gt;&lt;/div&gt;
      &lt;/div&gt;
      &lt;div class="timer"&gt;00:00&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre></div><p>We have three main classes:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">media-container</code> – wraps all our players</li><li class="listitem" style="list-style-type: disc"><code class="literal">media-area</code> – wraps video tag</li><li class="listitem" style="list-style-type: disc"><code class="literal">controls</code> – is the bottom bar that contains our controls</li></ul></div><p>Inside controls we have:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a id="id368" class="indexterm"/><code class="literal">play-button</code> – is the player's play/pause button</li><li class="listitem" style="list-style-type: disc"><a id="id369" class="indexterm"/><code class="literal">seek</code> – the progress/seek bar</li><li class="listitem" style="list-style-type: disc"><a id="id370" class="indexterm"/><code class="literal">fullscreen-button</code> – is the full screen functionality button</li><li class="listitem" style="list-style-type: disc"><a id="id371" class="indexterm"/><code class="literal">volume-container</code> – is the container of <code class="literal">volume-button</code></li><li class="listitem" style="list-style-type: disc"><a id="id372" class="indexterm"/><code class="literal">volume-slider</code> – is used to set the volume</li><li class="listitem" style="list-style-type: disc"><a id="id373" class="indexterm"/><code class="literal">timer</code> – is an indicator of time elapsed in minutes and seconds (mm:ss)<div><div><h3 class="title"><a id="tip37"/>Tip</h3><p>We are using classes although jQuery selectors work faster using IDs because we want to permit the use of multiple players in the same page if necessary.</p></div></div></li></ul></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec08"/>Styling</h3></div></div></div><a id="id374" class="indexterm"/><p>To start, we add some additional styles to <code class="literal">style.css</code>. We define a black background and remove the outline from all elements marked with the <code class="literal">media</code> class:</p><div><pre class="programlisting">.media{
  width:100%;
  background-color:#000;
  outline:none;
}</pre></div><p>We add a margin for the <strong>Top 5 Box Office</strong> section:</p><div><pre class="programlisting">.media-container{
  margin-right:200px;
}</pre></div><p>We remove that margin for small devices where we hide the <strong>Top 5 Box Office </strong>section:</p><div><pre class="programlisting">@media only screen and (max-width: 737px){
  …
  .media-container{
    margin-right:0;
  }
}</pre></div><a id="id375" class="indexterm"/><p>These styles are related to layout and not directly to our player. To make styles for our video player, let us create a stylesheet called <code class="literal">mediaplayer.css</code> and import it in the <code class="literal">head</code> tag of <code class="literal">trailer.html</code>.</p><div><pre class="programlisting">&lt;link rel="stylesheet" href="css/mediaplayer.css" type="text/css" /&gt;</pre></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec01"/>Buttons and image sprites</h4></div></div></div><a id="id376" class="indexterm"/><a id="id377" class="indexterm"/><p>We define our controls area using the <code class="literal">controls</code> class, set a black background, set a height of <code class="literal">35px</code> (same line height to center text vertically), and set <code class="literal">position</code> to <code class="literal">relative</code> (so if we set absolute elements inside the positioning, they will be relative to <code class="literal">controls</code>).</p><div><pre class="programlisting">.controls{
  background-color:#000;
  height:35px;
  line-height:35px;
  position:relative;
}</pre></div><p>We have an image sprite with all of our player controls called <code class="literal">player-control.png</code>. You can find it inside the <code class="literal">img</code> folder.</p><div><img src="img/5689_06_08.jpg" alt="Buttons and image sprites"/></div><p>The use of sprites is based on masking the visible element to show it and hiding the rest. In this case, suppose we want to show only our pause button. Our button has 35 x 35 pixels with <code class="literal">player-control.png</code> as the background image; the only part of the image that will be visible is inside our button area, so we can use background positioning to show different icons as is shown here: <a id="id378" class="indexterm"/>
<a id="id379" class="indexterm"/>
</p><div><img src="img/5689_06_09.jpg" alt="Buttons and image sprites"/></div><p>Defining the play, volume, and full screen buttons that we have:</p><div><pre class="programlisting">.play-button,.volume-button,.fullscreen-button{
  width:35px;
  height:35px;
  cursor:pointer;
  background-image:url(../img/player-control.png);
}</pre></div><p>As we saw before, we move <code class="literal">-35px</code> on the y axis to show our pause icon:</p><div><pre class="programlisting">.play-button.playing{
  background-position:0 -35px;
}</pre></div><p>We apply the same principle to the full screen button:</p><div><pre class="programlisting">.fullscreen-button{
  background-position:0 -105px;
}</pre></div><p>In the case of the volume button, we are going to have a slider to set the volume below it, so we set the background color to hide elements below and set the <code class="literal">position</code> to <code class="literal">absolute</code> with <code class="literal">z-index</code> of <code class="literal">1000</code> to be over the slider:</p><div><pre class="programlisting">.volume-button{
  background-position:0 -70px;
  position:absolute;
  left:0;
  background-color:#000;
  z-index:1000;
}</pre></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec02"/>Styling seek and volume bars</h4></div></div></div><a id="id380" class="indexterm"/><a id="id381" class="indexterm"/><p>The seek and volume bars can be styled as follows:</p><div><ol class="orderedlist arabic"><li class="listitem">Let us define the font styles in <code class="literal">timer</code>:<div><pre class="programlisting">.timer{
  color:#fff;
  font-size:.8em;
  padding:1px 8px 0;
}</pre></div></li><li class="listitem">At this point, we position <code class="literal">play-button</code> by floating it to the left-hand side and the timer, volume, and full screen to the right-hand side:<div><pre class="programlisting">.play-button,.seek{
  float:left;
}
.timer,.volume-container,.fullscreen-button{
  float:right;
}</pre></div></li><li class="listitem">We can float the <code class="literal">video</code> tag left with the <code class="literal">media</code> class to avoid extra spacing in some browsers:<div><pre class="programlisting">.media{
  float:left;
}</pre></div></li><li class="listitem">Use <code class="literal">overflow:hidden</code> to wrap <code class="literal">media-area</code> around <code class="literal">media</code>:<div><pre class="programlisting">.media-area{
  overflow:hidden;
  background-color:#000;
}</pre></div></li><li class="listitem">Using absolute positioning for the seek bar, we can dynamically expand the seek area using the <code class="literal">left</code> and <code class="literal">right</code> properties: <div><pre class="programlisting">.seek{
  top:12px;
  left:48px;
  right:133px;
  height:10px;
  position:absolute;
}</pre></div></li></ol></div><div><div><h3 class="title"><a id="tip38"/>Tip</h3><a id="id382" class="indexterm"/><a id="id383" class="indexterm"/><p>For this example, we created a flexible player to show some techniques related to styles, but it is good practice to define static dimensions for your player. Furthermore, it is better to use standard resolutions. The use of standard resolutions can improve performance for media reproduction on the client.</p></div></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec03"/>Features detection</h4></div></div></div><a id="id384" class="indexterm"/><p>Some of the <code class="literal">video</code> tag features are not available to all browsers via the HTML5 JavaScript API. For example, iOS devices disallow the use of volume control with JavaScript; it is only possible to use the default controls or hardware controls. Manipulating full screen controls using JavaScript is only possible in WebKit browsers.</p><p>We can define some classes to hide buttons when full screen or volume capabilities are not available. First, we hide our buttons:</p><div><pre class="programlisting">.no-fullscreen .fullscreen-button{
  display:none;
}
.no-volume .volume-container{
  display:none;
}</pre></div><p>Then, we change the <code class="literal">right</code> spacing of our <code class="literal">seek</code> bar:</p><div><pre class="programlisting">.no-volume .seek,.no-fullscreen .seek{
  right:88px;
}
.no-fullscreen.no-volume .seek{
  right:53px;
}</pre></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec04"/>Styling sliders</h4></div></div></div><a id="id385" class="indexterm"/><p>Since we are using jQuery UI to implement seek and volume sliders, we want to override some styles. jQuery UI sliders use the following:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">ui-slider-handle</code>: The circle that we use to drag and seek.</li><li class="listitem" style="list-style-type: disc"><code class="literal">ui-state-active</code>: The class added to <code class="literal">ui-slider-handle</code> while we drag.</li><li class="listitem" style="list-style-type: disc"><a id="id386" class="indexterm"/><code class="literal">ui-slider-range</code>: The bar that defines the active area. In our case, it is a blue bar.</li></ul></div><p>Let's see the process step by step.</p><div><ol class="orderedlist arabic"><li class="listitem">We want the same color for <code class="literal">ui-slider-handle</code> even when it is active, so we remove the background image used by jQuery UI:<div><pre class="programlisting">.ui-state-active{
  background-image:none;
}</pre></div></li><li class="listitem">Add the cursor pointer and remove the outline:<div><pre class="programlisting">.ui-slider .ui-slider-handle{
  cursor:pointer;
  outline:none;
}</pre></div></li><li class="listitem">Change <code class="literal">ui-slider-handle</code> size, rounded corners, and move it a little to the top (only for our <code class="literal">seek</code> slider):<div><pre class="programlisting">.seek .ui-slider-handle {
  width:16px;
  height:16px;
  top: -4px;
  -moz-border-radius:10px;
  -ms-border-radius:10px;
  -webkit-border-radius:10px;
  border-radius:10px;
}</pre></div></li><li class="listitem">Modify the rounded corners of the progress bar and add some inner shadows:<div><pre class="programlisting">.ui-slider-range {
  -moz-border-radius:15px;
  -ms-border-radius:15px;
  -webkit-border-radius:15px;
  border-radius:15px;
  box-shadow:inset 0 -3px 3px #39a2ce;
}</pre></div></li><li class="listitem">Change the seek bar progress color to a blue gradient:<div><pre class="programlisting">.seek .ui-slider-range {
  background: #4cbae8;
  background-image:-moz-linear-gradient(top, #4cbae8, #39a2ce);
  background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0, #4cbae8),color-stop(1, #39a2ce));
}</pre></div></li><li class="listitem"><a id="id387" class="indexterm"/>Change the volume progress color to a solid blue:<div><pre class="programlisting">.volume-slider .ui-slider-range {
  background:#4cbae8;
}</pre></div></li><li class="listitem">Center our volume slider using <code class="literal">margin</code> and set <code class="literal">width</code> and <code class="literal">height</code>:<div><pre class="programlisting">.volume-slider{
  margin:12px auto;
  width:6px;
  height:76px;
}</pre></div></li><li class="listitem">Set the volume handle dimensions and positioning:<div><pre class="programlisting">.volume-slider .ui-slider-handle {
  width:12px;
  height:12px;
  left: -4px;
}</pre></div></li><li class="listitem">To show and hide the volume slider, we set the <code class="literal">volume-container</code> positioning as <code class="literal">relative</code>:<div><pre class="programlisting">.volume-container{
  width:35px;
  height:35px;
  position:relative;
}</pre></div></li><li class="listitem">Set the slider positioning as <code class="literal">absolute</code>. We set <code class="literal">z-index</code> to <code class="literal">900</code> (below the volume button), <code class="literal">overflow</code> to <code class="literal">hidden</code>, and a CSS transition for all properties:<div><pre class="programlisting">.volume-slider-container{
  -moz-transition:all 0.1s ease-in-out;
  -ms-transition:all 0.1s ease-in-out;
  -o-transition:all 0.1s ease-in-out;
  -webkit-transition:all 0.1s ease-in-out;
  transition:all 0.1s ease-in-out; 
  position:absolute;
  bottom:1px;
  left:0;
  height:34px;
  width:35px;
  background-color:#000;
  z-index:900;
  overflow:hidden;
}</pre></div></li><li class="listitem"><a id="id388" class="indexterm"/>We can then resize <code class="literal">volume-container</code> on hover and <code class="literal">volume-slider-container</code> with it:<div><pre class="programlisting">.volume-container:hover .volume-slider-container{
  height:135px;
}</pre></div></li></ol></div><p>Now that our player looks the same, let us add all the interactions needed using JavaScript.</p></div></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec09"/>Adding interactions using JavaScript</h3></div></div></div><a id="id389" class="indexterm"/><p>To write our JavaScript code, we create a <code class="literal">movienow.mediaplayer.js</code> file in the <code class="literal">js</code> folder and include it before our body ends:</p><div><pre class="programlisting">&lt;script src="img/movienow.mediaplayer.js"&gt;&lt;/script&gt;</pre></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec05"/>Initial settings</h4></div></div></div><a id="id390" class="indexterm"/><p>We start our JavaScript the same way we started with geolocation by adding <code class="literal">mediaplayer</code> to our namespace and defining the <code class="literal">that</code> variable:</p><div><pre class="programlisting">var movienow = movienow || {};
movienow.mediaplayer = (function(){
  var that = this;
  <strong>/** OUR CODE GOES HERE **/	</strong>
})();</pre></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec06"/>Initializing video controllers</h4></div></div></div><p>When the <code class="literal">ready</code> document is triggered, we add the click event listeners to buttons, detect full screen capabilities, and add the <code class="literal">no-fullscreen</code> class if it is not available; initialize the jQuery UI slider for seeking and for volume control if it is available. Notice that we manage Mozilla, WebKit, and standard full screen capabilities with different functions. If <a id="id391" class="indexterm"/>volume is not available, we add the <code class="literal">no-volume</code> class and finally we bind the events of time update and reproduction ended.</p><div><pre class="programlisting">$(document).ready(function(){ 
  $(".media-container .play-button").click(that.play);
  var mediaElements=$(".media-container .media");
  if (mediaElements[0].fullscreenEnabled) {$(".media-container .fullscreen-button").click(that.fullScreen);
  }else if(mediaElements[0].mozRequestFullScreen){
    $(".media-container .fullscreen-button").click(that.mozFullScreen);
  }else if(mediaElements[0].webkitRequestFullScreen){
    $(".media-container .fullscreen-button").click(that.webkitFullScreen);
  }else{
    $(".media-container").addClass("no-fullscreen");
  }  
  $(".media-container .seek").each(function() {
    var duration=that.getPlayer($(this))[0].duration;
    duration = duration?duration:0;
    $(this).slider({
      value: 0,
      step: 0.01,
      orientation: "horizontal",
      range: "min",
      max: duration,
      start: function(event,ui){
        var mediaArea=that.getPlayer($(event.target));
        mediaArea.addClass("seeking");
        mediaArea[0].pause();
      },
      slide:function(event,ui){
        sliderTime(event,ui);
      },
      stop:function(event,ui){
        var mediaArea=that.getPlayer($(event.target));
        controls=that.controls(mediaArea);
        sliderTime(event,ui);
        if(controls.find(".play-button").hasClass("playing")){
          mediaArea[0].play();
        }
        mediaArea.removeClass("seeking");
      }
    });
    if(navigator.userAgent.match(/(iPhone|iPod|iPad)/i)){
      $(".media-container").addClass("no-volume");
    }else{
      that.controls($(this)).find(".volume-slider").slider({
        value: 1,
        step: 0.05,
        orientation: "vertical",
        range: "min",
        max: 1,
        animate: true,
        slide:function(event,ui){
          var mediaArea=that.getPlayer($(event.target));
          mediaArea[0].volume=ui.value;
        }
      });
    }
  });
  mediaElements.bind("timeupdate", that.timeUpdate);
  mediaElements.bind('ended', that.endReproduction);
});</pre></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec07"/>Setting the seek slider</h4></div></div></div><a id="id392" class="indexterm"/><p>To set the seek slider, we set the initial value <code class="literal">value</code> to <code class="literal">0</code> and <code class="literal">step</code> to <code class="literal">0.01</code> to have a fluid movie movement on drag, <code class="literal">orientation</code> to <code class="literal">horizontal</code>, and <code class="literal">range</code> to <code class="literal">min</code> to consider the range between minimum value and current handle position value:</p><div><pre class="programlisting">$(this).slider({
  value: 0,
  step: 0.01,
  orientation: "horizontal",
  range: "min",
  max: duration,
  start: function(event,ui){
    var mediaArea=that.getPlayer($(event.target));
    mediaArea.addClass("seeking");
    mediaArea[0].pause();
  },
  slide:function(event,ui){
    sliderTime(event,ui);
  },
  stop:function(event,ui){
    var mediaArea=that.getPlayer($(event.target));
    controls=that.controls(mediaArea);
    sliderTime(event,ui);
    if(controls.find(".play-button").hasClass("playing")){
      mediaArea[0].play();
    }
    mediaArea.removeClass("seeking");
  }
});</pre></div><a id="id393" class="indexterm"/><p>There are three events managed:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">start</code> is triggered when the slider handle is pressed. Notice that we get <code class="literal">video</code> using the <code class="literal">getPlayer</code> function (this method will be declared later). We can pause the reproduction and add the <code class="literal">seeking</code> class to indicate that we are still dragging.</li><li class="listitem" style="list-style-type: disc"><code class="literal">slide</code> is triggered while we drag. We call the <code class="literal">slideTime</code> function to set the progress bar position and time text.</li><li class="listitem" style="list-style-type: disc"><code class="literal">stop</code> is triggered on mouse up. We get the <code class="literal">video</code> tag and controls using the <code class="literal">controls</code> function, call <code class="literal">sliderTime</code> and restore the previous state of our player (playing or paused) using the <code class="literal">play-button playing</code> class. Finally, we remove <code class="literal">seeking</code> to indicate that we stop dragging.</li></ul></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec08"/>Initializing the volume slider</h4></div></div></div><a id="id394" class="indexterm"/><p>If volume is available, we initialize the volume slider:</p><div><pre class="programlisting">that.controls($(this)).find(".volume-slider").slider({
  value: 1,
  step: 0.05,
  orientation: "vertical",
  range: "min",
  max: 1,
  animate: true,
  slide:function(event,ui){
    var mediaArea=that.getPlayer($(event.target));
    mediaArea[0].volume=ui.value;
  }
});</pre></div><a id="id395" class="indexterm"/><p>Notice that the current value of our slider is contained in the <code class="literal">ui.value</code> variable, and to set it in our player we use the <code class="literal">volume</code> property shown as follows: </p><div><pre class="programlisting">mediaArea[0].volume=ui.value;</pre></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec09"/>Functions to get DOM objects</h4></div></div></div><a id="id396" class="indexterm"/><p>We define two functions to execute jQuery selectors for the main player (the <code class="literal">media</code> class for the <code class="literal">video</code> tag or the <code class="literal">audio</code> tag if it is the case) and controls (the <code class="literal">controls</code> class):</p><div><pre class="programlisting">this.getPlayer= function(domObject){
  return $(domObject.parentsUntil(".media-container").find(".media"));
};
this.controls= function(domObject){
  return $(domObject.parentsUntil(".media-container").find(".controls"));
};</pre></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec10"/>Play and pause</h4></div></div></div><a id="id397" class="indexterm"/><a id="id398" class="indexterm"/><p>For <code class="literal">play-button</code>, we toggle the <code class="literal">playing</code> class and set our player to the playing (<code class="literal">player[0].play()</code>) or paused (<code class="literal">player[0].pause()</code>) state.</p><div><pre class="programlisting">this.play = function(event){
  var button=$(event.target);
  var player=that.getPlayer(button);
  if(button.hasClass("playing")) {
    player[0].pause();
    button.removeClass("playing");
  } else {
    player[0].play();
    button.addClass("playing");
  }
};</pre></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec11"/>Full screen</h4></div></div></div><a id="id399" class="indexterm"/><p>Full screen functionality is managed in different ways by every browser. To enter the full screen mode we use <code class="literal">element.requestFullscreen()</code> and its equivalents <code class="literal">element.mozRequestFullScreen()</code> for Firefox and <code class="literal">element.webkitEnterFullScreen()</code> for Safari and Chrome. To exit full screen mode, we use <code class="literal">document.cancelFullScreen()</code> , <code class="literal">document.mozCancelFullScreen()</code> for Firefox, and <code class="literal">document.webkitCancelFullScreen()</code> for Safari and Chrome. Finally, to validate if the browser is in full screen mode we use <code class="literal">document.fullScreen</code>, <code class="literal">document.mozfullScreen</code> for Firefox, and <code class="literal">this.webkitFullScreen</code> for Safari and Chrome.</p><p>Even user experience-wise the browsers vary; while Chrome and Safari show their own video controllers on full screen, Firefox doesn't show any controls by default. Full screen capabilities are not available in Internet Explorer. Our implementation verifies the mode and toggles between full screen and normal mode.</p><p>Using standard calls we have:</p><div><pre class="programlisting">this.fullScreen = function(event){
  var button=$(event.target);
  var player=that.getPlayer(button);
  if(document.fullScreen){
    document.exitFullScreen();
  } else {
    player[0].requestFullScreen();
  }
};</pre></div><p>Using the Firefox prefix:</p><div><pre class="programlisting">this.mozFullScreen = function(event){
  var button=$(event.target);
  var player=that.getPlayer(button);
  if(document.mozfullScreen){
    document.mozCancelFullScreen();
  } else {
    player[0].mozRequestFullScreen();
  }
};</pre></div><p>Finally, for Safari and Chrome we have:</p><div><pre class="programlisting">this.webkitFullScreen = function(event){
  var button=$(event.target);
  var player=that.getPlayer(button);
  if(document.webkitIsFullScreen){
    document.webkitCancelFullScreen();
  } else {
    player[0].webkitEnterFullScreen();
  }
};</pre></div><a id="id400" class="indexterm"/><p>Notice that the event to exit full screen mode is not being triggered because the browsers manage that functionality using the <em>Esc</em> key, but depending on future implementations of the HTML5 full screen specification on every browser, we could show our controller in full screen mode and take advantage of this.</p></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec12"/>Format time</h4></div></div></div><a id="id401" class="indexterm"/><p>We define the <code class="literal">timeFormat</code> function to get the player time in seconds and return it in mm:ss format:</p><div><pre class="programlisting">this.timeFormat=function(seconds){
  var m=Math.floor(seconds/60)&lt;10?"0"+Math.floor(seconds/60):Math.floor(seconds/60);
  var s=Math.floor(seconds-(m*60))&lt;10?"0"+Math.floor(seconds-(m*60)):Math.floor(seconds-(m*60));
  return m+":"+s;
};</pre></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec13"/>Controlling time</h4></div></div></div><a id="id402" class="indexterm"/><p>Every time we use the seek slider, we set media player time using the <code class="literal">currentTime</code> property, which triggers the <a id="id403" class="indexterm"/>
<code class="literal">timeupdate</code> event calling the <code class="literal">timeUpdate</code> function.</p><div><pre class="programlisting">this.sliderTime = function(event, ui) {
  var mediaArea=that.getPlayer($(event.target));
  var controls=that.controls(mediaArea);
  mediaArea[0].currentTime=ui.value;
};</pre></div><p>
<code class="literal">timeUpdate</code> sets the time in mm:ss and if the player is not in the <code class="literal">seeking</code> state (defined by the <code class="literal">seeking</code> class in <code class="literal">mediaArea</code>), it updates the progress/seek bar too. This function is <a id="id404" class="indexterm"/>invoked when the <code class="literal">timeupdate</code> event is triggered:</p><div><pre class="programlisting">this.timeUpdate = function(event) {
  var mediaArea=$(event.target);
  var controls=that.controls(mediaArea);
  var currentTime=mediaArea[0].currentTime;
  var duration=mediaArea[0].duration;
  var timer=$(controls.find(".timer"));
  if(currentTime&gt;=0)timer.html(that.timeFormat(currentTime));
  if(!mediaArea.hasClass("seeking")){
    var seekSlider=$(controls.find(".seek"));
    if(seekSlider.slider("option","max")==0){
      var newDuration=mediaArea[0].duration;
      newDuration=newDuration?newDuration:0;
      seekSlider.slider("option","max", newDuration);
    }
    seekSlider.slider("value", currentTime);
  }
};</pre></div></div><div><div><div><div><h4 class="title"><a id="ch06lvl4sec14"/>Until the end of time</h4></div></div></div><a id="id405" class="indexterm"/><p>When the reproduction ends, <code class="literal">endReproduction</code> is called and we remove the <code class="literal">playing</code> class from <code class="literal">play-button</code> to indicate that we have finished the reproduction:</p><div><pre class="programlisting">this.endReproduction = function(event) {
  var mediaArea=$(event.target);
  $(that.controls(mediaArea)).find(".play-button").removeClass("playing");
};</pre></div><p>The final script should look like the following code snippet:</p><div><pre class="programlisting">var movienow = movienow || {};
movienow.mediaplayer = (function(){
  var that = this;
  $(document).ready(function(){
    /*** play/pause button click event listener ***/ $(".media-container .play-button").click(that.play);var mediaElements=$(".media-container .media");
    if(mediaElements[0].fullscreenEnabled) {/*** fullscreen button click event listener ***/
      $(".media-container .fullscreen-button").click(that.fullScreen);
    }else if(mediaElements[0].mozRequestFullScreen){/*** fullscreen button click event listener mozilla ***/
      $(".media-container .fullscreen-button").click(that.mozFullScreen);
    }else if(mediaElements[0].webkitRequestFullScreen){/*** fullscreen button click event listener webkit ***/
      $(".media-container .fullscreen-button").click(that.webkitFullScreen);
    }else{
      /*** we add class no-fullscreen to hide fullscreen button when it is not available ***/$(".media-container").addClass("no-fullscreen");
    }
    /*** Loop to add jquery ui sliders to progress/seek bar and volume ***/
    $(".media-container .seek").each(function() {
      /*** Duration of the media ***/
      var duration=that.getPlayer($(this))[0].duration;
      duration = duration?duration:0;
      $(this).slider({
        value: 0,
        step: 0.01,
        orientation: "horizontal",
        range: "min",
        max: duration,
        /*** Start seek ***/
        start: function(event,ui){
          var mediaArea=that.getPlayer($(event.target));
          /*** Class seeking to know status of the media player ***/
          mediaArea.addClass("seeking");
          mediaArea[0].pause();
        },
        /*** During seek ***/
        slide:function(event,ui){
          sliderTime(event,ui);
        },
        /*** Stop seek ***/
        stop:function(event,ui){
          var mediaArea=that.getPlayer($(event.target));
          var controls=that.controls(mediaArea);
          sliderTime(event,ui);
          /*** We restore the status (paying or not) to the one before start seeking ***/
          if(controls.find(".play-button").hasClass("playing")){
            mediaArea[0].play();
          }
          mediaArea.removeClass("seeking");
        }
      });
      /*** Volume controllers ***/
      if(navigator.userAgent.match(/(iPhone|iPod|iPad)/i)){
        /*** ios devices only allow to change volume using the device hardware, so we hide volume controllers ***/
        $(".media-container").addClass("no-volume");
      }else{
        /*** volume slider controller ***/
        that.controls($(this)).find(".volume-slider").slider({
          value: 1,
          step: 0.05,
          orientation: "vertical",
          range: "min",
          max: 1,
          animate: true,
          slide:function(event,ui){
            var mediaArea=that.getPlayer($(event.target));
            mediaArea[0].volume=ui.value;
          }
        });
      }
    });
    /*** event triggered when time change on media player ***/ 
    mediaElements.bind("timeupdate", that.timeUpdate);
    /*** event triggered when reproduction end on media player ***/
    mediaElements.bind('ended', that.endReproduction);
  });
  /*** get player using jQuery selectors ***/
  this.getPlayer= function(domObject){
    return $(domObject.parentsUntil(".media-container").find(".media"));
  };
  /*** get control area using jQuery selectors ***/
  this.controls= function(domObject){
    return $(domObject.parentsUntil(".media-container").find(".controls"));
  };
  /*** play or pause and chenge play button icon ***/
  this.play = function(event){
    var button=$(event.target);
    var player=that.getPlayer(button);
    if(button.hasClass("playing")) {
      player[0].pause();
      button.removeClass("playing");
    }else{
      player[0].play();
      button.addClass("playing");
    }
  };
  /*** set on and off fullscreen mode ***/
  this.fullScreen = function(event){
    var button=$(event.target);
    var player=that.getPlayer(button);
    if($(document).context.fullScreenElement){
      $(document).context.exitFullscreen();
    }else{
      player[0].requestFullscreen();
    }
  };
  this.mozFullScreen = function(event){
    var button=$(event.target);
    var player=that.getPlayer(button);
    if($(document).context.mozFullScreenElement){
      $(document).context.mozCancelFullScreen();
    }else{
      player[0].mozRequestFullScreen();
    }
  };
  this.webkitFullScreen = function(event){
    var button=$(event.target);
    var player=that.getPlayer(button);
    if($(document).context.webkitIsFullScreen){
      $(document).context.webkitCancelFullScreen();
    }else{
      player[0].webkitEnterFullScreen();
    }
  };
  /*** set time format to mm:ss ***/
  this.timeFormat=function(seconds){
    var m=Math.floor(seconds/60)&lt;10?"0"+Math.floor(seconds/60):Math.floor(seconds/60);
    var s=Math.floor(seconds-(m*60))&lt;10?"0"+Math.floor(seconds-(m*60)):Math.floor(seconds-(m*60));
    return m+":"+s;
  };
  /*** use by seek slider, change slider position and time on controllers ***/
  this.sliderTime = function(event, ui) {
    var mediaArea=that.getPlayer($(event.target));
    var controls=that.controls(mediaArea);
    mediaArea[0].currentTime=ui.value;
  };
  /*** use by timeupdate event, change slider position and time on controllers ***/
  this.timeUpdate = function(event) {
    var mediaArea=$(event.target);
    var controls=that.controls(mediaArea);
    var currentTime=mediaArea[0].currentTime;
    var duration=mediaArea[0].duration;
    var timer=$(controls.find(".timer"));
    if(currentTime&gt;=0)timer.html(that.timeFormat(currentTime));
    if(!mediaArea.hasClass("seeking")){
      var seekSlider=$(controls.find(".seek"));
      /*** some players (like safari) don't have duration when a player is initialized, this verify duration and assigned again to max property on slider ***/
      if(seekSlider.slider("option","max")==0){
        var newDuration=mediaArea[0].duration;
        newDuration=newDuration?newDuration:0;
        seekSlider.slider("option","max", newDuration);
      }
      seekSlider.slider("value", currentTime);
    }
  };
  /*** change play button when reproduction ends ***/
  this.endReproduction = function(event) {
    var mediaArea=$(event.target);
    $(that.controls(mediaArea)).find(".play-button").removeClass("playing");
  };
})();</pre></div><a id="id406" class="indexterm"/><p>As a result we have a video player for multiple platforms:</p><div><img src="img/5689_06_07.jpg" alt="Until the end of time"/></div></div></div></div><div><div><div><div><h2 class="title"><a id="ch06lvl2sec66"/>Possible improvements</h2></div></div></div><a id="id407" class="indexterm"/><p>At this point we have a fully functional player, but we can add more improvements in the future. An interesting functionality to add is a buffering notification. To achieve this, you will need to listen to the <code class="literal">loadstart</code> event to recognize the start of loading of a video, <code class="literal">waiting</code> and <code class="literal">stalled</code> (depending on the browser: <a class="ulink" href="http://www.longtailvideo.com/html5/buffering/">http://www.longtailvideo.com/html5/buffering/</a>) to detect a stop in the reproduction because of buffering, and finally <code class="literal">canplay</code> and <code class="literal">canplaythrough</code> to recognize the end of buffering.</p><p>On <code class="literal">loadstart</code>, <code class="literal">waiting</code>, and <code class="literal">stalled</code> a buffering notification should be shown and on <code class="literal">canplay</code> and <code class="literal">canplaythrough</code> that notification should be hidden.</p></div><div><div><div><div><h2 class="title"><a id="ch06lvl2sec67"/>Still not perfect</h2></div></div></div><p>The HTML5 video specification is still in progress. Major inconsistencies exist because of multiple implementation decisions across browsers and platforms requiring different encodings. Nevertheless, it is a standard way of supporting video without plugins.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec56"/>Introducing HTML5 audio</h1></div></div></div><p>The HTML5 audio specification—much like HTML5 video—is still in development, and there is no audio format supported across all browsers. Motives for this are the same ones that have bee<a id="id408" class="indexterm"/>n impeding standardized support of HTML5 video as you can see in the following table:<a id="id409" class="indexterm"/>
</p><div><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Browser</p>
</th><th style="text-align: left" valign="bottom">
<p>Ogg Vorbis</p>
</th><th style="text-align: left" valign="bottom">
<p>WAV PCM</p>
</th><th style="text-align: left" valign="bottom">
<p>MP3</p>
</th><th style="text-align: left" valign="bottom">
<p>AAC</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<strong>Internet Explorer</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>9</p>
</td><td style="text-align: left" valign="top">
<p>9</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Mozilla Firefox</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>3.5</p>
</td><td style="text-align: left" valign="top">
<p>3.5</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Google Chrome</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>6</p>
</td><td style="text-align: left" valign="top">
<p>6</p>
</td><td style="text-align: left" valign="top">
<p>6</p>
</td><td style="text-align: left" valign="top">
<p>6</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Safari</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>Manual install</p>
</td><td style="text-align: left" valign="top">
<p>5</p>
</td><td style="text-align: left" valign="top">
<p>5</p>
</td><td style="text-align: left" valign="top">
<p>5</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<strong>Opera</strong>
</p>
</td><td style="text-align: left" valign="top">
<p>10.6</p>
</td><td style="text-align: left" valign="top">
<p>10.6</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td><td style="text-align: left" valign="top">
<p>No</p>
</td></tr></tbody></table></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec57"/>Implementing an audio player</h1></div></div></div><a id="id410" class="indexterm"/><p>MovieNow needs an audio podcast player. For that, we are going to use the HTML5 <code class="literal">audio</code> tag.</p><p>The <code class="literal">audio</code> tag behaves more or less the same as the <code class="literal">video</code> tag:</p><div><pre class="programlisting">&lt;audio&gt;
  &lt;source src="img/horse.ogg" type="audio/ogg" /&gt;
  &lt;source src="img/horse.mp3" type="audio/mp3" /&gt;
  &lt;p&gt;Audio not supported.&lt;/p&gt;
&lt;/audio&gt;</pre></div><div><div><h3 class="title"><a id="tip39"/>Tip</h3><p>Like the <code class="literal">video</code> tag, the <code class="literal">audio</code> tag allows you to specify the <code class="literal">src</code> attribute directly inside of it.</p></div></div><a id="id411" class="indexterm"/><p>To test, we will be using a sound effect audio from <a class="ulink" href="http://www.w3schools.com/">http://www.w3schools.com/</a>:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://www.w3schools.com/html5/horse.ogg">http://www.w3schools.com/html5/horse.ogg</a> for Firefox, Google Chrome, and Opera</li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://www.w3schools.com/html5/horse.mp3">http://www.w3schools.com/html5/horse.mp3</a> for Internet Explorer, Google Chrome, Safari, and Safari iOS</li></ul></div><p>We will create a <code class="literal">podcast.html</code> file and import the same libraries as <code class="literal">trailer.html</code>.</p><div><div><div><div><h2 class="title"><a id="ch06lvl2sec68"/>Custom controllers</h2></div></div></div><a id="id412" class="indexterm"/><p>Our media player is generic enough to use the same HTML structure for audio. We only need to replace the <code class="literal">video</code> tag with the <code class="literal">audio</code> tag, assign the <code class="literal">media</code> class to <code class="literal">audio</code> tag, and remove the full screen button:<a id="id413" class="indexterm"/>
</p><div><pre class="programlisting">&lt;div class="media-container no-fullscreen"&gt;
  &lt;div&gt;
    &lt;div class="media-area"&gt;
      &lt;audio class="media"&gt;
        &lt;source src="img/horse.ogg" type="audio/ogg" /&gt;
        &lt;source src="img/horse.mp3" type="audio/mp3" /&gt;
        &lt;p&gt;Audio not supported.&lt;/p&gt;
      &lt;/audio&gt;
    &lt;/div&gt;
    &lt;div class="controls"&gt;
      &lt;div class="play-button"&gt;&lt;/div&gt;
      &lt;div class="seek"&gt;&lt;/div&gt;
      &lt;div class="volume-container"&gt;
        &lt;div class="volume-slider-container"&gt;
          &lt;div class="volume-slider"&gt;&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="volume-button"&gt;&lt;/div&gt;
      &lt;/div&gt;
      &lt;div class="timer"&gt;00:00&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec10"/>Styling</h3></div></div></div><a id="id414" class="indexterm"/><p>One last adjustment is related to the <code class="literal">audio</code> tag. Some browsers have the <code class="literal">height</code> attribute defined by default, so we reset it to <code class="literal">0</code>:</p><div><pre class="programlisting">audio.media{
  height:0;
}</pre></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec58"/>How I learned to stop worrying and love Flash</h1></div></div></div><p>The awful truth is that HTML5 video and media capabilities are a new technology and the browser war makes it even more difficult to adopt these solutions as a standard for media playback. While Flash requires the installation of a plugin, it is a reliable technology to reproduce media and stream it across multiple browsers.</p><p>While Flash support decreases on mobile devices and video and audio specifications improve, certainly there will be a future with no Flash media, but for now Flash is, at worst, a fallback solution for cross-browser compatibility.</p><p>Huge media delivery products like YouTube still rely on Flash as the primary technology. You can decide to use HTML5 as your primary technology and fall back to Flash if the <code class="literal">video</code> and <code class="literal">audio</code> tags are not supported or vice versa, but the choice should be made based on your application's requirements.</p></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec59"/>Summary</h1></div></div></div><p>The HTML5 <code class="literal">video</code> and <code class="literal">audio</code> tags are simple and elegant ways to support media in your enterprise application, but differences between implementations across browsers should be taken into account when it is necessary to use them as a solution. For now, the best solution is to use both solutions and define a primary solution and a fallback.</p><p>The next chapter will focus on the use of another exciting feature of HTML5: canvas. We will use the <code class="literal">canvas</code> tag as a tool to visualize analytics related to movie reviews.</p></div></body></html>