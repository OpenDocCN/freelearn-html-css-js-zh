<html><head></head><body>
		<div><h1 id="_idParaDest-166"><em class="italic"><a id="_idTextAnchor165"/>Chapter 9</em>: Integrating Vue.js with Node.js</h1>
			<p>In this chapter, we will learn how to integrate a Vue.js application into a Node.js server, using Express to structure the server code (according to the MVC model) and MongoDB to store the information.</p>
			<p>For this, we will use the example of the list management application built in <a href="B17416_05_ePub.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <em class="italic">Managing a List with Vue.js</em>. But here, the server used will be a Node.js server, and the list items will be stored in the MongoDB database. This will allow them to be redisplayed later, if necessary.</p>
			<p>In the end, we will obtain a client-server application entirely made in JavaScript (both on the client side and on the server side).</p>
			<p>Here are the topics covered in this chapter:</p>
			<ul>
				<li>Displaying application screens</li>
				<li>Building the app with Express</li>
				<li>MongoDB database structure</li>
				<li>Installing the Axios library</li>
				<li>Inserting a new element in the list</li>
				<li>Displaying list elements</li>
				<li>Modifying an element in the list</li>
				<li>Removing an element from the list</li>
			</ul>
			<p>The application uses the same screens as those already used in <a href="B17416_05_ePub.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a><em class="italic">, Managing a List with Vue.js</em>. We repeat them below to make them easier for you to understand.</p>
			<h1 id="_idParaDest-167"><a id="_idTextAnchor166"/>Technical requirements</h1>
			<p>You can find the code files for this chapter on GitHub at: <a href="https://github.com/PacktPublishing/JavaScript-from-Frontend-to-Backend/blob/main/Chapter%209.zip">https://github.com/PacktPublishing/JavaScript-from-Frontend-to-Backend/blob/main/Chapter%209.zip</a>.</p>
			<h1 id="_idParaDest-168"><a id="_idTextAnchor167"/>Displaying application screens</h1>
			<p>Here, we <a id="_idIndexMarker636"/>visualize the screens of the application, allowing the following:</p>
			<ul>
				<li>Displaying the already existing list (empty at first)</li>
				<li>Inserting a new element at the end of the list</li>
				<li>Modifying an element of the list</li>
				<li>Removing an item from the list<p class="callout-heading">Note</p><p class="callout">The URL to access the list is <code>http://localhost:3000</code>. The server used here is a Node.js server <a id="_idIndexMarker637"/>running with the <strong class="bold">Express</strong> module. The database used <a id="_idIndexMarker638"/>is <strong class="bold">MongoDB</strong>.</p></li>
			</ul>
			<p>Initially, the list is empty. Only the <strong class="bold">Add Element</strong> button is present on the page (see the following figure):</p>
			<div><div><img src="img/Figure_9.01_B17416.jpg" alt="Figure 9.1 – Empty item list&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.1 – Empty item list</p>
			<p>Clicking the <strong class="bold">Add Element</strong> button <a id="_idIndexMarker639"/>multiple times creates multiple rows with the text <strong class="bold">Element X</strong> followed by <strong class="bold">Remove</strong> and <strong class="bold">Modify</strong> buttons (here, we clicked on the <strong class="bold">Add Element</strong> button three times):</p>
			<div><div><img src="img/Figure_9.02_B17416.jpg" alt="Figure 9.2 – Adding three items to the list&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.2 – Adding three items to the list</p>
			<p>Next, let’s modify the second element. An input field appears in place of the item text. Let’s type <code>New Element 2</code> in place of the text displayed in the input field:</p>
			<div><div><img src="img/Figure_9.03_B17416.jpg" alt="Figure 9.3 – Editing the second item in the list&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.3 – Editing the second item in the list</p>
			<p>By clicking <a id="_idIndexMarker640"/>outside the input field, the input field disappears, and the text of the element appears modified:</p>
			<div><div><img src="img/Figure_9.04_B17416.jpg" alt="Figure 9.4 – Second list item changed&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.4 – Second list item changed</p>
			<p>Finally, let’s remove the first and third items from the list:</p>
			<div><div><img src="img/Figure_5.06_B17416.jpg" alt="Figure 9.5 – First and third list items removed&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.5 – First and third list items removed</p>
			<p>Now, when we <a id="_idIndexMarker641"/>refresh the previous window, we see that the list is re-displayed with <code>New Element 2</code>, thus indicating that the modifications made are indeed stored in a database. This was not the case when we made this application in <a href="B17416_05_ePub.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <em class="italic">Managing a List with Vue.js</em>, with only Vue.js, because the elements of the list were not saved in a database:</p>
			<div><div><img src="img/Figure_5.06_B17416.jpg" alt="Figure 9.6 – New list display: the list is preserved&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.6 – New list display: the list is preserved</p>
			<p>To create this application, we will, of course, use the Vue.js program that we have already written in <a href="B17416_05_ePub.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <em class="italic">Managing a List with Vue.js</em>. But it will have to be modified so that this application works on a Node.js server with the Express module and that the data displayed is stored in the MongoDB database.</p>
			<p>We’ll indicate here the files of the <code>&lt;GlobalApp&gt;</code> and <code>&lt;Element&gt;</code> components, written previously, in <a href="B17416_05_ePub.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <em class="italic">Managing a List with Vue.js</em>, to explain the modifications <a id="_idIndexMarker642"/>that will be made to them hereafter.</p>
			<p>Here’s the <code>&lt;GlobalApp&gt;</code> component:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">&lt;GlobalApp&gt; component (global-app.js file)</p>
			<pre class="source-code">import Element from "./element.js";</pre>
			<pre class="source-code">const GlobalApp = {</pre>
			<pre class="source-code">  data() {</pre>
			<pre class="source-code">    return {</pre>
			<pre class="source-code">      elements : []</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  components : {</pre>
			<pre class="source-code">    Element:Element</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  template : `</pre>
			<pre class="source-code">    &lt;button @click="add()"&gt;Add Element&lt;/button&gt;</pre>
			<pre class="source-code">    &lt;ul&gt;</pre>
			<pre class="source-code">      &lt;Element v-for="(element, index) in elements" </pre>
			<pre class="source-code">       :key="index" </pre>
			<pre class="source-code">        :text="element" :index="index"</pre>
			<pre class="source-code">        @remove="remove($event)" @modify="modify($event)"</pre>
			<pre class="source-code">      /&gt;</pre>
			<pre class="source-code">    &lt;/ul&gt;</pre>
			<pre class="source-code">  `,</pre>
			<pre class="source-code">  methods : {</pre>
			<pre class="source-code">    add() {</pre>
			<pre class="source-code">      var element = "Element " + (this.elements.length + 1);</pre>
			<pre class="source-code">      this.elements.push(element);</pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    remove(params) {</pre>
			<pre class="source-code">      var index = params.index;</pre>
			<pre class="source-code">      this.elements.splice(index, 1);</pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    modify(params) {</pre>
			<pre class="source-code">      var index = params.index;</pre>
			<pre class="source-code">      var value = params.value;</pre>
			<pre class="source-code">      this.elements[index] = value;</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  }</pre>
			<pre class="source-code">}</pre>
			<pre class="source-code">export default GlobalApp;</pre>
			<p>Here’s <a id="_idIndexMarker643"/>the <code>&lt;Element&gt;</code> component:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">&lt;Element&gt; component (element.js file)</p>
			<pre class="source-code">const Element = {</pre>
			<pre class="source-code">  data() {</pre>
			<pre class="source-code">    return {</pre>
			<pre class="source-code">      input : false</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  template : `</pre>
			<pre class="source-code">    &lt;li&gt; </pre>
			<pre class="source-code">      &lt;span v-if="!input"&gt; {{text}} &lt;/span&gt;</pre>
			<pre class="source-code">      &lt;input v-else type="text" :value="text" </pre>
			<pre class="source-code">       @blur="modify($event)" ref="refInput" /&gt;</pre>
			<pre class="source-code">      &lt;button @click="remove()"&gt; Remove &lt;/button&gt; </pre>
			<pre class="source-code">      &lt;button @click="input=true"&gt; Modify &lt;/button&gt;</pre>
			<pre class="source-code">    &lt;/li&gt;</pre>
			<pre class="source-code">  `,</pre>
			<pre class="source-code">  props : ["text", "index"],</pre>
			<pre class="source-code">  methods : {</pre>
			<pre class="source-code">    remove() {</pre>
			<pre class="source-code">      // process the click on the Remove button</pre>
			<pre class="source-code">      this.$emit("remove", { index : this.index });</pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    modify(event) {</pre>
			<pre class="source-code">      var value = event.target.value;</pre>
			<pre class="source-code">      this.input = false;</pre>
			<pre class="source-code">      this.$emit("modify", { index : this.index, value : </pre>
			<pre class="source-code">      value });</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  emits : ["remove", "modify"],</pre>
			<pre class="source-code">  updated() {</pre>
			<pre class="source-code">    // check that refInput exists, and if so, give focus to </pre>
			<pre class="source-code">    // the input field</pre>
			<pre class="source-code">    if (this.$refs.refInput) this.$refs.refInput.focus();  </pre>
			<pre class="source-code">  }</pre>
			<pre class="source-code">}</pre>
			<pre class="source-code">export default Element;</pre>
			<p>The <code>index.html</code> file that <a id="_idIndexMarker644"/>allows you to include the <code>&lt;GlobalApp&gt;</code> component is the following:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">index.html file</p>
			<pre class="source-code">&lt;html&gt;</pre>
			<pre class="source-code">  &lt;head&gt;</pre>
			<pre class="source-code">    &lt;meta charset="utf-8" /&gt;</pre>
			<pre class="source-code">    &lt;script src="img/vue@next"&gt;&lt;/script&gt;</pre>
			<pre class="source-code">    </pre>
			<pre class="source-code">    &lt;style type="text/css"&gt;</pre>
			<pre class="source-code">      li {</pre>
			<pre class="source-code">        margin-top:10px;</pre>
			<pre class="source-code">      }</pre>
			<pre class="source-code">      ul button {</pre>
			<pre class="source-code">        margin-left:10px;</pre>
			<pre class="source-code">      }</pre>
			<pre class="source-code">    &lt;/style&gt;</pre>
			<pre class="source-code">  &lt;/head&gt;</pre>
			<pre class="source-code">  &lt;body&gt;</pre>
			<pre class="source-code">    &lt;div id="app"&gt;&lt;/div&gt;</pre>
			<pre class="source-code">  &lt;/body&gt;</pre>
			<pre class="source-code">  </pre>
			<pre class="source-code">  &lt;script type="module"&gt;</pre>
			<pre class="source-code">  </pre>
			<pre class="source-code">    import GlobalApp from "./global-app.js";</pre>
			<pre class="source-code">    </pre>
			<pre class="source-code">    var app = Vue.createApp({</pre>
			<pre class="source-code">      components : {</pre>
			<pre class="source-code">        GlobalApp:GlobalApp</pre>
			<pre class="source-code">      },</pre>
			<pre class="source-code">      template : "&lt;GlobalApp /&gt;"</pre>
			<pre class="source-code">    });</pre>
			<pre class="source-code">    </pre>
			<pre class="source-code">    var vm = app.mount("div#app");</pre>
			<pre class="source-code">    </pre>
			<pre class="source-code">  &lt;/script&gt;</pre>
			<pre class="source-code">  </pre>
			<pre class="source-code">&lt;/html&gt;</pre>
			<p>To create <a id="_idIndexMarker645"/>this application, we start by creating the Node.js application, which will host the JavaScript code written with Vue.js. To do this, the application is created using the <code>express</code> command. The application will be named <em class="italic">list</em> (for example), so we will have to type the <code>express list</code> command to create this application, as is explained in the following section.</p>
			<h1 id="_idParaDest-169"><a id="_idTextAnchor168"/>Building the app with Express</h1>
			<p>Let’s start <a id="_idIndexMarker646"/>by creating the application with Express. To do this, type the <code>express list</code> command, which creates the <a id="_idIndexMarker647"/>application named <em class="italic">list</em>. This application will be accessible using the URL <code>http://localhost:3000</code>, as seen in <a href="B17416_07_ePub.xhtml#_idTextAnchor138"><em class="italic">Chapter 7</em></a>, <em class="italic">Using Express with Node.js</em>.</p>
			<p>Let’s type the <code>express list</code> command in the current directory:</p>
			<div><div><img src="img/Figure_9.07_B17416.jpg" alt="Figure 9.7 – Creating the application list with Express&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.7 – Creating the application list with Express</p>
			<p>The server is started by typing the indicated commands, namely:  <code>cd list</code>, <code>npm install</code>, followed by <code>npm start</code>.</p>
			<p>The application is started by typing the URL <code>http://localhost:3000</code> in the browser.</p>
			<p>We display the basic application created as standard by Express (see <em class="italic">Figure 9.8</em>).</p>
			<p>If an error occurs while loading the Express modules, you can type the <code>npm link express</code> command in order to locate the Express module within the application. And if an error occurs while loading the mongoose module, you can type the <code>npm link mongoose</code> command.</p>
			<p>If all is okay, you obtain the following:</p>
			<div><div><img src="img/Figure_9.08_B17416.jpg" alt="Figure 9.8 – Standard application created with Express&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.8 – Standard application created with Express</p>
			<p>The goal <a id="_idIndexMarker648"/>now is to visualize our list <a id="_idIndexMarker649"/>management application, created with Vue.js. It consists of three files:</p>
			<ul>
				<li>The <code>index.html</code> file, which is the file to view at startup</li>
				<li>The <code>global-app.js</code> file, which describes the main <code>&lt;GlobalApp&gt;</code> component of the application</li>
				<li>The <code>element.js</code> file, which describes the <code>&lt;Element&gt;</code> component corresponding to a displayed element line</li>
			</ul>
			<p>The main directory of the Express application (the <code>list</code> directory) includes a <code>public</code> subdirectory containing the <code>images</code>, <code>javascripts</code>, and <code>stylesheets</code> subdirectories.</p>
			<p>Let’s drop the three files <code>index.html</code>, <code>global-app.js</code>, and <code>element.js</code> in the <code>public</code> directory, directly under the root.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Modifying files in the <code>public</code> directory does not require a server restart. On the other hand, modifying the <code>app.js</code> file of the Express application requires restarting the server with <code>npm start</code>.</p>
			<p>Let’s view the URL <code>http://localhost:3000</code> again in the browser. The Vue.js application we built in <a href="B17416_05_ePub.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <em class="italic">Managing a List with Vue.js</em>, will now appear. Button clicks will also start working.</p>
			<p>The only <a id="_idIndexMarker650"/>difference is that our Vue.js <a id="_idIndexMarker651"/>application runs on a Node.js server instead of running on another application server like in <a href="B17416_05_ePub.xhtml#_idTextAnchor109"><em class="italic">Chapter 5</em></a>, <em class="italic">Managing a List with Vue.js</em>.</p>
			<div><div><img src="img/Figure_9.09_B17416.jpg" alt="Figure 9.9 – Application running on a Node.js server&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.9 – Application running on a Node.js server</p>
			<p>However, if the page displayed is refreshed, the list previously displayed is deleted because there is currently no persistence of the information displayed in the database.</p>
			<p>We will now see how our application can interact with the Node.js server and the MongoDB database.</p>
			<h1 id="_idParaDest-170"><a id="_idTextAnchor169"/>MongoDB database structure</h1>
			<p>To build our application, we will have to perform data reads and updates on the server in the database. For example, each click on the <code>elements</code> collection. Indeed, each document of the <code>elements</code> collection will represent the text of the element displayed in the list on the screen.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">To access the MongoDB database, you start by installing the mongoose module (see the previous chapter), which allows you to manipulate database documents in JavaScript.</p>
			<p class="callout">To do this, type the <code>npm install mongoose</code> command (from the main directory, <code>list</code>, of the Express application).</p>
			<p>The <code>elements</code> collection will be the one that will store the list items in MongoDB. A document in the <code>elements</code> collection will consist of its text associated with the <code>text</code> property. Each document will also have the <code>_id</code> property, whose unique value is assigned by MongoDB for each document inserted into the collection.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The structure of the database is described using the <code>listSchema</code> schema, which will be associated with the <code>List</code> model used to create the documents of the <code>elements</code> collection.</p>
			<p>Express’s <code>app.js</code> file is modified to include these definitions:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Adding List model to use MongoDB’s elements collection (app.js file) </p>
			<pre class="source-code">var createError = require('http-errors');</pre>
			<pre class="source-code">var express = require('express');</pre>
			<pre class="source-code">var path = require('path');</pre>
			<pre class="source-code">var cookieParser = require('cookie-parser');</pre>
			<pre class="source-code">var logger = require('morgan');</pre>
			<pre class="source-code">var indexRouter = require('./routes/index');</pre>
			<pre class="source-code">var usersRouter = require('./routes/users');</pre>
			<pre class="source-code"><strong class="bold">var mongoose = require("mongoose");</strong></pre>
			<pre class="source-code"><strong class="bold">mongoose.connect("mongodb://localhost/mydb_test"); // we </strong></pre>
			<pre class="source-code"><strong class="bold">                                                   // connect </strong></pre>
			<pre class="source-code"><strong class="bold">                                                   // to </strong></pre>
			<pre class="source-code"><strong class="bold">                                                   // mydb_test</strong></pre>
			<pre class="source-code"><strong class="bold">var listSchema = mongoose.Schema({</strong></pre>
			<pre class="source-code"><strong class="bold"> text : String     // text associated with the list item</strong></pre>
			<pre class="source-code"><strong class="bold">});</strong></pre>
			<pre class="source-code"><strong class="bold">// association of the List model with the elements collection</strong></pre>
			<pre class="source-code"><strong class="bold">var List = mongoose.model("elements", listSchema);</strong></pre>
			<pre class="source-code">var app = express();</pre>
			<pre class="source-code">// view engine setup</pre>
			<pre class="source-code">app.set('views', path.join(__dirname, 'views'));</pre>
			<pre class="source-code">app.set('view engine', 'jade');</pre>
			<pre class="source-code">app.use(logger('dev'));</pre>
			<pre class="source-code">app.use(express.json());</pre>
			<pre class="source-code">app.use(express.urlencoded({ extended: false }));</pre>
			<pre class="source-code">app.use(cookieParser());</pre>
			<pre class="source-code">app.use(express.static(path.join(__dirname, 'public')));</pre>
			<pre class="source-code">app.use('/', indexRouter);</pre>
			<pre class="source-code">app.use('/users', usersRouter);</pre>
			<pre class="source-code">// catch 404 and forward to error handler</pre>
			<pre class="source-code">app.use(function(req, res, next) {</pre>
			<pre class="source-code">  next(createError(404));</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">// error handler</pre>
			<pre class="source-code">app.use(function(err, req, res, next) {</pre>
			<pre class="source-code">  // set locals, only providing error in development</pre>
			<pre class="source-code">  res.locals.message = err.message;</pre>
			<pre class="source-code">  res.locals.error = req.app.get('env') === 'development' ? </pre>
			<pre class="source-code">  err : {};</pre>
			<pre class="source-code">  // render the error page</pre>
			<pre class="source-code">  res.status(err.status || 500);</pre>
			<pre class="source-code">  res.render('error');</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">module.exports = app;</pre>
			<p>The <code>app.js</code> file will then be enriched to define the new routes that will update the database. These routes <a id="_idIndexMarker653"/>will be created by using the <code>app.use()</code> method (as explained in <a href="B17416_07_ePub.xhtml#_idTextAnchor138"><em class="italic">Chapter 7</em></a>, <em class="italic">Using Express with Node.js</em>). The creation of these routes will be described in the following sections.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Thanks to the <code>List</code> model that we have created, we will have access to the methods <code>List.create()</code>, <code>List.find()</code>, and so on for manipulating documents in the <code>elements</code> collection of the MongoDB database.</p>
			<p>To create interactions between the client (here, the browser) and the server (here, the Node.js server) in order to update the database containing the list of elements, we use the <strong class="bold">Axios JavaScript library</strong> here.</p>
			<h1 id="_idParaDest-171"><a id="_idTextAnchor170"/>Installing the Axios library</h1>
			<p>We see that, for now, we can manipulate the list items displayed on the HTML page, but we cannot yet <a id="_idIndexMarker654"/>update them in the database on the server.</p>
			<p>For this, the Vue.js program must be able to communicate with the Node.js server. This is possible using <a id="_idIndexMarker655"/>a JavaScript library such as Axios (see <a href="https://github.com/axios/axios">https://github.com/axios/axios</a>). All you have to do is include the library in the HTML page (here, it will be in the <code>index.html</code> file) in order to be able to use its features.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The Axios library is a library allowing communication between a browser and a server using <strong class="bold">Ajax technology</strong>. This technology <a id="_idIndexMarker656"/>allows a browser and a server to exchange information while remaining on the same HTML page, which is what we want here. This is <a id="_idIndexMarker657"/>called a <strong class="bold">single-page application</strong> (<strong class="bold">SPA</strong>) (when the application consists of a single HTML page).</p>
			<p>Let’s include the Axios library in the <code>index.html</code> file (using the <code>&lt;script&gt;</code> tag), and display the value of the <code>axios.VERSION</code> variable, which contains the version number of the library. This <a id="_idIndexMarker658"/>verifies that the Axios library is accessible:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Including Axios library and displaying version number (index.html file)</p>
			<pre class="source-code">&lt;html&gt;</pre>
			<pre class="source-code">  &lt;head&gt;</pre>
			<pre class="source-code">    &lt;meta charset="utf-8" /&gt;</pre>
			<pre class="source-code">    &lt;script src="img/vue@next"&gt;&lt;/script&gt;</pre>
			<pre class="source-code">    <strong class="bold">&lt;script src="https://unpkg.com/axios/dist/</strong></pre>
			<pre class="source-code"><strong class="bold">    axios.min.js"&gt;&lt;/script&gt;</strong></pre>
			<pre class="source-code">    </pre>
			<pre class="source-code">    &lt;style type="text/css"&gt;</pre>
			<pre class="source-code">      li {</pre>
			<pre class="source-code">        margin-top:10px;</pre>
			<pre class="source-code">      }</pre>
			<pre class="source-code">      ul button {</pre>
			<pre class="source-code">        margin-left:10px;</pre>
			<pre class="source-code">      }</pre>
			<pre class="source-code">    &lt;/style&gt;</pre>
			<pre class="source-code">  &lt;/head&gt;</pre>
			<pre class="source-code">  &lt;body&gt;</pre>
			<pre class="source-code">    &lt;div id="app"&gt;&lt;/div&gt;</pre>
			<pre class="source-code">  &lt;/body&gt;</pre>
			<pre class="source-code">  </pre>
			<pre class="source-code">  &lt;script type="module"&gt;</pre>
			<pre class="source-code">  </pre>
			<pre class="source-code">   <strong class="bold"> console.log("axios.VERSION = " + axios.VERSION); </strong></pre>
			<pre class="source-code"><strong class="bold">    // display Axios version number</strong></pre>
			<pre class="source-code">    </pre>
			<pre class="source-code">    import GlobalApp from "./global-app.js";</pre>
			<pre class="source-code">    </pre>
			<pre class="source-code">    var app = Vue.createApp({</pre>
			<pre class="source-code">      components : {</pre>
			<pre class="source-code">        GlobalApp:GlobalApp</pre>
			<pre class="source-code">      },</pre>
			<pre class="source-code">      template : "&lt;GlobalApp /&gt;"</pre>
			<pre class="source-code">    });</pre>
			<pre class="source-code">    </pre>
			<pre class="source-code">    var vm = app.mount("div#app");</pre>
			<pre class="source-code">    </pre>
			<pre class="source-code">  &lt;/script&gt;</pre>
			<pre class="source-code">  </pre>
			<pre class="source-code">&lt;/html&gt;</pre>
			<p>We simply <a id="_idIndexMarker659"/>added in the <code>index.html</code> file the Axios library (using the <code>&lt;script&gt;</code> tag) and the instruction to display the version number of the Axios library in the console, which allows us to check that the Axios library is accessible afterward.</p>
			<p>Let’s display the page again in the browser (with the URL <code>http://localhost:3000</code>).</p>
			<p>We get a message in the console indicating the version number of Axios used (see the following figure), thus showing that we have access to the functionalities of the Axios library:</p>
			<div><div><img src="img/Figure_9.10_B17416.jpg" alt="Figure 9.10 – Displaying the Axios version number&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.10 – Displaying the Axios version number</p>
			<p>Now let’s <a id="_idIndexMarker660"/>see how to use Axios to interact with the server and update the database documents.</p>
			<p>The goal is, of course, to make maximum use of the Vue.js code that we have already written by modifying it to use the Axios library and thus perform communication with the Node.js server.</p>
			<p>Subsequently, we will therefore modify the following files (in addition to the <code>index.html</code> file previously modified to include the Axios library):</p>
			<ul>
				<li>The <code>global-app.js</code> file, to make calls to the Axios library</li>
				<li>The <code>element.js</code> file, to adapt it to the structure of the database</li>
				<li>The <code>app.js</code> file (created by Express), to perform database queries</li>
			</ul>
			<p>We have seen how to install and use Axios in our program. Now let’s see how to use it to insert an element into the database.</p>
			<h1 id="_idParaDest-172"><a id="_idTextAnchor171"/>Inserting a new element in the list</h1>
			<p>Let’s see how to store a new element in the list, following a click on the <strong class="bold">Add Element</strong> button.</p>
			<p>The text associated <a id="_idIndexMarker661"/>with this element must be transmitted to the server, which will be of the form <strong class="bold">Element X</strong>. We will see later how to modify this text after clicking on the <strong class="bold">Modify</strong> button.</p>
			<p>The <code>add()</code> method defined in the <code>&lt;GlobalApp&gt;</code> component is used to insert a new element into the displayed list. It will be necessary to add instructions that use the Axios library in order to also insert this new element in the MongoDB <code>elements</code> collection.</p>
			<p>Before starting to use Axios, it is useful to slightly modify the JavaScript program written with Vue.js. To do this, we will use a new attribute when creating the <code>&lt;Element&gt;</code> component, replacing the <code>text</code> and <code>index</code> attributes with the <code>element</code> attribute.</p>
			<h2 id="_idParaDest-173"><a id="_idTextAnchor172"/>Replacing the text and index attributes with the element attribute</h2>
			<p>When <a id="_idIndexMarker662"/>creating an element, we currently use the element’s text and index, which are then used in the <code>&lt;Element&gt;</code> component, to display it (with its text) or to modify or delete it (with its index).</p>
			<p>The use of the index to identify the element in the list displayed on the screen was relevant before, but this is no longer the case if we want to modify or delete the element in the database. This is because the documents of a MongoDB collection are not identified by their index but rather by their identifier <code>_id</code>.</p>
			<p>Rather than passing the <code>text</code> and <code>index</code> parameters in the <code>&lt;Element&gt;</code> component, we simplify by passing only the <code>element</code> parameter, which is a <code>{ text, _id }</code> object. The <code>element.text</code> field allows you to retrieve the text to be displayed, while the <code>element._id</code> field allows you to access the unique identifier of the element (such as the index, which was unique for each element).</p>
			<p>We modify the <code>global-app.js</code> and <code>element.js</code> files to take this into account.</p>
			<p>These files are modified below but will be modified again to take into account the connection with the database:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">global-app.js file</p>
			<pre class="source-code">import Element from "./element.js";</pre>
			<pre class="source-code">const GlobalApp = {</pre>
			<pre class="source-code">  data() {</pre>
			<pre class="source-code">    return {</pre>
			<pre class="source-code">      <strong class="bold">elements : []  // array of object { text, _id }</strong></pre>
			<pre class="source-code"><strong class="bold">                     // (_id = document id in MongoDB)</strong></pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  components : {</pre>
			<pre class="source-code">    Element:Element</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  template : `</pre>
			<pre class="source-code">    &lt;button @click="add()"&gt;Add Element&lt;/button&gt;</pre>
			<pre class="source-code">    &lt;ul&gt;</pre>
			<pre class="source-code">     <strong class="bold"> &lt;Element v-for="(element, index) in elements" </strong></pre>
			<pre class="source-code"><strong class="bold">       :key="index" :element="element"</strong></pre>
			<pre class="source-code"><strong class="bold">        @remove="remove($event)" @modify="modify($event)"</strong></pre>
			<pre class="source-code"><strong class="bold">      /&gt;</strong></pre>
			<pre class="source-code">    &lt;/ul&gt;</pre>
			<pre class="source-code">  `,</pre>
			<pre class="source-code">  methods : {</pre>
			<pre class="source-code">    add() {</pre>
			<pre class="source-code">      <strong class="bold">var text = "Element " + (this.elements.length + 1);</strong></pre>
			<pre class="source-code"><strong class="bold">      this.elements.push({text:text, </strong></pre>
			<pre class="source-code"><strong class="bold">      _id:this.elements.length});  </strong></pre>
			<pre class="source-code"><strong class="bold">                         // to modify to retrieve the real </strong></pre>
			<pre class="source-code"><strong class="bold">                         // _id provided by MongoDB</strong></pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    remove(params) {</pre>
			<pre class="source-code">      var id = params.id;</pre>
			<pre class="source-code">    <strong class="bold">  // remove the element with this id from the elements </strong></pre>
			<pre class="source-code"><strong class="bold">      // array</strong></pre>
			<pre class="source-code"><strong class="bold">      this.elements = this.elements.filter(</strong></pre>
			<pre class="source-code"><strong class="bold">      function(element) {</strong></pre>
			<pre class="source-code"><strong class="bold">        if (element._id == id) return false;</strong></pre>
			<pre class="source-code"><strong class="bold">        else return true;</strong></pre>
			<pre class="source-code"><strong class="bold">      });</strong></pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    modify(params) {</pre>
			<pre class="source-code">      var id = params.id;</pre>
			<pre class="source-code">      var value = params.value;</pre>
			<pre class="source-code">    <strong class="bold">  // modify the text of the element with this id in the </strong></pre>
			<pre class="source-code"><strong class="bold">      // elements array</strong></pre>
			<pre class="source-code"><strong class="bold">      this.elements = this.elements.map(function(element) {</strong></pre>
			<pre class="source-code"><strong class="bold">        if (element._id == id) {</strong></pre>
			<pre class="source-code"><strong class="bold">          element.text = value;</strong></pre>
			<pre class="source-code"><strong class="bold">          return element;</strong></pre>
			<pre class="source-code"><strong class="bold">        }</strong></pre>
			<pre class="source-code"><strong class="bold">        else return element;</strong></pre>
			<pre class="source-code"><strong class="bold">      });</strong></pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  }</pre>
			<pre class="source-code">}</pre>
			<pre class="source-code">export default GlobalApp;</pre>
			<p>The <a id="_idIndexMarker663"/>following remarks can be made about the preceding code:</p>
			<ul>
				<li>The reactive <code>elements</code> variable now becomes an array of <code>{ text, _id }</code> objects. To do this, we write in the <code>add()</code> method the instruction <code>this.elements.push({text:text, _id:this.elements.length})</code> by inserting an object of the form <code>{text, _id}</code> into the <code>elements</code> array.</li>
				<li>The value of the <code>_id</code> property is temporary here: in fact, you must then retrieve the identifier provided by MongoDB when the document has been saved in the database.</li>
				<li>Each <code>&lt;Element&gt;</code> component is constructed (in the template) by passing it an <code>element</code> attribute that represents a <code>{ text, _id }</code> object.</li>
				<li>The <code>remove()</code> method must remove from the list the element having the passed identifier. To do this, we use the JavaScript <code>filter()</code> method to keep all the elements except the one with this identifier.</li>
				<li>Similarly, the <code>modify()</code> method must modify the value of the element of the list having this identifier. We use the JavaScript <code>map()</code> method to return a new array of elements, for which the element with this identifier has its value modified.</li>
			</ul>
			<p>The <code>element.js</code> file becomes the following:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">element.js file</p>
			<pre class="source-code">const Element = {</pre>
			<pre class="source-code">  data() {</pre>
			<pre class="source-code">    return {</pre>
			<pre class="source-code">      input : false</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  template : `</pre>
			<pre class="source-code">    &lt;li&gt; </pre>
			<pre class="source-code">      <strong class="bold">&lt;span v-if="!input"&gt; {{element.text}} &lt;/span&gt;</strong></pre>
			<pre class="source-code"><strong class="bold">      &lt;input v-else type="text" :value="element.text" </strong></pre>
			<pre class="source-code"><strong class="bold">       @blur="modify($event)" </strong></pre>
			<pre class="source-code"><strong class="bold">                    ref="refInput" /&gt;</strong></pre>
			<pre class="source-code">      &lt;button @click="remove()"&gt; Remove &lt;/button&gt; </pre>
			<pre class="source-code">      &lt;button @click="input=true"&gt; Modify &lt;/button&gt;</pre>
			<pre class="source-code">    &lt;/li&gt;</pre>
			<pre class="source-code">  `,</pre>
			<pre class="source-code">  <strong class="bold">props : ["element"],</strong></pre>
			<pre class="source-code">  methods : {</pre>
			<pre class="source-code">    remove() {</pre>
			<pre class="source-code">      // process the click on the Remove button</pre>
			<pre class="source-code">     <strong class="bold"> this.$emit("remove", { id : this.element._id });</strong></pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    modify(event) {</pre>
			<pre class="source-code">      var value = event.target.value;</pre>
			<pre class="source-code">      this.input = false;</pre>
			<pre class="source-code">      <strong class="bold">this.$emit("modify", { id : this.element._id, value : </strong></pre>
			<pre class="source-code"><strong class="bold">      value });</strong></pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  emits : ["remove", "modify"],</pre>
			<pre class="source-code">  updated() {</pre>
			<pre class="source-code">    // check that refInput exists, and if so, give focus to </pre>
			<pre class="source-code">    // the input field</pre>
			<pre class="source-code">    if (this.$refs.refInput) this.$refs.refInput.focus();  </pre>
			<pre class="source-code">  }</pre>
			<pre class="source-code">}</pre>
			<pre class="source-code">export default Element;</pre>
			<p>As <a id="_idIndexMarker664"/>the attribute transmitted for the creation of the <code>&lt;Element&gt;</code> component is named <code>element</code> and corresponds to an object <code>{ text, _id }</code>, we use <code>element.text</code> and <code>element._id</code> to display the text and use the identifier of the element (instead of the index).</p>
			<p>You can check that the program still works, even if the connection with the server for insertion into the database has not yet been made.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">We have modified the code of the Vue.js program in order to adapt it to the use of the MongoDB database.</p>
			<p>Let’s now explain how the Axios library will allow the client and the server to communicate with each other, in order to update the MongoDB database.</p>
			<h2 id="_idParaDest-174"><a id="_idTextAnchor173"/>Description of the Axios library for communicating between the client and the server</h2>
			<p>Now let’s use Axios to insert the element into the database.</p>
			<p>Axios <a id="_idIndexMarker665"/>offers four main methods for communicating between the browser and the server, with the JavaScript language. The server we are using here is a Node.js server, but Axios allows you to interact with any type of server. The four methods are those related to the types of HTTP requests one can make: <code>GET</code>, <code>POST</code>, <code>PUT</code>, and <code>DELETE</code>:</p>
			<ul>
				<li><code>axios.get(url, options)</code>: This allows you to perform a <code>GET</code> type request.</li>
				<li><code>axios.post(url, options)</code>: This allows you to perform a <code>POST</code> type request.</li>
				<li><code>axios.put(url, options)</code>: This allows you to perform a <code>PUT</code> type request.</li>
				<li><code>axios.delete(url, options)</code>: This allows you to perform a <code>DELETE</code> type request.</li>
			</ul>
			<p>The <code>options</code> parameter allows you to specify additional parameters that will allow the server to perform its processing. For example, in the case of our application, we will indicate in this parameter the text of the list element that we want to store in the database.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">All these methods return a <code>Promise</code> object, which then allows you to continue with the <code>then(callback)</code> method. The <code>callback(response)</code> function is used to retrieve and analyze the server’s response following the request being made.</p>
			<p class="callout"><code>Promise</code> objects were studied at the end of <a href="B17416_02_ePub.xhtml#_idTextAnchor044"><em class="italic">Chapter 2</em></a>, <em class="italic">Exploring the Advanced Concepts of JavaScript</em>.</p>
			<p>In each case, we will have to process the Axios request sent on the client side (in the <code>global-app.js</code> file associated with the <code>&lt;GlobalApp&gt;</code> component), then take it into <a id="_idIndexMarker666"/>account on the server side (in the <code>app.js</code> file, which receives the queries issued by Axios).</p>
			<p>Now let’s see how the <code>POST</code> request will allow us to insert elements into the database.</p>
			<h2 id="_idParaDest-175"><a id="_idTextAnchor174"/>Using Axios with a POST type request (client side)</h2>
			<p>Now let’s <a id="_idIndexMarker667"/>see how to use the <code>axios.post()</code> method to insert a new element into the <code>elements</code> collection, following the creation of a new element in the list.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">We are using the <code>POST</code> request here to insert the item, but other types of requests would work the same. However, using the <code>POST</code> request makes sense here because it follows the <a id="_idIndexMarker668"/>official recommendations for using <strong class="bold">REpresentational State Transfer</strong> (<strong class="bold">REST</strong>) requests.</p>
			<p>Although only a few lines are added to each file, the full code is shown below each time, so you can see where the changes are located:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Adding a new element in the database, client side (global-app.js file)</p>
			<pre class="source-code">import Element from "./element.js";</pre>
			<pre class="source-code">const GlobalApp = {</pre>
			<pre class="source-code">  data() {</pre>
			<pre class="source-code">    return {</pre>
			<pre class="source-code">      elements : []  // array of object { text, _id }</pre>
			<pre class="source-code">                     // (_id = document id in MongoDB)</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  components : {</pre>
			<pre class="source-code">    Element:Element</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  template : `</pre>
			<pre class="source-code">    &lt;button @click="add()"&gt;Add Element&lt;/button&gt;</pre>
			<pre class="source-code">    &lt;ul&gt;</pre>
			<pre class="source-code">      &lt;Element v-for="(element, index) in elements" </pre>
			<pre class="source-code">       :key="index" :element="element"</pre>
			<pre class="source-code">        @remove="remove($event)" @modify="modify($event)"</pre>
			<pre class="source-code">      /&gt;</pre>
			<pre class="source-code">    &lt;/ul&gt;</pre>
			<pre class="source-code">  `,</pre>
			<pre class="source-code">  methods : {</pre>
			<pre class="source-code">    add() {</pre>
			<pre class="source-code">      var text = "Element " + (this.elements.length + 1);</pre>
			<pre class="source-code">      <strong class="bold">axios.post("/list", {text:text})     // pass object </strong></pre>
			<pre class="source-code"><strong class="bold">                                           // {text:text} to </strong></pre>
			<pre class="source-code"><strong class="bold">                                           // server</strong></pre>
			<pre class="source-code"><strong class="bold">      .then((response) =&gt; {</strong></pre>
			<pre class="source-code"><strong class="bold">        this.elements.push({text:text, </strong></pre>
			<pre class="source-code"><strong class="bold">        _id:response.data.id});</strong></pre>
			<pre class="source-code"><strong class="bold">      });</strong></pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    remove(params) {</pre>
			<pre class="source-code">      var id = params.id;</pre>
			<pre class="source-code">      // remove the element with this id from the elements </pre>
			<pre class="source-code">      // array</pre>
			<pre class="source-code">      this.elements = this.elements.filter(</pre>
			<pre class="source-code">      function(element) {</pre>
			<pre class="source-code">        if (element._id == id) return false;</pre>
			<pre class="source-code">        else return true;</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    modify(params) {</pre>
			<pre class="source-code">      var id = params.id;</pre>
			<pre class="source-code">      var value = params.value;</pre>
			<pre class="source-code">      // modify the text of the element with this id in the </pre>
			<pre class="source-code">      // elements array</pre>
			<pre class="source-code">      this.elements = this.elements.map(function(element) {</pre>
			<pre class="source-code">        if (element._id == id) {</pre>
			<pre class="source-code">          element.text = value;</pre>
			<pre class="source-code">          return element;</pre>
			<pre class="source-code">        }</pre>
			<pre class="source-code">        else return element;</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  }</pre>
			<pre class="source-code">}</pre>
			<pre class="source-code">export default GlobalApp;</pre>
			<p>The <code>axios.post("/list", {text:text})</code> method activates the <code>/list</code> URL on the server, using a <code>POST</code> type request. The <code>text</code> parameter is passed to the server so that it stores it in the <code>elements</code> collection.</p>
			<p>In return for the call to the server, the latter returns a <code>response</code> object containing in <code>data.id</code> the identifier of the document created in MongoDB. This identifier and the element <a id="_idIndexMarker669"/>text are then stored in the <code>elements</code> array. Because the <code>elements</code> array is a reactive variable of Vue.js, its update causes the list to be re-displayed in the browser.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Notice how the callback function is written in the <code>then(callback)</code> method. We use the form with <code>=&gt;</code> (that is without using the <code>function</code> keyword) in order to preserve the value of <code>this</code> in the callback function. If you use the <code>function</code> keyword instead, the value of <code>this</code> is <code>undefined</code> and you can no longer access the <code>elements</code> variable through <code>this.elements</code>, which will cause an error.</p>
			<p>The <code>POST</code> request was issued by the client (the browser), so it must now be processed by the server to insert a new element into the collection. Let’s study how to proceed.</p>
			<h2 id="_idParaDest-176"><a id="_idTextAnchor175"/>POST type request processing (server side)</h2>
			<p>Now let’s <a id="_idIndexMarker670"/>see how the server handles the receipt of the <code>POST</code> request. It must create a new document in the <code>elements</code> collection of the database. The server’s <code>app.js</code> file is modified to take into account the <code>POST</code> request on the <code>/list</code> URL:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Adding a new element in the database, server side (app.js file)</p>
			<pre class="source-code">var createError = require('http-errors');</pre>
			<pre class="source-code">var express = require('express');</pre>
			<pre class="source-code">var path = require('path');</pre>
			<pre class="source-code">var cookieParser = require('cookie-parser');</pre>
			<pre class="source-code">var logger = require('morgan');</pre>
			<pre class="source-code">var indexRouter = require('./routes/index');</pre>
			<pre class="source-code">var usersRouter = require('./routes/users');</pre>
			<pre class="source-code">var mongoose = require("mongoose");</pre>
			<pre class="source-code">mongoose.connect("mongodb://localhost/mydb_test");</pre>
			<pre class="source-code">var listSchema = mongoose.Schema({</pre>
			<pre class="source-code"> text : String</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">var List = mongoose.model("elements", listSchema);</pre>
			<pre class="source-code">var app = express();</pre>
			<pre class="source-code">// view engine setup</pre>
			<pre class="source-code">app.set('views', path.join(__dirname, 'views'));</pre>
			<pre class="source-code">app.set('view engine', 'jade');</pre>
			<pre class="source-code">app.use(logger('dev'));</pre>
			<pre class="source-code">app.use(express.json());</pre>
			<pre class="source-code">app.use(express.urlencoded({ extended: false }));</pre>
			<pre class="source-code">app.use(cookieParser());</pre>
			<pre class="source-code">app.use(express.static(path.join(__dirname, 'public')));</pre>
			<pre class="source-code">app.use('/', indexRouter);</pre>
			<pre class="source-code">app.use('/users', usersRouter);</pre>
			<pre class="source-code"><strong class="bold">// creating a new element in the list</strong></pre>
			<pre class="source-code"><strong class="bold">app.post("/list", function(req, res) {</strong></pre>
			<pre class="source-code"><strong class="bold">  var text = req.body.text;</strong></pre>
			<pre class="source-code"><strong class="bold">  List.create({text:text}, function(err, doc) {</strong></pre>
			<pre class="source-code"><strong class="bold">    res.json({id:doc._id});  // send the MongoDB identifier </strong></pre>
			<pre class="source-code"><strong class="bold">                             // in the response</strong></pre>
			<pre class="source-code"><strong class="bold">  });</strong></pre>
			<pre class="source-code"><strong class="bold">});</strong></pre>
			<pre class="source-code">// catch 404 and forward to error handler</pre>
			<pre class="source-code">app.use(function(req, res, next) {</pre>
			<pre class="source-code">  next(createError(404));</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">// error handler</pre>
			<pre class="source-code">app.use(function(err, req, res, next) {</pre>
			<pre class="source-code">  // set locals, only providing error in development</pre>
			<pre class="source-code">  res.locals.message = err.message;</pre>
			<pre class="source-code">  res.locals.error = req.app.get('env') === 'development' ? </pre>
			<pre class="source-code">  err : {};</pre>
			<pre class="source-code">  // render the error page</pre>
			<pre class="source-code">  res.status(err.status || 500);</pre>
			<pre class="source-code">  res.render('error');</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">module.exports = app;</pre>
			<p>The <code>app.post("/list", callback)</code> method is used to receive and process the request to insert the new element into the <code>elements</code> collection.</p>
			<p>The text sent in the Axios <code>text</code> parameter is received on the server in the <code>req.body.text</code> variable. The update of the <code>elements</code> collection is performed by the <code>List.create()</code> class method, to which we pass the <code>text</code> parameter. In the callback function associated with the <code>create()</code> method, we retrieve the identifier of the document created in <code>doc._id</code>.</p>
			<p>We return <a id="_idIndexMarker671"/>this identifier in the response sent to the browser as a JSON object <code>{ id : doc._id }</code>. We use the <code>res.json()</code> method for this. This server return is processed in the <code>then(callback)</code> method when calling the <code>axios.post()</code> method previously seen (the <code>global-app.js</code> file).</p>
			<p>If you run the preceding program, you’ll see that the lines containing <strong class="bold">Element X</strong> are inserted one under the other on the page. But nothing says that the database has been updated. Let’s verify the correct insertion using the tools available in MongoDB.</p>
			<h2 id="_idParaDest-177"><a id="_idTextAnchor176"/>Verifying the correct operation of the insertion in the database</h2>
			<p>To verify <a id="_idIndexMarker672"/>the insertion in the database, just use the <code>mongo</code> utility, then type the command <code>db.elements.find()</code> to see the inserted documents displayed (assuming we have already connected the <code>mydb_test</code> database with the <code>db=connect("mydb_test")</code> command).</p>
			<p>Assuming that three list items have been inserted, we get the following:</p>
			<div><div><img src="img/Figure_9.11_B17416.jpg" alt="Figure 9.11 – Using the mongo utility to view the contents of the elements collection&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.11 – Using the mongo utility to view the contents of the elements collection</p>
			<p>The next <a id="_idIndexMarker673"/>step is to retrieve the information stored in the database to display the items in the list. The list should be viewed when the page is displayed at the start and will be updated as insertions, modifications, or deletions are made.</p>
			<h1 id="_idParaDest-178"><a id="_idTextAnchor177"/>Displaying list elements</h1>
			<p>In this section, we deal with the first display of the page. Insertion has been seen previously, and <a id="_idIndexMarker674"/>modification and deletion are covered in the following sections.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">To display the list when the application starts, you must use the <code>created()</code> method or the <code>mounted()</code> method of the component, which are called in each Vue.js component when the component is created.</p>
			<p>To retrieve the list of elements, we are going to use an HTTP <code>GET</code> request.</p>
			<h2 id="_idParaDest-179"><a id="_idTextAnchor178"/>Using Axios with a GET type request (client side)</h2>
			<p>Here, we <a id="_idIndexMarker675"/>are going to make a <code>GET</code> type request with the <code>/list</code> URL to the server. The <code>axios.get("/list")</code> instruction is used to perform this request. We can use this instruction in the <code>created()</code> or <code>mounted()</code> method. Here, we choose to use it in the <code>created()</code> method:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Retrieving list of items, client side (global-app.js file)</p>
			<pre class="source-code">import Element from "./element.js";</pre>
			<pre class="source-code">const GlobalApp = {</pre>
			<pre class="source-code">  data() {</pre>
			<pre class="source-code">    return {</pre>
			<pre class="source-code">      elements : []  // array of object { text, _id }</pre>
			<pre class="source-code">                     // (_id = document id in MongoDB)</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  components : {</pre>
			<pre class="source-code">    Element:Element</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  template : `</pre>
			<pre class="source-code">    &lt;button @click="add()"&gt;Add Element&lt;/button&gt;</pre>
			<pre class="source-code">    &lt;ul&gt;</pre>
			<pre class="source-code">      &lt;Element v-for="(element, index) in elements" </pre>
			<pre class="source-code">       :key="index" :element="element"</pre>
			<pre class="source-code">        @remove="remove($event)" @modify="modify($event)"</pre>
			<pre class="source-code">      /&gt;</pre>
			<pre class="source-code">    &lt;/ul&gt;</pre>
			<pre class="source-code">  `,</pre>
			<pre class="source-code">  methods : {</pre>
			<pre class="source-code">    add() {</pre>
			<pre class="source-code">      var text = "Element " + (this.elements.length + 1);</pre>
			<pre class="source-code">      axios.post("/list", {text:text})</pre>
			<pre class="source-code">      .then((response) =&gt; {</pre>
			<pre class="source-code">        console.log(this.elements);</pre>
			<pre class="source-code">        this.elements.push({text:text, </pre>
			<pre class="source-code">        _id:response.data.id});</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    remove(params) {</pre>
			<pre class="source-code">      var id = params.id;</pre>
			<pre class="source-code">      // remove the element with this id from the elements </pre>
			<pre class="source-code">      // array</pre>
			<pre class="source-code">      this.elements = this.elements.filter(</pre>
			<pre class="source-code">      function(element) {</pre>
			<pre class="source-code">        if (element._id == id) return false;</pre>
			<pre class="source-code">        else return true;</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    modify(params) {</pre>
			<pre class="source-code">      var id = params.id;</pre>
			<pre class="source-code">      var value = params.value;</pre>
			<pre class="source-code">      // modify the text of the element with this id in the </pre>
			<pre class="source-code">      // elements array</pre>
			<pre class="source-code">      this.elements = this.elements.map(function(element) {</pre>
			<pre class="source-code">        if (element._id == id) {</pre>
			<pre class="source-code">          element.text = value;</pre>
			<pre class="source-code">          return element;</pre>
			<pre class="source-code">        }</pre>
			<pre class="source-code">        else return element;</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  <strong class="bold">created() {</strong></pre>
			<pre class="source-code"><strong class="bold">    axios.get("/list")</strong></pre>
			<pre class="source-code"><strong class="bold">    .then((response) =&gt; {</strong></pre>
			<pre class="source-code"><strong class="bold">      this.elements = response.data.elements.map(</strong></pre>
			<pre class="source-code"><strong class="bold">       function(element) {</strong></pre>
			<pre class="source-code"><strong class="bold">         return {_id : element._id, text : element.text }</strong></pre>
			<pre class="source-code"><strong class="bold">      });</strong></pre>
			<pre class="source-code"><strong class="bold">    });</strong></pre>
			<pre class="source-code"><strong class="bold">  }</strong></pre>
			<pre class="source-code">}</pre>
			<pre class="source-code">export default GlobalApp;</pre>
			<p>The <code>axios.get("/list")</code> method makes the request to the server, then processes the response received in the <code>then(callback)</code> method. As before, the received <code>response</code> object contains the <code>data</code> property, which contains the response returned by the server (the <code>elements</code> field – see below).</p>
			<p>As the <a id="_idIndexMarker676"/>server sends all the document fields of the <code>elements</code> collection, we filter the list received by the <code>map()</code> method in order to keep only the <code>_id</code> and <code>text</code> fields (we thus remove the <code>__v</code> field associated with the version number, which is unnecessary here).</p>
			<p>Now let’s see how to process the <code>GET</code> request on the Node.js server side.</p>
			<h2 id="_idParaDest-180"><a id="_idTextAnchor179"/>GET type request processing (server side)</h2>
			<p>The <code>GET</code> <code>/list</code> request is received by the Node.js server through the <code>app.get("/list")</code> method defined in the <code>app.js</code> file. The processing will consist of reading <a id="_idIndexMarker677"/>the content of the <code>elements</code> collection and returning it in JSON form to the browser in the <code>elements</code> property. Each item in the returned collection has <code>_id</code>, <code>text</code>, and <code>__v</code> (for the version number of the document) fields:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Retrieving list of items, server side (app.js file)</p>
			<pre class="source-code">var createError = require('http-errors');</pre>
			<pre class="source-code">var express = require('express');</pre>
			<pre class="source-code">var path = require('path');</pre>
			<pre class="source-code">var cookieParser = require('cookie-parser');</pre>
			<pre class="source-code">var logger = require('morgan');</pre>
			<pre class="source-code">var indexRouter = require('./routes/index');</pre>
			<pre class="source-code">var usersRouter = require('./routes/users');</pre>
			<pre class="source-code">var mongoose = require("mongoose");</pre>
			<pre class="source-code">mongoose.connect("mongodb://localhost/mydb_test");</pre>
			<pre class="source-code">var listSchema = mongoose.Schema({</pre>
			<pre class="source-code"> text : String</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">var List = mongoose.model("elements", listSchema);</pre>
			<pre class="source-code">var app = express();</pre>
			<pre class="source-code">// view engine setup</pre>
			<pre class="source-code">app.set('views', path.join(__dirname, 'views'));</pre>
			<pre class="source-code">app.set('view engine', 'jade');</pre>
			<pre class="source-code">app.use(logger('dev'));</pre>
			<pre class="source-code">app.use(express.json());</pre>
			<pre class="source-code">app.use(express.urlencoded({ extended: false }));</pre>
			<pre class="source-code">app.use(cookieParser());</pre>
			<pre class="source-code">app.use(express.static(path.join(__dirname, 'public')));</pre>
			<pre class="source-code">app.use('/', indexRouter);</pre>
			<pre class="source-code">app.use('/users', usersRouter);</pre>
			<pre class="source-code">// creating a new element in the list</pre>
			<pre class="source-code">app.post("/list", function(req, res) {</pre>
			<pre class="source-code">  var text = req.body.text;</pre>
			<pre class="source-code">  console.log(text);</pre>
			<pre class="source-code">  List.create({text:text}, function(err, doc) {</pre>
			<pre class="source-code">    res.json({id:doc._id});</pre>
			<pre class="source-code">  });</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code"><strong class="bold">// retrieving list of elements</strong></pre>
			<pre class="source-code"><strong class="bold">app.get("/list", function(req, res) {</strong></pre>
			<pre class="source-code"><strong class="bold">  List.find(function(err, elements) {</strong></pre>
			<pre class="source-code"><strong class="bold">    res.json({elements:elements});</strong></pre>
			<pre class="source-code"><strong class="bold">  });</strong></pre>
			<pre class="source-code"><strong class="bold">});</strong></pre>
			<pre class="source-code">// catch 404 and forward to error handler</pre>
			<pre class="source-code">app.use(function(req, res, next) {</pre>
			<pre class="source-code">  next(createError(404));</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">// error handler</pre>
			<pre class="source-code">app.use(function(err, req, res, next) {</pre>
			<pre class="source-code">  // set locals, only providing error in development</pre>
			<pre class="source-code">  res.locals.message = err.message;</pre>
			<pre class="source-code">  res.locals.error = req.app.get('env') === 'development' ? </pre>
			<pre class="source-code">  err : {};</pre>
			<pre class="source-code">  // render the error page</pre>
			<pre class="source-code">  res.status(err.status || 500);</pre>
			<pre class="source-code">  res.render('error');</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">module.exports = app;</pre>
			<p>The <code>elements</code> collection is read using the <code>List.find()</code> class method. We return the <code>{ elements : elements }</code> object in response to the browser, the use of which we saw earlier.</p>
			<p>The list of <a id="_idIndexMarker678"/>items is now displayed each time the application is started. Just restart the server with <code>npm start</code>, then re-display the URL of the page, <code>http://localhost:3000</code>.</p>
			<div><div><img src="img/Figure_9.12_B17416.jpg" alt="Figure 9.12 – The list of elements is displayed when the application starts&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 9.12 – The list of elements is displayed when the application starts</p>
			<p>We have seen how to insert an element and retrieve the list of elements. Next, let’s see how to modify an element in the list.</p>
			<h1 id="_idParaDest-181"><a id="_idTextAnchor180"/>Modifying an element in the list</h1>
			<p>Here we <a id="_idIndexMarker679"/>show how to modify an element of the list, keeping this modification in the database. A <code>PUT</code> type request will be used for this.</p>
			<h2 id="_idParaDest-182"><a id="_idTextAnchor181"/>Using Axios with a PUT type request (client side)</h2>
			<p>The <code>axios.put("/list", options)</code> method is used to perform a <code>PUT</code> type request <a id="_idIndexMarker680"/>to the server. We transmit to the server in the <code>options</code> parameter the new text of the modified element and its identifier in the database. The identifier and the new text will allow the item to be updated on the server:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Modifying an element, client side (global-app.js file)</p>
			<pre class="source-code">import Element from "./element.js";</pre>
			<pre class="source-code">const GlobalApp = {</pre>
			<pre class="source-code">  data() {</pre>
			<pre class="source-code">    return {</pre>
			<pre class="source-code">      elements : []  // array of object { text, _id } </pre>
			<pre class="source-code">                     // (_id = document id in MongoDB) </pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  components : {</pre>
			<pre class="source-code">    Element:Element</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  template : `</pre>
			<pre class="source-code">    &lt;button @click="add()"&gt;Add Element&lt;/button&gt;</pre>
			<pre class="source-code">    &lt;ul&gt;</pre>
			<pre class="source-code">      &lt;Element v-for="(element, index) in elements" </pre>
			<pre class="source-code">      :key="index" :element="element"</pre>
			<pre class="source-code">        @remove="remove($event)" @modify="modify($event)"</pre>
			<pre class="source-code">      /&gt;</pre>
			<pre class="source-code">    &lt;/ul&gt;</pre>
			<pre class="source-code">  `,</pre>
			<pre class="source-code">  methods : {</pre>
			<pre class="source-code">    add() {</pre>
			<pre class="source-code">      var text = "Element " + (this.elements.length + 1);</pre>
			<pre class="source-code">      axios.post("/list", {text:text})</pre>
			<pre class="source-code">      .then((response) =&gt; {</pre>
			<pre class="source-code">        console.log(this.elements);</pre>
			<pre class="source-code">        this.elements.push({text:text, </pre>
			<pre class="source-code">        _id:response.data.id});</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    remove(params) {</pre>
			<pre class="source-code">      var id = params.id;</pre>
			<pre class="source-code">      // remove the element with this id from the elements </pre>
			<pre class="source-code">      // array</pre>
			<pre class="source-code">      this.elements = this.elements.filter(</pre>
			<pre class="source-code">      function(element) {</pre>
			<pre class="source-code">        if (element._id == id) return false;</pre>
			<pre class="source-code">        else return true;</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    modify(params) {</pre>
			<pre class="source-code">      var id = params.id;</pre>
			<pre class="source-code">      var value = params.value;</pre>
			<pre class="source-code">      // modify the text of the element with this id in the </pre>
			<pre class="source-code">      // elements array</pre>
			<pre class="source-code">      this.elements = this.elements.map(function(element) {</pre>
			<pre class="source-code">        if (element._id == id) {</pre>
			<pre class="source-code">          element.text = value;</pre>
			<pre class="source-code">          return element;</pre>
			<pre class="source-code">        }</pre>
			<pre class="source-code">        else return element;</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code"><strong class="bold">      // modify the text of the element having this </strong></pre>
			<pre class="source-code">      <strong class="bold">// identifier</strong></pre>
			<pre class="source-code">      <strong class="bold">axios.put("/list", {text:value, id:id});   </strong>    </pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  created() {</pre>
			<pre class="source-code">    axios.get("/list")</pre>
			<pre class="source-code">    .then((response) =&gt; {</pre>
			<pre class="source-code">      this.elements = response.data.elements.map(</pre>
			<pre class="source-code">      function(element) {</pre>
			<pre class="source-code">        return {_id : element._id, text : element.text }</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">    });</pre>
			<pre class="source-code">  }</pre>
			<pre class="source-code">}</pre>
			<pre class="source-code">export default GlobalApp;</pre>
			<p>The <code>then(callback)</code> method should not be used here because the server does not return <a id="_idIndexMarker681"/>any information for the browser.</p>
			<p>Let’s now see the management of the <code>PUT</code> request on the server side.</p>
			<h2 id="_idParaDest-183"><a id="_idTextAnchor182"/>PUT type request processing (server side)</h2>
			<p>The server processes the <code>PUT</code> <code>/list</code> request in the <code>app.js</code> file. The processing consists <a id="_idIndexMarker682"/>of carrying out an update of the document of the collection having this identifier, with the text received from the browser:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Modifying an element, server side (app.js file)</p>
			<pre class="source-code">var createError = require('http-errors');</pre>
			<pre class="source-code">var express = require('express');</pre>
			<pre class="source-code">var path = require('path');</pre>
			<pre class="source-code">var cookieParser = require('cookie-parser');</pre>
			<pre class="source-code">var logger = require('morgan');</pre>
			<pre class="source-code">var indexRouter = require('./routes/index');</pre>
			<pre class="source-code">var usersRouter = require('./routes/users');</pre>
			<pre class="source-code">var mongoose = require("mongoose");</pre>
			<pre class="source-code">mongoose.connect("mongodb://localhost/mydb_test");</pre>
			<pre class="source-code">var listSchema = mongoose.Schema({</pre>
			<pre class="source-code"> text : String</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">var List = mongoose.model("elements", listSchema);</pre>
			<pre class="source-code">var app = express();</pre>
			<pre class="source-code">// view engine setup</pre>
			<pre class="source-code">app.set('views', path.join(__dirname, 'views'));</pre>
			<pre class="source-code">app.set('view engine', 'jade');</pre>
			<pre class="source-code">app.use(logger('dev'));</pre>
			<pre class="source-code">app.use(express.json());</pre>
			<pre class="source-code">app.use(express.urlencoded({ extended: false }));</pre>
			<pre class="source-code">app.use(cookieParser());</pre>
			<pre class="source-code">app.use(express.static(path.join(__dirname, 'public')));</pre>
			<pre class="source-code">app.use('/', indexRouter);</pre>
			<pre class="source-code">app.use('/users', usersRouter);</pre>
			<pre class="source-code">// creating a new element in the list</pre>
			<pre class="source-code">app.post("/list", function(req, res) {</pre>
			<pre class="source-code">  var text = req.body.text;</pre>
			<pre class="source-code">  console.log(text);</pre>
			<pre class="source-code">  List.create({text:text}, function(err, doc) {</pre>
			<pre class="source-code">    res.json({id:doc._id});</pre>
			<pre class="source-code">  });</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">// retrieving list of elements</pre>
			<pre class="source-code">app.get("/list", function(req, res) {</pre>
			<pre class="source-code">  List.find(function(err, elements) {</pre>
			<pre class="source-code">    res.json({elements:elements});</pre>
			<pre class="source-code">  });</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code"><strong class="bold">// modifying an element in the list</strong></pre>
			<pre class="source-code"><strong class="bold">app.put("/list", function(req, res) {</strong></pre>
			<pre class="source-code"><strong class="bold">  var id = req.body.id;</strong></pre>
			<pre class="source-code"><strong class="bold">  var text = req.body.text;</strong></pre>
			<pre class="source-code"><strong class="bold">  List.updateOne({_id:id}, {text:text}).exec();</strong></pre>
			<pre class="source-code"><strong class="bold">  // don't forget exec()!</strong></pre>
			<pre class="source-code"><strong class="bold">  res.send();  // close the connection to the browser</strong></pre>
			<pre class="source-code"><strong class="bold">});</strong></pre>
			<pre class="source-code">// catch 404 and forward to error handler</pre>
			<pre class="source-code">app.use(function(req, res, next) {</pre>
			<pre class="source-code">  next(createError(404));</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">// error handler</pre>
			<pre class="source-code">app.use(function(err, req, res, next) {</pre>
			<pre class="source-code">  // set locals, only providing error in development</pre>
			<pre class="source-code">  res.locals.message = err.message;</pre>
			<pre class="source-code">  res.locals.error = req.app.get('env') === 'development' ? </pre>
			<pre class="source-code">  err : {};</pre>
			<pre class="source-code">  // render the error page</pre>
			<pre class="source-code">  res.status(err.status || 500);</pre>
			<pre class="source-code">  res.render('error');</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">module.exports = app;</pre>
			<p>The text <a id="_idIndexMarker683"/>and the identifier are retrieved from the server in the <code>req.body.text</code> and <code>req.body.id</code> variables. The document with this identifier is updated in the database with the new text. The <code>List.updateOne()</code> class method allows this document to be modified, but since it does not use a callback function afterward, the <code>exec()</code> method must be used afterward for the update to be carried out in the database.</p>
			<p>Also notice the <code>res.send()</code> instruction at the end of the processing. It closes the connection between the browser and the server. If the connection is not closed, the browser waits for the server’s response, which would never come if the server sends nothing back to the browser.</p>
			<p>Let’s finish by explaining how to remove an item from the list.</p>
			<h1 id="_idParaDest-184"><a id="_idTextAnchor183"/>Removing an element from the list</h1>
			<p>Finally, we will <a id="_idIndexMarker684"/>learn how to remove an element from the list. A <code>DELETE</code> type request will be used for this.</p>
			<h2 id="_idParaDest-185"><a id="_idTextAnchor184"/>Using Axios with a DELETE type request (client side)</h2>
			<p>The <code>axios.delete("/list", options)</code> method is used to trigger a <code>DELETE</code> type <a id="_idIndexMarker685"/>request on the server. The <code>options</code> parameter must indicate the identifier of the element to be deleted from the collection.</p>
			<p>However, unlike the previous <code>axios.get()</code>, <code>axios.put()</code>, and <code>axios.post()</code> calls, the <code>axios.delete("/list", options)</code> call requires that the <code>options</code> parameter be written in the <code>data</code> property (thus written as <code>{ data : options }</code>). If you don’t follow this convention, it won’t work.</p>
			<p>Here are the instructions for performing a <code>DELETE</code> request with the Axios library:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Deleting an element, client side (global-app.js file)</p>
			<pre class="source-code">import Element from "./element.js";</pre>
			<pre class="source-code">const GlobalApp = {</pre>
			<pre class="source-code">  data() {</pre>
			<pre class="source-code">    return {</pre>
			<pre class="source-code">      elements : []  // array of object { text, _id } </pre>
			<pre class="source-code">                     // (_id = document id in MongoDB)</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  components : {</pre>
			<pre class="source-code">    Element:Element</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  template : `</pre>
			<pre class="source-code">    &lt;button @click="add()"&gt;Add Element&lt;/button&gt;</pre>
			<pre class="source-code">    &lt;ul&gt;</pre>
			<pre class="source-code">      &lt;Element v-for="(element, index) in elements" </pre>
			<pre class="source-code">      :key="index" :element="element"</pre>
			<pre class="source-code">        @remove="remove($event)" @modify="modify($event)"</pre>
			<pre class="source-code">      /&gt;</pre>
			<pre class="source-code">    &lt;/ul&gt;</pre>
			<pre class="source-code">  `,</pre>
			<pre class="source-code">  methods : {</pre>
			<pre class="source-code">    add() {</pre>
			<pre class="source-code">      var text = "Element " + (this.elements.length + 1);</pre>
			<pre class="source-code">      axios.post("/list", {text:text})</pre>
			<pre class="source-code">      .then((response) =&gt; {</pre>
			<pre class="source-code">        console.log(this.elements);</pre>
			<pre class="source-code">        this.elements.push({text:text, </pre>
			<pre class="source-code">        _id:response.data.id});</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    remove(params) {</pre>
			<pre class="source-code">      var id = params.id;</pre>
			<pre class="source-code">      // remove the element with this id from the elements </pre>
			<pre class="source-code">      // array</pre>
			<pre class="source-code">      this.elements = this.elements.filter(</pre>
			<pre class="source-code">      function(element) {</pre>
			<pre class="source-code">        if (element._id == id) return false;</pre>
			<pre class="source-code">        else return true;</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">      <strong class="bold">axios.delete("/list", { data : {id:id} });    </strong></pre>
			<pre class="source-code"><strong class="bold">            // the options must be written in the data </strong></pre>
			<pre class="source-code">            <strong class="bold">// property</strong></pre>
			<pre class="source-code">    },</pre>
			<pre class="source-code">    modify(params) {</pre>
			<pre class="source-code">      var id = params.id;</pre>
			<pre class="source-code">      var value = params.value;</pre>
			<pre class="source-code">      // modify the text of the element with this id in the </pre>
			<pre class="source-code">      // elements array</pre>
			<pre class="source-code">      this.elements = this.elements.map(function(element) {</pre>
			<pre class="source-code">        if (element._id == id) {</pre>
			<pre class="source-code">          element.text = value;</pre>
			<pre class="source-code">          return element;</pre>
			<pre class="source-code">        }</pre>
			<pre class="source-code">        else return element;</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">      axios.put("/list", {text:value, id:id});   </pre>
			<pre class="source-code">            // modify the text of the element having this </pre>
			<pre class="source-code">            // identifier</pre>
			<pre class="source-code">    }</pre>
			<pre class="source-code">  },</pre>
			<pre class="source-code">  created() {</pre>
			<pre class="source-code">    axios.get("/list")</pre>
			<pre class="source-code">    .then((response) =&gt; {</pre>
			<pre class="source-code">      this.elements = response.data.elements.map(</pre>
			<pre class="source-code">      function(element) {</pre>
			<pre class="source-code">        return {_id : element._id, text : element.text }</pre>
			<pre class="source-code">      });</pre>
			<pre class="source-code">    });</pre>
			<pre class="source-code">  }</pre>
			<pre class="source-code">}</pre>
			<pre class="source-code">export default GlobalApp;</pre>
			<p>As mentioned before, we use the <code>options</code> parameter of the <code>axios.delete(/list", options)</code> method in the form <code>{ data : options }</code> so that <a id="_idIndexMarker686"/>the options are correctly passed by the <code>DELETE</code> method.</p>
			<p>Let’s now examine the processing performed by the server when receiving the <code>DELETE</code> request.</p>
			<h2 id="_idParaDest-186"><a id="_idTextAnchor185"/>DELETE type request processing (server side)</h2>
			<p>The server <a id="_idIndexMarker687"/>receives the <code>DELETE</code> <code>/list</code> request using the <code>app.delete("/list, callback)</code> method. The callback function uses the identifier passed in the request to delete the corresponding document from the <code>elements</code> collection:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Deleting an element, server side (app.js file)</p>
			<pre class="source-code">var createError = require('http-errors');</pre>
			<pre class="source-code">var express = require('express');</pre>
			<pre class="source-code">var path = require('path');</pre>
			<pre class="source-code">var cookieParser = require('cookie-parser');</pre>
			<pre class="source-code">var logger = require('morgan');</pre>
			<pre class="source-code">var indexRouter = require('./routes/index');</pre>
			<pre class="source-code">var usersRouter = require('./routes/users');</pre>
			<pre class="source-code">var mongoose = require("mongoose");</pre>
			<pre class="source-code">mongoose.connect("mongodb://localhost/mydb_test");</pre>
			<pre class="source-code">var listSchema = mongoose.Schema({</pre>
			<pre class="source-code"> text : String</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">var List = mongoose.model("elements", listSchema);</pre>
			<pre class="source-code">var app = express();</pre>
			<pre class="source-code">// view engine setup</pre>
			<pre class="source-code">app.set('views', path.join(__dirname, 'views'));</pre>
			<pre class="source-code">app.set('view engine', 'jade');</pre>
			<pre class="source-code">app.use(logger('dev'));</pre>
			<pre class="source-code">app.use(express.json());</pre>
			<pre class="source-code">app.use(express.urlencoded({ extended: false }));</pre>
			<pre class="source-code">app.use(cookieParser());</pre>
			<pre class="source-code">app.use(express.static(path.join(__dirname, 'public')));</pre>
			<pre class="source-code">app.use('/', indexRouter);</pre>
			<pre class="source-code">app.use('/users', usersRouter);</pre>
			<pre class="source-code">// creating a new element in the list</pre>
			<pre class="source-code">app.post("/list", function(req, res) {</pre>
			<pre class="source-code">  var text = req.body.text;</pre>
			<pre class="source-code">  console.log(text);</pre>
			<pre class="source-code">  List.create({text:text}, function(err, doc) {</pre>
			<pre class="source-code">    res.json({id:doc._id});</pre>
			<pre class="source-code">  });</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">// retrieving list of elements</pre>
			<pre class="source-code">app.get("/list", function(req, res) {</pre>
			<pre class="source-code">  List.find(function(err, elements) {</pre>
			<pre class="source-code">    res.json({elements:elements});</pre>
			<pre class="source-code">  });</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">// modifying an element in the list</pre>
			<pre class="source-code">app.put("/list", function(req, res) {</pre>
			<pre class="source-code">  var id = req.body.id;</pre>
			<pre class="source-code">  var text = req.body.text;</pre>
			<pre class="source-code">  List.updateOne({_id:id}, {text:text}).exec();</pre>
			<pre class="source-code"><strong class="bold">  </strong>res.send();  // close the connection to the browser</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code"><strong class="bold">// remove an element from the list</strong></pre>
			<pre class="source-code"><strong class="bold">app.delete("/list", function(req, res) {</strong></pre>
			<pre class="source-code"><strong class="bold">  var id = req.body.id;</strong></pre>
			<pre class="source-code"><strong class="bold">  console.log(req.body.id);</strong></pre>
			<pre class="source-code"><strong class="bold">  List.deleteOne({_id:id}).exec();   // don't forget exec()!</strong></pre>
			<pre class="source-code"><strong class="bold">  res.send();  // close the connection to the browser</strong></pre>
			<pre class="source-code"><strong class="bold">});</strong></pre>
			<pre class="source-code">// catch 404 and forward to error handler</pre>
			<pre class="source-code">app.use(function(req, res, next) {</pre>
			<pre class="source-code">  next(createError(404));</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">// error handler</pre>
			<pre class="source-code">app.use(function(err, req, res, next) {</pre>
			<pre class="source-code">  // set locals, only providing error in development</pre>
			<pre class="source-code">  res.locals.message = err.message;</pre>
			<pre class="source-code">  res.locals.error = req.app.get('env') === 'development' ? </pre>
			<pre class="source-code">  err : {};</pre>
			<pre class="source-code">  // render the error page</pre>
			<pre class="source-code">  res.status(err.status || 500);</pre>
			<pre class="source-code">  res.render('error');</pre>
			<pre class="source-code">});</pre>
			<pre class="source-code">module.exports = app;</pre>
			<p>The <code>List.deleteOne({_id:id})</code> method is used to delete the document having this identifier in the collection. As we do not use a callback function in the <code>List.deleteOne()</code> method, we call the <code>exec()</code> method so that the deletion is performed in the database.</p>
			<p>Also, notice the <code>res.send()</code> instruction at the end of the processing. It closes the connection between the browser and the server. If the connection is not closed, the browser <a id="_idIndexMarker688"/>waits for the server’s response, which would never come if the server sends nothing back to the browser. In this case, you would see unexpected results by clicking several times on the <strong class="bold">Delete</strong> buttons in the list and reloading the list.</p>
			<p>We have seen how to use MongoDB to insert, modify, and delete elements in a list, using a library such as Axios, allowing communication between the JavaScript code of the browser and the JavaScript code written for the server. And now, this brings us to the end of this chapter and the book. </p>
			<h1 id="_idParaDest-187"><a id="_idTextAnchor186"/>Summary</h1>
			<p>Through this complete example, we have seen how to use JavaScript on both the client side (here, with Vue.js) and the server side (with Node.js and MongoDB).</p>
			<p>The use of a single language to carry out all development simplifies learning and ensures great consistency throughout the application.</p>
			<p>In addition, tools such as Vue.js, allowing the creation of reusable components, and modules such as Express and mongoose based on the MVC model, make it possible to properly architect JavaScript code, both on the client side and on the server side.</p>
			<p>We also saw how the Axios library made it possible to communicate between the client and the server.</p>
			<p>You now have everything you need to create reliable, robust, and well-structured client and server applications entirely in JavaScript.</p>
			<h1 id="_idParaDest-188"><a id="_idTextAnchor187"/>Thanks</h1>
			<p>Thank you, dear reader, for purchasing and reading this book. It was written for the sole purpose of helping and guiding you. We hope it has been of great help to you. </p>
			<p>If so, we ask you for a very small but extremely important contribution – to make our book knownto others by means at your disposal, in the hope that it can keep helping people like you. Thanks very much!</p>
		</div>
	</body></html>