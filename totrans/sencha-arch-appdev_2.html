<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;Creating an Ext JS App"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Creating an Ext JS App</h1></div></div></div><p>In this chapter, we will take our first steps with Sencha Architect by implementing a sample application with <a id="id68" class="indexterm"/>Ext JS, always highlighting the Sencha Architect features. We will cover:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating an Ext JS project</li><li class="listitem" style="list-style-type: disc">Creating models, stores, views, and controllers</li><li class="listitem" style="list-style-type: disc">Executing the project for the first time</li></ul></div><div class="section" title="Implementing the Ext JS app"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec12"/>Implementing the Ext JS app</h1></div></div></div><p>Before we start<a id="id69" class="indexterm"/> implementing our Ext JS application, let's take a look at what we will have at the end of the chapter:</p><div class="mediaobject"><img src="graphics/9819OS_02_01.jpg" alt="Implementing the Ext JS app"/></div><p>It is a simple grid that lists books, which we will retrieve from a database.</p></div></div>
<div class="section" title="Creating the project"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec13"/>Creating the project</h1></div></div></div><p>First, to create a new <a id="id70" class="indexterm"/>Ext JS project, refer to the following screenshot:</p><div class="mediaobject"><img src="graphics/9819OS_02_02.jpg" alt="Creating the project"/></div><p>Right after the project is created, we will see the landing screen with the toolbar, canvas, project inspector, <a id="id71" class="indexterm"/>config panel, and toolbox. We will save our project right away. To do so, click on <span class="strong"><strong>Save</strong></span> on the toolbox or press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>S</em></span> (<span class="emphasis"><em>cmd</em></span> + <span class="emphasis"><em>S</em></span> on Mac OS). The <span class="strong"><strong>Save Project</strong></span> screen<a id="id72" class="indexterm"/> will be displayed:</p><div class="mediaobject"><img src="graphics/9819OS_02_03.jpg" alt="Creating the project"/></div><p>We will save the project as <code class="literal">extBooks</code> inside the <code class="literal">sencha-architect</code> directory.</p><p>Now that the project is saved, we can start implementing it. We will follow the following development workflow: we will implement first the model then the store, view, and controller, and then repeat until our project is finished.</p><div class="section" title="A quick word about MVC"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec14"/>A quick word about MVC</h2></div></div></div><p>
<span class="strong"><strong>Model-View-Controller</strong></span> (<span class="strong"><strong>MVC</strong></span>) is a software architecture pattern, which separates the<a id="id73" class="indexterm"/> representation of the information from the user's interaction with it. The model represents the application data, the view represents <a id="id74" class="indexterm"/>the output of the representation of the data (a form, grid, chart), and the controller mediates the input, converting it to commands for the model or view.</p><p>Ext JS and Sencha Touch use a <span class="strong"><strong>Model-View-Controller-Store</strong></span> (<span class="strong"><strong>MVCS</strong></span>) pattern. The model is a representation of the data we want to manipulate in our<a id="id75" class="indexterm"/> application (a representation of a table from the database). The view contains all the components and screens we create to manage the information of a model. As Ext JS is event driven, all the views fire events when the user interacts with them, and the controller will capture these events and will do something, redirecting the command to the model (or store) or the view. The store in Ext JS is very similar to the <a id="id76" class="indexterm"/>
<span class="strong"><strong>Data Access Object</strong></span> (<span class="strong"><strong>DAO</strong></span>) pattern used on the server side.</p><p>For a quick example, let's say we have <span class="strong"><strong>WidgetA</strong></span>, which is a grid panel that displays all the records from<a id="id77" class="indexterm"/> the table A. <span class="strong"><strong>ModelA</strong></span> represents this table. The <span class="strong"><strong>StoreA</strong></span> table is responsible for retrieving the information (collection of <span class="strong"><strong>ModelA</strong></span> from the server). When the user clicks on a record from <span class="strong"><strong>WidgetA</strong></span>, a window will be opened (called <span class="strong"><strong>WidgetB</strong></span>) that displays information from the table B (represented by <span class="strong"><strong>ModelB</strong></span>). And of course, the <span class="strong"><strong>StoreB</strong></span> will be responsible for retrieving the collection of <span class="strong"><strong>ModelB</strong></span> from server. In this case, we will have <span class="strong"><strong>ControllerA</strong></span> to capture the click event from <span class="strong"><strong>WidgetA</strong></span> and do all the required logic to display <span class="strong"><strong>WidgetB</strong></span> and load all the <span class="strong"><strong>ModelB</strong></span> information. If we try to put this in a quick reference diagram, it would look something like the following screenshot:</p><div class="mediaobject"><img src="graphics/9819OS_02_28.jpg" alt="A quick word about MVC"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>For more information about MVC and Sencha applications, go to <a class="ulink" href="http://docs.sencha.com/extjs/4.2.1/#!/guide/application_architecture">http://docs.sencha.com/extjs/4.2.1/#!/guide/application_architecture</a>.</p></div></div></div></div>
<div class="section" title="Configuring the app"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Configuring the app</h1></div></div></div><p>The first step is to set up the application we are going to develop throughout this chapter. Before we start, on the project inspector, select the <span class="strong"><strong>Application</strong></span> option<a id="id78" class="indexterm"/> (<span class="emphasis"><em>Step 1 in the following screenshot</em></span>) and then go to the config panel; locate the <span class="strong"><strong>name</strong></span> property and set its value to <code class="literal">Packt</code> (<span class="emphasis"><em>Step 2</em></span>). This is the namespace of our <a id="id79" class="indexterm"/>application, meaning that all the classes will be named <code class="literal">Packt.</code> <code class="literal">+</code> <code class="literal">package</code> <code class="literal">+</code> <code class="literal">className</code>. Many programming languages use namespacing to avoid collisions with other objects or variables in the global namespace. If we open the code editor, the code we will see is the same as on <span class="emphasis"><em>Step 3</em></span>:</p><div class="mediaobject"><img src="graphics/9819OS_02_04.jpg" alt="Configuring the app"/></div><p>All these configurations will be applied on the <code class="literal">app.js</code> file, since the <span class="strong"><strong>Application</strong></span> option represents the <code class="literal">app.js</code> file.</p></div>
<div class="section" title="Creating the model"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Creating the model</h1></div></div></div><p>Following our development <a id="id80" class="indexterm"/>workflow, we will start with the model. On the top of the project inspector, click on the <span class="strong"><strong>+</strong></span> icon and select <span class="strong"><strong>Model</strong></span> (<span class="emphasis"><em>Step 1</em></span>):</p><div class="mediaobject"><img src="graphics/9819OS_02_05.jpg" alt="Creating the model"/></div><p>Once the model is created, select it, go to the config panel, and set the class name (<span class="strong"><strong>userClassName</strong></span>) to <span class="strong"><strong>Book</strong></span> (<span class="emphasis"><em>Step 2</em></span>). Then, still on the config panel, locate the <span class="strong"><strong>Fields</strong></span> option, click on its <span class="strong"><strong>+</strong></span> icon, and add the first field, which we will name <code class="literal">id</code>. Continue adding the<a id="id81" class="indexterm"/> following fields: <span class="strong"><strong>id</strong></span>, <span class="strong"><strong>name</strong></span>, <span class="strong"><strong>author</strong></span>, <span class="strong"><strong>language</strong></span>, <span class="strong"><strong>paperback</strong></span>, <span class="strong"><strong>releaseDate</strong></span>, <span class="strong"><strong>isbn</strong></span>,and <span class="strong"><strong>isbn13</strong></span>, as shown in the following screenshot (<span class="emphasis"><em>Step 4</em></span>):</p><div class="mediaobject"><img src="graphics/9819OS_02_06.jpg" alt="Creating the model"/></div><p>If we go back to the project inspector, the book model should look like <span class="emphasis"><em>Step 5</em></span>. If we look at the canvas, nothing will be displayed on the design mode, but if we take a look at the code editor, the <code class="literal">Packt.model.Book</code> class<a id="id82" class="indexterm"/> will be defined. If we try to edit its code, it will not be possible, because we have a simple model with no functions or methods inside it (created by ourselves).</p><p>Once we save the project and take a look at the files that Sencha Architect has created so far, we will see that it created a file named <code class="literal">Book.js</code> inside the <code class="literal">app/model</code> directory.</p></div>
<div class="section" title="Creating the store"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Creating the store</h1></div></div></div><p>The next step is to create a store. Our data is going to come from the server (Java, Ruby, PHP, .NET, and so on), <a id="id83" class="indexterm"/>and we will use Ajax to load it. So, we need to create a store that will use an Ajax Proxy to read information that is coming from the server in a <span class="strong"><strong>JavaScript Object Notation</strong></span> (<span class="strong"><strong>JSON</strong></span>) format. So, we need to<a id="id84" class="indexterm"/> go back to the project inspector, click on the <span class="strong"><strong>+</strong></span> icon again, and select <span class="strong"><strong>Store</strong></span> and <span class="strong"><strong>Json Store</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/9819OS_02_07.jpg" alt="Creating the store"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>For more information about Ajax Proxy and Json Store, go to <a class="ulink" href="http://docs.sencha.com/extjs/4.2.1/#!/api/Ext.data.proxy.Ajax">http://docs.sencha.com/extjs/4.2.1/#!/api/Ext.data.proxy.Ajax</a>.</p></div></div><p>Right after we create the store, we will see a red exclamation mark icon (<span class="emphasis"><em>Step 1</em></span>). If we click on it (<span class="emphasis"><em>Step 1</em></span>), we will see an error message saying that we need to associate a model to this store or create<a id="id85" class="indexterm"/> at least one field on the store (<span class="emphasis"><em>Step 2</em></span>). As we already have a model, click on the store (<span class="strong"><strong>MyJsonStore</strong></span>) on the project inspector, go to the config panel, search for <code class="literal">model</code>, and then you can choose from the list the <span class="strong"><strong>Book</strong></span> model (which is already created) (<span class="emphasis"><em>Step 3</em></span>). In this case, we have only created the <span class="strong"><strong>Book</strong></span> model:</p><div class="mediaobject"><img src="graphics/9819OS_02_08.jpg" alt="Creating the store"/></div><p>Next, we need to give a name to our store. We will call it <code class="literal">Books</code> (following the Sencha MVC convention, the store name should be the plural of the model name). Sencha Architect also automatically creates the <span class="strong"><strong>storeId</strong></span> field for the store. Let's also change it to <span class="strong"><strong>books</strong></span> (as we can see<a id="id86" class="indexterm"/> in the following screenshot). Also, search for the <code class="literal">pageSize</code> property and set it to <code class="literal">5</code> (we will use a paging toolbar later):</p><div class="mediaobject"><img src="graphics/9819OS_02_09.jpg" alt="Creating the store"/></div><p>Then next step is to select the proxy (<span class="strong"><strong>MyAjaxProxy</strong></span>) under the <span class="strong"><strong>Books</strong></span> store in the project inspector and locate the <span class="strong"><strong>url</strong></span> configuration and set its value to <code class="literal">http://localhost/sencha-architect/extBooks/php/list.php</code>. We are going to create the server code for this example inside the <code class="literal">php</code> folder. You can get the server-side code within the source code distributed with this book.</p><div class="mediaobject"><img src="graphics/9819OS_02_10.jpg" alt="Creating the store"/></div><p>And finally, we need to set some configurations for the reader. To do so, please select the <span class="strong"><strong>MyJsonReader</strong></span> store<a id="id87" class="indexterm"/>, locate the <span class="strong"><strong>root</strong></span> property, and set its value to <span class="strong"><strong>data</strong></span>:</p><div class="mediaobject"><img src="graphics/9819OS_02_11.jpg" alt="Creating the store"/></div><p>When we load the information from the server, we expect to receive a JSON object that will have a property named <span class="strong"><strong>data</strong></span>, which will wrap the collection of book objects.</p><p>The last step to test—if everything is okay—is to load the store. To do it, select the <span class="strong"><strong>Books</strong></span> store, right-click on it, and select <span class="strong"><strong>Load Data</strong></span>; then, a new window will be displayed with the data loaded from the server. If you want to see the information that was loaded, you can also click on the eye icon as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/9819OS_02_12.jpg" alt="Creating the store"/></div><p>We set the proxy URL as <code class="literal">http://localhost/sencha-architect/extBooks/php/list.php</code> (the complete path) so we can perform this test. Usually, we simply <a id="id88" class="indexterm"/>need to set the relative URL; in our case, it is <code class="literal">php/list.php</code>. The complete URL is only for testing.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note05"/>Note</h3><p>You can find the <code class="literal">list.php</code> file inside the <code class="literal">extbooks</code> project available for download at <a class="ulink" href="https://github.com/loiane/sencha-architect-app-development">https://github.com/loiane/sencha-architect-app-development</a>. Before executing the project, please execute the <code class="literal">dbscript.sql</code> file and change the user and password inside the <code class="literal">db.php</code> file to connect to your database.</p></div></div><p>A mistake most developers make is to have the server code deployed on a server and the Sencha Architect project deployed in a different location. We always need to remember that we are using an Ajax Proxy, meaning that the calls need to be made from the same URL (server) as the project is deployed. If you would like to use a different domain/server, you can use the JSONP proxy or enable <span class="strong"><strong>Cross-Origin Resource Sharing</strong></span>
<a id="id89" class="indexterm"/> (<span class="strong"><strong>CORS</strong></span>) in the server side.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note06"/>Note</h3><p>To learn more about CORS, please go to <a class="ulink" href="http://enable-cors.org/">http://enable-cors.org/</a>.</p></div></div><p>Once we save the project and take a look at the files that Sencha Architect has created so far, we will see that it <a id="id90" class="indexterm"/>created a file named <code class="literal">Books.js</code> inside the <code class="literal">app/store</code> directory.</p></div>
<div class="section" title="Creating the books grid"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec17"/>Creating the books grid</h1></div></div></div><p>In the next step, we will create our first view, which is the books grid. There are two ways of creating a view. You <a id="id91" class="indexterm"/>can choose the one you like the most. The first one requires selecting the <span class="strong"><strong>Views</strong></span> package on the project inspector, going to the toolbox, locating the <span class="strong"><strong>Grid Panel</strong></span> component, and then double-clicking on it. A new <span class="strong"><strong>Grid Panel</strong></span> view<a id="id92" class="indexterm"/> called <code class="literal">MyGridPanel</code> will be created under the <span class="strong"><strong>Views</strong></span> package:</p><div class="mediaobject"><img src="graphics/9819OS_02_13.jpg" alt="Creating the books grid"/></div><p>You can use this approach for anything. If you want to add a toolbar to the grid, select the grid from the project inspector then go to the toolbar and double-click on the component you would like to add as an item of the grid (or any other view, store, model, or controller from the project inspector).</p><p>The second way of doing it is to select the component from the toolbox and drag-and-drop it inside the <span class="strong"><strong>Views</strong></span> package (or it can be a view, store, model, or controller as well):</p><div class="mediaobject"><img src="graphics/9819OS_02_14.jpg" alt="Creating the books grid"/></div><p>Once we have the <code class="literal">MyGridPanel</code> component under the <span class="strong"><strong>Views</strong></span> package, we need to set some configurations. Select the <code class="literal">MyGridPanel</code> view, go to the config panel, uncheck the <span class="strong"><strong>initialView</strong></span> property, <a id="id93" class="indexterm"/>set <span class="strong"><strong>userAlias</strong></span> as <span class="strong"><strong>booksgrid</strong></span> (alias convention is all in lowercase),and set <span class="strong"><strong>userClassName</strong></span> as <span class="strong"><strong>BooksGrid</strong></span> (which is the name of the class) as shown by <span class="emphasis"><em>Step 1</em></span>. Then, locate the <span class="strong"><strong>store</strong></span> property and select the <span class="strong"><strong>Books</strong></span> store (<span class="emphasis"><em>Step 2</em></span>):</p><div class="mediaobject"><img src="graphics/9819OS_02_15.jpg" alt="Creating the books grid"/></div><p>Now that our class is named <span class="strong"><strong>BooksGrid</strong></span> in <span class="strong"><strong>Views</strong></span>, select it, right-click on it, and select <span class="strong"><strong>Auto columns</strong></span> (<span class="emphasis"><em>Step 3</em></span>). This<a id="id94" class="indexterm"/> will generate all the columns based on the fields of the model that is associated with the store we set for the <span class="strong"><strong>BooksGrid</strong></span> class (<span class="emphasis"><em>Step 4</em></span>). However: we can only generate the autocolumns once we have the store set on the grid.</p><p>Next, we can go to the <span class="strong"><strong>Design</strong></span> tab<a id="id95" class="indexterm"/> on the canvas and change a few things, such as the grid title, column titles, and column width. To modify the title of the grid or a column, simply double-click on it as follows (or you can do it by using the config panel):</p><div class="mediaobject"><img src="graphics/9819OS_02_16.jpg" alt="Creating the books grid"/></div><p>These features can save us some time, because we do not need to go to the config panel to configure them.</p><p>Our last step is to add a paging toolbar to the books grid. Select the <span class="strong"><strong>BooksGrid</strong></span> class<a id="id96" class="indexterm"/> on the project inspector, go to the toolbox, locate the paging toolbar, and double- click on it. The paging toolbar will be added to the <span class="strong"><strong>BooksGrid</strong></span> class (or you can drag it from the toolbox and drop it on the <span class="strong"><strong>BooksGrid</strong></span> class). As the store is already set on the grid, it will be set automatically to the paging toolbar as well.</p><p>Once we save <a id="id97" class="indexterm"/>the project and take a look at the files that Sencha Architect has created so far, we will see that it created a file named <code class="literal">BooksGrid.js</code> inside the <code class="literal">app/view</code> directory.</p></div>
<div class="section" title="Creating the viewport"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec18"/>Creating the viewport</h1></div></div></div><p>Our next step is to create a viewport. To do so, select the <span class="strong"><strong>Views</strong></span> package (<span class="emphasis"><em>Step 1</em></span>), and on the toolbox, locate the <span class="strong"><strong>Viewport</strong></span> component and double-click on it (<span class="emphasis"><em>Step 2</em></span>). Select the <span class="strong"><strong>MyViewport</strong></span> view from the <span class="strong"><strong>Views</strong></span> package on the project inspector, go to the config panel, and set some properties: mark <span class="strong"><strong>initialView</strong></span> and set <span class="strong"><strong>userClassName</strong></span> as <span class="strong"><strong>Main</strong></span> (<span class="emphasis"><em>Step 3</em></span>). Finally, go to the <a id="id98" class="indexterm"/>
<span class="strong"><strong>Design</strong></span> tab and click on the blank area. A blue border should be displayed. Select the flyout config button and select <span class="strong"><strong>fit</strong></span> as <span class="strong"><strong>Layout</strong></span> as demonstrated in the following screenshot (<span class="emphasis"><em>Step 4</em></span>):</p><div class="mediaobject"><img src="graphics/9819OS_02_17.jpg" alt="Creating the viewport"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note07"/>Note</h3><p>To learn more about viewports, please go to <a class="ulink" href="http://docs.sencha.com/extjs/4.2.1/#!/api/Ext.container">http://docs.sencha.com/extjs/4.2.1/#!/api/Ext.container</a>. To learn more about the Fit Layout, please go to <a class="ulink" href="http://docs.sencha.com/extjs/4.2.1/#!/api/Ext.layout.container.Fit">http://docs.sencha.com/extjs/4.2.1/#!/api/Ext.layout.container.Fit</a>.</p></div></div><p>We cannot forget to always have <span class="strong"><strong>initialView</strong></span> on the project. One of the <span class="strong"><strong>View</strong></span> classes must have the <a id="id99" class="indexterm"/>highlighted icon as shown in the next screenshot, otherwise we will get a blank screen when we execute the project:</p><div class="mediaobject"><img src="graphics/9819OS_02_18.jpg" alt="Creating the viewport"/></div><p>Once we save the project and take a look at the files that Sencha Architect has created so far, we will see that it created a file named <code class="literal">Main.js</code> inside the <code class="literal">app/view</code> directory.</p><div class="section" title="Linking the grid to the viewport"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec15"/>Linking the grid to the viewport</h2></div></div></div><p>Our next goal is to make<a id="id100" class="indexterm"/> the <code class="literal">booksgrid</code> class<a id="id101" class="indexterm"/> an item of the viewport we created. So, let's go ahead and make it happen. The first step is to select the <code class="literal">booksgrid</code> class, then drag-and-drop it on the <code class="literal">Main</code> class:</p><div class="mediaobject"><img src="graphics/9819OS_02_19.jpg" alt="Linking the grid to the viewport"/></div><p>A window will be displayed with a <span class="strong"><strong>Copy</strong></span> <span class="strong"><strong>Component</strong></span> question. We will choose <span class="strong"><strong>Link</strong></span>; this way, our <code class="literal">booksgrid</code> class will continue a class and we can reuse its code. If we choose <span class="strong"><strong>Copy</strong></span>, Sencha Architect will copy all the <span class="strong"><strong>BooksGrid</strong></span> code into the <code class="literal">Main</code> class as an item. And if we choose <span class="strong"><strong>Move</strong></span>, Sencha Architect will delete the <code class="literal">booksgrid</code> class and put all its code inside the <code class="literal">Main</code> class as an item.</p><p>As a result, we will see a blue line connecting the <code class="literal">booksgrid</code> class to the <code class="literal">Main</code> class. If we verify the <code class="literal">Main</code> class source code on the code editor, we will notice that the <code class="literal">booksgrid</code> class is <a id="id102" class="indexterm"/>declared as an item of the viewport by using its <span class="strong"><strong>xtype</strong></span> (the <code class="literal">userAlias</code> property on the config panel):</p><div class="mediaobject"><img src="graphics/9819OS_02_20.jpg" alt="Linking the grid to the viewport"/></div><p>Linking components is a great way of reusing components on Sencha Architect.</p></div><div class="section" title="The output so far"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec16"/>The output so far</h2></div></div></div><p>It is time to execute our <a id="id103" class="indexterm"/>project for the first time. On the toolbar, click on the <span class="strong"><strong>Preview</strong></span> icon. Your default browser will open a page like this:</p><div class="mediaobject"><img src="graphics/9819OS_02_21.jpg" alt="The output so far"/></div><p>This is because Sencha Architect thinks the <code class="literal">app.html</code> page, which is the page that contains all the code from<a id="id104" class="indexterm"/> our application (Sencha Architect creates the <code class="literal">app.html</code> file instead of <code class="literal">index.html</code>), is deployed on the <code class="literal">root</code> folder of the webserver, which is not true. In our case, the application is located at the <code class="literal">htdocs/sencha-architect/extBooks</code> directory (<code class="literal">htdocs</code> is the public folder of Xampp). So, we need to set the correct location on the project's settings. On the toolbar, click on the <a id="id105" class="indexterm"/>
<span class="strong"><strong>Settings</strong></span> icon. A new window will be displayed; click on the <span class="strong"><strong>Project</strong></span> tab and put the full path to the project's directory as shown in the following screenshot (<span class="strong"><strong>URL prefix</strong></span>):</p><div class="mediaobject"><img src="graphics/9819OS_02_22.jpg" alt="The output so far"/></div><p>Now, if we try to execute the project again, it will open the correct URL with the grid we just created:</p><div class="mediaobject"><img src="graphics/9819OS_02_23.jpg" alt="The output so far"/></div><p>But wait a second, the grid is empty, and on the test we performed with the store, the server is returning some data. We need<a id="id106" class="indexterm"/> to create a controller to load the store when the grid is rendered; this way, we will have some information displayed inside the grid.</p></div></div>
<div class="section" title="Creating the controller"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec19"/>Creating the controller</h1></div></div></div><p>So, to create the controller, let's go back to the top of the project inspector and click on the <span class="strong"><strong>+</strong></span> icon once again and select the<a id="id107" class="indexterm"/> <span class="strong"><strong>Controller</strong></span> option (<span class="emphasis"><em>Step 1</em></span>). Then, with the controller selected, go to the config panel and change its <span class="strong"><strong>userClassname</strong></span> to <span class="strong"><strong>Book</strong></span> (<span class="emphasis"><em>Step 2</em></span>):</p><div class="mediaobject"><img src="graphics/9819OS_02_24.jpg" alt="Creating the controller"/></div><p>Still on the config panel, locate the <span class="strong"><strong>models</strong></span>, <span class="strong"><strong>stores</strong></span>, and <span class="strong"><strong>views</strong></span> properties (<span class="emphasis"><em>Step 3</em></span>). With these properties, we will declare the <span class="strong"><strong>models</strong></span>, <span class="strong"><strong>stores</strong></span>, and <span class="strong"><strong>views</strong></span> that this controller will care about. Once you <a id="id108" class="indexterm"/>select a model, store, or view, Sencha Architect will display the following window with a question. Click on <span class="strong"><strong>Remove</strong></span>:</p><div class="mediaobject"><img src="graphics/9819OS_02_25.jpg" alt="Creating the controller"/></div><p>This is because on the application (<code class="literal">app.js</code>), as we create models, stores, and views, they will be declared on the <span class="strong"><strong>models</strong></span>, <span class="strong"><strong>views</strong></span>, and <span class="strong"><strong>stores</strong></span> properties of the application. With this step, we are transferring the responsibility to the controller, and there is no need to keep their declaration on the <code class="literal">app.js</code> file and also on the controller (which is what will happen if we click on the <span class="strong"><strong>Keep</strong></span> button).</p><p>The next step is to add <span class="strong"><strong>Controller</strong></span> <span class="strong"><strong>Action</strong></span> to the <span class="strong"><strong>Book</strong></span> controller. To do so, select the <span class="strong"><strong>Book</strong></span> controller on the project inspector, go to the toolbox, locate <span class="strong"><strong>Controler</strong></span> <span class="strong"><strong>Action</strong></span>, and double-click on it (or drag-and-drop, as you wish) as demonstrated by <span class="emphasis"><em>Step 1</em></span>. Once <span class="strong"><strong>Controller</strong></span> <span class="strong"><strong>Action</strong></span> is listed under the <span class="strong"><strong>Book</strong></span> controller, select it (<span class="emphasis"><em>Step 2</em></span>), go to the config panel, and choose <span class="strong"><strong>BooksGrid</strong></span> as <span class="strong"><strong>targetType</strong></span>; then on <span class="strong"><strong>EventBinding</strong></span>, select the name of the event we want to listen to, which is <span class="strong"><strong>render</strong></span>. If you would like, you can change the <span class="strong"><strong>controlQuery</strong></span> to be more specific and the name of <span class="strong"><strong>BasicFunction</strong></span> (<span class="strong"><strong>fn</strong></span>) as well (<span class="emphasis"><em>Step 3</em></span>):</p><div class="mediaobject"><img src="graphics/9819OS_02_26.jpg" alt="Creating the controller"/></div><p>After these steps, the code editor will open the <span class="strong"><strong>onGridpanelRender</strong></span> function editor, so we can add the <a id="id109" class="indexterm"/>code we desire (we need to enter the code as shown in <span class="emphasis"><em>Step 4</em></span>). In this case, the render event passes the grid reference (<span class="strong"><strong>component</strong></span>) as a parameter and also some options (<span class="strong"><strong>eOpts</strong></span>). So, we need to get the grid reference (<span class="strong"><strong>component</strong></span>), call the <code class="literal">getStore</code> method<a id="id110" class="indexterm"/> to get the store reference, and then the <code class="literal">load</code> method so the store can load the information from the server (<span class="emphasis"><em>Step 4</em></span>).</p><p>Notice that we worked on the model, store, views and in the controller. Sencha Architect has generated all the code so far for us. Only now, on a controller action, do we have to use the code editor.</p><p>Once we save the project and take a look at the files that Sencha Architect has created so far, we will see that it created a file named <code class="literal">Book.js</code> inside the <code class="literal">app/controller</code> directory.</p><p>We can click on the preview icon again on the toolbar and now we will see the final version of our project.</p></div>
<div class="section" title="The final project structure"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec20"/>The final project structure</h1></div></div></div><p>As we have now finished<a id="id111" class="indexterm"/> implementing our first Ext JS project with Sencha Architect, let's take a look at the code generated for us:</p><div class="mediaobject"><img src="graphics/9819OS_02_27.jpg" alt="The final project structure"/></div><p>Notice that Sencha Architect created all the files for us (with the exception of the server-side code <code class="literal">php</code> folder).</p><p>It is very important to bring to our attention that we cannot modify the files on a code editor. In case we do modify any files and try to open them on Sencha Architect again, all changes will be lost because Sencha Architect will override them. So, in case you decide you want to change any file on a code editor, it is important to know that you will not be able to use Sencha Architect again (and if you do, you will lose the modifications).</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec21"/>Summary</h1></div></div></div><p>In this chapter, we learned how to implement our first Ext JS project using Sencha Architect. We learned how to create a new Ext JS project and set up the <code class="literal">app.js</code> file using the application. We learned how to create models, stores, views, and controller, and how to reuse a component by linking it to another component. We have also learned how to test a store to see if the information is being loaded from the server correctly and how to configure the project settings to execute it for the first time.</p><p>In the next chapter, we will create our first Sencha Touch application with Sencha Architect.</p></div></body></html>