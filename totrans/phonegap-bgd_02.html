<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;Building Your First PhoneGap Project"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Building Your First PhoneGap Project</h1></div></div></div><p>
<span class="emphasis"><em>In <a class="link" href="ch01.html" title="Chapter 1. Introduction to PhoneGap">Chapter 1</a>, <span class="emphasis"><em>Introduction to PhoneGap</em></span>, you learned about one of the problems PhoneGap is trying to solve—developing mobile applications consistently across multiple platforms—and how to set up your build environment. Next, you will delve into the internals of PhoneGap. First, you need to know how the project is structured and how the CLI tools are used.</em></span>
</p><p>In this chapter, you will:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Take a look at the structure of a PhoneGap/Cordova application</li><li class="listitem" style="list-style-type: disc">Learn about using the command-line tools of Cordova</li><li class="listitem" style="list-style-type: disc">Know about Cordova lifecycle events</li><li class="listitem" style="list-style-type: disc">Create a sample example</li><li class="listitem" style="list-style-type: disc">Get an overview of the browser's debugging tools</li><li class="listitem" style="list-style-type: disc">Review the debug workflow with mobile in mind</li><li class="listitem" style="list-style-type: disc">Learn how to build and deploy the applications</li></ul></div><div class="section" title="The structure of a PhoneGap application"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec23"/>The structure of a PhoneGap application</h1></div></div></div><p>After <a id="id75" class="indexterm"/>creating a new project, as explained in the previous chapter, you'll see the following structure inside the project's root folder:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">www</code>: This directory <a id="id76" class="indexterm"/>contains the source files of the application and so we will be playing a lot in this directory. It contains the <code class="literal">css</code>, <code class="literal">js</code>, and <code class="literal">img</code> subdirectories, where you can place the respective files. Apart from assets such as CSS, JavaScript, and images, we will also have application-related HTML files.</li><li class="listitem" style="list-style-type: disc"><code class="literal">merges</code>: In<a id="id77" class="indexterm"/> this folder, you can add any platform-specific customization so you don't have to modify the source files every time you work with a project. For example, we can use this feature to use a different font style on Android devices only. The platforms that you want to override will have a specific folder similar to the <code class="literal">www</code> folder having its own CSS, JS, HTML, and image contents:<div class="informalexample"><pre class="programlisting">merges/
|-- ios/
| '-- app.js
|-- android/
| '-- app.js
www/
'-- app.js</pre></div><p>In the preceding directory structure, the global application has the <code class="literal">app.js</code> file and in the <code class="literal">merges</code> directory, each platform has a separate <code class="literal">app.js</code> file. During the build process, the global <code class="literal">app.js</code> file will be replaced with the platform-specific <code class="literal">app.js</code> file.</p></li><li class="listitem" style="list-style-type: disc"><code class="literal">platforms</code>: This directory<a id="id78" class="indexterm"/> will have platform-dependent build files. For each platform that we add to the project, we can see a subdirectory.</li><li class="listitem" style="list-style-type: disc"><code class="literal">plugins</code>: This is<a id="id79" class="indexterm"/> the directory where you'll find the plugins used in the project. Whenever we install new plugins, they will be added over here.</li><li class="listitem" style="list-style-type: disc"><code class="literal">hooks</code>: This <a id="id80" class="indexterm"/>directory can contain scripts that can be used to customize the Cordova/PhoneGap commands. This is really for advanced users where integrating with build systems and version control systems is required.</li><li class="listitem" style="list-style-type: disc"><code class="literal">config.xml</code>: This<a id="id81" class="indexterm"/> configuration file will have all the values specific to the application, such as application name, package name, version number, and other such configurations.</li></ul></div></div></div>
<div class="section" title="Using the PhoneGap CLI"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec24"/>Using the PhoneGap CLI</h1></div></div></div><p>You can use<a id="id82" class="indexterm"/> the Cordova command-line interface to initialize the project code, after which you can use various platforms' SDKs to develop them further. In the previous chapter, we discussed how to create a new project, add the required platforms, and build them using the CLI.</p><p>Apart from creating a project by using the CLI tool, there are several other functions carried out by the CLI of Cordova. As the steps for installing the CLI are already covered, let's move on with advanced CLI usage. Once you create a project, use <code class="literal">cd</code> to move into it and you can execute a variety of project-level commands.</p><p>The following is the list of the most used CLI commands:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">platform add &lt;platform&gt;</code>: This <a id="id83" class="indexterm"/>adds a platform as a build target for the project.</li><li class="listitem" style="list-style-type: disc"><code class="literal">platform [rm | remove] &lt;platform&gt;</code>: This<a id="id84" class="indexterm"/> removes a platform which was previously added to the project.</li><li class="listitem" style="list-style-type: disc"><code class="literal">platform [ls | list]</code>: This lists <a id="id85" class="indexterm"/>all platforms for which the project will build.</li><li class="listitem" style="list-style-type: disc"><code class="literal">platform [up | update] &lt;platform&gt;</code>: This <a id="id86" class="indexterm"/>updates the Cordova version used for the given platform.</li><li class="listitem" style="list-style-type: disc"><code class="literal">plugin [ls | list]</code>: This<a id="id87" class="indexterm"/> lists all the plugins included in the project.</li><li class="listitem" style="list-style-type: disc"><code class="literal">plugin add &lt;path-to-plugin&gt; [&lt;path-to-plugin&gt; ...]</code>: This <a id="id88" class="indexterm"/>adds one (or more) plugins to the project.</li><li class="listitem" style="list-style-type: disc"><code class="literal">plugin [rm | remove] &lt;plugin-name&gt; [&lt;plugin-name&gt; ...]</code>: This removes one (or more) plugins from the project.</li><li class="listitem" style="list-style-type: disc"><code class="literal">plugin search [&lt;keyword1&gt; &lt;keyword2&gt; ...]</code>: This <a id="id89" class="indexterm"/>searches the plugin registry for plugins matching the list of keywords.</li><li class="listitem" style="list-style-type: disc"><code class="literal">prepare [platform...]</code>: This<a id="id90" class="indexterm"/> copies files into the specified platforms, or all platforms. It is then ready for building by Eclipse, Xcode, and so on.</li><li class="listitem" style="list-style-type: disc"><code class="literal">compile [platform...]</code>: This<a id="id91" class="indexterm"/> compiles the app into a binary for each targeted platform. With no parameters, it builds for all platforms; otherwise, it builds for the specified platforms.</li><li class="listitem" style="list-style-type: disc"><code class="literal">build [&lt;platform&gt; [&lt;platform&gt; [...]]]</code>: This<a id="id92" class="indexterm"/> is an alias for <code class="literal">cordova prepare</code> followed by <code class="literal">cordova compile</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">emulate [&lt;platform&gt; [&lt;platform&gt; [...]]]</code>: This<a id="id93" class="indexterm"/> launches emulators and deploys the app to them. With no parameters, it emulates the app for all the platforms added to the project; otherwise, it emulates the app for the specified platforms.</li><li class="listitem" style="list-style-type: disc"><code class="literal">serve [port]</code>: This <a id="id94" class="indexterm"/>launches a local web server allowing you to access each platform's <code class="literal">www</code> directory on the given port (default <code class="literal">8000</code>).</li></ul></div><p>All the preceding CLI commands are to be executed inside the project directory. Some of the example usages are as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>c:\hello&gt;phonegap platform add android</strong></span>
<span class="strong"><strong>c:\hello&gt;phonegap platform add ios</strong></span>
<span class="strong"><strong>c:\hello&gt;phonegap platform remove android</strong></span>
<span class="strong"><strong>c:\hello&gt;phonegap platform list</strong></span>
</pre></div><p>The <a id="id95" class="indexterm"/>
<code class="literal">help</code> command<a id="id96" class="indexterm"/> is a global command, which displays a help page with all the available commands and the syntax to use them. This command can be executed at any command window and not necessarily within the project directory:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>c:\&gt; phonegap help</strong></span>
</pre></div></div>
<div class="section" title="Cordova events"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec25"/>Cordova events</h1></div></div></div><p>To maximize<a id="id97" class="indexterm"/> the benefits of using Cordova, you should know about all the events available. They are called <span class="strong"><strong>lifecycle events</strong></span>
<a id="id98" class="indexterm"/> because they are a part of your application throughout its lifecycle. These events are available by default for all applications and it's up to the developer to use them to implement better design. Although there are several events, we will discuss the most important and commonly used events.</p><div class="section" title="The deviceready event"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec15"/>The deviceready event</h2></div></div></div><p>The <a id="id99" class="indexterm"/>
<code class="literal">deviceready</code> event<a id="id100" class="indexterm"/> is an important event of Cordova and you can't live without it in the Cordova world. This event is triggered when Cordova has fully loaded and the application is ready to be used. We should know when the application is ready to be used and so this event comes to our rescue. This event should be the gateway to all the application's functionality:</p><div class="informalexample"><pre class="programlisting">document.addEventListener("deviceready", function() {
    // Application starts here
});</pre></div><p>To make the code easy to understand, we can define the function separately and bind it to the event, as shown here:</p><div class="informalexample"><pre class="programlisting">document.addEventListener("deviceready", onDeviceReady);

function onDeviceReady() {
        // Application starts here
}</pre></div></div><div class="section" title="The online event"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec16"/>The online event</h2></div></div></div><p>The <a id="id101" class="indexterm"/>
<code class="literal">online</code> event<a id="id102" class="indexterm"/> is triggered when the device goes online with Internet connectivity. With this event, you can determine whether your application is currently in the online state or not. If your application requires the user to be online, this can be helpful:</p><div class="informalexample"><pre class="programlisting">document.addEventListener("online", onOnline);

function onOnline() {
    console.log('device is now online');
}</pre></div></div><div class="section" title="The offline event"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec17"/>The offline event</h2></div></div></div><p>As you <a id="id103" class="indexterm"/>might <a id="id104" class="indexterm"/>have guessed, the <code class="literal">offline</code> event is the opposite of the <code class="literal">online</code> event. When the device goes offline, the application can capture it by using this event and necessary action can be taken by the developer:</p><div class="informalexample"><pre class="programlisting">document.addEventListener("offline", onOffline);

function onOffline() {
   console.log('device is now offline');
}</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note05"/>Note</h3><p>There is no accurate way of finding whether the device is currently in the <a id="id105" class="indexterm"/>
<span class="strong"><strong>online</strong></span> or <a id="id106" class="indexterm"/>
<span class="strong"><strong>offline</strong></span> state. These events work on the connection state and it can sometimes be wrong. Note that even though the device is connected to 2G, 3G, or Wi-Fi, it doesn't mean the device is online.</p></div></div></div><div class="section" title="The pause event"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec18"/>The pause event</h2></div></div></div><p>The <a id="id107" class="indexterm"/>
<code class="literal">pause</code> event<a id="id108" class="indexterm"/> is triggered when the application is moved to the background, which is typically when the user switches to another application. You can use this event to notify users that they are being taken away from the application:</p><div class="informalexample"><pre class="programlisting">document.addEventListener("pause", onPause);</pre></div></div><div class="section" title="The resume event"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec19"/>The resume event</h2></div></div></div><p>When the<a id="id109" class="indexterm"/> application<a id="id110" class="indexterm"/> is again brought to the foreground, the <code class="literal">resume</code> event is triggered. This usually happens after the <code class="literal">pause</code> event as the app should be in the background before coming to the foreground of the mobile platform:</p><div class="informalexample"><pre class="programlisting">document.addEventListener("resume", onResume);</pre></div></div><div class="section" title="The backbutton event"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec20"/>The backbutton event</h2></div></div></div><p>The <a id="id111" class="indexterm"/>
<code class="literal">backbutton</code> event<a id="id112" class="indexterm"/> is fired when the user presses the Back button on the mobile device. You can use this event to override the default actions that happen when the Back button is pressed:</p><div class="informalexample"><pre class="programlisting">document.addEventListener("backbutton", onBackbutton);</pre></div><p>There are several other events that are supported by external plugins. There is an exhaustive list of such plugins, which can be used by adding the appropriate plugins to the project.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note06"/>Note</h3><p>Not all events are supported on all platforms. For example, the <code class="literal">backbutton</code> event is not supported on iOS devices. For<a id="id113" class="indexterm"/> the full list of supported platforms for each event, refer to the documentation at <a class="ulink" href="http://cordova.apache.org/docs/en/edge/cordova_events_events.md.html#Events">http://cordova.apache.org/docs/en/edge/cordova_events_events.md.html#Events</a>.</p></div></div></div></div>
<div class="section" title="Time for action &#x2013; the Hello World example"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec26"/>Time for action – the Hello World example</h1></div></div></div><p>PhoneGap<a id="id114" class="indexterm"/> is an intermediary layer that talks to the mobile device and the application; the app resides inside a browser, and, using the PhoneGap API, you can connect to phone features such as contacts and camera.</p><p>The UI layer of a PhoneGap application is a web browser view that takes up 100 percent of the device's width and height; think of the UI layer as a browser. The UI layer is known as <span class="strong"><strong>WebView</strong></span>. The WebView <a id="id115" class="indexterm"/>used by PhoneGap is the same one used by the native operating system.</p><p>Having discussed the basics of PhoneGap and the command-line tools, we will now create a simple application. This is not the typical Hello World example. With the already learned commands and configured environment with npm, let's create a new project:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>C:\&gt; phonegap create example1</strong></span>
<span class="strong"><strong>C:\&gt; cd example1</strong></span>
<span class="strong"><strong>C:\example&gt; phonegap platform add android</strong></span>
</pre></div><p>With the completion of the preceding commands, we created a new project called <code class="literal">example1</code> and added Android platform support to the project. The directory structure is now this:</p><div class="informalexample"><pre class="programlisting">example1
├── config.xml
├── hooks
├── merges
├── platforms
├── plugins
   └── android
├── www
   └── css
   └── img
   └── js
   └── index.html</pre></div><p>By default, the<a id="id116" class="indexterm"/> Cordova <code class="literal">create</code> script generates a skeletal web-based application whose home page is the project's <code class="literal">www/index.html</code> file. Edit this application however you want, but any initialization should be specified as part of the <code class="literal">deviceready</code> event handler, referenced by default from <code class="literal">www/js/index.js</code>.</p><p>When you open the <code class="literal">index.html</code> file present in the <code class="literal">www</code> directory, you will see HTML code. The <code class="literal">body</code> section will be similar to the code presented here. This is the default body content generated by the CLI tool for the project. It just shows a page with an image and some text:</p><div class="informalexample"><pre class="programlisting">&lt;body&gt;
    &lt;div class="app"&gt;
        &lt;h1&gt;Apache Cordova&lt;/h1&gt;
        &lt;div id="deviceready" class="blink"&gt;
            &lt;p class="event listening"&gt;Connecting to Device&lt;/p&gt;
            &lt;p class="event received"&gt;Device is Ready&lt;/p&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;script type="text/javascript" src="cordova.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript" src="js/index.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript"&gt;
        app.initialize();
    &lt;/script&gt;
&lt;/body&gt;</pre></div><p>The output would be the following:</p><div class="mediaobject"><img src="graphics/B03476_02_09.jpg" alt="Time for action – the Hello World example"/></div><p>For a complex <a id="id117" class="indexterm"/>application, the page would not be this simple. To start with, let's modify the page to add some text. The modified code is shown here, which is a simple static HTML content:</p><div class="informalexample"><pre class="programlisting">&lt;body&gt;
    &lt;h1&gt;First Project&lt;/h1&gt;
    &lt;h3&gt;What we have learnt?&lt;/h3&gt;
    &lt;ul&gt;
      &lt;li&gt;PhoneGap Structure&lt;/li&gt;
      &lt;li&gt;CLI Commands&lt;/li&gt;
      &lt;li&gt;Developer Tools&lt;/li&gt;
      &lt;li&gt;Debugging in Browsers&lt;/li&gt;
      &lt;li&gt;Cordova Events&lt;/li&gt;
    &lt;/ul&gt;
    &lt;script type="text/javascript" src="cordova.js"&gt;&lt;/script&gt;
    &lt;script type="text/javascript"&gt;
      document.addEventListener('deviceready', deviceready, false);
      function deviceready() {
        alert("Example Event");
      }
    &lt;/script&gt;
&lt;/body&gt;</pre></div><p>If any JavaScript external files are included at the top of the HTML <code class="literal">head</code> section, the browser stops parsing further until the file is downloaded. So it is recommended to add any JavaScript files or code chunks to the end of the <code class="literal">body</code> tag to decrease the wait time.</p><p>Today, most <a id="id118" class="indexterm"/>modern browsers support the <code class="literal">async</code> and <code class="literal">defer</code> attributes on scripts. These attributes tell the browser that it's safe to continue parsing while the scripts are being downloaded:</p><div class="informalexample"><pre class="programlisting">&lt;script type="text/javascript" src="path/to/script1.js" async&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="path/to/script2.js" defer&gt;&lt;/script&gt;</pre></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec21"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We removed the code from the default project created and added our own content. Please note that we added the <code class="literal">deviceready</code> event listener. When the app gets loaded and ready for action, the event will show an alert box. The <code class="literal">deviceready</code> event should be the entry point for all our device-related action.</p><p>When we build and emulate the sample project, we will see the following output in the emulator:</p><div class="mediaobject"><img src="graphics/B03476_02_10.jpg" alt="What just happened?"/></div></div></div>
<div class="section" title="WebKit debugging &#x2013; Chrome, Safari, and Opera"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec27"/>WebKit debugging – Chrome, Safari, and Opera</h1></div></div></div><p>WebKit-based browsers <a id="id119" class="indexterm"/>support various debugging tools. For example, when encountering JavaScript issues, you can launch Web Inspector or Developer Tools and start to explore logs and errors using the JavaScript console.</p><p>In Chrome, you<a id="id120" class="indexterm"/> can access the Developer Tools from the Customize menu (click on the Customize menu and then go to <span class="strong"><strong>Tools</strong></span> | <span class="strong"><strong>Developer Tools</strong></span>). The Customize menu is available in the top-right corner. When working with Safari, you<a id="id121" class="indexterm"/> first have to enable the Developer Tools by opening Safari's <span class="strong"><strong>Preferences</strong></span> panel and then selecting the <span class="strong"><strong>Show Develop</strong></span> menu in the menu bar checkbox. You can then access the inspector by choosing <span class="strong"><strong>Show Web Inspector</strong></span> from the application's <span class="strong"><strong>Develop</strong></span> menu.</p><p>Since the Web Inspector is part of the WebKit codebase, you can use the same shortcuts in Chrome and Safari to access the debugging tools.</p><p>On Windows and Linux, press:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>I</em></span> to open Developer Tools</li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>J</em></span> to open Developer Tools and bring focus to the console</li><li class="listitem" style="list-style-type: disc"><span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>C</em></span> to toggle the Inspect Element mode</li></ul></div><p>On OS X, press:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">⌥ ⌘ <span class="emphasis"><em>I</em></span> (option + command + <span class="emphasis"><em>I</em></span>) to open Developer Tools</li><li class="listitem" style="list-style-type: disc">⌥ ⌘ <span class="emphasis"><em>J</em></span> (option + command + <span class="emphasis"><em>J</em></span>) to open Developer Tools and bring focus to the console</li><li class="listitem" style="list-style-type: disc">⌥ ⌘ <span class="emphasis"><em>C</em></span> (option + command + <span class="emphasis"><em>C</em></span>) to toggle the Inspect Element mode</li></ul></div><p>When accessing Developer Tools, you can switch between tools by clicking on the respective icon.</p><p>The <span class="strong"><strong>Elements</strong></span> panel allows you to see the webpage as the browser renders it. When using it, you can see the raw HTML and CSS, and explore the <a id="id122" class="indexterm"/>
<span class="strong"><strong>Document Object Model</strong></span> (<span class="strong"><strong>DOM</strong></span>). By clicking on the <span class="strong"><strong>Elements</strong></span> panel and moving around the source of the page, you can identify the HTML blocks and change the CSS selector's value on-the-fly in order to experiment and fix possible rendering issues:</p><div class="mediaobject"><img src="graphics/B03476_02_01.jpg" alt="WebKit debugging – Chrome, Safari, and Opera"/></div><p>The <span class="strong"><strong>Resources</strong></span> panel lets you inspect resources that are loaded and available in the inspected page. It lets you interact with frame trees containing frame resources (HTML, JavaScript, CSS, images, fonts, and so on), HTML5 databases, local storage, cookies, and AppCache.</p><p>Using the <a id="id123" class="indexterm"/>
<span class="strong"><strong>Network</strong></span> panel, you can explore the components that a webpage or application requests from web servers, how long these requests take, and how much bandwidth is required.</p><p>Using the <span class="strong"><strong>Sources</strong></span> panel, you can access all the resources loaded into the page. Use this panel to access the JavaScript, set breakpoints in the code, and explore the stack trace for each error. In order to set a breakpoint, select the script in which you want to set the breakpoint, and then click on the line number you are interested in. When the debug tool reaches the breakpoint, you can see what's happening in your code by exploring the call stack (that is, the chain of functions and/or methods executed until this breakpoint) and the scope variables, and move in and out of functions:</p><div class="mediaobject"><img src="graphics/B03476_02_02.jpg" alt="WebKit debugging – Chrome, Safari, and Opera"/></div><p>The JavaScript can be edited directly inside the debugger and you can see your changes on-the-fly by going back and forth using the navigation arrows. If you want the debugger to stop the code <a id="id124" class="indexterm"/>execution each time an exception is raised, use the <span class="strong"><strong>Pause all</strong></span> button at the bottom left of the panel. For details about each of the functionalities, we recommend that you refer to the official docs at <a class="ulink" href="https://developer.chrome.com/devtools/docs/javascript-debugging">https://developer.chrome.com/devtools/docs/javascript-debugging</a>.</p><p>The <span class="strong"><strong>Timeline</strong></span> panel lets you analyze the various WebKit behind-the-scenes activities such as how long the browser takes to handle DOM events, render page layouts, and handle events.</p><p>Once you press the Record button, you can start to inspect what's happening in the page you are currently viewing.</p><p>The Events and Frames icons (available in Chrome) allow you to access two different timeline data views, the first one is based on time and the second one is based on frames; you can zoom into each view by using the grey vertical controls at the top.</p><p>The Memory icon lets you explore the memory usage of a specific webpage; in order to be more accurate during the exploration, it's a good habit to force the garbage collector by pressing the Trash icon at the bottom of the panel. Garbage collection is a form of automatic memory management; the collector attempts to reclaim garbage or memory occupied by objects that are no longer being used by the browser's window.</p><div class="mediaobject"><img src="graphics/B03476_02_03.jpg" alt="WebKit debugging – Chrome, Safari, and Opera"/></div><p>The <span class="strong"><strong>Profiles</strong></span> tool helps you capture and analyze the performance of JavaScript scripts. For example, you can learn which functions take the most time to execute and then zoom in on the possible bottlenecks and understand exactly where to optimize.</p><p>The <span class="strong"><strong>Audits</strong></span> panel is like having your own web optimization consultant sitting next to you. This panel can analyze a page as it loads and then provide suggestions and optimizations to decrease page load time and increase perceived responsiveness.</p></div>
<div class="section" title="Gecko debugging &#x2013; Firefox"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec28"/>Gecko debugging – Firefox</h1></div></div></div><p>Firefox<a id="id125" class="indexterm"/> is<a id="id126" class="indexterm"/> based on the Gecko open source layout engine used in many applications developed by the Mozilla Foundation and the Mozilla Corporation. It offers good debugging tools and it's evolving quickly, including innovative projects such as Desktop WebRT, which lets you build a desktop web application at runtime that provides web apps with a native-like look and feel along with platform integration APIs on Windows, OS X, and other desktop platforms.</p><p>If you are not<a id="id127" class="indexterm"/> developing apps for Android or iOS, you can use the Firefox layout engine, which offers some powerful development and debugging tools. Let's quickly explore how to use Firefox/Firebug to inspect and debug your app; as you will see, there are several similarities between the debug tools available in WebKit and Firefox.</p><p>Firebug integrated with Firefox puts a great set of developer tools at your fingertips that rivals the features of the WebKit Web Inspector. In order to install the <a id="id128" class="indexterm"/>Firebug extension, you have to go to <a class="ulink" href="https://www.getfirebug.com/downloads/">https://www.getfirebug.com/downloads/</a> and install the latest version. Once installed, you can open the extension by navigating to <span class="strong"><strong>Tools</strong></span> | <span class="strong"><strong>Web Developer</strong></span> | <span class="strong"><strong>Firebug</strong></span>.</p><p>The Firebug toolbar gives you access to the HTML source code and CSS rules, lets you explore and debug JavaScript functions, and more:</p><div class="mediaobject"><img src="graphics/B03476_02_04.jpg" alt="Gecko debugging – Firefox"/></div><p>Once the debugger reaches a breakpoint, you can:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Explore the variables defined in the block of code in which you set up the breakpoint</li><li class="listitem" style="list-style-type: disc">Explore the stack of function/method calls</li><li class="listitem" style="list-style-type: disc">Create watches in order to understand how the content of a variable changes during the execution of the code</li></ul></div><p>The Script <a id="id129" class="indexterm"/>console in Firebug is amazing. You can type your code in to the right window and then run it and see the results in the console by clicking on the <span class="strong"><strong>Run</strong></span> button at the bottom right of the panel:</p><div class="mediaobject"><img src="graphics/B03476_02_05.jpg" alt="Gecko debugging – Firefox"/></div><p>To filter logs, use<a id="id130" class="indexterm"/> the <span class="strong"><strong>All</strong></span>, <span class="strong"><strong>Errors</strong></span>, <span class="strong"><strong>Warnings</strong></span>, <span class="strong"><strong>Info</strong></span>, <span class="strong"><strong>Debug Info</strong></span>, and <span class="strong"><strong>Cookies</strong></span> selectors at the top of the window.</p><p>As mentioned previously, Firefox has three great native development tools: Scratchpad, Inspect, and Responsive Design View. You can access these tools through the menu bar by navigating to <span class="strong"><strong>Tools</strong></span> | <span class="strong"><strong>Web Developer</strong></span>.</p><p>Think of Scratchpad as a text editor; you can use it to type and execute JavaScript. The difference between Scratchpad and the console is that it looks like a text editor and you can write all the code you want before executing it:</p><div class="mediaobject"><img src="graphics/B03476_02_06.jpg" alt="Gecko debugging – Firefox"/></div><p>The Responsive Design View tool lets you change the resolution without resizing the browser. You can also use it to simulate device rotation:</p><div class="mediaobject"><img src="graphics/B03476_02_07.jpg" alt="Gecko debugging – Firefox"/></div></div>
<div class="section" title="Internet Explorer"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec29"/>Internet Explorer</h1></div></div></div><p>Internet Explorer, at<a id="id131" class="indexterm"/> the time of writing, still has a wide install base; it's also the least favorite browser among developers. Virtually every developer has experienced serious issues when optimizing a webpage for IE; this is due to the fact that IE diverges from web standards in significant areas, but things are changing and the preview of IE 10 is getting good scores in various tests. Internet Explorer 11 is even better for developers.</p><p>Developer Tools were introduced in Internet Explorer 8, and updated with new functionality in Internet Explorer 9. Developer Tools in Internet Explorer 10 add Web Worker debugging and support for multiple script sources.</p><p>You can access Developer Tools by pressing <span class="emphasis"><em>F12</em></span> or by navigating to <span class="strong"><strong>Tools</strong></span> | <span class="strong"><strong>Developer Tools</strong></span> from the menu bar:</p><div class="mediaobject"><img src="graphics/B03476_02_08.jpg" alt="Internet Explorer"/></div><p>The IE 10 Developer<a id="id132" class="indexterm"/> Tools provide a similar user interface to the Developer Tools in Safari, Chrome, and Firefox.</p></div>
<div class="section" title="Debugging workflow"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec30"/>Debugging workflow</h1></div></div></div><p>The<a id="id133" class="indexterm"/> desktop browser is a great tool for hybrid mobile app development. The majority of your mobile development can be previewed and debugged in your desktop browser. Because PhoneGap leverages open web standards (HTML, CSS, and JavaScript), you can start work in a desktop browser and then move on to a native project once the functionality is fleshed out. This way, it's possible to speed up our development cycles and spend more time implementing core functionality. You can use the latest versions of any of the major desktop browsers such as Internet Explorer (IE), Google Chrome, Firefox, Safari, or Opera to get started with a PhoneGap app. All of these browsers have Developer Tools for logging and debugging your code.</p><p>New developers tend to prefer WebKit-based browsers; at the time of writing, Chrome has the largest install base market share followed by Firefox and Internet Explorer.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note07"/>Note</h3><p>Chrome also offers a technology known as<a id="id134" class="indexterm"/> <span class="strong"><strong>Google Packaged Apps</strong></span> to build native apps based on web standards. More information about it is <a id="id135" class="indexterm"/>available at <a class="ulink" href="https://developer.chrome.com/apps/about_apps">https://developer.chrome.com/apps/about_apps</a>.</p></div></div><p>As you have<a id="id136" class="indexterm"/> seen, each browser offers different debugging tools and each tool has its pros and cons. Regardless of which tool you use, however, your debugging workflow is the same.</p><p>When investigating a specific problem, you will usually follow this process:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Find the relevant code in the debugger's code view pane.</li><li class="listitem">Set breakpoint(s) where you think interesting things may occur.</li><li class="listitem">Run the script again by reloading the page in the browser if it's an inline script, or by clicking on a button if it's an event handler.</li><li class="listitem">Wait until the debugger pauses execution and makes it possible to step through the code.</li><li class="listitem">Investigate the values of variables. For example, look for variables that are undefined when they should contain a value, or return <code class="literal">false</code> when you expect them to return <code class="literal">true</code>.</li></ol></div><p>If necessary, you can use the console to evaluate code or change variables for testing. You can also execute complex JavaScript code and test a solution before implementing it.</p><p>Identifying the problem by learning which piece of code or input caused the error conditions and isolating it is a suitable approach. However, with mobile apps, things are not always so straightforward. The advantage of PhoneGap is that you can develop and debug in a common environment such as the browser, but keep in mind that a mobile app has to be tested and debugged on the target devices as well.</p><p>Although it's not a neat way of debugging, you can use console log messages to debug. These log messages will be printed in the console of the browser development tool. A sample use of the JavaScript code is provided here for reference:</p><div class="informalexample"><pre class="programlisting">console.log("Application running now");</pre></div><p>There are <a id="id137" class="indexterm"/>several other debugging tools for PhoneGap/Cordova. While a few of them are free <a id="id138" class="indexterm"/>services, some of<a id="id139" class="indexterm"/> them are<a id="id140" class="indexterm"/> paid services:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem"><span class="strong"><strong>Ripple Emulator</strong></span>: <a class="ulink" href="http://emulate.phonegap.com/">http://emulate.phonegap.com/</a></li><li class="listitem"><span class="strong"><strong>GapDebug</strong></span>: <a class="ulink" href="https://www.genuitec.com/products/gapdebug/">https://www.genuitec.com/products/gapdebug/</a></li><li class="listitem"><span class="strong"><strong>jsHybugger</strong></span>: <a class="ulink" href="https://www.jshybugger.com/">https://www.jshybugger.com/</a></li><li class="listitem"><span class="strong"><strong>Weinre</strong></span>: <a class="ulink" href="http://people.apache.org/~pmuellr/weinre-docs/latest/">http://people.apache.org/~pmuellr/weinre-docs/latest/</a></li><li class="listitem"><span class="strong"><strong>Adobe</strong></span><a id="id141" class="indexterm"/><span class="strong"><strong> Edge </strong></span><a id="id142" class="indexterm"/><span class="strong"><strong>Inspect</strong></span>: <a class="ulink" href="https://creative.adobe.com/products/inspect">https://creative.adobe.com/products/inspect</a></li><li class="listitem"><span class="strong"><strong>Chrome</strong></span>: <a class="ulink" href="https://developer.chrome.com/devtools/docs/remote-debugging">https://developer.chrome.com/devtools/docs/remote-debugging</a></li></ol></div></div>
<div class="section" title="Building and deployment"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec31"/>Building and deployment</h1></div></div></div><p>Once you <a id="id143" class="indexterm"/>are done with your development, you might want to test the application on a real mobile device. Each mobile platform will have a different kind of binary format for the applications. For example, Android application files will have the <code class="literal">.apk</code> extension. Similarly, each platform will have a different format for the application.</p><p>To create binary files for all platforms from your source code, you need to build the application either locally or by using a cloud service.</p><p>If you are building the application locally, you need to run the command-line interface, and the required platform's SDK should be installed on the machine. The CLI supports the following combinations on each operating system:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Windows</p>
</th><th style="text-align: left" valign="bottom">
<p>Linux</p>
</th><th style="text-align: left" valign="bottom">
<p>Mac</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>Amazon Fire OS</p>
<p>Android</p>
<p>BlackBerry 10</p>
<p>Windows Phone 7</p>
<p>Windows Phone 8</p>
<p>Windows 8</p>
<p>Firefox OS</p>
</td><td style="text-align: left" valign="top">
<p>Amazon Fire OS</p>
<p>Android</p>
<p>BlackBerry 10</p>
<p>Firefox OS</p>
</td><td style="text-align: left" valign="top">
<p>iOS (only on Mac)</p>
</td></tr></tbody></table></div><p>This table makes it clear that you can't build an iOS application on a Windows machine or a Windows 8 application on a Mac machine. You will need an appropriate machine and the required SDKs installed on the machine.</p><p>Assuming you have all the required SDKs installed and configured, to build the application for each of the platform, you can use the <span class="strong"><strong>build</strong></span> tool<a id="id144" class="indexterm"/> of CLI.</p><p>Run the<a id="id145" class="indexterm"/> following command to build the project for all the platforms added to the project. If you added multiple platforms to the project using the <code class="literal">platform add</code> command, the build will happen for all platforms:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>C:\example1&gt; phonegap build</strong></span>
</pre></div><p>If you want to build the application only for a particular platform, say Android or iOS, you can target them individually with the following commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>C:\example1&gt; phonegap build android</strong></span>
<span class="strong"><strong>C:\example1&gt; phonegap build ios</strong></span>
</pre></div><p>The <code class="literal">build</code> command is the shortcut to prepare and compile the project. You can also build a project in two steps, as shown here. The following set of commands is the equivalent of the <code class="literal">build</code> command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>C:\example1&gt; phonegap prepare android</strong></span>
<span class="strong"><strong>C:\example1&gt; phonegap compile android</strong></span>
</pre></div><p>Once the build process is completed, the platform-specific app will be available within the project's <code class="literal">platforms</code> subdirectory.</p><p>Having seen <a id="id146" class="indexterm"/>the manual way of building an application, now let's find out about PhoneGap Build. If you want to build and generate application binary files for all platforms, you need to install the individual SDKs on your machine, which is not practically possible. That's where we find the PhoneGap Build process handy. PhoneGap Build is an online service for creating binary files for all mobile platforms based on a single source code.</p><p>It takes the source code and creates the app file for each of the platforms that you require. It's as simple as uploading your Cordova/PhoneGap project and the cloud service does the rest. The overall functionality of the <a id="id147" class="indexterm"/>PhoneGap Build process is provided in the following diagram, which is available at <a class="ulink" href="https://build.phonegap.com">https://build.phonegap.com</a>:</p><div class="mediaobject"><img src="graphics/B03476_02_11.jpg" alt="Building and deployment"/></div><p>To use<a id="id148" class="indexterm"/> PhoneGap Build, you have to follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Complete your PhoneGap/Cordova project and ensure you have all the functionalities included in the app as per your design.</li><li class="listitem">PhoneGap Build only requires the contents (HTML, CSS, JavaScript, and images) of your project's <code class="literal">assets</code> directory.</li><li class="listitem">If you have any <code class="literal">phonegap.js</code> or <code class="literal">cordova.js</code> files included in your assets, remove the file as the PhoneGap Build process will automatically inject the required file.</li><li class="listitem">You<a id="id149" class="indexterm"/> can <a id="id150" class="indexterm"/>upload the project to the PhoneGap Build process and you can see the magic happen.</li></ol></div><p>You can easily download all the application builds for all platforms with a single click:</p><div class="mediaobject"><img src="graphics/B03476_02_12.jpg" alt="Building and deployment"/></div><p>More details about the PhoneGap <a id="id151" class="indexterm"/>Build process can be obtained at <a class="ulink" href="http://docs.build.phonegap.com/en_US/">http://docs.build.phonegap.com/en_US/</a>.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec32"/>Summary</h1></div></div></div><p>After providing an overview of several tools and some debugging techniques, this chapter prepared you to move to the next step, creating and building a multi-platform app with Apache Cordova and its PhoneGap distribution. You also learned the usage of various command-line tools and Cordova events. In the next chapter, you'll gain information about various mobile frameworks and templates to start off your mobile development.</p></div></body></html>