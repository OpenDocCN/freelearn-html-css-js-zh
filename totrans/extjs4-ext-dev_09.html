<html><head></head><body><div class="chapter" title="Chapter&#xA0;9.&#xA0;Intuitive Multiselect Combobox"><div class="titlepage"><div><div><h1 class="title"><a id="ch09"/>Chapter 9. Intuitive Multiselect Combobox</h1></div></div></div><p>In this chapter we will explore an excellent Ext JS extension: <code class="literal">BoxSelect</code>, which was originally developed by Kevin Vaughan. This extension is really very useful and provides a friendlier<a id="id359" class="indexterm"/> combobox for multiple selections that creates removable labels for each selection, easily and individually, and lots more.</p><p>The topics covered are:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Features of <code class="literal">BoxSelect</code></li><li class="listitem" style="list-style-type: disc">The <code class="literal">BoxSelect</code> extension:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Basic configuration</li><li class="listitem" style="list-style-type: disc">Templates</li><li class="listitem" style="list-style-type: disc">Single value selection</li><li class="listitem" style="list-style-type: disc">Remote query with unknown values</li><li class="listitem" style="list-style-type: disc">Adding new records with autosuggestion</li><li class="listitem" style="list-style-type: disc"><code class="literal">BoxSelect</code> specific configurations</li><li class="listitem" style="list-style-type: disc">Value handling and events</li></ul></div></li></ul></div><div class="section" title="Features of BoxSelect"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec49"/>Features of BoxSelect</h1></div></div></div><p>
<code class="literal">BoxSelect</code> is an<a id="id360" class="indexterm"/> extended <code class="literal">ComboBox</code> component developed for more intuitive multiselect capabilities. <code class="literal">BoxSelect</code> comes with lots of examples and proper documentation. The<a id="id361" class="indexterm"/> following features are provided by the <code class="literal">BoxSelect</code> extension:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Selected items can be removed individually.</li><li class="listitem" style="list-style-type: disc">Customizable item templates for controlling the display of the selected values.</li><li class="listitem" style="list-style-type: disc">Supports keyboard-based selection and navigation for the selected values.</li><li class="listitem" style="list-style-type: disc">Supports on-demand loading of values from remote stores when an unknown value is set, and the <code class="literal">queryMode</code> option is set to <code class="literal">remote</code> and <code class="literal">forceSelection</code> is set to <code class="literal">true</code>.</li><li class="listitem" style="list-style-type: disc">Setting <code class="literal">forceSelection</code> to <code class="literal">false</code> creates new records.</li><li class="listitem" style="list-style-type: disc">When <code class="literal">multiSelect</code> is set to <code class="literal">true</code> the pick list can be configured to tell if it should collapse <a id="id362" class="indexterm"/>or not, after making a selection.</li><li class="listitem" style="list-style-type: disc">Selected <a id="id363" class="indexterm"/>items can be configured to be stacked or autosized.</li><li class="listitem" style="list-style-type: disc">Most of the existing functionalities and configuration options of <code class="literal">ComboBox</code> should work with <code class="literal">BoxSelect</code>.</li></ul></div></div></div>
<div class="section" title="Using BoxSelect"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec50"/>Using BoxSelect</h1></div></div></div><p>
<code class="literal">BoxSelect</code> extends the <code class="literal">ComboBox</code> control to provide a more multiselect, friendly <code class="literal">ComboBox</code> control. The examples <a id="id364" class="indexterm"/>included in this chapter show the differences between the default <a id="id365" class="indexterm"/>
<code class="literal">ComboBox</code> control and this extension, and provide general information about the advanced usage of <code class="literal">BoxSelect</code>.</p><div class="section" title="Basic configuration"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec10"/>Basic configuration</h2></div></div></div><p>
<code class="literal">BoxSelect</code> should support all configuration values as the <code class="literal">ComboBox</code> supports. There are some changes for the<a id="id366" class="indexterm"/> default values for this extension:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">multiSelect</code> option is set to <code class="literal">true</code> by default.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">forceSelection</code> option is set to <code class="literal">true</code> by default.</li><li class="listitem" style="list-style-type: disc">In most cases, the multiple selections are made from a preformed list, but we can also configure the <code class="literal">BoxSelect</code> extension to add new records with an autosuggestion list.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">ComboBox</code> component doesn't support <code class="literal">typeAhead</code> when the <code class="literal">multiSelect</code> option is set to <code class="literal">true</code>, but even though the value of <code class="literal">typeAhead</code> is set <a id="id367" class="indexterm"/>to <code class="literal">false</code> by default for the <code class="literal">BoxSelect</code> extension, support for this feature has been added for <code class="literal">multiSelect</code> when set to<code class="literal"> true</code>.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">value</code> option can be used to initialize the <code class="literal">multiSelect</code> values. The same format of values is accepted for the <code class="literal">setValue</code> method.</li></ul></div><p>Now, let us start using the <code class="literal">BoxSelect</code> extension with the following configuration:</p><div class="informalexample"><pre class="programlisting">{
  "value": [
    "TX",
    "CA"
  ],
  "fieldLabel": "Select multiple states",
  "displayField": "name",
  "valueField": "abbr",
  "width": 500,
  "labelWidth": 130,
  "emptyText": "Pick a state, any state",
  "store": "States",
  "queryMode": "local"
}</pre></div><p>And the screenshot should be as follows:</p><div class="mediaobject"><img src="graphics/3725OS_9_1.jpg" alt="Basic configuration"/></div><p>In the preceding screenshot, we can see how easily we can select multiple values within the <code class="literal">BoxSelect</code> combobox extension.</p></div><div class="section" title="Templates"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec11"/>Templates</h2></div></div></div><p>We can easily <a id="id368" class="indexterm"/>configure the display of the selected values and the <a id="id369" class="indexterm"/>drop-down list items through <a id="id370" class="indexterm"/>templates:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>labelTpl</strong></span>: It is the <a id="id371" class="indexterm"/>template configuration option which controls the display of the selected values within the input field.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>listConfig</strong></span>: It is the <a id="id372" class="indexterm"/>template configuration option which controls the display of the drop-down list items. This option is available within the default <code class="literal">ComboBox</code> field and also supported by <code class="literal">BoxSelect</code>.</li></ul></div><p>Now, let us see how we can set the configuration for customizing the <code class="literal">labelTpl</code> and the <code class="literal">listConfig</code> options:</p><div class="informalexample"><pre class="programlisting">{
  "delimiter": ", ",
  "value": "AZ, CA, NC",
  "labelTpl": "&lt;img src=\"{flagUrl}\"style=\"height: 25px;vertical-align: middle;margin: 2px;\" /&gt; {name} ({abbr})",
  "listConfig": {
    "tpl": [
      "&lt;ul&gt;&lt;tpl for=\".\"&gt;",
      "&lt;li role=\"option\"class=\"x-boundlist-item\"style=\"background-image:url({flagUrl});background-repeat: no-repeat;background-size: 25px;padding-left: 30px;\"&gt;{name}: {slogan}&lt;/li&gt;",
         "&lt;/tpl&gt;&lt;/ul&gt;"
    ]
  },
  "fieldLabel": "Select multiple states",
  "displayField": "name",
  "valueField": "abbr",
  "width": 500,
  "labelWidth": 130,

  "store": "States",
  "queryMode": "local"
}</pre></div><p>Following is <a id="id373" class="indexterm"/>the screenshot of the <code class="literal">BoxSelect</code> extension <a id="id374" class="indexterm"/>using <a id="id375" class="indexterm"/>the preceding configuration for <code class="literal">labelTpl</code> and<code class="literal"> listConfig</code>:</p><div class="mediaobject"><img src="graphics/3725OS_9_2.jpg" alt="Templates"/></div><p>In the preceding screenshot, we can see that the <code class="literal">BoxSelect</code> extension is working fine and is showing the selected items with the configured <code class="literal">labelTpl</code> and <code class="literal">listConfig</code> comboboxes.</p></div><div class="section" title="Single value selection"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec12"/>Single value selection</h2></div></div></div><p>The <code class="literal">BoxSelect</code> extension is targeted for multiple selections, but it also supports single selection by<a id="id376" class="indexterm"/> setting the <code class="literal">multiSelect</code> option to <code class="literal">false.</code> If we need the<a id="id377" class="indexterm"/> single selection option <a id="id378" class="indexterm"/>by default, we can add the following line of code before the <code class="literal">BoxSelect</code> extension is created:</p><div class="informalexample"><pre class="programlisting">Ext.ux.form.field.BoxSelect.prototype.multiSelect = false;</pre></div><p>Now, let us configure the <code class="literal">BoxSelect</code> extension for a single selection:</p><div class="informalexample"><pre class="programlisting">{
  "fieldLabel": "Select a state",
  "multiSelect": false,
  "filterPickList": true,
  "displayField": "name",
  "valueField": "abbr",
  "width": 500,
  "labelWidth": 130,
  "emptyText": "Pick a state, any state",
  "store": "States",
  "queryMode": "local"
}</pre></div><p>And the output should be as follows:</p><div class="mediaobject"><img src="graphics/3725OS_9_3.jpg" alt="Single value selection"/></div><p>In the preceding screenshot, we can now select only a single value within the combobox when the <code class="literal">multiSelect</code> option is set to <code class="literal">false</code>.</p></div><div class="section" title="Remote query with unknown values"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec13"/>Remote query with unknown values</h2></div></div></div><p>When we set the <code class="literal">queryMode</code> option to <code class="literal">remote</code> and the <code class="literal">forceSelection</code> option to <code class="literal">true</code>, and we pass a value to the <code class="literal">BoxSelect</code> extension that is not in the store, a query will be sent to the store's configured proxy "x" with the name of the <code class="literal">valueField</code> option and a set of unknown<a id="id379" class="indexterm"/> values separated by the <a id="id380" class="indexterm"/>configured <code class="literal">delimiter</code> as the parameters. For example, if the <code class="literal">valueField</code> option is <code class="literal">abbr</code>, the <code class="literal">delimiter</code> value is <code class="literal">|</code>, and unknown values '<code class="literal">NC</code>', '<code class="literal">VA</code>', and, '<code class="literal">ZZ</code>' are set, the following parameters will be passed to the store's configured proxy:</p><div class="informalexample"><pre class="programlisting">{ abbr: 'NC|VA|ZZ' }</pre></div><p>This attempt to load the unknown values will be performed only once per <code class="literal">initValue</code>/<code class="literal">setValue</code> call. The records which are still unknown after this request will be removed from the<a id="id381" class="indexterm"/> field's value, but all known values will be retained. In the preceding example, the <code class="literal">'ZZ'</code> entry was discarded.</p><p>Now, let us configure the <code class="literal">BoxSelect</code> extension for remote stores:</p><div class="informalexample"><pre class="programlisting">{
  "fieldLabel": "With Remote Store",
  "store": "RemoteStates",
  "pageSize": 25,
  "queryMode": "remote",
  "delimiter": "|",
  "value": "NC|VA|ZZ",
  "triggerOnClick": false,
  "labelTpl": "{name} ({abbr})",
  "listConfig": {
    "tpl": [
      "&lt;ul&gt;&lt;tpl for=\".\"&gt;",
        "&lt;li role=\"option\"class=\"x-boundlist-item\"&gt;{name}: {slogan}&lt;/li&gt;",
      "&lt;/tpl&gt;&lt;/ul&gt;"
    ]
  },
  "displayField": "name",
  "valueField": "abbr",
  "width": 500,
  "labelWidth": 130
}</pre></div><p>Following is the screenshot where we have used this configuration for the <code class="literal">BoxSelect</code> extension:</p><div class="mediaobject"><img src="graphics/3725OS_9_4.jpg" alt="Remote query with unknown values"/></div><p>In the preceding <a id="id382" class="indexterm"/>screenshot we can see that our configured <code class="literal">BoxSelect</code> is working fine for the remote store, and the value for '<code class="literal">NC</code>' and '<code class="literal">VA</code>' is<a id="id383" class="indexterm"/> retrieved where the value for '<code class="literal">ZZ</code>' is discarded.</p></div><div class="section" title="Adding new records with autosuggestion"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec14"/>Adding new records with autosuggestion</h2></div></div></div><p>In this example we will show the use of <code class="literal">forceSelection</code>, when set to <code class="literal">false</code>, to enable the entry of new<a id="id384" class="indexterm"/> values with autosuggestion<a id="id385" class="indexterm"/> provided from the attached <a id="id386" class="indexterm"/>store. The new records will be created using the user input for both the configured <code class="literal">displayField</code> and <code class="literal">valueField</code>. These <a id="id387" class="indexterm"/>new records are not added to the <code class="literal">ComboBox</code> store automatically.</p><p>New entries can be created by any of the following four ways:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">When we type the configured <code class="literal">delimiter</code> which is default to ',', the value that we entered before the <code class="literal">delimiter</code> will be used to create a new record.</li><li class="listitem" style="list-style-type: disc">When we paste texts in to the field, the value will be split according to the configured <code class="literal">delimiter</code>, which is default to ',' and any values entered will be parsed in to new/existing records.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">createNewOnEnter</code> option is set to <code class="literal">false</code> by default. If set to <code class="literal">true</code>, a new entry will be created when we press the <span class="emphasis"><em>Enter</em></span> key. This configuration option only applies if the <code class="literal">forceSelection</code> option is set to <code class="literal">false</code>.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">createNewOnBlur</code> option is set to <code class="literal">false</code> by default. If set to <code class="literal">true</code>, a new entry will be created when the focus leaves the input field. This configuration option only applies if <code class="literal">forceSelection</code> is set to <code class="literal">false</code>, and is superseded by <code class="literal">autoSelect</code> and <code class="literal">selectOnTab</code>.</li></ul></div><p>Now, let us configure the <code class="literal">BoxSelect</code> extension for autosuggestion:</p><div class="informalexample"><pre class="programlisting">{
  "fieldLabel": "Enter multiple email addresses",
  "width": 500,
  "growMin": 75,
  "growMax": 120,
  "labelWidth": 130,
  "store": [
    "test@example.com",
    "somebody@somewhere.net",
    "johnjacob@jingleheimerschmidts.org",
    "rumpelstiltskin@guessmyname.com",
    "fakeaddresses@arefake.com",
    "bob@thejoneses.com"
  ],
  "queryMode": "local",
  "forceSelection": false,
  "createNewOnEnter": true,
  "createNewOnBlur": true,
  "filterPickList": true,
  "displayField": "name",
  "valueField": "abbr"
}</pre></div><p>Using this <a id="id388" class="indexterm"/>configuration <a id="id389" class="indexterm"/>we<a id="id390" class="indexterm"/> will get the <code class="literal">BoxSelect</code> component <a id="id391" class="indexterm"/>as follows:</p><div class="mediaobject"><img src="graphics/3725OS_9_5.jpg" alt="Adding new records with autosuggestion"/></div><p>In the preceding screenshot, we can see how the <code class="literal">BoxSelect</code> component is offering an autosuggestion list where we can select those list items or create new records.</p></div><div class="section" title="BoxSelect specific configurations"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec15"/>BoxSelect specific configurations</h2></div></div></div><p>The following <a id="id392" class="indexterm"/>configuration options are specific to<a id="id393" class="indexterm"/> the <code class="literal">BoxSelect</code> extension:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">createNewOnEnter</code> option<a id="id394" class="indexterm"/> is set to <code class="literal">false</code> by default. If this option is set to <code class="literal">true</code> and the<code class="literal"> forceSelection</code> option<a id="id395" class="indexterm"/> is set to <code class="literal">false</code>, a new entry will be created as soon as the user presses the <span class="emphasis"><em>Enter</em></span> key.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">createNewOnBlur</code> option<a id="id396" class="indexterm"/> is set to <code class="literal">false</code> by default. If this option is set to <code class="literal">true</code> and the <code class="literal">forceSelection </code>option<a id="id397" class="indexterm"/> is set to <code class="literal">false</code>, a new entry will be created when the <a id="id398" class="indexterm"/>focus leaves the input field. This configuration option is superseded by <code class="literal">autoSelect</code><a id="id399" class="indexterm"/> and <code class="literal">selectOnTab</code>.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">stacked</code> option<a id="id400" class="indexterm"/> is set to <code class="literal">false</code> by default. If this option is set to <code class="literal">true</code>, the labeled items will fill the available width of the list instead of being only as wide as the displayed value.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">pinList</code> option<a id="id401" class="indexterm"/> is set to <code class="literal">true</code> by default. If this option is set to <code class="literal">false</code>, the pick list will automatically collapse after a selection is made, when <code class="literal">multiSelect</code> is <code class="literal">true</code>. This mimics the default behavior when <code class="literal">multiSelect</code> is <code class="literal">false</code>.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">triggerOnClick</code> option<a id="id402" class="indexterm"/> is set to <code class="literal">true</code> by default. When the option is set to <code class="literal">true</code>, the pick list will emulate a trigger when clicking in the field just like<a id="id403" class="indexterm"/> when a <code class="literal">ComboBox</code> component is set with the <code class="literal">editable</code> option to <code class="literal">false</code>.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">grow</code> option is set to <code class="literal">true</code> by default. If this option is set to <code class="literal">false</code>, the list of selections will scroll when necessary, and the height of the field will not change. This setting has no effect if a fixed height is set for the field, either directly (for example, through a height configuration), or by the containing layout.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">growMin</code> option<a id="id404" class="indexterm"/> is set to <code class="literal">false</code> by default. If this option is set to <code class="literal">true</code>, any numeric value will be used for the field's minimum height.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">growMax</code> option<a id="id405" class="indexterm"/> is set to <code class="literal">false</code> by default. If this option is set to <code class="literal">true</code>, any numeric value will be used for the field's maximum height and the list of selections will scroll when necessary.</li><li class="listitem" style="list-style-type: disc">The <code class="literal">filterPickList</code> option<a id="id406" class="indexterm"/> is set to <code class="literal">false</code> by default. If this option is set to <code class="literal">true</code>, the currently selected values will be hidden from the expanded pick list.</li></ul></div><p>Now, let us <a id="id407" class="indexterm"/>configure the <code class="literal">BoxSelect</code> component<a id="id408" class="indexterm"/> by changing some of the default values to see the effect:</p><div class="informalexample"><pre class="programlisting">{
  "fieldLabel": "Select multiple states",
  "displayField": "name",
  "width": 500,
  "labelWidth": 130,
  "store": "States",
  "queryMode": "local",
  "valueField": "abbr",
  "value": "WA, TX",
  "stacked": true,
  "pinList": false,
  "filterPickList": true
}</pre></div><p>Following is the<a id="id409" class="indexterm"/> screenshot of the <code class="literal">BoxSelect</code> component where we've used this configuration:</p><div class="mediaobject"><img src="graphics/3725OS_9_6.jpg" alt="BoxSelect specific configurations"/></div><p>In the preceding screenshot, we can see that the labeled items are filling the full width available as we set the <code class="literal">stacked</code> option to <code class="literal">true</code>. The pick list is automatically collapsing as soon as a <a id="id410" class="indexterm"/>selection is made as we set the <code class="literal">pinList</code> option<a id="id411" class="indexterm"/> to <code class="literal">false</code>, and the current selected <a id="id412" class="indexterm"/>values are hidden from the expanded pick list as we set the <code class="literal">filterPickList</code> option to <code class="literal">true</code>.</p></div><div class="section" title="Value handling and events"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec16"/>Value handling and events</h2></div></div></div><p>The following <a id="id413" class="indexterm"/>methods are available within <code class="literal">BoxSelect</code>, which <a id="id414" class="indexterm"/>helps to work with the value of the combobox:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">addValue(mixedValue)</code>: Adds a <a id="id415" class="indexterm"/>value or values to the current value of the field.</li><li class="listitem" style="list-style-type: disc"><code class="literal">removeValue(mixedValue)</code>: Removes<a id="id416" class="indexterm"/> a value or values from the current value of the field.</li><li class="listitem" style="list-style-type: disc"><code class="literal">getValueRecords()</code>: Returns<a id="id417" class="indexterm"/> the records for the field's current value.</li><li class="listitem" style="list-style-type: disc"><code class="literal">getSubmitData()</code>: Allows <a id="id418" class="indexterm"/>submitting the field as a JSON encoded array.</li></ul></div><p>Also the <code class="literal">BoxSelect</code> component<a id="id419" class="indexterm"/> provides the following two events<a id="id420" class="indexterm"/> for <a id="id421" class="indexterm"/>managing<a id="id422" class="indexterm"/> the selected items:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">valueSelectionChange<a id="id423" class="indexterm"/></li><li class="listitem" style="list-style-type: disc">valueFocusChange<a id="id424" class="indexterm"/></li></ul></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec51"/>Summary</h1></div></div></div><p>In this chapter we've explored the features and also went through the usage of the <code class="literal">BoxSelect</code> combobox extension. We've learned how to configure the <code class="literal">BoxSelect</code> extension and its proper usage. We can see that by using Ext JS's extension feature we can easily use the full strength of the Ext JS library's <code class="literal">ComboBox</code> field and can add our own custom functionality to fulfill our needs.</p><p>Throughout this book we have learned the fundamentals of Ext JS plugins and extensions, we have introduced some of the popular Ext JS libraries and community provided plugins and extensions, and we have also provided several hands-on real world plugins and extensions development with proper explanations and code. We now have clear knowledge about the proper usage and development of Ext JS plugins and extensions.</p></div></body></html>