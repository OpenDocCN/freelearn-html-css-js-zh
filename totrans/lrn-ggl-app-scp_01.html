<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Introducing Google Apps Scripts</h1></div></div></div><p>I know there may not be a single person in the world who has access to the Internet who has not used at least one of Google's products or services in their lifetime.</p><p>Google is known for its famous search engine, the video serving portal YouTube, and now by its numerous web applications, namely Gmail, Calendar, Drive, Docs, Sheets, and Forms. It also <a class="indexterm" id="id0"/>provides cloud computing and other software services.</p><p>The word "Google" has even become a verb, referring to conducting a web search. Nowadays, you hear people saying "I Googled something" rather than "I searched the web for something". In this chapter, you will learn about Google Applications, Application Scripts, and how to create a custom formula/function.</p><div><div><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Google Applications</h1></div></div></div><p>Google Applications are<a class="indexterm" id="id1"/> a collection of applications, namely Gmail, Calendar, Drive, Docs, Sheets, and Forms. From now on, we will use the term "Google Apps" or just "Apps".</p><p>Before we start, I'll quickly answer a few questions you may have:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Where do all these Apps run? On your computer?<p>No, all these Apps run on Google's Cloud-based servers.</p></li><li class="listitem" style="list-style-type: disc">How can you get access to these applications?<p>You <a class="indexterm" id="id2"/>can interact with these <a class="indexterm" id="id3"/>Apps through web browsers. No special hardware or software installations are required except for a modern web browser installed on your desktop, laptop, tablet, or smartphone.</p></li></ul></div><div><img alt="Google Applications" src="img/B05010_01_01.jpg"/></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Google Apps Script</h1></div></div></div><p>You can customize or automate Google Apps using the JavaScript scripting language with Google-defined classes, known as <strong>Google Apps Script</strong> (<strong>GAS</strong>). Google implements GAS based on JavaScript 1.6 with some portions of 1.7 and 1.8. The GAS services and APIs provide easy access so users can automate tasks across Google products and third-party services.</p><p>You can write code in<a class="indexterm" id="id4"/> Google Docs, Sheets, and Forms using GAS and can automate tasks similar to what Visual Basic for Applications does in Microsoft Office. However, GAS runs on Google's server and the results are rendered in your browser. The integrated script editor allows you to edit and debug your scripts within your browser, and you do need not install anything. You can activate your debugged and tested script functions to run either based on your interactions or based on a trigger in response to an event or timed intervals (in minutes, hours, days, weeks, future dates, and so on). These events include <code class="literal">onOpen</code>, <code class="literal">onEdit</code>, <code class="literal">onInstall</code>, and many more. GAS is also used to create add-ons for Docs, Sheets, and Forms.</p><p>GAS can help you with every aspect of automating a task—you can even use it to order a pizza at predetermined date/time!</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec06"/>Visual Basic for Applications</h2></div></div></div><p>Microsoft implements <strong>Visual</strong><a class="indexterm" id="id5"/>
<strong> Basic for Applications</strong> (<strong>VBA</strong>) to help automate Office applications such <a class="indexterm" id="id6"/>as Excel and Word. For each respective application, VBA is known as Excel VBA or Word VBA and so on. Using Excel VBA, you can create macros for Excel known as "Excel macros". GAS is for Google Applications, and operates in the same way as VBA does for Microsoft Office applications. Although both VBA and GAS do not require a separate compilation process, they are very different scripting languages and use different programming APIs, methods, and properties.</p><p>I hope many of you are <a class="indexterm" id="id7"/>familiar with using VBA for Office applications; if not, then never mind—that's not an obstacle to <a class="indexterm" id="id8"/>learning GAS.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec07"/>The advantages of GAS over VBA</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Version-independence</strong>: Sheets/Docs along with scripts are automatically saved in the cloud, attached to <a class="indexterm" id="id9"/>your Google account, and accessible from any computer with a <a class="indexterm" id="id10"/>browser. There is no need<a class="indexterm" id="id11"/> to worry whether the other computer has the same version of Sheets/Docs installed or not, whereas we can never be sure that one<a class="indexterm" id="id12"/> version of the Excel/Word macros will work on another version.</li><li class="listitem" style="list-style-type: disc"><strong>Platform-independence</strong>: When you create VBA macros in Excel/Word on the Windows<a class="indexterm" id="id13"/> platform, they may<a class="indexterm" id="id14"/> not work on the Mac platform and vice versa. With Google Sheets/Docs, it doesn't matter what platform you're working on—it'll work.</li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec08"/>The limitations of GAS</h2></div></div></div><p>GAS runs on <a class="indexterm" id="id15"/>Google's server, so it cannot run continuously for more than six minutes (this may vary in the future). All of your functions should finish running and should return results within this time limit. Don't panic, as you'll learn how to use triggers effectively to overcome these limitations later.</p><p>In the following sections, we will take a look at the most popular Google Apps and how we can use GAS to customize and/or automate tasks.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Google Drive</h1></div></div></div><p>Google Drive is a<a class="indexterm" id="id16"/> file storage application, which from now on we will just refer to as "Drive", where you can store and synchronize your files on Google's server. Let's look<a class="indexterm" id="id17"/> at some of the advantages of using Drive:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You can edit and share Google Docs, Sheets, and Forms with your friends or collaborators in real time.</li><li class="listitem" style="list-style-type: disc">You can even stop editing a document on one of your desktops and continue with your smartphone or tablet, and vice versa, no matter where you are and what device you are using. This is possible because your files are stored on Google's Cloud server.</li><li class="listitem" style="list-style-type: disc">Files created with Google Apps are stored in Drive with Google's native formats and extensions. For example, Google Docs (documents) files are <code class="literal">.gdoc</code>, Google Sheets (spreadsheets) are <code class="literal">.gsheet</code>, and so on.</li><li class="listitem" style="list-style-type: disc">In addition to <a class="indexterm" id="id18"/>Google's native files, you can also store or upload any other type of file from your desktop to Google Drive.<div><div><h3 class="title"><a id="note02"/>Note</h3><p>If you would like to synchronize files on your computer or devices with Drive, then you can install special software called <strong>Google Drive Client Application</strong>. While <a class="indexterm" id="id19"/>this application is running on your computer or device, it synchronizes files stored locally with the same files in Drive.</p></div></div></li></ul></div><p>You may be wondering, what is the purpose of synchronizing files? Sometimes you may need to, or someone may ask you to, parse a CSV file stored on a desktop using GAS to process the data and organize it into a Sheet. In this case, GAS won't execute on the desktop, but it can on the Google server. This way you can access your Drive files and parse data within your synchronized CSV file. You don't have to upload the CSV file manually every time to Drive.</p><p>The following screenshot shows the <code class="literal">Drive</code> folder view:</p><div><img alt="Google Drive" src="img/B05010_01_02.jpg"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Gmail</h1></div></div></div><p>Gmail is the most popular web-based e-mail service and is provided by Google. With it, occasionally composing and sending e-mail messages manually to one or a few people is not a problem. But what if you want to send an e-mail at a predefined time when you are not awake or to <a class="indexterm" id="id20"/>multiple recipients? Consider the following scenarios:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You want to send a surprise birthday greeting to your friend at a fixed time; neither earlier nor later</li><li class="listitem" style="list-style-type: disc">You need to send customized e-mails to hundreds of people at a time</li><li class="listitem" style="list-style-type: disc">You need to send e-mails periodically</li></ul></div><p>For all these scenarios, GAS has<a class="indexterm" id="id21"/> the answers:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Using GAS, you can build a mail merger application to send e-mails with customized greetings or messages to <em>n</em> number of people.</li><li class="listitem" style="list-style-type: disc">You can extract information buried in e-mails from your inbox and store and organize them in Google Sheets or Docs.</li><li class="listitem" style="list-style-type: disc">You can even convert the data or contents of a Google Sheet or Docs to a PDF or any other file format and send it as an e-mail attachment, or just save the created file in <a class="indexterm" id="id22"/>Drive and include only the file's URL as a hyperlink in e-mail messages.</li><li class="listitem" style="list-style-type: disc">In addition, GAS<a class="indexterm" id="id23"/> also allows you to mark selected messages as important, or starred. You can also add, delete, and update your Gmail Contacts using the <code class="literal">Contacts</code> service.</li></ul></div><p>The following screenshot shows how Gmail classifies or groups messages with labels:</p><div><img alt="Gmail" src="img/B05010_01_03.jpg"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Google Calendar</h1></div></div></div><p>Google's online Calendar<a class="indexterm" id="id24"/> service is integrated with Gmail. GAS provides access to Calendar service by using the <code class="literal">CalendarApp</code> class. Using GAS code, you can access and modify your Calendar and those you have <a class="indexterm" id="id25"/>subscribed to. Using GAS, you can create Calendar events and invite your friends programmatically. Alternatively, you can grab event details and populate them in Sheets.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Google Docs</h1></div></div></div><p>Google Docs is a word<a class="indexterm" id="id26"/> processing program, and runs on web-based software within the Google Drive service. Docs allows you to create and edit documents online while collaborating with other users in real time. Using GAS, you can create documents, format the contents, translate them to other language, save them in Drive, or e-mail them to your friends.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Google Sheets</h1></div></div></div><p>Google Sheets is a <a class="indexterm" id="id27"/>spreadsheet program much like Microsoft Excel. You can create Sheets, share them with others, and edit them in real time. Google provides built-in formulae/functions in Sheets. You can also create your own simple to complex formulae. In other words, you can create custom formulae. Using the <code class="literal">SpreadsheetApp</code> class in your GAS code, you can interact with other applications.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec15"/>Google Apps services</h1></div></div></div><p>Google provides Apps services to<a class="indexterm" id="id28"/> enable GAS to interact with the Apps. Almost all of the Apps provide one or more services. You can use these service classes in your GAS code to customize or automate Apps. Services are grouped as <strong>basic</strong> and <strong>advanced</strong>. You can use basic services directly, but for advanced services you need to enable them before using them. You will see how to enable them later on.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Creating Google Sheets in Drive and sharing them with your friends and the public</h2></div></div></div><p>Here<a class="indexterm" id="id29"/> are the <a class="indexterm" id="id30"/>steps to create a Google<a class="indexterm" id="id31"/> Sheet:</p><div><ol class="orderedlist arabic"><li class="listitem">Run <a class="indexterm" id="id32"/>your favorite<a class="indexterm" id="id33"/> browser and type <a class="ulink" href="https://drive.google.com/">https://drive.google.com/</a> in the address bar.<div><div><h3 class="title"><a id="tip02"/>Tip</h3><p>In order to use Google Drive, you should have a Google account. If you don't have an account, then create one.</p></div></div></li><li class="listitem">Now the<a class="indexterm" id="id34"/> Google Drive page will open. In the<a class="indexterm" id="id35"/> left pane, click on the <strong>NEW</strong> button and on <strong>Google Sheets</strong>:<div><img alt="Creating Google Sheets in Drive and sharing them with your friends and the public" src="img/B05010_01_04.jpg"/></div></li><li class="listitem">After<a class="indexterm" id="id36"/> creating a new Sheet, right-click on it (Windows) or context click (Mac) and select the <strong>Share...</strong> option:<div><img alt="Creating Google Sheets in Drive and sharing them with your friends and the public" src="img/B05010_01_05.jpg"/></div></li><li class="listitem">A new<a class="indexterm" id="id37"/> pop-up window will open as<a class="indexterm" id="id38"/> shown in the following screenshot. After that, enter the e-mail address, or<a class="indexterm" id="id39"/> addresses, with which you would like to share the document. Finally, click on the <strong>Done</strong> button:<div><img alt="Creating Google Sheets in Drive and sharing them with your friends and the public" src="img/B05010_01_06.jpg"/></div><p>Google will send a share notification to your friend(s). When your friend(s) click <a class="indexterm" id="id40"/>on the access link provided, they will get access to your document.</p></li></ol></div><p>Congratulations! You have<a class="indexterm" id="id41"/> created a new Sheet and successfully shared<a class="indexterm" id="id42"/> it with your friend(s).</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec16"/>Script projects</h1></div></div></div><p>Scripts are organized <a class="indexterm" id="id43"/>as projects. Projects can be of two types, standalone and bounded to a <code class="literal">gtype</code> (Google Drive native file type, such as Sheets, Docs, and Forms) file. Standalone scripts are created in a separate script file, you can see these files listed among other files in Drive. Bounded scripts are embedded within individual <code class="literal">gtype</code> files and created using the respective applications. As you can see, the standalone script files, among other files in Drive, you can open directly from Drive, but bounded script can be opened within respective applications only. However, bounded script will have more privileges over parent file than standalone scripts. For example, you can get access to the active document within bounded scripts, but not within standalone scripts.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Creating standalone script projects</h2></div></div></div><p>To create a standalone script file follow<a class="indexterm" id="id44"/> these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Follow the steps as described in the <em>Creating Google Sheets in Drive and sharing them with your friends and the public</em> section.</li><li class="listitem">Navigate to <strong>NEW</strong> | <strong>More</strong> | <strong>Google Apps Script</strong> rather than the spreadsheet, as shown in<a class="indexterm" id="id45"/> the following screenshot:<div><img alt="Creating standalone script projects" src="img/B05010_01_14.jpg"/></div></li><li class="listitem">A new untitled project will open in a new browser tab or window. The new project includes one code file, <code class="literal">Code.gs</code>, with a blank function, <code class="literal">myFunction</code>, as shown in the following screenshot:<div><img alt="Creating standalone script projects" src="img/B05010_01_09.jpg"/></div></li><li class="listitem">To save or rename the new project, press <em>Ctrl</em> + <em>S</em> on your keyboard or click on the <strong>Save</strong> icon (floppy disk) in the editor. If you are saving the project for the first time<a class="indexterm" id="id46"/> then a prompt will appear to enter a new project name. Enter the project name (whatever you like) and click on the <strong>OK</strong> button. The new script file will be saved in the current folder:<div><img alt="Creating standalone script projects" src="img/B05010_01_10.jpg"/></div></li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Creating new projects in Sheets</h2></div></div></div><p>Create a new <a class="indexterm" id="id47"/>Sheet or open the existing one. You will see a<a class="indexterm" id="id48"/> number of menu items at the top of the window. Now, follow these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Click on <strong>Tools</strong> and select <strong>Script editor...</strong>, as shown in the following screenshot:<div><img alt="Creating new projects in Sheets" src="img/B05010_01_07.jpg"/></div></li><li class="listitem">A new <a class="indexterm" id="id49"/>browser tab or window with a new <a class="indexterm" id="id50"/>project selection dialog will appear, as shown in the following screenshot:<div><img alt="Creating new projects in Sheets" src="img/B05010_01_08.jpg"/></div></li><li class="listitem">Click on <strong>Blank Project</strong> or close the dialog (you do not need to always select <strong>Blank Project</strong>, just this time). A new <a class="indexterm" id="id51"/>untitled project will open in a new browser tab/window.</li><li class="listitem">Save the <a class="indexterm" id="id52"/>project as described in the preceding section.<div><div><h3 class="title"><a id="tip03"/>Tip</h3><p>Although you can create as many bounded projects as you like, one project per file is enough. Creating just one project per file may help you to avoid problems with duplicate function and variable names.</p></div></div></li></ol></div><p>Congratulations! You have created a new script project. By following the preceding steps you can create script projects in Docs and Forms too.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Creating a custom formula in Sheets</h2></div></div></div><p>Open the <a class="indexterm" id="id53"/>spreadsheet you created earlier and make the following changes:</p><div><ol class="orderedlist arabic"><li class="listitem">In columns <em>A</em> and <em>B</em>, type a few first and last names.</li><li class="listitem">In cell <em>C2</em>, type (including the equals sign) <code class="literal">=CONCATENATE(A2," ", B2)</code>.</li></ol></div><p>Now you can see the first name and last name in cells <em>A2</em> and <em>B2</em> respectively, concatenated with <a class="indexterm" id="id54"/>a space in between.</p><p>
<code class="literal">CONCATENATE</code> is Google Sheet's built-in formula. You can also create your own, called custom formula:</p><div><ol class="orderedlist arabic"><li class="listitem">Open the script editor and copy-paste this code:<div><pre class="programlisting">function myFunction(s1,s2) {
  return s1 + " " + s2;
}</pre></div><p>Here is the screenshot for the same:</p><div><img alt="Creating a custom formula in Sheets" src="img/B05010_01_11.jpg"/></div></li><li class="listitem">Press <em>Ctrl</em> + <em>S</em> on your keyboard or click on the <strong>Save</strong> icon in the editor to save the script.</li><li class="listitem">Now return to the spreadsheet, and in cell <em>C2</em>, type <code class="literal">=myFunction(A2,B2)</code>.<p>This works in exactly the same way as the built-in formula. You can extend your formula to other cells below <em>C2</em>. This is a simple formula, but you can create complex formulae as per your requirements.</p></li><li class="listitem">Your custom<a class="indexterm" id="id55"/> formula should return a single value or a two-dimensional array. The following <a class="indexterm" id="id56"/>screenshot shows how a custom function will work:<div><img alt="Creating a custom formula in Sheets" src="img/B05010_01_12.jpg"/></div></li></ol></div><p>Congratulations! You have created a custom formula.</p><div><div><h3 class="title"><a id="note03"/>Note</h3><p>To add code completion and/or tooltips for your custom function, add the following comments at the preceding lines of code in the function:</p><div><pre class="programlisting">/**
 * Concatenates two strings
 *
 * @customfunction
 */
function myFunction(s1,s2){
      …</pre></div></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec17"/>Google Forms</h1></div></div></div><p>Google Forms is a Google App that <a class="indexterm" id="id57"/>you can use to collect information from your users. User responses or answers are collected and stored as responses in the Form itself and then can be populated in the connected Sheet. You can also change the response's target Sheet when required. You can create Google Forms dynamically using GAS.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Creating Forms within Google Sheet</h2></div></div></div><p>In the spreadsheet <a class="indexterm" id="id58"/>you created earlier, click on the <strong>Tools</strong> menu and select the <strong>Create a form</strong> option. A new Form will be created and is<a class="indexterm" id="id59"/> bound to a new Sheet automatically. The new Sheet's name will be similar to <code class="literal">Form Responses 1</code>. In the new Form, create form fields with headings exactly same as in the Sheet's column headers:</p><div><img alt="Creating Forms within Google Sheet" src="img/B05010_01_13.jpg"/></div><p>On completion, try submitting the data using a live Form.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec14"/>Some research</h2></div></div></div><p>If you are given a document's ID or key, something like <code class="literal">11CEeHWygGKqxGS7jmQzLpeO7Fs3cjetT4HTrWXHTDSU</code>, can you open the document, provided it has been shared <a class="indexterm" id="id60"/>with the public?</p><div><div><h3 class="title"><a id="tip04"/>Tip</h3><p>Every Google Doc, Sheet, folder, and project has an ID or key, which you can get from the corresponding item's URL.</p></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec18"/>Summary</h1></div></div></div><p>In this chapter, you learned about Google Apps and got an introduction to GAS, as well as how to create a project and custom formulas. There are many more Google Apps available but we just covered the most popular ones. It will not be hard to adopt the same scripting concepts and principles for other Apps. In the next chapter, you will learn to create basic elements such as custom menus, dialogs, and sidebars.</p></div></body></html>