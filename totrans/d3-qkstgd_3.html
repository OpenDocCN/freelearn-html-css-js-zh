<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Building an Interactive Scatter Plot</h1>
                </header>
            
            <article>
                
<p>Let's pretend we've started jogging and we want to visualize the data regarding our progress as a runner, with a scatter plot. We're going to have an array of objects, each with a date and distance properties. For each object in the array, we're going to create a circle in our SVG. If the <kbd>distance</kbd> property of an object is relatively high, its associated circle will be higher up on the graph. If the <kbd>date</kbd> property of an object is relatively high (a later date), its associated circle will be farther right.</p>
<p class="mce-root">By the end of this lesson, you should be able to do the following:</p>
<ul>
<li>Add a link to the D3 library</li>
<li>Add an<kbd>&lt;svg&gt;</kbd>tag and size it with D3</li>
<li>Create some fake data for our app</li>
<li>Add SVG circles and style them</li>
<li>Create a linear scale</li>
<li>Attach data to visual elements</li>
<li>Use data attached to a visual element to affect its appearance</li>
<li>Create a time scale</li>
<li>Parse and format times</li>
<li>Set dynamic domains</li>
<li>Dynamically generate SVG elements</li>
<li>Create axes</li>
<li>Display data in a table</li>
</ul>
<p><span>The complete code for this section can be found here: <a href="https://github.com/PacktPublishing/D3.js-Quick-Start-Guide/tree/master/Chapter03">https://github.com/PacktPublishing/D3.js-Quick-Start-Guide/tree/master/Chapter03</a>.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding a link to the D3 library</h1>
                </header>
            
            <article>
                
<p>The first thing we want to do is create a basic <kbd>index.html</kbd> file:</p>
<pre>&lt;!<span class="pl-ent">DOCTYPE</span> <span class="pl-e">html</span>&gt;
&lt;<span class="pl-ent">html</span>&gt;
    &lt;<span class="pl-ent">head</span>&gt;
        &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">title</span>&gt;&lt;/<span class="pl-ent">title</span>&gt;
    &lt;/<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">body</span>&gt;
    &lt;/<span class="pl-ent">body</span>&gt;
&lt;/<span class="pl-ent">html</span>&gt;</pre>
<p>Now add a link to D3 at the bottom of your <kbd>&lt;body&gt;</kbd> tag in <kbd>index.html</kbd>. We'll put it at the bottom so that the script loads after all your other HTML elements have loaded into the browser:</p>
<pre>&lt;<span class="pl-ent">body</span>&gt;    
    &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>https://d3js.org/d3.v5.min.js<span class="pl-pds">"</span></span>&gt;<span class="pl-s1">&lt;</span>/<span class="pl-ent">script</span>&gt;
&lt;/<span class="pl-ent">body</span>&gt;</pre>
<p>Now create <kbd>app.js</kbd> in the same folder as your <kbd>index.html</kbd>. In it, we will store all of our JS code. For now, just put this code in it to see whether it works:</p>
<pre><span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>this works<span class="pl-pds">'</span></span>);
<span class="pl-en">console</span>.<span class="pl-c1">log</span>(d3);</pre>
<p>Link to it in <kbd>index.html</kbd> at the bottom of the <kbd>&lt;body&gt;</kbd> tag. Make sure it comes after the D3 script tag so that D3 loads before your <kbd>app.js</kbd> script:</p>
<pre>&lt;<span class="pl-ent">body</span>&gt;
    &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>https://d3js.org/d3.v5.min.js<span class="pl-pds">"</span></span>&gt;<span class="pl-s1">&lt;</span>/<span class="pl-ent">script</span>&gt;
    &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>app.js<span class="pl-pds">"</span></span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span>&gt;<span class="pl-s1">&lt;</span>/<span class="pl-ent">script</span>&gt;
&lt;/<span class="pl-ent">body</span>&gt;</pre>
<p>Open <kbd>index.html</kbd> in Chrome just as we did in <a href="f40fadd5-f40b-43dc-a82d-206aac322123.xhtml">Chapter 2</a>, <em>Using SVG to Create Images Using Code</em>, (<strong>File</strong> | <strong>Open File</strong>), and check your Dev Tools (<strong>View</strong> | <strong>Developer</strong> | <strong>Developer tools</strong>) to see whether your JavaScript files are linked correctly:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-371 image-border" src="assets/45970fd8-68f3-4156-bf2f-70e8a9b48b1c.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding an&lt;svg&gt;tag and sizing it with D3</h1>
                </header>
            
            <article>
                
<p>In <kbd>&lt;indexentry content=" tag:sizing, with D3"&gt;</kbd> the <kbd>index.html</kbd>, at the top of <kbd>&lt;body&gt;</kbd>, before <kbd>&lt;indexentry content=" tag:adding"&gt;</kbd> your script tags, add an <kbd>&lt;svg&gt;</kbd> tag:</p>
<pre>&lt;<span class="pl-ent">body</span>&gt;
    &lt;<span class="pl-ent">svg</span>&gt;&lt;/<span class="pl-ent">svg</span>&gt;
    &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>https://d3js.org/d3.v5.min.js<span class="pl-pds">"</span></span>&gt;<span class="pl-s1">&lt;</span>/<span class="pl-ent">script</span>&gt;
    &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>app.js<span class="pl-pds">"</span></span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span>&gt;<span class="pl-s1">&lt;</span>/<span class="pl-ent">script</span>&gt;
&lt;/<span class="pl-ent">body</span>&gt;</pre>
<p>If we examine the <strong>Elements </strong>tab of our dev tools, we'll <kbd>&lt;indexentry content=" tag:adding"&gt;</kbd> see the <kbd>svg</kbd> element has <kbd>&lt;indexentry content=" tag:sizing, with D3"&gt;</kbd> been placed. In Chrome, it has a default width/height of 300 px/150 px:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-372 image-border" src="assets/87f192b1-16cf-4835-a11d-30160d13d466.png" style=""/></div>
<p>In <kbd>app.js</kbd>, remove your previous <kbd>console.log</kbd> statements and create variables to hold the width and height of the <kbd>&lt;svg&gt;</kbd> tag:</p>
<pre><span class="pl-k">var</span> <span class="pl-c1">WIDTH</span> <span class="pl-k">=</span> <span class="pl-c1">800</span>;
<span class="pl-k">var</span> <span class="pl-c1">HEIGHT</span> <span class="pl-k">=</span> <span class="pl-c1">600</span>;</pre>
<p>Next, we can use <kbd>d3.select()</kbd> to select a single element, in this case the <kbd>&lt;svg&gt;</kbd> element:</p>
<pre><span class="pl-k">var</span> <span class="pl-c1">WIDTH</span> <span class="pl-k">=</span> <span class="pl-c1">800</span>;
<span class="pl-k">var</span> <span class="pl-c1">HEIGHT</span> <span class="pl-k">=</span> <span class="pl-c1">600</span>;

<span class="pl-smi">d3</span>.<span class="pl-c1">select</span>(<span class="pl-s"><span class="pl-pds">'</span>svg<span class="pl-pds">'</span></span>);</pre>
<p>The return value of <kbd>d3.select('svg')</kbd> is a D3 version of the svg element (as in jQuery), so we can chain commands onto this. Let's add some styling to adjust the height/width of the element:</p>
<pre><span class="pl-smi">d3</span>.<span class="pl-c1">select</span>(<span class="pl-s"><span class="pl-pds">'</span>svg<span class="pl-pds">'</span></span>)
    .<span class="pl-c1">style</span>(<span class="pl-s"><span class="pl-pds">'</span>width<span class="pl-pds">'</span></span>, <span class="pl-c1">WIDTH</span>)
    .<span class="pl-c1">style</span>(<span class="pl-s"><span class="pl-pds">'</span>height<span class="pl-pds">'</span></span>, <span class="pl-c1">HEIGHT</span>);</pre>
<p>Now, when we check the dev tools, we'll see the <kbd>&lt;svg&gt;</kbd> element has been resized:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-373 image-border" src="assets/96cba3c4-fabf-4d03-9708-d0d978fd01e9.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating some fake data for our app</h1>
                </header>
            
            <article>
                
<p>In <kbd>app.js</kbd>, let's create an array of <kbd>run</kbd> objects, I am storing the date as a string on purpose also, it's important that this is an array of objects, to work with D3). Here's what your <kbd>app.js</kbd> code should look like so far:</p>
<pre><span class="pl-k">var</span> <span class="pl-c1">WIDTH</span> <span class="pl-k">=</span> <span class="pl-c1">800</span>;
<span class="pl-k">var</span> <span class="pl-c1">HEIGHT</span> <span class="pl-k">=</span> <span class="pl-c1">600</span>;

<span class="pl-k">var</span> runs <span class="pl-k">=</span> [
    {
        id<span class="pl-k">:</span> <span class="pl-c1">1</span>,
        date<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>October 1, 2017 at 4:00PM<span class="pl-pds">'</span></span>,
        distance<span class="pl-k">:</span> <span class="pl-c1">5.2</span>
    },
    {
        id<span class="pl-k">:</span> <span class="pl-c1">2</span>,
        date<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>October 2, 2017 at 5:00PM<span class="pl-pds">'</span></span>,
        distance<span class="pl-k">:</span> <span class="pl-c1">7.0725</span>
    },
    {
        id<span class="pl-k">:</span> <span class="pl-c1">3</span>,
        date<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>October 3, 2017 at 6:00PM<span class="pl-pds">'</span></span>,
        distance<span class="pl-k">:</span> <span class="pl-c1">8.7</span>
    }
];

<span class="pl-smi">d3</span>.<span class="pl-c1">select</span>(<span class="pl-s"><span class="pl-pds">'</span>svg<span class="pl-pds">'</span></span>)
    .<span class="pl-c1">style</span>(<span class="pl-s"><span class="pl-pds">'</span>width<span class="pl-pds">'</span></span>, <span class="pl-c1">WIDTH</span>)
    .<span class="pl-c1">style</span>(<span class="pl-s"><span class="pl-pds">'</span>height<span class="pl-pds">'</span></span>, <span class="pl-c1">HEIGHT</span>);</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding SVG circles and styling them</h1>
                </header>
            
            <article>
                
<p>In <kbd>index.html</kbd>, add three circles to your <kbd>&lt;svg&gt;</kbd> element (each one will represent a run):</p>
<pre>&lt;<span class="pl-ent">svg</span>&gt;
    &lt;<span class="pl-ent">circle</span>/&gt;
    &lt;<span class="pl-ent">circle</span>/&gt;
    &lt;<span class="pl-ent">circle</span>/&gt;
&lt;/<span class="pl-ent">svg</span>&gt;</pre>
<p>Create <kbd>app.css</kbd> <span>in the same folder as <kbd>index.html</kbd>, </span>with some styling for the circles and our <kbd>svg</kbd> element:</p>
<pre><span class="pl-ent">circle</span> {
    <span class="pl-c1">r</span>:<span class="pl-c1">5</span>;
    <span class="pl-c1">fill</span>: <span class="pl-c1">black</span>;
}
<span class="pl-ent">svg</span> {
    <span class="pl-c1">border</span>: <span class="pl-c1">1<span class="pl-k">px</span></span> <span class="pl-c1">solid</span> <span class="pl-c1">black</span>;
}</pre>
<p>Link to it in the head of <kbd>index.html</kbd>:</p>
<pre>&lt;<span class="pl-ent">head</span>&gt;
    &lt;<span class="pl-ent">meta</span> <span class="pl-e">charset</span>=<span class="pl-s"><span class="pl-pds">"</span>utf-8<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">title</span>&gt;&lt;/<span class="pl-ent">title</span>&gt;
    &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>stylesheet<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>app.css<span class="pl-pds">"</span></span>&gt;
&lt;/<span class="pl-ent">head</span>&gt;</pre>
<p>Our page should now look as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-374 image-border" src="assets/256cdb29-f354-48d4-a6c7-f5025e279b3b.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a linear scale</h1>
                </header>
            
            <article>
                
<p>We currently have three circles in our SVG and three objects in our <kbd>runs</kbd> array. One of the best things D3 does is provide the ability to link SVG elements with data so that as the data changes so do the SVG elements. In this chapter, we're going to link each circle to an object in the <kbd>runs</kbd> array. If the <kbd>distance</kbd> property of an object is relatively high, its associated circle will be higher up on the graph. If the <kbd>date</kbd> property of an object is relatively high (a later date), its associated circle is farther right.</p>
<p>First, let's position the circles vertically, based on the <kbd>distance</kbd> property of the objects in our <kbd>runs</kbd> array. One of the most important things that D3 does is provide the ability to convert (or <kbd>map</kbd>) data values to visual points and vice versa. It does so using a <kbd>scale</kbd>. There are lots of different kinds of scales that handle lots of different data types, but for now we're just going to use a <kbd>linear scale</kbd>, which will map numeric data values to numeric visual points, and vice versa.</p>
<p>At the bottom of <kbd>app.js</kbd>, add the following:</p>
<pre><span class="pl-k">var</span> yScale <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">scaleLinear</span>(); <span class="pl-c">//create the scale</span> </pre>
<p>Whenever we create a scale, we need to tell it the minimum and maximum possible values that can exist in our data (this is called the <kbd>domain</kbd>). To do so for our <kbd>yScale</kbd>, add the following to the bottom of <kbd>app.js</kbd>:</p>
<pre><span class="pl-smi">yScale</span>.<span class="pl-en">domain</span>([<span class="pl-c1">0</span>, <span class="pl-c1">10</span>]); <span class="pl-c">//minimum data value is 0, max is 10</span></pre>
<p>We also need to tell the scale what visual values correspond to those min/max values in the data (this is called the <kbd>range</kbd>). To do so<span>, add the following to the bottom of </span><kbd>app.js</kbd><span>:</span></p>
<pre><span class="pl-smi">//HEIGHT corresponds to min data value<br/>//0 corresponds to max data value<br/>yScale</span>.<span class="pl-en">range</span>([<span class="pl-c1">HEIGHT</span>, <span class="pl-c1">0</span>]); </pre>
<p><span>Your last three lines of code in </span><kbd>app.js</kbd> <span>should now look as follows:</span></p>
<pre>var yScale = d3.scaleLinear(); //create the scale<br/>yScale.domain([0, 10]); //minimum data value is 0, max is 10<br/>//HEIGHT corresponds to min data value<br/>//0 corresponds to max data value<br/>yScale.range([HEIGHT, 0]);</pre>
<p><span>In the previous snippet, the first (starting) value for the range is</span> <kbd>HEIGHT</kbd> <span>(600) and the second (ending) value is 0. The minimum for the data values is 0 and the max is 10. By doing this, we're saying that a data point (distance run) of 0 should map to a visual height value of</span> <kbd>HEIGHT</kbd> <span>(600):</span></p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-375 image-border" src="assets/b60104e3-ce39-4a3d-b84d-0b15931fe714.png" style=""/></div>
<p>This is because the lower the distance run (data value), the more we want to move the visual point down the <em>y</em> axis. Remember that the <em>y</em> axis starts with 0 at the top and increases in value as we move down vertically on the screen.</p>
<p><span>We also say that a data point (distance run) of 10 should map to a visual height of 0:</span></p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-376 image-border" src="assets/ec87518e-3736-41cc-80a4-f3dba371424d.png" style=""/></div>
<p>Again, this is because, as the distance run increases, we want to get back a visual value that is lower and lower so that our circles are closer to the top of the screen.</p>
<p>If you ever need to remind yourself what the domain/range is, you can do so by logging <kbd>yScale.domain()</kbd> or <kbd>yScale.range()</kbd>. Temporarily add the following at the bottom <kbd>app.js</kbd>:</p>
<pre><span class="pl-c">//you can get the domain whenever you want like this</span><span class="pl-en"><br/>console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">yScale</span>.<span class="pl-en">domain</span>());<br/><span class="pl-c">//you can get the range whenever you want like this:<br/></span><span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">yScale</span>.<span class="pl-en">range</span>());</pre>
<p>Our Chrome console should look as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-682 image-border" src="assets/09e09dd5-9765-4dcf-b00a-9aafb3681bcd.png" style=""/></div>
<p class="mce-root">When declaring the range/domain of a linear scale, we only need to specify start/end values for each. Values in between the <span>start/end</span> will be calculated by D3. For instance, to find out what visual value corresponds to the distance value of 5, use <kbd>yScale()</kbd>. Remove the previous two <kbd>console.log()</kbd> statements and add the following to the bottom of <kbd>app.js</kbd>:</p>
<pre><span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-en">yScale</span>(<span class="pl-c1">5</span>)); <span class="pl-c">//get a visual point from a data value</span></pre>
<p>Here's what our dev console should look like in Chrome:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-686 image-border" src="assets/ea310230-6299-4cbf-a70e-e7ff2fbd796d.png" style=""/></div>
<p>It makes sense that this logs <kbd>300</kbd> because the data value of <kbd>5</kbd> is half way between the minimum data value of <kbd>0</kbd> and the maximum data value of <kbd>10</kbd>. The range starts at <kbd>HEIGHT</kbd> (600) and goes to <kbd>0</kbd>, so halfway between those values is 300.</p>
<p>So, whenever you want to convert a data point to a visual point, call <kbd>yScale()</kbd>. We can go the other way and convert a visual point to a data value by calling <kbd>yScale.invert()</kbd>. To find out what data point corresponds to a visual value of 450, remove the previous <kbd>console.log()</kbd> statement and add the following to the bottom of <kbd>app.js</kbd>:</p>
<pre><span class="pl-c">//get a data values from a visual point</span><span class="pl-en"><br/>console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">yScale</span>.<span class="pl-en">invert</span>(<span class="pl-c1">450</span>));</pre>
<p>Here's what Chrome's console looks like:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-379 image-border" src="assets/8c887bf3-a317-481c-8e56-acc4bfa6639f.png" style=""/></div>
<p>It makes sense that this logs <kbd>2.5</kbd> because the visual value of 450 is 25% of the way from the starting visual value of 600 (<kbd>HEIGHT</kbd>)to the ending visual value of <kbd>0</kbd>. You can now delete that last <kbd>console.log()</kbd> line.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Attaching data to visual elements</h1>
                </header>
            
            <article>
                
<p>Now let's attach each of the JavaScript objects in our <kbd>runs</kbd> array to a circle in our SVG. Once we do this, each circle can access the data of its associated <kbd>run</kbd> object to determine its position. Add the following to the bottom of <kbd>app.js</kbd>:</p>
<pre><span class="pl-smi">yScale</span>.<span class="pl-en">range</span>([<span class="pl-c1">HEIGHT</span>, <span class="pl-c1">0</span>]);
<span class="pl-smi">yScale</span>.<span class="pl-en">domain</span>([<span class="pl-c1">0</span>, <span class="pl-c1">10</span>]);<br/><span class="pl-c">//selectAll is like select,<br/>//but it selects all elements that match the query string<br/></span><span class="pl-smi">d3</span>.<span class="pl-en">selectAll</span>(<span class="pl-s"><span class="pl-pds">'</span>circle<span class="pl-pds">'</span></span>).<span class="pl-c1">data</span>(runs);</pre>
<p>If there were more objects in our <kbd>runs</kbd> array than there are circles, the extra objects are ignored. If there are more circles than objects, then JavaScript objects are attached to circles in the order in which they appear in the DOM until there are no more objects to attach.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Use data attached to a visual element to affect its appearance</h1>
                </header>
            
            <article>
                
<p>We can change attributes for a selection of DOM elements by passing static values, and all selected elements will have that attribute set to that one specific value. Add the following temporarily to the end of <kbd>app.js</kbd>:</p>
<pre><span class="pl-smi">d3</span>.<span class="pl-en">selectAll</span>(<span class="pl-s"><span class="pl-pds">'</span>circle<span class="pl-pds">'</span></span>).<span class="pl-en">attr</span>(<span class="pl-s"><span class="pl-pds">'</span>cy<span class="pl-pds">'</span></span>, <span class="pl-c1">300</span>);</pre>
<p class="mce-root"/>
<p>The following should be seen on your screen:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-380 image-border" src="assets/699f8f2c-89e5-4ffe-96a8-f81e7ade4939.png" style=""/></div>
<p>But now that each circle has one of our <kbd>runs</kbd> JavaScript data objects attached to it, we can set attributes on each circle using that data. We do that by passing the <kbd>.attr()</kbd> method a callback function instead of a static value for its second parameter. Remove <kbd>d3.selectAll('circle').attr('cy', 300);</kbd> and adjust the last line of <kbd>app.js</kbd> from <kbd>d3.selectAll('circle').data(runs);</kbd> to the following:</p>
<pre><span class="pl-smi">d3</span>.<span class="pl-en">selectAll</span>(<span class="pl-s"><span class="pl-pds">'</span>circle<span class="pl-pds">'</span></span>).<span class="pl-c1">data</span>(runs)
    .<span class="pl-en">attr</span>(<span class="pl-s"><span class="pl-pds">'</span>cy<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">datum</span>, <span class="pl-smi">index</span>){
        <span class="pl-k">return</span> <span class="pl-en">yScale</span>(<span class="pl-smi">datum</span>.<span class="pl-smi">distance</span>);
    });</pre>
<p>If we refresh the browser, this is what we should see:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-381 image-border" src="assets/a7dca9d4-aa18-47d5-93c1-8809a5fdfb95.png" style=""/></div>
<p>Let's examine what we just wrote. The callback function passed as the second parameter to <kbd>.attr()</kbd> runs on each of the visual elements selected (each of the <kbd>circle</kbd> elements in this case). During each execution of the callback, the return value of that callback function is then assigned to whatever aspect of the current element is being set (in this case the <kbd>cy</kbd> attribute).</p>
<p class="mce-root">The callback function takes two params:</p>
<ul>
<li class="mce-root">The individual <kbd>datum</kbd> object from the <kbd>runs</kbd> array that was attached to that particular visual element when we called <kbd>.data(runs)</kbd></li>
<li class="mce-root">The <kbd>index</kbd> of that <kbd>datum</kbd> in the<kbd>runs</kbd> array</li>
</ul>
<p class="mce-root">In summary, what this does is loop through each <kbd>circle</kbd> in the SVG. For each <kbd>circle</kbd>, it looks at the <kbd>run</kbd> object attached to that <kbd>circle</kbd> and finds its <kbd>distance</kbd> property. It then feeds that data value into <kbd>yScale()</kbd>, which then converts it into its corresponding visual point. That visual point is then assigned to that circle's <kbd>cy</kbd> attribute. Since each data object has a different <kbd>distance</kbd> value, each <kbd>circle</kbd> is placed differently, vertically.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a time scale</h1>
                </header>
            
            <article>
                
<p>Let's position the circles horizontally, based on the date that their associated run happened. First, create a time scale. This is like a linear scale, but instead of mapping numeric values to visual points, it maps dates to visual points. Add the following to the bottom of <kbd>app.js</kbd>:</p>
<pre><span class="pl-c">//scaleTime maps date values with numeric visual points</span><span class="pl-k"><br/>var</span> xScale <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">scaleTime</span>();<br/><span class="pl-smi">xScale</span>.<span class="pl-en">range</span>([<span class="pl-c1">0</span>,<span class="pl-c1">WIDTH</span>]); <br/><span class="pl-smi">xScale</span>.<span class="pl-en">domain</span>([<span class="pl-k">new</span> <span class="pl-en">Date</span>(<span class="pl-s"><span class="pl-pds">'</span>2017-10-1<span class="pl-pds">'</span></span>), <span class="pl-k">new</span> <span class="pl-en">Date</span>(<span class="pl-s"><span class="pl-pds">'</span>2017-10-31<span class="pl-pds">'</span></span>)]); <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-en">xScale</span>(<span class="pl-k">new</span> <span class="pl-en">Date</span>(<span class="pl-s"><span class="pl-pds">'</span>2017-10-28<span class="pl-pds">'</span></span>))); <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">xScale</span>.<span class="pl-en">invert</span>(<span class="pl-c1">400</span>));</pre>
<p>Here's what our console should look like:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-382 image-border" src="assets/6141d754-75a9-47bb-9594-8db2b41dd0f9.png" style=""/></div>
<p>You can now remove the two <kbd>console.log()</kbd> statements.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Parsing and formatting times</h1>
                </header>
            
            <article>
                
<p>Note that the <kbd>date</kbd> properties of the objects in our <kbd>runs</kbd> array are strings and not date objects. This is a problem because <kbd>xScale</kbd>, as with all time scales, expects its data values to be date objects. Fortunately, D3 provides us an easy way to convert strings to dates and vice versa. We'll use a specially formatted string, based on the documentation (<a href="https://github.com/d3/d3-time-format#locale_format">https://github.com/d3/d3-time-format#locale_format</a>), to tell D3 how to parse the <kbd>date</kbd> string properties of the objects in our <kbd>runs</kbd> array into actual JavaScript date objects. Add the following at the end of <kbd>app.js</kbd>:</p>
<pre><span class="pl-c">//this format matches our data in the runs array</span><span class="pl-k"><br/>var</span> parseTime <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">timeParse</span>(<span class="pl-s"><span class="pl-pds">"</span>%B%e, %Y at %-I:%M%p<span class="pl-pds">"</span></span>); <br/><span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-en">parseTime</span>(<span class="pl-s"><span class="pl-pds">'</span>October 3, 2017 at 6:00PM<span class="pl-pds">'</span></span>));<br/><span class="pl-k">var</span> formatTime <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">timeFormat</span>(<span class="pl-s"><span class="pl-pds">"</span>%B%e, %Y at %-I:%M%p<span class="pl-pds">"</span></span>);<br/><span class="pl-c">//this format matches our data in the runs array</span> <br/><span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-en">formatTime</span>(<span class="pl-k">new</span> <span class="pl-en">Date</span>()));</pre>
<p>Here's our Chrome console:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-383 image-border" src="assets/d423b3e5-d578-4b72-89c7-181d4ca448a6.png" style=""/></div>
<p>Let's use this when calculating <kbd>cx</kbd> attributes for our circles. Remove the last two <kbd>console.log()</kbd> statements, and add the following to the bottom of <kbd>app.js</kbd>:</p>
<pre><span class="pl-c">//use parseTime to convert the date string property on the datum object to a Date object.<br/>//xScale then converts this to a visual value</span><span class="pl-smi"><br/>d3</span>.<span class="pl-en">selectAll</span>(<span class="pl-s"><span class="pl-pds">'</span>circle<span class="pl-pds">'</span></span>)<br/>    .<span class="pl-en">attr</span>(<span class="pl-s"><span class="pl-pds">'</span>cx<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">datum</span>, <span class="pl-smi">index</span>){<br/>        <span class="pl-k">return</span> <span class="pl-en">xScale</span>(<span class="pl-en">parseTime</span>(<span class="pl-smi">datum</span>.<span class="pl-smi">date</span>));<br/>    });</pre>
<p>Here's what Chrome should look like:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-384 image-border" src="assets/669b1c8e-9a20-4c67-b62c-037eb47a57f8.png" style=""/></div>
<p class="mce-root">In summary, this selects all of the <kbd>circle</kbd> elements. It then sets the <kbd>cx</kbd> attribute of each <kbd>circle</kbd> to the result of a callback function. That callback function runs for each <kbd>circle</kbd> and takes the <kbd>run</kbd> data object associated with that <kbd>circle</kbd> and finds its <kbd>date</kbd> property (remember it's a string, for example, <kbd>'October 3, 2017 at 6:00PM'</kbd>). It passes that string value to <kbd>parseTime()</kbd> which then turns the string into an actual JavaScript date object. That date object is then passed to <kbd>xScale()</kbd>, which converts the date into a visual value. That visual value is then used for the <kbd>cx</kbd> attribute of whichever <kbd>circle</kbd> the callback function has just run on. Since each <kbd>date</kbd> property of the objects in the <kbd>runs</kbd> array is different, the <kbd>circles</kbd> have different horizontal locations.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Setting dynamic domains</h1>
                </header>
            
            <article>
                
<p>At the moment, we're setting arbitrary min/max values for the domains of both distance and date. D3 can find the min/max of a dataset, so that our graph displays just the data ranges we need. All we need to do is pass the min/max methods a callback that gets called for each item of data in the <kbd>runs</kbd> array. D3 uses the callback to determine which properties of the datum object to compare for min/max.</p>
<p class="mce-root">Go to this part of the code:</p>
<pre><span class="pl-k">var</span> yScale <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">scaleLinear</span>(); <span class="pl-c">//create the scale</span>
<span class="pl-smi">yScale</span>.<span class="pl-en">range</span>([<span class="pl-c1">HEIGHT</span>, <span class="pl-c1">0</span>]); <span class="pl-c">//set the visual range (for example 600 to 0)</span>
<span class="pl-smi">yScale</span>.<span class="pl-en">domain</span>([<span class="pl-c1">0</span>, <span class="pl-c1">10</span>]); <span class="pl-c">//set the data domain (for example 0 to 10)</span></pre>
<p>Change it to this:</p>
<pre><span class="pl-k">var</span> yScale <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">scaleLinear</span>(); <span class="pl-c">//create the scale</span>
<span class="pl-smi">yScale</span>.<span class="pl-en">range</span>([<span class="pl-c1">HEIGHT</span>, <span class="pl-c1">0</span>]); <span class="pl-c">//set the visual range (for example 600 to 0)</span>
<span class="pl-k">var</span> yMin <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">min</span>(runs, <span class="pl-k">function</span>(<span class="pl-smi">datum</span>, <span class="pl-smi">index</span>){<br/>    //compare distance properties of each item in the data array
    <span class="pl-k">return</span> <span class="pl-smi">datum</span>.<span class="pl-smi">distance</span>; 
})
<span class="pl-k">var</span> yMax <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">max</span>(runs, <span class="pl-k">function</span>(<span class="pl-smi">datum</span>, <span class="pl-smi">index</span>){<br/>    //compare distance properties of each item in the data array
    <span class="pl-k">return</span> <span class="pl-smi">datum</span>.<span class="pl-smi">distance</span>;
})<br/>//now that we have the min/max of the data set for distance,<br/>//we can use those values for the yScale domain
<span class="pl-smi">yScale</span>.<span class="pl-en">domain</span>([yMin, yMax]);<span class="pl-c"> </span>
<span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">yScale</span>.<span class="pl-en">domain</span>());</pre>
<p class="CDPAlignLeft CDPAlign">Chrome should look as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-385 image-border" src="assets/478f937b-f01f-4ef9-ad53-8b66bd233768.png" style=""/></div>
<p>Let's examine what we just wrote. The following code finds the minimum distance:</p>
<pre>var yMin = d3.min(runs, function(datum, index){<br/>    //compare distance properties of each item in the data array<br/>    return datum.distance; <br/>})</pre>
<p>D3 loops through the <kbd>runs</kbd> array (the first parameter) and calls the callback function (the second parameter) on each element of the array. The return value of that function is compared the return values of the callback function as it runs on the other elements. The lowest value is assigned to <kbd>yMin</kbd>. The same thing happens for <kbd>d3.max()</kbd> but with the highest value.</p>
<p>We can combine both the min/max functions into one <kbd>extent</kbd> function that returns an array that has the exact same structure as<kbd>[yMin, yMax]</kbd>. Let's look at the code we just wrote:</p>
<pre>var yScale = d3.scaleLinear(); //create the scale<br/>yScale.range([HEIGHT, 0]); //set the visual range (for example 600 to 0)<br/>var yMin = d3.min(runs, function(datum, index){<br/>    //compare distance properties of each item in the data array<br/>    return datum.distance;<br/>})<br/>var yMax = d3.max(runs, function(datum, index){<br/>    //compare distance properties of each item in the data array<br/>    return datum.distance; <br/>})<br/>//now that we have the min/max of the data set for distance<br/>//we can use those values for the yScale domain<br/>yScale.domain([yMin, yMax]);<br/>console.log(yScale.domain());</pre>
<p>Change the previous code to this:</p>
<pre><span class="pl-k">var</span> yScale <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">scaleLinear</span>(); <span class="pl-c">//create the scale</span>
<span class="pl-smi">yScale</span>.<span class="pl-en">range</span>([<span class="pl-c1">HEIGHT</span>, <span class="pl-c1">0</span>]); <span class="pl-c">//set the visual range (for example 600 to 0)</span>
<span class="pl-k">var</span> yDomain <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">extent</span>(runs, <span class="pl-k">function</span>(<span class="pl-smi">datum</span>, <span class="pl-smi">index</span>){<br/>    //compare distance properties of each item in the data array
    <span class="pl-k">return</span> <span class="pl-smi">datum</span>.<span class="pl-smi">distance</span>; 
})
<span class="pl-smi">yScale</span>.<span class="pl-en">domain</span>(yDomain);</pre>
<p>It's much shorter, right? Let's do the same for the xScale's domain. Go to this part of the code:</p>
<pre><span class="pl-k">//scaleTime maps date values with numeric visual points<br/>var</span> xScale <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">scaleTime</span>(); 
<span class="pl-smi">xScale</span>.<span class="pl-en">range</span>([<span class="pl-c1">0</span>,<span class="pl-c1">WIDTH</span>]);
<span class="pl-smi">xScale</span>.<span class="pl-en">domain</span>([<span class="pl-k">new</span> <span class="pl-en">Date</span>(<span class="pl-s"><span class="pl-pds">'</span>2017-10-1<span class="pl-pds">'</span></span>), <span class="pl-k">new</span> <span class="pl-en">Date</span>(<span class="pl-s"><span class="pl-pds">'</span>2017-10-31<span class="pl-pds">'</span></span>)]);
<br/>//this format matches our data in the runs array
<span class="pl-k">var</span> parseTime <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">timeParse</span>(<span class="pl-s"><span class="pl-pds">"</span>%B%e, %Y at %-I:%M%p<span class="pl-pds">"</span></span>);<br/>//this format matches our data in the runs array 
<span class="pl-k">var</span> formatTime <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">timeFormat</span>(<span class="pl-s"><span class="pl-pds">"</span>%B%e, %Y at %-I:%M%p<span class="pl-pds">"</span></span>); </pre>
<p>Change it to this:</p>
<pre><span class="pl-k">var</span> parseTime <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">timeParse</span>(<span class="pl-s"><span class="pl-pds">"</span>%B%e, %Y at %-I:%M%p<span class="pl-pds">"</span></span>);
<span class="pl-k">var</span> formatTime <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">timeFormat</span>(<span class="pl-s"><span class="pl-pds">"</span>%B%e, %Y at %-I:%M%p<span class="pl-pds">"</span></span>);
<span class="pl-k">var</span> xScale <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">scaleTime</span>();
<span class="pl-smi">xScale</span>.<span class="pl-en">range</span>([<span class="pl-c1">0</span>,<span class="pl-c1">WIDTH</span>]);
<span class="pl-k">var</span> xDomain <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">extent</span>(runs, <span class="pl-k">function</span>(<span class="pl-smi">datum</span>, <span class="pl-smi">index</span>){
    <span class="pl-k">return</span> <span class="pl-en">parseTime</span>(<span class="pl-smi">datum</span>.<span class="pl-smi">date</span>);
});
<span class="pl-smi">xScale</span>.<span class="pl-en">domain</span>(xDomain);</pre>
<p>Notice we moved <kbd>parseTime</kbd> and <kbd>formatTime</kbd> up so they could be used within the <kbd>.extent()</kbd>. Here's what Chrome should look like:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-386 image-border" src="assets/bab5bea3-f40d-4990-85dc-98cc8620c3eb.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Dynamically generating SVG elements</h1>
                </header>
            
            <article>
                
<p>Currently, we have just enough <kbd>&lt;circle&gt;</kbd> elements to fit our data. What if we don't want to count how many elements are in the array? D3 can create elements as needed. First, remove all <kbd>&lt;circle&gt;</kbd> elements from <kbd>index.html</kbd>. Your <kbd>&lt;body&gt;</kbd> tag should now look as follows:</p>
<pre>&lt;body&gt;<br/>    &lt;svg&gt;&lt;/svg&gt;<br/>    &lt;script src="https://d3js.org/d3.v5.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="app.js" charset="utf-8"&gt;&lt;/script&gt;<br/>&lt;/body&gt;</pre>
<p>In <kbd>app.js</kbd>, go to this part of the code:</p>
<pre><span class="pl-smi">d3</span>.<span class="pl-en">selectAll</span>(<span class="pl-s"><span class="pl-pds">'</span>circle<span class="pl-pds">'</span></span>).<span class="pl-c1">data</span>(runs)
    .<span class="pl-en">attr</span>(<span class="pl-s"><span class="pl-pds">'</span>cy<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">datum</span>, <span class="pl-smi">index</span>){
        <span class="pl-k">return</span> <span class="pl-en">yScale</span>(<span class="pl-smi">datum</span>.<span class="pl-smi">distance</span>);
    });</pre>
<p>Modify the code to create the circles:</p>
<pre><span class="pl-smi">//since no circles exist, we need to select('svg')<br/>//so that d3 knows where to append the new circles<br/>d3</span>.<span class="pl-c1">select</span>(<span class="pl-s"><span class="pl-pds">'</span>svg<span class="pl-pds">'</span></span>).<span class="pl-en">selectAll</span>(<span class="pl-s"><span class="pl-pds">'</span>circle<span class="pl-pds">'</span></span>)
    .<span class="pl-c1">data</span>(runs) <span class="pl-c">//attach the data as before<br/>    //find the data objects that have not yet <br/>    //been attached to visual elements</span>
    .<span class="pl-en">enter</span>()<br/>    //for each data object that hasn't been attached,<br/>    //append a &lt;circle&gt; to the &lt;svg&gt;
    .<span class="pl-c1">append</span>(<span class="pl-s"><span class="pl-pds">'</span>circle<span class="pl-pds">'</span></span>); 

<span class="pl-smi">d3</span>.<span class="pl-en">selectAll</span>(<span class="pl-s"><span class="pl-pds">'</span>circle<span class="pl-pds">'</span></span>)
    .<span class="pl-en">attr</span>(<span class="pl-s"><span class="pl-pds">'</span>cy<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">datum</span>, <span class="pl-smi">index</span>){
        <span class="pl-k">return</span> <span class="pl-en">yScale</span>(<span class="pl-smi">datum</span>.<span class="pl-smi">distance</span>);
    });</pre>
<p>It should look exactly the same as before, but now circles are being created for each object in the <kbd>runs</kbd> array:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-387 image-border" src="assets/db7816e0-542e-4435-9e8e-d6231c750d0b.png" style=""/></div>
<p>Here's a more in-depth explanation of what we just wrote. Take a look at the first line of the new code:</p>
<pre>d3.select('svg').selectAll('circle')</pre>
<p>This might seem unnecessary. Why not just do <kbd>d3.selectAll('circle')</kbd>? Well, at the moment, there are no <kbd>circle</kbd> elements. We're going to be appending <kbd>circle</kbd> elements dynamically, so <kbd>d3.select('svg')</kbd> tells D3 where to append them. We still need <kbd>.selectAll('circle')</kbd> though, so that when we call <kbd>.data(runs)</kbd> on the next line, D3 knows what elements to bind the various objects in the <kbd>runs</kbd> array to. But there aren't any <kbd>circle</kbd> elements to bind data to. That's OK.<kbd>.enter()</kbd> finds the <kbd>run</kbd> objects that haven't been bound to any <kbd>circle</kbd> elements yet (in this case all of them). We then use <kbd>.append('circle')</kbd> to append a circle for each unbound <kbd>run</kbd> object that <kbd>.enter()</kbd> found.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating axes</h1>
                </header>
            
            <article>
                
<p>D3 can automatically generate axes for you<span>. Add the following to the bottom of</span><kbd>app.js</kbd><span>:</span></p>
<pre><span class="pl-k">//pass the appropriate scale in as a parameter<br/>var</span> bottomAxis <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">axisBottom</span>(xScale);</pre>
<p>This creates a bottom axis generator that can be used to insert an axis into any element you choose. Add the following code to the bottom of <kbd>app.js</kbd> to append a <kbd>&lt;g&gt;</kbd> element inside our SVG element and then insert a bottom axis inside it:</p>
<pre><span class="pl-smi">d3</span>.<span class="pl-c1">select</span>(<span class="pl-s"><span class="pl-pds">'</span>svg<span class="pl-pds">'</span></span>)
    .<span class="pl-c1">append</span>(<span class="pl-s"><span class="pl-pds">'</span>g<span class="pl-pds">'</span></span>) <span class="pl-c">//put everything inside a group</span>
    .<span class="pl-c1">call</span>(bottomAxis); <span class="pl-c">//generate the axis within the group</span></pre>
<p>Here's what Chrome should look like:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-388 image-border" src="assets/f285b8a3-8fec-45d2-aeb3-05745e70867f.png" style=""/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Display of Chrome</div>
<p>We want the axis to be at the bottom of the SVG, though. Modify the code we just wrote so it looks like this (note: we removed a<kbd>;</kbd> after<kbd>.call(bottomAxis)</kbd> and added<kbd>.attr('transform', 'translate(0,'+HEIGHT+')');</kbd>):</p>
<pre><span class="pl-k">//pass the appropriate scale in as a parameter<br/>var</span> bottomAxis <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">axisBottom</span>(xScale); 
<span class="pl-smi">d3</span>.<span class="pl-c1">select</span>(<span class="pl-s"><span class="pl-pds">'</span>svg<span class="pl-pds">'</span></span>)
    .<span class="pl-c1">append</span>(<span class="pl-s"><span class="pl-pds">'</span>g<span class="pl-pds">'</span></span>) <span class="pl-c">//put everything inside a group</span>
    .<span class="pl-c1">call</span>(bottomAxis) <span class="pl-c">//generate the axis within the group<br/>    //move it to the bottom</span>
    .<span class="pl-en">attr</span>(<span class="pl-s"><span class="pl-pds">'</span>transform<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>translate(0,<span class="pl-pds">'</span></span><span class="pl-k">+</span><span class="pl-c1">HEIGHT</span><span class="pl-k">+</span><span class="pl-s"><span class="pl-pds">'</span>)<span class="pl-pds">'</span></span>); </pre>
<p>Currently, our SVG clips the axis:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5669c90a-9f8c-412c-9e94-004749f69f0b.png"/></div>
<p>Let's alter our <kbd>svg</kbd> CSS so it doesn't clip any elements that extend beyond its bounds:</p>
<pre><span class="pl-ent">svg</span> {
    <span class="pl-c1">overflow</span>: <span class="pl-c1">visible</span>;    
}</pre>
<p>Now it looks good:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-389 image-border" src="assets/dbf37e37-8453-47d8-96d2-e3320942021b.png" style=""/></div>
<p>The left axis is pretty similar. Add the following to the bottom of <kbd>app.js</kbd>:</p>
<pre><span class="pl-k">var</span> leftAxis <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-en">axisLeft</span>(yScale);
<span class="pl-smi">d3</span>.<span class="pl-c1">select</span>(<span class="pl-s"><span class="pl-pds">'</span>svg<span class="pl-pds">'</span></span>)
    .<span class="pl-c1">append</span>(<span class="pl-s"><span class="pl-pds">'</span>g<span class="pl-pds">'</span></span>)<br/>    //no need to transform, since it's placed correctly initially
    .<span class="pl-c1">call</span>(leftAxis); </pre>
<p>Note: we don't need to set a <kbd>transform</kbd> attribute, since it starts out in the correct place initially:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-695 image-border" src="assets/b2446c71-3c12-42e3-adeb-9e6e89b8edda.png" style=""/></div>
<p>It's a little tough to see, so let's add the following at the bottom of <kbd>app.css</kbd>:</p>
<pre><span class="pl-ent">body</span> {
    <span class="pl-c1">margin</span>: <span class="pl-c1">20<span class="pl-k">px</span></span> <span class="pl-c1">40<span class="pl-k">px</span></span>;
}</pre>
<p>Now our axes are complete:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-696 image-border" src="assets/79d82b84-83f6-42ee-a839-a10577191e0e.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Displaying data in a table</h1>
                </header>
            
            <article>
                
<p>Just for debugging purposes, let's create a table that will show all of our data. Make your <kbd>&lt;body&gt;</kbd> tag in <kbd>index.html</kbd> look as follows:</p>
<pre>&lt;body&gt;<br/>    &lt;svg&gt;&lt;/svg&gt;<br/>    &lt;table&gt;<br/>        &lt;thead&gt;<br/>            &lt;tr&gt;<br/>                &lt;th&gt;id&lt;/th&gt;<br/>                &lt;th&gt;date&lt;/th&gt;<br/>                &lt;th&gt;distance&lt;/th&gt;<br/>            &lt;/tr&gt;<br/>        &lt;/thead&gt;<br/>        &lt;tbody&gt;<br/>        &lt;/tbody&gt;<br/>    &lt;/table&gt;<br/>    &lt;script src="https://d3js.org/d3.v5.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="app.js" charset="utf-8"&gt;&lt;/script&gt;<br/>&lt;/body&gt;</pre>
<p>D3 can also be used to manipulate the DOM, just like jQuery. Let's populate the<kbd>&lt;tbody&gt;</kbd>in that style. Add the following to the bottom of <kbd>app.js</kbd>:</p>
<pre><span class="pl-k">var</span> <span class="pl-en">createTable</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(){
    <span class="pl-k">for</span> (<span class="pl-k">var</span> i <span class="pl-k">=</span> <span class="pl-c1">0</span>; i <span class="pl-k">&lt;</span> <span class="pl-smi">runs</span>.<span class="pl-c1">length</span>; i<span class="pl-k">++</span>) {
        <span class="pl-k">var</span> row <span class="pl-k">=</span> <span class="pl-smi">d3</span>.<span class="pl-c1">select</span>(<span class="pl-s"><span class="pl-pds">'</span>tbody<span class="pl-pds">'</span></span>).<span class="pl-c1">append</span>(<span class="pl-s"><span class="pl-pds">'</span>tr<span class="pl-pds">'</span></span>);
        <span class="pl-smi">row</span>.<span class="pl-c1">append</span>(<span class="pl-s"><span class="pl-pds">'</span>td<span class="pl-pds">'</span></span>).<span class="pl-en">html</span>(runs[i].<span class="pl-c1">id</span>);
        <span class="pl-smi">row</span>.<span class="pl-c1">append</span>(<span class="pl-s"><span class="pl-pds">'</span>td<span class="pl-pds">'</span></span>).<span class="pl-en">html</span>(runs[i].<span class="pl-smi">date</span>);
        <span class="pl-smi">row</span>.<span class="pl-c1">append</span>(<span class="pl-s"><span class="pl-pds">'</span>td<span class="pl-pds">'</span></span>).<span class="pl-en">html</span>(runs[i].<span class="pl-smi">distance</span>);
    }
}

<span class="pl-en">createTable</span>();</pre>
<p>Add some styling for the table at the bottom of <kbd>app.css</kbd>:</p>
<pre><span class="pl-ent">table</span>, <span class="pl-ent">th</span>, <span class="pl-ent">td</span> {
   <span class="pl-c1">border</span>: <span class="pl-c1">1<span class="pl-k">px</span></span> <span class="pl-c1">solid</span> <span class="pl-c1">black</span>;
}
<span class="pl-ent">th</span>, <span class="pl-ent">td</span> {
    <span class="pl-c1">padding</span>:<span class="pl-c1">10<span class="pl-k">px</span></span>;
    <span class="pl-c1">text-align</span>: <span class="pl-c1">center</span>;
}</pre>
<p>Adjust the CSS for <kbd>svg</kbd> to add a bottom margin. This will create some space between the graph and the table:</p>
<pre><span class="pl-ent">svg</span> {
    <span class="pl-c1">overflow</span>: <span class="pl-c1">visible</span>;
    <span class="pl-c1">margin-bottom</span>: <span class="pl-c1">50<span class="pl-k">px</span></span>;
}</pre>
<p>Now the browser should look like this:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-392 image-border" src="assets/f6ad7a6c-7b35-417a-a97b-a3b7008c7863.png" style=""/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>At this point, you have a static scatter plot and a table that displays its data. In <a href="e503bfe5-4b90-47eb-bae0-d588a9b545d5.xhtml">Chapter 4</a>, <em>Making a Basic Scatter Plot Interactive</em>, we will be learning how to make it interactive.</p>


            </article>

            
        </section>
    </body></html>