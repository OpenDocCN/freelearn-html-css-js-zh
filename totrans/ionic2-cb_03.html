<html><head></head><body><div class="chapter" title="Chapter&#xA0;3.&#xA0;Extending Ionic 2 with Angular 2 Building Blocks" id="aid-QMFO1"><div class="titlepage"><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Extending Ionic 2 with Angular 2 Building Blocks</h1></div></div></div><p>In this chapter, we will cover the following tasks related to creating custom components, directives, and filters with Angular 2:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Creating a custom pizza ordering component</li><li class="listitem">Creating a custom username input directive</li><li class="listitem">Creating a custom pipe</li><li class="listitem">Creating a shared service to provide data to multiple pages</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch03lvl1sec22"/>Introduction</h1></div></div></div><p>Most of Ionic's out-of-the-box features are actually prebuilt components. In this section, you will learn how to create your own custom component using the <code class="literal">html</code> template, which contains Ionic components as well.</p><p>Components actually define Angular 2. A component is no more than just a class with self-describing features. For example, <code class="literal">&lt;ul&gt;</code> is a component that you are already familiar with. Previously, you used various Ionic components, such as <code class="literal">&lt;ion-list&gt;</code> and <code class="literal">&lt;ion-item&gt;</code>. A component is <a id="id169" class="indexterm"/>a decorator (that is, <code class="literal">@Component</code>) to add metadata to a class to describe the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>selector</strong></span>: This is the name<a id="id170" class="indexterm"/> that is to be used in the DOM (for example, <code class="literal">&lt;my-component&gt;</code>)</li><li class="listitem"><span class="strong"><strong>template or templateUrl</strong></span>: This refers to<a id="id171" class="indexterm"/> the way the component is rendered</li><li class="listitem"><span class="strong"><strong>directives</strong></span>: This refers to<a id="id172" class="indexterm"/> a list of directive dependencies you plan to use inside the component</li><li class="listitem"><span class="strong"><strong>providers</strong></span>: This is a list <a id="id173" class="indexterm"/>of providers (that is, services) you plan to use inside the component</li></ul></div><p>Of course, there are many other options, but the preceding four options are the most common ones.</p></div></div>
<div class="section" title="Creating a custom pizza ordering component"><div class="titlepage" id="aid-RL0A2"><div><div><h1 class="title"><a id="ch03lvl1sec23"/>Creating a custom pizza ordering component</h1></div></div></div><p>In this section, you<a id="id174" class="indexterm"/> will build an app to demonstrate a custom component with its private variables and template. Observe the following screenshot of the pizza ordering component:</p><div class="mediaobject"><img src="../Images/image00240.jpeg" alt="Creating a custom pizza ordering component"/></div><p style="clear:both; height: 1em;"> </p><p>The user will not notice which area is a part of the page as opposed to a self-contained component. Your custom component here is the only area where the list is <span class="emphasis"><em>listening</em></span> to the <span class="strong"><strong>Vegetarian</strong></span> checkbox:</p><div class="mediaobject"><img src="../Images/image00241.jpeg" alt="Creating a custom pizza ordering component"/></div><p style="clear:both; height: 1em;"> </p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec42"/>Getting ready</h2></div></div></div><p>This app example could work either in a browser or in a physical device.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec43"/>How to do it...</h2></div></div></div><p>Perform the<a id="id175" class="indexterm"/> following instructions:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new <code class="literal">MyComponent</code> app using the <code class="literal">blank</code> template as shown, and go into the <code class="literal">MyComponent</code> folder:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic start MyComponent blank --v2</strong></span>
<span class="strong"><strong>$ cd MyComponent</strong></span>
</pre></div></li><li class="listitem">Open the <code class="literal">./app/pages/home/home.html</code> file and replace the content with the following code:<div class="informalexample"><pre class="programlisting">&lt;ion-header&gt;
  &lt;ion-navbar&gt;
    &lt;ion-title&gt;
      Pizza App
    &lt;/ion-title&gt;
  &lt;/ion-navbar&gt;
&lt;/ion-header&gt;

&lt;ion-content padding&gt;
  &lt;ion-card&gt;
    &lt;ion-card-header&gt;
      App Homepage
    &lt;/ion-card-header&gt;
    &lt;ion-card-content&gt;
      Please start to order your pizza now!
    &lt;/ion-card-content&gt;
  &lt;/ion-card&gt;

  &lt;my-component&gt;&lt;/my-component&gt;
&lt;/ion-content&gt;</pre></div><p>This is your root page containing <code class="literal">&lt;my-component&gt;</code>, which will be defined later.</p></li><li class="listitem">Open <code class="literal">./app/pages/home/home.ts</code> for editing <a id="id176" class="indexterm"/>globally with the following code:<div class="informalexample"><pre class="programlisting">import { Component } from '@angular/core';
import { NavController } from 'ionic-angular';
import { MyComponent } from '../../components/foo';

@Component({
  selector: 'page-home',
  templateUrl: 'home.html'
})
export class HomePage {

  constructor(public navCtrl: NavController) {
    
  }

}</pre></div><p>You simply have to declare <code class="literal">MyComponent</code> as a dependency. A component is basically just a directive with a template,  assuming you are familiar with the directive concept of Angular 1.</p></li><li class="listitem">Now, let's create the component by first creating a directive, as illustrated in the following code:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mkdir ./src/components</strong></span>
</pre></div></li><li class="listitem">Create a <code class="literal">foo.ts</code> file in the <code class="literal">components</code> directory that you just created, as shown in the following code:<div class="informalexample"><pre class="programlisting">import { Component } from '@angular/core';

@Component({
  selector: 'my-component',
  templateUrl: 'foo.html'
})
export class MyComponent {
  public data: any = {myToggle: true};

  constructor() {
  }
  
  isClicked(val) {
    console.log('Vegetarian: ' + val);
  }

}</pre></div></li><li class="listitem">Create <code class="literal">foo.html</code> in the <code class="literal">./src/components</code> folder, as<a id="id177" class="indexterm"/> follows:<div class="informalexample"><pre class="programlisting">&lt;ion-list&gt;
  &lt;ion-item&gt;
    &lt;ion-label&gt;Vegetarian&lt;/ion-label&gt;
    &lt;ion-toggle (click)="isClicked(data.myToggle)" [(ngModel)]="data.myToggle"&gt;&lt;/ion-toggle&gt;
  &lt;/ion-item&gt;
  
  &lt;ion-card *ngIf="data.myToggle"&gt;
    &lt;ion-card-header&gt;
      I only eat vegetarian foods
    &lt;/ion-card-header&gt;

    &lt;ion-list&gt;
      &lt;button ion-item&gt;
        Mushroom
      &lt;/button&gt;
      &lt;button ion-item&gt;
        Spinach
      &lt;/button&gt;
      &lt;button ion-item&gt;
        Red Peppers
      &lt;/button&gt;
    &lt;/ion-list&gt;
  &lt;/ion-card&gt;
  
  &lt;ion-card *ngIf="!data.myToggle"&gt;
    &lt;ion-card-header&gt;
      I love meat
    &lt;/ion-card-header&gt;

    &lt;ion-list&gt;
      &lt;button ion-item&gt;
        Beef
      &lt;/button&gt;
      &lt;button ion-item&gt;
        Chicken
      &lt;/button&gt;
      &lt;button ion-item&gt;
        Sausage
      &lt;/button&gt;
    &lt;/ion-list&gt;
  &lt;/ion-card&gt;
  
&lt;/ion-list&gt;</pre></div></li><li class="listitem">Modify <code class="literal">./src/app/app.module.ts</code>, as illustrated, so that you can declare <code class="literal">MyComponent</code>. Observe<a id="id178" class="indexterm"/> the following code:<div class="informalexample"><pre class="programlisting">import { NgModule } from '@angular/core';
import { IonicApp, IonicModule } from 'ionic-angular';
import { MyApp } from './app.component';
import { HomePage } from '../pages/home/home';
import { MyComponent } from '../components/foo';

@NgModule({
  declarations: [
    MyApp,
    HomePage,
    MyComponent
  ],
  imports: [
    IonicModule.forRoot(MyApp)
  ],
  bootstrap: [IonicApp],
  entryComponents: [
    MyApp,
    HomePage,
    MyComponent
  ],
  providers: []
})
export class AppModule {}</pre></div></li><li class="listitem">Go to your terminal and run the app using the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic serve</strong></span>
</pre></div></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec44"/>How it works…</h2></div></div></div><p>You may wonder why it's necessary to create a component just to toggle a list (of pizza topping options). The <a id="id179" class="indexterm"/>answer is that this is just a demonstration of how you can compartmentalize your app using a component. The key things that you have done are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">You created a custom component, called <code class="literal">&lt;my-component&gt;</code>, which can be used anywhere, including outside your app.</li><li class="listitem">The data within your component is completely private. This means that nobody else can access it without calling a method within your component's class.</li><li class="listitem">You can add or change behaviors within your component without impacting other areas outside the component.</li></ul></div><p>To create a component, you need to ensure that you import the <code class="literal">decorator</code>, as shown, from Angular 2 itself (and not from Ionic 2):</p><div class="informalexample"><pre class="programlisting">import { Component } from '@angular/core';

@Component({
  selector: 'my-component',
  templateUrl: 'foo.html'
})</pre></div><p>In your component template, everything is local to what is inside the component class. So, you can bind the click event using <code class="literal">click</code>, as shown in the following code:</p><div class="informalexample"><pre class="programlisting">  &lt;ion-item&gt;
    &lt;ion-label&gt;Vegetarian&lt;/ion-label&gt;
    &lt;ion-toggle (click)="isClicked(data.myToggle)" [(ngModel)]="data.myToggle"&gt;&lt;/ion-toggle&gt;
  &lt;/ion-item&gt;</pre></div><p>Just like Angular 1, you need to use <code class="literal">[(ngModel)]</code> to declare that you want <code class="literal">data.myToggle</code> to be your model. The <code class="literal">[(..)]</code> part is to tell Angular 2 that this is a two-way binding.</p><p>There are two lists of pizza toppings. The first one is as follows:</p><div class="informalexample"><pre class="programlisting">  &lt;ion-card *ngIf="data.myToggle"&gt;
    &lt;ion-card-header&gt;
      I only eat vegetarian foods
    &lt;/ion-card-header&gt;

    &lt;ion-list&gt;
      &lt;button ion-item&gt;
        Mushroom
      &lt;/button&gt;
      &lt;button ion-item&gt;
        Spinach
      &lt;/button&gt;
      &lt;button ion-item&gt;
        Red Peppers
      &lt;/button&gt;
    &lt;/ion-list&gt;
  &lt;/ion-card&gt;</pre></div><p>The second list of pizza toppings is as shown:</p><div class="informalexample"><pre class="programlisting">  &lt;ion-card *ngIf="!data.myToggle"&gt;
    &lt;ion-card-header&gt;
      I love meat
    &lt;/ion-card-header&gt;

    &lt;ion-list&gt;
      &lt;button ion-item&gt;
        Beef
      &lt;/button&gt;
      &lt;button ion-item&gt;
        Chicken
      &lt;/button&gt;
      &lt;button ion-item&gt;
        Sausage
      &lt;/button&gt;
    &lt;/ion-list&gt;
  &lt;/ion-card&gt;</pre></div><p>To toggle the <a id="id180" class="indexterm"/>visibility of each list based on the <code class="literal">data.myToggle</code> model, you can use <code class="literal">*ngIf</code>, which is very similar to <code class="literal">ng-if</code> from Angular 1.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec45"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">For more<a id="id181" class="indexterm"/> information about components in the Angular 2 documentation, you can visit <a class="ulink" href="https://angular.io/docs/ts/latest/guide/architecture.html">https://angular.io/docs/ts/latest/guide/architecture.html</a>.</li></ul></div></div></div>
<div class="section" title="Creating a custom username input directive"><div class="titlepage" id="aid-SJGS2"><div><div><h1 class="title"><a id="ch03lvl1sec24"/>Creating a custom username input directive</h1></div></div></div><p>Since you have<a id="id182" class="indexterm"/> gone through the process of creating a component in the preceding section, you may wonder what the difference is between a component and a directive. If you have some experience with Angular 1, you may notice that it had no definition of a component. Starting in Angular 2, there are the following three kinds of directive:</p><div class="informaltable"><table border="1"><colgroup><col/><col/></colgroup><thead><tr><th valign="bottom">
<p>Kind</p>
</th><th valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td valign="top">
<p>Components</p>
</td><td valign="top">
<p>They have a template and a class associated with the component (that is, <code class="literal">ion-input</code>)</p>
</td></tr><tr><td valign="top">
<p>Structural directives</p>
</td><td valign="top">
<p>They change the DOM structure within the scope of where it is (that is, <code class="literal">*ngIf</code> or <code class="literal">*ngFor</code>)</p>
</td></tr><tr><td valign="top">
<p>Attribute directives</p>
</td><td valign="top">
<p>They change the appearance of the current DOM by intercepting its display or events</p>
</td></tr></tbody></table></div><p>You may have a mix of <a id="id183" class="indexterm"/>both structural and attribute characteristics in the same directive. In this section, you will learn how to create an attribute directive that can prevent certain characters from being input in the <span class="strong"><strong>Username</strong></span> as well as showing another DOM node (where it says <span class="strong"><strong>You are typing username</strong></span>) by toggling its visibility. Observe the following screenshot of the app:</p><div class="mediaobject"><img src="../Images/image00242.jpeg" alt="Creating a custom username input directive"/></div><p style="clear:both; height: 1em;"> </p><p>The <span class="strong"><strong>GO</strong></span> button is there just for cosmetic purposes, and you will not need to write any code for it.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec46"/>Getting ready</h2></div></div></div><p>This app example<a id="id184" class="indexterm"/> could work either in a browser or on a physical device.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec47"/>How to do it...</h2></div></div></div><p>Observe the following instructions:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new <code class="literal">MyIonicInputDirective</code> app using the <code class="literal">blank</code> template, as shown, and go into the <code class="literal">MyIonicInputDirective</code> folder:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic start MyIonicInputDirective blank --v2</strong></span>
<span class="strong"><strong>$ cd MyIonicInputDirective</strong></span>
</pre></div></li><li class="listitem">Open the <code class="literal">./src/app/pages/home/home.html</code> file and replace the content with the following code:<div class="informalexample"><pre class="programlisting">&lt;ion-header&gt;
  &lt;ion-navbar color="danger"&gt;
    &lt;ion-title&gt;
      Login
    &lt;/ion-title&gt;
  &lt;/ion-navbar&gt;
&lt;/ion-header&gt;

&lt;ion-content padding&gt;
  &lt;ion-list&gt;

    &lt;ion-item &gt;
      &lt;ion-input type="text" placeholder="Username" [(ngModel)]="username"[myIonicInput]="myStyles"&gt;&lt;/ion-input&gt;
    &lt;/ion-item&gt;

    &lt;ion-item&gt;
      &lt;ion-input type="password" placeholder="Password"&gt;&lt;/ion-input&gt;
    &lt;/ion-item&gt;

  &lt;/ion-list&gt;
  &lt;p *ngIf="myStyles.showUsername" class="hint"&gt;
    You are typing username
  &lt;/p&gt;

  &lt;ion-fab bottom center&gt;
    &lt;button ion-fab&gt;GO&lt;/button&gt;
  &lt;/ion-fab&gt;
&lt;/ion-content&gt;</pre></div><p>As mentioned earlier, the <span class="strong"><strong>GO</strong></span> button is just an example of the new floating button<a id="id185" class="indexterm"/> feature from Ionic 2. All you need to do is include <code class="literal">bottom</code> and <code class="literal">center</code> in order to position it. These are actually good examples of attribute directives.</p></li><li class="listitem">Open <code class="literal">home.ts</code>, in the same folder as in the preceding step, to edit and insert the following code:<div class="informalexample"><pre class="programlisting">import { Component } from '@angular/core';
import { NavController } from 'ionic-angular';

@Component({
  selector: 'page-home',
  templateUrl: 'home.html'
})
export class HomePage {
  private myStyles: Object = {showUsername: false};

  constructor(public navCtrl: NavController) {
  }

}</pre></div></li><li class="listitem">Create the <code class="literal">./src/directives</code> folder, as shown in the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mkdir ./src/directives</strong></span>
</pre></div></li><li class="listitem">Create the <code class="literal">my-ionic-input.ts</code> file in the <code class="literal">directives</code> folder and copy the following<a id="id186" class="indexterm"/> code:<div class="informalexample"><pre class="programlisting">import {Directive, ElementRef, Input} from '@angular/core';

@Directive({
  selector: '[myIonicInput]',
  host: {
    '(mouseenter)': 'onMouseEnter()',
    '(mouseleave)': 'onMouseLeave()'
    // '(keypress)': 'onKeyPress'
  }
})
export class MyIonicInputDirective {
  @Input('myIonicInput') myStyles: any;
  
  constructor(private el: ElementRef) { 
    el.nativeElement.onkeypress = function(e) {
      console.log(e);
       
      if ('~!@#$%^&amp;*()-='.includes(String.fromCharCode(e.keyCode))) {
        e.preventDefault();
        return;
      }
    }
  }
  onMouseEnter() { 
    this.myStyles.showUsername = true;
  }
  
  onMouseLeave(e) { 
    this.myStyles.showUsername = false; 
  }

  // onKeyPress will not work with ion-input directly because the actual input element is a child of ion-input  
  // onKeyPress() { 
  //   console.log("onKeyPress");
  // }
}</pre></div></li><li class="listitem">Open and edit <code class="literal">./src/app/app.module.ts</code> to declare <a id="id187" class="indexterm"/>your new directive, as follows:<div class="informalexample"><pre class="programlisting">import { NgModule } from '@angular/core';
import { IonicApp, IonicModule } from 'ionic-angular';
import { MyApp } from './app.component';
import { HomePage } from '../pages/home/home';
import { MyIonicInputDirective } from '../directives/my-ionic-input';

@NgModule({
  declarations: [
    MyApp,
    HomePage,
    MyIonicInputDirective
  ],
  imports: [
    IonicModule.forRoot(MyApp)
  ],
  bootstrap: [IonicApp],
  entryComponents: [
    MyApp,
    HomePage
  ],
  providers: []
})
export class AppModule {}</pre></div></li><li class="listitem">Go to your terminal and run the app, as shown:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic serve</strong></span>
</pre></div></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec48"/>How it works…</h2></div></div></div><p>The home page template (<code class="literal">home.html</code>) is very typical with <code class="literal">ion-list</code> and <code class="literal">ion-item</code>, which contain your input elements. However, there are two important things to take note of. First, there is an attribute, called <code class="literal">myIonicInput</code>, in the <code class="literal">ion-input</code> component. Observe the following <a id="id188" class="indexterm"/>code:</p><div class="informalexample"><pre class="programlisting">&lt;ion-item &gt;
  &lt;ion-input type="text" placeholder="Username" [(ngModel)]="username" [myIonicInput]="myStyles"&gt;&lt;/ion-input&gt;
&lt;/ion-item&gt;</pre></div><p>Second, the <code class="literal">myStyles</code> object is now used to toggle the visibility of the <code class="literal">&lt;p&gt;</code> element, as shown:</p><div class="informalexample"><pre class="programlisting">&lt;p *ngIf="myStyles.showUsername" class="hint"&gt;
  You are typing username
&lt;/p&gt;</pre></div><p>This <code class="literal">myStyles</code> object is actually a <code class="literal">private</code> variable in your <code class="literal">HomePage</code> class in the <code class="literal">home.ts</code> file, as follows:</p><div class="informalexample"><pre class="programlisting">export class HomePage {
  private myStyles: Object = {showUsername: false};
}</pre></div><p>With TypeScript, you could assign a type (that is, object) to a variable with a default value. You may also note that <code class="literal">MyIonicInputDirective</code> should be declared for a dependency to be injected into the template directives.</p><p>To create a basic directive, you must import at least <code class="literal">Directive</code> and <code class="literal">ElementRef</code> in order to manipulate the DOM. However, since this <code class="literal">Directive</code> has input (that is, <code class="literal">myStyles</code>), you should also import <code class="literal">Input</code> in your <code class="literal">my-ionic-input.ts</code>, as illustrated in the following code:</p><div class="informalexample"><pre class="programlisting">import {Directive, ElementRef, Input} from '@angular/core';</pre></div><p>You have <code class="literal">selector</code> and <code class="literal">host</code> metadata in your directive, as shown:</p><div class="informalexample"><pre class="programlisting">@Directive({
  selector: '[myIonicInput]',
  host: {
    '(mouseenter)': 'onMouseEnter()',
    '(mouseleave)': 'onMouseLeave()'
    // '(keypress)': 'onKeyPress'
  }
})</pre></div><p>The <code class="literal">myIonicInput</code> selector will be queried from the DOM and will trigger <span class="emphasis"><em>actions</em></span> on that DOM node. For event detection on the DOM, you have to map the event name to the class method. For example, the <code class="literal">mouseenter</code> event will trigger a call to the <code class="literal">onMouseEnter()</code> method in the directive's class, which is <code class="literal">MyIonicInputDirective</code>.</p><p>Now, let's look more<a id="id189" class="indexterm"/> closely in the directive's class:</p><div class="informalexample"><pre class="programlisting">export class MyIonicInputDirective {
  @Input('myIonicInput') myStyles: any;
  
  constructor(private el: ElementRef) { 
    el.nativeElement.onkeypress = function(e) {
      console.log(e);
       
      if ('~!@#$%^&amp;*()-='.includes(String.fromCharCode(e.keyCode))) {
        e.preventDefault();
        return;
      }
    }
  }
  onMouseEnter() { 
    this.myStyles.showUsername = true;
  }
  
  onMouseLeave(e) { 
    this.myStyles.showUsername = false; 
  }

  // onKeyPress will not work with ion-input directly because the actual input element is a child of ion-input  
  // onKeyPress() { 
  //   console.log("onKeyPress");
  // }
}</pre></div><p>The <code class="literal">@Input</code> decorator is used to declare that you will bring in a variable from the template. This is the reason why you must have the square brackets in <code class="literal">[myIonicInput]="myStyles"</code>. Otherwise, <code class="literal">myStyles</code> would just be a string instead of an expression referring to the <code class="literal">myStyles</code> object from the <code class="literal">HomePage</code> class. Another interesting thing to note here is the code inside the <code class="literal">constructor</code>. The <code class="literal">ElementRef</code> is pointing to the same DOM where you placed your attribute directive. You want to modify the behavior of the keyboard using <code class="literal">el.nativeElement.onkeypress</code> so that special characters won't be allowed. If the user enters a special character, it will trigger <code class="literal">e.preventDefault()</code> and nothing will happen. The keyboard event is basically discarded. You may wonder why we cannot just use the <code class="literal">keypress</code> event and map it to <code class="literal">onKeyPress</code>, which was intentionally commented out. The reason is that you are placing the <code class="literal">myIonicInput</code> directive on top of <code class="literal">ion-input</code>. But the actual <code class="literal">&lt;input&gt;</code> DOM is just a child of <code class="literal">ion-input</code>. Therefore, if you listen to the <code class="literal">keypress</code> event on the parent <code class="literal">ion-input</code>, you won't be able to bind it.</p><p>The <code class="literal">onMouseEnter</code> and <code class="literal">onMouseLeave</code> methods are very self explanatory because they just toggle the <code class="literal">myStyles.showUsername</code> variable. Again, this <code class="literal">myStyles</code> object is just a reference back to the <code class="literal">myStyles</code> of <code class="literal">HomePage</code>. So, if you change the variable here, it will change at the home<a id="id190" class="indexterm"/> page's level as well.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec49"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">For more information about <a id="id191" class="indexterm"/>Angular 2 directives, you can refer to the official documentation at <a class="ulink" href="https://angular.io/docs/ts/latest/guide/attribute-directives.html">https://angular.io/docs/ts/latest/guide/attribute-directives.html</a></li><li class="listitem">Since this is<a id="id192" class="indexterm"/> the first section where TypeScript appears, it might be helpful to go through the handbook at <a class="ulink" href="http://www.typescriptlang.org/docs/tutorial.html">http://www.typescriptlang.org/docs/tutorial.html</a>, for more details</li></ul></div></div></div>
<div class="section" title="Creating a custom pipe"><div class="titlepage" id="aid-TI1E2"><div><div><h1 class="title"><a id="ch03lvl1sec25"/>Creating a custom pipe</h1></div></div></div><p>Pipes are also a feature of Angular 2 and are not specific to Ionic. If you are familiar with Angular 1, a <span class="emphasis"><em>pipe</em></span> is exactly<a id="id193" class="indexterm"/> the same thing as a <span class="emphasis"><em>filter</em></span>. The main reason you might want to use pipes is to display data in a different format in the view. You don't want to change the actual value in the component. This makes things very convenient because <a id="id194" class="indexterm"/>you don't have to decide on the specific format within the code, while leaving flexibility in the view layer. Here is a list of some useful built-in pipes (from <a class="ulink" href="https://angular.io/docs/ts/latest/api/#!?apiFilter=pipe">https://angular.io/docs/ts/latest/api/#!?apiFilter=pipe</a>):</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">AsyncPipe</li><li class="listitem">DatePipe</li><li class="listitem">NumberPipe</li><li class="listitem">SlicePipe</li><li class="listitem">DecimalPipe</li><li class="listitem">JsonPipe</li><li class="listitem">PercentPipe</li><li class="listitem">UpperCasePipe</li><li class="listitem">LowerCasePipe</li><li class="listitem">CurrencyPipe</li><li class="listitem">ReplacePipe</li></ul></div><p>In this section, you<a id="id195" class="indexterm"/> will learn how to create a custom pipe using the <code class="literal">@Pipe</code> decorator. The following is a screenshot of the app:</p><div class="mediaobject"><img src="../Images/image00243.jpeg" alt="Creating a custom pipe"/></div><p style="clear:both; height: 1em;"> </p><p>While the app interface is very simple, this example is to show you how to create a pipe to extract object data.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec50"/>Getting ready</h2></div></div></div><p>There is no need to test in a physical device because the Angular 2 pipe will work just fine in the web browser.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec51"/>How to do it...</h2></div></div></div><p>Observe the<a id="id196" class="indexterm"/> following instructions:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new <code class="literal">CustomPipe</code> app using the <code class="literal">blank</code> template, as shown, and go to the <code class="literal">CustomPipe</code> folder:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic start CustomPipe blank --v2</strong></span>
<span class="strong"><strong>$ cd CustomPipe</strong></span>
</pre></div></li><li class="listitem">Open the <code class="literal">./src/pages/home/home.html</code> file and modify the content with the following code:<div class="informalexample"><pre class="programlisting">&lt;ion-header&gt;
  &lt;ion-navbar&gt;
    &lt;ion-title&gt;
      User
    &lt;/ion-title&gt;
  &lt;/ion-navbar&gt;
&lt;/ion-header&gt;

&lt;ion-content padding&gt;

  &lt;h4&gt;Unformatted Value&lt;/h4&gt;
  &lt;ion-card&gt;

    &lt;ion-card-header&gt;
      &lt;code&gt;user&lt;/code&gt;
    &lt;/ion-card-header&gt;

    &lt;ion-card-content&gt;
      {{ user | json }}
    &lt;/ion-card-content&gt;

  &lt;/ion-card&gt;
  
  &lt;h4&gt;Formatted Value&lt;/h4&gt;
  &lt;ion-list&gt;

    &lt;ion-item&gt;
      &lt;ion-label fixed&gt;First Name&lt;/ion-label&gt;
      &lt;ion-note item-right&gt;{{ user | userExtract : "firstname" }}&lt;/ion-note&gt;
    &lt;/ion-item&gt;

    &lt;ion-item&gt;
      &lt;ion-label fixed&gt;Last Name&lt;/ion-label&gt;
      &lt;ion-note item-right&gt;{{ user | userExtract : "lastname" }}&lt;/ion-note&gt;
    &lt;/ion-item&gt;
    
    &lt;ion-item&gt;
      &lt;ion-label fixed&gt;Age&lt;/ion-label&gt;
      &lt;ion-note item-right&gt;{{ user | userExtract : "age" }}&lt;/ion-note&gt;
    &lt;/ion-item&gt;

  &lt;/ion-list&gt;
&lt;/ion-content&gt;</pre></div><p>You can quickly see that the template uses the <code class="literal">userExtract</code> pipe to render the correct information.</p></li><li class="listitem">Then, replace<a id="id197" class="indexterm"/> the content of <code class="literal">./src/pages/home/home.ts</code> with the following code:<div class="informalexample"><pre class="programlisting">import { Component } from '@angular/core';
import { NavController } from 'ionic-angular';

@Component({
  selector: 'page-home',
  templateUrl: 'home.html'
})
export class HomePage {
  private user: any;
  
  constructor(public navCtrl: NavController) {
    this.user = {
      name: 'John Connor',
      birthyear: 1985
    }
  }

}</pre></div><p>You don't have the <code class="literal">custom-pipe.ts</code> file yet, so, you need to create it next.</p></li><li class="listitem">Create the <code class="literal">./src/utils</code> folder by using the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mkdir ./utils/utils</strong></span>
</pre></div><p>You can call this folder anything. However, since, sometimes, pipes are<a id="id198" class="indexterm"/> considered <span class="emphasis"><em>utility</em></span> functions, let's call it <code class="literal">utils</code>.</p></li><li class="listitem">Create the <code class="literal">custom-pipe.ts</code> file in the <code class="literal">utils</code> folder and copy the following code:<div class="informalexample"><pre class="programlisting">import { Pipe, PipeTransform } from '@angular/core';

@Pipe({name: 'userExtract'})
export class UserExtractPipe implements PipeTransform {
  transform(value: any, arg) : any {
    let newVal: any;
    if (arg == "firstname") {
      
      newVal = value.name ? value.name.split(' ')[0] : '';

    } else if (arg == "lastname") {
      
      newVal = value.name ? value.name.split(' ').splice(-1) : '';
      
    } else if (arg == "age") {
      var currentTime = new Date();
      
      newVal = value.birthyear ? currentTime.getFullYear() - value.birthyear : 0;
    }
    
    return newVal;
  }
}</pre></div></li><li class="listitem">Add <code class="literal">UserExtractPipe</code> to <code class="literal">./src/app/app.module.ts</code> by replacing with the following code:<div class="informalexample"><pre class="programlisting">import { NgModule } from '@angular/core';
import { IonicApp, IonicModule } from 'ionic-angular';
import { MyApp } from './app.component';
import { HomePage } from '../pages/home/home';
import { UserExtractPipe } from '../utils/custom-pipe'

@NgModule({
  declarations: [
    MyApp,
    HomePage,
    UserExtractPipe
  ],
  imports: [
    IonicModule.forRoot(MyApp)
  ],
  bootstrap: [IonicApp],
  entryComponents: [
    MyApp,
    HomePage
  ],
  providers: []
})
export class AppModule {}</pre></div></li><li class="listitem">Go to your terminal and run the app, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic serve</strong></span>
</pre></div></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec52"/>How it works…</h2></div></div></div><p>You can use an<a id="id199" class="indexterm"/> Angular 2 pipe in the view to simply convert or transform any value to a desired value. There is no limitation on how you want to structure the pipe. Angular 2 automatically detects the <code class="literal">|</code> sign in the template and turns the value in front of it to an input. To create a pipe, you must import the decorator and provide a name (see <code class="literal">custom-pipe.ts</code>), as shown:</p><div class="informalexample"><pre class="programlisting">import { Pipe, PipeTransform } from '@angular/core';

@Pipe({name: 'userExtract'})</pre></div><p>The input from the template is the following <code class="literal">value</code> parameter:</p><div class="informalexample"><pre class="programlisting">transform(value: any, arg) : any {</pre></div><p>The value returned by the <code class="literal">transform</code> method will be the output to the view, as shown in the following code:</p><div class="informalexample"><pre class="programlisting">return newVal;</pre></div><p>In this example, you are taking a parameter for the pipe to process, as illustrated in the following code:</p><div class="informalexample"><pre class="programlisting">    if (arg == "firstname") {
      
      newVal = value.name ? value.name.split(' ')[0] : '';

    } else if (arg == "lastname") {
      
      newVal = value.name ? value.name.split(' ').splice(-1) : '';
      
    } else if (arg == "age") {
      var currentTime = new Date();
      
      newVal = value.birthyear ? currentTime.getFullYear() - value.birthyear : 0;
    }</pre></div><p>For example, this is what you had in the <code class="literal">home.html</code> template:</p><div class="informalexample"><pre class="programlisting">    &lt;ion-item&gt;
      &lt;ion-label fixed&gt;First Name&lt;/ion-label&gt;
      &lt;ion-note item-right&gt;{{ user | userExtract : "firstname" }}&lt;/ion-note&gt;
    &lt;/ion-item&gt;</pre></div><p>Each parameter is placed after a colon (<code class="literal">:</code>). Then, within your <code class="literal">@Pipe</code> class, you can refer to it using <code class="literal">arg</code>. The<a id="id200" class="indexterm"/> rest of the code is very simple as already shown in the preceding section. Observe the following </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">If it's <code class="literal">firstname</code>, take the first word after splitting by space</li><li class="listitem">If it's <code class="literal">lastname</code>, take the last word</li><li class="listitem">If it's <code class="literal">age</code>, subtract the current year from birth year</li></ul></div><p>Of course, you could have more complicated scenarios with pipes. However, the overall recommendation is to keep things simple at the view to ensure rendering performance. If you need to do heavy processing, it's best to handle it as a separate variable.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec53"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">To understand <a id="id201" class="indexterm"/>more about Angular 2 pipes, you can check out the official documentation at <a class="ulink" href="https://angular.io/docs/ts/latest/guide/pipes.html">https://angular.io/docs/ts/latest/guide/pipes.html</a></li></ul></div></div></div>
<div class="section" title="Creating a shared service to provide data to multiple pages"><div class="titlepage" id="aid-UGI02"><div><div><h1 class="title"><a id="ch03lvl1sec26"/>Creating a shared service to provide data to multiple pages</h1></div></div></div><p>When you develop an<a id="id202" class="indexterm"/> app that involves a lot of pages and communication to the backend, you will need to have a way to communicate across the pages and components. For example, you may have a service to<a id="id203" class="indexterm"/> request user data from the backend and store it in a common local service. Then, you will need to provide a way for the user to update their user data and see the update in real time. When the user navigates to different pages, the same information will be pulled and rendered as well without making multiple trips to the backend. This is a very common scenario that requires the use of the <code class="literal">@Injectable</code> decorator in Angular 2.</p><p>Observe the following screenshot of the app you will build:</p><div class="mediaobject"><img src="../Images/image00244.jpeg" alt="Creating a shared service to provide data to multiple pages"/></div><p style="clear:both; height: 1em;"> </p><p>The user<a id="id204" class="indexterm"/> can fill out the form and<a id="id205" class="indexterm"/> see updates above it in real time. Then, they can move to the next page (<span class="strong"><strong>Go to Page 2</strong></span>) and see the following screenshot:</p><div class="mediaobject"><img src="../Images/image00245.jpeg" alt="Creating a shared service to provide data to multiple pages"/></div><p style="clear:both; height: 1em;"> </p><p>This page uses the same service as the preceding page and references the same date with the name and age. You will learn the following topics in this section:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Creating a service using <code class="literal">@Injectable</code></li><li class="listitem">Sharing a service across multiple pages</li><li class="listitem">Detecting<a id="id206" class="indexterm"/> changes using getters and setters inside the service</li></ul></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec54"/>Getting ready</h2></div></div></div><p>This app<a id="id207" class="indexterm"/> example could work either in a browser or on a physical device.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec55"/>How to do it...</h2></div></div></div><p>Observe the following instructions:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new <code class="literal">SharedService</code> app using the <code class="literal">blank</code> template, as shown, and go to the <code class="literal">SharedService</code> folder:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic start SharedService blank --v2</strong></span>
<span class="strong"><strong>$ cd SharedService</strong></span>
</pre></div></li><li class="listitem">You will need to make several changes in the directory because you have two pages and a common service for both. Let's start by modifying the <code class="literal">./src/app/app.component.ts</code> file so that the <code class="literal">rootPage</code> is pointing to <code class="literal">Page1</code>:<div class="informalexample"><pre class="programlisting">import { Component } from '@angular/core';
import { Platform } from 'ionic-angular';
import { StatusBar, Splashscreen } from 'ionic-native';
import { Page1 } from '../pages/page1/page1';

@Component({
  template: `&lt;ion-nav [root]="rootPage"&gt;&lt;/ion-nav&gt;`
})
export class MyApp {
  rootPage = Page1;

  constructor(platform: Platform) {
    platform.ready().then(() =&gt; {
      // Okay, so the platform is ready and our plugins are available.
      // Here you can do any higher level native things you might need.
      StatusBar.styleDefault();
      Splashscreen.hide();
    });
  }
}</pre></div></li><li class="listitem">Create <code class="literal">./src/pages/page1</code>, as shown in the following code:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mkdir ./src/pages/page1</strong></span>
</pre></div></li><li class="listitem">Create <a id="id208" class="indexterm"/>your first<a id="id209" class="indexterm"/> template, <code class="literal">page1.html</code>, in the <code class="literal">page1</code> folder with the following code:<div class="informalexample"><pre class="programlisting">&lt;ion-header&gt;
  &lt;ion-navbar&gt;
    &lt;ion-title&gt;
      Profile
    &lt;/ion-title&gt;
  &lt;/ion-navbar&gt;
&lt;/ion-header&gt;

&lt;ion-content&gt;
  &lt;ion-card&gt;
    &lt;ion-card-header&gt;
      What you are entering
    &lt;/ion-card-header&gt;
    &lt;ion-card-content&gt;
      &lt;ion-badge item-right&gt;Name&lt;/ion-badge&gt; {{ user.name }}
      &lt;br&gt;&lt;br&gt;
      &lt;ion-badge item-right&gt;Age&lt;/ion-badge&gt; {{ user.age }}
    &lt;/ion-card-content&gt;
  &lt;/ion-card&gt;
  &lt;ion-list&gt;

    &lt;ion-item&gt;
      &lt;ion-label fixed&gt;Name&lt;/ion-label&gt;
      &lt;ion-input type="text" [(ngModel)]="user.name"&gt;&lt;/ion-input&gt;
    &lt;/ion-item&gt;

    &lt;ion-item&gt;
      &lt;ion-label fixed&gt;Password&lt;/ion-label&gt;
      &lt;ion-input type="number" [(ngModel)]="user.age"&gt;&lt;/ion-input&gt;
    &lt;/ion-item&gt;

  &lt;/ion-list&gt;
  
  &lt;button ion-button full block (click)="goToPage2()"&gt;Go to Page 2&lt;/button&gt;

&lt;/ion-content&gt;</pre></div></li><li class="listitem">Create <code class="literal">page1.ts</code> in<a id="id210" class="indexterm"/> the <code class="literal">page1</code> folder, as follows:<div class="informalexample"><pre class="programlisting">import { Component } from '@angular/core';
import { NavController } from 'ionic-angular';
import { UserService } from '../../services/user';
import { Page2 } from '../page2/page2';

@Component({
  selector: 'page-one',
  templateUrl: 'page1.html'
})
export class Page1 {
  private user: any;
  private nav: any;
  
  constructor(public navCtrl: NavController, user: UserService, nav: NavController) {
    console.log(user.name);
    this.user = user;
    this.nav = nav;
  }
  
  goToPage2(){
    this.nav.push(Page2);
  }
}</pre></div><div class="note" title="Note"><h3 class="title"><a id="tip10"/>Tip</h3><p>The file extension is <code class="literal">.ts</code>, and not <code class="literal">.js</code>, because you are going to use some TypeScript-specific features, such as getters and setters.</p></div></li><li class="listitem">Similarly, create<a id="id211" class="indexterm"/> the <code class="literal">page2</code> folder using the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mkdir ./src/pages/page1</strong></span>
</pre></div></li><li class="listitem">Add the <code class="literal">page2.html</code> template in the <code class="literal">page2</code> folder as well, as follows:<div class="informalexample"><pre class="programlisting">&lt;ion-header&gt;
  &lt;ion-navbar&gt;
    &lt;ion-title&gt;
      Confirmation
    &lt;/ion-title&gt;
  &lt;/ion-navbar&gt;
&lt;/ion-header&gt;

&lt;ion-content class="home"&gt;
  &lt;ion-card&gt;
    &lt;ion-card-header&gt;
      Please confirm your profile
    &lt;/ion-card-header&gt;
    &lt;ion-card-content&gt;
      {{ user.name }} is {{ user.age }} years old
    &lt;/ion-card-content&gt;
  &lt;/ion-card&gt;
  
  &lt;button ion-button full block (click)="goToPage1()"&gt;Back to Page 1&lt;/button&gt;
&lt;/ion-content&gt;</pre></div><p>This is<a id="id212" class="indexterm"/> your second<a id="id213" class="indexterm"/> page with the same <code class="literal">name</code> and <code class="literal">age</code> information.</p></li><li class="listitem">Create <code class="literal">page2.ts</code>, in the <code class="literal">page2</code> folder, with the following code:<div class="informalexample"><pre class="programlisting">import { Component } from '@angular/core';
import { NavController } from 'ionic-angular';
import { UserService } from '../../services/user';
import { Page1 } from '../page1/page1';

@Component({
  selector: 'page-two',
  templateUrl: 'page2.html'
})
export class Page2 {
  private user: any;
  private nav: any;
  
  constructor(public navCtrl: NavController, user: UserService, nav: NavController) {
    console.log(user.name);
    this.user = user;
    this.nav = nav;
  }
  
  goToPage1(){
    this.nav.push(Page1);
  }
}</pre></div></li><li class="listitem">Create the <code class="literal">services</code> folder with<a id="id214" class="indexterm"/> the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mkdir ./src/services</strong></span>
</pre></div></li><li class="listitem">Put <code class="literal">UserService</code> in<a id="id215" class="indexterm"/> the <code class="literal">user.ts</code> file in the <code class="literal">services</code> folder, as shown:<div class="informalexample"><pre class="programlisting">import {Injectable} from '@angular/core';

@Injectable()
export class UserService {
  private _name: string;
  private _age: number;
  
  constructor() {
    this._name = 'John Connor';
    this._age = 31;
  }
  
  get name() {
    return this._name;
  }
  
  set name(newVal) {
    console.log('Set name = ' + newVal);
    this._name = newVal;
  }
  
  get age() {
    return this._age;
  }
  
  set age(newVal) {
    console.log('Set age = ' + newVal);
    this._age = newVal;
  }
}</pre></div></li><li class="listitem">Open and edit <code class="literal">./src/app/app.module.ts</code> so that you can inject <code class="literal">UserService</code> as a global provider:<div class="informalexample"><pre class="programlisting">import { NgModule } from '@angular/core';
import { IonicApp, IonicModule } from 'ionic-angular';
import { MyApp } from './app.component';
import { Page1 } from '../pages/page1/page1';
import { Page2 } from '../pages/page2/page2';
import { UserService } from '../services/user';

@NgModule({
  declarations: [
    MyApp,
    Page1,
    Page2
  ],
  imports: [
    IonicModule.forRoot(MyApp)
  ],
  bootstrap: [IonicApp],
  entryComponents: [
    MyApp,
    Page1,
    Page2
  ],
  providers: [UserService]
})
export class AppModule {}</pre></div></li><li class="listitem">Verify<a id="id216" class="indexterm"/> your folder <a id="id217" class="indexterm"/>structure looks like the following screenshot:<div class="mediaobject"><img src="../Images/image00246.jpeg" alt="How to do it..."/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Go to your terminal and run the app as shown with the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic serve</strong></span>
</pre></div></li></ol><div style="height:10px; width: 1px"/></div><p>You can move from <code class="literal">page 1</code> to <code class="literal">page 2</code> and then back and the data persists across the pages.</p></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec56"/>How it works…</h2></div></div></div><p>In general, if you<a id="id218" class="indexterm"/> want to use a common<a id="id219" class="indexterm"/> service across multiple pages, you must inject it at the highest level. In this example, you put <code class="literal">UserService</code> as a dependency at the start of <code class="literal">app.module.ts</code>, as follows:</p><div class="informalexample"><pre class="programlisting">providers: [UserService]</pre></div><p>After that, other pages within the app can start using this common service without having to reinject it. The main reason is that, whenever you inject a service or class, it will instantiate a new object, which ends up erasing all the existing data in memory. If you want to keep the data persistent across the pages, it should be in the parent app to avoid reinjection.</p><p>To use the <code class="literal">UserService</code> in each page, you just need to import it, as illustrated in the following code:</p><div class="informalexample"><pre class="programlisting">import { UserService } from '../../services/user';</pre></div><p>The way to "bring in" the service is to put the referencing in the constructor (page1.ts), as shown:</p><div class="informalexample"><pre class="programlisting">  constructor(user: UserService, nav: NavController) {
    console.log(user.name);
    this.user = user;
    this.nav = nav;
  }</pre></div><p>This will pass down the <code class="literal">UserService</code> reference to a local private variable of the page (in this case, <code class="literal">this.user</code>).</p><p>From the<a id="id220" class="indexterm"/> template standpoint, there is no difference<a id="id221" class="indexterm"/> between using <code class="literal">{{ user.name }}</code> and <code class="literal">{{ user.age }}</code> to inject data.</p><p>Now, let's take a look at <code class="literal">UserService</code>:</p><div class="informalexample"><pre class="programlisting">import {Injectable} from '@angular/core';

@Injectable()
export class UserService {
  private _name: string;
  private _age: number;
  
  constructor() {
    this._name = 'John Connor';
    this._age = 31;
  }
  
  get name() {
    return this._name;
  }
  
  set name(newVal) {
    console.log('Set name = ' + newVal);
    this._name = newVal;
  }
  
  get age() {
    return this._age;
  }
  
  set age(newVal) {
    console.log('Set age = ' + newVal);
    this._age = newVal;
  }
}</pre></div><p>Actually, there are several things going on here. First, you need to import <code class="literal">Injectable</code> from <code class="literal">@angular/core</code>.</p><div class="note" title="Note"><h3 class="title"><a id="tip11"/>Tip</h3><p>Don't forget the parentheses in <code class="literal">@Injectable()</code>.</p></div><p>Second, if you <a id="id222" class="indexterm"/>want to use getters and setters, you need to make separate variables, called <code class="literal">_name</code> and <code class="literal">_age</code>, to store the data. Then, you<a id="id223" class="indexterm"/> can use the get/set method to do additional processing when other pages access or set the variables in this common class. If you change the <code class="literal">name</code> or <code class="literal">age</code> from <code class="literal">Page 1</code>, you can see the following logs in the console:</p><div class="mediaobject"><img src="../Images/image00247.jpeg" alt="How it works…"/></div><p style="clear:both; height: 1em;"> </p><p>This feature is very beneficial since you can use this as a replacement for <code class="literal">watch</code> or <code class="literal">observable</code>. If you recall from Angular 1, you have to use <code class="literal">$scope.$watch</code> for a similar approach.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch03lvl2sec57"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">For more<a id="id224" class="indexterm"/> information about Angular 2 services, visit the official documentation at <a class="ulink" href="https://angular.io/docs/ts/latest/tutorial/toh-pt4.html">https://angular.io/docs/ts/latest/tutorial/toh-pt4.html</a></li><li class="listitem">You can get<a id="id225" class="indexterm"/> great instructions on many techniques for component communication at <a class="ulink" href="https://angular.io/docs/ts/latest/cookbook/component-communication.html">https://angular.io/docs/ts/latest/cookbook/component-communication.html</a></li></ul></div></div></div></body></html>