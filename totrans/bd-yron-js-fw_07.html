<html><head></head><body>
<div id="_idContainer066">
<h1 class="chapter-number" id="_idParaDest-109"><a id="_idTextAnchor108"/><span class="koboSpan" id="kobo.1.1">7</span></h1>
<h1 id="_idParaDest-110"><a id="_idTextAnchor109"/><span class="koboSpan" id="kobo.2.1">Creating a Full Stack Framework</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In </span><a href="B19014_06.xhtml#_idTextAnchor089"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.4.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.5.1">, we learned a practical example of building a simple JavaScript testing framework. </span><span class="koboSpan" id="kobo.5.2">In this chapter, we will continue this practical approach, further diving into the development </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">of frameworks.</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">The next goal is to develop a full stack framework that will enable developers to build large and small web applications. </span><span class="koboSpan" id="kobo.7.2">This chapter will start off by developing the backend parts of such a framework, focusing on the server-side components and integrating essential developer tooling. </span><span class="koboSpan" id="kobo.7.3">These backend components, once established, will help us support the frontend elements of the framework we will create in </span><a href="B19014_08.xhtml#_idTextAnchor138"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.8.1">Chapter 8</span></em></span></a><span class="koboSpan" id="kobo.9.1">. </span><span class="koboSpan" id="kobo.9.2">Developing the backend feature set in this chapter will help us do </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.11.1">Define the technical architecture and goals of our new full stack framework. </span><span class="koboSpan" id="kobo.11.2">This is similar to the </span><a href="B19014_06.xhtml#_idTextAnchor089"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.12.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.13.1"> exercise, but now we will switch the context and focus more on the technical challenges of the backend </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">server functionality.</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Learn more about the components that are required to produce functioning full stack tooling. </span><span class="koboSpan" id="kobo.15.2">We will study and explore the abstractions we can build and the core parts of the framework that will make it usable in many </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">development scenarios.</span></span></li>
<li><span class="koboSpan" id="kobo.17.1">Identify the features that will improve usability, focusing on the features that empower developers and increase efficiency. </span><span class="koboSpan" id="kobo.17.2">These comprise tools that help automatically generate the framework scaffold from a template and enhance </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">development productivity.</span></span></li>
</ul>
<h1 id="_idParaDest-111"><a id="_idTextAnchor110"/><span class="koboSpan" id="kobo.19.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.20.1">The implemented framework code is in the book repository at </span><a href="https://github.com/PacktPublishing/Building-Your-Own-JavaScript-Framework"><span class="koboSpan" id="kobo.21.1">https://github.com/PacktPublishing/Building-Your-Own-JavaScript-Framework</span></a><span class="koboSpan" id="kobo.22.1">. </span><span class="koboSpan" id="kobo.22.2">The assets and code are in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.23.1">chapter7</span></strong><span class="koboSpan" id="kobo.24.1"> directory. </span><span class="koboSpan" id="kobo.24.2">As with </span><a href="B19014_06.xhtml#_idTextAnchor089"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.25.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.26.1">, we will utilize Node.js v20 or higher for </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">this project.</span></span></p>
<p><span class="koboSpan" id="kobo.28.1">Refer to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.29.1">README.md</span></strong><span class="koboSpan" id="kobo.30.1"> file of the framework in the chapter directory if you want to run or tweak the framework files locally. </span><strong class="source-inline"><span class="koboSpan" id="kobo.31.1">npm scripts</span></strong><span class="koboSpan" id="kobo.32.1"> can be handy to use shortcuts during development. </span><span class="koboSpan" id="kobo.32.2">As with other projects, to begin working on the framework, you need to install the dependencies with </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.33.1">npm install</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.34.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.35.1">The framework provides an executable that helps create the scaffold outline of the project, run the newly created application, and more. </span><span class="koboSpan" id="kobo.35.2">To locally install the </span><strong class="source-inline"><span class="koboSpan" id="kobo.36.1">componium</span></strong><span class="koboSpan" id="kobo.37.1"> framework executable from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.38.1">chapter7</span></strong><span class="koboSpan" id="kobo.39.1"> directory, you can link the executable to use it in different directories. </span><span class="koboSpan" id="kobo.39.2">To achieve this, from the checked-out repository directory, use </span><strong class="source-inline"><span class="koboSpan" id="kobo.40.1">npm link &lt;path&gt;/chapter7/componium</span></strong><span class="koboSpan" id="kobo.41.1">. </span><span class="koboSpan" id="kobo.41.2">This will link a global framework executable to your terminal shell that you can use in a sample project. </span><span class="koboSpan" id="kobo.41.3">In addition, if you make any changes to the framework files, the executable will pick up the changes instantly, as the script is directly linked. </span><span class="koboSpan" id="kobo.41.4">Check out the detailed </span><strong class="source-inline"><span class="koboSpan" id="kobo.42.1">npm link</span></strong><span class="koboSpan" id="kobo.43.1"> instructions at </span><a href="https://docs.npmjs.com/cli/commands/npm-link"><span class="koboSpan" id="kobo.44.1">docs.npmjs.com/cli/commands/npm-link</span></a><span class="koboSpan" id="kobo.45.1"> and the following note about </span><span class="No-Break"><span class="koboSpan" id="kobo.46.1">Windows compatibility.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.47.1">A note about Windows compatibility</span></p>
<p class="callout"><span class="koboSpan" id="kobo.48.1">There are a few things to keep in mind when working with framework executables and commands such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.49.1">npm link</span></strong><span class="koboSpan" id="kobo.50.1"> in the Windows OS. </span><span class="koboSpan" id="kobo.50.2">When running </span><strong class="source-inline"><span class="koboSpan" id="kobo.51.1">npm link chapter7\componium</span></strong><span class="koboSpan" id="kobo.52.1"> or other commands, you may experience some issues with the executable environment. </span><span class="koboSpan" id="kobo.52.2">There are a few common errors that can occur, including </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">the following.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.54.1">If you get an error related to </span><strong class="source-inline"><span class="koboSpan" id="kobo.55.1">enoent ENOENT: no such file or directory AppData\Roaming\npm</span></strong><span class="koboSpan" id="kobo.56.1">, make sure to create that directory in the mentioned path. </span><span class="koboSpan" id="kobo.56.2">This is usually an artifact of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.57.1">npm</span></strong><span class="koboSpan" id="kobo.58.1"> installer </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">on Windows.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.60.1">If you get an issue with </span><strong class="source-inline"><span class="koboSpan" id="kobo.61.1">UnauthorizedAccessException</span></strong><span class="koboSpan" id="kobo.62.1">, this is a standard security measure of Windows. </span><span class="koboSpan" id="kobo.62.2">To fix this, run </span><strong class="source-inline"><span class="koboSpan" id="kobo.63.1">Set-ExecutionPolicy RemoteSigned</span></strong><span class="koboSpan" id="kobo.64.1"> and allow the execution. </span><span class="koboSpan" id="kobo.64.2">For more information, refer to Microsoftâ€™s documentation </span><span class="No-Break"><span class="koboSpan" id="kobo.65.1">at </span></span><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy"><span class="No-Break"><span class="koboSpan" id="kobo.66.1">learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.67.1">.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.68.1">You can also refer to the </span><em class="italic"><span class="koboSpan" id="kobo.69.1">Common errors</span></em><span class="koboSpan" id="kobo.70.1"> article for npm at </span><a href="https://docs.npmjs.com/common-errors"><span class="koboSpan" id="kobo.71.1">docs.npmjs.com/common-errors</span></a><span class="koboSpan" id="kobo.72.1">. </span><span class="koboSpan" id="kobo.72.2">If you can successfully run </span><strong class="source-inline"><span class="koboSpan" id="kobo.73.1">componium --version</span></strong><span class="koboSpan" id="kobo.74.1"> using your PowerShell or Command Prompt, then your environment is </span><span class="No-Break"><span class="koboSpan" id="kobo.75.1">correctly configured.</span></span></p>
<h1 id="_idParaDest-112"><a id="_idTextAnchor111"/><span class="koboSpan" id="kobo.76.1">Full stack framework goals</span></h1>
<p><span class="koboSpan" id="kobo.77.1">Before </span><a id="_idIndexMarker479"/><span class="koboSpan" id="kobo.78.1">we get to the software architecture part of this project, we need to get a better insight into what a full stack framework will entail, especially in the JavaScript context and the languageâ€™s ecosystem. </span><span class="koboSpan" id="kobo.78.2">When developing a full stack JavaScript framework, we get to create a blend of abstractions and conventions to help developers produce a combination of frontend and backend components, given the modular nature of the JavaScript language and its ecosystem. </span><span class="koboSpan" id="kobo.78.3">From the JavaScript-language point of view, the framework can utilize the latest syntax and functional improvements, such as ES6 modules and modern web APIs. </span><span class="koboSpan" id="kobo.78.4">Ecosystem-wise, we will heavily rely on already-established modules to enable certain functionality. </span><span class="koboSpan" id="kobo.78.5">Similar to the approach in </span><a href="B19014_06.xhtml#_idTextAnchor089"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.79.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.80.1">, this strategy allows us to stay focused on the larger system design and achieve much better </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">feature coverage.</span></span></p>
<p><span class="koboSpan" id="kobo.82.1">The primary objective of a full stack framework is to simplify the application development process, making it faster and more efficient by providing a structured and standardized way to build applications. </span><span class="koboSpan" id="kobo.82.2">We have seen examples of the variety of these technical solutions in </span><a href="B19014_01.xhtml#_idTextAnchor015"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.83.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.84.1">, where frameworks such as Next.js create a much more streamlined and opinionated workflow across the whole stack. </span><span class="koboSpan" id="kobo.84.2">The projects, similar to Next.js, encapsulate all aspects of development and cover many use cases, seeking to eliminate the necessity of deciding on different technologies for different layers of development and offer a single unified vision. </span><span class="koboSpan" id="kobo.84.3">One of the goals of our sample framework project in this chapter is to focus on similar examples of developing a unified feature set, where components fit </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">naturally together.</span></span></p>
<p><span class="koboSpan" id="kobo.86.1">The implementation vision of the framework in this chapter should offer a unified API such that the developers utilizing the API can easily get acquainted with its structure and functionality, reducing the learning curve typically associated with new technology adoption. </span><span class="koboSpan" id="kobo.86.2">The familiarity and interoperability between different features ensure a seamless experience for developers. </span><span class="koboSpan" id="kobo.86.3">The framework API provides abstractions (highlighted in </span><a href="B19014_02.xhtml#_idTextAnchor030"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.87.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.88.1"> in the </span><em class="italic"><span class="koboSpan" id="kobo.89.1">About abstractions</span></em><span class="koboSpan" id="kobo.90.1"> section) that make complex operations simple without compromising the flexibility required for advanced use cases. </span><span class="koboSpan" id="kobo.90.2">The approach to creating easy-to-use public framework API interfaces is essential to support the varying skill levels of developers and the requirements of robust applications. </span><span class="koboSpan" id="kobo.90.3">When you develop or support a full stack framework similar to the practical example in this chapter, you will also have to take a variety of features into consideration. </span><span class="koboSpan" id="kobo.90.4">You will find that in your particular scenario, you will invest more in a feature set that is a higher priority for </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">your organization.</span></span></p>
<p><span class="koboSpan" id="kobo.92.1">Looking at the</span><a id="_idIndexMarker480"/><span class="koboSpan" id="kobo.93.1"> server-side feature set first, a full stack JavaScript framework must be able to provide a set of fundamental building blocks to handle standard use cases, based on different technological challenges. </span><span class="koboSpan" id="kobo.93.2">The features powered by such building blocks could include request routing, database integrations, unified interfaces for events, logging, and performance scaling. </span><span class="koboSpan" id="kobo.93.3">In some cases, a framework can also offer features beyond what a developer requires in their projects. </span><span class="koboSpan" id="kobo.93.4">Therefore, as part of the development process, we have to strike a balance between using the built-in features and offering a variety of extensibility options. </span><span class="koboSpan" id="kobo.93.5">We have seen instances of this in the </span><em class="italic"><span class="koboSpan" id="kobo.94.1">Plugin and extension APIs</span></em><span class="koboSpan" id="kobo.95.1"> section of </span><a href="B19014_03.xhtml#_idTextAnchor051"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.96.1">Chapter 3</span></em></span></a><span class="koboSpan" id="kobo.97.1">, where the server-side frameworks included a way to extend and enable additional functionality. </span><span class="koboSpan" id="kobo.97.2">Besides providing a sizeable, flexible feature set with the best developer experience, the applications must be easily deployable and have a way to be monitored once operating in production environments. </span><span class="koboSpan" id="kobo.97.3">In this case, pursue a goal of making it easy for developers to deploy their applications, scale those applications up as they get more traffic, and monitor latency and error rates. </span><span class="koboSpan" id="kobo.97.4">This involves building in utilities to set up multiple server instances, defining database migrations, </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">and more.</span></span></p>
<p><span class="koboSpan" id="kobo.99.1">As we define the</span><a id="_idIndexMarker481"/><span class="koboSpan" id="kobo.100.1"> expected functionality of a full stack framework, we need to define how much the frontend and backend features will interact with each other and where we would like to start the initial development. </span><span class="koboSpan" id="kobo.100.2">Considerations for those two sides of a full stack framework are explored in the </span><span class="No-Break"><span class="koboSpan" id="kobo.101.1">next sections.</span></span></p>
<h2 id="_idParaDest-113"><a id="_idTextAnchor112"/><span class="koboSpan" id="kobo.102.1">Frontend functionality</span></h2>
<p><span class="koboSpan" id="kobo.103.1">On the frontend side of a</span><a id="_idIndexMarker482"/><span class="koboSpan" id="kobo.104.1"> full stack framework, the emphasis should be on providing seamless integration of frontend components that interact well with backend services. </span><span class="koboSpan" id="kobo.104.2">Examples of these types of features could be easily fetching data from the server, rendering frontend components, and having access to the static files. </span><span class="koboSpan" id="kobo.104.3">Ember.js, along with EmberData, provides real-world examples of how to effectively collaborate with server-side systems. </span><span class="koboSpan" id="kobo.104.4">Another example is Next.js, which provides a tightly integrated solution for both the server and the client. </span><span class="koboSpan" id="kobo.104.5">Generally, the opinionated components can define how the framework interacts with the data received from the network requests, and how the data is bound to views and components on </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">the frontend.</span></span></p>
<p><span class="koboSpan" id="kobo.106.1">The frontend</span><a id="_idIndexMarker483"/><span class="koboSpan" id="kobo.107.1"> feature set should be capable of handling standard frontend requirements as well. </span><span class="koboSpan" id="kobo.107.2">These could include working with popular libraries by offering an easy way to integrate those libraries into projects. </span><span class="koboSpan" id="kobo.107.3">An extensive frontend solution should facilitate client-side routing and the ability to manage dependencies and handle form validation, user input sanitization, and JavaScript code bundling. </span><span class="koboSpan" id="kobo.107.4">Application state management is another significant component that can help manage the complexity of </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">larger projects.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer060">
<span class="koboSpan" id="kobo.109.1"><img alt="Figure 7.1: The focus of a full stack framework" src="image/Figure_7.1_B19014.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.110.1">Figure 7.1: The focus of a full stack framework</span></p>
<p><span class="koboSpan" id="kobo.111.1">Ultimately, the process of developing a comprehensive full stack framework calls for the exploration of considerable facets of technology. </span><span class="koboSpan" id="kobo.111.2">This initiative also necessitates a broad spectrum of programming skills. </span><span class="koboSpan" id="kobo.111.3">Youâ€™ll be expected to delve into both the complexities of the frontend features, where you will be concerned with user experience, and the backend challenges, focusing on servers, databases, and application logic. </span><span class="koboSpan" id="kobo.111.4">The development process enhances your coding abilities and promotes a better understanding of the entire web development ecosystem. </span><span class="koboSpan" id="kobo.111.5">In </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.112.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.113.1">.1</span></em><span class="koboSpan" id="kobo.114.1">, we break down the two important aspects of our framework development. </span><span class="koboSpan" id="kobo.114.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.115.1">Features</span></strong><span class="koboSpan" id="kobo.116.1"> will provide the</span><a id="_idIndexMarker484"/><span class="koboSpan" id="kobo.117.1"> necessary functionality to build frontend and backend components, interacting with services such as a database, and the </span><strong class="bold"><span class="koboSpan" id="kobo.118.1">Developer Experience</span></strong><span class="koboSpan" id="kobo.119.1"> will make these features reusable and easily accessible for application projects. </span><span class="koboSpan" id="kobo.119.2">The result of all this work will be a project usable by a variety of stakeholders, satisfying the respective needs of developers to produce web applications that power new services and web-based </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">software products.</span></span></p>
<h2 id="_idParaDest-114"><a id="_idTextAnchor113"/><span class="koboSpan" id="kobo.121.1">Backend functionality</span></h2>
<p><span class="koboSpan" id="kobo.122.1">We start with backend feature</span><a id="_idIndexMarker485"/><span class="koboSpan" id="kobo.123.1"> development first. </span><span class="koboSpan" id="kobo.123.2">This approach will serve the project as a foundation to later add frontend features on top of it to complete the full stack feature set. </span><span class="koboSpan" id="kobo.123.3">We will focus on frontend features and architecture in the next chapter. </span><span class="koboSpan" id="kobo.123.4">For now, we will imagine that our backend framework can deliver files to the browser client and can be used with any frontend framework. </span><span class="koboSpan" id="kobo.123.5">Browser-based applications can make requests to the server-side components to fetch data, static files, or </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">web pages.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer061">
<span class="koboSpan" id="kobo.125.1"><img alt="Figure 7.2: Our full stack framework logo" src="image/Figure_7.2_B19014.png.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.126.1">Figure 7.2: Our full stack framework logo</span></p>
<p><span class="koboSpan" id="kobo.127.1">We will reuse the same Componium project identity and branding that was established in </span><a href="B19014_06.xhtml#_idTextAnchor089"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.128.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.129.1">. </span><span class="koboSpan" id="kobo.129.2">We now have a new logo, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.130.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.131.1">.2</span></em><span class="koboSpan" id="kobo.132.1">, to serve as a branding example that identifies our full stack project. </span><span class="koboSpan" id="kobo.132.2">The Componium term and branding will cover all parts of the framework will be utilized in the command-line interface as well. </span><span class="koboSpan" id="kobo.132.3">Keeping the target developer user base in mind, here is a list of potential starter backend features for </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">this project:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.134.1">API deployment</span></strong><span class="koboSpan" id="kobo.135.1">: The</span><a id="_idIndexMarker486"/><span class="koboSpan" id="kobo.136.1"> ability to deploy an API service. </span><span class="koboSpan" id="kobo.136.2">The API functionality should be flexible enough to allow us to easily configure endpoints and add functional middleware to a selection of endpoints. </span><span class="koboSpan" id="kobo.136.3">The API capabilities should also include a modular approach to defining GraphQL resources </span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">and schemas.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.138.1">Page rendering features</span></strong><span class="koboSpan" id="kobo.139.1">: The ability to deliver web pages with custom and reusable layouts containing </span><a id="_idIndexMarker487"/><span class="koboSpan" id="kobo.140.1">static and </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">dynamic data.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.142.1">Middleware mechanisms</span></strong><span class="koboSpan" id="kobo.143.1">: Features that can add various types of server middleware, such as</span><a id="_idIndexMarker488"/><span class="koboSpan" id="kobo.144.1"> authentication, to all or some of the routes of </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">the application.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.146.1">Database capabilities</span></strong><span class="koboSpan" id="kobo.147.1">: Database </span><strong class="bold"><span class="koboSpan" id="kobo.148.1">object-relational mapping</span></strong><span class="koboSpan" id="kobo.149.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.150.1">ORM</span></strong><span class="koboSpan" id="kobo.151.1">) capabilities that provide the </span><a id="_idIndexMarker489"/><span class="koboSpan" id="kobo.152.1">ability to use different types of </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">database</span></span><span class="No-Break"><a id="_idIndexMarker490"/></span><span class="No-Break"><span class="koboSpan" id="kobo.154.1"> technologies.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.155.1">Application scalability</span></strong><span class="koboSpan" id="kobo.156.1">: Designed to</span><a id="_idIndexMarker491"/><span class="koboSpan" id="kobo.157.1"> handle high-load situations and offer scalability and performance optimization options. </span><span class="koboSpan" id="kobo.157.2">The framework should provide the necessary tools to test, debug, and deploy </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">an application.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.159.1">Development tools</span></strong><span class="koboSpan" id="kobo.160.1">: The framework offers a variety of helpers to ease the development process. </span><span class="koboSpan" id="kobo.160.2">The</span><a id="_idIndexMarker492"/><span class="koboSpan" id="kobo.161.1"> tools can include application bootstrapping and scaffolding of standard components. </span><span class="koboSpan" id="kobo.161.2">Live-reloading of the backend server can also save a lot of time by avoiding manually restarting the process on </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">every change.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.163.1">These</span><a id="_idIndexMarker493"/><span class="koboSpan" id="kobo.164.1"> functionality goals are now defined in enough detail, covering both the frontend and backend experiences. </span><span class="koboSpan" id="kobo.164.2">Utilizing the considerations in this section, we are ready to proceed to the exciting steps of architecting the initial parts of the full </span><span class="No-Break"><span class="koboSpan" id="kobo.165.1">stack framework.</span></span></p>
<h1 id="_idParaDest-115"><a id="_idTextAnchor114"/><span class="koboSpan" id="kobo.166.1">Architecture</span></h1>
<p><span class="koboSpan" id="kobo.167.1">Now that</span><a id="_idIndexMarker494"/><span class="koboSpan" id="kobo.168.1"> we have a clearer definition of the backend features, we can start architecting the packages and components of the framework. </span><span class="koboSpan" id="kobo.168.2">We will need encapsulation for server and routing interfaces, as well as additional components that allow us to communicate with databases, fetch particular application configurations, and report metrics or logs </span><span class="No-Break"><span class="koboSpan" id="kobo.169.1">through logging.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer062">
<span class="koboSpan" id="kobo.170.1"><img alt="Figure 7.3: The request life cycle" src="image/Figure_7.3_B19014.png.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.171.1">Figure 7.3: The request life cycle</span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.172.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.173.1">.3</span></em><span class="koboSpan" id="kobo.174.1"> represents a simplified view of the request life cycle that our framework will process. </span><span class="koboSpan" id="kobo.174.2">The requests can originate in a browser client or, potentially, be direct requests to an API endpoint of the server that our framework needs to handle. </span><span class="koboSpan" id="kobo.174.3">You can find a sample</span><a id="_idIndexMarker495"/><span class="koboSpan" id="kobo.175.1"> application built using our framework in the chapter directory </span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">under </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">tests/sample</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.178.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer063">
<span class="koboSpan" id="kobo.179.1"><img alt="Figure 7.4: A sample application layout" src="image/Figure_7.4_B19014.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.180.1">Figure 7.4: A sample application layout</span></p>
<p><span class="koboSpan" id="kobo.181.1">We now have</span><a id="_idIndexMarker496"/><span class="koboSpan" id="kobo.182.1"> an overview of how a framework processes requests through its internals. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.183.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.184.1">.4</span></em><span class="koboSpan" id="kobo.185.1"> shows an example of an application layout, consisting of the backend API and GraphQL routes. </span><span class="koboSpan" id="kobo.185.2">Developers can utilize this structure to build different types of server-side applications. </span><span class="koboSpan" id="kobo.185.3">In the following sections, we will take an in-depth look at the entry points, router, configuration, database, and observability features that make this application layout possible. </span><span class="koboSpan" id="kobo.185.4">You can find the files in the chapter directory under </span><strong class="source-inline"><span class="koboSpan" id="kobo.186.1">componium/tests/sample</span></strong><span class="koboSpan" id="kobo.187.1">. </span><span class="koboSpan" id="kobo.187.2">Some of the files, such as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.188.1">*.log</span></strong><span class="koboSpan" id="kobo.189.1"> files, will automatically generate when the application starts and produces some logging; normally, these log files are ignored by the version </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">control system.</span></span></p>
<h2 id="_idParaDest-116"><a id="_idTextAnchor115"/><span class="koboSpan" id="kobo.191.1">Entry point</span></h2>
<p><span class="koboSpan" id="kobo.192.1">The server file is the entry point to</span><a id="_idIndexMarker497"/><span class="koboSpan" id="kobo.193.1"> provide most of the capabilities of our backend framework. </span><span class="koboSpan" id="kobo.193.2">It bootstraps a process, loads the appropriate configuration, connects to a database if specified, and establishes the request route handlers. </span><span class="koboSpan" id="kobo.193.3">In </span><a href="B19014_06.xhtml#_idTextAnchor089"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.194.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.195.1">, we had a simpler server (located in the project file at </span><strong class="source-inline"><span class="koboSpan" id="kobo.196.1">componium-test/blob/main/packages/browser/server.js</span></strong><span class="koboSpan" id="kobo.197.1">), developed using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">http.createServer(...)</span></strong><span class="koboSpan" id="kobo.199.1"> Node.js APIs. </span><span class="koboSpan" id="kobo.199.2">We can follow the same strategy and build a new server from scratch. </span><span class="koboSpan" id="kobo.199.3">However, for a full stack framework, we need a more established solution that has many server interfaces already in place. </span><span class="koboSpan" id="kobo.199.4">An excellent middle-ground choice for this project is to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">express</span></strong><span class="koboSpan" id="kobo.201.1"> module and create abstractions on top of it. </span><em class="italic"><span class="koboSpan" id="kobo.202.1">Express</span></em><span class="koboSpan" id="kobo.203.1"> will allow us to define middleware, custom routers, parse requests, craft API responses, and much more. </span><span class="koboSpan" id="kobo.203.2">If this sounds familiar, this is because this is a similar architecture to the NestJS framework project previewed in </span><a href="B19014_04.xhtml#_idTextAnchor063"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.204.1">Chapter 4</span></em></span></a><span class="No-Break"><span class="koboSpan" id="kobo.205.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.206.1">To expand the server functionality, we will also allow developers to create multiple servers in the same application context, </span><span class="No-Break"><span class="koboSpan" id="kobo.207.1">like so:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.208.1">
import Componium from "componium";
const app = await Componium.initialize();
const server = await app.createServer({...});</span></pre>
<p><span class="koboSpan" id="kobo.209.1">With the</span><a id="_idIndexMarker498"/><span class="koboSpan" id="kobo.210.1"> server interfaces in place, we can now accept requests on a port and configure the servers with options that fit our requirements. </span><span class="koboSpan" id="kobo.210.2">Once the server is created, as seen in the preceding code, the main purpose of it is to handle endpoints and perform backend tasks. </span><span class="koboSpan" id="kobo.210.3">For the purposes of handling endpoints, we will introduce the </span><em class="italic"><span class="koboSpan" id="kobo.211.1">router</span></em><span class="koboSpan" id="kobo.212.1"> interface. </span><span class="koboSpan" id="kobo.212.2">It comes into play to accept requests and enable the </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">API features.</span></span></p>
<h2 id="_idParaDest-117"><a id="_idTextAnchor116"/><span class="koboSpan" id="kobo.214.1">Router</span></h2>
<p><span class="koboSpan" id="kobo.215.1">In this framework, we want to </span><a id="_idIndexMarker499"/><span class="koboSpan" id="kobo.216.1">provide options for file-based and dynamic routing. </span><span class="koboSpan" id="kobo.216.2">This involves using a similar feature to file-based routers in Next.js. </span><span class="koboSpan" id="kobo.216.3">We saw this concept in the overview of the building blocks in </span><a href="B19014_02.xhtml#_idTextAnchor030"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.217.1">Chapter 2</span></em></span></a><span class="koboSpan" id="kobo.218.1">. </span><span class="koboSpan" id="kobo.218.2">The router implementations can be found in the server package of the framework â€“ for example, the file-based router is </span><span class="No-Break"><span class="koboSpan" id="kobo.219.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">packages/server/file-router.js</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.221.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.222.1">The file-based router implementation is capable of recursively loading API endpoints from a directory structure. </span><span class="koboSpan" id="kobo.222.2">The file-based feature allows for some manual configuration. </span><span class="koboSpan" id="kobo.222.3">By default, the framework can look in a </span><strong class="source-inline"><span class="koboSpan" id="kobo.223.1">routes</span></strong><span class="koboSpan" id="kobo.224.1"> directory of a project. </span><span class="koboSpan" id="kobo.224.2">However, that can be adjusted by passing a file-router directory option to the server configuration. </span><span class="koboSpan" id="kobo.224.3">For details on the implementation of a file-based router, refer to the following package â€“ </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.225.1">packages/server/file-router.js</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.227.1">As we need to handle different HTTP methods in our file router, we can establish a pattern for the HTTP methods. </span><span class="koboSpan" id="kobo.227.2">This way, if you make a </span><strong class="source-inline"><span class="koboSpan" id="kobo.228.1">POST</span></strong><span class="koboSpan" id="kobo.229.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.230.1">DELETE</span></strong><span class="koboSpan" id="kobo.231.1"> request, you are still able to indicate what type of HTTP method the file should respond to. </span><span class="koboSpan" id="kobo.231.2">To enable this functionality, we will configure the framework to handle files in the following manner. </span><span class="koboSpan" id="kobo.231.3">Files ending with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.232.1">.post.js</span></strong><span class="koboSpan" id="kobo.233.1"> will indicate that this route is a </span><strong class="source-inline"><span class="koboSpan" id="kobo.234.1">POST</span></strong><span class="koboSpan" id="kobo.235.1"> method route. </span><span class="koboSpan" id="kobo.235.2">Files omitting this configuration will default to a </span><strong class="source-inline"><span class="koboSpan" id="kobo.236.1">GET</span></strong><span class="koboSpan" id="kobo.237.1"> handler. </span><span class="koboSpan" id="kobo.237.2">To handle index or root endpoint routes, we will use an </span><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">_index.js</span></strong><span class="koboSpan" id="kobo.239.1"> file. </span><span class="koboSpan" id="kobo.239.2">This indicates that it is the root handler. </span><span class="koboSpan" id="kobo.239.3">For example, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.240.1">api/</span></strong><span class="koboSpan" id="kobo.241.1"> directory can have the </span><strong class="source-inline"><span class="koboSpan" id="kobo.242.1">_index.js</span></strong><span class="koboSpan" id="kobo.243.1"> file, which will handle the requests to the root endpoint of the API. </span><span class="koboSpan" id="kobo.243.2">Refer to </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.244.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.245.1">.4</span></em><span class="koboSpan" id="kobo.246.1"> to see the directory structure of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.247.1">api/</span></strong><span class="koboSpan" id="kobo.248.1"> directory. </span><span class="koboSpan" id="kobo.248.2">You can find an example of this in the sample application in the GitHub repository </span><span class="No-Break"><span class="koboSpan" id="kobo.249.1">at </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.250.1">componium/tests/sample/routes/api/_index.js</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.252.1">Besides file-based routing, developers will sometimes need to define the routes and modular routers directly or programmatically in their code. </span><span class="koboSpan" id="kobo.252.2">To support those use cases, our framework offers several server methods to allow flexibility around routes, middlewares, and custom</span><a id="_idIndexMarker500"/><span class="koboSpan" id="kobo.253.1"> routers, as shown in the following </span><span class="No-Break"><span class="koboSpan" id="kobo.254.1">code block:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.255.1">
server.addMiddleware("middleware1", () =&gt; {
Â Â console.log("Server middleware log");
});
server.addRoute("/dynamic", function (request, response) {
Â Â return response.send("Dynamic Path");
});
const router = server.createRouter("/router");
router.addMiddleware("routerMiddleware", (request) =&gt; {
Â Â console.log("Router middleware:", request.originalUrl);
});
router.addRoute("/sample", function (request, response) {
Â Â return response.send("Router Sample");
});</span></pre>
<p><span class="koboSpan" id="kobo.256.1">Reading the preceding middleware code, we can see some of the methods that our framework offers to enable dynamic routing. </span><span class="koboSpan" id="kobo.256.2">Backed by the primitives from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.257.1">express</span></strong><span class="koboSpan" id="kobo.258.1"> package, we can create a more abstract system that provides a custom way to describe router definitions. </span><span class="koboSpan" id="kobo.258.2">As always, it also allows us to swap out the </span><strong class="source-inline"><span class="koboSpan" id="kobo.259.1">express</span></strong><span class="koboSpan" id="kobo.260.1"> module in favor of something else later on if required. </span><span class="koboSpan" id="kobo.260.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.261.1">addRoute</span></strong><span class="koboSpan" id="kobo.262.1"> methods are present on both the server and custom router objects. </span><span class="koboSpan" id="kobo.262.2">These allow us to add custom route handlers instead of using file-based handlers. </span><span class="koboSpan" id="kobo.262.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">addRoute</span></strong><span class="koboSpan" id="kobo.264.1"> function takes an argument of the route path and a function that has request/response arguments, used to process the request. </span><span class="koboSpan" id="kobo.264.2">This route-handling flow is visualized in the preceding code, which creates a server middleware, a new route, and an additional router with its own routing entities. </span><span class="koboSpan" id="kobo.264.3">Further details on router capabilities can be found </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">at </span></span><a href="https://expressjs.com/en/guide/routing.html"><span class="No-Break"><span class="koboSpan" id="kobo.266.1">expressjs.com/en/guide/routing.html</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.267.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.268.1">In addition to routing methods, we have additional middleware management functions, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">addMiddleware</span></strong><span class="koboSpan" id="kobo.270.1">. </span><span class="koboSpan" id="kobo.270.2">These methods allow us to configure any self-developed or external middleware. </span><span class="koboSpan" id="kobo.270.3">In this case, it makes our framework compatible with other express-based middleware. </span><span class="koboSpan" id="kobo.270.4">For example, we can use it to add authentication to our endpoints using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.271.1">passport</span></strong><span class="koboSpan" id="kobo.272.1"> module (</span><a href="https://github.com/jaredhanson/passport"><span class="koboSpan" id="kobo.273.1">github.com/jaredhanson/passport</span></a><span class="koboSpan" id="kobo.274.1">); this will enable the framework to support a huge variety of </span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">authentication options.</span></span></p>
<p><span class="koboSpan" id="kobo.276.1">The </span><a id="_idIndexMarker501"/><span class="koboSpan" id="kobo.277.1">established architecture of the router and entry points allows us to actually create an application process that can accept requests. </span><span class="koboSpan" id="kobo.277.2">In the following subsections, we will define the ability to configure different components of </span><span class="No-Break"><span class="koboSpan" id="kobo.278.1">our framework.</span></span></p>
<h2 id="_idParaDest-118"><a id="_idTextAnchor117"/><span class="koboSpan" id="kobo.279.1">Configuration</span></h2>
<p><span class="koboSpan" id="kobo.280.1">Developers expect a clean way to</span><a id="_idIndexMarker502"/><span class="koboSpan" id="kobo.281.1"> configure a framework-based application, with capabilities to run it in local, test, and production environments. </span><span class="koboSpan" id="kobo.281.2">To enable this, we will utilize the </span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">config</span></strong><span class="koboSpan" id="kobo.283.1"> package (located at </span><a href="https://npmjs.com/package/config"><span class="koboSpan" id="kobo.284.1">npmjs.com/package/config</span></a><span class="koboSpan" id="kobo.285.1">). </span><span class="koboSpan" id="kobo.285.2">This package will allow us to elegantly organize the configuration options and let the application code base behave differently, based on </span><span class="No-Break"><span class="koboSpan" id="kobo.286.1">the environment.</span></span></p>
<p><span class="koboSpan" id="kobo.287.1">To provide a simple example, if we had only one property to configure, then our configuration file, </span><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">default.json</span></strong><span class="koboSpan" id="kobo.289.1">, would look something </span><span class="No-Break"><span class="koboSpan" id="kobo.290.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.291.1">
{
Â Â "database": {
Â Â Â Â "connection_uri": "sqlite::memory"
Â Â }
}</span></pre>
<p><span class="koboSpan" id="kobo.292.1">With the </span><strong class="source-inline"><span class="koboSpan" id="kobo.293.1">config</span></strong><span class="koboSpan" id="kobo.294.1"> package, we</span><a id="_idIndexMarker503"/><span class="koboSpan" id="kobo.295.1"> can access the configuration in any of the framework modules and allow it to be used for any developer purposes from within the </span><span class="No-Break"><span class="koboSpan" id="kobo.296.1">code base:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.297.1">
import config from "config";
console.log("config", config.get
Â Â ("database.connection_uri"));</span></pre>
<p><span class="koboSpan" id="kobo.298.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.299.1">config</span></strong><span class="koboSpan" id="kobo.300.1"> package automatically loads the required file and allows us to fetch data out of that configuration storage and access all the set properties. </span><span class="koboSpan" id="kobo.300.2">In the preceding configuration code, we get to fetch the database connection URL that can be used to bootstrap the database connection from </span><span class="No-Break"><span class="koboSpan" id="kobo.301.1">the application.</span></span></p>
<p><span class="koboSpan" id="kobo.302.1">As with other modules, we can create abstraction on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.303.1">config</span></strong><span class="koboSpan" id="kobo.304.1"> package. </span><span class="koboSpan" id="kobo.304.2">However, we want to offer the core features of the package for developersâ€™ use. </span><span class="koboSpan" id="kobo.304.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.305.1">config</span></strong><span class="koboSpan" id="kobo.306.1"> package supports several file formats for application configuration, such</span><a id="_idIndexMarker504"/><span class="koboSpan" id="kobo.307.1"> as YAML (</span><a href="https://yaml.org"><span class="koboSpan" id="kobo.308.1">yaml.org</span></a><span class="koboSpan" id="kobo.309.1">), JSON, or straight-up JavaScript. </span><span class="koboSpan" id="kobo.309.2">Providing a choice of formats is helpful, as it enables us to meet the requirements of the application deployment tools. </span><span class="koboSpan" id="kobo.309.3">For example, developer operations might prefer to structure all the production configurations with </span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">YAML files.</span></span></p>
<p><span class="koboSpan" id="kobo.311.1">Configuring aspects of applications within a framework can become remarkably complex, due to the variety of configuration formats and methods available. </span><span class="koboSpan" id="kobo.311.2">The JavaScript ecosystem provides dozens of packages that can help you with configuration. </span><span class="koboSpan" id="kobo.311.3">Try to evaluate some of them to find the one that fits your needs best. </span><span class="koboSpan" id="kobo.311.4">Consider the types of configuration file extensions that a package supports and what kind of validation it can perform. </span><span class="koboSpan" id="kobo.311.5">Furthermore, in the following subsection, we will highlight how your framework should offer a set of defaults that work for </span><span class="No-Break"><span class="koboSpan" id="kobo.312.1">your users.</span></span></p>
<h2 id="_idParaDest-119"><a id="_idTextAnchor118"/><span class="koboSpan" id="kobo.313.1">Sensible defaults</span></h2>
<p><strong class="bold"><span class="koboSpan" id="kobo.314.1">Sensible defaults</span></strong><span class="koboSpan" id="kobo.315.1"> are</span><a id="_idIndexMarker505"/><span class="koboSpan" id="kobo.316.1"> a crucial aspect of a practical application </span><a id="_idIndexMarker506"/><span class="koboSpan" id="kobo.317.1">configuration strategy. </span><span class="koboSpan" id="kobo.317.2">The baseline configuration inside of a framework makes it easy for applications to work out of the box. </span><span class="koboSpan" id="kobo.317.3">Usually, you want to support the most common scenario, such as the development environment. </span><span class="koboSpan" id="kobo.317.4">Sensible defaults will</span><a id="_idIndexMarker507"/><span class="koboSpan" id="kobo.318.1"> allow developers to quickly test-run the framework and see whether they can achieve their project goals by building a prototype. </span><span class="koboSpan" id="kobo.318.2">This is especially handy for new developers. </span><span class="koboSpan" id="kobo.318.3">Later, the defaults can be overridden to fit the production environment and its requirements. </span><span class="koboSpan" id="kobo.318.4">Using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.319.1">config</span></strong><span class="koboSpan" id="kobo.320.1"> package features will allow us to specify the defaults in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.321.1">default.js</span></strong><span class="koboSpan" id="kobo.322.1"> file. </span><span class="koboSpan" id="kobo.322.2">This file will act as a template for an applicationâ€™s configuration. </span><span class="koboSpan" id="kobo.322.3">The configuration file can also be scaffolded in different ways; we will look into this further in the </span><em class="italic"><span class="koboSpan" id="kobo.323.1">Developer </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.324.1">experience</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.325.1"> section.</span></span></p>
<p><span class="koboSpan" id="kobo.326.1">Reducing the </span><a id="_idIndexMarker508"/><span class="koboSpan" id="kobo.327.1">amount of configuration in your framework is something to strive for. </span><span class="koboSpan" id="kobo.327.2">It is key to creating a consistent experience and reducing the burdens of building new projects with </span><span class="No-Break"><span class="koboSpan" id="kobo.328.1">your framework.</span></span></p>
<h2 id="_idParaDest-120"><a id="_idTextAnchor119"/><span class="koboSpan" id="kobo.329.1">Database</span></h2>
<p><span class="koboSpan" id="kobo.330.1">As we add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.331.1">database</span></strong><span class="koboSpan" id="kobo.332.1"> functionality to</span><a id="_idIndexMarker509"/><span class="koboSpan" id="kobo.333.1"> our framework, we need to make sure to support a wide variety of databases. </span><span class="koboSpan" id="kobo.333.2">The project should also offer a unified, abstract way to work with database objects. </span><span class="koboSpan" id="kobo.333.3">To support these use cases, we can rely on a higher abstract library that enables ORM. </span><span class="koboSpan" id="kobo.333.4">For this chapterâ€™s example, we will rely on an open source ORM library called </span><strong class="bold"><span class="koboSpan" id="kobo.334.1">Sequelize</span></strong><span class="koboSpan" id="kobo.335.1"> (</span><a href="https://sequelize.org"><span class="koboSpan" id="kobo.336.1">sequelize.org</span></a><span class="koboSpan" id="kobo.337.1">). </span><span class="koboSpan" id="kobo.337.2">This library gives us support for MySQL, PostgreSQL, and </span><a id="_idIndexMarker510"/><span class="koboSpan" id="kobo.338.1">MSSQL out of the box. </span><span class="koboSpan" id="kobo.338.2">It also enables us to use SQLite in local development and other environments, which makes it really easy to work with database operations and not connect to more complex database services. </span><span class="koboSpan" id="kobo.338.3">An ORM library such as Sequelize will add capabilities to interact with a database using JavaScript. </span><span class="koboSpan" id="kobo.338.4">It will allow us to treat database entities as objects, simplifying data manipulation </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">and extraction.</span></span></p>
<p><span class="koboSpan" id="kobo.340.1">In Componium, the database interface can be found in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.341.1">db</span></strong><span class="koboSpan" id="kobo.342.1"> package. </span><span class="koboSpan" id="kobo.342.2">While some parts of interaction with Sequelize are abstracted, we still rely on the users of our framework to get familiar with the library and its features directly. </span><span class="koboSpan" id="kobo.342.3">It is common to see large frameworks rely on separate ORM layers, due to the fact that implementing and supporting several database engines requires a lot of investment in code </span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">and time.</span></span></p>
<p><span class="koboSpan" id="kobo.344.1">When a new application is initialized in code, a framework automatically tries to make a connection to the configured database. </span><span class="koboSpan" id="kobo.344.2">To operate with database entities, the application needs to load the model files. </span><span class="koboSpan" id="kobo.344.3">In the Componium framework, the models are stored in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.345.1">models</span></strong><span class="koboSpan" id="kobo.346.1"> directory and loaded during the initialization as well. </span><span class="koboSpan" id="kobo.346.2">This application structure allows framework users to keep data models organized and modular. </span><span class="koboSpan" id="kobo.346.3">The models can then be used within your route handlers to interact with the database, whether you need to create, read, update, or delete data. </span><span class="koboSpan" id="kobo.346.4">Hereâ€™s an example of a model we can use in </span><span class="No-Break"><span class="koboSpan" id="kobo.347.1">the app:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.348.1">
import { DataTypes, Model } from "sequelize";
class Package extends Model {}
Package.init(
Â Â {
Â Â Â Â title: DataTypes.STRING,
Â Â Â Â address: DataTypes.STRING,
Â Â Â Â created: DataTypes.DATE,
Â Â },
Â Â { sequelize: componium.db, modelName: "package" }
);</span></pre>
<p><span class="koboSpan" id="kobo.349.1">To get </span><a id="_idIndexMarker511"/><span class="koboSpan" id="kobo.350.1">access or mutate this model in our route handlers, we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">componium</span></strong><span class="koboSpan" id="kobo.352.1"> object to get to the database entity object and perform </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">an operation:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.354.1">
export default async (req, res) =&gt; {
Â Â const packages = await componium.models
Â Â Â Â ["package"].findAll();
Â Â componium.logger.info(`Found packages ${JSON.stringify
Â Â Â Â (packages)}`);
Â Â res.json(packages);
};</span></pre>
<p><span class="koboSpan" id="kobo.355.1">The preceding </span><a id="_idIndexMarker512"/><span class="koboSpan" id="kobo.356.1">code, located in the application under </span><strong class="source-inline"><span class="koboSpan" id="kobo.357.1">sample/api/packages.js</span></strong><span class="koboSpan" id="kobo.358.1">, queries the packages stored in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.359.1">Package</span></strong><span class="koboSpan" id="kobo.360.1"> model. </span><span class="koboSpan" id="kobo.360.2">Finally, it returns all the objects found in a query in the route handler. </span><span class="koboSpan" id="kobo.360.3">For the purposes of this chapter, the database implementation is fairly simple, but you can take up the challenge to make the code more accommodating to handle multiple databases and improve model file coupling </span><span class="No-Break"><span class="koboSpan" id="kobo.361.1">if desired.</span></span></p>
<h2 id="_idParaDest-121"><a id="_idTextAnchor120"/><span class="koboSpan" id="kobo.362.1">GraphQL support</span></h2>
<p><span class="koboSpan" id="kobo.363.1">In addition to the several options to</span><a id="_idIndexMarker513"/><span class="koboSpan" id="kobo.364.1"> define API endpoints, our framework also supports </span><strong class="bold"><span class="koboSpan" id="kobo.365.1">GraphQL</span></strong><span class="koboSpan" id="kobo.366.1">, a powerful query language that is useful for backend data retrieval. </span><span class="koboSpan" id="kobo.366.2">Some </span><a id="_idIndexMarker514"/><span class="koboSpan" id="kobo.367.1">developers might prefer to use GraphQL with our framework, and they should have good experience in integrating </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">this system.</span></span></p>
<p><span class="koboSpan" id="kobo.369.1">The GraphQL module can be found in the chapter files under </span><strong class="source-inline"><span class="koboSpan" id="kobo.370.1">packages/server/graphql.js</span></strong><span class="koboSpan" id="kobo.371.1">. </span><span class="koboSpan" id="kobo.371.2">Following a similar design for a file-based router, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.372.1">componium</span></strong><span class="koboSpan" id="kobo.373.1"> framework has a feature to make it easier to develop modular schemas for GraphQL. </span><span class="koboSpan" id="kobo.373.2">These schemas can be defined in separate files and later assembled into full schemas that are supported by every Componium server object. </span><span class="koboSpan" id="kobo.373.3">Every GraphQL type definition can be defined in its own </span><strong class="source-inline"><span class="koboSpan" id="kobo.374.1">*.gql.js</span></strong><span class="koboSpan" id="kobo.375.1"> file. </span><span class="koboSpan" id="kobo.375.2">Hereâ€™s an example of a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.376.1">packages.gql.js</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.377.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.378.1">
const typeDefs = `#graphql
Â Â scalar Date
Â Â type Package {
Â Â Â Â title: String,
Â Â Â Â address: String,
Â Â Â Â created: Date,
Â Â }
Â Â type Query {
Â Â Â Â packages: [Package]
Â Â }
`;</span></pre>
<p><span class="koboSpan" id="kobo.379.1">First, we define a sample definition for the package type so that we can query the data for that </span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">particular model:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.381.1">
const resolvers = {
Â Â Query: {
Â Â Â Â packages: async () =&gt; {
Â Â Â Â Â Â const packages = await componium.models
Â Â Â Â Â Â Â Â ["package"].findAll();
Â Â Â Â Â Â componium.logger.info(`Found packages ${JSON.
</span><span class="koboSpan" id="kobo.381.2">Â Â Â Â Â Â Â Â stringify(packages)}`);
Â Â Â Â Â Â return packages;
Â Â Â Â },
Â Â },
};
export {typeDefs, resolvers };</span></pre>
<p><span class="koboSpan" id="kobo.382.1">The preceding</span><a id="_idIndexMarker515"/><span class="koboSpan" id="kobo.383.1"> code uses the schema definition for a Package type that queries the entries for the objects related to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.384.1">Package</span></strong><span class="koboSpan" id="kobo.385.1"> model, retrieving all the stored packages in the database. </span><span class="koboSpan" id="kobo.385.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.386.1">.findAll()</span></strong><span class="koboSpan" id="kobo.387.1"> call is the built-in interface related to the ORM package that is used under </span><span class="No-Break"><span class="koboSpan" id="kobo.388.1">the hood.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer064">
<span class="koboSpan" id="kobo.389.1"><img alt="Figure 7.5: An Apollo GraphQL sandbox request" src="image/Figure_7.5_B19014.png.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.390.1">Figure 7.5: An Apollo GraphQL sandbox request</span></p>
<p><span class="koboSpan" id="kobo.391.1">The database </span><a id="_idIndexMarker516"/><span class="koboSpan" id="kobo.392.1">items can now be retrieved using the query language. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.393.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.394.1">.5</span></em><span class="koboSpan" id="kobo.395.1"> shows an interface of the </span><strong class="bold"><span class="koboSpan" id="kobo.396.1">Apollo Server Sandbox</span></strong><span class="koboSpan" id="kobo.397.1"> (</span><a href="https://github.com/apollographql/apollo-server"><span class="koboSpan" id="kobo.398.1">github.com/apollographql/apollo-server</span></a><span class="koboSpan" id="kobo.399.1">), which allows us to play around with the defined GraphQL schemas. </span><span class="koboSpan" id="kobo.399.2">This functionality is available to the users of our framework because Componium utilizes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.400.1">@apollo/server</span></strong><span class="koboSpan" id="kobo.401.1"> package. </span><span class="koboSpan" id="kobo.401.2">GraphQL support can be enabled or disabled by specifying the </span><strong class="source-inline"><span class="koboSpan" id="kobo.402.1">gql</span></strong><span class="koboSpan" id="kobo.403.1"> option when we create new Componium servers, by calling the </span><strong class="source-inline"><span class="koboSpan" id="kobo.404.1">app.createServer({gql: </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.405.1">false})</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.406.1"> method.</span></span></p>
<p><span class="koboSpan" id="kobo.407.1">If you are looking to learn more about GraphQL, check out some of the publications related to it at </span><a href="https://packtpub.com/search?query=graphql&amp;products=Book"><span class="koboSpan" id="kobo.408.1">packtpub.com/search?query=graphql&amp;products=Book</span></a><span class="koboSpan" id="kobo.409.1">, especially the </span><em class="italic"><span class="koboSpan" id="kobo.410.1">Full Stack Web Development with GraphQL and React</span></em><span class="koboSpan" id="kobo.411.1"> book. </span><span class="koboSpan" id="kobo.411.2">Many aspects of GraphQL can get really complex quickly, but it is a good example of a feature you can add to your </span><a id="_idIndexMarker517"/><span class="koboSpan" id="kobo.412.1">framework to enable a powerful query language based on an </span><span class="No-Break"><span class="koboSpan" id="kobo.413.1">established specification.</span></span></p>
<p><span class="koboSpan" id="kobo.414.1">The next subsection focuses on observability, which will help to make sure the GraphQL feature works properly in applications and we can acquire enough visibility into the internals of the projects </span><span class="No-Break"><span class="koboSpan" id="kobo.415.1">using logging.</span></span></p>
<h2 id="_idParaDest-122"><a id="_idTextAnchor121"/><span class="koboSpan" id="kobo.416.1">Observability</span></h2>
<p><span class="koboSpan" id="kobo.417.1">The final feature that is worth highlighting </span><a id="_idIndexMarker518"/><span class="koboSpan" id="kobo.418.1">has to deal with </span><strong class="bold"><span class="koboSpan" id="kobo.419.1">observability</span></strong><span class="koboSpan" id="kobo.420.1">. </span><span class="koboSpan" id="kobo.420.2">Our framework should offer an interface to allow developers to log essential operations to a file. </span><span class="koboSpan" id="kobo.420.3">The framework itself should automatically log any sensitive operations that the developer should be </span><span class="No-Break"><span class="koboSpan" id="kobo.421.1">aware of.</span></span></p>
<p><span class="koboSpan" id="kobo.422.1">This is where the </span><em class="italic"><span class="koboSpan" id="kobo.423.1">winston</span></em><span class="koboSpan" id="kobo.424.1">-based </span><strong class="source-inline"><span class="koboSpan" id="kobo.425.1">Logger</span></strong><span class="koboSpan" id="kobo.426.1"> class comes into play; you can find the implementation in the frameworkâ€™s </span><strong class="source-inline"><span class="koboSpan" id="kobo.427.1">packages/app/logger.js</span></strong><span class="koboSpan" id="kobo.428.1"> file. </span><span class="koboSpan" id="kobo.428.2">winston (</span><a href="https://github.com/winstonjs/winston"><span class="koboSpan" id="kobo.429.1">github.com/winstonjs/winston</span></a><span class="koboSpan" id="kobo.430.1">) is a logging library that can output the logs in flexible ways and is compatible with various deployment environments. </span><span class="koboSpan" id="kobo.430.2">It provides a simple and straightforward interface for logging, allowing developers to easily incorporate logging into their applications with minimal effort. </span><span class="koboSpan" id="kobo.430.3">This not only ensures that developers have granular control over what gets logged but also standardizes the way logs are generated across </span><span class="No-Break"><span class="koboSpan" id="kobo.431.1">an application.</span></span></p>
<p><span class="koboSpan" id="kobo.432.1">The logger class is designed to be flexible with respect to the logging environment. </span><span class="koboSpan" id="kobo.432.2">It is configured to log to a console in non-production environments, allowing for real-time debugging during the development stages. </span><span class="koboSpan" id="kobo.432.3">In production, the logs are written to specified files, providing a permanent record of the applicationâ€™s operation and behavior that can be referred back to when needed. </span><span class="koboSpan" id="kobo.432.4">This separation of environments also provides a level of safety, ensuring that sensitive data is not inadvertently exposed during development. </span><span class="koboSpan" id="kobo.432.5">These logs can then be used to diagnose and troubleshoot issues, enhancing the observability and reliability of the application. </span><span class="koboSpan" id="kobo.432.6">As discussed in the </span><em class="italic"><span class="koboSpan" id="kobo.433.1">GraphQL support</span></em><span class="koboSpan" id="kobo.434.1"> section earlier, we will use the logger to keep track of the </span><span class="No-Break"><span class="koboSpan" id="kobo.435.1">found packages:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.436.1">
componium.logger.info(`Found packages ${JSON.
</span><span class="koboSpan" id="kobo.436.2">Â Â sstringify(packages)}`);</span></pre>
<p><span class="koboSpan" id="kobo.437.1">In development mode, this logger will provide information in the terminal console; this way, this information can effortlessly be seen during the feature development phase. </span><span class="koboSpan" id="kobo.437.2">Once the application is deployed and running in the production environment, it will log into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">error.log</span></strong><span class="koboSpan" id="kobo.439.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.440.1">combined.log</span></strong><span class="koboSpan" id="kobo.441.1"> files. </span><span class="koboSpan" id="kobo.441.2">The format of the logs in those files will be JSON, such as </span><span class="No-Break"><span class="koboSpan" id="kobo.442.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.443.1">
{"level":"info","message":"Found packages [{\"id\":1,\"title\":\"Paper Delivery\",\"address\":\"123 Main St.\",\"createdAt\":\"2023-02-01T05:00:00.000Z\",\"updatedAt\":\"2023-02-01T05:00:00.000Z\"}]","service":"package-service"}</span></pre>
<p><span class="koboSpan" id="kobo.444.1">This </span><strong class="source-inline"><span class="koboSpan" id="kobo.445.1">logger</span></strong><span class="koboSpan" id="kobo.446.1"> class has the interface to log </span><strong class="source-inline"><span class="koboSpan" id="kobo.447.1">.info</span></strong><span class="koboSpan" id="kobo.448.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.449.1">.warn</span></strong><span class="koboSpan" id="kobo.450.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.451.1">.error</span></strong><span class="koboSpan" id="kobo.452.1"> messages. </span><span class="koboSpan" id="kobo.452.2">It will empower developers by providing a way to keep track of the application behavior, debug issues, and store necessary logs that can later </span><span class="No-Break"><span class="koboSpan" id="kobo.453.1">be parsed.</span></span></p>
<p><span class="koboSpan" id="kobo.454.1">Concluding </span><a id="_idIndexMarker519"/><span class="koboSpan" id="kobo.455.1">the </span><em class="italic"><span class="koboSpan" id="kobo.456.1">Architecture</span></em><span class="koboSpan" id="kobo.457.1"> section, we now have insight into entry points, routing, logging, database, and endpoint support. </span><span class="koboSpan" id="kobo.457.2">These are plenty of features for the first iteration of the project. </span><span class="koboSpan" id="kobo.457.3">Further, we will connect these features with an improved </span><span class="No-Break"><span class="koboSpan" id="kobo.458.1">developer experience.</span></span></p>
<h1 id="_idParaDest-123"><a id="_idTextAnchor122"/><span class="koboSpan" id="kobo.459.1">Developer experience</span></h1>
<p><span class="koboSpan" id="kobo.460.1">With several</span><a id="_idIndexMarker520"/><span class="koboSpan" id="kobo.461.1"> essential backend features built, we can now focus on the developer experience aspects. </span><span class="koboSpan" id="kobo.461.2">Earlier referenced in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.462.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.463.1">.1</span></em><span class="koboSpan" id="kobo.464.1">, this is the second important aspect of the framework we will focus on. </span><span class="koboSpan" id="kobo.464.2">The goal behind introducing framework-adjacent developer tools is to lessen the friction of adapting the features of our framework. </span><span class="koboSpan" id="kobo.464.3">It also helps to streamline the experience and create a unified way to work with the </span><span class="No-Break"><span class="koboSpan" id="kobo.465.1">frameworkâ€™s primitives.</span></span></p>
<p><span class="koboSpan" id="kobo.466.1">To enable most of this experience, we will rely on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.467.1">componium</span></strong><span class="koboSpan" id="kobo.468.1"> executable that ships with the framework when it is installed. </span><span class="koboSpan" id="kobo.468.2">This executable will take care of a lot of mundane tasks, such as initializing applications and scaffolding standard components. </span><span class="koboSpan" id="kobo.468.3">It will also eliminate common points of friction by enabling features such as live </span><span class="No-Break"><span class="koboSpan" id="kobo.469.1">server reload.</span></span></p>
<p><span class="koboSpan" id="kobo.470.1">In the next three subsections, we will explore three potential developer experience offerings that you can provide to the users of </span><span class="No-Break"><span class="koboSpan" id="kobo.471.1">your framework.</span></span></p>
<h2 id="_idParaDest-124"><a id="_idTextAnchor123"/><span class="koboSpan" id="kobo.472.1">Bootstrapping a new application</span></h2>
<p><span class="koboSpan" id="kobo.473.1">The Componium</span><a id="_idIndexMarker521"/><span class="koboSpan" id="kobo.474.1"> frameworkâ€™s </span><strong class="source-inline"><span class="koboSpan" id="kobo.475.1">componium</span></strong><span class="koboSpan" id="kobo.476.1"> executable shipped with the library simplifies the process of bootstrapping a new application. </span><span class="koboSpan" id="kobo.476.2">Rather than setting up a new application from scratch, the developer can just run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.477.1">npx componium init</span></strong><span class="koboSpan" id="kobo.478.1"> command. </span><span class="koboSpan" id="kobo.478.2">This command will provide options to create a basic project structure with all the necessary configurations and dependencies set up. </span><span class="koboSpan" id="kobo.478.3">The initialization process saves a significant amount of time and ensures consistency across different projects built using the framework. </span><span class="koboSpan" id="kobo.478.4">The command has the flexibility to accept parameters such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.479.1">npx componium init my-app</span></strong><span class="koboSpan" id="kobo.480.1"> to create a new application structure in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.481.1">my-app</span></strong><span class="koboSpan" id="kobo.482.1"> directory. </span><span class="koboSpan" id="kobo.482.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.483.1">init</span></strong><span class="koboSpan" id="kobo.484.1"> feature is great for developers, since it automates the repetitive and error-prone process of creating new applications </span><span class="No-Break"><span class="koboSpan" id="kobo.485.1">from nothing.</span></span></p>
<p><span class="koboSpan" id="kobo.486.1">Making this bootstrapping process easy is key for new developers to get started using the framework. </span><span class="koboSpan" id="kobo.486.2">Looking back to </span><a href="B19014_01.xhtml#_idTextAnchor015"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.487.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.488.1">, you will find that almost every framework offers one or several ways of bootstrapping projects, using a CLI tool or a </span><span class="No-Break"><span class="koboSpan" id="kobo.489.1">similar mechanism.</span></span></p>
<h2 id="_idParaDest-125"><a id="_idTextAnchor124"/><span class="koboSpan" id="kobo.490.1">Scaffolding</span></h2>
<p><span class="koboSpan" id="kobo.491.1">To continue on the theme of reducing</span><a id="_idIndexMarker522"/><span class="koboSpan" id="kobo.492.1"> error-prone tasks, scaffolding is a highly beneficial feature that further enhances the developer experience. </span><span class="koboSpan" id="kobo.492.2">It allows developers to automatically generate boilerplate code for components that are supported by the framework. </span><span class="koboSpan" id="kobo.492.3">In the framework exercise of this chapter, we will support creating things such as models, GraphQL schemas, </span><span class="No-Break"><span class="koboSpan" id="kobo.493.1">and routes.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer065">
<span class="koboSpan" id="kobo.494.1"><img alt="Figure 7.6: An example of the scaffolding experience" src="image/Figure_7.6_B19014.png.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.495.1">Figure 7.6: An example of the scaffolding experience</span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.496.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.497.1">.6</span></em><span class="koboSpan" id="kobo.498.1"> showcases the developer experience when running the framework executable to scaffold some new components inside of new applications. </span><span class="koboSpan" id="kobo.498.2">A highly detailed description can be provided for each option that helps explain the potential options of each operation. </span><span class="koboSpan" id="kobo.498.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">create</span></strong><span class="koboSpan" id="kobo.500.1"> command can also support a direct set of parameters to avoid the </span><strong class="source-inline"><span class="koboSpan" id="kobo.501.1">Select</span></strong><span class="koboSpan" id="kobo.502.1"> interface for more advanced users of the framework. </span><span class="koboSpan" id="kobo.502.2">The scaffolding commands can demonstrate best practices and quickly teach developers about the </span><span class="No-Break"><span class="koboSpan" id="kobo.503.1">frameworkâ€™s capabilities.</span></span></p>
<p><span class="koboSpan" id="kobo.504.1">In addition, the new project initialization scaffolding options can include the framework features a developer wants to use. </span><span class="koboSpan" id="kobo.504.2">For example, they can choose the defaults or customize the project and choose their database type, enable GraphQL support, opt in for the file-based router, and so on. </span><span class="koboSpan" id="kobo.504.3">To successfully perform this workflow step, the framework has to provide clear instructions related to initializing and setting up </span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">the project.</span></span></p>
<p><span class="koboSpan" id="kobo.506.1">Scaffolding is</span><a id="_idIndexMarker523"/><span class="koboSpan" id="kobo.507.1"> super common in many projects and is a must-have for new projects. </span><span class="koboSpan" id="kobo.507.2">In some cases, the scaffolding features can ship separately from the main project. </span><span class="koboSpan" id="kobo.507.3">However, providing the ability to scaffold greatly improves interaction with </span><span class="No-Break"><span class="koboSpan" id="kobo.508.1">your framework.</span></span></p>
<h2 id="_idParaDest-126"><a id="_idTextAnchor125"/><span class="koboSpan" id="kobo.509.1">File watching</span></h2>
<p><span class="koboSpan" id="kobo.510.1">File watching</span><a id="_idIndexMarker524"/><span class="koboSpan" id="kobo.511.1"> is another </span><a id="_idIndexMarker525"/><span class="koboSpan" id="kobo.512.1">valuable feature provided by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.513.1">componium</span></strong><span class="koboSpan" id="kobo.514.1"> executable. </span><span class="koboSpan" id="kobo.514.2">In this case, itâ€™s used for internal usage via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.515.1">componium dev</span></strong><span class="koboSpan" id="kobo.516.1"> command. </span><span class="koboSpan" id="kobo.516.2">This feature watches for changes in the source code files of the application. </span><span class="koboSpan" id="kobo.516.3">It later automatically rebuilds and restarts the server whenever a change is detected. </span><span class="koboSpan" id="kobo.516.4">This means that developers can see the results of their changes faster and iterate faster. </span><span class="koboSpan" id="kobo.516.5">This file-watching infrastructure will come in handy as we further develop the backend features of the framework. </span><span class="koboSpan" id="kobo.516.6">It can also be beneficial for the next chapter, where we introduce frontend components that will need to be rebuilt as they are </span><span class="No-Break"><span class="koboSpan" id="kobo.517.1">iterated upon.</span></span></p>
<p><span class="koboSpan" id="kobo.518.1">The combination of these features â€“ easy initialization, detailed code scaffolding, and file watching â€“ creates an excellent developer experience, as it allows developers to focus on the projectâ€™s requirements. </span><span class="koboSpan" id="kobo.518.2">We shall see how these developer features are relevant in the next section, as they relate to an example workflow utilizing our newly </span><span class="No-Break"><span class="koboSpan" id="kobo.519.1">developed framework.</span></span></p>
<p><span class="koboSpan" id="kobo.520.1">The three examples of improvements to the developer experience help to define the specific tasks in which framework authors can invest. </span><span class="koboSpan" id="kobo.520.2">These enhancements aim to improve the overall usability of the project. </span><span class="koboSpan" id="kobo.520.3">In the next section, the workflow that we will discuss how these scaffolding and file-watching tools can be utilized and accompany the framework project and makes it more pleasant </span><span class="No-Break"><span class="koboSpan" id="kobo.521.1">to use.</span></span></p>
<h1 id="_idParaDest-127"><a id="_idTextAnchor126"/><span class="koboSpan" id="kobo.522.1">Developer workflow</span></h1>
<p><span class="koboSpan" id="kobo.523.1">In the previous sections of the chapter, we</span><a id="_idIndexMarker526"/><span class="koboSpan" id="kobo.524.1"> identified the project goals, developed the architecture, and described a few sample features of the framework. </span><span class="koboSpan" id="kobo.524.2">In this workflow section, let us summarize how developers can take advantage of the project and understand </span><span class="No-Break"><span class="koboSpan" id="kobo.525.1">their workflow.</span></span></p>
<p><span class="koboSpan" id="kobo.526.1">Here are the parts of the workflow, including some of the steps required on the framework developer side to make the project available </span><span class="No-Break"><span class="koboSpan" id="kobo.527.1">for consumption.</span></span></p>
<h2 id="_idParaDest-128"><a id="_idTextAnchor127"/><span class="koboSpan" id="kobo.528.1">Framework distribution</span></h2>
<p><span class="koboSpan" id="kobo.529.1">A newly created</span><a id="_idIndexMarker527"/><span class="koboSpan" id="kobo.530.1"> JavaScript framework is published publicly or privately on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.531.1">npm</span></strong><span class="koboSpan" id="kobo.532.1"> package registry. </span><span class="koboSpan" id="kobo.532.2">When a framework author wants to keep the project fully private, it can be consumed from a private Git repository within the internal infrastructure. </span><span class="koboSpan" id="kobo.532.3">This whole framework package includes a </span><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">README</span></strong><span class="koboSpan" id="kobo.534.1"> file and framework documentation that helps external developers start building a </span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">new application.</span></span></p>
<h2 id="_idParaDest-129"><a id="_idTextAnchor128"/><span class="koboSpan" id="kobo.536.1">New project requirements</span></h2>
<p><span class="koboSpan" id="kobo.537.1">To use an example of</span><a id="_idIndexMarker528"/><span class="koboSpan" id="kobo.538.1"> framework usage, a developer wants to build a sample application that keeps track of packages. </span><span class="koboSpan" id="kobo.538.2">The system needs to be able to list inbound and outbound packages, change the properties of those packages, and add and remove new ones. </span><span class="koboSpan" id="kobo.538.3">Ultimately, the developer would like to enable these features and deploy them to a remote environment, where the application interacts with a production/staging </span><span class="No-Break"><span class="koboSpan" id="kobo.539.1">database environment.</span></span></p>
<h2 id="_idParaDest-130"><a id="_idTextAnchor129"/><span class="koboSpan" id="kobo.540.1">Starting a project</span></h2>
<p><span class="koboSpan" id="kobo.541.1">To start building the application, the </span><a id="_idIndexMarker529"/><span class="koboSpan" id="kobo.542.1">developer installs the framework. </span><span class="koboSpan" id="kobo.542.2">They can use a command such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.543.1">npm install -g componium</span></strong><span class="koboSpan" id="kobo.544.1">. </span><span class="koboSpan" id="kobo.544.2">The command globally installs the framework. </span><span class="koboSpan" id="kobo.544.3">This is similar to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.545.1">npm link</span></strong><span class="koboSpan" id="kobo.546.1"> command that we used before to get access to the executable. </span><span class="koboSpan" id="kobo.546.2">However, in this case, the framework is downloaded from the npm package manager database. </span><span class="koboSpan" id="kobo.546.3">In your case, you can use the npm-linked version of the executable if it makes </span><span class="No-Break"><span class="koboSpan" id="kobo.547.1">it easier.</span></span></p>
<p><span class="koboSpan" id="kobo.548.1">With the framework installed, the developer can now run </span><strong class="source-inline"><span class="koboSpan" id="kobo.549.1">componium init</span></strong><span class="koboSpan" id="kobo.550.1"> to create a new application structure. </span><span class="koboSpan" id="kobo.550.2">The terminal will show </span><span class="No-Break"><span class="koboSpan" id="kobo.551.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.552.1">
&gt; cd new-app
&gt; componium init
Creating /Users/user/dev/new-app/app.js...
</span><span class="koboSpan" id="kobo.552.2">...
</span><span class="koboSpan" id="kobo.552.3">Installing dependencies...
</span><span class="koboSpan" id="kobo.552.4">New Componium application initialized.</span></pre>
<h2 id="_idParaDest-131"><a id="_idTextAnchor130"/><span class="koboSpan" id="kobo.553.1">Using the framework</span></h2>
<p><span class="koboSpan" id="kobo.554.1">The initialization script </span><a id="_idIndexMarker530"/><span class="koboSpan" id="kobo.555.1">automatically installs the necessary parts of the project, including a </span><strong class="source-inline"><span class="koboSpan" id="kobo.556.1">package.json</span></strong><span class="koboSpan" id="kobo.557.1"> file. </span><span class="koboSpan" id="kobo.557.2">The code scaffolds the necessary files into the project directory based on those choices. </span><span class="koboSpan" id="kobo.557.3">The starting point now leaves the developer with a brand-new project directory, where they can begin development. </span><span class="koboSpan" id="kobo.557.4">The expectation of this workflow ensures minimal friction during installation and presents the developer with an example of running application code. </span><span class="koboSpan" id="kobo.557.5">The next step for the developer is to use either the </span><strong class="source-inline"><span class="koboSpan" id="kobo.558.1">componium dev</span></strong><span class="koboSpan" id="kobo.559.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">componium create</span></strong><span class="koboSpan" id="kobo.561.1"> command. </span><span class="koboSpan" id="kobo.561.2">The first command, </span><strong class="source-inline"><span class="koboSpan" id="kobo.562.1">dev</span></strong><span class="koboSpan" id="kobo.563.1">, will start the development server in the project directory, and the second command, </span><strong class="source-inline"><span class="koboSpan" id="kobo.564.1">create</span></strong><span class="koboSpan" id="kobo.565.1">, can scaffold new components within the project. </span><span class="koboSpan" id="kobo.565.2">It is up to the developer to decide whether they want to use the scaffolding helpers or write code from scratch using the provided framework documentation. </span><span class="koboSpan" id="kobo.565.3">These two commands will come in handy in the next parts of the workflow, where a developer can start adding new API models and </span><span class="No-Break"><span class="koboSpan" id="kobo.566.1">server endpoints.</span></span></p>
<h2 id="_idParaDest-132"><a id="_idTextAnchor131"/><span class="koboSpan" id="kobo.567.1">Creating an API and a model</span></h2>
<p><span class="koboSpan" id="kobo.568.1">Now, by</span><a id="_idIndexMarker531"/><span class="koboSpan" id="kobo.569.1"> following the docs on route creation and </span><a id="_idIndexMarker532"/><span class="koboSpan" id="kobo.570.1">handling, the developer can create the necessary endpoints to support the requirements of the project that they are building. </span><span class="koboSpan" id="kobo.570.2">For example, they can begin by using the file-based router to define two endpoints â€“ one to create new </span><em class="italic"><span class="koboSpan" id="kobo.571.1">package</span></em><span class="koboSpan" id="kobo.572.1"> entries and another to list them. </span><span class="koboSpan" id="kobo.572.2">To do this, they can make a directory called </span><strong class="source-inline"><span class="koboSpan" id="kobo.573.1">api</span></strong><span class="koboSpan" id="kobo.574.1"> and add a new file, </span><strong class="source-inline"><span class="koboSpan" id="kobo.575.1">api/packages.js</span></strong><span class="koboSpan" id="kobo.576.1">. </span><span class="koboSpan" id="kobo.576.2">You can find an example of this file </span><span class="No-Break"><span class="koboSpan" id="kobo.577.1">at </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">chapter7/componium/tests/sample/models/package.js</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.579.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.580.1">Instead of doing this manually, the scaffolding tool can also help generate a new route file and a new model file, later placing them into the correct directory. </span><span class="koboSpan" id="kobo.580.2">For the route generation, the command looks </span><span class="No-Break"><span class="koboSpan" id="kobo.581.1">like this:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.582.1">
&gt; componium create
? </span><span class="koboSpan" id="kobo.582.2">What would you like to scaffold? </span><span class="koboSpan" id="kobo.582.3">Route
? </span><span class="koboSpan" id="kobo.582.4">Enter a name for your ROUTE packages</span></pre>
<p><span class="koboSpan" id="kobo.583.1">This will now provide an endpoint to handle requests. </span><span class="koboSpan" id="kobo.583.2">The developer will likely start looking for ways to enrich the API endpoints with actual data. </span><span class="koboSpan" id="kobo.583.3">The API creation step requires the application author to understand the available options and the mechanisms to create new endpoints. </span><span class="koboSpan" id="kobo.583.4">Most likely, they can learn this from the framework documentation and provided </span><span class="No-Break"><span class="koboSpan" id="kobo.584.1">sample apps.</span></span></p>
<h2 id="_idParaDest-133"><a id="_idTextAnchor132"/><span class="koboSpan" id="kobo.585.1">Expanding the API</span></h2>
<p><span class="koboSpan" id="kobo.586.1">With the </span><a id="_idIndexMarker533"/><span class="koboSpan" id="kobo.587.1">API routes functioning, it is time to enable data persistence. </span><span class="koboSpan" id="kobo.587.2">In this case, the developer needs to add database capabilities to save and list </span><em class="italic"><span class="koboSpan" id="kobo.588.1">packages</span></em><span class="koboSpan" id="kobo.589.1">. </span><span class="koboSpan" id="kobo.589.2">The framework already ensures that it can connect to a development database locally so that step is taken care of. </span><span class="koboSpan" id="kobo.589.3">The next step in the workflow is to add a </span><em class="italic"><span class="koboSpan" id="kobo.590.1">Package</span></em><span class="koboSpan" id="kobo.591.1"> model and load it in the API endpoints. </span><span class="koboSpan" id="kobo.591.2">The scaffolding tooling can generate a model file in the right location using a CLI prompt or command. </span><span class="koboSpan" id="kobo.591.3">For example, the CLI can run </span><strong class="source-inline"><span class="koboSpan" id="kobo.592.1">componium create</span></strong><span class="koboSpan" id="kobo.593.1"> to prompt the developer for the database model details. </span><span class="koboSpan" id="kobo.593.2">To successfully achieve this workflow task, the application author needs to be aware of the scaffolding tools or manual ways to manage database models within the framework. </span><span class="koboSpan" id="kobo.593.3">Once we create the model, we can update the </span><strong class="source-inline"><span class="koboSpan" id="kobo.594.1">models/package.js</span></strong><span class="koboSpan" id="kobo.595.1"> file to store the properties of </span><span class="No-Break"><span class="koboSpan" id="kobo.596.1">different packages:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.597.1">
import Package from "../../models/package.js";
export default async (req, res) =&gt; {
Â Â const model = await Package();
Â Â const sample = await model.create({
Â Â Â Â title: "Paper Delivery",
Â Â Â Â address: "123 Main St.",
Â Â Â Â created: new Date(2023, 1, 1),
Â Â });
Â Â const packages = await model.findAll();
Â Â componium.logger.info(`Found packages ${JSON.
</span><span class="koboSpan" id="kobo.597.2">Â Â Â Â stringify(packages)}`);
Â Â res.json(packages);
};</span></pre>
<p><span class="koboSpan" id="kobo.598.1">In the preceding</span><a id="_idIndexMarker534"/><span class="koboSpan" id="kobo.599.1"> code, we can both create new packages and then respond with all the packages in the database. </span><span class="koboSpan" id="kobo.599.2">Furthermore, we can split the creation logic and the query logic into different routes. </span><span class="koboSpan" id="kobo.599.3">The full packages file can be found </span><span class="No-Break"><span class="koboSpan" id="kobo.600.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.601.1">tests/sample/routes/api/packages.js</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.602.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.603.1">By the end of this workflow step, the endpoint should now have the code logic to interact with the newly created Package model and list the records when the </span><strong class="source-inline"><span class="koboSpan" id="kobo.604.1">packages.js</span></strong><span class="koboSpan" id="kobo.605.1"> route </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">is accessed.</span></span></p>
<h2 id="_idParaDest-134"><a id="_idTextAnchor133"/><span class="koboSpan" id="kobo.607.1">Adding tests</span></h2>
<p><span class="koboSpan" id="kobo.608.1">At this </span><a id="_idIndexMarker535"/><span class="koboSpan" id="kobo.609.1">point in our workflow, we have a working API that interacts with the database. </span><span class="koboSpan" id="kobo.609.2">The developer has already tested the endpoints manually using sample requests. </span><span class="koboSpan" id="kobo.609.3">They can also land some functional test cases to make sure the API works properly. </span><span class="koboSpan" id="kobo.609.4">To successfully add tests, there needs to be documentation on the suggested ways to test endpoints. </span><span class="koboSpan" id="kobo.609.5">These suggestions can include the use of third-party</span><a id="_idIndexMarker536"/><span class="koboSpan" id="kobo.610.1"> test libraries or the built-in </span><strong class="source-inline"><span class="koboSpan" id="kobo.611.1">componium-test</span></strong><span class="koboSpan" id="kobo.612.1"> library from </span><a href="B19014_06.xhtml#_idTextAnchor089"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.613.1">Chapter 6</span></em></span></a><span class="No-Break"><span class="koboSpan" id="kobo.614.1">.</span></span></p>
<h2 id="_idParaDest-135"><a id="_idTextAnchor134"/><span class="koboSpan" id="kobo.615.1">Configuring environments</span></h2>
<p><span class="koboSpan" id="kobo.616.1">With the </span><a id="_idIndexMarker537"/><span class="koboSpan" id="kobo.617.1">routes tested, it is time to attempt to deploy the application to see whether it works in the remote environment. </span><span class="koboSpan" id="kobo.617.2">The application frameworks that we saw in </span><a href="B19014_01.xhtml#_idTextAnchor015"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.618.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.619.1"> pride themselves on the ease of deployment. </span><span class="koboSpan" id="kobo.619.2">Therefore, the expectations are high to make the application as easy as possible </span><span class="No-Break"><span class="koboSpan" id="kobo.620.1">to deploy.</span></span></p>
<p><span class="koboSpan" id="kobo.621.1">To successfully achieve this step, our framework provides a production configuration file, </span><strong class="source-inline"><span class="koboSpan" id="kobo.622.1">config/production.json</span></strong><span class="koboSpan" id="kobo.623.1">. </span><span class="koboSpan" id="kobo.623.2">This JSON file contains various environment-specific settings that the application uses when running in the production environment. </span><span class="koboSpan" id="kobo.623.3">It is still up to the developer to properly understand how to securely specify the database information and other configuration options. </span><span class="koboSpan" id="kobo.623.4">The framework documentation can guide the application authors to suggest optimal ways to make this step work. </span><span class="koboSpan" id="kobo.623.5">While the framework provides this file, itâ€™s still the responsibility of the developer to understand how to securely specify the required attributes. </span><span class="koboSpan" id="kobo.623.6">The way these details are specified can significantly impact the security and performance of the application, making it critical to get </span><span class="No-Break"><span class="koboSpan" id="kobo.624.1">it right.</span></span></p>
<h2 id="_idParaDest-136"><a id="_idTextAnchor135"/><span class="koboSpan" id="kobo.625.1">Deploying the application</span></h2>
<p><span class="koboSpan" id="kobo.626.1">With the </span><a id="_idIndexMarker538"/><span class="koboSpan" id="kobo.627.1">production configuration correctly configured, the developer can now deploy the application to their server environment and test out the new API. </span><span class="koboSpan" id="kobo.627.2">This step completes our sample workflow, and if the developer can successfully test out their changes and interact with the database, then the workflow </span><span class="No-Break"><span class="koboSpan" id="kobo.628.1">is successful.</span></span></p>
<p><span class="koboSpan" id="kobo.629.1">This is just one example of a framework workflow, which allows us to document the steps from installation to a working application. </span><span class="koboSpan" id="kobo.629.2">There are more steps that could potentially be added; it largely depends on how far we are willing to explore this workflow. </span><span class="koboSpan" id="kobo.629.3">For example, using the middleware APIs of the framework, we can explore how common middleware such as authentication can be easily added to the new endpoints. </span><span class="koboSpan" id="kobo.629.4">We also didnâ€™t cover the use cases where an application author needs to have frontend views to manage and interact with </span><span class="No-Break"><span class="koboSpan" id="kobo.630.1">the endpoints.</span></span></p>
<p><span class="koboSpan" id="kobo.631.1">The process of figuring out these types of workflows can help us identify friction and opportunities to make the frameworkâ€™s developer experience much better. </span><span class="koboSpan" id="kobo.631.2">It also ensures that we figure out what types of documentation and tooling improvements can be added to the project as we develop </span><span class="No-Break"><span class="koboSpan" id="kobo.632.1">it further.</span></span></p>
<p><span class="koboSpan" id="kobo.633.1">At this point of</span><a id="_idIndexMarker539"/><span class="koboSpan" id="kobo.634.1"> deployment of the application, we conclude the workflowâ€™s standard progression. </span><span class="koboSpan" id="kobo.634.2">The additional steps in the more extensive workflow can involve doing more in-depth database operations and using the frameworkâ€™s GraphQL features. </span><span class="koboSpan" id="kobo.634.3">Overall, focusing on several of these types of workflows can help framework authors fine-tune how stakeholders interact with their systems. </span><span class="koboSpan" id="kobo.634.4">In the following section, we will take a look at a list of the external dependencies that made all </span><span class="No-Break"><span class="koboSpan" id="kobo.635.1">this possible.</span></span></p>
<h1 id="_idParaDest-137"><a id="_idTextAnchor136"/><span class="koboSpan" id="kobo.636.1">Dependencies</span></h1>
<p><span class="koboSpan" id="kobo.637.1">The workflow that </span><a id="_idIndexMarker540"/><span class="koboSpan" id="kobo.638.1">we mentioned in the previous section is made possible by several external libraries and modules. </span><span class="koboSpan" id="kobo.638.2">Hereâ€™s a recap of some of the modules that we used in the Componium framework from </span><span class="No-Break"><span class="koboSpan" id="kobo.639.1">this chapter:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.640.1">@apollo/server</span></strong><span class="koboSpan" id="kobo.641.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.642.1">@graphql-tools/schema</span></strong><span class="koboSpan" id="kobo.643.1">: The combination of these two tools allows us to offer the GraphQL features of this framework project. </span><span class="koboSpan" id="kobo.643.2">Apollo Server is able to integrate with Componium servers, and it also provides an easy-to-use sandbox to test </span><span class="No-Break"><span class="koboSpan" id="kobo.644.1">GraphQL schemas.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.645.1">Chokidar</span></strong><span class="koboSpan" id="kobo.646.1">: This is the file-watching library that helps to create a better experience by watching for changes to the application files and performing steps, such as restarting the </span><span class="No-Break"><span class="koboSpan" id="kobo.647.1">development server.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.648.1">@inquirer</span></strong><span class="koboSpan" id="kobo.649.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.650.1">yargs</span></strong><span class="koboSpan" id="kobo.651.1">: These libraries allow us to create the </span><strong class="source-inline"><span class="koboSpan" id="kobo.652.1">componium</span></strong><span class="koboSpan" id="kobo.653.1"> command-line tool. </span><em class="italic"><span class="koboSpan" id="kobo.654.1">Inquirer</span></em><span class="koboSpan" id="kobo.655.1"> can create interactive terminal interfaces, useful for Componium development commands, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.656.1">componium create</span></strong><span class="koboSpan" id="kobo.657.1">. </span><em class="italic"><span class="koboSpan" id="kobo.658.1">Yargs</span></em><span class="koboSpan" id="kobo.659.1"> helps us work with command-line commands, flags, and options, making it easier to quickly develop a sleek development interface for </span><span class="No-Break"><span class="koboSpan" id="kobo.660.1">our project.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.661.1">express</span></strong><span class="koboSpan" id="kobo.662.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.663.1">body-parser</span></strong><span class="koboSpan" id="kobo.664.1">: These are the underlying server libraries that make it possible to initialize Componium servers and add routes </span><span class="No-Break"><span class="koboSpan" id="kobo.665.1">and middleware.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.666.1">Winston</span></strong><span class="koboSpan" id="kobo.667.1">: This is the logging library that is used in the underlying </span><strong class="source-inline"><span class="koboSpan" id="kobo.668.1">Logging</span></strong><span class="koboSpan" id="kobo.669.1"> class. </span><span class="koboSpan" id="kobo.669.2">It helps us provide a way for the Componium applications to log to different types </span><span class="No-Break"><span class="koboSpan" id="kobo.670.1">of logs.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.671.1">sequelize</span></strong><span class="koboSpan" id="kobo.672.1">: This is the ORM layer library that helps applications integrate with a variety </span><span class="No-Break"><span class="koboSpan" id="kobo.673.1">of databases.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.674.1">componium-test</span></strong><span class="koboSpan" id="kobo.675.1">: This is the testing library from </span><a href="B19014_06.xhtml#_idTextAnchor089"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.676.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.677.1"> that we can utilize to test the </span><span class="No-Break"><span class="koboSpan" id="kobo.678.1">backend framework.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.679.1">debug</span></strong><span class="koboSpan" id="kobo.680.1">: This is the logging module used to track down and debug internal issues of a framework during development. </span><span class="koboSpan" id="kobo.680.2">As mentioned in </span><a href="B19014_06.xhtml#_idTextAnchor089"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.681.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.682.1">, it supports scoping a debug level to a particular component by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.683.1">DEBUG=componium:* </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.684.1">environment</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.685.1"> variable.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.686.1">config</span></strong><span class="koboSpan" id="kobo.687.1">: This </span><a id="_idIndexMarker541"/><span class="koboSpan" id="kobo.688.1">is the configuration manager module that helps store and organize the application configuration in </span><span class="No-Break"><span class="koboSpan" id="kobo.689.1">different formats.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.690.1">Some of these modules are quite common in server-side frameworks and other Node.js tools at large. </span><span class="koboSpan" id="kobo.690.2">For the purposes of your own framework, you can choose the packages we just discussed or find alternatives that better fit your use cases. </span><span class="koboSpan" id="kobo.690.3">Luckily, the Node.js ecosystem has a lot to offer in terms of ORM, logging, and </span><span class="No-Break"><span class="koboSpan" id="kobo.691.1">testing solutions.</span></span></p>
<h1 id="_idParaDest-138"><a id="_idTextAnchor137"/><span class="koboSpan" id="kobo.692.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.693.1">In this chapter, we have taken a step further, from the earlier experience with the testing framework, by composing a brand-new server-side framework that is capable of routing requests, handling API calls, and much more. </span><span class="koboSpan" id="kobo.693.2">This supports our plan to develop a full stack framework that covers both frontend and backend features, with components interacting with each other within the same unified vision. </span><span class="koboSpan" id="kobo.693.3">Our goal was to create something that is used and reused for multiple application use cases and feature </span><span class="No-Break"><span class="koboSpan" id="kobo.694.1">set combinations.</span></span></p>
<p><span class="koboSpan" id="kobo.695.1">We started by defining our projectâ€™s goals, and we later developed the core architecture aspects of the framework. </span><span class="koboSpan" id="kobo.695.2">This architecture included producing features such as server process management, environment configuration, and database interaction. </span><span class="koboSpan" id="kobo.695.3">To enable usability and empower developer productivity, we also focused on producing several features that focus on </span><span class="No-Break"><span class="koboSpan" id="kobo.696.1">developer experience.</span></span></p>
<p><span class="koboSpan" id="kobo.697.1">This was the second practical exercise in our framework experience, and hopefully, this gives you even more confidence in your skills to develop your own frameworks. </span><span class="koboSpan" id="kobo.697.2">To take this a step further, the next chapter will focus on our final challenge â€“ building frontend components for our full stack framework. </span><span class="koboSpan" id="kobo.697.3">The introduction of the frontend components in the next chapter will enable the whole full stack experience of our newly </span><span class="No-Break"><span class="koboSpan" id="kobo.698.1">created framework.</span></span></p>
</div>
</body></html>