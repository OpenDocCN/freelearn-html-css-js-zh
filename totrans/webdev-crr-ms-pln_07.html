<html><head></head><body>
<div><h1 class="chapter-number" id="_idParaDest-176"><a id="_idTextAnchor176"/>7</h1>
<h1 id="_idParaDest-177"><a id="_idTextAnchor177"/>From Front to Back – More on Backend Tools and Technologies</h1>
<p>In the last chapter, we focused primarily on the frontend. In this chapter, we’ll jump back to the backend side of the fence and look at some other server-side technologies and concepts. A full-fledged website or web app will rarely be only a client – it will nearly always require some sort of server to interact with – so, being full stack and understanding how both sides fit together is beneficial to being a web developer even if you ultimately decide to focus on one side or the other.</p>
<p>In this chapter, we’ll look at what is perhaps the most important server-side concept: data. You’ll learn how data is stored and accessed, and you’ll understand the basic operations that can be performed on data. You’ll see multiple ways of storing data, and then you’ll learn how to build a facility that clients can use to access that data.</p>
<p>Of course, understanding how to work with data should obviously be important since without data, a website is likely to not be of all that much use, but knowing how to expose that data to clients in a consistent way (where <em class="italic">clients</em> in this context most often will mean a browser-based application) is also important to understand since it allows not only your own app or website to use the data but potentially others in their own way, which is a nice bit of flexibility to be able to offer.</p>
<p>You’ll also get a look at a couple of different technologies for building server-side code, in addition to Node, which you’ve seen already. This will include Java, PHP, .NET, and even some Python options. It’s important to know what the various options are so that you can make an informed decision about which is most appropriate when building your server-side code (and you may find that the decision in large part comes down to personal preference and pre-existing knowledge, which oftentimes is fine).</p>
<p>So, in this chapter, we’ll cover the following topics:</p>
<ul>
<li>Getting to the heart of the matter – data</li>
<li>Building web APIs with REST, Node, and Express</li>
<li>Going back to the future – SSR</li>
<li>Using PHP on the server side</li>
<li>Building with Java and Spring Boot</li>
<li>Introducing .NET</li>
<li>Using Python web app frameworks</li>
<li>Reviewing the roadmap</li>
</ul>
<h1 id="_idParaDest-178"><a id="_idTextAnchor178"/>Technical requirements</h1>
<p>As usual, you will want the code download bundle for this book, along with the code found in the <code>ch-07</code> directory specifically.</p>
<p>But specifically for this chapter, you’ll need to install a tool called Postman, which we’ll use for exercising our backend code later. Though at the time of writing you can download the tool without signing up, you’ll most likely want an account either way since it provides expanded functionality. So, go to <a href="https://www.postman.com">https://www.postman.com</a>, sign up, and download the Postman desktop app. The app is a typical desktop app for whichever operating system you’re using, so you shouldn’t have much trouble getting it installed.</p>
<p>You’ll also need to have the .NET SDK installed, which you can get at <a href="https://dotnet.microsoft.com">https://dotnet.microsoft.com</a>. This is a platform Microsoft provides for developing all sorts of apps, both Windows native and web apps. This again is a standard installer, so you shouldn’t have too much trouble – just grab the latest version available. Once you install it, go to Command Prompt and execute the <code>dotnet --version</code> command to confirm it’s ready to go.</p>
<p>Finally, you’ll next need to install the latest Java JDK, which you can get here: <a href="https://www.oracle.com/java/technologies/downloads">https://www.oracle.com/java/technologies/downloads</a>. Java is one of the most popular programming languages and platforms in use today, and we’ll take a look at it later. The version shouldn’t matter for our purposes here, so just grab the latest (21 as of this writing). Once installed, head to Command Prompt and ensure that <code>java -–version</code> returns you the correct version. Note that if you run into any issues with either the JDK or the .NET SDK not working, you can find installation help on their respective websites.</p>
<h1 id="_idParaDest-179"><a id="_idTextAnchor179"/>Getting to the heart of the matter – data</h1>
<p>Most websites or web apps require data of some sort to do what they’re designed to do. That’s not exactly a revelatory statement, of course. eBay wouldn’t work if it didn’t have data available to display auctions. Google wouldn’t be able to do searches without (an insane amount of) data. And CNN wouldn’t be able to show the latest news headlines without data to back it up.</p>
<p>But how does that data get<a id="_idIndexMarker712"/> stored, and how does it get used?</p>
<p>So far, everything you’ve seen has been more or less static, meaning it doesn’t change. A page is what it is when you create it, and it will always be that. Oh, there may be some minor dynamic interactions – things such as buttons that highlight when you hover your mouse over them – but that’s not dynamic content such as those websites I named produce. That can only be done with data.</p>
<p>There are lots of ways to store data that websites can work with. Perhaps the simplest form is to store it as plain text files on the server. Those files can be read – perhaps in Node-based code, for example – and their contents can be used to create a dynamic response at the time it’s requested.</p>
<p>In a nutshell, that’s what we’re talking about here: creating responses dynamically on the server when requested by a client (usually a web browser) and returning them for display to the user.</p>
<p>While plain text files can work, the more common method is<a id="_idIndexMarker713"/> some form of <strong class="bold">database</strong>. A database is, usually, a piece of software running on the server, separate from your web server software and separate from your own application code, where data is stored and which can respond to requests for that data (or for writing data to it). While it’s possible in some cases for a web browser to access such database software directly, it’s far more common to have some server-side code that does so and then uses the data to produce a response. This is more common for no other reason than security: presumably, your own code is protected against misuse of the database, whereas just giving users direct access to it will most likely lack such protection.</p>
<p>There are several different types of databases, but the two most relevant to you as a budding web developer are <strong class="bold">relational databases</strong> and <strong class="bold">NoSQL databases</strong>. Let’s talk about relational databases first.</p>
<h2 id="_idParaDest-180"><a id="_idTextAnchor180"/>Relational databases</h2>
<p>Relational databases <a id="_idIndexMarker714"/>conceptually look a lot like spreadsheets – say, Microsoft Excel. In a spreadsheet, you have rows and columns. Where they intersect, you have a cell, and in a cell, you usually have some data. In an Excel spreadsheet, you can also have multiple sheets, often to store different types of data. <em class="italic">Figure 7</em><em class="italic">.1</em> illustrates these ideas:</p>
<div><div><img alt="Figure 7.1: An Excel spreadsheet, with multiple sheets shown to mimic a database and tables" src="img/B18315_07_1.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.1: An Excel spreadsheet, with multiple sheets shown to mimic a database and tables</p>
<p>If you already understand the basic structure of a spreadsheet, then to understand a relational database, you really just have to change some words!</p>
<p>The entire spreadsheet in Excel is conceptually what we call a <em class="italic">database</em>, and each sheet in a spreadsheet is called a <em class="italic">table</em> in that <a id="_idIndexMarker715"/>database. Within the database software, you can normally have multiple databases if you need to. This can be confusing, so to disambiguate, we tend to say database <em class="italic">server</em> versus plain <em class="italic">database</em>:</p>
<ul>
<li>A database <em class="italic">server</em> refers to <a id="_idIndexMarker716"/>the software that runs on the server (names such as Oracle MySQL, PostgreSQL, and MS SQL Server) and which contains databases and provides the basic functionality to work with the data</li>
<li>The term <em class="italic">database</em> – different from the <a id="_idIndexMarker717"/>aforementioned database <em class="italic">server</em> – refers to the actual collection of tables for a given purpose, perhaps one database per website hosted on the server, but all living in the database server software</li>
</ul>
<p>In a database table, you define what columns there are – what type of data you want to store about each row of data in the table – and then you have the rows of data itself. If you think of each row of data – which we often<a id="_idIndexMarker718"/> call a <strong class="bold">record</strong> – as being some sort of entity, say a person or a banking account, then the columns effectively describe the pieces of information you want to store about each.</p>
<p>For example, let’s say you want to create a database table to store some information about people. We’ll be exceptionally uncreative here and say that we’ll name the table <code>People</code>. Maybe for <a id="_idIndexMarker719"/>each row of data – which will be a person entity – you want to store their first name, last name, and age. As a result, you might wind up with a database table that looks like <em class="italic">Figure 7</em><em class="italic">.2</em>:</p>
<div><div><img alt="Figure 7.2: The People table’s structure" src="img/B18315_07_2.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.2: The People table’s structure</p>
<p class="callout-heading">Note</p>
<p class="callout">As an aside, you probably would never store a person’s age because that obviously won’t be correct a year later. Instead, you would most likely store their birthdate and calculate their age from that when needed. But here, I’m trying to keep this example as simple as possible.</p>
<p>For each column, you have to tell the database what kind of data will be stored in it. Every database specifies the type of data in each column differently, but they all relate to what you know already. Here, you can see that <code>first_name</code> and <code>last_name</code> are strings (which are of the data type <code>TEXT</code> in this particular database), and <code>age</code> is a number (of the data type <code>INTEGER</code>). Another bit of terminology to change here is that we usually call a single data element a field in a database rather than a cell as in a spreadsheet. But it’s again the same basic thing: it’s the value in a row that corresponds to a given column.</p>
<p>With that basic table structure defined, we can store some rows of data in it; maybe this data (and yes, those were their actual ages when the series began – I did the research!):</p>
<pre class="source-code">
FIRST NAME, LAST NAME, AGE
James, Kirk, 32
Leonard, McCoy, 38
Montgomery, Scott, 43</pre> <p>But how do we actually store that data? That’s where the concept of Structured Query Language comes in, which<a id="_idIndexMarker720"/> is what we’re discussing next.</p>
<h3>Introducing SQL</h3>
<p><strong class="bold">Structured Query Language</strong> (<strong class="bold">SQL</strong>) is a special language used to interact with relational databases. It allows us to request data using a<a id="_idIndexMarker721"/> form that is generally easy to understand, attempting to<a id="_idIndexMarker722"/> look less like a programming language than something like JS.</p>
<p>To jump right in with an example, let’s say you wanted to get all three records from our <code>People</code> table. The SQL statement for that would be this:</p>
<pre class="source-code">
SELECT * FROM People;</pre> <p>That’s it! What you’ll get is a list of records, each containing the first name, last name, and age of each person. This shows the most basic type of SQL statement: a <code>SELECT</code> statement. We tell it what data we want from each record (in this case, the asterisk means all), and then we have to state what table to get the records from.</p>
<p>If we wanted just the last names, we would execute the following:</p>
<pre class="source-code">
SELECT last_name FROM People;</pre> <p>And if we wanted just the last name and age, we could execute the following:</p>
<pre class="source-code">
SELECT last_name, age FROM People;</pre> <p>What if we want just the people who are over 40 years old? That’s where the <code>WHERE</code> clause comes into play:</p>
<pre class="source-code">
SELECT * FROM People WHERE age &gt; 40;</pre> <p>Now, we’ll get just a single record – Montgomery Scott – since that’s the only record with a value for <code>age</code> greater than <code>40</code>.</p>
<p>Here, <code>SELECT</code> statements such as this allow for other capabilities, including sorting the returned data, filtering it in various ways, and lots of functions that can be used to manipulate the returned data (for example, to uppercase the names, maybe). But the basic ability to retrieve data is ultimately what it’s all about.</p>
<p>And, of course, retrieving data is great, but what if we want to add a person? This can be done through SQL as well, using an <code>INSERT</code> statement:</p>
<pre class="source-code">
INSERT INTO People (first_name, last_name, age) VALUES ('Pavel', 'Chekov', 21);</pre> <p>We have to provide the name of the table to insert the data into, then a list of fields to insert, and then the value of each field. After executing that statement, we’ll have four rows of data in the table.</p>
<p>What about changing existing <a id="_idIndexMarker723"/>data? That’s doable too with SQL, using its <code>UPDATE</code> statement:</p>
<pre class="source-code">
UPDATE People SET age=50 WHERE last_name='Kirk';</pre> <p>Again, we have to specify which table <a id="_idIndexMarker724"/>we’re changing data in, and then which field to change.</p>
<p>And of course, we can update multiple fields if we wish:</p>
<pre class="source-code">
UPDATE People SET first_name='Jim', age=50 WHERE last_name='Kirk';</pre> <p>The <code>WHERE</code> clause is actually optional here, but the result of not providing it is that <strong class="bold">all</strong> the records in the table will be updated since there’s nothing to limit which records it affects. So, it’s important when working with SQL that your statements that change data always do so to only the records you intend to change.</p>
<p>The final form of SQL statement you need to be aware of is for deleting data:</p>
<pre class="source-code">
DELETE FROM People WHERE age &lt; 30;</pre> <p>Once more, you must specify the table to operate on, and then some <code>WHERE</code> clause to determine which records to remove. As with the <code>UPDATE</code> statement, the <code>WHERE</code> clause is optional, so unless you actually intend to delete all the records in the table, be careful to include the correct criteria to match records by!</p>
<p>These are, of course, just the most basic SQL statements possible – SQL can get quite a bit more complex as you get into more advanced use cases – but if you understand the basic idea behind these four types of statements, then you’ll have a good start on understanding more advanced use cases.</p>
<p>Now, one of those more advanced use cases is when tables have some direct relationship to each other, which is where the word <em class="italic">relational</em> comes from in relational databases, so let’s talk about that next.</p>
<h3>Putting the relational in relational databases</h3>
<p>As you know, you can have multiple tables in a database. For example, let’s say that in addition to the <code>People</code> table, we add a <code>Starships</code> table now, as shown in <em class="italic">Figure 7</em><em class="italic">.3</em>:</p>
<div><div><img alt="Figure 7.3: The Starships table’s structure" src="img/B18315_07_3.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.3: The Starships table’s structure</p>
<p>As it stands, there isn’t any real relationship between these two tables, and there’s nothing that ties them together. Sometimes that’s fine, but what if we want to know the starship each person serves on? One way<a id="_idIndexMarker725"/> we could do this would be to alter the <code>People</code> table, as shown in <em class="italic">Figure 7</em><em class="italic">.4</em>:</p>
<div><div><img alt="Figure 7.4: The People table’s structure, now with a starship_id column" src="img/B18315_07_4.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.4: The People table’s structure, now with a starship_id column</p>
<p>Now, the <code>starship_id</code> column has been added, and assuming that the value in that field for each row of data <a id="_idIndexMarker726"/>matches one of the <code>id</code> values of a record in the <code>Starships</code> table, we’ve effectively connected the two tables and can now, at least indirectly, tell which starship each person serves on. We’ve created a <em class="italic">relationship</em>, in other words, between these tables, making this now a truly <em class="italic">relational</em> database.</p>
<p>But what does that do to our SQL queries? Well, they work the same as before, but now we have some new capabilities at our fingertips because we can query for data from both tables at once based on the relationship:</p>
<pre class="source-code">
SELECT p.first_name, p.last_name, p.age, s.starship_name FROM People p, Starships s WHERE s.id = p.starship_id;</pre> <p>Now, we’ll get four pieces of data for each record returned: the first name, last name, and age of each person, plus the starship they serve on. But we need to specify that we’re querying from two tables and combining the data in one result set, a concept called <code>p</code> for the <code>Person</code> table and <code>s</code> for the <code>Starships</code> table.</p>
<p>We then use these names as prefixes on the names of columns everywhere in the query (again, to ensure that SQL knows exactly which fields we want).</p>
<p>Finally, we have to provide a <code>WHERE</code> clause here. It says that for each record in the <code>People</code> table (since it’s the first one in the list of tables in the <code>FROM</code> clause), find a record in the <code>Starships</code> table with an <code>id</code> value that matches the <code>starship_id</code> value in the <code>People</code> table. And since we’re returning <code>s.starship_name</code> in the list of fields, we wind up with data about each person from <code>People</code>, along with the name of the starship they serve on from <code>Starships</code>.</p>
<p>This is really the main point<a id="_idIndexMarker728"/> of relational databases: the ability to return data that is a combination of data from two or more tables, based on some relationship between them. The relationship here is the <code>id</code> fields, so where they match, the data from both tables is combined and returned as part of the query results. Joining is an expansive topic that can get fairly complex in a hurry (it deals with the mathematical concept of set theory), so we won’t go into it in detail here. But the basic concept is always the same: your<a id="_idIndexMarker729"/> query works to combine data from multiple tables based on one or more matching conditions, returning it all as a single list of data records.</p>
<p class="callout-heading">Note</p>
<p class="callout">If you want to dive a little deeper into the various join types and how to write them, a good reference can be found here: <a href="https://learnsql.com/blog/sql-joins-types-explained">https://learnsql.com/blog/sql-joins-types-explained</a>.</p>
<p>Even from this simple example, I’m sure you can begin to see the power of relational data. You can have a list of students and a separate list of classes and be able to write a query to get a list of classes each attends. Or, you could have a list of banking accounts and who owns each in separate tables but be able to tie them together when needed.</p>
<p>Why do this, though? One of the main goals of relational databases is to not duplicate data (or, more precisely, duplicate it as little as possible – a process called <code>People</code> table itself, on each row of data. That would work just as well for our purposes. But if the name of the starship changes, then we would need to update all records in the <code>People</code> table accordingly. If instead we have two tables and join them as shown, then you just need to change the name in the <code>Starships</code> table – in one place, on one record – and it, in effect, is automatically changed for every person serving on it (at the time you do a query, that is). It’s a more logical way to deal with the data since the name of the starship isn’t logically tied to a person – they’re separate entities, really – and it’s also more efficient in<a id="_idIndexMarker731"/> terms of storage space (and, in some cases, improves performance, though that is very much a situation-by-situation thing and can, in fact, have the <em class="italic">opposite</em> effect).</p>
<p>At this point, you may be<a id="_idIndexMarker732"/> wondering what to do if the data you’re working with isn’t inherently relational. And what if the form of the data you want to store isn’t as concrete as it needs to be in order to be described in a table as you’ve seen so far? Well, there’s another type of database for such cases that might be more appropriate – NoSQL databases.</p>
<h2 id="_idParaDest-181"><a id="_idTextAnchor181"/>NoSQL databases</h2>
<p>In simplest terms, a NoSQL database is literally any other kind of mechanism for storing data (which we often call <em class="italic">data stores</em>) that doesn’t <a id="_idIndexMarker733"/>use SQL to operate on the data. This includes types of databases such as the following:</p>
<ul>
<li><code>"first name"</code>, and the value for that key is <code>"Frank"</code>. This is just about the <a id="_idIndexMarker734"/>simplest NoSQL type there is, and it’s used for situations where the data is very simple. Some common names you’ll hear for this type are Redis and DynamoDB, two products that provide a key-value database store.</li>
<li><strong class="bold">Graph databases</strong>: These are somewhat <a id="_idIndexMarker735"/>newer and are specifically used for types of data that have (usually many) well-defined connections between entities. An example of this might be a social network: you are an entity, and you probably have connections to many friends, who also have connections to many friends, and so on. While these types of relationships can be modeled in a relational database, a graph database may be more appropriate, especially if you need to <em class="italic">traverse the graph</em>, meaning to start at one entity and follow its connections to some remote entity. Some common names you might <a id="_idIndexMarker736"/>hear for this type are Neo4j and Amazon Neptune.</li>
<li><strong class="bold">Wide-column stores</strong>: These are a type of database used primarily when there is a need to analyze especially large datasets. They work by storing columns of data together in rows, which allows<a id="_idIndexMarker737"/> for optimizing complex queries across many fields of data in each entity. Examples of this type include Apache Cassandra and Google Bigtable.</li>
</ul>
<p>There is also a fourth type known as a <em class="italic">document database</em> – I left it off the list because while all of the previous types are NoSQL<a id="_idIndexMarker738"/> databases, the fact is that when someone says NoSQL database, nine times out of ten, they probably mean a document database.</p>
<p>In a document database, the <a id="_idIndexMarker739"/>data is stored in objects, very often JSON objects, though not necessarily. You’ve seen JSON several times already: the <code>package.json</code> file that <code>npm</code> generates when you initialize a project. But the format of the data stored in it is <strong class="bold">JSON</strong>, which stands for <strong class="bold">JavaScript Object Notation</strong>. Curiously, while it was definitely invented <a id="_idIndexMarker740"/>within the context of JS, it’s used outside of that context frequently nowadays because it’s relatively simple and easy to work with. It’s simply a string at the end of the day, which can be easily parsed and used in various ways.</p>
<p>One of those ways is to serve as a document in a document database, such as MongoDB, which is easily the biggest name in document databases (CouchDB is another popular name). As an example, if we wanted to store the data in the <code>People</code> table from earlier in MongoDB, we would wind up with four separate documents that might look something like this:</p>
<pre class="source-code">
{ first_name: "James", last_name: "Kirk", age: 32 }
{ first_name: "Leonard", last_name: "McCoy", age: 38 }
{ first_name: "Montgomery", last_name: "Scott", age: 43 }</pre> <p>Rather than being rows in a table, each of those is a separate object – a document – stored in a <strong class="bold">collection</strong>, which roughly corresponds to a relational database table.</p>
<p>Here’s the big difference between a relational database and a document database. Let’s say I want to store a nickname, but only for Leonard McCoy. In a relational database, I would need to add a <code>nickname</code> column to the table, and each row would need to have a nickname (it could, of course, be blank for people without a nickname). In a document database, though, I could simply write McCoy’s document like so:</p>
<pre class="source-code">
{ first_name: "Leonard", last_name: "McCoy", age: 38, nickname: "Bones" }</pre> <p>It doesn’t matter that the other documents don’t have a <code>nickname</code> field; that’s perfectly valid. You see, the structure of a database, which includes the fields in the tables, is known as the <strong class="bold">schema</strong>. Since all rows of<a id="_idIndexMarker741"/> data in a table share the same column, the table essentially defines the schema for all the rows.</p>
<p>But in a document database, it’s the documents themselves that define the schema. Well, really, <em class="italic">you</em> as the developer do(!), but the point is that each document can in a sense have its own schema.</p>
<p>This has several benefits. One is that development can often be done quicker and easier with a document database<a id="_idIndexMarker742"/> because, unlike a relational database, you don’t have to get everything right at the start. With a relational database, you have to think about the data you want to store, and you have to build the tables with the appropriate columns and data types at the start (it’s true that you can alter the structure of tables after they’ve been created, but this comes with caveats that will sometimes make it not possible, and even if it <em class="italic">is</em> possible, it takes time and effort).</p>
<p>Another benefit is that as you develop and realize that you need slightly different schemas on newer documents, you don’t necessarily have to alter existing data at all. As long as your code understands the possible differences, then you can deal with two versions of a document efficiently.</p>
<p>Now, one common misconception is that NoSQL databases, and document databases specifically, don’t have relational data. For sure that <em class="italic">can</em> be true, but using a document database doesn’t automatically mean that your data <em class="italic">can’t</em> have relationships. It’s probably fair to say that <em class="italic">more often than not</em> it won’t, and if it does have relationships, then it’s <em class="italic">probably</em> more appropriate to use a relational database. But one doesn’t negate the other.</p>
<p>And NoSQL databases do supply mechanisms to perform all the basic CRUD operations, including querying for related data. I’m not going to go into those in detail here, just because they can vary greatly from database to database. However, given it’s the most popular NoSQL/document database, here’s an example from MongoDB, just so you have some idea what it looks like:</p>
<pre class="source-code">
db.users.find({ "age": 38 })</pre> <p>That would be equivalent in SQL to the following:</p>
<pre class="source-code">
select * from People where age=38;</pre> <p>As with SQL, such statements can get rather complex the more complex the documents are, and if there are relationships between them, and so on. But that, in a nutshell, is how you work with them, and that code can be written in a multitude of languages depending on your needs <a id="_idIndexMarker743"/>and server-side infrastructure.</p>
<p>All of this database discussion leads to one last general topic, but I have to warn you, it may take you a moment to stop giggling before you read the next section, because here comes some CRUD!</p>
<h2 id="_idParaDest-182"><a id="_idTextAnchor182"/>Basic CRUD operations</h2>
<p>I know, I know – it sounds dirty, but I swear it’s a real term! The acronym <strong class="bold">CRUD</strong> stands for <strong class="bold">Create, Read, Update, and Delete</strong>, and it defines the four basic operations you can do on data, whether in a relational <a id="_idIndexMarker744"/>database or not. You can, of course, do the following:</p>
<ul>
<li>Create data, as with an <code>insert</code> SQL statement</li>
<li>Read data, as with a <code>select</code> SQL statement</li>
<li>Update data, as with an <code>update</code> SQL statement</li>
<li>Delete data, as with a <code>delete</code> SQL statement</li>
</ul>
<p>If for no other reason than just being able to have an intelligible conversation with other developers, it’s valuable to have this terminology in your head, even if you might snicker to yourself every time you say it! And it doesn’t really matter how these operations are implemented in code; it only matters that conceptually, they are the only things you ever do with data in any form.</p>
<p>But, of course, how these operations are implemented <em class="italic">does</em> matter in other ways. These CRUD (hehe) operations are often the basis for something called a web API, a collection of functions that can be called from remote systems. When it comes to building web APIs, the most common way to build them today is with yet another acronym (this field is flush with acronyms, if nothing else!): REST. And that’s the next thing we’re going to investigate.</p>
<h1 id="_idParaDest-183"><a id="_idTextAnchor183"/>Building web APIs with REST, Node, and Express</h1>
<p>Before we get to REST, though, let’s talk about APIs generally.</p>
<p>An <strong class="bold">API</strong> is an <strong class="bold">application programming interface</strong>. This can simply be a collection of functions that a program or library provides for other code to use. An API can be code located on the same machine as the <a id="_idIndexMarker745"/>code that calls on it, or an API can be exposed over a network, such as the internet and the World Wide Web. In this latter case, we call it a web API, a remote API, or sometimes a cloud API. All those terms mean the same thing, though: functions that can be called over the network, and they also tend to be language- and even technology-agnostic when built this way, meaning a JS client can call on a web API built in C, or code written in Python can call on a web API built with PHP, and so on.</p>
<p>There are a great many ways to structure and build such web APIs, lots of different technologies and patterns that can be used to build them, and a lot of different forms they can take. However, one has risen to the top of the heap after a lot of different options have been tried, and that approach is REST.</p>
<h2 id="_idParaDest-184"><a id="_idTextAnchor184"/>Introducing REST</h2>
<p>At its core, <strong class="bold">REST</strong>, which stands for <strong class="bold">REpresentational State Transfer</strong>, is just a way to structure HTTP requests in a (relatively) consistent way.</p>
<p>The web inherently uses REST <a id="_idIndexMarker746"/>principles. For example, when you enter a URL in your browser, you’re requesting a resource based on a unique URL, be that resource an HTML page, an image, or maybe some data in the form of JSON (which is most common when talking about REST services). That’s basically all the World Wide Web is, and that’s really all REST is! However, the modern notion of REST refines that basic idea, making it a bit more well-defined.</p>
<p>RESTful services, as we call web APIs built using REST, define the meaning of the standard HTTP methods – methods such as <code>GET</code>, <code>POST</code>, <code>PUT</code>, and <code>DELETE</code> – in explicit ways so that they have specific meanings. For example, a request made with <code>GET</code> means to retrieve a resource. <code>PUT</code> (usually) means to update some existing resource, while <code>POST</code> (usually) means to create a new resource. <code>DELETE</code>, of course, literally means to delete an existing resource. And of course, we’re talking about data on a server somewhere.</p>
<p>Breaking down the words that make up the acronym <em class="italic">REST</em> is helpful to understand it:</p>
<ul>
<li>The word <em class="italic">representational</em> refers to the fact that when you request data from the API, what you get is a <em class="italic">representation</em> of some resource in a form you can digest in code, but not really the resource itself. For example, while a checking account resource might be stored in a database on the server in some binary form that would look like gibberish to a client, you can <em class="italic">represent</em> that account using something such as JSON, which is essentially just plain text with a specific format, which any client can make use of.</li>
<li>The word <em class="italic">state</em> refers to the current condition of the resource. In other words, when you request a representation of a checking account, you get a representation of it as it <a id="_idIndexMarker747"/>exists at the time of the request.</li>
<li>The word <em class="italic">transfer</em> literally means to transfer that representation across the network.</li>
</ul>
<p>So, putting that all together: a REST API is one that transfers representations of resources stored on a server in their current state or allows for updating the current state in some way or deleting the resource.</p>
<p>That’s the theory; now, let’s look at REST in a bit more practical sense.</p>
<h2 id="_idParaDest-185"><a id="_idTextAnchor185"/>REST in practice</h2>
<p>When you work with a REST API, you<a id="_idIndexMarker748"/> might have a URL that points to a resource on the server – say, a checking account:</p>
<p><a href="https://my-awesome-web-api.com/checking-accounts/1234">https://my-awesome-web-api.com/checking-accounts/1234</a></p>
<p>If you make a <code>GET</code> request to that URL (it’s not a real URL, but let’s pretend it is), it will return to you a representation of the checking account with account number 1234. The representation could be in many forms, but by far the most common when using a RESTful API is JSON. So, you might get back a response something like this:</p>
<pre class="source-code">
{ account_number: 1234, balance: 546.32, date_opened: "12-15-2017" }</pre> <p>If you wanted to get a list of all accounts, then you would simply drop the <code>/1234</code> part from the URL (most likely), and you would (likely) get back an array of object representations.</p>
<p>Now, if you want to update the balance of that account (we’re ignoring security for this discussion, obviously!), you would usually make a request using the same URL, but using the HTTP <code>POST</code> method this time, and in the body of the request, you might provide some JSON like so:</p>
<pre class="source-code">
{ new_balance: 771.10 }</pre> <p>The exact semantics of the <a id="_idIndexMarker749"/>API – the format of the data you get back and the data you pass in for updates – will vary from service to service, but the basic idea here is the meaning of the HTTP methods and the fact that JSON is being used to represent the checking account in both cases. Some APIs might require you to send back the exact representation you received from a <code>GET</code> request with the fields to be updated having the new values; others may just require the fields to be updated, as I’ve shown here.</p>
<p>Note the key point, which is that the URL itself is what identifies the resource – the checking account, in this case – that we’re operating on. That’s why it doesn’t need to be included in the JSON sent in (probably – again, the semantics can vary from service to service).</p>
<p>Similarly, to remove that account, you would again use the same URL, but now with the HTTP <code>DELETE</code> method. That change is all it takes for the server-side code to identify what you want to do since the HTTP method is essentially a verb in this conversation, describing the action you want to take on the resource pointed to by the URL.</p>
<p>To create a new account, that’s where it gets a little tricky. While we know that we need to use the <code>PUT</code> method, there obviously isn’t an existing checking account number to put on the URL, so what does the URL look like in this case? The answer is that it again depends on the semantics of the API. Some will have you put something such as <code>/add</code> or <code>/addNew</code> in place of the account number. Some will not need anything and just take the <code>PUT</code> method as meaning you want to add an account.</p>
<p>This leads to an important point, which I’ve been hinting at with my use of equivocation terms throughout this discussion so far: there is REST, or RESTful, and there is REST-like. What that means is some developers will get pretty hardcore about following REST principles very rigidly (being RESTful). The problem with doing that is that sometimes you will have to make compromises in the design of the API that aren’t optimal. For example, some people say that the <code>/add</code> pattern described previously isn’t “proper” REST, but then they often don’t have a great answer for what the “right” answer is.</p>
<p>By contrast, you can be a little more flexible and design your API to be REST-like, which means you follow <em class="italic">most</em> of the architectural guidelines that define REST but allow for some degree of fungibility in it. There will almost always be some cases where things don’t quite fit the REST model as<a id="_idIndexMarker750"/> cleanly as you might like. Even just the meaning of HTTP methods can be debatable. While <code>GET</code> and <code>DELETE</code> are virtually never argued about, some developers say that <code>POST</code> should be used for updates instead of <code>PUT</code>, among other debates.</p>
<p>There is no canonical “these are the rules of REST that you must follow, or woe be unto you!” that anyone can point to. REST isn’t a set of guidelines; it’s an architectural principle, and those generally don’t have well-defined rules to follow.</p>
<p>So, my advice is to lean on the side of being REST-like. As long as you’re using HTTP methods with consistent meanings, and as long as you’re using URLs to identify resources to work with, then you’re about 90% of the way toward doing “proper” REST. If you also use JSON for your representation of those resources, then that probably gets you to somewhere like 98%.</p>
<p>So, that in a nutshell is what REST is, but how do you build a REST web API? Let’s take a look at one way with something you have some familiarity with: Node and Express.</p>
<h2 id="_idParaDest-186"><a id="_idTextAnchor186"/>Building your first REST API</h2>
<p>We’ll begin, as always, by init’ing a new project with NPM. Then, we’ll add Express as a dependency using the now-familiar <code>npm install –save express</code> command. That sets us up for coding a RESTful API.</p>
<p>Let’s take our previous <a id="_idIndexMarker751"/>database example using our Starfleet personnel and create an API that will let us add people, delete people, update people, and, of course, query people. To keep things simple, our “database” (which here simply means a collection of data, not a proper database as previously discussed) will just be JS variables since we’re focusing on the API part right now and not the database part. I’ll break down the code into easily digestible bite-sized pieces, but the complete file is <code>restAPI.js</code> in the <code>ch-07/rest</code> directory of the download bundle, and it begins like this:</p>
<pre class="source-code">
const express = require(`express`);
const app = express();
app.use(express.json());</pre> <p>We, of course, need to import Express itself and create an Express app, and then add some middleware to handle JSON being sent in a request. This is stuff you saw in <a href="B18315_03.xhtml#_idTextAnchor082"><em class="italic">Chapter 3</em></a>.</p>
<p>After that, we create our “database” in JS variables:</p>
<pre class="source-code">
let people = { };
people[1] = { first_name: `James`, last_name: `Kirk`, age: 32 };
people[2] = { first_name: `Leonard`, last_name: `McCoy`, age: 38 };
people[3] = { first_name: `Montgomery`, last_name: `Scott`, age: 43 };
let nextKey = 4;</pre> <p>First, an empty object is created and assigned to the <code>people</code> variable.</p>
<p>Next, we add the three crew members you saw earlier in the database discussion, each as a JS object.</p>
<p>The thing to note here is that JS <a id="_idIndexMarker752"/>objects are what are known as <strong class="bold">associative arrays</strong>. This is a data <a id="_idIndexMarker753"/>structure where values are mapped to keys. In a JS object, the field names are the keys. What this allows us to do is use the array bracket notation to access those fields (the key names are associative with values, and we can use array notation to access them, hence <em class="italic">associative arrays</em>).</p>
<p>And, what’s interesting is that in JS, field names in objects can be numbers, so that’s what I’ve used for the keys here. That allows me to simply increment by one the <code>nextKey</code> variable that you see defined in the last line to create a unique key for each newly added person.</p>
<p>So, when that code executes, it results in a JS object with this structure:</p>
<pre class="source-code">
People = {
  1: { first_name: `James`, last_name: `Kirk`, age: 32 },
  2: { first_name: `Leonard`, last_name: `McCoy`, age: 38 },
  3: { first_name: `Montgomery`, last_name: `Scott`, age: 43 }
}</pre> <p>We can then access any of the people in the object using the key values (<code>1</code>, <code>2</code>, or <code>3</code>) to access the object for a particular person. The keys act as identifiers for the people in essence, which allows us to request a person by that identifier.</p>
<p>With the database defined, we can set up the first function in our API, and that will be a <code>POST</code> request used to create a new person:</p>
<pre class="source-code">
app.post(`/people`, (inRequest, inResponse) =&gt; {
  const { first_name, last_name, age } = inRequest.body;
  const key = nextKey;
  nextKey = nextKey+ 1;
  people[key] = { key, first_name, last_name, age };
  inResponse.status(201).send(people[key]);
});</pre> <p>As you saw in <a href="B18315_03.xhtml#_idTextAnchor082"><em class="italic">Chapter 3</em></a>, we set <a id="_idIndexMarker754"/>up routes with Express, where a route corresponds to a URL, and we call the appropriate method on the app object that corresponds to the HTTP method the route should respond to in order to do that. Here, we wind up with a URL such as <a href="http://localhost:8080/people">http://localhost:8080/people</a> that we can post to, which will trigger this code.</p>
<p>Inside the function, our middleware will have already parsed the incoming JSON, which would be in the following form:</p>
<pre class="source-code">
{ "first_name": "Pavel", "last_name": "Checkov", "age": 21 }</pre> <p>The individual values will be pulled out and added to the <code>inRequest.body</code> object. We can use JS destructuring notation (as explained in <a href="B18315_06.xhtml#_idTextAnchor159"><em class="italic">Chapter 6</em></a>) to get the values into individual variables. From there, we take the value of <code>nextKey</code> as the key of the new object and make sure we increment it so that the next creation gets a new key. Then, we just add a new object with the data received in the request, under the key we just created.</p>
<p>The final step to creating our web API is to return a response since it wouldn’t be much good without that! But here is another facet of “proper” REST API design: the return codes should also have some meaning, just like the HTTP methods do.</p>
<p>You could return an HTTP 200 status (or response) code here, because 200 means OK, or “the operation was successful.” However, code 201 means Created, which seems more right for an object creation function such as this. There can be debate about which is more appropriate, but the key thing is that your functions are consistent with response code meanings.</p>
<p>And whatever choices <a id="_idIndexMarker755"/>you make, they should always be logical! While 200 or 201 makes sense, 500, for example, wouldn’t because that code means Internal Server Error (you can see a list of the codes and their meanings here: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status</a>).</p>
<p>In addition to the response code, what you return is also an important consideration. And, at the risk of sounding like a broken record, you can find some debate about what is proper for various operations. But when creating a resource such as this, a good approach is to return the new resource itself, since the caller may want a copy of it, especially if the identifier is included, as it is here. That allows the caller to have all the information they need – the key – to delete or update the resource later without having to query the API again to get it.</p>
<p>Next up, let’s look at a function to get a list of all people:</p>
<pre class="source-code">
app.get(`/people`, (inRequest, inResponse) =&gt; {
  inResponse.status(200).json(Object.values(people));
});</pre> <p>Yep, it’s just a simple one line of code! We just need to return a response 200 (which makes sense for a <code>GET</code> operation as none seem better to me) that is a JSON representation of the values – the objects for each person – in the <code>people</code> object.</p>
<p>The next function we’ll write is to get a single person:</p>
<pre class="source-code">
app.get(`/people/:key`, (inRequest, inResponse) =&gt; {
  const key = inRequest.params.key;
  inResponse.status(200).json(people[key]);
});</pre> <p>When you define the URL for an HTTP request, here by calling <code>app.get()</code> again, you can have multiple handlers for a given HTTP method, but the URL must be different for each, or else Express won’t know which you want to use. Here, the URL is made different by the addition of the <code>:key</code> element. This is a token that Express will fill in and make available on the <code>inRequest.params</code> object. If a client makes a <code>GET</code> request to <code>/people</code>, then the previously-defined <code>app.get()</code> route handler will execute, but if they instead make a request to <code>/people/1</code>, then this function will execute instead, and the <code>1</code> value from <a id="_idIndexMarker756"/>the URL will become the value of <code>inRequest.params.key</code>.</p>
<p>That allows us to get the value into the <code>key</code> variable, which we can then use to access the right person object in <code>people</code> and send it back as JSON to the caller, fulfilling the request.</p>
<p class="callout-heading">Note</p>
<p class="callout">I should take this opportunity to point out that I’ve written this code very simplistically, and one thing I left out in service of that goal is error checking. For example, what happens if the caller passes in a <code>key</code> variable that doesn’t exist in <code>people</code>? As written, they’ll get no response (or, really, an empty response – but not what a caller expects; that’s the point). You would most likely want to check for that condition and return a different status code, maybe 404 Not Found, and perhaps a string in the response saying it wasn’t found as well (the latter is another of those debatable REST decisions – some people feel the HTTP response code is sufficient; others always want <em class="italic">some</em> response from a function no matter what).</p>
<p>Okay, great – we can create people and we can get a list of all people and even get one specific person, so what about updating an existing person? That’s next:</p>
<pre class="source-code">
app.put(`/people/:key`, (inRequest, inResponse) =&gt; {
  const key = inRequest.params.key;
  const { first_name, last_name, age } = inRequest.body;
  people[key] = { key, first_name, last_name, age };
  inResponse.status(200).send(people[key]);
});</pre> <p>The URL is the same as for getting a person, which makes sense since in both cases the caller needs to specify the resource that we’re dealing with. But, of course, we need a different HTTP method, so <code>app.put()</code> is used this time to register the handler for this route. Inside the handler function, we’ll keep things simple and always update all fields in the target resource (by way of creating a new object) rather than cherry-picking them. This means the caller must always send all the data back, even fields that aren’t changing. Then, it’s just a matter of creating a new object with the data sent in, assigning it to the proper key in the <code>people</code> object, and returning a suitable response.</p>
<p>Since there isn’t an<a id="_idIndexMarker757"/> HTTP response code that more clearly means updated successfully, I went with a plain 200 (OK), and I sent back the <code>key</code> variable only this time since the caller already effectively has a copy of the data in its now-current state (arguably, it isn’t necessary to even send back the <code>key</code> variable, but in this case, I did prefer to have <em class="italic">something</em> returned).</p>
<p>The final route we have to write is for deleting a person:</p>
<pre class="source-code">
app.delete(`/people/:key`, (inRequest, inResponse) =&gt; {
  const key = inRequest.params.key;
  delete people[key];
  inResponse.status(200).send(key);
});</pre> <p>Yep, it’s that simple! This time, we use <code>app.delete()</code> since that’s the HTTP method needed to use this function. We get the <code>key</code> variable from the URL and use the JS <code>delete</code> keyword, which removes a field from an object, to remove the specified person. Finally, an HTTP 200 response code is sent back, along with the <code>key</code> variable that was removed (again, because I felt it more appropriate to not just return an empty response, but that’s a call you’ll have to make in your own work).</p>
<p>And with that, we have all the functions in our web API that we need. Now, we simply need to start the Express server and thereby make our API active:</p>
<pre class="source-code">
app.listen(8080, () =&gt; {
  console.log(`API is up and running on port 8080`);
});</pre> <p>We run it on port <code>8080</code>, and everything is good to go.</p>
<p>Now, you can, of course, go off and write some code, perhaps some JS to run in a browser, which calls this API. But before you do that, wanting to be a good web developer, you should probably test it a bit, right? How can you do that? You have lots of options here, but I’m<a id="_idIndexMarker758"/> going to talk about one very popular one in particular next: Postman.</p>
<h2 id="_idParaDest-187"><a id="_idTextAnchor187"/>Testing the API with Postman</h2>
<p>Once you have an API <a id="_idIndexMarker759"/>running, testing it can be done in many ways, but one way that many developers use is a tool called Postman. This is a GUI desktop application that <a id="_idIndexMarker760"/>allows you to make all sorts of HTTP requests to anything you need to, including the API that you should have running on your machine at this point. With Postman, you define requests, including what HTTP method they use, what URL they use, and any data to be sent with them, and you can trigger those requests at the click of a button. Postman can show you the response and can even take the raw response and reformat it to make it easier to read.</p>
<p>As an example, testing the <code>GET</code> operation to retrieve all the people from our faux database is easy:</p>
<ol>
<li>Launch Postman and login if necessary.</li>
<li>Create a workspace if you don’t have one already (it may create one by default for you).</li>
<li>On the left, you should see a <strong class="bold">Collections</strong> tab. Collections are just groups of logically related requests. Create a new collection with the <strong class="bold">+</strong> button you should see next to the <strong class="bold">Collections</strong> tab, and name it whatever you’d like (I uncreatively called mine <strong class="bold">Book</strong>).</li>
<li>Click the collection so that it’s highlighted, at which point you should see a three-dot menu to the right of the name. Click the menu, and then select the <strong class="bold">Add Request</strong> option. You should see a new request added, and over on the right, a new tab should appear that has all the details about the request; Postman should automatically focus on the name of the request, ready for you to enter anything you wish there.</li>
<li>Ensure that the <strong class="bold">GET</strong> method is selected in the dropdown below the request name.</li>
<li>In the box to the right <a id="_idIndexMarker761"/>of the method, which should say <strong class="bold">Enter URL</strong> initially, enter <a id="_idIndexMarker762"/>the following URL: <a href="https://localhost:8080/people">localhost:8080/people</a>.</li>
<li>You should then be able to click the <strong class="bold">Send</strong> button to send the request, and the results should appear in the <strong class="bold">Response</strong> section at the bottom.</li>
</ol>
<p><em class="italic">Figure 7</em><em class="italic">.5</em> shows what all of this should look like when done properly:</p>
<div><div><img alt="Figure 7.5: Postman, with a Book collection, a Get All request added, and a successful Get All response" src="img/B18315_07_5.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.5: Postman, with a Book collection, a Get All request added, and a successful Get All response</p>
<p>You can then add a request to test creating a new person. It’s the same procedure starting with creating a new request in the collection; however, this time, the method will be <code>POST</code> body content to send. It’ll just be some JSON, perhaps like the following:</p>
<pre class="source-code">
{ "first_name": "Pavel", "last_name": "Checkov", "age": 21 }</pre> <p>To the right of the <strong class="bold">Body</strong> tab, you’ll also<a id="_idIndexMarker763"/> need to select the type of data as <strong class="bold">JSON</strong>. Once<a id="_idIndexMarker764"/> that’s done, you should be able to trigger the request and get back a valid response, as shown in <em class="italic">Figure 7</em><em class="italic">.6</em>:</p>
<div><div><img alt="Figure 7.6: Postman, showing a successful Create response" src="img/B18315_07_6.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.6: Postman, showing a successful Create response</p>
<p>As an exercise, go ahead and add requests for updating and deleting people. Remember that in those cases, the URL will need to include the key on the end (so, something like <a href="https://localhost:8080/people/4">localhost:8080/people/4</a>, for example, if 4 is the key returned from a create call). Play around with it a bit, creating a person, then doing a <strong class="bold">Get All</strong> to see that it has been added, then maybe updating a person and doing a <strong class="bold">Get</strong> for that specific person to see the update, and finally deleting that person and then doing a final <strong class="bold">Get All</strong> to see they’ve been removed.</p>
<p>This is just the very basics of using Postman; it has a lot more capabilities than this:</p>
<ul>
<li>You can write scripts to execute multiple requests to more fully test your target</li>
<li>You can include cookies and headers and all the other goodies HTTP requests allow for</li>
<li>You can supply security credentials for APIs that require it</li>
<li>You can simulate a browser <a id="_idIndexMarker765"/>sending a form rather than sending JSON</li>
<li>You can test GraphQL servers, which is a way you can expose a database to clients directly in a safe way and in a way that they can query for data based on their own specific needs.</li>
<li>You can set up certificates to be able to test HTTPS endpoints</li>
</ul>
<p>In short: if it’s done via HTTP/HTTPS, then <a id="_idIndexMarker766"/>you can almost certainly do it with Postman. It’s a great tool that allows you to test your server-side code without having to write all the client-side code first.</p>
<p>But aside from during development, another situation where a tool such as Postman can come in handy is if your code isn’t working right for a given request from client to server. The problem could be in your client code or your server code. How do you know which it is? One good way to start figuring that out is to remove one or the other from the equation entirely. If you test your web API with Postman and find a problem occurs, then you just discovered the problem must be on the server side since the client side isn’t involved. Well, to be fair, as you gain experience, you’ll find that statement isn’t always as concrete as it seems! But it’s a generally solid approach to getting on the right path, at least.</p>
<p>Now that you’ve learned a bit about databases and web APIs, let’s talk about something that was actually touched upon earlier but that there’s a little bit more to say about, that being the “classic” web versus the “modern” (SPA-based, primarily) web, and how what’s old is what’s new again, in a sense, in the form of SSR.</p>
<h1 id="_idParaDest-188"><a id="_idTextAnchor188"/>Going back to the future – SSR</h1>
<p>In <a href="B18315_03.xhtml#_idTextAnchor082"><em class="italic">Chapter 3</em></a>, we talked about SPAs and how they lead to a different model of web development. We talked about how this new model was in contrast to the classic model, where every interaction on<a id="_idIndexMarker767"/> the page leads to a request to the server, which generates an entirely new HTML page to be displayed. The new model instead depends on JS: on the client making a request to the server for just data, which the client code then does something with, most often displaying it in some fashion.</p>
<p>When we looked at React, Vue, and Angular, we saw how the initial HTML document was essentially empty, and everything that wound up being shown in the browser was created on the fly by JS on the client machine.</p>
<p>What’s interesting, though, is that as with many things in this field, the pendulum is swinging back the other way a little bit, this time in the form of <strong class="bold">SSR</strong>, which stands for <strong class="bold">server-side rendering</strong>. With SSR, web pages are rendered on the server and returned to the browser.</p>
<p>But wait – isn’t that what came <em class="italic">before</em> SPAs?!</p>
<p>Yes. Yes, indeed it is. The wheel turns, does it not?</p>
<p>As you can probably guess, though, there is a difference between SSR and just having static HTML pages on a web server.</p>
<p>With SSR, it’s often the case that only the first request generates a new HTML page. The server takes what is essentially a <a id="_idIndexMarker768"/>template in the form of an HTML page, merges in some data, and then returns the final HTML to the client. However, what’s interesting is that some of that work can actually be done via JS executing on the server instead of the browser. In effect, the server is acting like a web browser, albeit one that doesn’t display the HTML. You can even use libraries such as React, Vue, and JS to render the content, but on the server. The server produces the final HTML document, as a browser would by executing the JS, and returns it, fully formed, to the browser. This will very often (almost always, in fact) include all the necessary CSS and JS, embedded in the HTML document.</p>
<p>Subsequent actions that occur on the client may result in a call to the server that generates a whole new HTML document, making SSR in that situation just like the classic model. But more often, after the initial page is loaded, things begin to function like an SPA in that the server is called to get only data, which is then rendered or used on the client in some way. We wind up with something of a hybrid approach.</p>
<p>Why would anyone want to do this, you might ask? There are a couple of good reasons:</p>
<ul>
<li><strong class="bold">Performance</strong>: Especially when we’re talking <a id="_idIndexMarker769"/>about how fast a website loads initially, performance is a key metric. By using the server to do that work – servers that are in most cases more powerful than client machines and that are closer to the data they need – returning a complete document can be noticeably faster than returning an HTML document, which then creates new requests to get resources such as JS, CSS, and image files, and then render the content with JS.</li>
<li><strong class="bold">Search engine optimization (SEO)</strong>: It’s the art of including content on a website that search engines use to rank your <a id="_idIndexMarker770"/>site. Properly tuning this content allows you to show up sooner in search results, which is a key consideration for public websites. With a website that functions purely as an SPA, that content only exists on the client machine when requested, so search engines have a harder time indexing your site, and you have a harder time performing SEO. With SSR, though, because the server is returning a full HTML document and not a nearly empty one, you’d get to start a React, Vue, or Angular app, and search engines “see” more content to index, which, when SEO is done properly, leads to higher ranking in search results.</li>
<li><strong class="bold">Better device support</strong>: Because most of the heaviest lifting in terms of rendering the full HTML is done on the server, it allows less powerful client devices to have a more acceptable experience. Older cell phones, for example, still used around the world, will usually have an easier time rendering a complete HTML page – which <a id="_idIndexMarker771"/>from its perspective is static – than it will running a lot of complex JS on the phone itself to generate the HTML on the fly.</li>
</ul>
<p>Most of the modern frameworks have support for SSR nowadays. In fact, it can be as easy as flipping a switch in a config file in some cases, and all of a sudden, you’ll find your initial HTML document being<a id="_idIndexMarker772"/> rendered on the server. Although in a lot of ways like the classic model, which at this point is 30+ years old, SSR is a fairly new thing. Well, sort of: it was actually introduced in some modern frameworks as early as 2010, and 10 years in web development really isn’t a long time! But it’s new in the sense that it has started picking up steam in terms of developer mindshare more recently, as it’s become a more standard part of modern frameworks.</p>
<p>But it’s still an optional thing. Is it possible to do SEO without SSR? Yes, it is, though it can be more challenging. For example, you’ll sometimes find that you may have to have some content in your static HTML page that is invisible and that gets removed when it gets to the browser – but then, you’ll find that search engines are kind of on to such tricks, so it may not work as well as you’d hope, or indeed at all in some cases. And your use case may not make SSR worth it anyway because it certainly does complicate things, and any time you add complexity to web development, you have to do a cost-benefit analysis to decide if it’s worth it.</p>
<p>Another possibility is to use <a id="_idIndexMarker773"/>server-side technologies to render your initial HTML document (as well as handle subsequent data requests), which is actually another form of SSR in a sense, but one in which you have more granular control. That can be done with Node, of course, but there are other options, and that’s what we’re going to talk about next.</p>
<h1 id="_idParaDest-189"><a id="_idTextAnchor189"/>Using PHP on the server side</h1>
<p>There are many server-side technologies you can use; you’re not limited to Node and JS. One such technology – one of the <a id="_idIndexMarker774"/>oldest, in fact – is PHP. First hitting the scene in 1995 (though taking a couple of years to start gaining traction), PHP is what’s known as a <em class="italic">preprocessor</em>. Essentially, it’s an extension to a web server that performs some sort of manipulation on <a id="_idIndexMarker775"/>a requested resource.</p>
<p>In the case of PHP, that manipulation is executing code written in the PHP language that is embedded in an HTML file. The file is given a <code>.php</code> extension, and when requested, that extension identifies to the web server that it needs to hand that file off to the PHP preprocessor, allow it to transform it, and then return to the caller whatever the output of that transformation is.</p>
<p>That may sound a little complicated, but I think a simple example will make it clear (you’ll find this in the <code>hello_world.php</code> file in the <code>ch-07/php</code> directory). As always in programming, let’s use a “Hello, world!” example:</p>
<pre class="source-code">
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;A simple PHP example&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;?php
      echo "Hello, World!";
    ?&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre> <p>As you can see, it’s a simple HTML document, until you hit that funky-looking <code>&lt;?php</code> thing. This begins a block of PHP code, and <code>?&gt;</code> closes the block. Anything in between those must be written in PHP. When this file is requested from a web server that has PHP installed, the web server sees the <code>.php</code> extension and hands the file off to the PHP processor. The processor looks <a id="_idIndexMarker776"/>for any PHP code blocks like this (of which you can have as many as you like) and executes the code in it. Whatever the output of the code is, if any, replaces the block in the final output.</p>
<p>As a result, what gets returned to the browser in this case will be the following:</p>
<pre class="source-code">
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;A simple PHP example&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    Hello, World!
  &lt;/body&gt;
&lt;/html&gt;</pre> <p>As you can see, there no longer is any PHP code. Instead, the text that the code outputs via the <code>echo</code> statement replaces it. This is a common approach with many server-side technologies, <em class="italic">“execute some code in a special block and replace it with the result of that code,”</em> and it means that the client doesn’t need to know anything about PHP; it’s all handled on the server. The client just knows that it’s getting an HTML document back; it doesn’t know anything about what the server did to produce it, but PHP and technologies like it provide us <a id="_idIndexMarker777"/>developers a very simple way to build dynamic content into otherwise static resources and without any complex infrastructure or code such as in a Node/Express application, for comparison.</p>
<p>PHP is a robust and powerful language, much like JS, and has a lot of libraries supporting it that allow it to, for example, interface with databases easily, make calls to remote systems, manipulate images, and really do all the things that any useful server-side language would do. It has over time evolved into a modern language with all the sorts of features developers have come to expect from a modern language.</p>
<p>To give you just a little more of a taste of PHP, let’s implement a pretty common thing done with it, or really any <a id="_idIndexMarker778"/>server-side technology: handling the submission of a form.</p>
<p>First, we’ll create a simple form (<code>form.html</code>):</p>
<pre class="source-code">
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;PHP Form&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;form action="form.php" method="post"&gt;
      Your Name: &lt;input type="text" name="username"&gt;&lt;br&gt;
      &lt;input type="submit"&gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre> <p>As you can see, it’s just a simple HTML form, something you’ve seen before. We allow the user to enter their name and submit the form; that’s it. The target of the form submission is <code>form.php</code>, which we’ll create next:</p>
<pre class="source-code">
&lt;?php
  $username = $_POST["username"];
  echo "Hello, " . $username . "!";
?&gt;</pre> <p>Here, we construct a plain text response by getting the <code>username</code> variable from the request and constructing a string with it. Variables in PHP begin with a <code>$</code> symbol, and the <code>$_POST</code> variable is one PHP supplies which will hold the values of any data submitted via a POST request. The only one we have to worry about is <code>username</code>, so we wind up with a <code>$username</code> variable with the value of whatever the user submitted in the form. Then, <code>echo</code> is used to create the output, and in PHP, periods are used to represent string concatenation, so we’re building a string such as <code>"Hello, Frank!"</code> and returning that to the client (note that we don’t need to construct a full HTML document because the browser is quite capable of displaying a plain text response such as this).</p>
<p>PHP is fairly straightforward<a id="_idIndexMarker779"/> but opens up a lot of possibilities. It is, however, far from the only such option available. Another one, which in some contexts is much more popular, is Java, and specifically the Spring Boot library for it. Let’s take a quick look at that now.</p>
<h1 id="_idParaDest-190"><a id="_idTextAnchor190"/>Building with Java and Spring Boot</h1>
<p>Java and Spring Boot kind of go hand in hand these days in the sense that Spring Boot is the most popular way people write apps using Java nowadays, but Spring Boot couldn’t exist without Java. So, let’s start with Java, then talk about some things that go along with it that allow you to build web <a id="_idIndexMarker780"/>apps, and finally arrive at Spring Boot. I think once <a id="_idIndexMarker781"/>you’ve read through this entire section, you’ll understand how the pieces fit together pretty well.</p>
<h2 id="_idParaDest-191"><a id="_idTextAnchor191"/>Introducing Java</h2>
<p><strong class="bold">Java</strong>, which I’ll let you know up-front has nothing to do with JS other than a similar-looking language syntax and is a product of the now-defunct Sun Microsystems, is now owned by Oracle, and it is easily<a id="_idIndexMarker782"/> one of the most widely used languages and platforms of them all. It is especially popular in enterprise environments where things such as stability and flexibility – and having a company sue if something goes wrong, to be blunt – are of primary importance.</p>
<p>Java became popular based on its “write once run anywhere” principle. It was one of the first languages that allowed for a piece of code, without being changed in any way, to run on multiple different hardware platforms and operating systems. There were a few ways to do that before Java, but none were as easy as Java.</p>
<p>Java accomplishes this by the introduction of the <strong class="bold">JVM</strong>, or <strong class="bold">Java Virtual Machine</strong>. It’s similar conceptually to the VMs you’ve already met, but it’s not a full simulation of a machine. Instead, it’s a simulation of an <a id="_idIndexMarker783"/>artificial machine, one that doesn’t exist in the real world. It winds up being a target for compiled code. In other words, rather than compiling Java code to a form that can run on the native machine, it instead compiles to an intermediate form that can run on the artificial machine the JVM represents. The JVM also isn’t an encapsulation of that machine and an operating system like a VM is; it instead is just the machine, with<a id="_idIndexMarker784"/> the compiled Java code running on it, and being the only thing running on it (more or less).</p>
<p>Java also comes with a very extensive standard library and thousands upon thousands of functions for you to use, battle-tested and extremely solid. This means you have a great foundation to build upon even before you think about adding any third-party libraries, which Java, of course, supports.</p>
<p>When you work with Java, you <a id="_idIndexMarker785"/>normally will interact with its <strong class="bold">JDK</strong> or <strong class="bold">Java Development Kit</strong>. The JDK is a specific form of an <strong class="bold">SDK</strong>, which stands for <strong class="bold">software development kit</strong>. An SDK is a <a id="_idIndexMarker786"/>collection of tools for working with a specific development platform or language, and a JDK then is an SDK specific to Java. You install a JDK, or indeed you can usually just expand an archive and not actually install it per se, and then use its command-line tools to compile code, debug code, and do all the other things you might want to do with Java code.</p>
<h2 id="_idParaDest-192"><a id="_idTextAnchor192"/>Writing a Java app</h2>
<p>And what does Java code look like? Here is <a id="_idIndexMarker787"/>perhaps the simplest Java app you can write (this is the <code>HelloWorld.java</code> file in the <code>ch-07/java</code> directory):</p>
<pre class="source-code">
public class HelloWorld {
    public static void main(String inArgs[]) {
        System.out.println("Hello from your first Java
                            app!");
    }
}</pre> <p>This is called a Java <em class="italic">app</em> specifically, and it shows that everything in Java begins with a class, which is the fundamental concept in <code>public</code> keyword before the <code>class</code> keyword and name is called an access modifier, and it tells Java where this class can be used from. The <code>public</code> access modifier means that any other Java code can use it.</p>
<p>Classes can have a lot of <a id="_idIndexMarker789"/>stuff in them, but this one contains just one thing: a function (or method, since it’s a function in a class) named <code>main()</code>. The method has the <code>public</code> access modifier too, so any other Java code can call this method (by contrast, a method can be private, which would mean that only other code in the class can use it).</p>
<p>The <code>static</code> keyword means that the <code>main()</code> method can be called on the <code>HelloWorld</code> class without creating a new instance of it first (which is typically what we do with classes – create object instances from them, but in this case, we just want to be able to execute the method, so we can skip that requirement with <code>static</code>).</p>
<p>The <code>void</code> keyword means that this method won’t return anything.</p>
<p>This method accepts an argument that is an array of strings and that will come from any options we pass to it on the command line when run, if any (we don’t need that here, but I figured I’d mention it since it’s required by Java to make a Java app work).</p>
<p>The <code>System.out.println()</code> statement in <code>main()</code> – the only code in it – is a method that outputs text to the console.</p>
<p>You must first compile this app, and that’s done using the Java compiler:</p>
<pre class="source-code">
javac HelloWorld.java</pre> <p>That will produce a <code>HelloWorld.class</code> file. A <code>.class</code> file is what actually runs on the JVM, which you can now do easily:</p>
<pre class="source-code">
java HelloWorld</pre> <p>Note that <code>javac</code> is the Java compiler, while plain old <code>java</code> is essentially the JVM. The JVM will look for a file named <code>HelloWorld.class</code> in the current directory, will find it assuming you’ve compiled <code>HelloWorld.java</code>, and will then look for a <code>public static void main()</code> method in it (it <em class="italic">has</em> to be that <em class="italic">exact</em> method signature), which is the default method a Java app must include to be runnable. Finding one, it will execute the method, and the text should be output to the console.</p>
<p>Java apps are neat, and you can do virtually anything with them, but when we’re talking about web development with Java, we rarely do that with plain Java apps. The next step above apps when it comes to web development are JSPs and servlets.</p>
<h2 id="_idParaDest-193"><a id="_idTextAnchor193"/>Introducing JSPs and servlets</h2>
<p>As with PHP (and with <code>.cshtml</code> files, as you’ll see with .NET later), Java offers a template language called <strong class="bold">JSP</strong>, or <strong class="bold">Java Server Pages</strong>. This allows you to embed Java code in HTML files. A simple example would be <a id="_idIndexMarker790"/>the following:</p>
<pre class="source-code">
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Hello World JSP&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;% out.println("Hello World!"); %&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre> <p>Any code inside the <code>&lt;% %&gt;</code> block is Java code and will be executed as such, just as with PHP.</p>
<p>When a JSP is requested, it will be processed by the JVM, and what will happen is something called a <strong class="bold">servlet</strong> will be generated. A<a id="_idIndexMarker791"/> servlet is a special Java class that knows how to respond to HTTP requests. But servlets can’t work alone. Instead, they have to be run as part of a <strong class="bold">Java web app</strong>, which runs in an <strong class="bold">application server</strong>. The application server manages the web app, handles its lifecycle events, and acts as the web server. When it sees a<a id="_idIndexMarker792"/> request come in for this JSP for the first time, it will generate a servlet class and then execute it (subsequent requests can just execute it immediately).</p>
<p>The servlet code for our JSP that would be generated might look something like this:</p>
<pre class="source-code">
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
public class GeneratedServlet extends HttpServlet {
    public void _jspService(HttpServletRequest request,
        HttpServletResponse response)
            throws IOException, ServletException {
        response.setContentType("text/html");
        PrintWriter out = response.getWriter();
        out.println("&lt;html&gt;");
        out.println("&lt;head&gt;");
        out.println("&lt;title&gt;Hello World JSP&lt;/title&gt;");
        out.println("&lt;/head&gt;");
        out.println("&lt;body&gt;");
        out.println("Hello World!");
        out.println("&lt;/body&gt;");
        out.println("&lt;/html&gt;");
    }
}</pre> <p>There would likely be additional methods present to handle various events in the lifetime of a servlet, but that’s the basic idea, and you can see how the <code>_jspSevice()</code> method, which<a id="_idIndexMarker793"/> is the main one in a servlet, outputs the HTML from our JSP. Of course, more complex Java code in the JSP would result in more complex code in the servlet too.</p>
<p>You can write a servlet directly yourself too; you don’t have to start with JSPs. In fact, while JSPs can’t be used without servlets, servlets can definitely be used without JSPs.</p>
<p>Note that I have not included a complete example of all of this in the code bundle for two reasons.</p>
<p>First, there’s quite a lot more involved in setting up a working Java web app than this, starting with needing to install and run an app server (which is what manages the JSPs and servlets and the web app they’re a part of, and something called <strong class="bold">Java Enterprise Edition</strong> (or <strong class="bold">JEE</strong> for short). While Java itself comes with a robust standard library, JEE builds on top of that significantly, providing <a id="_idIndexMarker794"/>a lot of the higher-level functions modern web apps need. While Java comes with basic data structure and algorithms, JEE added JSPs, servlets, database access, and a whole host of other “advanced” facilities.</p>
<p>Second, I wanted to save space<a id="_idIndexMarker795"/> for the next section, which I did include a working example for since the topics of Spring and Spring Boot are arguably more important nowadays than being able to build a Java web app from scratch using JSPs and/or servlets and even JEE, and that’s what we’re looking at next.</p>
<h2 id="_idParaDest-194"><a id="_idTextAnchor194"/>Introducing Spring and Spring Boot</h2>
<p><strong class="bold">Spring</strong> is without question the single most popular third-party library available for Java. It supplies an absolutely <a id="_idIndexMarker796"/>monstrous list of features on top of Java: things such as security, streamlined database functionality, a high-level web app architecture, REST service construction and consumption, task scheduling, and so much more.</p>
<p>What it’s perhaps best known for, though, is its <strong class="bold">Dependency Injection</strong>, or <strong class="bold">DI</strong>, framework. DI is the idea that rather than <a id="_idIndexMarker797"/>your code constructing objects of various types, it is better to have some higher-level entity <em class="italic">inject</em> them into your code. There are many reasons for doing this, but maybe the biggest is testing. If you have some code that builds a connection to a database and you then want to test the code, you might need to connect to a separate test database. Rather than having to build that into the code, you could instead have a test framework build the connection, knowing how to build it for the test database rather than the real database, and inject the connection into your code. That way, the code you test is identical regardless of which database you connect to.</p>
<p>Spring became famous for this DI framework, but it grew massively after that, encompassing nearly anything you could do with Java. In fact, it’s so comprehensive now that a lot of people consider Spring to be the core of what Java is, JEE specifically. While Spring still needs JEE under the covers, when using Spring, you can all but ignore JEE if you wish, deferring to Spring’s functionality instead.</p>
<p>Building on top of Spring comes something called Spring Boot. In short, <strong class="bold">Spring Boot</strong> is a framework that helps you<a id="_idIndexMarker798"/> bootstrap (set up) and develop Spring-based Java apps, most commonly web apps. Spring Boot does this in the following ways:</p>
<ul>
<li><code>.class</code> files). This simplifies the process of setting up and configuring Spring applications.</li>
<li><strong class="bold">Standalone</strong>: Spring Boot applications are standalone and can be run directly using Java, which makes it easier to build and test Spring applications.</li>
<li><strong class="bold">Opinionated defaults</strong>: Spring Boot comes with a set of opinionated defaults for quick project setup, while also offering options to override these settings for customization. This means you have to do less up-front configuration to make a Spring Boot app work, but you can override the defaults later as needs dictate.</li>
<li><strong class="bold">Embedded servers</strong>: Spring Boot apps include the Tomcat, Jetty, or Undertow app server directly, so you don’t need to deploy your application to an app server. You get a runnable unit with Spring Boot that requires nothing aside from Java itself to work.</li>
<li><strong class="bold">Wide range of features</strong>: Out-of-the-box Spring Boot supports a wide range of data access, security, and cloud services, making it a versatile tool for a variety of applications.</li>
</ul>
<p>Let’s now build a simple Hello World web app with Spring Boot and see what’s involved.</p>
<h2 id="_idParaDest-195"><a id="_idTextAnchor195"/>A simple Spring Boot web app</h2>
<p>The simplest way to start a Spring<a id="_idIndexMarker799"/> Boot app is to head on over to <a href="https://start.spring.io">https://start.spring.io</a> and let someone else do the work for you! This is a site provided by the creators of Spring and Spring Boot that will generate a basic Spring Boot app for you.</p>
<p>You can see this site in <em class="italic">Figure 7</em><em class="italic">.7</em>. If you want to try it yourself, select the options you see here (including adding the <strong class="bold">Spring Web</strong> dependency on the right, or this project won’t work!).</p>
<div><div><img alt="Figure 7.7: The Spring Initializr website with options for creating the example project" src="img/B18315_07_7.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.7: The Spring Initializr website with options for creating the example project</p>
<p>Once you click the <code>.zip</code> file that contains your starter project. Extract that archive, go to Command Prompt in the directory (which would be named <code>demo</code> if you entered exactly what is shown in the screenshot), and execute this command:</p>
<pre class="source-code">
mvnw spring-boot:run</pre> <p>You’ll see a ton of stuff fly by and, as long as it doesn’t end with an error of some sort, it doesn’t really matter. But, to give you some idea… Maven, which is what the <code>mvnw</code> command represents, is a <a id="_idIndexMarker800"/>Java build tool. It knows how to build your project into a runnable unit. You see, real Java apps are rarely just a single <code>.java</code> file to be compiled. Usually, there are all sorts of third-party libraries needed, lots of source files to compile, and other files that must be included in various ways. Rather than figure out how to do all of that yourself, as long as you follow a standard structure and provide some configuration files, then Maven will know how to build your project, get all the dependencies for you, and handle all those icky details.</p>
<p>Usually, the command to use for Maven is just plain <code>mvn</code>. But, for that to work, Maven must already be installed and in your path. To save from having to do that yourself, <code>mvnw</code> is a Maven <em class="italic">wrapper</em>. These files know how to use Maven without you first having to install it. When you first run that command, the wrapper will download the necessary Maven files, everything Maven needs to run, and then it will begin building the project, downloading all of its dependencies along the way.</p>
<p>At the end, it will run the project, which starts the server that Spring Boot provides. And you can then access it in your browser at <a href="http://localhost:8080">http://localhost:8080</a>. However, if you do that right away, you’ll get a “Whitelabel Error Page” screen. That’s because we haven’t supplied any code to<a id="_idIndexMarker801"/> handle the default route, and Spring Boot isn’t going to do that for us!</p>
<p>To fix it, we need to add a file named <code>HelloController.java</code> in the <code>src/main/java/com/example/demo</code> directory under the parent project directory and put the following content into it:</p>
<pre class="source-code">
package com.example.demo;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.
    RestController;
@RestController
public class HelloController {
    @GetMapping("/")
    public String index() {
        return "Hello, world!";
    }
}</pre> <p>This is a controller class that handles requests to specified URLs. In this case, the <code>@GetMapping("/")</code> line tells Spring Boot to execute this method when a URL with nothing after the domain name comes in (where <code>localhost</code> is our domain name).</p>
<p>This statement, plus the <code>@RestController</code> line, are what <a id="_idIndexMarker802"/>are called <code>@RestController</code> annotation tells Spring Boot that this class handles HTTP requests (it’s generally meant to be used to build REST APIs, but given that a simple <code>GET</code> request to a URL is still a RESTful operation, it counts for this use case), and Spring Boot will maintain a mapping <a id="_idIndexMarker803"/>between URLs and controllers and hand requests off to the appropriate controllers when they come in.</p>
<p>The method annotated with the <code>@GetMapping</code> annotation then executes and returns our greeting string – nothing fancy there at all. In fact, this is about as simple as a Spring Boot app gets, but it demonstrates the basic ideas well enough.</p>
<p>Spring Boot, as well as Spring and Java itself, is so broad and does so much that you can’t hope to learn it all in one go; you have to introduce new concepts as they’re needed and learn as you go, which you’ll remember is one of the big core requirements to being a web developer!</p>
<p>Now that you’ve seen some PHP and Java, let’s have a look at another choice for server-side coding, this time from our friends at Microsoft: .NET.</p>
<h1 id="_idParaDest-196"><a id="_idTextAnchor196"/>Introducing .NET</h1>
<p>While Java largely rules the enterprise space, it’s not the only popular choice there. Microsoft has a competitor to it named .NET. As with Java, it’s a large, sprawling platform that covers pretty much all the bases in terms of what developers need. It can handle database access and network <a id="_idIndexMarker804"/>communications and can be used to build RESTful APIs as well as other <a id="_idIndexMarker805"/>server-based facilities. It can be used in <strong class="bold">artificial intelligence</strong> (<strong class="bold">AI</strong>) applications, and it comes with support for several <a id="_idIndexMarker806"/>different languages via the <strong class="bold">Common Language Runtime</strong> or <strong class="bold">CLR</strong>, which is conceptually like Java’s JVM.</p>
<p>And like Java, while .NET is definitely used for desktop development – more so than Java, in fact, is – it has largely become the domain of the server and is the primary supported language/platform in Microsoft’s Azure cloud. And while .NET began primarily as a Windows technology, it is currently also officially supported on Linux and other operating systems.</p>
<p>.NET is often used in conjunction with Microsoft’s Visual Studio IDE. In fact, in practice, you probably won’t find that many .NET developers who don’t use it! But at the end of the day, it’s not required since .NET provides an SDK like Java that you can work with exclusively from the<a id="_idIndexMarker807"/> command line, and for our purposes, here we won’t be using Visual Studio.</p>
<h2 id="_idParaDest-197"><a id="_idTextAnchor197"/>Generating a Hello World web app</h2>
<p>Assuming you have the .NET SDK installed and <a id="_idIndexMarker808"/>working, it makes it even easier than other options to build a Hello World application because it’s built right into .NET! All you need to do is create a directory for your project and execute this command:</p>
<pre class="source-code">
dotnet new mvc -n HelloWorld</pre> <p>You’ll wind up with a new directory named <code>HelloWorld</code>, in which will be a fully functional Hello World application! To run it, navigate to that new directory and execute this command:</p>
<pre class="source-code">
dotnet run</pre> <p>You will, of course, find such a project already built in the <code>ch-07/dotnet/HelloWorld</code> directory, but it’s a good exercise to create and run it yourself from scratch. And once you do, you can access the page at http://localhost:5262.</p>
<p>You’ll note from looking at <em class="italic">Figure 7</em><em class="italic">.8</em> that it has a little more content than the simple “Hello, World!” page as in the previous examples (which is why I’m showing it here while I didn’t show the others). Unfortunately, as a result of that, there is a lot more code behind this “simple” example than either the PHP or Java versions – too much to go into everything:</p>
<div><div><img alt="Figure 7.8: The .NET version of the Hello World app" src="img/B18315_07_8.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.8: The .NET version of the Hello World app</p>
<p>But, to not leave you completely with nothing, the three main files involved are probably <code>Program.cs</code>, <code>HomeController.cs</code>, and <code>Index.cshtml</code> (there are many other files created by .NET, but those are kind of the key ones). These files are what we’ll be looking at in the next three subsections.</p>
<p>The <code>.cs</code> extension indicates these are C# source files, where C# is one of the languages you can use in .NET, and by <a id="_idIndexMarker809"/>far the most used one at that (nearly to the exclusion of all others, I’d even say). By extension, <code>.cshtml</code> indicates an HTML file that has C# code embedded in it, much like a <code>.php</code> file can have PHP code embedded in it.</p>
<h3>The server starting point</h3>
<p>Here’s the <code>Program.cs</code> file, which is<a id="_idIndexMarker810"/> essentially the starting point that sets up the server:</p>
<pre class="source-code">
var builder = WebApplication.CreateBuilder(args);
builder.Services.AddControllersWithViews();
var app = builder.Build();
if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Home/Error");
    app.UseHsts();
}
app.UseHttpsRedirection();
app.UseStaticFiles();
app.UseRouting();
app.UseAuthorization();
app.MapControllerRoute(
    name: "default",
    pattern: "{controller=Home}/{action=Index}/{id?}");
app.Run();</pre> <p>If you generate this app yourself, your version may look slightly different depending on what version of the SDK you have, but it should look substantially the same. From it, you can tell that C# looks a lot like all the languages you’ve seen, which is to be expected since they all are based on the C language’s syntax and structure (there are huge differences between, say, JS and C#, but they look similar enough and share enough concepts that you can <a id="_idIndexMarker811"/>probably grasp what’s going on even if you’ve never seen a given C-based language before).</p>
<p>Similar to making a server with Node and Express, you construct an <code>app</code> object, in this case using something called a builder, which is code that knows how to construct an <code>app</code> object for you (I know, obvious, right?). After that, middleware is added for doing things such as handling errors (<code>UserExceptionHandler</code>), serving static files (<code>UseStaticFiles</code>), and setting up routes to controllers (<code>MapControllerRoute</code>).</p>
<h3>The controller</h3>
<p>A controller is a piece of code that handles <a id="_idIndexMarker812"/>a given request, and that’s where the <code>HomeController.cs</code> file comes in, as it handles our main “home” route:</p>
<pre class="source-code">
using System.Diagnostics;
using Microsoft.AspNetCore.Mvc;
using HelloWorld.Models;
namespace HelloWorld.Controllers;
public class HomeController : Controller
{
    private readonly ILogger&lt;HomeController&gt; _logger;
    public HomeController(ILogger&lt;HomeController&gt; logger)
    {
        _logger = logger;
    }
    public IActionResult Index()
    {
        return View();
    }
    public IActionResult Privacy()
    {
        return View();
    }
    [ResponseCache(Duration = 0, Location =
        ResponseCacheLocation.None, NoStore = true)]
    public IActionResult Error()
    {
        return View(new ErrorViewModel { RequestId =
            Activity.Current?.Id ??
                HttpContext.TraceIdentifier });
    }
}</pre> <p>This is part of an <strong class="bold">MVC</strong> application, which stands for <strong class="bold">Model-View-Controller</strong>. This is an application architecture pattern – a<a id="_idIndexMarker813"/> way to structure applications, in other words – that tries to separate out the view (usually in the form of an HTML file or something similar) from the model (which means the data, in essence) from the controller (which binds the other two together). The three are usually implemented as separate units of code as is the case here, but they work together to generate a response for a client on a given URL. The reason for <a id="_idIndexMarker814"/>doing this is that if you want to change, say, your database, you can do so without touching the view or the controller layers; just change the model layer as needed.</p>
<p>Note that in this example, there actually is no model layer, which is okay: you can still have a more-or-less MVC architecture even if the view or model is left out (the controller will always be present, and it’s rare to not have a view layer, but if you don’t need data then you don’t need a model layer, which really makes it an MV architecture, but we tend to call it MVC anyway, I guess just because developers can be weird sometimes!).</p>
<h3>The view</h3>
<p>Finally, a view is<a id="_idIndexMarker815"/> generated by the <code>Index.cshtml</code> file:</p>
<pre class="source-code">
@{
    ViewData["Title"] = "Home Page";
}
&lt;div class="text-center"&gt;
    &lt;h1 class="display-4"&gt;Welcome&lt;/h1&gt;
    &lt;p&gt;Learn about
        &lt;a href="https://learn.microsoft.com/aspnet/core"&gt;
            building Web apps with ASP.NET Core&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;</pre> <p>And it’s the simplest one of the three! Like PHP and JSP, it’s a template in essence, where the <code>${ }</code> blocks represent C# code to be executed when rendered. The rest is just plain HTML.</p>
<p>PHP, Java, and .NET aren’t the only choices, though. Another you might consider is one you saw in earlier chapters: Python. Let’s see how Python can be used to build web apps next.</p>
<h1 id="_idParaDest-198"><a id="_idTextAnchor198"/>Using Python web app frameworks</h1>
<p>In <a href="B18315_05.xhtml#_idTextAnchor129"><em class="italic">Chapter 5</em></a>, you met Python, and we<a id="_idIndexMarker816"/> talked about how it can be used in the context of DevOps. That’s not the only place Python can be used, though. Of course, you can write standalone Python apps for all sorts of purposes too. But beyond that, Python can be used as the backend platform for your websites and web apps as well.</p>
<p>As you’ve seen, when working with Node to develop server-side code, developers have two main paths. One is to build the server code solely with Node’s built-in capabilities, which can be suitable for smaller projects. However, for larger projects, most developers prefer using a library or framework such as Express to enhance their development process.</p>
<p>Similarly, Python offers all the<a id="_idIndexMarker817"/> essentials for building a server from scratch. But as with Node, many developers opt for a more comprehensive solution in the form of a framework to avoid writing a lot of repetitive, foundational code, one of those being Django.</p>
<h2 id="_idParaDest-199"><a id="_idTextAnchor199"/>Django</h2>
<p><strong class="bold">Django</strong> is a framework designed to<a id="_idIndexMarker818"/> streamline development; Django aims to ease the development load by providing pre-built defaults for various functions, significantly <a id="_idIndexMarker819"/>cutting down on the amount of basic code developers need to write. Django is known for being like Angular in the sense that it tries to include most, if not all, of what a typical developer will need to get the job done.</p>
<p>To give you a brief view of what a Django app might look like, you would need to start by creating a directory to host your project (which you’ll find in the download bundle under <code>ch-07/python</code>) and installing Django itself:</p>
<pre class="source-code">
pip install django</pre> <p>In the Python world, <code>pip</code> plays the same basic role as <code>npm</code> does in the Node world, installing and dealing with packages, and this specific command installs the Django package globally, meaning it can be used from anywhere. After that, we can use commands that Django provides to create a new Django project:</p>
<pre class="source-code">
django-admin startproject helloworld_project</pre> <p>You’ll wind up with a <code>helloworld_project</code> directory in whichever directory you’re in when you execute it, which you will then navigate to for the next steps.</p>
<p>With Django, a single project can host multiple apps, but we just need one right now, and there’s a command to create that too:</p>
<pre class="source-code">
python manage.py startapp hello</pre> <p>The <code>manage.py</code> file is a script provided by Django for performing all sorts of setup and management tasks on a project and the apps under it. After executing that command, you’ll find a <code>hello</code> directory created inside the <code>helloworld_project</code> directory.</p>
<p>The next step is to create a view, which is conceptually like a route in an Express app: something that will respond to <a id="_idIndexMarker820"/>requests to a specific URL. To do this, go into the <code>hello</code> directory, open the <code>views.py</code> file that you’ll find has been created <a id="_idIndexMarker821"/>there, and add this content below the comment line:</p>
<pre class="source-code">
# Create your views here.
from django.http import HttpResponse
def hello_world(request):
    return HttpResponse("Hello, World!")</pre> <p>This provides a function that will ultimately execute when we make a request to a configured URL and will return a simple text response.</p>
<p>Next, you need to tell Django to use this view. This requires two steps.</p>
<p>First, in the <code>helloworld_project</code> directory, you find that a directory was created automatically that is also named <code>helloworld_project</code>. I know – the names are confusing, but it’s the way Django does it: you get a directory with the same name as the project directory it’s in. Inside that inner <code>helloworld_project</code> directory, open the <code>urls.py</code> file. In it, you’ll find some instructional comments and a few lines of code. Two things need to be done here. First, add a new import under the existing one:</p>
<pre class="source-code">
from django.urls import include</pre> <p>That adds a package named <code>include</code> that we need in order to do the rest of what’s to come.</p>
<p>Then, on the line that defines the <code>urlpatterns</code> array, add a new entry after the <code>/admin</code> one that’s already there:</p>
<pre class="source-code">
path('hello/', include('hello.urls')),</pre> <p>This essentially sets up a route to the <code>hello</code> app itself and tells Django to look for routes in it as defined in its own <code>hello.urls</code> file.</p>
<p>And that file is the final step to make everything work. You’ll need to create a <code>urls.py</code> file in the <code>hello</code> directory with the following content:</p>
<pre class="source-code">
from django.urls import path
from . import views
urlpatterns = [
    path('', views.hello_world, name='hello_world'),
]</pre> <p>That sets up a route in the <code>hello</code> app itself to the view we created.</p>
<p>At this point, your first Django app should be ready! Conveniently, Django includes a built-in web server to test with, and <a id="_idIndexMarker822"/>you can start it up now to try your app out:</p>
<pre class="source-code">
python manage.py runserver</pre> <p>You should find that your app responds<a id="_idIndexMarker823"/> to requests to <a href="http://localhost:8000/hello">http://localhost:8000/hello</a>.</p>
<p>For such a simple example, it may seem like there’s a lot involved with Django, but as an app gets more complex, it starts to pull its weight much more by virtue of the advanced functionality it provides, which while it can require this type<a id="_idIndexMarker824"/> of setup too, it tends to have a much better <strong class="bold">return on investment</strong> (<strong class="bold">ROI</strong>), meaning the benefit is worth the cost.</p>
<p>But if you find Django not to your liking, another popular framework named Flask might be more so.</p>
<h2 id="_idParaDest-200"><a id="_idTextAnchor200"/>Flask</h2>
<p>With <strong class="bold">Flask</strong>, another popular Python web<a id="_idIndexMarker825"/> framework like Django, the Hello World <a id="_idIndexMarker826"/>example is a lot simpler, and it begins with installing Flask:</p>
<pre class="source-code">
pip install flask</pre> <p>Next, create a directory for your project (which you can name anything you like), and in it, create an <code>app.py</code> file like so:</p>
<pre class="source-code">
from flask import Flask
app = Flask(__name__)
@app.route('/')
def hello_world():
    return 'Hello, World!'</pre> <p>And guess what? You’re actually <a id="_idIndexMarker827"/>done at this point! You can now run the development server that, like Django, Flask provides:</p>
<pre class="source-code">
flask run</pre> <p>And then, you can access the app at <a href="http://localhost:5000">http://localhost:5000</a>.</p>
<p>With Flask clearly being much simpler, why would anyone in their right mind choose Django?!</p>
<p>The answer is that they<a id="_idIndexMarker828"/> serve different purposes:</p>
<ul>
<li>Django is attempting to be as close to all-encompassing as possible. It has facilities for working with databases, security, a built-in administration app, functions for dealing with sessions and authentication, a templating engine, advanced URL routing, and a lot more.</li>
<li>Flask, on the other hand, is what’s <a id="_idIndexMarker829"/>known as a <strong class="bold">micro-framework</strong>. Flask is designed to be more lightweight and simply not do as much as Django, which requires you to add other libraries to the mix as you see fit.</li>
</ul>
<p>Both have their pros and cons, and it’s roughly the same situation as comparing React or Vue to Angular: the first two simply do a lot less out of the box, by design, but there is arguably more flexibility in a smaller framework since you get to choose how specific features are provided.</p>
<h1 id="_idParaDest-201"><a id="_idTextAnchor201"/>Reviewing the roadmap</h1>
<p>Well, that’s a few<a id="_idIndexMarker830"/> more knocked off, isn’t it? In <em class="italic">Figure 7</em><em class="italic">.9</em>, you can see the updated web developer roadmap:</p>
<div><div><img alt="Figure 7.9: The roadmap with a few more boxes filled in" src="img/B18315_07_9.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.9: The roadmap with a few more boxes filled in</p>
<p>With this chapter, you<a id="_idIndexMarker831"/> uncovered the <strong class="bold">Databases</strong>, <strong class="bold">Java and Spring Boot</strong>, <strong class="bold">PHP</strong>, and <strong class="bold">.NET</strong> blocks. And would you look at that – the entire backend section is now fully revealed!</p>
<h1 id="_idParaDest-202"><a id="_idTextAnchor202"/>Summary</h1>
<p>In this chapter, you learned about a variety of server-side technologies, starting with databases. You learned the difference between relational databases and NoSQL databases, and in the process, you got an introduction to the SQL language. You then learned about exposing that data through a REST interface, probably the most common way web APIs are provided these days (oh, and you learned what a web API is too, didn’t you?).</p>
<p>After that, you got a look at some server-side technologies for building server-side code, including Java and Spring Boot, PHP, .NET, and some Python web frameworks such as Django and Flash. You sampled code for all of them to give you an idea of what might be involved if you choose them, and we talked a bit about the decision points that go into choosing one versus another – and you learned that in large part, it comes down to personal preference and what you have the most experience working with!</p>
<p>In the next chapter, we’re going to in a sense close out the technical portion of this book and look at some alternate approaches to coding, in some cases some cutting-edge technologies that attempt to make web development much less about development. This includes things such as AI, <strong class="bold">content management systems</strong> (<strong class="bold">CMS</strong>), and other so-called “no-code” alternatives.</p>
</div>
</body></html>