<html><head></head><body>
<div><div><h1 id="_idParaDest-285"><em class="italic"><a id="_idTextAnchor289"/>Chapter 12</em>: Optimizing Bootstrap 5 CSS and JavaScript Code</h1>
<p>In this chapter, we’re not going to use Bootstrap 5 to create any new user interfaces or customize any existing ones. We won’t even look at any of the source code contained in the Bootstrap 5 files. Instead, we will see how we can optimize our compiled Bootstrap 5 CSS and JavaScript code after we have finished creating our website.</p>
<p>We will first concentrate on optimizing our stylesheet by only including the Bootstrap 5 Sass partials we actually use and removing all the helpers and utilities that we don’t use. Then we will use Node.js, NPM, and Laravel Mix to set up a build process to automate some tasks that will help us bundle only the JavaScript that our components actually use and minify both our compiled CSS and bundled JavaScript.</p>
<p>In this chapter, we’re going to cover the following main topics:</p>
<ul>
<li>Including the Sass partials for the used components only</li>
<li>Removing unused helpers and utilities</li>
<li>Setting up a build process using Node.js, npm, and Laravel Mix</li>
<li>Using a module bundler to optimize JavaScript</li>
<li>Minifying our compiled CSS and bundled JavaScript</li>
</ul>
<h1 id="_idParaDest-286"><a id="_idTextAnchor290"/>Technical requirements</h1>
<ul>
<li>To preview the examples, you will need a code editor and a browser. The source code for all code examples can be found here: <a href="https://github.com/PacktPublishing/The-Missing-Bootstrap-5-Guide">https://github.com/PacktPublishing/The-Missing-Bootstrap-5-Guide</a>.</li>
<li>To compile Sass to CSS, you will need either of the following: <ul><li><strong class="bold">Node.js</strong>, if you prefer a <strong class="bold">command-line interface</strong> (<strong class="bold">CLI</strong>) using Terminal (Mac) or Command Prompt (Windows) </li>
<li><strong class="bold">Scout-App</strong>, if you prefer a <strong class="bold">graphical user interface</strong> (<strong class="bold">GUI</strong>) </li>
<li><strong class="bold">Visual Studio Code</strong>, if you prefer to use an extension from the Visual Studio Code Marketplace</li>
</ul></li>
</ul>
<p>All these approaches are explained in <a href="B17143_02_epub.xhtml#_idTextAnchor033"><em class="italic">Chapter 2</em></a>, <em class="italic">Using and Compiling Sass</em>.</p>
<p>To use Laravel Mix, you will need <strong class="bold">Node.js</strong> installed on your computer and then follow the instructions to download the required packages from npm.</p>
<h1 id="_idParaDest-287"><a id="_idTextAnchor291"/>Including the Sass partials for the used components only</h1>
<p>In this section, we<a id="_idIndexMarker885"/> will see how we can optimize our compiled CSS by only including the Bootstrap 5 Sass partials that are actually used by the components in our HTML code. On the website that we created earlier in this book, we have used all of the Bootstrap 5 components except for the Placeholder, Popover, and Scrollspy components. Scrollspy is a JavaScript-only component, so we will remove the Sass partials belonging to the Placeholder and Popover components. In our <code>styles.scss</code> file, we have a long list of <code>// Optional Bootstrap CSS</code>, which among other things contains the Sass partials for all components. So, this is where we want to carefully consider which partial files we can remove. In the following code snippet, you will see the long list of <code>// Optional Bootstrap CSS</code> where the lines that import the Sass partials for the Placeholder and Popover components have been commented out. You could also choose to delete those lines, but by keeping them commented out it’s easy to uncomment them if you add any of these components to the website at a later stage, and they will anyway be removed automatically when the Sass is compiled:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">part-3/chapter-12/website/scss/style.scss</p>
<pre class="source-code">// Optional Bootstrap CSS</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/reboot";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/type";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/images";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/containers";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/grid";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/tables";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/forms";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/buttons";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/transitions";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/dropdown";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/button-group";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/nav";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/navbar";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/card";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/accordion";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/breadcrumb";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/pagination";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/badge";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/alert";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/progress";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/list-group";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/close";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/toasts";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/modal";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/tooltip";</pre>
<pre class="source-code"><strong class="bold">// @import "</strong>../../../../<strong class="bold">bootstrap/scss/popover";</strong></pre>
<pre class="source-code">@import "../../../../bootstrap/scss/carousel";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/spinners";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/offcanvas";</pre>
<pre class="source-code"><strong class="bold">// @import "</strong>../../../../<strong class="bold">bootstrap/scss/placeholders";</strong></pre>
<p>When we compile <a id="_idIndexMarker886"/>our Sass code, the compiled CSS stylesheet will now be slightly smaller since the CSS for the Popover and Placeholder components have been removed.</p>
<p class="callout-heading">Dependencies across Sass partials</p>
<p class="callout">There are some dependencies across the various Sass partial files, so it might not be easy to simply remove a file for a specific component. Make sure that you test your website carefully.</p>
<h1 id="_idParaDest-288"><a id="_idTextAnchor292"/>Removing unused helpers and utilities</h1>
<p>The helpers and utilities of Bootstrap 5 are something that we use in addition to components, sometimes on specific code inside of a component, and sometimes as part of our own HTML code. Therefore, it can also be considered which of these we actually use, and make sure to not include the ones that we don’t use.</p>
<h2 id="_idParaDest-289"><a id="_idTextAnchor293"/>Removing unused helpers</h2>
<p>In our <a id="_idIndexMarker887"/>code for the website, we have used the following helpers: Ratio, Position, Visually hidden, and Stretched link. The Bootstrap 5 code for these helpers is imported in our <code>style.scss</code> file using the following code:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">part-3/chapter-12/website/scss/style.scss</p>
<pre class="source-code">// Helpers</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/helpers";</pre>
<p>This will import the <code>_helpers.scss</code> file containing <code>@import</code> statements for the individual helpers. The content of that file is as follows:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">part-3/chapter-12/website/bootstrap/scss/_helpers.scss</p>
<pre class="source-code">@import "helpers/clearfix";</pre>
<pre class="source-code">@import "helpers/colored-links";</pre>
<pre class="source-code">@import "helpers/ratio";</pre>
<pre class="source-code">@import "helpers/position";</pre>
<pre class="source-code">@import "helpers/stacks";</pre>
<pre class="source-code">@import "helpers/visually-hidden";</pre>
<pre class="source-code">@import "helpers/stretched-link";</pre>
<pre class="source-code">@import "helpers/text-truncation";</pre>
<pre class="source-code">@import "helpers/vr";</pre>
<p>We might <a id="_idIndexMarker888"/>now think that we simply need to uncomment the <code>@import</code> statements for the helpers that we don’t use, just as we did with the components in the previous section. This will work here and now, but if we choose to update Bootstrap 5 at a later point, our changes will be gone, since the <code>_helpers.scss</code> file will be replaced. This is because this file is part of the Bootstrap 5 source code that is replaced when you update Bootstrap 5. If you know you won’t update Bootstrap 5 at a later point or know that you will remember to make the same edits to the <code>_helpers.scss</code> file again after updating, you can do it like this:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">part-3/chapter-12/website/bootstrap/scss/_helpers.scss</p>
<pre class="source-code"><strong class="bold">// @import "helpers/clearfix";</strong></pre>
<pre class="source-code"><strong class="bold">// @import "helpers/colored-links";</strong></pre>
<pre class="source-code">@import "helpers/ratio";</pre>
<pre class="source-code">@import "helpers/position";</pre>
<pre class="source-code"><strong class="bold">// @import "helpers/stacks";</strong></pre>
<pre class="source-code">@import "helpers/visually-hidden";</pre>
<pre class="source-code">@import "helpers/stretched-link";</pre>
<pre class="source-code"><strong class="bold">// @import "helpers/text-truncation";</strong></pre>
<pre class="source-code"><strong class="bold">// @import "helpers/vr";</strong></pre>
<p>But to <a id="_idIndexMarker889"/>do it in a better and more maintainable way, we can change our <code>@import</code> statement in the <code>styles.scss</code> file and import only the individual helper partial files that we need instead of importing the <code>_helpers.scss</code> file. So, we will ignore that file (even though it’s part of the Bootstrap 5 source code) and instead implement our own way of importing the helpers.</p>
<p>The code will then look like this:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">part-3/chapter-12/website/scss/style.scss</p>
<pre class="source-code">// Helpers</pre>
<pre class="source-code">// @import "../../../../bootstrap/scss/helpers/clearfix";</pre>
<pre class="source-code">// @import "../../../../bootstrap/scss/helpers/colored-links";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/helpers/ratio";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/helpers/position";</pre>
<pre class="source-code">// @import "../../../../bootstrap/scss/helpers/stacks";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/helpers/visually-hidden";</pre>
<pre class="source-code">@import "../../../../bootstrap/scss/helpers/stretched-link";</pre>
<pre class="source-code">// @import "../../../../bootstrap/scss/helpers/text-truncation";</pre>
<pre class="source-code">// @import "../../../../bootstrap/scss/helpers/vr";</pre>
<p>I have <a id="_idIndexMarker890"/>chosen to keep the unused imports in our file but have them commented out. Then, it’s easier to uncomment them in the future if the need arises, and it will anyway be removed when compiling the Sass and hence not take up any space. Just like the way we did with the imports of the component partial files.</p>
<h2 id="_idParaDest-290"><a id="_idTextAnchor294"/>Removing unused utilities</h2>
<p>To <a id="_idIndexMarker891"/>remove unused utilities, we will need to take a different approach than what we have seen with components and helpers. We now need to use the utility API, which we learned about in <a href="B17143_06_epub.xhtml#_idTextAnchor130"><em class="italic">Chapter 6</em></a>, <em class="italic">Understanding and Using the Bootstrap 5 Utility API</em>. In the <code>_utilities.scss</code> file of Bootstrap 5, we see a total of 80 defined utility classes that have different settings and values. For each of them, we can see what the class or class prefix will be, and we can use that to search through our code to see which ones we actually use. If we do this, we will see that we roughly use half of them. To be precise, we need to remove the following 37 utility classes that are not being used:</p>
<pre>align, opacity, overflow, shadow, start, translate-middle, max-width, viewport-width, min-viewport-width, max-height, viewport-height, min-viewport-height, flex, flex-grow, flex-shrink, flex-wrap, gap, align-content, align-self, order, margin, margin-start, padding-x, padding-end, padding-start, font-family, word-wrap, text-opacity, bg-opacity, gradient, user-select, pointer-events, rounded-top, rounded-end, rounded-bottom, rounded-start, visibility</pre>
<p>The negative margin utilities (<code>negative-margin</code>, <code>negative-margin-x</code>, <code>negative-margin-y</code>, <code>negative-margin-top</code>, <code>negative-margin-end</code>, <code>negative-margin-bottom</code>, and <code>negative-margin-start</code>) are not included in the list, since they are disabled by default, and we haven’t enabled them through the <code>$enable-negative-margins</code> option in our own Sass code.</p>
<p>To remove all of the unused utilities so that they are not generated through the utility API, we use the following code:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">part-3/chapter-12/website/scss/_utilities.scss</p>
<pre class="source-code">// Remove unused utilities</pre>
<pre class="source-code">$utilities: map-merge(</pre>
<pre class="source-code">  $utilities,</pre>
<pre class="source-code">  (</pre>
<pre class="source-code">    "align": null,</pre>
<pre class="source-code">    "opacity": null,</pre>
<pre class="source-code">    "overflow": null,</pre>
<pre class="source-code">    "shadow": null,</pre>
<pre class="source-code">    "start": null,</pre>
<pre class="source-code">    "translate-middle": null,</pre>
<pre class="source-code">    "max-width": null,</pre>
<pre class="source-code">    "viewport-width": null,</pre>
<pre class="source-code">    "min-viewport-width": null,</pre>
<pre class="source-code">    "max-height": null,</pre>
<pre class="source-code">    "viewport-height": null,</pre>
<pre class="source-code">    "min-viewport-height": null,</pre>
<pre class="source-code">    "flex": null,</pre>
<pre class="source-code">    "flex-grow": null,</pre>
<pre class="source-code">    "flex-shrink": null,</pre>
<pre class="source-code">    "flex-wrap": null,</pre>
<pre class="source-code">    "gap": null,</pre>
<pre class="source-code">    "align-content": null,</pre>
<pre class="source-code">    "align-self": null,</pre>
<pre class="source-code">    "order": null,</pre>
<pre class="source-code">    "margin": null,</pre>
<pre class="source-code">    "margin-start": null,</pre>
<pre class="source-code">    "padding-x": null,</pre>
<pre class="source-code">    "padding-end": null,</pre>
<pre class="source-code">    "padding-start": null,</pre>
<pre class="source-code">    "font-family": null,</pre>
<pre class="source-code">    "word-wrap": null, </pre>
<pre class="source-code">    "text-opacity": null,</pre>
<pre class="source-code">    "bg-opacity": null,</pre>
<pre class="source-code">    "gradient": null,</pre>
<pre class="source-code">    "user-select": null,</pre>
<pre class="source-code">    "pointer-events": null,</pre>
<pre class="source-code">    "rounded-top": null,</pre>
<pre class="source-code">    "rounded-end": null,</pre>
<pre class="source-code">    "rounded-bottom": null,</pre>
<pre class="source-code">    "rounded-start": null,</pre>
<pre class="source-code">    "visibility": null,</pre>
<pre class="source-code">  )</pre>
<pre class="source-code">);</pre>
<p>After <a id="_idIndexMarker892"/>compiling the Sass code, the resulting CSS file (in the expanded Sass output format) will now be 1,513 lines smaller, which is equal to 25,485 bytes saved.</p>
<h3>Specifying used utilities</h3>
<p>Another <a id="_idIndexMarker893"/>way to optimize the usage of utilities is to specify the utilities that are <em class="italic">being used</em> instead. There are a total of 39 utilities being used in our project, and we can generate just these by using the <code>map-get-multiple()</code> Sass function provided by Bootstrap 5 in the <code>_functions.scss</code> file. With this function, we can get multiple keys from a Sass map and thus overwrite the <code>$utilities</code> variable as follows:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">SCSS</p>
<pre class="source-code">$utilities: map-get-multiple(</pre>
<pre class="source-code">  $utilities,</pre>
<pre class="source-code">  (</pre>
<pre class="source-code">    "float",</pre>
<pre class="source-code">    "display",</pre>
<pre class="source-code">    "position",</pre>
<pre class="source-code">    "top",</pre>
<pre class="source-code">    "bottom",</pre>
<pre class="source-code">    "end",</pre>
<pre class="source-code">    "border",</pre>
<pre class="source-code">    "border-top",</pre>
<pre class="source-code">    "border-end",</pre>
<pre class="source-code">    "border-bottom",</pre>
<pre class="source-code">    "border-start",</pre>
<pre class="source-code">    "border-color",</pre>
<pre class="source-code">    "border-width",</pre>
<pre class="source-code">    "width",</pre>
<pre class="source-code">    "height",</pre>
<pre class="source-code">    "flex-direction",</pre>
<pre class="source-code">    "justify-content",</pre>
<pre class="source-code">    "align-items",</pre>
<pre class="source-code">    "margin-x",</pre>
<pre class="source-code">    "margin-y",</pre>
<pre class="source-code">    "margin-top",</pre>
<pre class="source-code">    "margin-end",</pre>
<pre class="source-code">    "margin-bottom",</pre>
<pre class="source-code">    "padding",</pre>
<pre class="source-code">    "padding-y",</pre>
<pre class="source-code">    "padding-top",</pre>
<pre class="source-code">    "padding-bottom",</pre>
<pre class="source-code">    "font-size",</pre>
<pre class="source-code">    "font-style",</pre>
<pre class="source-code">    "font-weight",</pre>
<pre class="source-code">    "line-height",</pre>
<pre class="source-code">    "text-align",</pre>
<pre class="source-code">    "text-decoration",</pre>
<pre class="source-code">    "text-transform",</pre>
<pre class="source-code">    "white-space",</pre>
<pre class="source-code">    "color",</pre>
<pre class="source-code">    "background-color",</pre>
<pre class="source-code">    "rounded",</pre>
<pre class="source-code">    "utility",</pre>
<pre class="source-code">  )</pre>
<pre class="source-code">);</pre>
<p>No matter<a id="_idIndexMarker894"/> whether you choose to specify which utilities to remove or which are being used, the result will be the same.</p>
<h2 id="_idParaDest-291"><a id="_idTextAnchor295"/>Trimming used utilities</h2>
<p>If <a id="_idIndexMarker895"/>you want to go that extra mile, it’s also possible to trim any used utilities. By that, I mean that we remove any variations of a utility that we are not using by editing the values of that utility.</p>
<p>Say that we want to edit the <code>text-align</code> utility since we are only using the <code>.text-center</code> class in our project. So, we want to remove the <code>.text-start</code> and <code>.text-end</code> variations as well as disable the responsive variations of this utility. To accomplish this, we can use the following code:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">SCSS</p>
<pre class="source-code">$utilities: map-merge(</pre>
<pre class="source-code">  $utilities,</pre>
<pre class="source-code">  (</pre>
<pre class="source-code">    "text-align": map-merge(</pre>
<pre class="source-code">      map-get($utilities, "text-align"),</pre>
<pre class="source-code">      ( values: (</pre>
<pre class="source-code">          center: center,</pre>
<pre class="source-code">        ),</pre>
<pre class="source-code">        responsive: false</pre>
<pre class="source-code">      ),</pre>
<pre class="source-code">    ),</pre>
<pre class="source-code">  )</pre>
<pre class="source-code">);</pre>
<p>Now, we<a id="_idIndexMarker896"/> will only generate the <code>.text-center</code> class, which is the only one we use for text alignment.</p>
<p>Alternatively, this can also be done by using the following code, where we overwrite the code for the text alignment utility and, therefore, must also specify <code>property</code> and <code>class</code>:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">SCSS</p>
<pre class="source-code">$utilities: map-merge(</pre>
<pre class="source-code">  $utilities,</pre>
<pre class="source-code">  (</pre>
<pre class="source-code">    "text-align": (</pre>
<pre class="source-code">      property: text-align,</pre>
<pre class="source-code">      responsive: false,</pre>
<pre class="source-code">      class: text,</pre>
<pre class="source-code">      values: (</pre>
<pre class="source-code">        center: center,</pre>
<pre class="source-code">      )</pre>
<pre class="source-code">    )</pre>
<pre class="source-code">  )</pre>
<pre class="source-code">);</pre>
<p>This was<a id="_idIndexMarker897"/> just an example. I have not used this method of trimming used utilities for the project, since it’s a rather big task. But if you go that extra mile, it will be possible to save some lines and bytes of code.</p>
<p>In the next section, we will set up a build tool using Node.js, npm, and Laravel Mix. We will do that to be able to optimize our usage of JavaScript and automate tasks for Sass compiling and general minifying.</p>
<h1 id="_idParaDest-292"><a id="_idTextAnchor296"/>Setting up a build process using Node.js, npm, and Laravel Mix</h1>
<p>In <a href="B17143_02_epub.xhtml#_idTextAnchor033"><em class="italic">Chapter 2</em></a><em class="italic">,</em> <em class="italic">Using and Compiling Sass</em>, we already learned how to use Node.js and npm to set up a <a id="_idIndexMarker898"/>script that would compile our Sass to CSS. In this<a id="_idIndexMarker899"/> setup, we will use Laravel Mix, which is a wrapper around <a id="_idIndexMarker900"/>Webpack. In short, Webpack is a module <a id="_idIndexMarker901"/>bundler that prepares JavaScript and assets for the browser. By using Laravel Mix, we get a simple API for setting the Webpack configuration without any prior experience with Webpack.</p>
<p>If you haven’t already installed Node.js, then please go back and take a look at <a href="B17143_02_epub.xhtml#_idTextAnchor033"><em class="italic">Chapter 2</em></a> and the <em class="italic">Compiling Sass</em> section. Now, here’s a step-by-step guide on how to set up Laravel Mix using Node.js and npm. This will, in the end, generate a <code>package.json</code> file, a Laravel Mix configuration file, as well as a folder, and some empty files.</p>
<p class="callout-heading">Skip setting up Laravel Mix</p>
<p class="callout">If you want, you can choose to skip the manual setup of Laravel Mix and simply use the Laravel Mix template provided with this book in the code related to this chapter. Then, simply go to the next section.</p>
<p>Before we <a id="_idIndexMarker902"/>start setting up Laravel Mix, we must open the Terminal (Mac) or<a id="_idIndexMarker903"/> Command Prompt (Windows) and navigate to our<a id="_idIndexMarker904"/> project folder. Then, we can follow these eight steps:</p>
<ol>
<li>Generate an empty npm project with the default settings:<pre><strong class="bold">npm init -y</strong></pre></li>
<li>Install the latest version of Bootstrap 5:<pre><strong class="bold">npm install bootstrap@5.2.0 --save-dev</strong></pre></li>
</ol>
<p><code>--save-dev</code> is used to specify that it is a development dependency. Change the version number if you want another version.</p>
<ol>
<li value="3">Install Popper, which is a dependency for the Dropdown, Popover, and Tooltip components:<pre><strong class="bold">npm install @popperjs/core --save-dev</strong></pre></li>
<li>Install Laravel Mix:<pre><strong class="bold">npm install laravel-mix --save-dev</strong></pre></li>
<li>Create the <code>webpack.mix.js</code> file in the root folder of the project. This is a configuration file for Laravel Mix.</li>
<li>In the root folder of the project, create the <code>src</code> folder with the empty <code>js</code> and <code>scss</code> folders inside. Create the <code>script.js</code> file in the <code>js</code> folder and the <code>style.scss</code> file in the <code>scss</code> folder. The file and folder structure should look like this:<pre>src
|- js
   |- script.js
|- scss
   |- style.scss</pre></li>
</ol>
<p>We will put some code in those files in just a moment.</p>
<ol>
<li value="7">Add the <a id="_idIndexMarker905"/>following code to the configuration file (<code>webpack.mix.js</code>) to<a id="_idIndexMarker906"/> import <code>mix</code> and define our<a id="_idIndexMarker907"/> build:<pre>let mix = require('laravel-mix');
mix.js('src/js/script.js', 'js/').sass(
  'src/scss/style.scss', 'css/');</pre></li>
</ol>
<p>Laravel Mix has now been instructed to do the following:</p>
<ol>
<li>Bundle the JavaScript in <code>src/js/script.js</code> and output it to the <code>js</code> folder.</li>
<li>Compile the Sass in <code>src/scss/style.scss</code> and output it to the <code>css</code> folder.</li>
</ol>
<ol>
<li value="8">Run the following command to install additional dependencies:<pre><strong class="bold">npx mix</strong></pre></li>
</ol>
<p>This command should only be necessary to run once.</p>
<h2 id="_idParaDest-293"><a id="_idTextAnchor297"/>Using the Laravel Mix template</h2>
<p>If you haven’t <a id="_idIndexMarker908"/>followed the manual steps to set up Laravel Mix, you can also grab the Laravel Mix template from the <code>part-3/chapter-12/laravel-mix/template</code> folder. In this case, you should simply place the content of that template folder inside your project folder and run the following command:</p>
<pre>npm install</pre>
<p>This will install <a id="_idIndexMarker909"/>Bootstrap 5, Popper, and Laravel Mix, as well as all dependencies. You don’t have to run the <code>npx mix</code> command to install additional dependencies.</p>
<h2 id="_idParaDest-294"><a id="_idTextAnchor298"/>Using Laravel Mix</h2>
<p>The code in our<a id="_idIndexMarker910"/> project should now look like this:</p>
<pre class="source-code">src</pre>
<pre class="source-code">|- js</pre>
<pre class="source-code">   |- script.js</pre>
<pre class="source-code">|- scss</pre>
<pre class="source-code">   |- style.scss</pre>
<pre class="source-code">package-lock.json</pre>
<pre class="source-code">package.json</pre>
<pre class="source-code">webpack.mix.js</pre>
<p>Be aware that we haven’t put any code inside the <code>script.js</code> and <code>style.scss</code> files just yet, and neither have we added any HTML files or other assets to the project. We will do that in just a moment. First, let’s take a look at two of the most useful commands.</p>
<p>To trigger the Webpack build, which we defined in the <code>webpack.mix.js</code> file, we simply run the following command:</p>
<pre>npx mix</pre>
<p>This will now compile the files and build the bundle.</p>
<p>To watch the filesystem for changes and automatically recompile the files and rebuild the bundle, we can use the following command:</p>
<pre>npx mix watch</pre>
<p>Webpack will<a id="_idIndexMarker911"/> now run every time we save changes to a JavaScript or Sass file in our project folder.</p>
<p class="callout-heading">No code was added to <code>script.js</code> and <code>style.scss</code> yet</p>
<p class="callout">The Laravel Mix commands currently don’t produce any results, since we haven’t added any code to our <code>script.js</code> and <code>style.scss</code> files in the <code>src</code> folder. We will do that now.</p>
<h2 id="_idParaDest-295"><a id="_idTextAnchor299"/>Adding the website code to the build process</h2>
<p>We have to<a id="_idIndexMarker912"/> make some changes to our project, since it's not compatible with the way we want to use Laravel Mix. Because of this, we won’t make changes to the existing project in <code>part-3/chapter-12/website</code>, but instead, make a copy to <code>part-3/chapter-12/laravel-mix/setup</code> and make our changes there. . Please note that all the changes described in this section has already been applied to the code on GitHub.</p>
<p>Here are the steps we need to make in order to restructure and update our project:</p>
<ol>
<li value="1"><code>src</code><strong class="bold"> folder</strong>:</li>
</ol>
<p>First, we have to move our <code>js</code> and <code>scss</code> folder into the new <code>src</code> folder and delete the <code>bootstrap.bundle.min.js</code> file. The Bootstrap 5 JavaScript code will be compiled and bundled by Laravel Mix and then placed in another folder.</p>
<ol>
<li value="2"><strong class="bold">Update HTML</strong>:</li>
</ol>
<p>Since we have now deleted the <code>bootstrap.bundle.min.js</code> file in the previous step, we can now delete the following line of code from all HTML files:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">HTML</p>
<pre>&lt;script src="img/bootstrap.bundle.min.js"&gt;&lt;/script&gt;</pre>
<p>Then, in the files that previously had only the <code>bootstrap.bundle.min.js</code> file and not the <code>script.js</code> file, we must add this file, so that all HTML pages, in the end, have only the following <code>script</code> tag:</p>
<pre>&lt;script src="img/script.js"&gt;&lt;/script&gt;</pre>
<p>So, the <a id="_idIndexMarker913"/>bottom part of each HTML file should look like this with few exceptions:</p>
<pre>      &lt;/footer&gt;
    &lt;script src="img/script.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>
<ol>
<li value="3"><strong class="bold">Update Sass</strong>:</li>
</ol>
<p>Now, we need to update the file path of the imports of the Bootstrap 5 Sass partials in the <code>style.scss</code> file. We need to replace <code>../bootstrap/scss/</code> with <code>~bootstrap/scss/</code> (or simply <code>../</code> with <code>~</code>) to make sure we get the source code directly from the <code>node_modules</code> folder. The tilde character, <code>~</code>, is a reference to that folder.</p>
<p>Our top part of the <code>style.scss</code> file should now look like this:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">part-3/chapter-12/laravel-mix/website/src/scss/style.scss</p>
<pre>// Required
@import "~bootstrap/scss/functions";
// Default variable overrides
@import "default-variable-overrides";
// Required
@import "~bootstrap/scss/variables";
// Variable value using existing variable
@import "variable-value-using-variable";
// Required
@import "~bootstrap/scss/maps";
@import "~bootstrap/scss/mixins";
@import "~bootstrap/scss/root";</pre>
<p>We will keep the rest of our Sass files untouche4.</p>
<ol>
<li value="1"><strong class="bold">Update JavaScript</strong>:</li>
</ol>
<p>When we <a id="_idIndexMarker914"/>load Bootstrap 5 via a <code>&lt;script&gt;</code> tag, we use the <code>bootstrap</code> namespace when initializing JavaScript components as follows:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">JavaScript</p>
<pre>new bootstrap.[component]([element])</pre>
<p>To import the Bootstrap 5 JavaScript source code to make it work with our own current JavaScript code, we must do it in the following way at the top of our <code>script.js</code> file:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">part-3/chapter-12/laravel-mix/setup/src/js/script.js</p>
<pre>import * as bootstrap from 'bootstrap';</pre>
<p>This will import all Bootstrap 5 JavaScript source files, which is similar to what we had before when we used the <code>bootstrap.bundle.min.js</code> file in a <code>&lt;script&gt;</code> tag.</p>
<p>Now, to actually trigger the Webpack build, compile the Sass, and bundle the JavaScript, we can use the Laravel Mix commands from before to run it once:</p>
<pre><strong class="bold">npx mix</strong></pre>
<p>Or we can <a id="_idIndexMarker915"/>use the following command to run it every time we save changes to a JavaScript or Sass file in our project folder:</p>
<pre><strong class="bold">npx mix watch</strong></pre>
<p>We have now learned how to set up a build process using Node.js, npm, and Laravel Mix. However, we are importing all of the JavaScript code even though we don’t use it all. Next up, we will see how we can optimize the JavaScript import.</p>
<h1 id="_idParaDest-296"><a id="_idTextAnchor300"/>Using a module bundler to optimize JavaScript</h1>
<p>We can<a id="_idIndexMarker916"/> optimize our usage of JavaScript files<a id="_idIndexMarker917"/> when using a module bundler. Instead of importing all the Bootstrap 5 JavaScript source files like we just did before, we can import only the ones we need.</p>
<p>In the source code of Bootstrap 5, we have the <code>bootstrap/js/dist</code> folder, which contains the source code for the individual JavaScript components, as well as the <code>base-component.js</code> file and the <code>dom</code> folder, with some more general code related to working with the DOM (the Document Object Model of the page).</p>
<p>We might imagine that we can just add one of these files in a <code>&lt;script&gt;</code> tag in our HTML as follows:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">HTML</p>
<pre class="source-code">&lt;script src="img/modal.js"&gt;&lt;/script&gt;</pre>
<p>However, this won’t work. We’ll get an error in the browser console. We have to reference these files in our <code>script.js</code> file and use a module bundler.</p>
<p>As an example, if we only import the <code>bootstrap/js/dist/modal.js</code> file, it will also import the <code>bootstrap/js/dist/base-component.js</code> file and all the DOM-related files in the <code>bootstrap/js/dist/dom</code> folder.</p>
<p>If we instead only import the <code>bootstrap/js/dist/tooltip.js</code> file, it will also import the <code>bootstrap/js/dist/base-component.js</code> file, all the DOM-related files in the <code>bootstrap/js/dist/dom</code> folder, and all the necessary files from the Popper npm package, since the tooltip component relies on this library for positioning.</p>
<p>Before we proceed, please note that we won’t make more changes to the code in <code>part-3/chapter-12/laravel-mix/setup</code>, but instead, make a copy of that code to <code>part-3/chapter-12/laravel-mix/optimize-js</code> and make our changes there. Please note that all the changes described in this section has already been applied to the code on GitHub.</p>
<p>On our website, we use all of the JavaScript components, except for Button, Popover, and Scrollspy (however, we still use Button as a regular component using HTML and CSS). Now, to <a id="_idIndexMarker918"/>optimize the usage of JavaScript files, we <a id="_idIndexMarker919"/>will add the following lines of code to our <code>script.js</code> file to only include the components we actually use:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">part-3/chapter-12/laravel-mix/optimize-js/src/js/script.js</p>
<pre class="source-code">import Alert from 'bootstrap/js/dist/alert';</pre>
<pre class="source-code">import Carousel from 'bootstrap/js/dist/carousel';</pre>
<pre class="source-code">import Collapse from 'bootstrap/js/dist/collapse';</pre>
<pre class="source-code">import Dropdown from 'bootstrap/js/dist/dropdown';</pre>
<pre class="source-code">import Modal from 'bootstrap/js/dist/modal';</pre>
<pre class="source-code">import Offcanvas from 'bootstrap/js/dist/offcanvas';</pre>
<pre class="source-code">import Tab from 'bootstrap/js/dist/tab';</pre>
<pre class="source-code">import Toast from 'bootstrap/js/dist/toast';</pre>
<pre class="source-code">import Tooltip from 'bootstrap/js/dist/tooltip';</pre>
<p>As mentioned in<a id="_idIndexMarker920"/> the previous section, when we <a id="_idIndexMarker921"/>load Bootstrap 5 via a <code>&lt;script&gt;</code> tag, we use the <code>bootstrap</code> namespace when initializing JavaScript components, as follows:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">JavaScript</p>
<pre class="source-code">new bootstrap.[component]([element])</pre>
<p>Since we’re now using a bundler, the window object will not be defined, so we must initialize components in the following way:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">JavaScript</p>
<pre class="source-code">new [component]([element])</pre>
<p>Because of this, we need to make some changes to our <code>script.js</code> file. We need to replace the <code>new bootstrap.[component]</code> code with <code>new [component]</code> everywhere we’re <a id="_idIndexMarker922"/>using it. As an example, in the code<a id="_idIndexMarker923"/> where we initialize all tooltips, we must make the following change:</p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US">part-3/chapter-12/laravel-mix/optimize-js/src/js/script.js</p>
<pre class="source-code">const tooltipTriggerElements = </pre>
<pre class="source-code">  document.querySelectorAll('[data-bs-toggle="tooltip"]');</pre>
<pre class="source-code">for (let i = 0; i &lt; tooltipTriggerElements.length; i++) {</pre>
<pre class="source-code">  new <strong class="bold">bootstrap.</strong>Tooltip(tooltipTriggerElements[i])</pre>
<pre class="source-code">}</pre>
<p>Now, we can run the same Laravel Mix commands as mentioned before again.</p>
<p>Please note, that we must also run the command: </p>
<pre>npm install</pre>
<p>if it hasn't been run already. This command will create the <code>node_modules</code> folder and download all necessary dependencies (including the source code for Bootstrap 5) to that.</p>
<h1 id="_idParaDest-297"><a id="_idTextAnchor301"/>Minifying our compiled CSS and bundled JavaScript</h1>
<p>To <a id="_idIndexMarker924"/>optimize our code even further, we want to minify the compiled CSS and bundled JavaScript. We<a id="_idIndexMarker925"/> can do this with Laravel Mix simply by running the following command:</p>
<pre>npx mix --production</pre>
<p>The <code>--production</code> flag is used to indicate that we want to minify the compiled and bundled files.</p>
<h1 id="_idParaDest-298"><a id="_idTextAnchor302"/>Summary</h1>
<p>We have now learned how we can optimize the compiled Bootstrap 5 CSS and JavaScript code. First, we learned how to optimize our stylesheet by only including the Bootstrap 5 Sass partials we actually used and removing all the helpers and utilities that we didn’t use. Then, we learned how to use Node.js, npm, and Laravel Mix to set up a build process to automate some tasks, which helped us bundle only the JavaScript that our components actually used and minify both our compiled CSS and bundled JavaScript.</p>
<p>Even though the methods and techniques described in this chapter don’t alter the look and feel of the website, they will optimize your final code and thus provide better performance and a faster load time for the user.</p>
<p>Throughout this book, we have learned how to work with Bootstrap 5 in various new ways. From only knowing about the HTML structure and class names for the various Bootstrap 5 components with the default style, we have learned how to change the global options and the color palette, how to understand and navigate the Sass source code, how to customize various Bootstrap 5 elements with the use of Sass variables, and how to use the powerful utility API. On top of that, we have learned how to use Bootstrap 5 with more advanced Sass, CSS, and JavaScript features, and finally, how to optimize the compiled CSS and JavaScript (including using a module bundler). We are now well equipped as Bootstrap 5 developers to solve more advanced tasks and be more creative with the usage of the Bootstrap 5 source code.</p>
<p>Thanks for reading!</p>
</div>
</div>
</body></html>