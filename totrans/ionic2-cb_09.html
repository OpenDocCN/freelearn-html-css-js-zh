<html><head></head><body><div class="chapter" title="Chapter&#xA0;9.&#xA0;Publishing the App for Different Platforms" id="aid-1JFUC1"><div class="titlepage"><div><div><h1 class="title"><a id="ch09"/>Chapter 9. Publishing the App for Different Platforms</h1></div></div></div><p>In this chapter, we will cover the following tasks related to publishing and future-proofing an app:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Adding versioning to future proof the app</li><li class="listitem">Building and publishing an app for iOS</li><li class="listitem">Building and publishing an app for Android</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec48"/>Introduction</h1></div></div></div><p>In the past, it was very cumbersome to build and successfully publish an app. However, there is much documentation and many unofficial instructions on the internet today that can pretty much address any problem that you may run into. In addition, Ionic also comes with its own CLI to assist in this process. This chapter will guide you through the app building and publishing steps at a high level. You will learn how to do the following things:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Add versioning to future proof the app</li><li class="listitem">Publish your app to App Store or Google Play</li></ul></div><p>The purpose of this chapter is to provide ideas on what to look for and some <span class="emphasis"><em>gotchas</em></span>. Apple and Google are constantly updating their platforms and processes; so, the steps may not look exactly the same over time.</p></div></div>
<div class="section" title="Adding versioning to future proof the app"><div class="titlepage" id="aid-1KEEU2"><div><div><h1 class="title"><a id="ch09lvl1sec49"/>Adding versioning to future proof the app</h1></div></div></div><p>It's typical that you <a id="id691" class="indexterm"/>don't think about keeping track of the app version for a<a id="id692" class="indexterm"/> particular user. However, as the app grows in the number of users as well as releases, you will soon face the problem of update issues and incompatibilities. For example, a user may run an old version of your app but all your backend APIs are now expecting new parameters from a newer app version. Therefore, you may want to think about a strategy to detect the app version locally in order to notify the users for an update<a id="id693" class="indexterm"/> requirement. This is also helpful if your backend processes differently for a specific app version.</p><p>The app you are going to build is<a id="id694" class="indexterm"/> very simple. It will detect the current version and store the information in a service. This is the screenshot of the app:</p><div class="mediaobject"><img src="../Images/image00394.jpeg" alt="Adding versioning to future proof the app"/></div><p style="clear:both; height: 1em;"> </p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec120"/>Getting ready</h2></div></div></div><p>This app example must run on a physical device or a simulator.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec121"/>How to do it...</h2></div></div></div><p>Observe the following instructions:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new <code class="literal">MyAppVersion</code> app using the <code class="literal">blank</code> template, as follows, and go to the <code class="literal">MyAppVersion</code> folder:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic start MyAppVersion blank --v2</strong></span>
<span class="strong"><strong>$ cd MyAppVersion </strong></span>
</pre></div></li><li class="listitem">Install the <code class="literal">app-version</code> plugin:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic plugin add cordova-plugin-app-version</strong></span>
</pre></div></li><li class="listitem">Edit <code class="literal">./config.xml </code>by changing the version number, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>&lt;widget id="com.ionicframework.myappversion637242" version="0.0.123"  &gt;</strong></span>
</pre></div></li></ol><div style="height:10px; width: 1px"/></div><p>Note that your <code class="literal">widget id</code> might be different from the one mentioned here. You only need to change the version number. In this case, it is the <code class="literal">0.0.123</code> version.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create the <code class="literal">services</code> folder inside the app folder, as shown:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mkdir ./src/services</strong></span>
</pre></div></li><li class="listitem">Create <code class="literal">myenv.ts</code> in the <code class="literal">services</code> folder <a id="id695" class="indexterm"/>with the<a id="id696" class="indexterm"/> following code:<div class="informalexample"><pre class="programlisting">import {Injectable} from '@angular/core';
import {AppVersion} from 'ionic-native';

@Injectable()
export class MyEnv {
  public appVersion: any;
  
  constructor() {
    this.appVersion = AppVersion;
  }

  getAppVersion() {
    return this.appVersion.getVersionCode();
  }
}</pre></div><p>This is your only service for this app. In the real-world project, you will need multiple services because some of them will have to communicate directly with your backend.</p></li><li class="listitem">Open and edit your .<code class="literal">/src/app/app.module.ts</code>,<code class="literal"> </code>as follows:<div class="informalexample"><pre class="programlisting">import { NgModule } from '@angular/core';
import { IonicApp, IonicModule } from 'ionic-angular';
import { MyApp } from './app.component';
import { HomePage } from '../pages/home/home';
import { MyEnv } from '../services/myenv';

@NgModule({
  declarations: [
    MyApp,
    HomePage
  ],
  imports: [
    IonicModule.forRoot(MyApp)
  ],
  bootstrap: [IonicApp],
  entryComponents: [
    MyApp,
    HomePage
  ],
  providers: [MyEnv]
})
export class AppModule {}</pre></div><p>The main modification in this file is to inject the <code class="literal">MyEnv</code> provider for the entire app.</p></li><li class="listitem">Open and<a id="id697" class="indexterm"/> replace .<code class="literal">/src/pages/home/home.html </code>with this code:<div class="informalexample"><pre class="programlisting">&lt;ion-header&gt;
  &lt;ion-navbar&gt;
    &lt;ion-title&gt;
      MyAppVersion
    &lt;/ion-title&gt;
  &lt;/ion-navbar&gt;
&lt;/ion-header&gt;

&lt;ion-content padding class="center home"&gt;
  &lt;button ion-button (click)="getVersion()" &gt;Get App Version&lt;/button&gt;
  &lt;p class="large" *ngIf="ver"&gt;
    MyAppVersion {{ ver }}
  &lt;/p&gt;
&lt;/ion-content&gt;</pre></div></li><li class="listitem">Open and <a id="id698" class="indexterm"/>replace <code class="literal">./src/pages/home/home.ts</code> with the following code:<div class="informalexample"><pre class="programlisting">import { Component } from '@angular/core';
import { NavController } from 'ionic-angular';
import { MyEnv } from '../../services/myenv';

@Component({
  selector: 'page-home',
  templateUrl: 'home.html'
})
export class HomePage {
  public ver: string;

  constructor(private navCtrl: NavController, public myEnv: MyEnv) {
    this.myEnv = myEnv;
  }

  getVersion() {
    console.log(this.myEnv.getAppVersion());
    this.myEnv.getAppVersion().then((data) =&gt; this.ver = data);
  }
}</pre></div></li><li class="listitem">Open and <a id="id699" class="indexterm"/>edit <code class="literal">home.scss</code> in the same folder:<div class="informalexample"><pre class="programlisting">.home {
  p.large {
    font-size: 16px;
  }
}

ion-content {
  &amp;.center {
    text-align: center;
  }
}</pre></div></li><li class="listitem">Go to your terminal and run the app. If you want to run the app on your physical device, type the <a id="id700" class="indexterm"/>given command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic run ios</strong></span>
</pre></div><p>For Android, type the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic run android</strong></span>
</pre></div></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec122"/>How it works…</h2></div></div></div><p>In a nutshell, the <code class="literal">AppVersion</code> plugin does all the <span class="emphasis"><em>heavy lifting</em></span>. It's not possible for an Ionic app to find out the current version in its code using Javascript. You may think that using local storage or cookie is an alternative, but the users could also delete that storage manually. In order to have a permanent solution, the <code class="literal">AppVersion</code> plugin should be used because it can read your <code class="literal">config.xml</code> file and get the version for you.</p><p>It's the best practice to create a separate service for all environment variables. That's why you should have a service, called <code class="literal">MyEnv</code>. Also, you should inject <code class="literal">MyEnv</code> as a provider at the <span class="emphasis"><em>app level</em></span> because you want to instantiate it only once, instead of doing it every time a new component is created. Observe the following code:</p><div class="informalexample"><pre class="programlisting">providers: [MyEnv]</pre></div><p>Since all the <code class="literal">AppVersion</code> methods are based on <code class="literal">promise</code>, you should return the entire object as a promise. Let's take a look at the <code class="literal">getAppVersion()</code> method in your <code class="literal">myenv.ts</code> file:</p><div class="informalexample"><pre class="programlisting">  getAppVersion() {
    return this.appVersion.getVersionCode();
  }</pre></div><p>Then, in your page files, such <a id="id701" class="indexterm"/>as <code class="literal">home.ts</code>, you should call the <code class="literal">getAppVersion</code> method, as shown, and use the .<code class="literal">then()</code> method to get the result:</p><div class="informalexample"><pre class="programlisting">  getVersion() {
    console.log(this.myEnv.getAppVersion());
    this.myEnv.getAppVersion().then((data) =&gt; this.ver = data);
  }</pre></div><p>If you open the<a id="id702" class="indexterm"/> console to inspect the <code class="literal">promise</code> object, you will see that it has your app version value and the <code class="literal">.then()</code> method. Observe the following screenshot:</p><div class="mediaobject"><img src="../Images/image00395.jpeg" alt="How it works…"/></div><p style="clear:both; height: 1em;"> </p><p>For more information about the <code class="literal">AppVersion</code> plugin, you may want to refer to the official AppVersion <a id="id703" class="indexterm"/>documentation at <a class="ulink" href="https://github.com/whiteoctober/cordova-plugin-app-version">https://github.com/whiteoctober/cordova-plugin-app-version</a>.</p></div></div>
<div class="section" title="Building and publishing an app for iOS"><div class="titlepage" id="aid-1LCVG2"><div><div><h1 class="title"><a id="ch09lvl1sec50"/>Building and publishing an app for iOS</h1></div></div></div><p>Publishing on App Store <a id="id704" class="indexterm"/>could be a frustrating process if you are not well prepared upfront. In this section, you <a id="id705" class="indexterm"/>will walk through the steps to properly configure everything in Apple Developer Center, iTunes Connect and local Xcode project.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec123"/>Getting ready</h2></div></div></div><p>You must register for Apple <a id="id706" class="indexterm"/>Developer Program in order to access <a class="ulink" href="https://developer.apple.com/macos/touch-bar/">https://developer.apple.com/macos/touch-bar/</a> and <a class="ulink" href="https://itunesconnect.apple.com">https://itunesconnect.apple.com</a>, because those websites will require an approved account.</p><p>In addition, the following instructions a the specific version of these components:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Mac OS X El Capitan 10.11.2</li><li class="listitem">Xcode 7.2</li><li class="listitem">Ionic CLI 2.0</li><li class="listitem">Cordova 5.4.1</li></ul></div></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec124"/>How to do it…</h2></div></div></div><p>Here are the instructions:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Ensure that you<a id="id707" class="indexterm"/> are in the app folder and build for the iOS platform:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic build ios</strong></span>
</pre></div><p>Go to the <code class="literal">/platforms/ios</code> folder to open the <code class="literal">.xcodeproj</code> file in Xcode. Observe the<a id="id708" class="indexterm"/> following screenshot:</p><div class="mediaobject"><img src="../Images/image00396.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Go through the <span class="strong"><strong>General</strong></span> tab, as illustrated in the following screenshot, to make sure that you have the correct information for everything, especially <span class="strong"><strong>Bundle Identifier</strong></span> and <span class="strong"><strong>Version</strong></span>. Change and save as needed:<div class="mediaobject"><img src="../Images/image00397.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Visit the Apple<a id="id709" class="indexterm"/> Developer website and click on <span class="strong"><strong>Certificates, Identifiers &amp; Profiles</strong></span>, as illustrated:<div class="mediaobject"><img src="../Images/image00277.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Select the correct device <a id="id710" class="indexterm"/>platform you are targeting. In this case, it will be <span class="strong"><strong>iOS, tvOS, watchOS</strong></span> as shown:<div class="mediaobject"><img src="../Images/image00278.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">For the iOS app, you need the certificate, app ID, test device, and provisioning profile. To <a id="id711" class="indexterm"/>start with the certificate, navigate to <span class="strong"><strong>Certificates</strong></span> | <span class="strong"><strong>All</strong></span>, as<a id="id712" class="indexterm"/> follows:<div class="mediaobject"><img src="../Images/image00289.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Click on the (<span class="strong"><strong>+</strong></span>) plus button, as shown in the following screenshot:<div class="mediaobject"><img src="../Images/image00398.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">You just have to go through the steps in the website to fill out the necessary information, as depicted in the following screenshot:<div class="mediaobject"><img src="../Images/image00399.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Once you've<a id="id713" class="indexterm"/> completed the form, you can save the CSR file and import it to your Mac's <span class="strong"><strong>Keychain Access</strong></span>.</li><li class="listitem">Navigate to <span class="strong"><strong>Identifiers</strong></span> | <span class="strong"><strong>App IDs</strong></span>, as follows, to <a id="id714" class="indexterm"/>create an app ID:<div class="mediaobject"><img src="../Images/image00279.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Click on the plus (<span class="strong"><strong>+</strong></span>) button at the top right of the screen, as follows:<div class="mediaobject"><img src="../Images/image00400.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Fill in the form to<a id="id715" class="indexterm"/> register your <span class="strong"><strong>App ID</strong></span>, as shown:<div class="mediaobject"><img src="../Images/image00401.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">The important part <a id="id716" class="indexterm"/>here that you need to do correctly is the <span class="strong"><strong>Bundle ID</strong></span>, as shown in the following screenshot, because it must match your <span class="strong"><strong>Bundle Identifier</strong></span> in Xcode:<div class="mediaobject"><img src="../Images/image00402.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">If your<a id="id717" class="indexterm"/> app needs <span class="strong"><strong>Push Notifications</strong></span> or other <span class="strong"><strong>App Services</strong></span>, you<a id="id718" class="indexterm"/> need to check those services on the page:<div class="mediaobject"><img src="../Images/image00403.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">If you need to<a id="id719" class="indexterm"/> push the <a id="id720" class="indexterm"/>app to a specific device, you must register the device. Navigate to <span class="strong"><strong>Devices</strong></span> | <span class="strong"><strong>All</strong></span>, as illustrated:<div class="mediaobject"><img src="../Images/image00301.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Click on the plus (<span class="strong"><strong>+</strong></span>) button, as<a id="id721" class="indexterm"/> shown:<div class="mediaobject"><img src="../Images/image00302.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Provide the <a id="id722" class="indexterm"/>device <span class="strong"><strong>UDID</strong></span>, as follows, and save it in order to register the device:<div class="mediaobject"><img src="../Images/image00303.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Finally, you need a provisioning profile if one doesn't exist yet. Usually, Xcode will create one automatically. However, you could create your own by navigating to <span class="strong"><strong>Provisioning Profiles</strong></span> | <span class="strong"><strong>All</strong></span>, as shown:<div class="mediaobject"><img src="../Images/image00404.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Click on the plus (<span class="strong"><strong>+</strong></span>) button, as follows:<div class="mediaobject"><img src="../Images/image00405.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Select<a id="id723" class="indexterm"/> App Store as <a id="id724" class="indexterm"/>your provisioning profile, as illustrated:<div class="mediaobject"><img src="../Images/image00406.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Select the correct <span class="strong"><strong>App ID</strong></span> in the drop-down menu and save to finalize your provisioning profile creation, as follows:<div class="mediaobject"><img src="../Images/image00407.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Visit iTunes <a id="id725" class="indexterm"/>Connect at <a class="ulink" href="https://itunesconnect.apple.com">https://itunesconnect.apple.com</a> and click<a id="id726" class="indexterm"/> on the <span class="strong"><strong>My Apps </strong></span>button, shown as<a id="id727" class="indexterm"/> follows:<div class="mediaobject"><img src="../Images/image00408.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Select the plus (<span class="strong"><strong>+</strong></span>) icon to select <span class="strong"><strong>New App</strong></span>, as shown:<div class="mediaobject"><img src="../Images/image00409.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Fill out the<a id="id728" class="indexterm"/> form and ensure that you select the right <span class="strong"><strong>Bundle Identifier</strong></span> of your app:<div class="mediaobject"><img src="../Images/image00410.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p><p>There are several additional <a id="id729" class="indexterm"/>steps to provide information about the app, such as screenshot, icon, and address. If you just want to test the app, you could provide some place holder information initially and come back to edit later.</p><p>That's it to prepare your Developer and iTunes Connect account.</p></li><li class="listitem">Now, open <span class="strong"><strong>Xcode</strong></span> and select <span class="strong"><strong>iOS Device</strong></span> as the archive target. Otherwise, the <span class="strong"><strong>Archive</strong></span> feature will not turn on. You <a id="id730" class="indexterm"/>will need to archive your app before you can submit to the App Store:<div class="mediaobject"><img src="../Images/image00411.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Navigate<a id="id731" class="indexterm"/> to <span class="strong"><strong>Product</strong></span> | <span class="strong"><strong>Archive</strong></span> in the top menu, as illustrated:<div class="mediaobject"><img src="../Images/image00412.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">After the archive process is completed, select <span class="strong"><strong>Submit to App Store</strong></span> to finish the publishing process.</li><li class="listitem">To publish, select <span class="strong"><strong>Submit for Beta App Review</strong></span>. You may want to go through other tabs, such as <span class="strong"><strong>Pricing</strong></span> and <span class="strong"><strong>In-App Purchases</strong></span>, to configure your own requirements.</li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec125"/>How it works…</h2></div></div></div><p>Obviously, this section does not cover every bit of detail in the publishing process. In general, you just need to ensure that your app is tested thoroughly, locally, on a physical device (either via USB or <span class="emphasis"><em>TestFlight</em></span>) before submitting it to the App Store. </p><p>If for some reason the <span class="strong"><strong>Archive</strong></span> feature doesn't build, you could manually go to your local Xcode folder to delete that <a id="id732" class="indexterm"/>specific temporary archived app to clear cache, as<a id="id733" class="indexterm"/> shown:</p><div class="informalexample"><pre class="programlisting">~/Library/Developer/Xcode/Archives</pre></div></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec126"/>There's more…</h2></div></div></div><p>
<span class="emphasis"><em>TestFlight</em></span> is a separate subject by itself. The benefit of <span class="emphasis"><em>TestFlight</em></span> is that you don't need your app to be approved by Apple in order to install the app on a physical device for testing and development. You can find out more<a id="id734" class="indexterm"/> information about <span class="emphasis"><em>TestFlight</em></span> at<a class="ulink" href="http://%20https://developer.apple.com/library/content/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/BetaTestingTheApp.html"> https://developer.apple.com/library/content/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/BetaTestingTheApp.html</a>.</p></div></div>
<div class="section" title="Building and publishing an app for Android"><div class="titlepage" id="aid-1MBG22"><div><div><h1 class="title"><a id="ch09lvl1sec51"/>Building and publishing an app for Android</h1></div></div></div><p>Building and <a id="id735" class="indexterm"/>publishing an Android app is a little more straightforward than iOS because<a id="id736" class="indexterm"/> you just interface with the command line to build the .apk file and upload it to Google Play's Developer Console.</p><p>The Ionic Framework documentation<a id="id737" class="indexterm"/> also has a great instruction page for this, which is <a class="ulink" href="http://ionicframework.com/docs/guide/publishing.html">http://ionicframework.com/docs/guide/publishing.html</a>.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec127"/>Getting ready</h2></div></div></div><p>The requirement is to have your <a id="id738" class="indexterm"/>Google Developer account ready and to log in to <a class="ulink" href="https://play.google.com/apps/publish">https://play.google.com/apps/publish</a>.</p><p>Your local environment should also have the right SDK as well as <code class="literal">keytool</code>, <code class="literal">jarsigner</code>, and <code class="literal">zipalign</code> command line for that specific version.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec128"/>How to do it…</h2></div></div></div><p>Here are the instructions:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to your app folder and build for Android with the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ionic package build --release android</strong></span>
</pre></div></li><li class="listitem">You will see the <code class="literal">android-release-unsigned.apk</code> in the <code class="literal">/platforms/android/build/outputs/apk</code> folder. Go to that folder in the terminal:<div class="mediaobject"><img src="../Images/image00413.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">If this is the first time you created this app, you must have a <code class="literal">keystore</code> file. This file is used to identify your app for publishing. If you lose it, you cannot update your app later on. To create a <code class="literal">keystore</code>, type the following command line and ensure that it's the same <code class="literal">keytool</code> version of the SDK:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000</strong></span>
</pre></div></li><li class="listitem">Once you fill <a id="id739" class="indexterm"/>out the information in the command line, make a copy <a id="id740" class="indexterm"/>of this file somewhere safe because you will need it later.</li><li class="listitem">The next step is to use that file to <span class="emphasis"><em>sign</em></span> your app so that it will create a new <code class="literal">.apk</code> that Google Play allows users to install:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore HelloWorld-release-unsigned.apk alias_name</strong></span>
</pre></div></li><li class="listitem">To prepare for the final <code class="literal">.apk</code> before upload, you must package it using <code class="literal">zipalign</code>, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ zipalign -v 4 HelloWorld-release-unsigned.apk HelloWorld.apk</strong></span>
</pre></div></li></ol><div style="height:10px; width: 1px"/></div><p>You need to ensure that <code class="literal">zipalign</code> is in <code class="literal">PATH</code> or you have to specify the absolute path. The app name could<a id="id741" class="indexterm"/> be anything you like or you can use the same name as created in this chapter:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Log in<a id="id742" class="indexterm"/> to Google Developer Console and click on <span class="strong"><strong>Add new application</strong></span>, as shown:<div class="mediaobject"><img src="../Images/image00414.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Fill out content rating and other information as possible for your app using the left menu:<div class="mediaobject"><img src="../Images/image00415.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Now you are ready to upload your <code class="literal">.apk</code> file. First is to do a Beta:<div class="mediaobject"><img src="../Images/image00416.jpeg" alt="How to do it…"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Once you are done with Beta testing, you can follow Developer Console instructions to push the app to production.</li></ol><div style="height:10px; width: 1px"/></div><div class="note" title="Note"><h3 class="title"><a id="note32"/>Note</h3><p>If you run into any problem while publishing the app, it's helpful to look at the "Why can't I publish?" link in<a id="id743" class="indexterm"/> the dashboard's top right corner. Google will guide you on specific steps that must be completed or fixed.</p></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec129"/>How it works…</h2></div></div></div><p>This section does not cover other <a id="id744" class="indexterm"/>Android marketplaces, such as Amazon app store, because each of them has different processes. However, the common idea is that you need to completely build the unsigned version of the <code class="literal">.apk</code>, sign it using an existing or new <code class="literal">keystore</code> file, and, finally, <code class="literal">zipa</code>
<code class="literal">lign</code> to prepare it for upload.</p></div></div></body></html>