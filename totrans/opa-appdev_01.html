<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Getting Started with Opa</h1></div></div></div><p>This chapter shows how to install Opa and set its environment. A simple Opa program will also be shown to give a first glimpse of Opa programming.</p><div><div><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Installing Opa</h1></div></div></div><p>This <a id="id0" class="indexterm"/>section is <a id="id1" class="indexterm"/>about installation and configuration of Opa. You<a id="id2" class="indexterm"/> can get a more detailed installation guide that includes how to build Opa from source on<a id="id3" class="indexterm"/> Opa's webpage (<a class="ulink" href="https://github.com/MLstate/opalang/wiki/Getting-started">https://github.com/MLstate/opalang/wiki/Getting-started</a>). This section will give us brief instructions on how to install Opa compiler, Node.js, and some required modules for Node.js.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec07"/>Installing Node.js</h2></div></div></div><p>Node.js (<a class="ulink" href="http://nodejs.org">http://nodejs.org</a>) is a <a id="id4" class="indexterm"/>platform for <a id="id5" class="indexterm"/>
<a id="id6" class="indexterm"/>building fast <a id="id7" class="indexterm"/>and scalable network applications. It is the backend of Opa (since Opa 1.0.0). We need to install Node.js first before installing Opa. The following are the steps to install Node.js on various operating systems:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Mac OS</strong>: Following<a id="id8" class="indexterm"/> are<a id="id9" class="indexterm"/> the steps to install Node.js:<div><ol class="orderedlist arabic"><li class="listitem">Download the latest <code class="literal">.pkg</code> package from <a class="ulink" href="http://nodejs.org/dist/latest/">http://nodejs.org/dist/latest/</a>.</li><li class="listitem">Double-click on the package to install Node.js.</li></ol></div></li><li class="listitem" style="list-style-type: disc"><strong>Ubuntu and Debian Linux</strong>: To <a id="id10" class="indexterm"/>install <a id="id11" class="indexterm"/>Node.js on Ubuntu and Debian Linux, type the following commands:<div><pre class="programlisting">
<strong>$sudo apt-get install python-software-properties</strong>
<strong>$sudo add-apt-repository ppa:chris-lea/node.js</strong>
<strong>$sudo apt-get update</strong>
<strong>$sudo apt-get install nodejs npm</strong>
</pre></div><div><div><h3 class="title"><a id="tip02"/>Tip</h3><p>
<strong>Downloading the example code files</strong>
</p><p>You can download the example code files for all Packt books you have purchased from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div></div></li><li class="listitem" style="list-style-type: disc"><strong>Windows</strong>: The <a id="id12" class="indexterm"/>following are the steps to<a id="id13" class="indexterm"/> install Node.js:<div><ol class="orderedlist arabic"><li class="listitem">Download the latest <code class="literal">.msi</code> package from <a class="ulink" href="http://nodejs.org/dist/latest/">http://nodejs.org/dist/latest/</a>.</li><li class="listitem">Double-click on the package to install Node.js on Windows.</li></ol></div></li></ul></div><p>Type the following commands to confirm your installation. If everything goes right, you will see the version information of Node.js and npm.</p><div><pre class="programlisting">
<strong>$ node -v</strong>
<strong>$ npm –v</strong>
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Installing the required modules</h2></div></div></div><p>There are<a id="id14" class="indexterm"/> several modules that are required by Opa to run an application. Type the following command to install these modules:</p><div><pre class="programlisting">
<strong>$ npm install -g mongodb formidable nodemailer simplesmtp imap</strong>
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Installing the Opa compiler</h2></div></div></div><p>The easiest <a id="id15" class="indexterm"/>solution for installing Opa is to download <a id="id16" class="indexterm"/>an installer <a id="id17" class="indexterm"/>from the Opa website<a id="id18" class="indexterm"/> (<a class="ulink" href="http://opalang.org/">http://opalang.org/</a>). You can also get the installer from Opa's GitHub repository (<a class="ulink" href="https://github.com/MLstate/opalang/downloads">https://github.com/MLstate/opalang/downloads</a>). At the time this book is being written, the latest version of Opa is 1.1.0.</p><p>Following are the steps to install Opa on various operating systems:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>Mac OS X</strong>: <a id="id19" class="indexterm"/>Download the latest <code class="literal">.dmg</code> package and double-click on it to install. You will need the password of an <a id="id20" class="indexterm"/>administrative account.</li><li class="listitem" style="list-style-type: disc"><strong>Ubuntu and Debian Linux</strong>: Download <a id="id21" class="indexterm"/>the latest <code class="literal">.deb</code> package<a id="id22" class="indexterm"/> and double-click on it to install. You can also install it with the following command line:<div><pre class="programlisting">
<strong>$sudo dpkg –i opa-1.1.0.x86.deb</strong>
</pre></div></li><li class="listitem" style="list-style-type: disc"><strong>Windows</strong>: Download<a id="id23" class="indexterm"/> the latest <code class="literal">.exe</code> file and double-click on it to install. Note <a id="id24" class="indexterm"/>that only 64-bit packages are available for Windows at this time.</li><li class="listitem" style="list-style-type: disc"><strong>Other Linux</strong>: To <a id="id25" class="indexterm"/>install Opa follow these<a id="id26" class="indexterm"/> steps:<div><ol class="orderedlist arabic"><li class="listitem">Download the latest <code class="literal">.run</code> package for Linux.</li><li class="listitem">Go to the download folder and add an execution privilege to the downloaded file by running the following command:<div><pre class="programlisting">
<strong>$ chmod a+x opa-1.1.0.x64.run</strong>
</pre></div></li><li class="listitem">Run the installing script:<div><pre class="programlisting">
<strong>$ sudo ./opa-1.1.0.x64.run</strong>
</pre></div></li></ol></div></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Testing the installation</h2></div></div></div><p>To test if Opa<a id="id27" class="indexterm"/> is installed properly on your computer, run the following command:</p><div><pre class="programlisting">
<strong>$ opa --version</strong>
</pre></div><p>Opa is installed properly if the version information of the Opa compiler is printed.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Setting up editors</h1></div></div></div><p>You can write Opa codes with any text editor you like, but a good editor can make coding easier.<a id="id28" class="indexterm"/> This section is about setting up editors you may commonly use. For now, Sublime Text is the most complete <strong>Integrated Development Environment</strong> (<strong>IDE</strong>)<a id="id29" class="indexterm"/> for Opa.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Sublime Text</h2></div></div></div><p>Sublime Text (<a class="ulink" href="http://www.sublimetext.com/">http://www.sublimetext.com/</a>)<a id="id30" class="indexterm"/> is a<a id="id31" class="indexterm"/> sophisticated<a id="id32" class="indexterm"/> text editor<a id="id33" class="indexterm"/> for code, markup, and prose. You can <a id="id34" class="indexterm"/>download and try Sublime Text for free from <a class="ulink" href="http://www.sublimetext.com/2">http://www.sublimetext.com/2</a>.</p><p>There is an Opa plugin that offers syntax highlighting, code completion, and some other features. To install <a id="id35" class="indexterm"/>the plugin, follow these steps:</p><div><ol class="orderedlist arabic"><li class="listitem">Get the plugin from <a class="ulink" href="https://github.com/downloads/MLstate/OpaSublimeText/Opa.sublime-package">https://github.com/downloads/MLstate/OpaSublimeText/Opa.sublime-package</a>.</li><li class="listitem">Move it to<code class="literal"> ~/.config/sublime-text2/Installed Packages/</code> (in Linux), or <code class="literal">%%APPDATA%%\Sublime Text 2\Installed Packages\</code> (in Windows), or <code class="literal">~/Library/Application Support/Sublime Text 2/Installed Packages</code> (in Mac).</li><li class="listitem">Start Sublime and check if the menu entry (<strong>View</strong> | <strong>Syntax</strong> | <strong>Opa</strong>) is present. If everything goes well, the file with the <code class="literal">.opa</code> extension should automatically have its syntax highlighted. If not, please make sure you are using the Opa plugin (<strong>View</strong> | <strong>Syntax</strong> | <strong>Opa</strong>). We can navigate to <strong>Edit</strong> | <strong>Line</strong> | <strong>Reindent</strong> to auto-indent the Opa code.</li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Vim</h2></div></div></div><p>Vim (<a class="ulink" href="http://www.vim.org/">http://www.vim.org/</a>) is <a id="id36" class="indexterm"/>a highly<a id="id37" class="indexterm"/> configurable text editor,<a id="id38" class="indexterm"/> freely available for many different platforms. The Opa installation package provides a mode for Vim at <code class="literal">/usr/share/opa/vim/</code> (for Linux) or <code class="literal">/opt/mlstate/share/opa/vim/</code> (for Mac OS). To enable Vim to detect Opa syntax, copy these files to your <code class="literal">.vim</code> directory in your home folder (create it if it does not exist already):</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">On Linux, type the following command:<div><pre class="programlisting">
<strong>$cp –p /usr/share/opa/vim/* ~/.vim/</strong>
</pre></div></li><li class="listitem" style="list-style-type: disc">On Mac OS, type the following command:<div><pre class="programlisting">
<strong>$cp –p /opt/mlstate/share/opa/vim/* ~/.vim</strong>
</pre></div></li></ul></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Emacs</h2></div></div></div><p>On Mac OS X, <a id="id39" class="indexterm"/>
<a id="id40" class="indexterm"/>you can either use Aquamacs and the package installation will take care of it, or you should add the following line to your configuration file (which might be <code class="literal">~/.emacs</code>; create it if it does not exist already):</p><div><pre class="programlisting">(autoload 'opa-classic-mode "/Library/Application Support/Emacs/site-lisp/opa-mode/opa-mode.el" "Opa CLASSIC editing mode." t)
(autoload 'opa-js-mode "/Library/Application Support/Emacs/site-lisp/opa-mode/opa-js-mode.el" "Opa JS editing mode." t)
(add-to-list 'auto-mode-alist '("\.opa$" . opa-js-mode))
(add-to-list 'auto-mode-alist '("\.js\.opa$" . opa-js-mode))
(add-to-list 'auto-mode-alist '("\.classic\.opa$" . opa-classic-mode))</pre></div><p>On Linux, add the following lines to your configuration file:</p><div><pre class="programlisting">(autoload 'opa-js-mode "/usr/share/opa/emacs/opa-js-mode.el" "Opa JS editing mode." t)
(autoload 'opa-classic-mode "/usr/share/opa/emacs/opa-mode.el" "Opa CLASSIC editing mode." t)
(add-to-list 'auto-mode-alist '("\.opa$" . opa-js-mode))
(add-to-list 'auto-mode-alist '("\.js\.opa$" . opa-js-mode))
(add-to-list 'auto-mode-alist '("\.classic\.opa$" . opa-classic-mode))</pre></div><p>For Eclipse, the experimental plugin<a id="id41" class="indexterm"/> is available at <a class="ulink" href="https://github.com/MLstate/opa-eclipse-plugin">https://github.com/MLstate/opa-eclipse-plugin</a>.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Your first Opa application</h1></div></div></div><p>As a first<a id="id42" class="indexterm"/> example, here is the most simple program in Opa:</p><div><pre class="programlisting">jlog("hello Opa!")</pre></div><p>Compile and run it:</p><div><pre class="programlisting">
<strong>$ opa hello.opa -o hello.js</strong>
<strong>$ ./hello.js</strong>
</pre></div><div><div><h3 class="title"><a id="note02"/>Note</h3><p>We can type <code class="literal">opa hello.opa --</code> to compile and run the code in a single line.</p></div></div><p>The code does nothing but prints <strong>hello Opa</strong> on your screen. If you can see this message, it means Opa is working properly on your machine.</p></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Summary</h1></div></div></div><p>In this chapter, we learned how to install Opa, set up a proper editor, and write our first Opa program. In the next chapter, we will have a brief look at the basic grammar of the Opa language.</p></div></body></html>