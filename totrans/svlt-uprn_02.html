<html><head></head><body>
<div id="_idContainer011">
<h1 class="chapter-number" id="_idParaDest-32"><a id="_idTextAnchor032"/><span class="koboSpan" id="kobo.1.1">2</span></h1>
<h1 id="_idParaDest-33"><a id="_idTextAnchor033"/><span class="koboSpan" id="kobo.2.1">Configurations and Options</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In my opinion, there are few things more frustrating than working diligently on a project for weeks, only for a bug to manifest itself upon the project launch in the production environment because of a seemingly obscure configuration option. </span><span class="koboSpan" id="kobo.3.2">That is why this chapter will make efforts to teach you about the various options available to you before you dig in. </span><span class="koboSpan" id="kobo.3.3">I know you’re ready to learn about SvelteKit already. </span><span class="koboSpan" id="kobo.3.4">I promise that I’m just as excited to get into “actually building stuff” as you are, but I assure you that there is value in learning these concepts early on. </span><span class="koboSpan" id="kobo.3.5">If you’re hoping to rapidly develop a high-performance web application, then I believe it is in your best interest to learn these concepts before you start on your </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">specific app.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">To begin this chapter, we’ll start by taking a look at how you can manage your project configuration with options available in your </span><strong class="source-inline"><span class="koboSpan" id="kobo.6.1">svelte.config.js</span></strong><span class="koboSpan" id="kobo.7.1"> file. </span><span class="koboSpan" id="kobo.7.2">We’ll then take a brief look at some configurations with basic adapters so that you can get started. </span><span class="koboSpan" id="kobo.7.3">We’ll also look at the options available to you in your </span><strong class="source-inline"><span class="koboSpan" id="kobo.8.1">vite.config.js</span></strong><span class="koboSpan" id="kobo.9.1"> file. </span><span class="koboSpan" id="kobo.9.2">It may seem strange to discuss Vite so much in a book about SvelteKit, but SvelteKit wouldn’t be the tool it is </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">without Vite.</span></span></p>
<p><span class="koboSpan" id="kobo.11.1">In this chapter, we’ll cover </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">these topics:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.13.1">Configuring SvelteKit</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.14.1">Configuring Vite</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.15.1">After we have discussed the configurations and how they’ll affect your tools, you should feel more comfortable making appropriate changes to suit the needs of your next </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">SvelteKit project.</span></span></p>
<h1 id="_idParaDest-34"><a id="_idTextAnchor034"/><span class="koboSpan" id="kobo.17.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.18.1">The complete code for this chapter is available on GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">at: </span></span><a href="https://github.com/PacktPublishing/SvelteKit-Up-and-Running/tree/main/chapters/chapter02"><span class="No-Break"><span class="koboSpan" id="kobo.20.1">https://github.com/PacktPublishing/SvelteKit-Up-and-Running/tree/main/chapters/chapter02</span></span></a></p>
<h1 id="_idParaDest-35"><a id="_idTextAnchor035"/><span class="koboSpan" id="kobo.21.1">Configuring SvelteKit</span></h1>
<p><span class="koboSpan" id="kobo.22.1">The </span><a id="_idIndexMarker018"/><span class="koboSpan" id="kobo.23.1">essential configuration for a SvelteKit project lives inside</span><a id="_idIndexMarker019"/><span class="koboSpan" id="kobo.24.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.25.1">svelte.config.js</span></strong><span class="koboSpan" id="kobo.26.1"> file. </span><span class="koboSpan" id="kobo.26.2">Understanding the various options available to you will empower you to make the most of SvelteKit. </span><span class="koboSpan" id="kobo.26.3">While we cannot cover all available options in such a brief section, the aim of it is to cover options that you are likely to find useful. </span><span class="koboSpan" id="kobo.26.4">For </span><a id="_idIndexMarker020"/><span class="koboSpan" id="kobo.27.1">more configuration options, see the </span><em class="italic"><span class="koboSpan" id="kobo.28.1">Further Reading</span></em><span class="koboSpan" id="kobo.29.1"> section at the end of this chapter for </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">more resources.</span></span></p>
<p><span class="koboSpan" id="kobo.31.1">To get started, go ahead and </span><a id="_idIndexMarker021"/><span class="koboSpan" id="kobo.32.1">open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.33.1">svelte.config.js</span></strong><span class="koboSpan" id="kobo.34.1"> file from the skeleton project in your editor. </span><span class="koboSpan" id="kobo.34.2">Note that it’s quite simple at this point. </span><span class="koboSpan" id="kobo.34.3">Essentially, it imports the </span><strong class="source-inline"><span class="koboSpan" id="kobo.35.1">adapter</span></strong><span class="koboSpan" id="kobo.36.1"> function from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.37.1">@sveltejs/adapter-auto</span></strong><span class="koboSpan" id="kobo.38.1"> package, specifies that function in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.39.1">kit</span></strong><span class="koboSpan" id="kobo.40.1"> property of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.41.1">config</span></strong><span class="koboSpan" id="kobo.42.1"> constant, and finally, exports the </span><strong class="source-inline"><span class="koboSpan" id="kobo.43.1">config</span></strong><span class="koboSpan" id="kobo.44.1"> object. </span><span class="koboSpan" id="kobo.44.2">We’re also given a type annotation via </span><strong class="bold"><span class="koboSpan" id="kobo.45.1">JSDoc</span></strong><span class="koboSpan" id="kobo.46.1">. </span><span class="koboSpan" id="kobo.46.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.47.1">config.kit</span></strong><span class="koboSpan" id="kobo.48.1"> property is where we will add various other properties to customize our configuration. </span><span class="koboSpan" id="kobo.48.2">It should look similar </span><span class="No-Break"><span class="koboSpan" id="kobo.49.1">to this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.50.1">
import adapter from '@sveltejs/adapter-auto';
/** @type {import('@sveltejs/kit').Config} */
const config = {
      kit: {
           adapter: adapter()
       }
};
export default config;</span></pre>
<p><span class="koboSpan" id="kobo.51.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.52.1">adapter-auto</span></strong><span class="koboSpan" id="kobo.53.1"> package is included by default when installing with </span><strong class="source-inline"><span class="koboSpan" id="kobo.54.1">npm create svelte@latest</span></strong><span class="koboSpan" id="kobo.55.1">. </span><span class="koboSpan" id="kobo.55.2">It will automatically adapt your project during build time so that it can be effortlessly deployed to Vercel, Cloudflare Pages, Netlify, or Azure Static Web Apps. </span><span class="koboSpan" id="kobo.55.3">Because of this, </span><strong class="source-inline"><span class="koboSpan" id="kobo.56.1">adapter-auto</span></strong><span class="koboSpan" id="kobo.57.1"> is </span><a id="_idIndexMarker022"/><span class="koboSpan" id="kobo.58.1">considered a </span><strong class="bold"><span class="koboSpan" id="kobo.59.1">zero-config</span></strong><span class="koboSpan" id="kobo.60.1"> adapter, meaning that you can use it for any of the aforementioned environments. </span><span class="koboSpan" id="kobo.60.2">However, even if you are using one of these environments, it is recommended to install the environment-specific adapter to your </span><strong class="source-inline"><span class="koboSpan" id="kobo.61.1">devDependencies</span></strong><span class="koboSpan" id="kobo.62.1">. </span><span class="koboSpan" id="kobo.62.2">Doing so will allow you to customize options specific to that environment, since </span><strong class="source-inline"><span class="koboSpan" id="kobo.63.1">adapter-auto</span></strong><span class="koboSpan" id="kobo.64.1"> does not accept </span><span class="No-Break"><span class="koboSpan" id="kobo.65.1">any options.</span></span></p>
<p><span class="koboSpan" id="kobo.66.1">We’ll discuss adapters at length in a later chapter; we’ll cover how you can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.67.1">adapter-static</span></strong><span class="koboSpan" id="kobo.68.1"> package to generate a static site and how you can run SvelteKit applications on Node.js servers using </span><strong class="source-inline"><span class="koboSpan" id="kobo.69.1">adapter-node</span></strong><span class="koboSpan" id="kobo.70.1">. </span><span class="koboSpan" id="kobo.70.2">For now, let’s look at some other potential configuration options you may find yourself needing in the </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">following sections.</span></span></p>
<h2 id="_idParaDest-36"><a id="_idTextAnchor036"/><span class="koboSpan" id="kobo.72.1">alias</span></h2>
<p><span class="koboSpan" id="kobo.73.1">While it is </span><a id="_idIndexMarker023"/><span class="koboSpan" id="kobo.74.1">very useful to have access to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.75.1">src/lib/</span></strong><span class="koboSpan" id="kobo.76.1"> path via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.77.1">$lib/</span></strong><span class="koboSpan" id="kobo.78.1"> alias, there may come a time where you want to access something outside of that. </span><span class="koboSpan" id="kobo.78.2">To do so, you can add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.79.1">alias</span></strong><span class="koboSpan" id="kobo.80.1"> property to </span><strong class="source-inline"><span class="koboSpan" id="kobo.81.1">config.kit</span></strong><span class="koboSpan" id="kobo.82.1">. </span><span class="koboSpan" id="kobo.82.2">For instance, if your project had a specific file for connecting to and managing a database, you could create an alias to make imports simpler. </span><span class="koboSpan" id="kobo.82.3">Alternatively, you may want to easily access an image from a commonly used folder. </span><span class="koboSpan" id="kobo.82.4">See the following code snippets demonstrating </span><span class="No-Break"><span class="koboSpan" id="kobo.83.1">these concepts:</span></span></p>
<p class="SC---Heading" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.84.1">src/db.js</span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.85.1">
const db = {
     connection: 'DB connection successful!',
     // database logic goes here…
};
export default db;</span></pre>
<p class="SC---Heading" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.86.1">svelte.config.js</span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.87.1">
import adapter from '@sveltejs/adapter-auto';
/** @type {import('@sveltejs/kit').Config} */
const config = {
      kit: {
           adapter: adapter(),
           alias: {
                 db: '/src/db.js',
                 img: '/src/images'
                 }
       },
};
export default config;</span></pre>
<p class="SC---Heading" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.88.1">src/routes/+page.svelte</span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.89.1">
&lt;script&gt;
      import db from 'db';
      import url from 'img/demo.png';
      let status = db.connection;
&lt;/script&gt;
&lt;p&gt;{status}&lt;/p&gt;
&lt;img src={url}&gt;</span></pre>
<p><span class="koboSpan" id="kobo.90.1">In this</span><a id="_idIndexMarker024"/><span class="koboSpan" id="kobo.91.1"> example, I’ve created a mock database object with a property called </span><strong class="source-inline"><span class="koboSpan" id="kobo.92.1">connection</span></strong><span class="koboSpan" id="kobo.93.1">. </span><span class="koboSpan" id="kobo.93.2">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.94.1">svelte.config.js</span></strong><span class="koboSpan" id="kobo.95.1"> file, I’ve added two aliases – one for the mock database object and another that points to a folder of images. </span><span class="koboSpan" id="kobo.95.2">Then, in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">+page.svelte</span></strong><span class="koboSpan" id="kobo.97.1"> file, an import is made from both of these aliases to illustrate how you might use aliases to import a single file, as well as make an import of one particular file from </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">a directory.</span></span></p>
<p><span class="koboSpan" id="kobo.99.1">This example fails to take into consideration any asynchronous code that would usually be required for database operations. </span><span class="koboSpan" id="kobo.99.2">It is also not considered best practice to make calls to a database directly from routes, but we’ll come back to how to do that in a later chapter. </span><span class="koboSpan" id="kobo.99.3">While this example is quite rudimentary, it is intended to showcase the usefulness of being able to add your own aliases for specific files </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">and directories.</span></span></p>
<h2 id="_idParaDest-37"><a id="_idTextAnchor037"/><span class="koboSpan" id="kobo.101.1">appDir</span></h2>
<p><span class="koboSpan" id="kobo.102.1">This </span><a id="_idIndexMarker025"/><span class="koboSpan" id="kobo.103.1">property defaults to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.104.1">_app</span></strong><span class="koboSpan" id="kobo.105.1"> value and is used to determine where imported assets such as CSS and JS will be served from the </span><span class="No-Break"><span class="koboSpan" id="kobo.106.1">built application.</span></span></p>
<h2 id="_idParaDest-38"><a id="_idTextAnchor038"/><span class="koboSpan" id="kobo.107.1">csp</span></h2>
<p><span class="koboSpan" id="kobo.108.1">To aid in defending </span><a id="_idIndexMarker026"/><span class="koboSpan" id="kobo.109.1">your application and its users from</span><a id="_idIndexMarker027"/><span class="koboSpan" id="kobo.110.1"> malicious </span><strong class="bold"><span class="koboSpan" id="kobo.111.1">cross-site scripting</span></strong><span class="koboSpan" id="kobo.112.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.113.1">XSS</span></strong><span class="koboSpan" id="kobo.114.1">) attacks, you can </span><a id="_idIndexMarker028"/><span class="koboSpan" id="kobo.115.1">implement </span><strong class="bold"><span class="koboSpan" id="kobo.116.1">Content Security Policy</span></strong><span class="koboSpan" id="kobo.117.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.118.1">CSP</span></strong><span class="koboSpan" id="kobo.119.1">) response headers. </span><span class="koboSpan" id="kobo.119.2">How CSP works is beyond the scope of this book, so it is recommended to study it further before implementing these options in your configuration, as doing so without sufficient knowledge can lead to undesired consequences. </span><span class="koboSpan" id="kobo.119.3">The three properties that can be added to </span><strong class="source-inline"><span class="koboSpan" id="kobo.120.1">config.kit.csp</span></strong><span class="koboSpan" id="kobo.121.1"> are </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">as follows:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.123.1">mode: 'hash' | 'nonce' | 'auto'</span></strong><span class="koboSpan" id="kobo.124.1">: This specifies whether hashes or nonces should be used to enforce CSP. </span><span class="koboSpan" id="kobo.124.2">Using </span><strong class="source-inline"><span class="koboSpan" id="kobo.125.1">auto</span></strong><span class="koboSpan" id="kobo.126.1"> will use nonces for dynamically rendered pages and hashes for </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">prerendered pages.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.128.1">directives</span></strong><span class="koboSpan" id="kobo.129.1">: Directives specified here will be added to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.130.1">Content-Security-Policy</span></strong><span class="koboSpan" id="kobo.131.1"> headers. </span><span class="koboSpan" id="kobo.131.2">See the official SvelteKit documentation for a full list of </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">available options.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.133.1">reportOnly</span></strong><span class="koboSpan" id="kobo.134.1">: This is used to report errors but still allows scripts to be loaded. </span><span class="koboSpan" id="kobo.134.2">Directives specified here will be added to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.135.1">Content-Security-Policy-Report-Only</span></strong><span class="koboSpan" id="kobo.136.1"> headers. </span><span class="koboSpan" id="kobo.136.2">See the official SvelteKit documentation for a full list of </span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">available options.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.138.1">While this can be helpful to prevent scripts from being loaded from external sources, you may have deliberately included scripts </span><a id="_idIndexMarker029"/><span class="koboSpan" id="kobo.139.1">from a </span><strong class="bold"><span class="koboSpan" id="kobo.140.1">Content Delivery Network</span></strong><span class="koboSpan" id="kobo.141.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.142.1">CDN</span></strong><span class="koboSpan" id="kobo.143.1">). </span><span class="koboSpan" id="kobo.143.2">If you have included external scripts, then depending on the CSP for your application, you may need to add </span><strong class="source-inline"><span class="koboSpan" id="kobo.144.1">%sveltekit.nonce%</span></strong><span class="koboSpan" id="kobo.145.1"> to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.146.1">nonce</span></strong><span class="koboSpan" id="kobo.147.1"> property of the included script, </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">like so:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.149.1">
&lt;script src='YOUR_EXT_URL/script.js' nonce='%sveltekit.nonce%'&gt;</span></pre>
<h2 id="_idParaDest-39"><a id="_idTextAnchor039"/><span class="koboSpan" id="kobo.150.1">csrf</span></h2>
<p><span class="koboSpan" id="kobo.151.1">To help </span><a id="_idIndexMarker030"/><span class="koboSpan" id="kobo.152.1">protect your </span><a id="_idIndexMarker031"/><span class="koboSpan" id="kobo.153.1">application from </span><strong class="bold"><span class="koboSpan" id="kobo.154.1">cross-site request forgery</span></strong><span class="koboSpan" id="kobo.155.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.156.1">CSRF</span></strong><span class="koboSpan" id="kobo.157.1">) attacks, this option comes enabled by default. </span><span class="koboSpan" id="kobo.157.2">It prevents end users from making </span><strong class="source-inline"><span class="koboSpan" id="kobo.158.1">POST</span></strong><span class="koboSpan" id="kobo.159.1"> requests to your application from another origin. </span><span class="koboSpan" id="kobo.159.2">If you need to disable it, you can do so by setting </span><strong class="source-inline"><span class="koboSpan" id="kobo.160.1">config.kit.csrf.checkOrigin</span></strong><span class="koboSpan" id="kobo.161.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.162.1">false</span></strong><span class="koboSpan" id="kobo.163.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">like </span></span><span class="No-Break"><a id="_idIndexMarker032"/></span><span class="No-Break"><span class="koboSpan" id="kobo.165.1">so:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.166.1">
const config = {
  kit: {
    adapter: adapter(),
    csrf: {
      checkOrigin: false
    }
  },
};</span></pre>
<h2 id="_idParaDest-40"><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.167.1">env</span></h2>
<p><span class="koboSpan" id="kobo.168.1">If you have</span><a id="_idIndexMarker033"/><span class="koboSpan" id="kobo.169.1"> included </span><strong class="source-inline"><span class="koboSpan" id="kobo.170.1">.env</span></strong><span class="koboSpan" id="kobo.171.1"> files in your project, you can further specify which ones can be public and which directory they are stored in with the </span><span class="No-Break"><span class="koboSpan" id="kobo.172.1">following options:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">dir</span></strong><span class="koboSpan" id="kobo.174.1">: A string value that defaults to “</span><strong class="source-inline"><span class="koboSpan" id="kobo.175.1">.</span></strong><span class="koboSpan" id="kobo.176.1">” (the project </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">root</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.178.1"> directory).</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.179.1">publicPrefix</span></strong><span class="koboSpan" id="kobo.180.1">: A string value that defaults to </span><strong class="source-inline"><span class="koboSpan" id="kobo.181.1">PUBLIC_</span></strong><span class="koboSpan" id="kobo.182.1">. </span><span class="koboSpan" id="kobo.182.2">This prefix denotes whether environment variables located in </span><strong class="source-inline"><span class="koboSpan" id="kobo.183.1">.env</span></strong><span class="koboSpan" id="kobo.184.1"> files are safe to be exposed to client-side code. </span><span class="koboSpan" id="kobo.184.2">Those environment variables are then accessible by importing from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.185.1">$env/static/public</span></strong><span class="koboSpan" id="kobo.186.1"> module throughout the rest of the application. </span><span class="koboSpan" id="kobo.186.2">For example, assume we’re working with an </span><strong class="source-inline"><span class="koboSpan" id="kobo.187.1">.env</span></strong><span class="koboSpan" id="kobo.188.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.189.1">base</span></strong><span class="koboSpan" id="kobo.190.1"> directory of our project. </span><span class="koboSpan" id="kobo.190.2">Adding the </span><strong class="source-inline"><span class="koboSpan" id="kobo.191.1">PUBLIC_EXTERNAL_API=https://api.nasa.gov/planetary/apod</span></strong><span class="koboSpan" id="kobo.192.1"> value will be importable in client-side code, whereas the </span><strong class="source-inline"><span class="koboSpan" id="kobo.193.1">INTERNAL_API=AN_INTERNAL_IP_ADDRESS</span></strong><span class="koboSpan" id="kobo.194.1"> value will only be importable in </span><span class="No-Break"><span class="koboSpan" id="kobo.195.1">server code.</span></span></li>
</ul>
<h2 id="_idParaDest-41"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.196.1">prerender</span></h2>
<p><span class="koboSpan" id="kobo.197.1">It’s</span><a id="_idIndexMarker034"/><span class="koboSpan" id="kobo.198.1"> very likely that at least some content in your application will be prerenderable – that is, it will show the exact same HTML, CSS, and JS for each and every user that visits it. </span><span class="koboSpan" id="kobo.198.2">A common example of this is an “About” page. </span><span class="koboSpan" id="kobo.198.3">Whether or not you would like for a specific page to be prerendered will be addressed in a later chapter, but to further customize prerendering, consider the following options that can be added </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">config.kit.prerender</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.202.1">entries</span></strong><span class="koboSpan" id="kobo.203.1">: An array of strings for each route that should be prerendered. </span><span class="koboSpan" id="kobo.203.2">The default value is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">*</span></strong><span class="koboSpan" id="kobo.205.1"> special character and will include all </span><span class="No-Break"><span class="koboSpan" id="kobo.206.1">non-dynamic routes.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">concurrency</span></strong><span class="koboSpan" id="kobo.208.1">: The number of pages that can be prerendered simultaneously. </span><span class="koboSpan" id="kobo.208.2">Because JS is single-threaded, this will only take effect if your project needs to make network requests during the </span><span class="No-Break"><span class="koboSpan" id="kobo.209.1">prerendering process.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.210.1">crawl</span></strong><span class="koboSpan" id="kobo.211.1">: This option defaults to </span><strong class="source-inline"><span class="koboSpan" id="kobo.212.1">true</span></strong><span class="koboSpan" id="kobo.213.1">. </span><span class="koboSpan" id="kobo.213.2">It tells SvelteKit whether or not it should prerender pages found in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.214.1">entries</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.215.1"> array.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.216.1">handleHttpError</span></strong><span class="koboSpan" id="kobo.217.1">: This option defaults to </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">fail</span></strong><span class="koboSpan" id="kobo.219.1">. </span><span class="koboSpan" id="kobo.219.2">Other options include </span><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">ignore</span></strong><span class="koboSpan" id="kobo.221.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.222.1">warn</span></strong><span class="koboSpan" id="kobo.223.1">, or a </span><strong class="source-inline"><span class="koboSpan" id="kobo.224.1">details</span></strong><span class="koboSpan" id="kobo.225.1"> object specific to SvelteKit that implements </span><strong class="source-inline"><span class="koboSpan" id="kobo.226.1">PrerenderHttpErrorHandler</span></strong><span class="koboSpan" id="kobo.227.1">. </span><span class="koboSpan" id="kobo.227.2">If the prerendering process fails at any point, this option determines how to </span><span class="No-Break"><span class="koboSpan" id="kobo.228.1">manage it.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">handleMissingId</span></strong><span class="koboSpan" id="kobo.230.1">: This is the same as </span><strong class="source-inline"><span class="koboSpan" id="kobo.231.1">handleHttpError</span></strong><span class="koboSpan" id="kobo.232.1"> except that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.233.1">details</span></strong><span class="koboSpan" id="kobo.234.1"> object it accepts is implemented from </span><strong class="source-inline"><span class="koboSpan" id="kobo.235.1">PrerenderMissingIdHandler</span></strong><span class="koboSpan" id="kobo.236.1">. </span><span class="koboSpan" id="kobo.236.2">Linking to a specific point on another page is done using a hash in the URL – a </span><strong class="source-inline"><span class="koboSpan" id="kobo.237.1">#</span></strong><span class="koboSpan" id="kobo.238.1"> character followed by the ID of an element on the destination page. </span><span class="koboSpan" id="kobo.238.2">If an element with the specified ID is not found on the destination page, then this option will determine how the build process </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">should behave.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.240.1">origin</span></strong><span class="koboSpan" id="kobo.241.1">: This defaults to </span><a href="https://kit.svelte.dev/docs/page-options"><span class="koboSpan" id="kobo.242.1">https://kit.svelte.dev/docs/page-options</span></a><span class="koboSpan" id="kobo.243.1">. </span><span class="koboSpan" id="kobo.243.2">If you want to use the application URL in the rendered content, it can be helpful to specify </span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">it here.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.245.1">Hopefully, this list of options was not too overwhelming and gave some insight as to how you can customize SvelteKit to your needs. </span><span class="koboSpan" id="kobo.245.2">SvelteKit will continue to evolve, so it is always recommended to check the official documentation, as features may be added or removed in </span><a id="_idIndexMarker035"/><span class="No-Break"><span class="koboSpan" id="kobo.246.1">future releases.</span></span></p>
<p><span class="koboSpan" id="kobo.247.1">Now that we’ve looked at a few options available for customizing SvelteKit, let’s look at how we can modify the behavior of Vite. </span><span class="koboSpan" id="kobo.247.2">Like SvelteKit, Vite comes with opinions on how projects should be configured. </span><span class="koboSpan" id="kobo.247.3">These opinions are useful for a wide range of use cases, but there will always be instances where they’ll need to </span><span class="No-Break"><span class="koboSpan" id="kobo.248.1">be adjusted.</span></span></p>
<h1 id="_idParaDest-42"><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.249.1">Configuring Vite</span></h1>
<p><span class="koboSpan" id="kobo.250.1">As previously </span><a id="_idIndexMarker036"/><span class="koboSpan" id="kobo.251.1">mentioned, Vite is the build tool that makes SvelteKit possible, so it’s just as important to know how to configure Vite as it is SvelteKit. </span><span class="koboSpan" id="kobo.251.2">That being said, Vite is highly configurable, and so for the sake of brevity (and your attention span), we’ll keep it limited to only a high-level view of available options. </span><span class="koboSpan" id="kobo.251.3">This section is not intended to be an exhaustive list but rather a quick glance at the options available to you. </span><span class="koboSpan" id="kobo.251.4">For further reading, consult the resources located at the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.252.1">this chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.253.1">At its heart, SvelteKit is just a Vite plugin. </span><span class="koboSpan" id="kobo.253.2">Obviously, there is more to it than that, but when you open </span><strong class="source-inline"><span class="koboSpan" id="kobo.254.1">vite.config.js</span></strong><span class="koboSpan" id="kobo.255.1"> in a newly created SvelteKit project, you’ll see what I mean. </span><span class="koboSpan" id="kobo.255.2">Similar to </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">svelte.config.js</span></strong><span class="koboSpan" id="kobo.257.1">, this configuration exports a </span><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">config</span></strong><span class="koboSpan" id="kobo.259.1"> constant, with a couple of properties set – the SvelteKit plugin that is imported and the tests to include. </span><span class="koboSpan" id="kobo.259.2">If you answered “no” to tests during the </span><strong class="source-inline"><span class="koboSpan" id="kobo.260.1">create@svelte</span></strong><span class="koboSpan" id="kobo.261.1"> prompts, you may not see the </span><strong class="source-inline"><span class="koboSpan" id="kobo.262.1">test</span></strong><span class="koboSpan" id="kobo.263.1"> property. </span><span class="koboSpan" id="kobo.263.2">The configuration from the skeleton application is shown in the following </span><span class="No-Break"><span class="koboSpan" id="kobo.264.1">code snippet:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.265.1">
import { sveltekit } from '@sveltejs/kit/vite';
const config = {
      plugins: [sveltekit()],
      test: {
           include: ['src/**/*.{test,spec}.{js,ts}']
     }
};
export default config;</span></pre>
<h2 id="_idParaDest-43"><a id="_idTextAnchor043"/><span class="koboSpan" id="kobo.266.1">plugins</span></h2>
<p><span class="koboSpan" id="kobo.267.1">It seems </span><a id="_idIndexMarker037"/><span class="koboSpan" id="kobo.268.1">logical to start with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">plugins</span></strong><span class="koboSpan" id="kobo.270.1"> property of our Vite configuration, as this book’s entire premise is based around one plugin in particular. </span><span class="koboSpan" id="kobo.270.2">With Vite becoming more popular and seeing a rise in adoption, its ecosystem is expanding, and with that comes more plugins. </span><span class="koboSpan" id="kobo.270.3">Many of those plugins are developed by the community to solve common problems. </span><span class="koboSpan" id="kobo.270.4">And because Vite extends Rollup, many Rollup plugins also work with Vite out of the box, although not all. </span><span class="koboSpan" id="kobo.270.5">The Vite development team maintains several official Vite plugins, including one that enables legacy browser support. </span><span class="koboSpan" id="kobo.270.6">Many features and functionality can be added to your application via these plugins. </span><span class="koboSpan" id="kobo.270.7">Once you have found a plugin that satisfies your requirements and installed it, you will need to import and include it in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.271.1">config.plugins</span></strong><span class="koboSpan" id="kobo.272.1"> array, just as SvelteKit was previously shown. </span><span class="koboSpan" id="kobo.272.2">Configurations for plugins vary, but typically, options are passed via the parameters of the imported function call. </span><span class="koboSpan" id="kobo.272.3">To find more plugins available for Vite, check out the Awesome Vite project </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">at </span></span><a href="https://github.com/vitejs/awesome-vite"><span class="No-Break"><span class="koboSpan" id="kobo.274.1">https://github.com/vitejs/awesome-vite</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.275.1">.</span></span></p>
<h2 id="_idParaDest-44"><a id="_idTextAnchor044"/><span class="koboSpan" id="kobo.276.1">server</span></h2>
<p><span class="koboSpan" id="kobo.277.1">Since Vite is </span><a id="_idIndexMarker038"/><span class="koboSpan" id="kobo.278.1">running the development server you’ll be working on with SvelteKit, you may need to make some changes to how that server operates. </span><span class="koboSpan" id="kobo.278.2">For instance, you may need to change the default port, proxy it through another server elsewhere, add support for HTTPS, or even disable HMR for testing with older browsers. </span><span class="koboSpan" id="kobo.278.3">In these instances and more, you will want to adjust </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.279.1">config.server</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.280.1"> accordingly.</span></span></p>
<h2 id="_idParaDest-45"><a id="_idTextAnchor045"/><span class="koboSpan" id="kobo.281.1">build</span></h2>
<p><span class="koboSpan" id="kobo.282.1">When building</span><a id="_idIndexMarker039"/><span class="koboSpan" id="kobo.283.1"> your application for your production environment, you’ll likely need to make some adjustments. </span><span class="koboSpan" id="kobo.283.2">Whether you need to ensure the application has met specific browser compatibility or you’d like to customize Rollup’s options, these settings can be found </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">under </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.285.1">config.build</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.286.1">.</span></span></p>
<h2 id="_idParaDest-46"><a id="_idTextAnchor046"/><span class="koboSpan" id="kobo.287.1">preview</span></h2>
<p><span class="koboSpan" id="kobo.288.1">Once you </span><a id="_idIndexMarker040"/><span class="koboSpan" id="kobo.289.1">have built your application for your production environment, you should test it with Vite’s preview functionality. </span><span class="koboSpan" id="kobo.289.2">Changing your preview server’s options can be done by </span><span class="No-Break"><span class="koboSpan" id="kobo.290.1">managing </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.291.1">config.preview</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.292.1">.</span></span></p>
<h2 id="_idParaDest-47"><a id="_idTextAnchor047"/><span class="koboSpan" id="kobo.293.1">optimizeDeps</span></h2>
<p><span class="koboSpan" id="kobo.294.1">Occasionally, you</span><a id="_idIndexMarker041"/><span class="koboSpan" id="kobo.295.1"> may want to test multiple dependencies or versions of dependencies with your code to see how well they work for your project. </span><span class="koboSpan" id="kobo.295.2">To include or exclude dependencies from pre-bundling, or to further modify options used by </span><strong class="source-inline"><span class="koboSpan" id="kobo.296.1">esbuild</span></strong><span class="koboSpan" id="kobo.297.1">, begin </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">configuring </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.299.1">config.optimizeDeps</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">.</span></span></p>
<h2 id="_idParaDest-48"><a id="_idTextAnchor048"/><span class="koboSpan" id="kobo.301.1">ssr</span></h2>
<p><span class="koboSpan" id="kobo.302.1">If you </span><a id="_idIndexMarker042"/><span class="koboSpan" id="kobo.303.1">need to prevent dependencies from running in your server environment, you may need to manage the options available to you </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">under </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.305.1">config.ssr</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.306.1">.</span></span></p>
<h1 id="_idParaDest-49"><a id="_idTextAnchor049"/><span class="koboSpan" id="kobo.307.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.308.1">In this chapter, we covered many configuration options available for SvelteKit. </span><span class="koboSpan" id="kobo.308.2">We went over an example of how </span><strong class="source-inline"><span class="koboSpan" id="kobo.309.1">config.kit.alias</span></strong><span class="koboSpan" id="kobo.310.1"> might be useful for importing frequently accessed files. </span><span class="koboSpan" id="kobo.310.2">While we did not cover all options, we did briefly look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.311.1">appDir</span></strong><span class="koboSpan" id="kobo.312.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.313.1">csp</span></strong><span class="koboSpan" id="kobo.314.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.315.1">csrf</span></strong><span class="koboSpan" id="kobo.316.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.317.1">env</span></strong><span class="koboSpan" id="kobo.318.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.319.1">prerender</span></strong><span class="koboSpan" id="kobo.320.1"> options and how they can affect </span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">our application.</span></span></p>
<p><span class="koboSpan" id="kobo.322.1">We also glanced at some configuration options available in </span><strong class="source-inline"><span class="koboSpan" id="kobo.323.1">vite.config.js</span></strong><span class="koboSpan" id="kobo.324.1">. </span><span class="koboSpan" id="kobo.324.2">For the most part, SvelteKit sets up a configuration that works for us according to the choices made in the installation prompt, but for further tweaks and plugins, we now know where to start looking in the official </span><span class="No-Break"><span class="koboSpan" id="kobo.325.1">Vite documentation.</span></span></p>
<p><span class="koboSpan" id="kobo.326.1">In the next chapter, we’ll go over some existing web standards and how SvelteKit’s design keeps them in mind. </span><span class="koboSpan" id="kobo.326.2">Existing standards present in web browsers are quickly becoming supported in other environments, including Node-based environments or even Deno and Cloudflare Workers. </span><span class="koboSpan" id="kobo.326.3">By leveraging these standards instead of building new ones on top of them, SvelteKit is accessible to </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">more developers.</span></span></p>
<h1 id="_idParaDest-50"><a id="_idTextAnchor050"/><span class="koboSpan" id="kobo.328.1">Further Reading</span></h1>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.329.1">SvelteKit documentation</span></strong><span class="koboSpan" id="kobo.330.1"> – The first stop on your troubleshooting journey should always be the official SvelteKit </span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">documentation: </span></span><a href="https://kit.svelte.dev/docs"><span class="No-Break"><span class="koboSpan" id="kobo.332.1">https://kit.svelte.dev/docs</span></span></a></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.333.1">Awesome Vite</span></strong><span class="koboSpan" id="kobo.334.1"> – A collection of official and community-maintained resources or plugins that make development with Vite </span><span class="No-Break"><span class="koboSpan" id="kobo.335.1">delightful: </span></span><a href="https://github.com/vitejs/awesome-vite"><span class="No-Break"><span class="koboSpan" id="kobo.336.1">https://github.com/vitejs/awesome-vite</span></span></a></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.337.1">Vite documentation </span></strong><span class="koboSpan" id="kobo.338.1">– Need to modify your development server or build process? </span><span class="koboSpan" id="kobo.338.2">Check here for official </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">recommendations: </span></span><a href="https://vitejs.dev/config/"><span class="No-Break"><span class="koboSpan" id="kobo.340.1">https://vitejs.dev/config/</span></span></a></li>
</ul>
</div>
</body></html>