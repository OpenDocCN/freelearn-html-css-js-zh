<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Gauge, Polar, and Range Charts</h1></div></div></div><p>In this chapter, we will learn how to create a gauge chart step by step. A gauge chart is very different from other Highcharts graphs. We will explore the new settings by plotting something similar to a twin-dials Fiat 500 speedometer. After that, we will review the structure of the polar chart and its similarity with other charts. Then, we will move on to examine how to create a range chart by using examples from the previous chapter. Finally, we will use a gauge chart to tweak the radial gradient in stages to achieve the desired effect. In this chapter, we will cover the following topics:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Plotting a speedometer gauge chart</li><li class="listitem" style="list-style-type: disc">Demonstrating a simple solid gauge chart</li><li class="listitem" style="list-style-type: disc">Converting a spline chart to a polar/radar chart</li><li class="listitem" style="list-style-type: disc">Plotting range charts with market index data</li><li class="listitem" style="list-style-type: disc">Using a radial gradient on a gauge chart</li></ul></div><div><div><div><div><h1 class="title"><a id="ch06lvl1sec42"/>Loading gauge, polar, and range charts</h1></div></div></div><p>In order to use <a id="id386" class="indexterm"/>any gauge, <a id="id387" class="indexterm"/>polar, and range type charts, first <a id="id388" class="indexterm"/>we need to include an additional file, <code class="literal">highcharts-more.js</code>, provided in the package:</p><div><pre class="programlisting"> &lt;script type="text/javascript" 
     src="img/highcharts.js"&gt;&lt;/script&gt;
 &lt;script type="text/javascript" 
     src="img/highcharts-more.js"&gt;&lt;/script&gt;</pre></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec43"/>Plotting a speedometer gauge chart</h1></div></div></div><p>Gauge charts have a <a id="id389" class="indexterm"/>very different structure compared to other Highcharts graphs. For instance, the backbone of a gauge chart is made up of a pane. A <strong>pane</strong><a id="id390" class="indexterm"/> is a circular plot area for laying out chart content. We can adjust the size, position, and background of the pane. Once a pane is laid out, we can then put the axis on top of it. Highcharts supports multiple panes within a chart, so we can display multiple gauges (that is, multiple gauge series) within a chart. A gauge series is composed of two specific components—a pivot and a dial.</p><p>Another distinct difference in gauge charts is that the series is actually one dimensional data: a single value. Therefore, there is only one axis, the y axis, used in this type of chart. The <code class="literal">yAxis</code> properties are used the same way as other series type charts which can be on a <code class="literal">linear</code>, <code class="literal">datetime</code>, or <code class="literal">logarithmic</code> scale, and it also responds to the <code class="literal">tickInterval</code> option and so on.</p><div><div><div><div><h2 class="title"><a id="ch06lvl2sec50"/>Plotting a twin dials chart – a Fiat 500 speedometer</h2></div></div></div><p>So far, we have mentioned all<a id="id391" class="indexterm"/> the parts that make up a gauge chart, and their<a id="id392" class="indexterm"/> relationships. There are many selectable options that can be used with gauge charts. In order to fully utilize them, we are going to learn in stages how to construct a sophisticated gauge chart by following the design of a Fiat 500 speedometer, as follows:</p><div><img src="img/7451OS_06_01.jpg" alt="Plotting a twin dials chart – a Fiat 500 speedometer"/></div><p>The speedometer is assembled <a id="id393" class="indexterm"/>with two dials on top of each other. The outer dial has two<a id="id394" class="indexterm"/> axes—mph and km/h. The inner dial is the rpm meter, which has a different scale and style. Another uncommon feature is that the body parts of both dials are hidden underneath: only the top needle parts are displayed. In the center of the gauge is an LED screen showing journey information. Despite all these unique characteristics, Highcharts provides enough flexibility to assemble a chart that looks very similar.</p></div><div><div><div><div><h2 class="title"><a id="ch06lvl2sec51"/>Plotting a gauge chart pane</h2></div></div></div><p>First, let's see what a pane <a id="id395" class="indexterm"/>does in Highcharts. In order to do that, we should start by building a<a id="id396" class="indexterm"/> single dial speedometer. The following is the chart configuration code for a gauge chart with a single pane and a single axis:</p><div><pre class="programlisting">     chart: {
            renderTo: 'container'
     },
     title: {  text: 'Fiat 500 Speedometer' },
     pane: [{
             startAngle: -120,
             endAngle: 120,
             size: 300,
             backgroundColor: '#E4E3DF'
     }],
     yAxis: [{
             min: 0,
             max: 140,
             labels: {
                   rotation: 'auto'
             }
     }],
     series: [{
             type: 'gauge',
             data: [ 0 ]
     }]</pre></div><p>The preceding code snippet produces the following gauge chart:</p><div><img src="img/7451OS_06_02.jpg" alt="Plotting a gauge chart pane"/></div><p>At the moment, this looks <a id="id397" class="indexterm"/>nothing like a Fiat 500 speedometer, but we will see the <a id="id398" class="indexterm"/>chart evolving gradually. The configuration declares a pane with a circular plot area from -120 to 120 degrees, with the y axis laying horizontally, whereas 0 degrees is at the 12 o'clock position. The <code class="literal">rotation</code> option generally takes a numerical degree value; <code class="literal">'auto'</code> is the special keyword to enable the y axis labels to automatically rotate so that they are aligned with the pane angle. The little box below the dial is the default data label showing the current value in the series.</p><div><div><div><div><h3 class="title"><a id="ch06lvl3sec10"/>Setting pane backgrounds</h3></div></div></div><p>Gauge charts support <a id="id399" class="indexterm"/>more advanced background settings than just a single background color, as we saw in the previous example. Instead, we can specify another property, <code class="literal">background</code>, inside the <code class="literal">pane</code> option that accepts an array of different background settings. Each setting can be declared as an inner ring with both the <code class="literal">innerRadius</code> and <code class="literal">outerRadius</code> values defined, or as a circular background with only the <code class="literal">outerRadius</code> option. Both options are assigned percentage values with respect to the size of the pane. Here we set multiple backgrounds to the pane, as follows:</p><div><pre class="programlisting">            chart: {
                type: 'gauge',
                .... 
            },
            title: { .... },
            series: [{
                name: 'Speed',
                data: [ 0 ],
                dial: { backgroundColor: '#FA3421' }
            }],
            pane: [{
                startAngle: -120,
                endAngle: 120,
                size: 300,
                background: [{
                    backgroundColor: { 
                       radialGradient: {
                          cx: 0.5,
                          cy: 0.6,
                          r: 1.0 
                        },
                       stops: [
                           [0.3, '#A7A9A4'],
                           [0.45, '#DDD'],
                           [0.7, '#EBEDEA'],
                       ]
                    },
                    innerRadius: '72%',
                    outerRadius: '105%'
                 }, {
                    // BG color in between speed and rpm
                    backgroundColor: '#38392F',
                    outerRadius: '72%',
                    innerRadius: '67%'
                 }, {
                    // BG color for rpm
                    .....
                 }]</pre></div><p>As we can see, several <a id="id400" class="indexterm"/>backgrounds are defined, which include the backgrounds for the inner gauge: the rpm dial. Some of these backgrounds are rings and the last one is a circular background. Moreover, the needle color, <code class="literal">series.dial.backgroundColor</code>, is set to black by default. We are setting the dial color to red initially, so that we can still see the needle with the black background, which also more closely resembles the real-life example. Later in this section, we will explore the details of shaping and coloring the dial and pivot. As for the backgrounds with the <code class="literal">radialGradient</code> feature, we will examine them later in this chapter.</p><div><img src="img/7451OS_06_03.jpg" alt="Setting pane backgrounds"/></div></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec11"/>Managing axes with different scales</h3></div></div></div><p>The next task is to lay a<a id="id401" class="indexterm"/> secondary <em>y</em> axis for the km/h scale, and we will set the new axis below the current display axis. We insert the new axis configuration as follows:</p><div><pre class="programlisting">            yAxis: [{
                min: 0,
                max: 140,
                labels: {
                   rotation: 'auto'
                }
            }, {
                min: 0,
                max: 220,
                tickPosition: 'outside',
                minorTickPosition: 'outside',
                offset: -40,
                labels: {
                   distance: 5,
                   rotation: 'auto'
                }
            }],</pre></div><p>The new axis has a scale from <code class="literal">0</code> to <code class="literal">220</code> and we use the <code class="literal">offset</code> option with a negative value, which pushes the axes' line towards the center of the pane. In addition, both <code class="literal">tickPosition</code> and <code class="literal">minorTickPosition</code> are set to <code class="literal">'outside'</code>. This changes the interval ticks' direction to the opposite of the default settings. Both axes are now facing each other, which makes them similar to the the following figure:</p><div><img src="img/7451OS_06_04.jpg" alt="Managing axes with different scales"/></div><p>However, there is an issue<a id="id402" class="indexterm"/> that has arisen, as the scale of the top axis has been disturbed: it is no longer between 0 and 140. This is because the default action for a secondary axis is to align the intervals between multiple axes. To resolve this issue, we must set the <code class="literal">chart.alignTicks</code> option to <code class="literal">false</code>. After that, the issue is resolved and both axes are laid out as expected:</p><div><img src="img/7451OS_06_05.jpg" alt="Managing axes with different scales"/></div></div><div><div><div><div><h3 class="title"><a id="ch06lvl3sec12"/>Extending to multiple panes</h3></div></div></div><p>Since the gauge consists of<a id="id403" class="indexterm"/> two dials, we need to add an extra pane for the second dial. The following is the pane configuration:</p><div><pre class="programlisting">            pane: [{
                // First pane for speed dial
                startAngle: -120,
                endAngle: 120,
                size: 300,
                background: [{
                    backgroundColor: { 
                       radialGradient: {
                       .....
                }]
            }, {
                // Second pane for rpm dial
                startAngle: -120,
                endAngle: 120,
                size: 200
            }]</pre></div><p>The second pane's plot area starts and ends at the same angles as the first pane, but has a smaller size. Since we haven't used the <code class="literal">center</code> option to position any panes within the chart, the inner pane is automatically placed at the center of the outer pane. The next step is to create another axis, rpm, which has a red region marked between the values of 4.5 and 6. Then, we bind all the axes to<a id="id404" class="indexterm"/> their panes, as follows:</p><div><pre class="programlisting">            yAxis: [{
                // axis for rpm - pane 1
                min: 0,
                max: 6,
                labels: {
                   rotation: 'auto',
                   formatter: function() {
                       if (this.value &gt;= 4.5) {
                          return '&lt;span style="color:' + 
                          '#A41E09"&gt;' + this.value +
                          "&lt;/span&gt;";
                       }
                       return this.value;
                   }
                },
                plotBands: [{
                    from: 4.5,
                    to: 6,
                    color: '#A41E09',
                    innerRadius: '94%'
                }],
                pane: 1
            }, {
                // axis for mph - pane 0
                min: 0,
                max: 140,
                .....
                pane: 0
            }, {
                // axis for km/h - pane 0
                min: 0,
                max: 220,
                ....
                pane: 0
          }]</pre></div><p>For the rpm axis, we use <code class="literal">labels.formatter</code> to mark up the font color in the high-revolution region and also create a plot band for the axis. The <code class="literal">innerRadius</code> option is to control how thick the red area appears to be. The next task is to create a new gauge series, that is, a second dial for the new pane. Since the chart contains two different dials, we need to make the dial movement relative to an axis, therefore we assign the <code class="literal">yAxis</code> option to bind the series to an axis. Also, we set the initial value for the new series to <code class="literal">4</code>, just to demonstrate how the two dials are constructed, not superimposed on each other, as follows:</p><div><pre class="programlisting">            series: [{
                type: 'gauge',
                name: 'Speed',
                data: [ 0 ],
                yAxis: 0
            }, {
                type: 'gauge',
                name: 'RPM',
                data: [ 4 ],
                yAxis: 2
            }]</pre></div><p>With all these additional <a id="id405" class="indexterm"/>changes, the following is the new look of the internal dial:</p><div><img src="img/7451OS_06_06.jpg" alt="Extending to multiple panes"/></div><p>In the next part, we will learn how to set up the look and feel of the dial needles.</p></div></div><div><div><div><div><h2 class="title"><a id="ch06lvl2sec52"/>Gauge series – dial and pivot</h2></div></div></div><p>There are a couple of properties <a id="id406" class="indexterm"/>specific to the gauge series, which are <code class="literal">plotOptions.gauge.dial</code> and <code class="literal">plotOptions.gauge.pivot</code>. The <code class="literal">dial</code> option <a id="id407" class="indexterm"/>controls the look <a id="id408" class="indexterm"/>and feel of the needle itself, whereas <code class="literal">pivot</code> <a id="id409" class="indexterm"/>is the tiny circle object at the center of the gauge attached to the dial.</p><p>First of all, we want to change the color and the thickness of the dials, as follows:</p><div><pre class="programlisting">            series: [{
                type: 'gauge',
                name: 'Speed',
                ....
                dial: {
                    backgroundColor: '#FA3421',
                    baseLength: '90%',
                    baseWidth: 7,
                    topWidth: 3,
                    borderColor: '#B17964',
                    borderWidth: 1
                }
            }, {
                type: 'gauge',
                name: 'RPM',
                ....
                dial: {
                    backgroundColor: '#FA3421',
                    baseLength: '90%',
                    baseWidth: 7,
                    topWidth: 3,
                    borderColor: '#631210',
                    borderWidth: 1
                }
            }]</pre></div><p>The preceding code<a id="id410" class="indexterm"/> snippet results <a id="id411" class="indexterm"/>in the <a id="id412" class="indexterm"/>following output:</p><div><img src="img/7451OS_06_07.jpg" alt="Gauge series – dial and pivot"/></div><p>First, we widen the needle by setting the <code class="literal">baseWidth</code> option to <code class="literal">7</code> pixels across and <code class="literal">3</code> pixels at the end of the needle. Then, instead of having the needle narrowing down gradually to the end of the tip, we set the <code class="literal">baseLength</code> option to <code class="literal">'90%'</code>, which is the position on the dial where the needle starts to narrow down to a point.</p><p>As we can see, the<a id="id413" class="indexterm"/> dials are still not quite right in that they are not long <a id="id414" class="indexterm"/>enough to reach to their axis lines, as shown in the preceding screenshot. Secondly, the <a id="id415" class="indexterm"/>rest of the dial bodies are not covered up. We can resolve this issue by fiddling with the <code class="literal">rearLength</code> option. The following are the amended series settings:</p><div><pre class="programlisting">            series: [{
                type: 'gauge',
                name: 'Speed',
                .....
                dial: {
                    .....
                    radius: '100%',
                    rearLength: '-74%'
                },
                pivot: { radius: 0 }   
            }, {    
                type: 'gauge',
                name: 'RPM',
                .....
                dial: { 
                    .....
                    radius: '100%',
                    rearLength: '-74%'
                },
                pivot: { radius: 0 }
            }] </pre></div><p>The trick is that instead of having a positive value like most of the gauge charts would have, we input a negative value that creates the covered-up effect. Finally, we remove the pivot by specifying the <code class="literal">radius</code> value as <code class="literal">0</code>. The following is the final adjustment of the dials:</p><div><img src="img/7451OS_06_08.jpg" alt="Gauge series – dial and pivot"/></div></div><div><div><div><div><h2 class="title"><a id="ch06lvl2sec53"/>Polishing the chart with fonts and colors</h2></div></div></div><p>The next step is to apply the<a id="id416" class="indexterm"/> axis options to tweak the tick intervals' color and size. The axis labels<a id="id417" class="indexterm"/> use fonts from the<a id="id418" class="indexterm"/> Google web fonts <a id="id419" class="indexterm"/>service (refer to <a class="ulink" href="http://www.google.com/fonts">http://www.google.com/fonts</a> for Google web fonts). Then, we<a id="id420" class="indexterm"/> adjust the font size and color to that shown in the screenshot. There are a myriad of fonts to choose from with Google web fonts and they come with easy instructions to apply them. The following is an example of embedding the Squada One font into the <code class="literal">&lt;head&gt;</code> section of an HTML file:</p><div><pre class="programlisting">&lt;link href='http://fonts.googleapis.com/css?family=Squada One'  
 rel='stylesheet' type='text/css'&gt;</pre></div><p>We apply the new imported font to the y axis titles and labels as shown in the following example:</p><div><pre class="programlisting">   yAxis: [{
        // axis for rpm - pane 1
        min: 0,
        max: 6,
        labels: { 
            style: {
                fontFamily: 'Squada One',
                fontSize: 22
                ....
            }
        }</pre></div><p>This significantly improves the look of the gauge, as follows:</p><div><img src="img/7451OS_06_09.jpg" alt="Polishing the chart with fonts and colors"/></div><p>The final part is to <a id="id421" class="indexterm"/>transform<a id="id422" class="indexterm"/> the series <a id="id423" class="indexterm"/>data labels to resemble an LED screen. We will change the<a id="id424" class="indexterm"/> data labels' font size, style, and color and remove the border of the label box. The rpm data label has a smaller font size and moves above the mph data label. To make it look more realistic, we will also set the background for the data labels to a pale orange color. All the details of the tunings can be found in the <a id="id425" class="indexterm"/>online example at <a class="ulink" href="http://joekuan.org/Learning_Highcharts/">http://joekuan.org/Learning_Highcharts/</a>. The following is the final look of the polished gauge chart:</p><div><img src="img/7451OS_06_10.jpg" alt="Polishing the chart with fonts and colors"/></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec44"/>Plotting the solid gauge chart</h1></div></div></div><p>Highcharts provides <a id="id426" class="indexterm"/>another type of gauge chart, solid gauge, which has a different presentation. Instead of having a dial, the chart background is filled with another color to indicate the level. The following is an example derived from the Highcharts online demo:</p><div><img src="img/7451OS_06_28.jpg" alt="Plotting the solid gauge chart"/></div><p>The principle of making a solid gauge chart is the same as a gauge chart, including the pane, y axis and series data, but without the dial setup. The following is our first attempt:</p><div><pre class="programlisting">            chart: {
                renderTo: 'container',
                type: 'solidgauge'
            },
            title: ....,
            pane: {
               size: '90%',
                background: {
                    innerRadius: "70%",
                    outerRadius: "100%"
                }
            },
            // the value axis
            yAxis: {
                min: 0,
                max: 200,
                title: {
                    text: 'Speed'
                }
            },
            series: [{
               data: [40],
               dataLabels: {
                    enabled: false
               }
            }]</pre></div><p>We start with <code class="literal">pane</code> in a donut<a id="id427" class="indexterm"/> shape by specifying the <code class="literal">innerRadius</code> and <code class="literal">outerRadius</code> options. Then, we assign the y axis range along the background pane and set the initial value to 40 for a visible gauge level. The following is the result of our first solid gauge:</p><div><img src="img/7451OS_06_24.jpg" alt="Plotting the solid gauge chart"/></div><p>As we can see, the pane<a id="id428" class="indexterm"/> starts and ends at the 12 o'clock position with a section of the pane filled up with blue as the solid gauge dial. Let's make the axis progress clockwise from 9 o'clock to 3 o'clock and configure the intervals to become visible over the color gauge. In addition, we will increase the thickness of the intervals and only allow the first and last interval labels to be displayed. Here is the modified configuration:</p><div><pre class="programlisting">            chart: .... ,
            title: .... ,
            pane: {
                startAngle: -90,
                endAngle: 90,
                ....
            },
            yAxis: {
                lineColor: '#8D8D8D',
                tickColor: '#8D8D8D',
                intervalWidth: 2,
                zIndex: 4,
                minorTickInterval: null,
                tickInterval: 10,
                labels: {
                    step: 20,
                    y: 16
                },
                ....
           },
           series: ....</pre></div><p>The <code class="literal">startAngle</code> and <code class="literal">endAngle</code> options are the effective start and end positions for labelling on the pane, so -90 and 90 degrees are the 9 o'clock and 3 o'clock positions respectively. Next, both <code class="literal">lineColor</code> (the axis line color at the outer boundary) and <code class="literal">tickColor</code> are applied with a darker color, so that by combining them with the <code class="literal">zIndex</code> option, the intervals become visible with the different levels of gauge colors.</p><p>The following is the output of the modified <a id="id429" class="indexterm"/>chart:</p><div><img src="img/7451OS_06_25.jpg" alt="Plotting the solid gauge chart"/></div><p>Next, we remove the bottom half of the background pane to leave a semi-circle shape and configure the background with shading (described in detail later in this chapter). Then, we adjust the size of the color gauge to be the same width as the background pane. We provide a list of color bands for different speed values, so that Highcharts will automatically change the gauge level from one color band to another according to the value:</p><div><pre class="programlisting"> chart: ...
            title: ...
            pane: {
             
                background: {
              
                    shape: 'arc',
                    borderWidth: 2,
                    borderColor: '#8D8D8D',
                    backgroundColor: {
                        radialGradient: {
                            cx: 0.5, 
                            cy: 0.7, 
                            r: 0.9
                        },
                        stops: [
                            [ 0.3, '#CCC' ],
                            [ 0.6, '#E8E8E8' ]
                        ]
                    },
                }
            },

            yAxis: {
                        ... ,
          stops: [
                    [ 0, '#4673ac' ], // blue
                    [ 0.2, '#79c04f' ], // green
                    [ 0.4, '#ffcc00'], // yellow
                    [ 0.6, '#ff6600'], // orange
                    [ 0.8, '#ff5050' ], // red
                    [ 1.0, '#cc0000' ]
                ],
            },

            plotOptions: {
                      solidgauge: {
                                    innerRadius: '71%'
                                }
                    },

                   series: [{
                            data: [100],
                            }]</pre></div><p>The <code class="literal">shape</code> option, <code class="literal">'arc'</code>, turns <a id="id430" class="indexterm"/>the pane into an arc shape. The color bands along the y axis are provided with a <code class="literal">stops</code> option, which is an array of ratios (the ratio of y axis range) and the color values. In order to align the gauge level with the pane, we assign the <code class="literal">innerRadius</code> value of <code class="literal">plotOptions.solidgauge</code> to be slightly smaller than the pane <code class="literal">innerRadius</code> value, so that the movement of the gauge level doesn't cover the pane's inner border. We set the series value to 100 to show that the gauge level displays a different color as follows:</p><div><img src="img/7451OS_06_26.jpg" alt="Plotting the solid gauge chart"/></div><p>Now we have extra space in the <a id="id431" class="indexterm"/>bottom half of the chart, we can simply move the chart lower and decorate it with a data label as follows:</p><div><pre class="programlisting">            pane: {
                .... ,
                center: [ '50%', '65%' ]
            },
            plotOptions: {
                solidgauge: {
                   innerRadius: '71%',
                    dataLabels: {
                           y: 5,
                           borderWidth: 0,
                           useHTML: true
                    }
               }
            },
            series: [{
                 data: [100],
                 dataLabels: {
                      y: -60,
                      format: '&lt;div style="text-align:center"&gt;' + 
      '&lt;span style="font-size:35px;color:black"&gt;{y}&lt;/span&gt;&lt;br/&gt;' +
     '&lt;span style="font-size:16px;color:silver"&gt;km/h&lt;/span&gt;&lt;/div&gt;'
              }
            }]</pre></div><p>We set the chart's vertical position to 65 percent of the plot area height with the <code class="literal">center</code> option. Finally, we enable <code class="literal">dataLabels</code> to be<a id="id432" class="indexterm"/> shown as in HTML with textual decoration:</p><div><img src="img/7451OS_06_27.jpg" alt="Plotting the solid gauge chart"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec45"/>Converting a spline chart to a polar/radar chart</h1></div></div></div><p>Polar (or radar) charts <a id="id433" class="indexterm"/>are generally used to spot data trends. They <a id="id434" class="indexterm"/>have a few differences from line and column type <a id="id435" class="indexterm"/>charts. Even though they may look like pie charts, they have nothing in common with them. In fact, a polar chart is a round representation of the conventional two-dimensional charts. To visualize it another way, it is a folded line or a column chart placed in a circular way with both ends of the x axis meeting.</p><p>Again, we need to include <code class="literal">highcharts-more.js</code> in order to plot a polar chart. The following screenshot illustrates the structure of a polar chart:</p><div><img src="img/7451OS_06_11.jpg" alt="Converting a spline chart to a polar/radar chart"/></div><p>There are very few differences <a id="id436" class="indexterm"/>in principle, and the same also applies to <a id="id437" class="indexterm"/>the Highcharts configuration. Let's use our very <a id="id438" class="indexterm"/>first example of a browser usage chart in <a class="link" href="ch01.html" title="Chapter 1. Web Charts">Chapter 1</a>, <em>Web Charts</em>, and turn it into a radar chart. Recalling the browser line chart, we made the following:</p><div><img src="img/7451OS_06_12.jpg" alt="Converting a spline chart to a polar/radar chart"/></div><p>To turn the line chart into a <a id="id439" class="indexterm"/>polar chart, we only need to set<a id="id440" class="indexterm"/> the <code class="literal">chart.polar</code> option to <code class="literal">true</code>, which <a id="id441" class="indexterm"/>transforms the orthogonal x and y coordinates into a polar coordinate system. To make the new polar chart easier to read, we set the <em>x</em> axis labels' <code class="literal">rotation</code> value to <code class="literal">'auto'</code>, as follows:</p><div><pre class="programlisting">             chart: { 
                 ....,
                 polar: true
             },
             ....,
             xAxis: {
                 ....,
                 labels: { rotation:  'auto' }
             },</pre></div><p>The following is the polar version of the line chart:</p><div><img src="img/7451OS_06_13.jpg" alt="Converting a spline chart to a polar/radar chart"/></div><p>As we can see, one characteristic of a polar chart is that it reveals data trends differently compared to conventional charts. From a clockwise direction, we see the data line "spirals up" for an upward trend (Chrome) and "spirals down" for a downward trend (Internet Explorer), whereas the data line for Firefox doesn't show much movement. As for Safari and Opera, these series are essentially lost as they are completely invisible unless we enlarge the chart container, which is impractical. Another characteristic is that the last and first data points in the series are connected together. As a result, the Firefox series shows a closed loop and there is a sudden jump<a id="id442" class="indexterm"/> in the Internet Explorer<a id="id443" class="indexterm"/> series (the Chrome series is not connected because it has null values at the beginning of the series as the Chrome browser was not released until late 2008).</p><p>To correct this behavior, we can simply add a null value at the end of each <a id="id444" class="indexterm"/>series data array to break the continuity, which is demonstrated in the following screenshot:</p><div><img src="img/7451OS_06_23.jpg" alt="Converting a spline chart to a polar/radar chart"/></div><p>Instead of having a round polar chart, Highcharts supports polygon interpolation along the <em>y</em> axis grid lines. This means that the grid lines are straightened and the whole chart becomes like a spider web.</p><p>For the sake of illustration, we <a id="id445" class="indexterm"/>set the width of <em>x</em> and <em>y</em> axis lines to 0, which<a id="id446" class="indexterm"/> removes the round outline<a id="id447" class="indexterm"/> from the chart. Then, we set a special option on the <em>y</em> axis, <code class="literal">gridLineInterpolation,</code> to <code class="literal">polygon</code>. Finally, we change the <code class="literal">tickmarkPlacement</code> option of the x axis to <code class="literal">'on'</code> instead of the default value, <code class="literal">between</code>. This gets the interval ticks on the x axis to align with the start of each category. The following code snippet summarizes the changes that we need to make:</p><div><pre class="programlisting">            xAxis: {
                categories: [ ..... ],
                tickmarkPlacement: 'on',
                labels: {
                    rotation: 'auto',
                },
                lineWidth: 0,
                plotBands: [{
                    from: 10,
                    to: 11,
                    color: '#FF0000'
                }]
            },
            yAxis: {
                .....,
                gridLineInterpolation: 'polygon',
                lineWidth: 0,
                min: 0
            },</pre></div><p>In order to demonstrate a spider web shape, we will remove most of the data samples from the previous chart (alternatively, you can enlarge the chart container to keep all the data). We will also add a couple<a id="id448" class="indexterm"/> of grid line decorations and an x-axis plot <a id="id449" class="indexterm"/>band (Nov – Dec) just to show that other axis<a id="id450" class="indexterm"/> options can still be applied to a polar chart:</p><div><img src="img/7451OS_06_14.jpg" alt="Converting a spline chart to a polar/radar chart"/></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec46"/>Plotting range charts with market index data</h1></div></div></div><p>Range charts are<a id="id451" class="indexterm"/> really line and column type charts presenting a<a id="id452" class="indexterm"/> series of data in range. The set of range type series can be <code class="literal">arearange</code>, <code class="literal">areasplinerange</code>, and <code class="literal">columnrange</code>. These series expect an array of three data points, x, y min, y max, in the data option or array of y min, y max if <code class="literal">xAxis.cateogries</code> has already been specified.</p><p>Let's use our past examples to see whether we can make an improvement to the range charts. In <a class="link" href="ch02.html" title="Chapter 2. Highcharts Configurations">Chapter 2</a>, <em>Highcharts Configurations</em>, we have a five-series graph showing the monthly data of Nasdaq 100: open, close, high, low, and volume, as shown in the following screenshot:</p><div><img src="img/7451OS_06_15.jpg" alt="Plotting range charts with market index data"/></div><p>With the new range series, we <a id="id453" class="indexterm"/>sort the series data and merge the<a id="id454" class="indexterm"/> <strong>Monthly High</strong> and <strong>Monthly Low</strong> columns into a column range series, and the <strong>Open</strong> and <strong>Low</strong> columns into an area spline range series, as follows:</p><div><pre class="programlisting">            series: [{
              type: 'columnrange',
              name: 'High &amp; Low',
              data: [ [ 2237.73, 2336.04 ], 
                      [ 2285.44, 2403.52 ], 
                      [ 2217.43, 2359.98 ],  ...... ]
            }, {
              type: 'areasplinerange',
              name: 'Open &amp; Close',
              // This array of data is pre-sorted,
              // not in Open, Close order.
              data: [ [ 2238.66, 2336.04 ], 
                      [ 2298.37, 2350.99 ], 
                      [ 2338.99, 2359.78 ], ...... ]
            }, {
              name: 'Volume',
              ......</pre></div><p>The following screenshot shows the range chart version:</p><div><img src="img/7451OS_06_16.jpg" alt="Plotting range charts with market index data"/></div><p>The new chart looks much <a id="id455" class="indexterm"/>simpler to read and the graph is less<a id="id456" class="indexterm"/> packed. It is worth noting that for the column range series, it is mandatory to keep the range in min to max order. As for the area spline and area range series types, we can still plot the range series even without sorting them beforehand.</p><p>For instance, the <strong>High &amp; Low</strong> range series have to be in min and max order, according to the natural meaning of the name of the series. However, this is not the same for the <strong>Open &amp; Close</strong> range series as we wouldn't know which way is open or close. If we plot the <strong>Open &amp; Close</strong> area range series by keeping keeping the range in open to close order, instead of y min to y max, the area range is displayed differently, as shown in the following screenshot:</p><div><img src="img/7451OS_06_17.jpg" alt="Plotting range charts with market index data"/></div><p>As we can see, there are <a id="id457" class="indexterm"/>twisted bits in the area range series; these<a id="id458" class="indexterm"/> crossovers are caused by the reverse order in the data pairs. Nonetheless, we won't know whether open is higher than close or vice versa. If we only want to know how wide the range between the <strong>Open &amp; Close</strong> series is, then the preceding area range chart achieves the goal. By keeping them as separate series, there will be no such issue. In a nutshell, this is the subtle difference when plotting range series data with ambiguous meanings.</p></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec47"/>Using a radial gradient on a gauge chart</h1></div></div></div><p>The radial gradient setting is<a id="id459" class="indexterm"/> based on SVG. As its name implies, a <strong>radial gradient</strong><a id="id460" class="indexterm"/> is color shading radiating outwards in a circular direction. Therefore, it requires three properties to define the gradient circle—<code class="literal">cx</code>, <code class="literal">cy</code>, and <code class="literal">r</code>. The <a id="id461" class="indexterm"/>gradient circle is the outermost circle for shading, such that no shading can go outside of this.</p><p>All the gradient positions are defined in ratio values between zero and one with respect to their containing elements. The <code class="literal">cx</code> and <code class="literal">cy</code> options are at the x, y center position of the outermost circle, whereas <code class="literal">r</code> is the radius of the outmost circle. If <code class="literal">r</code> is 0.5, it means the gradient radius is half the diameter of its element, the same size as the containing pane. In other words, the gradient starts from the center and goes all the way to the edge of the gauge. The <code class="literal">stop </code>offsets option works the same way as the linear gradient: the first parameter is the ratio position in the gradient circle to stop the shading. This controls the intensity of shading between the colors. The shorter the gap, the higher the contrast between the colors.</p><p>Let's explore how to set up the color gradient. The following is a mood swing detector without any color gradient:</p><div><img src="img/7451OS_06_18.jpg" alt="Using a radial gradient on a gauge chart"/></div><p>We will apply a radial <a id="id462" class="indexterm"/>gradient to the preceding chart with the<a id="id463" class="indexterm"/> following settings:</p><div><pre class="programlisting">                background: [{ 
                   backgroundColor: {
                       radialGradient: {
                           cx: 0.5,
                           cy: 0.5,
                            r: 0.5
                       },
                       stops: [
                           [ 0, '#CCD5DE' ],
                           [ 1, '#002E59' ]
                       ]  
                   }
                }]</pre></div><p>We have set <code class="literal">cx</code>, <code class="literal">cy</code>, and <code class="literal">r</code> to <code class="literal">0.5</code> for the gradient to start shading from the center position all the way towards the edge of the circle, as follows:</p><div><img src="img/7451OS_06_19.jpg" alt="Using a radial gradient on a gauge chart"/></div><p>As we can see, the preceding<a id="id464" class="indexterm"/> chart shows white shading evenly radiating from<a id="id465" class="indexterm"/> the center. Let's change some of the parameters and see the effect:</p><div><pre class="programlisting">              backgroundColor: {
                  radialGradient: {
                      cx: 0.5,
                      cy: 0.7,
                      r: 0.25
                  },
                  stops: [
                      [ 0.15, '#CCD5DE' ],
                      [ 0.85, '#002E59' ]
                  ]  
              }</pre></div><p>Here, we have changed the size of the gradient circle to half the size of the gauge and moved the circle down. The bright color doesn't start shading until it reaches 15 percent of the size of the gradient circle, so there is a distinct white blob in the middle, and the shading stops at 85 percent of the circle:</p><div><img src="img/7451OS_06_20.jpg" alt="Using a radial gradient on a gauge chart"/></div><p>In the SVG radiant gradient, there are<a id="id466" class="indexterm"/> two other options, <code class="literal">fx</code> and <code class="literal">fy</code>, which are used to <a id="id467" class="indexterm"/>set the focal point position for the shading; they are also referred to as the inner circle settings.</p><div><div><h3 class="title"><a id="note13"/>Note</h3><p>The '<code class="literal">fx</code>'and '<code class="literal">fy</code>' options may not work properly with Chrome and Safari browsers. At the time of writing this, only Firefox and Internet Explorer browsers are working properly with the images shown here.</p></div></div><p>Let's experiment with how the focal point can affect the shading:</p><div><pre class="programlisting">                   backgroundColor: {
                       radialGradient: {
                           cx: 0.5,
                           cy: 0.7,
                            r: 0.25,
                           fx: 0.6,
                           fy: 1.0
                       },
                       stops: [
                           [ 0.15, '#CCD5DE' ],
                           [ 0.85, '#002E59' ]
                       ]  
                   }</pre></div><p>The preceding code snippet produces the following output:</p><div><img src="img/7451OS_06_21.jpg" alt="Using a radial gradient on a gauge chart"/></div><p>We can observe that the <code class="literal">fx</code> <a id="id468" class="indexterm"/>and <code class="literal">fy</code> options move the bright color starting from<a id="id469" class="indexterm"/> the bottom of the gradient circle and slightly to the right-hand side. This makes the shading much more directional. Let's make our final change by moving the bright spot position towards the center of the gauge chart. In addition, we align the focal directional along the <strong>Good</strong> label:</p><div><pre class="programlisting">                background: [{ 
                   backgroundColor: {
                       radialGradient: {
                           cx: 0.32,
                           cy: 0.38,
                            r: 0.25,
                           fx: 1.3,
                           fy: 0.95 
                       },
                       stops: [
                           [ 0.1, '#CCD5DE' ],
                           [ 0.9, '#002E59' ]
                       ]  
                   }]</pre></div><p>Finally, we can finish the chart by moving the bright side to where we want it to be, as follows:</p><div><img src="img/7451OS_06_22.jpg" alt="Using a radial gradient on a gauge chart"/></div><div><div><h3 class="title"><a id="note14"/>Note</h3><p>The <code class="literal">fx</code> and <code class="literal">fy</code> options<a id="id470" class="indexterm"/> are only for SVG, which older versions<a id="id471" class="indexterm"/> of Internet Explorer (8.0 or earlier) using VML won't support.</p></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch06lvl1sec48"/>Summary</h1></div></div></div><p>In this chapter, we learned about gauge, polar, and range charts. An extensive step-by-step demonstration showed how to plot a complex speedometer by utilizing most of the gauge options. We also demonstrated the differences between polar, column, and line charts with respect to principle and configuration. We used range charts to improve past chapter examples and study the subtle differences they insert into the chart. Finally, we explored how to define radial gradients by tweaking the options in stages.</p><p>In the next chapter, we will learn the structure of a bubble chart by recreating it from an online sport chart. Then, we will briefly discuss the properties of a box plot chart by transforming data from a spider chart, following with presenting the F1 race data with an error bar chart.</p></div></body></html>